Time to train models with hard masking!
The PID of this script is: 2262743

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:34:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:34:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.6978
Train Loss: 0.8178
ID Validation ACCURACY: 0.7073
ID Validation Loss: 0.8153
ID Test ACCURACY: 0.7103
ID Test Loss: 0.7832
OOD Validation ACCURACY: 0.5293
OOD Validation Loss: 4.3988
OOD Test ACCURACY: 0.7053
OOD Test Loss: 0.8200

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.5981
Train Loss: 1.5295
ID Validation ACCURACY: 0.6107
ID Validation Loss: 1.4661
ID Test ACCURACY: 0.6133
ID Test Loss: 1.4754
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.6360
OOD Test ACCURACY: 0.8323
OOD Test Loss: 0.5349

[0m[1;37mINFO[0m: [1mChartInfo 0.7103 0.7053 0.6133 0.8323 0.6107 0.9293[0mId_val ACCURACY: 0.7073Id_val Loss: 0.8153
Id_test ACCURACY: 0.7103Id_test Loss: 0.7832
Test ACCURACY: 0.7053Test Loss: 0.8200


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:34:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:46 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:34:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 55...
[0m[1;37mINFO[0m: [1mCheckpoint 55: 
-----------------------------------
Train ACCURACY: 0.6576
Train Loss: 1.1793
ID Validation ACCURACY: 0.6677
ID Validation Loss: 1.1576
ID Test ACCURACY: 0.6633
ID Test Loss: 1.1636
OOD Validation ACCURACY: 0.9090
OOD Validation Loss: 0.5521
OOD Test ACCURACY: 0.6873
OOD Test Loss: 0.8331

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.6379
Train Loss: 1.1194
ID Validation ACCURACY: 0.6470
ID Validation Loss: 1.0736
ID Test ACCURACY: 0.6483
ID Test Loss: 1.0711
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.4564
OOD Test ACCURACY: 0.7453
OOD Test Loss: 0.6907

[0m[1;37mINFO[0m: [1mChartInfo 0.6633 0.6873 0.6483 0.7453 0.6470 0.9297[0mId_val ACCURACY: 0.6677Id_val Loss: 1.1576
Id_test ACCURACY: 0.6633Id_test Loss: 1.1636
Test ACCURACY: 0.6873Test Loss: 0.8331


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:34:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:34:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.6217
Train Loss: 1.0116
ID Validation ACCURACY: 0.6153
ID Validation Loss: 0.9939
ID Test ACCURACY: 0.6220
ID Test Loss: 1.0031
OOD Validation ACCURACY: 0.3637
OOD Validation Loss: 1.7772
OOD Test ACCURACY: 0.3713
OOD Test Loss: 1.3965

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.4042
Train Loss: 1.5028
ID Validation ACCURACY: 0.4107
ID Validation Loss: 1.4701
ID Test ACCURACY: 0.4163
ID Test Loss: 1.4716
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.4579
OOD Test ACCURACY: 0.7133
OOD Test Loss: 0.7982

[0m[1;37mINFO[0m: [1mChartInfo 0.6220 0.3713 0.4163 0.7133 0.4107 0.9297[0mId_val ACCURACY: 0.6153Id_val Loss: 0.9939
Id_test ACCURACY: 0.6220Id_test Loss: 1.0031
Test ACCURACY: 0.3713Test Loss: 1.3965


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:34:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:34:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.6936
Train Loss: 1.0310
ID Validation ACCURACY: 0.6920
ID Validation Loss: 1.0685
ID Test ACCURACY: 0.6947
ID Test Loss: 1.0131
OOD Validation ACCURACY: 0.3340
OOD Validation Loss: 4.6738
OOD Test ACCURACY: 0.4180
OOD Test Loss: 1.3806

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.4467
Train Loss: 1.2594
ID Validation ACCURACY: 0.4403
ID Validation Loss: 1.2612
ID Test ACCURACY: 0.4583
ID Test Loss: 1.2354
OOD Validation ACCURACY: 0.9253
OOD Validation Loss: 0.5541
OOD Test ACCURACY: 0.3493
OOD Test Loss: 1.3955

[0m[1;37mINFO[0m: [1mChartInfo 0.6947 0.4180 0.4583 0.3493 0.4403 0.9253[0mId_val ACCURACY: 0.6920Id_val Loss: 1.0685
Id_test ACCURACY: 0.6947Id_test Loss: 1.0131
Test ACCURACY: 0.4180Test Loss: 1.3806


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:34:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:34:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.7152
Train Loss: 1.0120
ID Validation ACCURACY: 0.7130
ID Validation Loss: 0.9707
ID Test ACCURACY: 0.7370
ID Test Loss: 0.9485
OOD Validation ACCURACY: 0.8773
OOD Validation Loss: 0.5091
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.4013

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.5879
Train Loss: 1.6555
ID Validation ACCURACY: 0.5947
ID Validation Loss: 1.6052
ID Test ACCURACY: 0.6073
ID Test Loss: 1.5892
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.7251
OOD Test ACCURACY: 0.8343
OOD Test Loss: 0.5963

[0m[1;37mINFO[0m: [1mChartInfo 0.7370 0.9243 0.6073 0.8343 0.5947 0.9300[0mId_val ACCURACY: 0.7130Id_val Loss: 0.9707
Id_test ACCURACY: 0.7370Id_test Loss: 0.9485
Test ACCURACY: 0.9243Test Loss: 0.4013


Final accuracies: 
ID_VAL     = 0.679 +- 0.036
ID_TEST    = 0.685 +- 0.040
TEST       = 0.621 +- 0.204

Final losses: 
ID_VAL     = 1.0012 +- 0.1136
ID_TEST    = 0.9823 +- 0.1225
TEST       = 0.9663 +- 0.3782
Diff id_val-test  = 0.0349 
DONE TRAIN GSAT GOODMotif/basis hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:35:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:35:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.8946
Train Loss: 0.2294
ID Validation ACCURACY: 0.8451
ID Validation Loss: 0.4596
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4928
OOD Validation ACCURACY: 0.8442
OOD Validation Loss: 0.7055
OOD Test ACCURACY: 0.7909
OOD Test Loss: 1.2081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ACCURACY: 0.8613
Train Loss: 0.3029
ID Validation ACCURACY: 0.8268
ID Validation Loss: 0.4327
ID Test ACCURACY: 0.8231
ID Test Loss: 0.4451
OOD Validation ACCURACY: 0.8502
OOD Validation Loss: 0.5097
OOD Test ACCURACY: 0.8121
OOD Test Loss: 0.6943

[0m[1;37mINFO[0m: [1mChartInfo 0.8359 0.7909 0.8231 0.8121 0.8268 0.8502[0mId_val ACCURACY: 0.8451Id_val Loss: 0.4596
Id_test ACCURACY: 0.8359Id_test Loss: 0.4928
Test ACCURACY: 0.7909Test Loss: 1.2081


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:35:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:35:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.1959
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5034
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5283
OOD Validation ACCURACY: 0.8458
OOD Validation Loss: 0.8693
OOD Test ACCURACY: 0.8026
OOD Test Loss: 1.3095

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.8494
Train Loss: 0.3303
ID Validation ACCURACY: 0.8246
ID Validation Loss: 0.3965
ID Test ACCURACY: 0.8274
ID Test Loss: 0.4033
OOD Validation ACCURACY: 0.8494
OOD Validation Loss: 0.3884
OOD Test ACCURACY: 0.8215
OOD Test Loss: 0.4617

[0m[1;37mINFO[0m: [1mChartInfo 0.8380 0.8026 0.8274 0.8215 0.8246 0.8494[0mId_val ACCURACY: 0.8449Id_val Loss: 0.5034
Id_test ACCURACY: 0.8380Id_test Loss: 0.5283
Test ACCURACY: 0.8026Test Loss: 1.3095


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:35:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:35:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.1496
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5913
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5983
OOD Validation ACCURACY: 0.8434
OOD Validation Loss: 0.9268
OOD Test ACCURACY: 0.7956
OOD Test Loss: 1.1860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ACCURACY: 0.8865
Train Loss: 0.2502
ID Validation ACCURACY: 0.8387
ID Validation Loss: 0.4508
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4682
OOD Validation ACCURACY: 0.8523
OOD Validation Loss: 0.5568
OOD Test ACCURACY: 0.8184
OOD Test Loss: 0.7482

[0m[1;37mINFO[0m: [1mChartInfo 0.8447 0.7956 0.8359 0.8184 0.8387 0.8523[0mId_val ACCURACY: 0.8449Id_val Loss: 0.5913
Id_test ACCURACY: 0.8447Id_test Loss: 0.5983
Test ACCURACY: 0.7956Test Loss: 1.1860


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:35:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:35:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.8962
Train Loss: 0.2153
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.4803
ID Test ACCURACY: 0.8374
ID Test Loss: 0.4933
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7998
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.8763
Train Loss: 0.2680
ID Validation ACCURACY: 0.8308
ID Validation Loss: 0.4440
ID Test ACCURACY: 0.8295
ID Test Loss: 0.4615
OOD Validation ACCURACY: 0.8541
OOD Validation Loss: 0.6125
OOD Test ACCURACY: 0.8222
OOD Test Loss: 0.7056

[0m[1;37mINFO[0m: [1mChartInfo 0.8374 0.7991 0.8295 0.8222 0.8308 0.8541[0mId_val ACCURACY: 0.8427Id_val Loss: 0.4803
Id_test ACCURACY: 0.8374Id_test Loss: 0.4933
Test ACCURACY: 0.7991Test Loss: 1.0971


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:35:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:35:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:35:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9018
Train Loss: 0.2011
ID Validation ACCURACY: 0.8468
ID Validation Loss: 0.5144
ID Test ACCURACY: 0.8415
ID Test Loss: 0.5419
OOD Validation ACCURACY: 0.8424
OOD Validation Loss: 0.9462
OOD Test ACCURACY: 0.7918
OOD Test Loss: 1.4711

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.8617
Train Loss: 0.3062
ID Validation ACCURACY: 0.8221
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8200
ID Test Loss: 0.4485
OOD Validation ACCURACY: 0.8539
OOD Validation Loss: 0.4468
OOD Test ACCURACY: 0.8237
OOD Test Loss: 0.5712

[0m[1;37mINFO[0m: [1mChartInfo 0.8415 0.7918 0.8200 0.8237 0.8221 0.8539[0mId_val ACCURACY: 0.8468Id_val Loss: 0.5144
Id_test ACCURACY: 0.8415Id_test Loss: 0.5419
Test ACCURACY: 0.7918Test Loss: 1.4711


Final accuracies: 
ID_VAL     = 0.845 +- 0.001
ID_TEST    = 0.840 +- 0.003
TEST       = 0.796 +- 0.004

Final losses: 
ID_VAL     = 0.5098 +- 0.0449
ID_TEST    = 0.5309 +- 0.0388
TEST       = 1.2544 +- 0.1277
Diff id_val-test  = 0.7446 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN GSAT GOODSST2/length hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:36:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:36:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;31mERROR[0m: 05/17/2024 10:36:16 AM - utils.py - line 52 : [1mCheckpoint not found at /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/checkpoints/round1/GOODCMNIST_color_covariate/repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedmitig_explscoreshardavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.7/best.ckpt
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 636, in goodtg
    main()
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 580, in main
    test_score, test_loss = pipeline.load_task(load_param=True, load_split="id")
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1372, in load_task
    test_score, test_loss = self.config_model('test', load_param=load_param, load_split=load_split)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1402, in config_model
    print(f'#E#Checkpoint not found at {os.path.abspath(self.config.test_ckpt)}')
Time to train models with hard masking!
The PID of this script is: 2263352

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:41:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:41:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 18...
[0m[1;37mINFO[0m: [1mCheckpoint 18: 
-----------------------------------
Train ACCURACY: 0.6871
Train Loss: 0.8504
ID Validation ACCURACY: 0.6993
ID Validation Loss: 0.8351
ID Test ACCURACY: 0.6983
ID Test Loss: 0.8449
OOD Validation ACCURACY: 0.5330
OOD Validation Loss: 1.1042
OOD Test ACCURACY: 0.5190
OOD Test Loss: 1.0268

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5497
Train Loss: 1.1856
ID Validation ACCURACY: 0.5620
ID Validation Loss: 1.1989
ID Test ACCURACY: 0.5707
ID Test Loss: 1.1955
OOD Validation ACCURACY: 0.6903
OOD Validation Loss: 0.7487
OOD Test ACCURACY: 0.6773
OOD Test Loss: 0.7183

[0m[1;37mINFO[0m: [1mChartInfo 0.6983 0.5190 0.5707 0.6773 0.5620 0.6903[0mId_val ACCURACY: 0.6993Id_val Loss: 0.8351
Id_test ACCURACY: 0.6983Id_test Loss: 0.8449
Test ACCURACY: 0.5190Test Loss: 1.0268


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:41:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:41:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.6884
Train Loss: 0.7575
ID Validation ACCURACY: 0.7133
ID Validation Loss: 0.7174
ID Test ACCURACY: 0.6943
ID Test Loss: 0.7583
OOD Validation ACCURACY: 0.5157
OOD Validation Loss: 1.1036
OOD Test ACCURACY: 0.7193
OOD Test Loss: 0.7663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 75...
[0m[1;37mINFO[0m: [1mCheckpoint 75: 
-----------------------------------
Train ACCURACY: 0.5467
Train Loss: 0.9902
ID Validation ACCURACY: 0.5517
ID Validation Loss: 0.9905
ID Test ACCURACY: 0.5537
ID Test Loss: 0.9969
OOD Validation ACCURACY: 0.7237
OOD Validation Loss: 0.7625
OOD Test ACCURACY: 0.6420
OOD Test Loss: 0.7160

[0m[1;37mINFO[0m: [1mChartInfo 0.6943 0.7193 0.5537 0.6420 0.5517 0.7237[0mId_val ACCURACY: 0.7133Id_val Loss: 0.7174
Id_test ACCURACY: 0.6943Id_test Loss: 0.7583
Test ACCURACY: 0.7193Test Loss: 0.7663


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:41:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:41:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.6692
Train Loss: 0.8985
ID Validation ACCURACY: 0.6720
ID Validation Loss: 0.8802
ID Test ACCURACY: 0.6757
ID Test Loss: 0.8848
OOD Validation ACCURACY: 0.3387
OOD Validation Loss: 1.1799
OOD Test ACCURACY: 0.5467
OOD Test Loss: 0.8602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 0.5163
Train Loss: 1.2847
ID Validation ACCURACY: 0.5163
ID Validation Loss: 1.3363
ID Test ACCURACY: 0.5163
ID Test Loss: 1.3361
OOD Validation ACCURACY: 0.6937
OOD Validation Loss: 0.7726
OOD Test ACCURACY: 0.6027
OOD Test Loss: 0.9304

[0m[1;37mINFO[0m: [1mChartInfo 0.6757 0.5467 0.5163 0.6027 0.5163 0.6937[0mId_val ACCURACY: 0.6720Id_val Loss: 0.8802
Id_test ACCURACY: 0.6757Id_test Loss: 0.8848
Test ACCURACY: 0.5467Test Loss: 0.8602


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:41:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:41:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.7740
Train Loss: 0.6713
ID Validation ACCURACY: 0.7883
ID Validation Loss: 0.6566
ID Test ACCURACY: 0.7730
ID Test Loss: 0.7012
OOD Validation ACCURACY: 0.4643
OOD Validation Loss: 1.2859
OOD Test ACCURACY: 0.7057
OOD Test Loss: 0.6370

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.6974
Train Loss: 0.7951
ID Validation ACCURACY: 0.7197
ID Validation Loss: 0.7468
ID Test ACCURACY: 0.7103
ID Test Loss: 0.8074
OOD Validation ACCURACY: 0.6740
OOD Validation Loss: 0.8290
OOD Test ACCURACY: 0.6273
OOD Test Loss: 0.9364

[0m[1;37mINFO[0m: [1mChartInfo 0.7730 0.7057 0.7103 0.6273 0.7197 0.6740[0mId_val ACCURACY: 0.7883Id_val Loss: 0.6566
Id_test ACCURACY: 0.7730Id_test Loss: 0.7012
Test ACCURACY: 0.7057Test Loss: 0.6370


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:41:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:41:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.6885
Train Loss: 0.8644
ID Validation ACCURACY: 0.6977
ID Validation Loss: 0.8397
ID Test ACCURACY: 0.6903
ID Test Loss: 0.8483
OOD Validation ACCURACY: 0.5057
OOD Validation Loss: 1.1208
OOD Test ACCURACY: 0.6890
OOD Test Loss: 0.8000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 78...
[0m[1;37mINFO[0m: [1mCheckpoint 78: 
-----------------------------------
Train ACCURACY: 0.4692
Train Loss: 1.2687
ID Validation ACCURACY: 0.4743
ID Validation Loss: 1.2830
ID Test ACCURACY: 0.4663
ID Test Loss: 1.2951
OOD Validation ACCURACY: 0.6260
OOD Validation Loss: 0.8764
OOD Test ACCURACY: 0.3913
OOD Test Loss: 1.4173

[0m[1;37mINFO[0m: [1mChartInfo 0.6903 0.6890 0.4663 0.3913 0.4743 0.6260[0mId_val ACCURACY: 0.6977Id_val Loss: 0.8397
Id_test ACCURACY: 0.6903Id_test Loss: 0.8483
Test ACCURACY: 0.6890Test Loss: 0.8000


Final accuracies: 
ID_VAL     = 0.714 +- 0.039
ID_TEST    = 0.706 +- 0.034
TEST       = 0.636 +- 0.085

Final losses: 
ID_VAL     = 0.7858 +- 0.0844
ID_TEST    = 0.8075 +- 0.0675
TEST       = 0.8181 +- 0.1274
Diff id_val-test  = 0.0322 
DONE TRAIN GSAT GOODMotif2/basis hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:41:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:41:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.3520
Train Loss: 4.1012
ID Validation ACCURACY: 0.3500
ID Validation Loss: 4.1593
ID Test ACCURACY: 0.3524
ID Test Loss: 4.1588
OOD Validation ACCURACY: 0.3167
OOD Validation Loss: 6.5550
OOD Test ACCURACY: 0.1637
OOD Test Loss: 33.3198

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.3520
Train Loss: 4.1012
ID Validation ACCURACY: 0.3500
ID Validation Loss: 4.1593
ID Test ACCURACY: 0.3524
ID Test Loss: 4.1588
OOD Validation ACCURACY: 0.3167
OOD Validation Loss: 6.5550
OOD Test ACCURACY: 0.1637
OOD Test Loss: 33.3198

[0m[1;37mINFO[0m: [1mChartInfo 0.3524 0.1637 0.3524 0.1637 0.3500 0.3167[0mId_val ACCURACY: 0.3564Id_val Loss: 4.1339
Id_test ACCURACY: 0.3561Id_test Loss: 4.1454
Test ACCURACY: 0.1639Test Loss: 34.8937


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:42:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:42:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.4144
Train Loss: 2.4823
ID Validation ACCURACY: 0.4157
ID Validation Loss: 2.5162
ID Test ACCURACY: 0.4114
ID Test Loss: 2.4803
OOD Validation ACCURACY: 0.3104
OOD Validation Loss: 6.7585
OOD Test ACCURACY: 0.1446
OOD Test Loss: 41.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.2914
Train Loss: 3.5159
ID Validation ACCURACY: 0.2877
ID Validation Loss: 3.5219
ID Test ACCURACY: 0.2904
ID Test Loss: 3.4864
OOD Validation ACCURACY: 0.3116
OOD Validation Loss: 9.4187
OOD Test ACCURACY: 0.1699
OOD Test Loss: 50.5791

[0m[1;37mINFO[0m: [1mChartInfo 0.4114 0.1446 0.2904 0.1699 0.2877 0.3116[0mId_val ACCURACY: 0.4224Id_val Loss: 2.4381
Id_test ACCURACY: 0.4144Id_test Loss: 2.5086
Test ACCURACY: 0.1483Test Loss: 40.3337


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:42:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:42:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.3567
Train Loss: 3.2947
ID Validation ACCURACY: 0.3594
ID Validation Loss: 3.2787
ID Test ACCURACY: 0.3510
ID Test Loss: 3.2852
OOD Validation ACCURACY: 0.3019
OOD Validation Loss: 3.8731
OOD Test ACCURACY: 0.1820
OOD Test Loss: 4.9479

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.3426
Train Loss: 2.6924
ID Validation ACCURACY: 0.3353
ID Validation Loss: 2.7255
ID Test ACCURACY: 0.3387
ID Test Loss: 2.7041
OOD Validation ACCURACY: 0.3136
OOD Validation Loss: 2.9546
OOD Test ACCURACY: 0.1916
OOD Test Loss: 4.1809

[0m[1;37mINFO[0m: [1mChartInfo 0.3510 0.1820 0.3387 0.1916 0.3353 0.3136[0mId_val ACCURACY: 0.3526Id_val Loss: 3.2744
Id_test ACCURACY: 0.3604Id_test Loss: 3.3012
Test ACCURACY: 0.1820Test Loss: 4.9627


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:43:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:43:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.3909
Train Loss: 2.8134
ID Validation ACCURACY: 0.4021
ID Validation Loss: 2.7741
ID Test ACCURACY: 0.3860
ID Test Loss: 2.8356
OOD Validation ACCURACY: 0.3126
OOD Validation Loss: 4.1696
OOD Test ACCURACY: 0.2140
OOD Test Loss: 12.2054

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.3350
Train Loss: 4.2162
ID Validation ACCURACY: 0.3359
ID Validation Loss: 4.3002
ID Test ACCURACY: 0.3386
ID Test Loss: 4.2674
OOD Validation ACCURACY: 0.3293
OOD Validation Loss: 8.2922
OOD Test ACCURACY: 0.1864
OOD Test Loss: 53.4631

[0m[1;37mINFO[0m: [1mChartInfo 0.3860 0.2140 0.3386 0.1864 0.3359 0.3293[0mId_val ACCURACY: 0.3931Id_val Loss: 2.7777
Id_test ACCURACY: 0.3841Id_test Loss: 2.7834
Test ACCURACY: 0.2086Test Loss: 12.7388


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:43:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:43:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.3832
Train Loss: 3.2781
ID Validation ACCURACY: 0.3854
ID Validation Loss: 3.3077
ID Test ACCURACY: 0.3756
ID Test Loss: 3.3515
OOD Validation ACCURACY: 0.2441
OOD Validation Loss: 6.2321
OOD Test ACCURACY: 0.1736
OOD Test Loss: 8.2136

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.3804
Train Loss: 3.3525
ID Validation ACCURACY: 0.3771
ID Validation Loss: 3.3880
ID Test ACCURACY: 0.3827
ID Test Loss: 3.3628
OOD Validation ACCURACY: 0.3297
OOD Validation Loss: 4.5238
OOD Test ACCURACY: 0.2149
OOD Test Loss: 6.5520

[0m[1;37mINFO[0m: [1mChartInfo 0.3756 0.1736 0.3827 0.2149 0.3771 0.3297[0mId_val ACCURACY: 0.3884Id_val Loss: 3.2394
Id_test ACCURACY: 0.3821Id_test Loss: 3.2972
Test ACCURACY: 0.1683Test Loss: 8.2310


Final accuracies: 
ID_VAL     = 0.383 +- 0.026
ID_TEST    = 0.379 +- 0.021
TEST       = 0.174 +- 0.020

Final losses: 
ID_VAL     = 3.1727 +- 0.5717
ID_TEST    = 3.2072 +- 0.5594
TEST       = 20.2320 +- 14.5077
Diff id_val-test  = 17.0593 
DONE TRAIN GSAT GOODCMNIST/color hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:44:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:44:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9219
Train Loss: 0.2433
ID Validation ROC-AUC: 0.9005
ID Validation Loss: 0.2836
ID Test ROC-AUC: 0.9006
ID Test Loss: 0.2830
OOD Validation ROC-AUC: 0.6415
OOD Validation Loss: 0.5290
OOD Test ROC-AUC: 0.6998
OOD Test Loss: 0.6406

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ROC-AUC: 0.8862
Train Loss: 0.2825
ID Validation ROC-AUC: 0.8721
ID Validation Loss: 0.3043
ID Test ROC-AUC: 0.8739
ID Test Loss: 0.3017
OOD Validation ROC-AUC: 0.6708
OOD Validation Loss: 0.4663
OOD Test ROC-AUC: 0.6892
OOD Test Loss: 0.5869

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.6998 0.8739 0.6892 0.8721 0.6708[0mId_val ROC-AUC: 0.9005Id_val Loss: 0.2836
Id_test ROC-AUC: 0.9006Id_test Loss: 0.2830
Test ROC-AUC: 0.6998Test Loss: 0.6406


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:44:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:44:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ROC-AUC: 0.9224
Train Loss: 0.2417
ID Validation ROC-AUC: 0.9030
ID Validation Loss: 0.2771
ID Test ROC-AUC: 0.9024
ID Test Loss: 0.2775
OOD Validation ROC-AUC: 0.6469
OOD Validation Loss: 0.5210
OOD Test ROC-AUC: 0.6993
OOD Test Loss: 0.6134

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ROC-AUC: 0.8995
Train Loss: 0.2912
ID Validation ROC-AUC: 0.8814
ID Validation Loss: 0.3229
ID Test ROC-AUC: 0.8856
ID Test Loss: 0.3231
OOD Validation ROC-AUC: 0.6688
OOD Validation Loss: 0.3630
OOD Test ROC-AUC: 0.6979
OOD Test Loss: 0.6124

[0m[1;37mINFO[0m: [1mChartInfo 0.9024 0.6993 0.8856 0.6979 0.8814 0.6688[0mId_val ROC-AUC: 0.9030Id_val Loss: 0.2771
Id_test ROC-AUC: 0.9024Id_test Loss: 0.2775
Test ROC-AUC: 0.6993Test Loss: 0.6134


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:44:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:44:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ROC-AUC: 0.9160
Train Loss: 0.2563
ID Validation ROC-AUC: 0.8983
ID Validation Loss: 0.2916
ID Test ROC-AUC: 0.8976
ID Test Loss: 0.2924
OOD Validation ROC-AUC: 0.6457
OOD Validation Loss: 0.5279
OOD Test ROC-AUC: 0.7031
OOD Test Loss: 0.6410

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ROC-AUC: 0.8843
Train Loss: 0.2917
ID Validation ROC-AUC: 0.8698
ID Validation Loss: 0.3179
ID Test ROC-AUC: 0.8731
ID Test Loss: 0.3116
OOD Validation ROC-AUC: 0.6741
OOD Validation Loss: 0.4275
OOD Test ROC-AUC: 0.6836
OOD Test Loss: 0.6310

[0m[1;37mINFO[0m: [1mChartInfo 0.8976 0.7031 0.8731 0.6836 0.8698 0.6741[0mId_val ROC-AUC: 0.8983Id_val Loss: 0.2916
Id_test ROC-AUC: 0.8976Id_test Loss: 0.2924
Test ROC-AUC: 0.7031Test Loss: 0.6410


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:44:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:44:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ROC-AUC: 0.9203
Train Loss: 0.2616
ID Validation ROC-AUC: 0.8992
ID Validation Loss: 0.3023
ID Test ROC-AUC: 0.8991
ID Test Loss: 0.3012
OOD Validation ROC-AUC: 0.6438
OOD Validation Loss: 0.5717
OOD Test ROC-AUC: 0.7015
OOD Test Loss: 0.6695

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ROC-AUC: 0.8698
Train Loss: 0.3086
ID Validation ROC-AUC: 0.8607
ID Validation Loss: 0.3199
ID Test ROC-AUC: 0.8667
ID Test Loss: 0.3140
OOD Validation ROC-AUC: 0.6746
OOD Validation Loss: 0.4525
OOD Test ROC-AUC: 0.6941
OOD Test Loss: 0.5667

[0m[1;37mINFO[0m: [1mChartInfo 0.8991 0.7015 0.8667 0.6941 0.8607 0.6746[0mId_val ROC-AUC: 0.8992Id_val Loss: 0.3023
Id_test ROC-AUC: 0.8991Id_test Loss: 0.3012
Test ROC-AUC: 0.7015Test Loss: 0.6695


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:45:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:45:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ROC-AUC: 0.9212
Train Loss: 0.2580
ID Validation ROC-AUC: 0.9021
ID Validation Loss: 0.2945
ID Test ROC-AUC: 0.9029
ID Test Loss: 0.2921
OOD Validation ROC-AUC: 0.6499
OOD Validation Loss: 0.5617
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.6597

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ROC-AUC: 0.8981
Train Loss: 0.2656
ID Validation ROC-AUC: 0.8784
ID Validation Loss: 0.3013
ID Test ROC-AUC: 0.8854
ID Test Loss: 0.2911
OOD Validation ROC-AUC: 0.6706
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.6942
OOD Test Loss: 0.5938

[0m[1;37mINFO[0m: [1mChartInfo 0.9029 0.7014 0.8854 0.6942 0.8784 0.6706[0mId_val ROC-AUC: 0.9021Id_val Loss: 0.2945
Id_test ROC-AUC: 0.9029Id_test Loss: 0.2921
Test ROC-AUC: 0.7014Test Loss: 0.6597


Final accuracies: 
ID_VAL     = 0.901 +- 0.002
ID_TEST    = 0.901 +- 0.002
TEST       = 0.701 +- 0.001

Final losses: 
ID_VAL     = 0.2898 +- 0.0087
ID_TEST    = 0.2892 +- 0.0082
TEST       = 0.6449 +- 0.0192
Diff id_val-test  = 0.3550 
DONE TRAIN GSAT LBAPcore/assay hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:45:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:45:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.8946
Train Loss: 0.2294
ID Validation ACCURACY: 0.8451
ID Validation Loss: 0.4596
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4928
OOD Validation ACCURACY: 0.8442
OOD Validation Loss: 0.7055
OOD Test ACCURACY: 0.7909
OOD Test Loss: 1.2081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ACCURACY: 0.8613
Train Loss: 0.3029
ID Validation ACCURACY: 0.8268
ID Validation Loss: 0.4327
ID Test ACCURACY: 0.8231
ID Test Loss: 0.4451
OOD Validation ACCURACY: 0.8502
OOD Validation Loss: 0.5097
OOD Test ACCURACY: 0.8121
OOD Test Loss: 0.6943

[0m[1;37mINFO[0m: [1mChartInfo 0.8359 0.7909 0.8231 0.8121 0.8268 0.8502[0mId_val ACCURACY: 0.8451Id_val Loss: 0.4596
Id_test ACCURACY: 0.8359Id_test Loss: 0.4928
Test ACCURACY: 0.7909Test Loss: 1.2081


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:45:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:45:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:45:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.1959
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5034
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5283
OOD Validation ACCURACY: 0.8458
OOD Validation Loss: 0.8693
OOD Test ACCURACY: 0.8026
OOD Test Loss: 1.3095

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.8494
Train Loss: 0.3303
ID Validation ACCURACY: 0.8246
ID Validation Loss: 0.3965
ID Test ACCURACY: 0.8274
ID Test Loss: 0.4033
OOD Validation ACCURACY: 0.8494
OOD Validation Loss: 0.3884
OOD Test ACCURACY: 0.8215
OOD Test Loss: 0.4617

[0m[1;37mINFO[0m: [1mChartInfo 0.8380 0.8026 0.8274 0.8215 0.8246 0.8494[0mId_val ACCURACY: 0.8449Id_val Loss: 0.5034
Id_test ACCURACY: 0.8380Id_test Loss: 0.5283
Test ACCURACY: 0.8026Test Loss: 1.3095


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.1496
ID Validation ACCURACY: 0.8449
ID Validation Loss: 0.5913
ID Test ACCURACY: 0.8447
ID Test Loss: 0.5983
OOD Validation ACCURACY: 0.8434
OOD Validation Loss: 0.9268
OOD Test ACCURACY: 0.7956
OOD Test Loss: 1.1860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ACCURACY: 0.8865
Train Loss: 0.2502
ID Validation ACCURACY: 0.8387
ID Validation Loss: 0.4508
ID Test ACCURACY: 0.8359
ID Test Loss: 0.4682
OOD Validation ACCURACY: 0.8523
OOD Validation Loss: 0.5568
OOD Test ACCURACY: 0.8184
OOD Test Loss: 0.7482

[0m[1;37mINFO[0m: [1mChartInfo 0.8447 0.7956 0.8359 0.8184 0.8387 0.8523[0mId_val ACCURACY: 0.8449Id_val Loss: 0.5913
Id_test ACCURACY: 0.8447Id_test Loss: 0.5983
Test ACCURACY: 0.7956Test Loss: 1.1860


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.8962
Train Loss: 0.2153
ID Validation ACCURACY: 0.8427
ID Validation Loss: 0.4803
ID Test ACCURACY: 0.8374
ID Test Loss: 0.4933
OOD Validation ACCURACY: 0.8439
OOD Validation Loss: 0.7998
OOD Test ACCURACY: 0.7991
OOD Test Loss: 1.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.8763
Train Loss: 0.2680
ID Validation ACCURACY: 0.8308
ID Validation Loss: 0.4440
ID Test ACCURACY: 0.8295
ID Test Loss: 0.4615
OOD Validation ACCURACY: 0.8541
OOD Validation Loss: 0.6125
OOD Test ACCURACY: 0.8222
OOD Test Loss: 0.7056

[0m[1;37mINFO[0m: [1mChartInfo 0.8374 0.7991 0.8295 0.8222 0.8308 0.8541[0mId_val ACCURACY: 0.8427Id_val Loss: 0.4803
Id_test ACCURACY: 0.8374Id_test Loss: 0.4933
Test ACCURACY: 0.7991Test Loss: 1.0971


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9018
Train Loss: 0.2011
ID Validation ACCURACY: 0.8468
ID Validation Loss: 0.5144
ID Test ACCURACY: 0.8415
ID Test Loss: 0.5419
OOD Validation ACCURACY: 0.8424
OOD Validation Loss: 0.9462
OOD Test ACCURACY: 0.7918
OOD Test Loss: 1.4711

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.8617
Train Loss: 0.3062
ID Validation ACCURACY: 0.8221
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8200
ID Test Loss: 0.4485
OOD Validation ACCURACY: 0.8539
OOD Validation Loss: 0.4468
OOD Test ACCURACY: 0.8237
OOD Test Loss: 0.5712

[0m[1;37mINFO[0m: [1mChartInfo 0.8415 0.7918 0.8200 0.8237 0.8221 0.8539[0mId_val ACCURACY: 0.8468Id_val Loss: 0.5144
Id_test ACCURACY: 0.8415Id_test Loss: 0.5419
Test ACCURACY: 0.7918Test Loss: 1.4711


Final accuracies: 
ID_VAL     = 0.845 +- 0.001
ID_TEST    = 0.840 +- 0.003
TEST       = 0.796 +- 0.004

Final losses: 
ID_VAL     = 0.5098 +- 0.0449
ID_TEST    = 0.5309 +- 0.0388
TEST       = 1.2544 +- 0.1277
Diff id_val-test  = 0.7446 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN GSAT GOODSST2/length hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6877
ID Validation Loss: 3.0407
ID Test ACCURACY: 0.6661
ID Test Loss: 3.2248
OOD Validation ACCURACY: 0.5972
OOD Validation Loss: 3.5529
OOD Test ACCURACY: 0.5367
OOD Test Loss: 4.2839

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0041
ID Validation ACCURACY: 0.6697
ID Validation Loss: 3.3240
ID Test ACCURACY: 0.6679
ID Test Loss: 3.3535
OOD Validation ACCURACY: 0.6101
OOD Validation Loss: 3.3846
OOD Test ACCURACY: 0.5642
OOD Test Loss: 3.7116

[0m[1;37mINFO[0m: [1mChartInfo 0.6661 0.5367 0.6679 0.5642 0.6697 0.6101[0mId_val ACCURACY: 0.6877Id_val Loss: 3.0407
Id_test ACCURACY: 0.6661Id_test Loss: 3.2248
Test ACCURACY: 0.5367Test Loss: 4.2839


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 157...
[0m[1;37mINFO[0m: [1mCheckpoint 157: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6895
ID Validation Loss: 4.0211
ID Test ACCURACY: 0.6300
ID Test Loss: 3.9427
OOD Validation ACCURACY: 0.5832
OOD Validation Loss: 3.7787
OOD Test ACCURACY: 0.5635
OOD Test Loss: 4.3822

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6787
ID Validation Loss: 3.5222
ID Test ACCURACY: 0.6534
ID Test Loss: 3.4855
OOD Validation ACCURACY: 0.6230
OOD Validation Loss: 3.2861
OOD Test ACCURACY: 0.5477
OOD Test Loss: 3.9053

[0m[1;37mINFO[0m: [1mChartInfo 0.6300 0.5635 0.6534 0.5477 0.6787 0.6230[0mId_val ACCURACY: 0.6895Id_val Loss: 4.0211
Id_test ACCURACY: 0.6300Id_test Loss: 3.9427
Test ACCURACY: 0.5635Test Loss: 4.3822


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6751
ID Validation Loss: 3.4008
ID Test ACCURACY: 0.6498
ID Test Loss: 3.5024
OOD Validation ACCURACY: 0.5882
OOD Validation Loss: 3.5451
OOD Test ACCURACY: 0.5669
OOD Test Loss: 3.8004

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6606
ID Validation Loss: 2.9431
ID Test ACCURACY: 0.6480
ID Test Loss: 3.2333
OOD Validation ACCURACY: 0.6056
OOD Validation Loss: 2.9688
OOD Test ACCURACY: 0.5607
OOD Test Loss: 3.3583

[0m[1;37mINFO[0m: [1mChartInfo 0.6498 0.5669 0.6480 0.5607 0.6606 0.6056[0mId_val ACCURACY: 0.6751Id_val Loss: 3.4008
Id_test ACCURACY: 0.6498Id_test Loss: 3.5024
Test ACCURACY: 0.5669Test Loss: 3.8004


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6841
ID Validation Loss: 3.9650
ID Test ACCURACY: 0.6480
ID Test Loss: 4.0392
OOD Validation ACCURACY: 0.5955
OOD Validation Loss: 4.0912
OOD Test ACCURACY: 0.5422
OOD Test Loss: 4.6949

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6588
ID Validation Loss: 3.7182
ID Test ACCURACY: 0.6787
ID Test Loss: 3.3927
OOD Validation ACCURACY: 0.6174
OOD Validation Loss: 3.7005
OOD Test ACCURACY: 0.5546
OOD Test Loss: 4.1786

[0m[1;37mINFO[0m: [1mChartInfo 0.6480 0.5422 0.6787 0.5546 0.6588 0.6174[0mId_val ACCURACY: 0.6841Id_val Loss: 3.9650
Id_test ACCURACY: 0.6480Id_test Loss: 4.0392
Test ACCURACY: 0.5422Test Loss: 4.6949


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:46:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:46:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 0.6841
ID Validation Loss: 3.3700
ID Test ACCURACY: 0.6408
ID Test Loss: 3.6060
OOD Validation ACCURACY: 0.6106
OOD Validation Loss: 3.5388
OOD Test ACCURACY: 0.5456
OOD Test Loss: 4.0838

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.6552
ID Validation Loss: 2.6488
ID Test ACCURACY: 0.6444
ID Test Loss: 2.8878
OOD Validation ACCURACY: 0.6162
OOD Validation Loss: 2.8389
OOD Test ACCURACY: 0.5340
OOD Test Loss: 3.5982

[0m[1;37mINFO[0m: [1mChartInfo 0.6408 0.5456 0.6444 0.5340 0.6552 0.6162[0mId_val ACCURACY: 0.6841Id_val Loss: 3.3700
Id_test ACCURACY: 0.6408Id_test Loss: 3.6060
Test ACCURACY: 0.5456Test Loss: 4.0838


Final accuracies: 
ID_VAL     = 0.684 +- 0.005
ID_TEST    = 0.647 +- 0.012
TEST       = 0.551 +- 0.012

Final losses: 
ID_VAL     = 3.5595 +- 0.3762
ID_TEST    = 3.6630 +- 0.2969
TEST       = 4.2490 +- 0.2988
Diff id_val-test  = 0.6895 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN GSAT GOODTwitter/length hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.6978
Train Loss: 0.8178
ID Validation ACCURACY: 0.7073
ID Validation Loss: 0.8153
ID Test ACCURACY: 0.7103
ID Test Loss: 0.7832
OOD Validation ACCURACY: 0.5293
OOD Validation Loss: 4.3988
OOD Test ACCURACY: 0.7053
OOD Test Loss: 0.8200

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.5981
Train Loss: 1.5295
ID Validation ACCURACY: 0.6107
ID Validation Loss: 1.4661
ID Test ACCURACY: 0.6133
ID Test Loss: 1.4754
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.6360
OOD Test ACCURACY: 0.8323
OOD Test Loss: 0.5349

[0m[1;37mINFO[0m: [1mChartInfo 0.7103 0.7053 0.6133 0.8323 0.6107 0.9293[0mId_val ACCURACY: 0.7073Id_val Loss: 0.8153
Id_test ACCURACY: 0.7103Id_test Loss: 0.7832
Test ACCURACY: 0.7053Test Loss: 0.8200


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 55...
[0m[1;37mINFO[0m: [1mCheckpoint 55: 
-----------------------------------
Train ACCURACY: 0.6576
Train Loss: 1.1793
ID Validation ACCURACY: 0.6677
ID Validation Loss: 1.1576
ID Test ACCURACY: 0.6633
ID Test Loss: 1.1636
OOD Validation ACCURACY: 0.9090
OOD Validation Loss: 0.5521
OOD Test ACCURACY: 0.6873
OOD Test Loss: 0.8331

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.6379
Train Loss: 1.1194
ID Validation ACCURACY: 0.6470
ID Validation Loss: 1.0736
ID Test ACCURACY: 0.6483
ID Test Loss: 1.0711
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.4564
OOD Test ACCURACY: 0.7453
OOD Test Loss: 0.6907

[0m[1;37mINFO[0m: [1mChartInfo 0.6633 0.6873 0.6483 0.7453 0.6470 0.9297[0mId_val ACCURACY: 0.6677Id_val Loss: 1.1576
Id_test ACCURACY: 0.6633Id_test Loss: 1.1636
Test ACCURACY: 0.6873Test Loss: 0.8331


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.6217
Train Loss: 1.0116
ID Validation ACCURACY: 0.6153
ID Validation Loss: 0.9939
ID Test ACCURACY: 0.6220
ID Test Loss: 1.0031
OOD Validation ACCURACY: 0.3637
OOD Validation Loss: 1.7772
OOD Test ACCURACY: 0.3713
OOD Test Loss: 1.3965

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.4042
Train Loss: 1.5028
ID Validation ACCURACY: 0.4107
ID Validation Loss: 1.4701
ID Test ACCURACY: 0.4163
ID Test Loss: 1.4716
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.4579
OOD Test ACCURACY: 0.7133
OOD Test Loss: 0.7982

[0m[1;37mINFO[0m: [1mChartInfo 0.6220 0.3713 0.4163 0.7133 0.4107 0.9297[0mId_val ACCURACY: 0.6153Id_val Loss: 0.9939
Id_test ACCURACY: 0.6220Id_test Loss: 1.0031
Test ACCURACY: 0.3713Test Loss: 1.3965


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.6936
Train Loss: 1.0310
ID Validation ACCURACY: 0.6920
ID Validation Loss: 1.0685
ID Test ACCURACY: 0.6947
ID Test Loss: 1.0131
OOD Validation ACCURACY: 0.3340
OOD Validation Loss: 4.6738
OOD Test ACCURACY: 0.4180
OOD Test Loss: 1.3806

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.4467
Train Loss: 1.2594
ID Validation ACCURACY: 0.4403
ID Validation Loss: 1.2612
ID Test ACCURACY: 0.4583
ID Test Loss: 1.2354
OOD Validation ACCURACY: 0.9253
OOD Validation Loss: 0.5541
OOD Test ACCURACY: 0.3493
OOD Test Loss: 1.3955

[0m[1;37mINFO[0m: [1mChartInfo 0.6947 0.4180 0.4583 0.3493 0.4403 0.9253[0mId_val ACCURACY: 0.6920Id_val Loss: 1.0685
Id_test ACCURACY: 0.6947Id_test Loss: 1.0131
Test ACCURACY: 0.4180Test Loss: 1.3806


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.7152
Train Loss: 1.0120
ID Validation ACCURACY: 0.7130
ID Validation Loss: 0.9707
ID Test ACCURACY: 0.7370
ID Test Loss: 0.9485
OOD Validation ACCURACY: 0.8773
OOD Validation Loss: 0.5091
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.4013

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.5879
Train Loss: 1.6555
ID Validation ACCURACY: 0.5947
ID Validation Loss: 1.6052
ID Test ACCURACY: 0.6073
ID Test Loss: 1.5892
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.7251
OOD Test ACCURACY: 0.8343
OOD Test Loss: 0.5963

[0m[1;37mINFO[0m: [1mChartInfo 0.7370 0.9243 0.6073 0.8343 0.5947 0.9300[0mId_val ACCURACY: 0.7130Id_val Loss: 0.9707
Id_test ACCURACY: 0.7370Id_test Loss: 0.9485
Test ACCURACY: 0.9243Test Loss: 0.4013


Final accuracies: 
ID_VAL     = 0.679 +- 0.036
ID_TEST    = 0.685 +- 0.040
TEST       = 0.621 +- 0.204

Final losses: 
ID_VAL     = 1.0012 +- 0.1136
ID_TEST    = 0.9823 +- 0.1225
TEST       = 0.9663 +- 0.3782
Diff id_val-test  = 0.0349 
DONE TRAIN GSAT GOODMotif/basis hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.7197
Train Loss: 0.7820
ID Validation ACCURACY: 0.7167
ID Validation Loss: 0.7473
ID Test ACCURACY: 0.7263
ID Test Loss: 0.7804
OOD Validation ACCURACY: 0.4943
OOD Validation Loss: 1.4449
OOD Test ACCURACY: 0.3717
OOD Test Loss: 6.8538

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 52...
[0m[1;37mINFO[0m: [1mCheckpoint 52: 
-----------------------------------
Train ACCURACY: 0.6988
Train Loss: 0.9173
ID Validation ACCURACY: 0.7097
ID Validation Loss: 0.8609
ID Test ACCURACY: 0.7137
ID Test Loss: 0.8967
OOD Validation ACCURACY: 0.6590
OOD Validation Loss: 1.0066
OOD Test ACCURACY: 0.4037
OOD Test Loss: 1.9222

[0m[1;37mINFO[0m: [1mChartInfo 0.7263 0.3717 0.7137 0.4037 0.7097 0.6590[0mId_val ACCURACY: 0.7167Id_val Loss: 0.7473
Id_test ACCURACY: 0.7263Id_test Loss: 0.7804
Test ACCURACY: 0.3717Test Loss: 6.8538


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.7800
Train Loss: 0.6829
ID Validation ACCURACY: 0.7807
ID Validation Loss: 0.6494
ID Test ACCURACY: 0.7813
ID Test Loss: 0.6898
OOD Validation ACCURACY: 0.5450
OOD Validation Loss: 1.2229
OOD Test ACCURACY: 0.3953
OOD Test Loss: 2.7475

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.7662
Train Loss: 0.7588
ID Validation ACCURACY: 0.7690
ID Validation Loss: 0.7299
ID Test ACCURACY: 0.7800
ID Test Loss: 0.7629
OOD Validation ACCURACY: 0.5940
OOD Validation Loss: 1.1164
OOD Test ACCURACY: 0.3670
OOD Test Loss: 4.3641

[0m[1;37mINFO[0m: [1mChartInfo 0.7813 0.3953 0.7800 0.3670 0.7690 0.5940[0mId_val ACCURACY: 0.7807Id_val Loss: 0.6494
Id_test ACCURACY: 0.7813Id_test Loss: 0.6898
Test ACCURACY: 0.3953Test Loss: 2.7475


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 71...
[0m[1;37mINFO[0m: [1mCheckpoint 71: 
-----------------------------------
Train ACCURACY: 0.7691
Train Loss: 0.7874
ID Validation ACCURACY: 0.7797
ID Validation Loss: 0.7486
ID Test ACCURACY: 0.7787
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.6203
OOD Validation Loss: 1.0268
OOD Test ACCURACY: 0.3957
OOD Test Loss: 2.4402

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 71...
[0m[1;37mINFO[0m: [1mCheckpoint 71: 
-----------------------------------
Train ACCURACY: 0.7691
Train Loss: 0.7874
ID Validation ACCURACY: 0.7797
ID Validation Loss: 0.7486
ID Test ACCURACY: 0.7787
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.6203
OOD Validation Loss: 1.0268
OOD Test ACCURACY: 0.3957
OOD Test Loss: 2.4402

[0m[1;37mINFO[0m: [1mChartInfo 0.7787 0.3957 0.7787 0.3957 0.7797 0.6203[0mId_val ACCURACY: 0.7797Id_val Loss: 0.7486
Id_test ACCURACY: 0.7787Id_test Loss: 0.7782
Test ACCURACY: 0.3957Test Loss: 2.4402


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.7937
Train Loss: 0.7235
ID Validation ACCURACY: 0.7980
ID Validation Loss: 0.6911
ID Test ACCURACY: 0.8007
ID Test Loss: 0.7069
OOD Validation ACCURACY: 0.5993
OOD Validation Loss: 0.9847
OOD Test ACCURACY: 0.3377
OOD Test Loss: 1.5111

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.6588
Train Loss: 1.0386
ID Validation ACCURACY: 0.6667
ID Validation Loss: 1.0173
ID Test ACCURACY: 0.6580
ID Test Loss: 1.0129
OOD Validation ACCURACY: 0.6160
OOD Validation Loss: 1.5710
OOD Test ACCURACY: 0.4370
OOD Test Loss: 2.5924

[0m[1;37mINFO[0m: [1mChartInfo 0.8007 0.3377 0.6580 0.4370 0.6667 0.6160[0mId_val ACCURACY: 0.7980Id_val Loss: 0.6911
Id_test ACCURACY: 0.8007Id_test Loss: 0.7069
Test ACCURACY: 0.3377Test Loss: 1.5111


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:47:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:47:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.7828
Train Loss: 0.7860
ID Validation ACCURACY: 0.7877
ID Validation Loss: 0.7713
ID Test ACCURACY: 0.7937
ID Test Loss: 0.7787
OOD Validation ACCURACY: 0.4320
OOD Validation Loss: 1.0457
OOD Test ACCURACY: 0.3123
OOD Test Loss: 2.1943

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.7738
Train Loss: 0.6598
ID Validation ACCURACY: 0.7807
ID Validation Loss: 0.6297
ID Test ACCURACY: 0.7767
ID Test Loss: 0.6571
OOD Validation ACCURACY: 0.6107
OOD Validation Loss: 0.9966
OOD Test ACCURACY: 0.3437
OOD Test Loss: 2.6551

[0m[1;37mINFO[0m: [1mChartInfo 0.7937 0.3123 0.7767 0.3437 0.7807 0.6107[0mId_val ACCURACY: 0.7877Id_val Loss: 0.7713
Id_test ACCURACY: 0.7937Id_test Loss: 0.7787
Test ACCURACY: 0.3123Test Loss: 2.1943


Final accuracies: 
ID_VAL     = 0.773 +- 0.029
ID_TEST    = 0.776 +- 0.026
TEST       = 0.363 +- 0.033

Final losses: 
ID_VAL     = 0.7215 +- 0.0447
ID_TEST    = 0.7468 +- 0.0399
TEST       = 3.1494 +- 1.8965
Diff id_val-test  = 2.4278 
DONE TRAIN GSAT GOODMotif/size hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:48:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:48:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.8554
Train Loss: 0.4338
ID Validation ROC-AUC: 0.8168
ID Validation Loss: 0.4661
ID Test ROC-AUC: 0.8029
ID Test Loss: 0.4748
OOD Validation ROC-AUC: 0.7182
OOD Validation Loss: 0.7766
OOD Test ROC-AUC: 0.6901
OOD Test Loss: 0.4975

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.8166
Train Loss: 0.1397
ID Validation ROC-AUC: 0.7736
ID Validation Loss: 0.1728
ID Test ROC-AUC: 0.7581
ID Test Loss: 0.1493
OOD Validation ROC-AUC: 0.7639
OOD Validation Loss: 0.1526
OOD Test ROC-AUC: 0.6632
OOD Test Loss: 0.1138

[0m[1;37mINFO[0m: [1mChartInfo 0.8029 0.6901 0.7581 0.6632 0.7736 0.7639[0mId_val ROC-AUC: 0.8168Id_val Loss: 0.4661
Id_test ROC-AUC: 0.8029Id_test Loss: 0.4748
Test ROC-AUC: 0.6901Test Loss: 0.4975


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:48:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:48:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ROC-AUC: 0.8823
Train Loss: 0.1330
ID Validation ROC-AUC: 0.8155
ID Validation Loss: 0.1790
ID Test ROC-AUC: 0.8073
ID Test Loss: 0.1630
OOD Validation ROC-AUC: 0.7386
OOD Validation Loss: 0.2770
OOD Test ROC-AUC: 0.6827
OOD Test Loss: 0.1716

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.8034
Train Loss: 0.1680
ID Validation ROC-AUC: 0.7835
ID Validation Loss: 0.1884
ID Test ROC-AUC: 0.7716
ID Test Loss: 0.1649
OOD Validation ROC-AUC: 0.7634
OOD Validation Loss: 0.2424
OOD Test ROC-AUC: 0.6550
OOD Test Loss: 0.1592

[0m[1;37mINFO[0m: [1mChartInfo 0.8073 0.6827 0.7716 0.6550 0.7835 0.7634[0mId_val ROC-AUC: 0.8155Id_val Loss: 0.1790
Id_test ROC-AUC: 0.8073Id_test Loss: 0.1630
Test ROC-AUC: 0.6827Test Loss: 0.1716


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:48:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:48:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.8896
Train Loss: 0.1635
ID Validation ROC-AUC: 0.8154
ID Validation Loss: 0.2174
ID Test ROC-AUC: 0.7951
ID Test Loss: 0.2075
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.3360
OOD Test ROC-AUC: 0.6662
OOD Test Loss: 0.2099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ROC-AUC: 0.7948
Train Loss: 0.1687
ID Validation ROC-AUC: 0.7578
ID Validation Loss: 0.1964
ID Test ROC-AUC: 0.7533
ID Test Loss: 0.1648
OOD Validation ROC-AUC: 0.7704
OOD Validation Loss: 0.2321
OOD Test ROC-AUC: 0.6840
OOD Test Loss: 0.1430

[0m[1;37mINFO[0m: [1mChartInfo 0.7951 0.6662 0.7533 0.6840 0.7578 0.7704[0mId_val ROC-AUC: 0.8154Id_val Loss: 0.2174
Id_test ROC-AUC: 0.7951Id_test Loss: 0.2075
Test ROC-AUC: 0.6662Test Loss: 0.2099


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:48:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:48:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ROC-AUC: 0.8629
Train Loss: 0.3601
ID Validation ROC-AUC: 0.8071
ID Validation Loss: 0.3906
ID Test ROC-AUC: 0.8014
ID Test Loss: 0.3869
OOD Validation ROC-AUC: 0.7294
OOD Validation Loss: 0.6233
OOD Test ROC-AUC: 0.6772
OOD Test Loss: 0.4237

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ROC-AUC: 0.8228
Train Loss: 0.1441
ID Validation ROC-AUC: 0.8016
ID Validation Loss: 0.1667
ID Test ROC-AUC: 0.7843
ID Test Loss: 0.1413
OOD Validation ROC-AUC: 0.7586
OOD Validation Loss: 0.1918
OOD Test ROC-AUC: 0.6593
OOD Test Loss: 0.1299

[0m[1;37mINFO[0m: [1mChartInfo 0.8014 0.6772 0.7843 0.6593 0.8016 0.7586[0mId_val ROC-AUC: 0.8071Id_val Loss: 0.3906
Id_test ROC-AUC: 0.8014Id_test Loss: 0.3869
Test ROC-AUC: 0.6772Test Loss: 0.4237


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:48:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/17/2024 10:48:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.8839
Train Loss: 0.1354
ID Validation ROC-AUC: 0.8150
ID Validation Loss: 0.1913
ID Test ROC-AUC: 0.8209
ID Test Loss: 0.1571
OOD Validation ROC-AUC: 0.7443
OOD Validation Loss: 0.2553
OOD Test ROC-AUC: 0.6590
OOD Test Loss: 0.1739

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ROC-AUC: 0.8156
Train Loss: 0.1601
ID Validation ROC-AUC: 0.7807
ID Validation Loss: 0.1914
ID Test ROC-AUC: 0.7745
ID Test Loss: 0.1596
OOD Validation ROC-AUC: 0.7633
OOD Validation Loss: 0.1988
OOD Test ROC-AUC: 0.6787
OOD Test Loss: 0.1375

[0m[1;37mINFO[0m: [1mChartInfo 0.8209 0.6590 0.7745 0.6787 0.7807 0.7633[0mId_val ROC-AUC: 0.8150Id_val Loss: 0.1913
Id_test ROC-AUC: 0.8209Id_test Loss: 0.1571
Test ROC-AUC: 0.6590Test Loss: 0.1739


Final accuracies: 
ID_VAL     = 0.814 +- 0.003
ID_TEST    = 0.806 +- 0.009
TEST       = 0.675 +- 0.011

Final losses: 
ID_VAL     = 0.2889 +- 0.1170
ID_TEST    = 0.2779 +- 0.1291
TEST       = 0.2953 +- 0.1376
Diff id_val-test  = 0.0065 
DONE TRAIN GSAT GOODHIV/scaffold hard
DONE all :)
