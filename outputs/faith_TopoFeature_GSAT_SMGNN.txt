nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 931295

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:06:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:06:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.682
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.602
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.458
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.313
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.190
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.317
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.178
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.097
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.052
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.452
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.363
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.268
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.148


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.681783393501805
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.662
SUFF_SIMPLE for r=0.05 class 1.0 = 0.639 +- 0.472 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all KL = 0.414 +- 0.472 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all L1 = 0.639 +- 0.350 (in-sample avg dev_std = 0.567)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6023790613718412
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.648
SUFF_SIMPLE for r=0.1 class 1.0 = 0.633 +- 0.474 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.1 all KL = 0.421 +- 0.474 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.1 all L1 = 0.633 +- 0.359 (in-sample avg dev_std = 0.553)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4578736462093863
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.666
SUFF_SIMPLE for r=0.2 class 1.0 = 0.64 +- 0.471 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all KL = 0.429 +- 0.471 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all L1 = 0.64 +- 0.354 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3126173285198556
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.624
SUFF_SIMPLE for r=0.4 class 1.0 = 0.623 +- 0.480 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.4 all KL = 0.429 +- 0.480 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.4 all L1 = 0.623 +- 0.366 (in-sample avg dev_std = 0.502)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1896895306859206
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.745
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.454 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.8 all KL = 0.699 +- 0.454 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.8 all L1 = 0.765 +- 0.369 (in-sample avg dev_std = 0.255)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.458
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.31731507936507936
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.171
SUFF_SIMPLE for r=0.05 class 1.0 = 0.591 +- 0.436 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.05 all KL = 0.506 +- 0.436 (in-sample avg dev_std = 0.471)
SUFF_SIMPLE for r=0.05 all L1 = 0.591 +- 0.354 (in-sample avg dev_std = 0.471)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.458
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.17750277777777776
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.168
SUFF_SIMPLE for r=0.1 class 1.0 = 0.593 +- 0.436 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.1 all KL = 0.507 +- 0.436 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.1 all L1 = 0.593 +- 0.353 (in-sample avg dev_std = 0.470)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.458
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09652142857142856
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.164
SUFF_SIMPLE for r=0.2 class 1.0 = 0.593 +- 0.438 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.2 all KL = 0.512 +- 0.438 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.2 all L1 = 0.593 +- 0.357 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.458
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05197103174603174
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.157
SUFF_SIMPLE for r=0.4 class 1.0 = 0.594 +- 0.440 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 all KL = 0.516 +- 0.440 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 all L1 = 0.594 +- 0.360 (in-sample avg dev_std = 0.439)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02853055555555556
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.172
SUFF_SIMPLE for r=0.8 class 1.0 = 0.647 +- 0.439 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.8 all KL = 0.615 +- 0.439 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.8 all L1 = 0.647 +- 0.381 (in-sample avg dev_std = 0.144)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.778
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45156888168557535
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.55
SUFF_SIMPLE for r=0.05 class 1.0 = 0.684 +- 0.446 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 all KL = 0.603 +- 0.446 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.05 all L1 = 0.684 +- 0.361 (in-sample avg dev_std = 0.322)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.778
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3629558346839546
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.588
SUFF_SIMPLE for r=0.1 class 1.0 = 0.7 +- 0.445 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all KL = 0.611 +- 0.445 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.1 all L1 = 0.7 +- 0.348 (in-sample avg dev_std = 0.300)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.778
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26818679092382497
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.6
SUFF_SIMPLE for r=0.2 class 1.0 = 0.699 +- 0.442 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 all KL = 0.616 +- 0.442 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 all L1 = 0.699 +- 0.351 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.778
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19988168557536468
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.564
SUFF_SIMPLE for r=0.4 class 1.0 = 0.666 +- 0.449 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.4 all KL = 0.597 +- 0.449 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.4 all L1 = 0.666 +- 0.371 (in-sample avg dev_std = 0.241)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1477151539708266
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.777
SUFF_SIMPLE for r=0.8 class 1.0 = 0.817 +- 0.367 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all KL = 0.791 +- 0.367 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.8 all L1 = 0.817 +- 0.312 (in-sample avg dev_std = 0.116)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.681783393501805
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.195
NEC for r=0.05 class 1.0 = 0.713 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.868 +- 0.313 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.713 +- 0.305 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6023790613718412
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.25
NEC for r=0.1 class 1.0 = 0.722 +- 0.197 (in-sample avg dev_std = 0.543)
NEC for r=0.1 all KL = 0.954 +- 0.197 (in-sample avg dev_std = 0.543)
NEC for r=0.1 all L1 = 0.722 +- 0.214 (in-sample avg dev_std = 0.543)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4578736462093863
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.558
NEC for r=0.2 class 1.0 = 0.485 +- 0.289 (in-sample avg dev_std = 0.629)
NEC for r=0.2 all KL = 0.852 +- 0.289 (in-sample avg dev_std = 0.629)
NEC for r=0.2 all L1 = 0.485 +- 0.294 (in-sample avg dev_std = 0.629)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3126173285198556
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.741
NEC for r=0.4 class 1.0 = 0.301 +- 0.417 (in-sample avg dev_std = 0.547)
NEC for r=0.4 all KL = 0.622 +- 0.417 (in-sample avg dev_std = 0.547)
NEC for r=0.4 all L1 = 0.301 +- 0.293 (in-sample avg dev_std = 0.547)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1896895306859206
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.879
NEC for r=0.8 class 1.0 = 0.17 +- 0.421 (in-sample avg dev_std = 0.471)
NEC for r=0.8 all KL = 0.416 +- 0.421 (in-sample avg dev_std = 0.471)
NEC for r=0.8 all L1 = 0.17 +- 0.225 (in-sample avg dev_std = 0.471)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.458
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.31731507936507936
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.001
NEC for r=0.05 class 1.0 = 0.427 +- 0.459 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.459 +- 0.459 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.427 +- 0.400 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.458
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.17750277777777776
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.017
NEC for r=0.1 class 1.0 = 0.419 +- 0.456 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all KL = 0.453 +- 0.456 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all L1 = 0.419 +- 0.396 (in-sample avg dev_std = 0.089)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.458
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09652142857142856
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.108
NEC for r=0.2 class 1.0 = 0.412 +- 0.433 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all KL = 0.491 +- 0.433 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all L1 = 0.412 +- 0.354 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.458
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05197103174603174
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.213
NEC for r=0.4 class 1.0 = 0.374 +- 0.413 (in-sample avg dev_std = 0.560)
NEC for r=0.4 all KL = 0.493 +- 0.413 (in-sample avg dev_std = 0.560)
NEC for r=0.4 all L1 = 0.374 +- 0.313 (in-sample avg dev_std = 0.560)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02853055555555556
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.249
NEC for r=0.8 class 1.0 = 0.351 +- 0.410 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all KL = 0.47 +- 0.410 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all L1 = 0.351 +- 0.306 (in-sample avg dev_std = 0.551)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.778
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.45156888168557535
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.17
NEC for r=0.05 class 1.0 = 0.565 +- 0.442 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all KL = 0.661 +- 0.442 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all L1 = 0.565 +- 0.380 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.778
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3629558346839546
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.205
NEC for r=0.1 class 1.0 = 0.591 +- 0.389 (in-sample avg dev_std = 0.388)
NEC for r=0.1 all KL = 0.73 +- 0.389 (in-sample avg dev_std = 0.388)
NEC for r=0.1 all L1 = 0.591 +- 0.337 (in-sample avg dev_std = 0.388)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.778
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26818679092382497
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.319
NEC for r=0.2 class 1.0 = 0.543 +- 0.366 (in-sample avg dev_std = 0.540)
NEC for r=0.2 all KL = 0.728 +- 0.366 (in-sample avg dev_std = 0.540)
NEC for r=0.2 all L1 = 0.543 +- 0.310 (in-sample avg dev_std = 0.540)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.778
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19988168557536468
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.475
NEC for r=0.4 class 1.0 = 0.442 +- 0.373 (in-sample avg dev_std = 0.591)
NEC for r=0.4 all KL = 0.669 +- 0.373 (in-sample avg dev_std = 0.591)
NEC for r=0.4 all L1 = 0.442 +- 0.290 (in-sample avg dev_std = 0.591)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1477151539708266
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.586
NEC for r=0.8 class 1.0 = 0.304 +- 0.394 (in-sample avg dev_std = 0.527)
NEC for r=0.8 all KL = 0.527 +- 0.394 (in-sample avg dev_std = 0.527)
NEC for r=0.8 all L1 = 0.304 +- 0.270 (in-sample avg dev_std = 0.527)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:12:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:12:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.688
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.645
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.496
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.334
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.205
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.344
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.193
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.106
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.057
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.031
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.426
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.357
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.274
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.204
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.152


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6880685920577617
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.735
SUFF_SIMPLE for r=0.05 class 1.0 = 0.709 +- 0.471 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.05 all KL = 0.517 +- 0.471 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.05 all L1 = 0.709 +- 0.334 (in-sample avg dev_std = 0.533)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6451407942238268
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.696
SUFF_SIMPLE for r=0.1 class 1.0 = 0.682 +- 0.480 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all KL = 0.509 +- 0.480 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all L1 = 0.682 +- 0.354 (in-sample avg dev_std = 0.525)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4963862815884477
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.68
SUFF_SIMPLE for r=0.2 class 1.0 = 0.669 +- 0.478 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.2 all KL = 0.49 +- 0.478 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.2 all L1 = 0.669 +- 0.358 (in-sample avg dev_std = 0.515)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3336570397111913
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.677
SUFF_SIMPLE for r=0.4 class 1.0 = 0.668 +- 0.478 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 all KL = 0.5 +- 0.478 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 all L1 = 0.668 +- 0.364 (in-sample avg dev_std = 0.492)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20480144404332132
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.758
SUFF_SIMPLE for r=0.8 class 1.0 = 0.772 +- 0.449 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all KL = 0.7 +- 0.449 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all L1 = 0.772 +- 0.360 (in-sample avg dev_std = 0.287)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.788
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3440488095238095
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.249
SUFF_SIMPLE for r=0.05 class 1.0 = 0.415 +- 0.366 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 all KL = 0.307 +- 0.366 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 all L1 = 0.415 +- 0.297 (in-sample avg dev_std = 0.516)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.788
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.19299722222222224
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.246
SUFF_SIMPLE for r=0.1 class 1.0 = 0.416 +- 0.365 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.1 all KL = 0.308 +- 0.365 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.1 all L1 = 0.416 +- 0.297 (in-sample avg dev_std = 0.509)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.788
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10556468253968256
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.236
SUFF_SIMPLE for r=0.2 class 1.0 = 0.412 +- 0.369 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.2 all KL = 0.308 +- 0.369 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.2 all L1 = 0.412 +- 0.302 (in-sample avg dev_std = 0.491)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.788
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.056962301587301596
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.216
SUFF_SIMPLE for r=0.4 class 1.0 = 0.402 +- 0.371 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.4 all KL = 0.303 +- 0.371 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.4 all L1 = 0.402 +- 0.302 (in-sample avg dev_std = 0.475)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03132619047619048
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.235
SUFF_SIMPLE for r=0.8 class 1.0 = 0.45 +- 0.421 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.8 all KL = 0.396 +- 0.421 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.8 all L1 = 0.45 +- 0.357 (in-sample avg dev_std = 0.201)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.735
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4256487034035657
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 1.0 = 0.641 +- 0.432 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.05 all KL = 0.558 +- 0.432 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.05 all L1 = 0.641 +- 0.342 (in-sample avg dev_std = 0.388)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.735
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35721636952998387
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.509
SUFF_SIMPLE for r=0.1 class 1.0 = 0.642 +- 0.437 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 all KL = 0.568 +- 0.437 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 all L1 = 0.642 +- 0.348 (in-sample avg dev_std = 0.360)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.735
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27384116693679095
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.511
SUFF_SIMPLE for r=0.2 class 1.0 = 0.634 +- 0.438 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.2 all KL = 0.565 +- 0.438 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.2 all L1 = 0.634 +- 0.353 (in-sample avg dev_std = 0.342)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.735
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2039141004862237
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.538
SUFF_SIMPLE for r=0.4 class 1.0 = 0.612 +- 0.443 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 all KL = 0.546 +- 0.443 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.4 all L1 = 0.612 +- 0.363 (in-sample avg dev_std = 0.311)


ratio=0.8


40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.736
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15218679092382495
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.668
SUFF_SIMPLE for r=0.8 class 1.0 = 0.771 +- 0.380 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.8 all KL = 0.749 +- 0.380 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.8 all L1 = 0.771 +- 0.322 (in-sample avg dev_std = 0.221)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6880685920577617
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.188
NEC for r=0.05 class 1.0 = 0.729 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.893 +- 0.277 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.729 +- 0.278 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6451407942238268
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.184
NEC for r=0.1 class 1.0 = 0.763 +- 0.175 (in-sample avg dev_std = 0.469)
NEC for r=0.1 all KL = 0.964 +- 0.175 (in-sample avg dev_std = 0.469)
NEC for r=0.1 all L1 = 0.763 +- 0.188 (in-sample avg dev_std = 0.469)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4963862815884477
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.475
NEC for r=0.2 class 1.0 = 0.566 +- 0.228 (in-sample avg dev_std = 0.661)
NEC for r=0.2 all KL = 0.904 +- 0.228 (in-sample avg dev_std = 0.661)
NEC for r=0.2 all L1 = 0.566 +- 0.264 (in-sample avg dev_std = 0.661)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3336570397111913
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.694
NEC for r=0.4 class 1.0 = 0.363 +- 0.389 (in-sample avg dev_std = 0.614)
NEC for r=0.4 all KL = 0.685 +- 0.389 (in-sample avg dev_std = 0.614)
NEC for r=0.4 all L1 = 0.363 +- 0.300 (in-sample avg dev_std = 0.614)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20480144404332132
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.875
NEC for r=0.8 class 1.0 = 0.191 +- 0.417 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all KL = 0.459 +- 0.417 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all L1 = 0.191 +- 0.217 (in-sample avg dev_std = 0.540)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.788
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3440488095238095
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.008
NEC for r=0.05 class 1.0 = 0.702 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.767 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.702 +- 0.288 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.788
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.19299722222222224
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.051
NEC for r=0.1 class 1.0 = 0.677 +- 0.363 (in-sample avg dev_std = 0.160)
NEC for r=0.1 all KL = 0.746 +- 0.363 (in-sample avg dev_std = 0.160)
NEC for r=0.1 all L1 = 0.677 +- 0.297 (in-sample avg dev_std = 0.160)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.788
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10556468253968256
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.216
NEC for r=0.2 class 1.0 = 0.617 +- 0.333 (in-sample avg dev_std = 0.602)
NEC for r=0.2 all KL = 0.745 +- 0.333 (in-sample avg dev_std = 0.602)
NEC for r=0.2 all L1 = 0.617 +- 0.255 (in-sample avg dev_std = 0.602)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.788
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.056962301587301596
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.387
NEC for r=0.4 class 1.0 = 0.51 +- 0.324 (in-sample avg dev_std = 0.644)
NEC for r=0.4 all KL = 0.671 +- 0.324 (in-sample avg dev_std = 0.644)
NEC for r=0.4 all L1 = 0.51 +- 0.251 (in-sample avg dev_std = 0.644)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03132619047619048
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.413
NEC for r=0.8 class 1.0 = 0.479 +- 0.335 (in-sample avg dev_std = 0.606)
NEC for r=0.8 all KL = 0.627 +- 0.335 (in-sample avg dev_std = 0.606)
NEC for r=0.8 all L1 = 0.479 +- 0.264 (in-sample avg dev_std = 0.606)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.735
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4256487034035657
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.162
NEC for r=0.05 class 1.0 = 0.552 +- 0.442 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all KL = 0.626 +- 0.442 (in-sample avg dev_std = 0.015)
NEC for r=0.05 all L1 = 0.552 +- 0.383 (in-sample avg dev_std = 0.015)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.735
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.35721636952998387
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.156
NEC for r=0.1 class 1.0 = 0.589 +- 0.421 (in-sample avg dev_std = 0.236)
NEC for r=0.1 all KL = 0.674 +- 0.421 (in-sample avg dev_std = 0.236)
NEC for r=0.1 all L1 = 0.589 +- 0.357 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.735
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27384116693679095
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.236
NEC for r=0.2 class 1.0 = 0.563 +- 0.405 (in-sample avg dev_std = 0.461)
NEC for r=0.2 all KL = 0.675 +- 0.405 (in-sample avg dev_std = 0.461)
NEC for r=0.2 all L1 = 0.563 +- 0.328 (in-sample avg dev_std = 0.461)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.735
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2039141004862237
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.377
NEC for r=0.4 class 1.0 = 0.484 +- 0.389 (in-sample avg dev_std = 0.596)
NEC for r=0.4 all KL = 0.642 +- 0.389 (in-sample avg dev_std = 0.596)
NEC for r=0.4 all L1 = 0.484 +- 0.291 (in-sample avg dev_std = 0.596)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15218679092382495
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.541
NEC for r=0.8 class 1.0 = 0.343 +- 0.377 (in-sample avg dev_std = 0.591)
NEC for r=0.8 all KL = 0.538 +- 0.377 (in-sample avg dev_std = 0.591)
NEC for r=0.8 all L1 = 0.343 +- 0.241 (in-sample avg dev_std = 0.591)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:17:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:17:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.692
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.649
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.503
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.339
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.211
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.348
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.196
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.107
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.058
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.032
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.436
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.357
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.269
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.198
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.153


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6922057761732852
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.72
SUFF_SIMPLE for r=0.05 class 1.0 = 0.695 +- 0.481 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.05 all KL = 0.5 +- 0.481 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.05 all L1 = 0.695 +- 0.344 (in-sample avg dev_std = 0.535)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.648505415162455
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.702
SUFF_SIMPLE for r=0.1 class 1.0 = 0.688 +- 0.484 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.1 all KL = 0.508 +- 0.484 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.1 all L1 = 0.688 +- 0.354 (in-sample avg dev_std = 0.505)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5034332129963899
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.671
SUFF_SIMPLE for r=0.2 class 1.0 = 0.661 +- 0.481 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 all KL = 0.477 +- 0.481 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 all L1 = 0.661 +- 0.365 (in-sample avg dev_std = 0.501)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3393646209386281
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.631
SUFF_SIMPLE for r=0.4 class 1.0 = 0.628 +- 0.474 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 all KL = 0.44 +- 0.474 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 all L1 = 0.628 +- 0.373 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21089530685920577
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 1.0 = 0.688 +- 0.485 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.485 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.8 all L1 = 0.688 +- 0.388 (in-sample avg dev_std = 0.344)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.874
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34841666666666665
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.221
SUFF_SIMPLE for r=0.05 class 1.0 = 0.359 +- 0.351 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.05 all KL = 0.188 +- 0.351 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.05 all L1 = 0.359 +- 0.296 (in-sample avg dev_std = 0.535)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.874
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.19591746031746032
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.212
SUFF_SIMPLE for r=0.1 class 1.0 = 0.355 +- 0.350 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 all KL = 0.186 +- 0.350 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 all L1 = 0.355 +- 0.297 (in-sample avg dev_std = 0.522)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.874
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10721111111111112
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.192
SUFF_SIMPLE for r=0.2 class 1.0 = 0.339 +- 0.339 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.2 all KL = 0.173 +- 0.339 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.2 all L1 = 0.339 +- 0.288 (in-sample avg dev_std = 0.513)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.874
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05812222222222222
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.155
SUFF_SIMPLE for r=0.4 class 1.0 = 0.313 +- 0.330 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.4 all KL = 0.16 +- 0.330 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.4 all L1 = 0.313 +- 0.276 (in-sample avg dev_std = 0.486)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032084126984126986
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.064
SUFF_SIMPLE for r=0.8 class 1.0 = 0.277 +- 0.342 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 all KL = 0.168 +- 0.342 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 all L1 = 0.277 +- 0.290 (in-sample avg dev_std = 0.141)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.741
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.43558103727714753
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.552
SUFF_SIMPLE for r=0.05 class 1.0 = 0.645 +- 0.428 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.05 all KL = 0.576 +- 0.428 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.05 all L1 = 0.645 +- 0.348 (in-sample avg dev_std = 0.341)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.741
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3565113452188007
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.547
SUFF_SIMPLE for r=0.1 class 1.0 = 0.639 +- 0.433 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.1 all KL = 0.575 +- 0.433 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.1 all L1 = 0.639 +- 0.354 (in-sample avg dev_std = 0.328)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.741
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2694132901134522
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.558
SUFF_SIMPLE for r=0.2 class 1.0 = 0.625 +- 0.438 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.2 all KL = 0.56 +- 0.438 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.2 all L1 = 0.625 +- 0.358 (in-sample avg dev_std = 0.316)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.741
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19762682333873585
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.542
SUFF_SIMPLE for r=0.4 class 1.0 = 0.594 +- 0.442 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.4 all KL = 0.528 +- 0.442 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.4 all L1 = 0.594 +- 0.364 (in-sample avg dev_std = 0.300)


ratio=0.8


40 5 0
40 5 0

Model Accuracy of binarized graphs for r=0.8 =  0.742
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15315680713128038
len(reference) = 2466
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.657
SUFF_SIMPLE for r=0.8 class 1.0 = 0.702 +- 0.411 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.666 +- 0.411 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.702 +- 0.352 (in-sample avg dev_std = 0.232)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6922057761732852
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.303
NEC for r=0.05 class 1.0 = 0.643 +- 0.361 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.81 +- 0.361 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.643 +- 0.345 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.648505415162455
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.281
NEC for r=0.1 class 1.0 = 0.704 +- 0.223 (in-sample avg dev_std = 0.566)
NEC for r=0.1 all KL = 0.934 +- 0.223 (in-sample avg dev_std = 0.566)
NEC for r=0.1 all L1 = 0.704 +- 0.233 (in-sample avg dev_std = 0.566)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5034332129963899
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.562
NEC for r=0.2 class 1.0 = 0.489 +- 0.291 (in-sample avg dev_std = 0.671)
NEC for r=0.2 all KL = 0.864 +- 0.291 (in-sample avg dev_std = 0.671)
NEC for r=0.2 all L1 = 0.489 +- 0.285 (in-sample avg dev_std = 0.671)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3393646209386281
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.747
NEC for r=0.4 class 1.0 = 0.294 +- 0.432 (in-sample avg dev_std = 0.536)
NEC for r=0.4 all KL = 0.612 +- 0.432 (in-sample avg dev_std = 0.536)
NEC for r=0.4 all L1 = 0.294 +- 0.304 (in-sample avg dev_std = 0.536)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21089530685920577
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.881
NEC for r=0.8 class 1.0 = 0.159 +- 0.430 (in-sample avg dev_std = 0.463)
NEC for r=0.8 all KL = 0.382 +- 0.430 (in-sample avg dev_std = 0.463)
NEC for r=0.8 all L1 = 0.159 +- 0.234 (in-sample avg dev_std = 0.463)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.874
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.34841666666666665
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.002
NEC for r=0.05 class 1.0 = 0.767 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.87 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.767 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.874
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.19591746031746032
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.029
NEC for r=0.1 class 1.0 = 0.751 +- 0.317 (in-sample avg dev_std = 0.146)
NEC for r=0.1 all KL = 0.858 +- 0.317 (in-sample avg dev_std = 0.146)
NEC for r=0.1 all L1 = 0.751 +- 0.262 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.874
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10721111111111112
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.225
NEC for r=0.2 class 1.0 = 0.671 +- 0.294 (in-sample avg dev_std = 0.678)
NEC for r=0.2 all KL = 0.868 +- 0.294 (in-sample avg dev_std = 0.678)
NEC for r=0.2 all L1 = 0.671 +- 0.237 (in-sample avg dev_std = 0.678)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.874
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05812222222222222
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.463
NEC for r=0.4 class 1.0 = 0.507 +- 0.313 (in-sample avg dev_std = 0.721)
NEC for r=0.4 all KL = 0.809 +- 0.313 (in-sample avg dev_std = 0.721)
NEC for r=0.4 all L1 = 0.507 +- 0.259 (in-sample avg dev_std = 0.721)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032084126984126986
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.509
NEC for r=0.8 class 1.0 = 0.436 +- 0.377 (in-sample avg dev_std = 0.640)
NEC for r=0.8 all KL = 0.721 +- 0.377 (in-sample avg dev_std = 0.640)
NEC for r=0.8 all L1 = 0.436 +- 0.292 (in-sample avg dev_std = 0.640)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.741
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.43558103727714753
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.166
NEC for r=0.05 class 1.0 = 0.527 +- 0.449 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all KL = 0.591 +- 0.449 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all L1 = 0.527 +- 0.387 (in-sample avg dev_std = 0.089)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.741
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3565113452188007
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.175
NEC for r=0.1 class 1.0 = 0.545 +- 0.431 (in-sample avg dev_std = 0.288)
NEC for r=0.1 all KL = 0.624 +- 0.431 (in-sample avg dev_std = 0.288)
NEC for r=0.1 all L1 = 0.545 +- 0.367 (in-sample avg dev_std = 0.288)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.741
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2694132901134522
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.242
NEC for r=0.2 class 1.0 = 0.536 +- 0.403 (in-sample avg dev_std = 0.439)
NEC for r=0.2 all KL = 0.638 +- 0.403 (in-sample avg dev_std = 0.439)
NEC for r=0.2 all L1 = 0.536 +- 0.335 (in-sample avg dev_std = 0.439)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.741
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19762682333873585
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.353
NEC for r=0.4 class 1.0 = 0.476 +- 0.393 (in-sample avg dev_std = 0.569)
NEC for r=0.4 all KL = 0.606 +- 0.393 (in-sample avg dev_std = 0.569)
NEC for r=0.4 all L1 = 0.476 +- 0.302 (in-sample avg dev_std = 0.569)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15315680713128038
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.531
NEC for r=0.8 class 1.0 = 0.34 +- 0.383 (in-sample avg dev_std = 0.556)
NEC for r=0.8 all KL = 0.502 +- 0.383 (in-sample avg dev_std = 0.556)
NEC for r=0.8 all L1 = 0.34 +- 0.261 (in-sample avg dev_std = 0.556)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:23:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:23:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.679
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.641
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.502
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.336
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.211
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.346
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.198
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.110
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.465
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.380
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.285
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.207
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.159


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678956678700361
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.683
SUFF_SIMPLE for r=0.05 class 1.0 = 0.653 +- 0.438 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.05 all KL = 0.406 +- 0.438 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.05 all L1 = 0.653 +- 0.336 (in-sample avg dev_std = 0.538)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6414404332129965
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.68
SUFF_SIMPLE for r=0.1 class 1.0 = 0.651 +- 0.431 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.1 all KL = 0.393 +- 0.431 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.1 all L1 = 0.651 +- 0.333 (in-sample avg dev_std = 0.551)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5021696750902527
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.676
SUFF_SIMPLE for r=0.2 class 1.0 = 0.647 +- 0.429 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all KL = 0.392 +- 0.429 (in-sample avg dev_std = 0.532)
SUFF_SIMPLE for r=0.2 all L1 = 0.647 +- 0.336 (in-sample avg dev_std = 0.532)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.33616967509025264
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.66
SUFF_SIMPLE for r=0.4 class 1.0 = 0.635 +- 0.429 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.4 all KL = 0.373 +- 0.429 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.4 all L1 = 0.635 +- 0.337 (in-sample avg dev_std = 0.530)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2113465703971119
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.776
SUFF_SIMPLE for r=0.8 class 1.0 = 0.779 +- 0.444 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all KL = 0.674 +- 0.444 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.8 all L1 = 0.779 +- 0.345 (in-sample avg dev_std = 0.260)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.775
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3457103174603175
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.013
SUFF_SIMPLE for r=0.05 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.05 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.05 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.187)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.775
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1978797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.012
SUFF_SIMPLE for r=0.1 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.191)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.775
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10993809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.011
SUFF_SIMPLE for r=0.2 class 1.0 = 0.305 +- 0.366 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.2 all L1 = 0.305 +- 0.296 (in-sample avg dev_std = 0.178)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.775
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060727380952380956
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.01
SUFF_SIMPLE for r=0.4 class 1.0 = 0.305 +- 0.367 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all KL = 0.233 +- 0.367 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.4 all L1 = 0.305 +- 0.297 (in-sample avg dev_std = 0.165)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03458214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.147
SUFF_SIMPLE for r=0.8 class 1.0 = 0.408 +- 0.409 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.8 all KL = 0.335 +- 0.409 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.8 all L1 = 0.408 +- 0.345 (in-sample avg dev_std = 0.127)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.845
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.46460899513776327
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 1.0 = 0.719 +- 0.433 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all KL = 0.672 +- 0.433 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.05 all L1 = 0.719 +- 0.357 (in-sample avg dev_std = 0.245)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.845
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37974351701782827
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.607
SUFF_SIMPLE for r=0.1 class 1.0 = 0.718 +- 0.436 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.1 all KL = 0.674 +- 0.436 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.1 all L1 = 0.718 +- 0.359 (in-sample avg dev_std = 0.238)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.845
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2845421393841167
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.606
SUFF_SIMPLE for r=0.2 class 1.0 = 0.711 +- 0.439 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.665 +- 0.439 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.711 +- 0.359 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.845
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.207347244732577
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.601
SUFF_SIMPLE for r=0.4 class 1.0 = 0.696 +- 0.443 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 all KL = 0.644 +- 0.443 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 all L1 = 0.696 +- 0.363 (in-sample avg dev_std = 0.222)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1593594003241491
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.748
SUFF_SIMPLE for r=0.8 class 1.0 = 0.828 +- 0.352 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.819 +- 0.352 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.828 +- 0.303 (in-sample avg dev_std = 0.089)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.678956678700361
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.126
NEC for r=0.05 class 1.0 = 0.779 +- 0.181 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.95 +- 0.181 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.779 +- 0.210 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6414404332129965
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.131
NEC for r=0.1 class 1.0 = 0.802 +- 0.075 (in-sample avg dev_std = 0.446)
NEC for r=0.1 all KL = 0.986 +- 0.075 (in-sample avg dev_std = 0.446)
NEC for r=0.1 all L1 = 0.802 +- 0.133 (in-sample avg dev_std = 0.446)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5021696750902527
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.371
NEC for r=0.2 class 1.0 = 0.662 +- 0.118 (in-sample avg dev_std = 0.723)
NEC for r=0.2 all KL = 0.97 +- 0.118 (in-sample avg dev_std = 0.723)
NEC for r=0.2 all L1 = 0.662 +- 0.203 (in-sample avg dev_std = 0.723)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.33616967509025264
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.634
NEC for r=0.4 class 1.0 = 0.439 +- 0.291 (in-sample avg dev_std = 0.695)
NEC for r=0.4 all KL = 0.826 +- 0.291 (in-sample avg dev_std = 0.695)
NEC for r=0.4 all L1 = 0.439 +- 0.267 (in-sample avg dev_std = 0.695)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2113465703971119
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.81
NEC for r=0.8 class 1.0 = 0.256 +- 0.405 (in-sample avg dev_std = 0.588)
NEC for r=0.8 all KL = 0.58 +- 0.405 (in-sample avg dev_std = 0.588)
NEC for r=0.8 all L1 = 0.256 +- 0.251 (in-sample avg dev_std = 0.588)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.775
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3457103174603175
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.004
NEC for r=0.05 class 1.0 = 0.695 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.766 +- 0.368 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.695 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.775
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.1978797619047619
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.004
NEC for r=0.1 class 1.0 = 0.695 +- 0.368 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all KL = 0.767 +- 0.368 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all L1 = 0.695 +- 0.299 (in-sample avg dev_std = 0.035)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.775
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10993809523809524
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.023
NEC for r=0.2 class 1.0 = 0.69 +- 0.366 (in-sample avg dev_std = 0.252)
NEC for r=0.2 all KL = 0.767 +- 0.366 (in-sample avg dev_std = 0.252)
NEC for r=0.2 all L1 = 0.69 +- 0.294 (in-sample avg dev_std = 0.252)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.775
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060727380952380956
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.095
NEC for r=0.4 class 1.0 = 0.66 +- 0.365 (in-sample avg dev_std = 0.465)
NEC for r=0.4 all KL = 0.762 +- 0.365 (in-sample avg dev_std = 0.465)
NEC for r=0.4 all L1 = 0.66 +- 0.284 (in-sample avg dev_std = 0.465)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03458214285714286
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.126
NEC for r=0.8 class 1.0 = 0.646 +- 0.364 (in-sample avg dev_std = 0.507)
NEC for r=0.8 all KL = 0.759 +- 0.364 (in-sample avg dev_std = 0.507)
NEC for r=0.8 all L1 = 0.646 +- 0.280 (in-sample avg dev_std = 0.507)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.845
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.46460899513776327
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.123
NEC for r=0.05 class 1.0 = 0.666 +- 0.371 (in-sample avg dev_std = 0.037)
NEC for r=0.05 all KL = 0.774 +- 0.371 (in-sample avg dev_std = 0.037)
NEC for r=0.05 all L1 = 0.666 +- 0.324 (in-sample avg dev_std = 0.037)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.845
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37974351701782827
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.108
NEC for r=0.1 class 1.0 = 0.691 +- 0.343 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all KL = 0.807 +- 0.343 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all L1 = 0.691 +- 0.292 (in-sample avg dev_std = 0.284)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.845
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2845421393841167
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.214
NEC for r=0.2 class 1.0 = 0.644 +- 0.336 (in-sample avg dev_std = 0.510)
NEC for r=0.2 all KL = 0.787 +- 0.336 (in-sample avg dev_std = 0.510)
NEC for r=0.2 all L1 = 0.644 +- 0.276 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.845
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.207347244732577
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.363
NEC for r=0.4 class 1.0 = 0.549 +- 0.350 (in-sample avg dev_std = 0.662)
NEC for r=0.4 all KL = 0.734 +- 0.350 (in-sample avg dev_std = 0.662)
NEC for r=0.4 all L1 = 0.549 +- 0.267 (in-sample avg dev_std = 0.662)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1593594003241491
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.512
NEC for r=0.8 class 1.0 = 0.419 +- 0.369 (in-sample avg dev_std = 0.647)
NEC for r=0.8 all KL = 0.63 +- 0.369 (in-sample avg dev_std = 0.647)
NEC for r=0.8 all L1 = 0.419 +- 0.268 (in-sample avg dev_std = 0.647)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:28:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:28:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.703
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.632
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.475
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.316
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.190
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.320
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.179
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.097
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.052
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.469
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.375
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.275
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.199
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.147


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7031696750902527
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.731
SUFF_SIMPLE for r=0.05 class 1.0 = 0.693 +- 0.475 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.05 all KL = 0.498 +- 0.475 (in-sample avg dev_std = 0.593)
SUFF_SIMPLE for r=0.05 all L1 = 0.693 +- 0.333 (in-sample avg dev_std = 0.593)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6322418772563176
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.703
SUFF_SIMPLE for r=0.1 class 1.0 = 0.685 +- 0.479 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.1 all KL = 0.507 +- 0.479 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.1 all L1 = 0.685 +- 0.351 (in-sample avg dev_std = 0.530)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4750397111913358
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.69
SUFF_SIMPLE for r=0.2 class 1.0 = 0.683 +- 0.475 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all KL = 0.51 +- 0.475 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.2 all L1 = 0.683 +- 0.356 (in-sample avg dev_std = 0.493)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.31620938628158846
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.69
SUFF_SIMPLE for r=0.4 class 1.0 = 0.679 +- 0.479 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 all KL = 0.505 +- 0.479 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 all L1 = 0.679 +- 0.357 (in-sample avg dev_std = 0.488)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.19025992779783393
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.711
SUFF_SIMPLE for r=0.8 class 1.0 = 0.723 +- 0.474 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.8 all KL = 0.627 +- 0.474 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.8 all L1 = 0.723 +- 0.377 (in-sample avg dev_std = 0.342)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.497
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.32049801587301585
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.334
SUFF_SIMPLE for r=0.05 class 1.0 = 0.575 +- 0.409 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 all KL = 0.476 +- 0.409 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 all L1 = 0.575 +- 0.320 (in-sample avg dev_std = 0.568)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.497
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.17943968253968254
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.328
SUFF_SIMPLE for r=0.1 class 1.0 = 0.577 +- 0.409 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.1 all KL = 0.479 +- 0.409 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.1 all L1 = 0.577 +- 0.322 (in-sample avg dev_std = 0.561)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.497
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09732658730158729
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.319
SUFF_SIMPLE for r=0.2 class 1.0 = 0.573 +- 0.408 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.2 all KL = 0.473 +- 0.408 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.2 all L1 = 0.573 +- 0.320 (in-sample avg dev_std = 0.568)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.497
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.052212301587301585
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.285
SUFF_SIMPLE for r=0.4 class 1.0 = 0.566 +- 0.412 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.4 all KL = 0.471 +- 0.412 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.4 all L1 = 0.566 +- 0.325 (in-sample avg dev_std = 0.561)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02834920634920635
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.184
SUFF_SIMPLE for r=0.8 class 1.0 = 0.607 +- 0.433 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 all KL = 0.575 +- 0.433 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.8 all L1 = 0.607 +- 0.373 (in-sample avg dev_std = 0.211)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.745
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.46887236628849266
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.587
SUFF_SIMPLE for r=0.05 class 1.0 = 0.642 +- 0.439 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 all KL = 0.547 +- 0.439 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 all L1 = 0.642 +- 0.336 (in-sample avg dev_std = 0.422)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.745
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37497893030794166
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.57
SUFF_SIMPLE for r=0.1 class 1.0 = 0.642 +- 0.440 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.1 all KL = 0.563 +- 0.440 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.1 all L1 = 0.642 +- 0.347 (in-sample avg dev_std = 0.339)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.745
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27524311183144246
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.573
SUFF_SIMPLE for r=0.2 class 1.0 = 0.631 +- 0.440 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.2 all KL = 0.556 +- 0.440 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.2 all L1 = 0.631 +- 0.353 (in-sample avg dev_std = 0.300)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.745
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19919611021069691
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.591
SUFF_SIMPLE for r=0.4 class 1.0 = 0.597 +- 0.448 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all KL = 0.525 +- 0.448 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all L1 = 0.597 +- 0.365 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1469716369529984
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.709
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.390 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 all KL = 0.745 +- 0.390 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 all L1 = 0.765 +- 0.330 (in-sample avg dev_std = 0.132)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7031696750902527
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.199
NEC for r=0.05 class 1.0 = 0.713 +- 0.325 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.858 +- 0.325 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.713 +- 0.306 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6322418772563176
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.256
NEC for r=0.1 class 1.0 = 0.712 +- 0.204 (in-sample avg dev_std = 0.549)
NEC for r=0.1 all KL = 0.946 +- 0.204 (in-sample avg dev_std = 0.549)
NEC for r=0.1 all L1 = 0.712 +- 0.225 (in-sample avg dev_std = 0.549)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4750397111913358
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.6
NEC for r=0.2 class 1.0 = 0.448 +- 0.331 (in-sample avg dev_std = 0.606)
NEC for r=0.2 all KL = 0.79 +- 0.331 (in-sample avg dev_std = 0.606)
NEC for r=0.2 all L1 = 0.448 +- 0.302 (in-sample avg dev_std = 0.606)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.31620938628158846
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.801
NEC for r=0.4 class 1.0 = 0.24 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.4 all KL = 0.494 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.4 all L1 = 0.24 +- 0.280 (in-sample avg dev_std = 0.488)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.19025992779783393
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.925
NEC for r=0.8 class 1.0 = 0.117 +- 0.385 (in-sample avg dev_std = 0.422)
NEC for r=0.8 all KL = 0.292 +- 0.385 (in-sample avg dev_std = 0.422)
NEC for r=0.8 all L1 = 0.117 +- 0.182 (in-sample avg dev_std = 0.422)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.497
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.32049801587301585
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.467 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.497 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.467 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.497
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.17943968253968254
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.023
NEC for r=0.1 class 1.0 = 0.458 +- 0.447 (in-sample avg dev_std = 0.137)
NEC for r=0.1 all KL = 0.492 +- 0.447 (in-sample avg dev_std = 0.137)
NEC for r=0.1 all L1 = 0.458 +- 0.385 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.497
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09732658730158729
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.236
NEC for r=0.2 class 1.0 = 0.426 +- 0.396 (in-sample avg dev_std = 0.606)
NEC for r=0.2 all KL = 0.535 +- 0.396 (in-sample avg dev_std = 0.606)
NEC for r=0.2 all L1 = 0.426 +- 0.302 (in-sample avg dev_std = 0.606)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.497
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.052212301587301585
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.374
NEC for r=0.4 class 1.0 = 0.372 +- 0.370 (in-sample avg dev_std = 0.598)
NEC for r=0.4 all KL = 0.494 +- 0.370 (in-sample avg dev_std = 0.598)
NEC for r=0.4 all L1 = 0.372 +- 0.275 (in-sample avg dev_std = 0.598)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.02834920634920635
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.436
NEC for r=0.8 class 1.0 = 0.327 +- 0.366 (in-sample avg dev_std = 0.526)
NEC for r=0.8 all KL = 0.421 +- 0.366 (in-sample avg dev_std = 0.526)
NEC for r=0.8 all L1 = 0.327 +- 0.283 (in-sample avg dev_std = 0.526)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.745
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.46887236628849266
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.173
NEC for r=0.05 class 1.0 = 0.544 +- 0.446 (in-sample avg dev_std = 0.090)
NEC for r=0.05 all KL = 0.61 +- 0.446 (in-sample avg dev_std = 0.090)
NEC for r=0.05 all L1 = 0.544 +- 0.386 (in-sample avg dev_std = 0.090)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.745
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.37497893030794166
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.198
NEC for r=0.1 class 1.0 = 0.579 +- 0.402 (in-sample avg dev_std = 0.346)
NEC for r=0.1 all KL = 0.675 +- 0.402 (in-sample avg dev_std = 0.346)
NEC for r=0.1 all L1 = 0.579 +- 0.343 (in-sample avg dev_std = 0.346)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.745
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27524311183144246
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.337
NEC for r=0.2 class 1.0 = 0.541 +- 0.374 (in-sample avg dev_std = 0.540)
NEC for r=0.2 all KL = 0.685 +- 0.374 (in-sample avg dev_std = 0.540)
NEC for r=0.2 all L1 = 0.541 +- 0.300 (in-sample avg dev_std = 0.540)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.745
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19919611021069691
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 1.0 = 0.421 +- 0.369 (in-sample avg dev_std = 0.606)
NEC for r=0.4 all KL = 0.611 +- 0.369 (in-sample avg dev_std = 0.606)
NEC for r=0.4 all L1 = 0.421 +- 0.267 (in-sample avg dev_std = 0.606)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1469716369529984
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.648
NEC for r=0.8 class 1.0 = 0.284 +- 0.352 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all KL = 0.473 +- 0.352 (in-sample avg dev_std = 0.542)
NEC for r=0.8 all L1 = 0.284 +- 0.229 (in-sample avg dev_std = 0.542)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:34:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:34:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.685
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.648
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.508
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.343
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.211
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.202
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.110
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.059
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.032
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.449
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.367
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.279
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.205
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.156


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6850830324909746
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.721
SUFF_SIMPLE for r=0.05 class 1.0 = 0.7 +- 0.456 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.05 all KL = 0.52 +- 0.456 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.05 all L1 = 0.7 +- 0.344 (in-sample avg dev_std = 0.470)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6482851985559567
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 1.0 = 0.703 +- 0.453 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.1 all KL = 0.522 +- 0.453 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.1 all L1 = 0.703 +- 0.341 (in-sample avg dev_std = 0.487)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5078483754512637
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.714
SUFF_SIMPLE for r=0.2 class 1.0 = 0.695 +- 0.455 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.2 all KL = 0.526 +- 0.455 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.2 all L1 = 0.695 +- 0.352 (in-sample avg dev_std = 0.456)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3425776173285198
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.709
SUFF_SIMPLE for r=0.4 class 1.0 = 0.698 +- 0.447 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.4 all KL = 0.526 +- 0.447 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.4 all L1 = 0.698 +- 0.351 (in-sample avg dev_std = 0.418)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21086281588447653
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.895
SUFF_SIMPLE for r=0.8 class 1.0 = 0.886 +- 0.346 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 all KL = 0.818 +- 0.346 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.8 all L1 = 0.886 +- 0.260 (in-sample avg dev_std = 0.141)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.362
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36138809523809523
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.029
SUFF_SIMPLE for r=0.05 class 1.0 = 0.644 +- 0.425 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all KL = 0.618 +- 0.425 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all L1 = 0.644 +- 0.373 (in-sample avg dev_std = 0.247)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.362
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20229523809523808
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.029
SUFF_SIMPLE for r=0.1 class 1.0 = 0.645 +- 0.426 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all KL = 0.62 +- 0.426 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all L1 = 0.645 +- 0.374 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.362
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10970357142857141
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.025
SUFF_SIMPLE for r=0.2 class 1.0 = 0.645 +- 0.427 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.622 +- 0.427 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.645 +- 0.375 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.362
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05892301587301587
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.022
SUFF_SIMPLE for r=0.4 class 1.0 = 0.644 +- 0.428 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all KL = 0.62 +- 0.428 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all L1 = 0.644 +- 0.376 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03215912698412699
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.053
SUFF_SIMPLE for r=0.8 class 1.0 = 0.672 +- 0.419 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.8 all KL = 0.657 +- 0.419 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.8 all L1 = 0.672 +- 0.372 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.562
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.44946636952998376
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.408
SUFF_SIMPLE for r=0.05 class 1.0 = 0.613 +- 0.414 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 all KL = 0.554 +- 0.414 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 all L1 = 0.613 +- 0.348 (in-sample avg dev_std = 0.319)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.562
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3672568881685575
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.417
SUFF_SIMPLE for r=0.1 class 1.0 = 0.608 +- 0.416 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.1 all KL = 0.548 +- 0.416 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.1 all L1 = 0.608 +- 0.350 (in-sample avg dev_std = 0.307)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.562
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2787463533225284
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.443
SUFF_SIMPLE for r=0.2 class 1.0 = 0.584 +- 0.420 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 all KL = 0.518 +- 0.420 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.2 all L1 = 0.584 +- 0.352 (in-sample avg dev_std = 0.290)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.562
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20533144246353321
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.463
SUFF_SIMPLE for r=0.4 class 1.0 = 0.56 +- 0.421 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.4 all KL = 0.485 +- 0.421 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.4 all L1 = 0.56 +- 0.354 (in-sample avg dev_std = 0.283)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15607293354943275
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.591
SUFF_SIMPLE for r=0.8 class 1.0 = 0.696 +- 0.407 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.8 all KL = 0.654 +- 0.407 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.8 all L1 = 0.696 +- 0.344 (in-sample avg dev_std = 0.196)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6850830324909746
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.126
NEC for r=0.05 class 1.0 = 0.784 +- 0.181 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.951 +- 0.181 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.784 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6482851985559567
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.076
NEC for r=0.1 class 1.0 = 0.825 +- 0.110 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all KL = 0.983 +- 0.110 (in-sample avg dev_std = 0.315)
NEC for r=0.1 all L1 = 0.825 +- 0.124 (in-sample avg dev_std = 0.315)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5078483754512637
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.288
NEC for r=0.2 class 1.0 = 0.722 +- 0.076 (in-sample avg dev_std = 0.710)
NEC for r=0.2 all KL = 0.984 +- 0.076 (in-sample avg dev_std = 0.710)
NEC for r=0.2 all L1 = 0.722 +- 0.159 (in-sample avg dev_std = 0.710)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3425776173285198
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.588
NEC for r=0.4 class 1.0 = 0.492 +- 0.252 (in-sample avg dev_std = 0.745)
NEC for r=0.4 all KL = 0.863 +- 0.252 (in-sample avg dev_std = 0.745)
NEC for r=0.4 all L1 = 0.492 +- 0.249 (in-sample avg dev_std = 0.745)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21086281588447653
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.789
NEC for r=0.8 class 1.0 = 0.296 +- 0.346 (in-sample avg dev_std = 0.631)
NEC for r=0.8 all KL = 0.667 +- 0.346 (in-sample avg dev_std = 0.631)
NEC for r=0.8 all L1 = 0.296 +- 0.232 (in-sample avg dev_std = 0.631)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.362
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.36138809523809523
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.351 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.364 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.351 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.362
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20229523809523808
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.002
NEC for r=0.1 class 1.0 = 0.35 +- 0.432 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.363 +- 0.432 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.35 +- 0.385 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.362
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10970357142857141
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.017
NEC for r=0.2 class 1.0 = 0.35 +- 0.428 (in-sample avg dev_std = 0.200)
NEC for r=0.2 all KL = 0.369 +- 0.428 (in-sample avg dev_std = 0.200)
NEC for r=0.2 all L1 = 0.35 +- 0.377 (in-sample avg dev_std = 0.200)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.362
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05892301587301587
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.079
NEC for r=0.4 class 1.0 = 0.338 +- 0.412 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all KL = 0.374 +- 0.412 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all L1 = 0.338 +- 0.349 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03215912698412699
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.107
NEC for r=0.8 class 1.0 = 0.328 +- 0.403 (in-sample avg dev_std = 0.426)
NEC for r=0.8 all KL = 0.372 +- 0.403 (in-sample avg dev_std = 0.426)
NEC for r=0.8 all L1 = 0.328 +- 0.334 (in-sample avg dev_std = 0.426)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.562
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.44946636952998376
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.129
NEC for r=0.05 class 1.0 = 0.427 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.481 +- 0.447 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.427 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.562
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3672568881685575
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.088
NEC for r=0.1 class 1.0 = 0.463 +- 0.448 (in-sample avg dev_std = 0.074)
NEC for r=0.1 all KL = 0.522 +- 0.448 (in-sample avg dev_std = 0.074)
NEC for r=0.1 all L1 = 0.463 +- 0.389 (in-sample avg dev_std = 0.074)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.562
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2787463533225284
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.089
NEC for r=0.2 class 1.0 = 0.476 +- 0.437 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all KL = 0.546 +- 0.437 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all L1 = 0.476 +- 0.376 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.562
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20533144246353321
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.164
NEC for r=0.4 class 1.0 = 0.452 +- 0.424 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all KL = 0.54 +- 0.424 (in-sample avg dev_std = 0.436)
NEC for r=0.4 all L1 = 0.452 +- 0.349 (in-sample avg dev_std = 0.436)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15607293354943275
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.272
NEC for r=0.8 class 1.0 = 0.401 +- 0.405 (in-sample avg dev_std = 0.573)
NEC for r=0.8 all KL = 0.515 +- 0.405 (in-sample avg dev_std = 0.573)
NEC for r=0.8 all L1 = 0.401 +- 0.300 (in-sample avg dev_std = 0.573)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:40:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:40:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.681
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.585
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.433
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.299
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.184
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.324
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.181
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.099
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.053
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.029
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.471
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.368
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.266
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.196
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.148


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.680942238267148
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.707
SUFF_SIMPLE for r=0.05 class 1.0 = 0.671 +- 0.475 (in-sample avg dev_std = 0.589)
SUFF_SIMPLE for r=0.05 all KL = 0.445 +- 0.475 (in-sample avg dev_std = 0.589)
SUFF_SIMPLE for r=0.05 all L1 = 0.671 +- 0.335 (in-sample avg dev_std = 0.589)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5845342960288809
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 1.0 = 0.675 +- 0.474 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.1 all KL = 0.446 +- 0.474 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.1 all L1 = 0.675 +- 0.330 (in-sample avg dev_std = 0.570)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4334801444043322
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.712
SUFF_SIMPLE for r=0.2 class 1.0 = 0.673 +- 0.463 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.463 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.2 all L1 = 0.673 +- 0.337 (in-sample avg dev_std = 0.563)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2994007220216606
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.657
SUFF_SIMPLE for r=0.4 class 1.0 = 0.637 +- 0.475 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all KL = 0.43 +- 0.475 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all L1 = 0.637 +- 0.360 (in-sample avg dev_std = 0.507)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.18442960288808666
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.719
SUFF_SIMPLE for r=0.8 class 1.0 = 0.735 +- 0.469 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.8 all KL = 0.651 +- 0.469 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.8 all L1 = 0.735 +- 0.378 (in-sample avg dev_std = 0.282)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.637
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.32447023809523806
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.481
SUFF_SIMPLE for r=0.05 class 1.0 = 0.614 +- 0.397 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.05 all KL = 0.482 +- 0.397 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.05 all L1 = 0.614 +- 0.299 (in-sample avg dev_std = 0.554)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.637
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.18141984126984126
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.472
SUFF_SIMPLE for r=0.1 class 1.0 = 0.615 +- 0.399 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.1 all KL = 0.487 +- 0.399 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.302 (in-sample avg dev_std = 0.548)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.637
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09879365079365078
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.459
SUFF_SIMPLE for r=0.2 class 1.0 = 0.61 +- 0.403 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.2 all KL = 0.486 +- 0.403 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.2 all L1 = 0.61 +- 0.306 (in-sample avg dev_std = 0.542)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.637
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05326071428571428
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.432
SUFF_SIMPLE for r=0.4 class 1.0 = 0.597 +- 0.405 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.4 all KL = 0.472 +- 0.405 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.4 all L1 = 0.597 +- 0.310 (in-sample avg dev_std = 0.541)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.029078968253968253
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.387
SUFF_SIMPLE for r=0.8 class 1.0 = 0.631 +- 0.425 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.8 all KL = 0.596 +- 0.425 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.8 all L1 = 0.631 +- 0.365 (in-sample avg dev_std = 0.212)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.796
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4706580226904376
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.688
SUFF_SIMPLE for r=0.05 class 1.0 = 0.686 +- 0.438 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.05 all KL = 0.554 +- 0.438 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.05 all L1 = 0.686 +- 0.309 (in-sample avg dev_std = 0.421)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.796
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3683800648298217
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.703
SUFF_SIMPLE for r=0.1 class 1.0 = 0.693 +- 0.432 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all KL = 0.56 +- 0.432 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all L1 = 0.693 +- 0.316 (in-sample avg dev_std = 0.381)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.796
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2658042949756888
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.662
SUFF_SIMPLE for r=0.2 class 1.0 = 0.669 +- 0.438 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.2 all KL = 0.557 +- 0.438 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.2 all L1 = 0.669 +- 0.340 (in-sample avg dev_std = 0.351)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.796
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1960850891410049
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.597
SUFF_SIMPLE for r=0.4 class 1.0 = 0.644 +- 0.443 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 all KL = 0.564 +- 0.443 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 all L1 = 0.644 +- 0.362 (in-sample avg dev_std = 0.303)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.14821799027552676
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.749
SUFF_SIMPLE for r=0.8 class 1.0 = 0.755 +- 0.408 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.8 all KL = 0.726 +- 0.408 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.8 all L1 = 0.755 +- 0.346 (in-sample avg dev_std = 0.164)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.680942238267148
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.191
NEC for r=0.05 class 1.0 = 0.716 +- 0.318 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.864 +- 0.318 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.716 +- 0.305 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5845342960288809
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.307
NEC for r=0.1 class 1.0 = 0.668 +- 0.216 (in-sample avg dev_std = 0.515)
NEC for r=0.1 all KL = 0.934 +- 0.216 (in-sample avg dev_std = 0.515)
NEC for r=0.1 all L1 = 0.668 +- 0.255 (in-sample avg dev_std = 0.515)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4334801444043322
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.626
NEC for r=0.2 class 1.0 = 0.425 +- 0.335 (in-sample avg dev_std = 0.571)
NEC for r=0.2 all KL = 0.788 +- 0.335 (in-sample avg dev_std = 0.571)
NEC for r=0.2 all L1 = 0.425 +- 0.303 (in-sample avg dev_std = 0.571)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.2994007220216606
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.821
NEC for r=0.4 class 1.0 = 0.227 +- 0.423 (in-sample avg dev_std = 0.452)
NEC for r=0.4 all KL = 0.506 +- 0.423 (in-sample avg dev_std = 0.452)
NEC for r=0.4 all L1 = 0.227 +- 0.274 (in-sample avg dev_std = 0.452)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.18442960288808666
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.925
NEC for r=0.8 class 1.0 = 0.127 +- 0.409 (in-sample avg dev_std = 0.430)
NEC for r=0.8 all KL = 0.36 +- 0.409 (in-sample avg dev_std = 0.430)
NEC for r=0.8 all L1 = 0.127 +- 0.176 (in-sample avg dev_std = 0.430)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.637
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.32447023809523806
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.003
NEC for r=0.05 class 1.0 = 0.585 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.635 +- 0.433 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.585 +- 0.364 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.637
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.18141984126984126
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.05
NEC for r=0.1 class 1.0 = 0.568 +- 0.427 (in-sample avg dev_std = 0.202)
NEC for r=0.1 all KL = 0.627 +- 0.427 (in-sample avg dev_std = 0.202)
NEC for r=0.1 all L1 = 0.568 +- 0.358 (in-sample avg dev_std = 0.202)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.637
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09879365079365078
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.342
NEC for r=0.2 class 1.0 = 0.478 +- 0.347 (in-sample avg dev_std = 0.671)
NEC for r=0.2 all KL = 0.651 +- 0.347 (in-sample avg dev_std = 0.671)
NEC for r=0.2 all L1 = 0.478 +- 0.258 (in-sample avg dev_std = 0.671)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.637
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05326071428571428
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 1.0 = 0.39 +- 0.322 (in-sample avg dev_std = 0.654)
NEC for r=0.4 all KL = 0.579 +- 0.322 (in-sample avg dev_std = 0.654)
NEC for r=0.4 all L1 = 0.39 +- 0.229 (in-sample avg dev_std = 0.654)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.029078968253968253
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.546
NEC for r=0.8 class 1.0 = 0.328 +- 0.330 (in-sample avg dev_std = 0.584)
NEC for r=0.8 all KL = 0.479 +- 0.330 (in-sample avg dev_std = 0.584)
NEC for r=0.8 all L1 = 0.328 +- 0.237 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.796
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4706580226904376
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.164
NEC for r=0.05 class 1.0 = 0.582 +- 0.439 (in-sample avg dev_std = 0.092)
NEC for r=0.05 all KL = 0.664 +- 0.439 (in-sample avg dev_std = 0.092)
NEC for r=0.05 all L1 = 0.582 +- 0.378 (in-sample avg dev_std = 0.092)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.796
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3683800648298217
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.197
NEC for r=0.1 class 1.0 = 0.614 +- 0.389 (in-sample avg dev_std = 0.389)
NEC for r=0.1 all KL = 0.732 +- 0.389 (in-sample avg dev_std = 0.389)
NEC for r=0.1 all L1 = 0.614 +- 0.329 (in-sample avg dev_std = 0.389)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.796
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.2658042949756888
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.366
NEC for r=0.2 class 1.0 = 0.538 +- 0.361 (in-sample avg dev_std = 0.567)
NEC for r=0.2 all KL = 0.725 +- 0.361 (in-sample avg dev_std = 0.567)
NEC for r=0.2 all L1 = 0.538 +- 0.295 (in-sample avg dev_std = 0.567)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.796
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1960850891410049
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.573
NEC for r=0.4 class 1.0 = 0.407 +- 0.368 (in-sample avg dev_std = 0.583)
NEC for r=0.4 all KL = 0.643 +- 0.368 (in-sample avg dev_std = 0.583)
NEC for r=0.4 all L1 = 0.407 +- 0.277 (in-sample avg dev_std = 0.583)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.14821799027552676
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.694
NEC for r=0.8 class 1.0 = 0.298 +- 0.377 (in-sample avg dev_std = 0.496)
NEC for r=0.8 all KL = 0.495 +- 0.377 (in-sample avg dev_std = 0.496)
NEC for r=0.8 all L1 = 0.298 +- 0.268 (in-sample avg dev_std = 0.496)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:45:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:45:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.710
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.645
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.490
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.327
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.200
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.312
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.174
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.094
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.050
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.028
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.449
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.362
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.267
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.197
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.150


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7101696750902526
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.653
SUFF_SIMPLE for r=0.05 class 1.0 = 0.631 +- 0.452 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all KL = 0.396 +- 0.452 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.05 all L1 = 0.631 +- 0.347 (in-sample avg dev_std = 0.547)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6450541516245487
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.655
SUFF_SIMPLE for r=0.1 class 1.0 = 0.637 +- 0.464 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.1 all KL = 0.422 +- 0.464 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.1 all L1 = 0.637 +- 0.354 (in-sample avg dev_std = 0.537)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4897942238267148
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.644
SUFF_SIMPLE for r=0.2 class 1.0 = 0.628 +- 0.461 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 all KL = 0.416 +- 0.461 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 all L1 = 0.628 +- 0.357 (in-sample avg dev_std = 0.526)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.32699638989169677
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.613
SUFF_SIMPLE for r=0.4 class 1.0 = 0.603 +- 0.459 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 all KL = 0.395 +- 0.459 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 all L1 = 0.603 +- 0.362 (in-sample avg dev_std = 0.521)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20033212996389893
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.733
SUFF_SIMPLE for r=0.8 class 1.0 = 0.746 +- 0.463 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.8 all KL = 0.655 +- 0.463 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.8 all L1 = 0.746 +- 0.368 (in-sample avg dev_std = 0.270)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.588
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.31244285714285713
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.2
SUFF_SIMPLE for r=0.05 class 1.0 = 0.514 +- 0.417 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.05 all KL = 0.405 +- 0.417 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.05 all L1 = 0.514 +- 0.335 (in-sample avg dev_std = 0.555)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.588
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.17352261904761904
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.198
SUFF_SIMPLE for r=0.1 class 1.0 = 0.512 +- 0.419 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.1 all KL = 0.402 +- 0.419 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.1 all L1 = 0.512 +- 0.335 (in-sample avg dev_std = 0.562)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.588
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09356626984126984
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.198
SUFF_SIMPLE for r=0.2 class 1.0 = 0.511 +- 0.415 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 all KL = 0.4 +- 0.415 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.2 all L1 = 0.511 +- 0.334 (in-sample avg dev_std = 0.558)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.588
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05014285714285714
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.19
SUFF_SIMPLE for r=0.4 class 1.0 = 0.503 +- 0.414 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.4 all KL = 0.393 +- 0.414 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.337 (in-sample avg dev_std = 0.546)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027825
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.209
SUFF_SIMPLE for r=0.8 class 1.0 = 0.579 +- 0.447 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 all KL = 0.529 +- 0.447 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 all L1 = 0.579 +- 0.383 (in-sample avg dev_std = 0.224)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.44873824959481357
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.537
SUFF_SIMPLE for r=0.05 class 1.0 = 0.67 +- 0.446 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.05 all KL = 0.585 +- 0.446 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.05 all L1 = 0.67 +- 0.361 (in-sample avg dev_std = 0.347)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3617358184764992
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.537
SUFF_SIMPLE for r=0.1 class 1.0 = 0.672 +- 0.448 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.1 all KL = 0.587 +- 0.448 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.1 all L1 = 0.672 +- 0.363 (in-sample avg dev_std = 0.336)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26712236628849273
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.537
SUFF_SIMPLE for r=0.2 class 1.0 = 0.665 +- 0.449 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all KL = 0.579 +- 0.449 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.2 all L1 = 0.665 +- 0.364 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19691288492706646
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.521
SUFF_SIMPLE for r=0.4 class 1.0 = 0.635 +- 0.449 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 all KL = 0.544 +- 0.449 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 all L1 = 0.635 +- 0.366 (in-sample avg dev_std = 0.330)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15049878444084278
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.656
SUFF_SIMPLE for r=0.8 class 1.0 = 0.77 +- 0.403 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all KL = 0.729 +- 0.403 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.8 all L1 = 0.77 +- 0.336 (in-sample avg dev_std = 0.216)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7101696750902526
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.126
NEC for r=0.05 class 1.0 = 0.779 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.951 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.779 +- 0.217 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6450541516245487
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.138
NEC for r=0.1 class 1.0 = 0.791 +- 0.151 (in-sample avg dev_std = 0.465)
NEC for r=0.1 all KL = 0.97 +- 0.151 (in-sample avg dev_std = 0.465)
NEC for r=0.1 all L1 = 0.791 +- 0.164 (in-sample avg dev_std = 0.465)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.4897942238267148
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.378
NEC for r=0.2 class 1.0 = 0.66 +- 0.105 (in-sample avg dev_std = 0.726)
NEC for r=0.2 all KL = 0.979 +- 0.105 (in-sample avg dev_std = 0.726)
NEC for r=0.2 all L1 = 0.66 +- 0.198 (in-sample avg dev_std = 0.726)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.32699638989169677
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.654
NEC for r=0.4 class 1.0 = 0.426 +- 0.311 (in-sample avg dev_std = 0.691)
NEC for r=0.4 all KL = 0.811 +- 0.311 (in-sample avg dev_std = 0.691)
NEC for r=0.4 all L1 = 0.426 +- 0.275 (in-sample avg dev_std = 0.691)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.20033212996389893
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.81
NEC for r=0.8 class 1.0 = 0.269 +- 0.386 (in-sample avg dev_std = 0.621)
NEC for r=0.8 all KL = 0.635 +- 0.386 (in-sample avg dev_std = 0.621)
NEC for r=0.8 all L1 = 0.269 +- 0.241 (in-sample avg dev_std = 0.621)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.588
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.31244285714285713
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.533 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.583 +- 0.454 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.533 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.588
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.17352261904761904
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.004
NEC for r=0.1 class 1.0 = 0.532 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.1 all KL = 0.582 +- 0.454 (in-sample avg dev_std = 0.054)
NEC for r=0.1 all L1 = 0.532 +- 0.389 (in-sample avg dev_std = 0.054)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.588
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09356626984126984
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.066
NEC for r=0.2 class 1.0 = 0.517 +- 0.444 (in-sample avg dev_std = 0.403)
NEC for r=0.2 all KL = 0.588 +- 0.444 (in-sample avg dev_std = 0.403)
NEC for r=0.2 all L1 = 0.517 +- 0.368 (in-sample avg dev_std = 0.403)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.588
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05014285714285714
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.222
NEC for r=0.4 class 1.0 = 0.464 +- 0.415 (in-sample avg dev_std = 0.628)
NEC for r=0.4 all KL = 0.594 +- 0.415 (in-sample avg dev_std = 0.628)
NEC for r=0.4 all L1 = 0.464 +- 0.314 (in-sample avg dev_std = 0.628)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.027825
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.364
NEC for r=0.8 class 1.0 = 0.406 +- 0.366 (in-sample avg dev_std = 0.665)
NEC for r=0.8 all KL = 0.586 +- 0.366 (in-sample avg dev_std = 0.665)
NEC for r=0.8 all L1 = 0.406 +- 0.263 (in-sample avg dev_std = 0.665)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.44873824959481357
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.128
NEC for r=0.05 class 1.0 = 0.597 +- 0.424 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all KL = 0.695 +- 0.424 (in-sample avg dev_std = 0.056)
NEC for r=0.05 all L1 = 0.597 +- 0.367 (in-sample avg dev_std = 0.056)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3617358184764992
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.119
NEC for r=0.1 class 1.0 = 0.628 +- 0.396 (in-sample avg dev_std = 0.299)
NEC for r=0.1 all KL = 0.737 +- 0.396 (in-sample avg dev_std = 0.299)
NEC for r=0.1 all L1 = 0.628 +- 0.338 (in-sample avg dev_std = 0.299)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.26712236628849273
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.2
NEC for r=0.2 class 1.0 = 0.597 +- 0.380 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all KL = 0.743 +- 0.380 (in-sample avg dev_std = 0.516)
NEC for r=0.2 all L1 = 0.597 +- 0.311 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.19691288492706646
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.333
NEC for r=0.4 class 1.0 = 0.516 +- 0.373 (in-sample avg dev_std = 0.638)
NEC for r=0.4 all KL = 0.712 +- 0.373 (in-sample avg dev_std = 0.638)
NEC for r=0.4 all L1 = 0.516 +- 0.292 (in-sample avg dev_std = 0.638)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15049878444084278
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.473
NEC for r=0.8 class 1.0 = 0.398 +- 0.386 (in-sample avg dev_std = 0.637)
NEC for r=0.8 all KL = 0.621 +- 0.386 (in-sample avg dev_std = 0.637)
NEC for r=0.8 all L1 = 0.398 +- 0.277 (in-sample avg dev_std = 0.637)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:50:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:50:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.700
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.650
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.495
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.329
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.201
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.346
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.192
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.104
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.056
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.031
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.464
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.372
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.277
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.202
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.150


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7002815884476534
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.729
SUFF_SIMPLE for r=0.05 class 1.0 = 0.702 +- 0.479 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.05 all KL = 0.511 +- 0.479 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.05 all L1 = 0.702 +- 0.342 (in-sample avg dev_std = 0.515)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6499855595667869
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.694
SUFF_SIMPLE for r=0.1 class 1.0 = 0.677 +- 0.486 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.1 all KL = 0.5 +- 0.486 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.1 all L1 = 0.677 +- 0.357 (in-sample avg dev_std = 0.530)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49518050541516245
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.679
SUFF_SIMPLE for r=0.2 class 1.0 = 0.67 +- 0.488 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all KL = 0.498 +- 0.488 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all L1 = 0.67 +- 0.364 (in-sample avg dev_std = 0.504)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3291046931407942
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.645
SUFF_SIMPLE for r=0.4 class 1.0 = 0.639 +- 0.480 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.480 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.4 all L1 = 0.639 +- 0.369 (in-sample avg dev_std = 0.508)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2006462093862816
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.708
SUFF_SIMPLE for r=0.8 class 1.0 = 0.723 +- 0.476 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.8 all KL = 0.628 +- 0.476 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.8 all L1 = 0.723 +- 0.378 (in-sample avg dev_std = 0.323)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.782
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3456142857142857
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.286
SUFF_SIMPLE for r=0.05 class 1.0 = 0.46 +- 0.392 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all KL = 0.286 +- 0.392 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all L1 = 0.46 +- 0.317 (in-sample avg dev_std = 0.584)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.782
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.19230039682539685
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.269
SUFF_SIMPLE for r=0.1 class 1.0 = 0.45 +- 0.396 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.1 all KL = 0.285 +- 0.396 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.1 all L1 = 0.45 +- 0.319 (in-sample avg dev_std = 0.574)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.782
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10410992063492062
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.249
SUFF_SIMPLE for r=0.2 class 1.0 = 0.438 +- 0.392 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.2 all KL = 0.276 +- 0.392 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.2 all L1 = 0.438 +- 0.319 (in-sample avg dev_std = 0.563)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.782
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05607619047619048
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.235
SUFF_SIMPLE for r=0.4 class 1.0 = 0.43 +- 0.394 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 all KL = 0.277 +- 0.394 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 all L1 = 0.43 +- 0.322 (in-sample avg dev_std = 0.551)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.031007936507936512
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.201
SUFF_SIMPLE for r=0.8 class 1.0 = 0.449 +- 0.439 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all L1 = 0.449 +- 0.375 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.81
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4639323338735819
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.575
SUFF_SIMPLE for r=0.05 class 1.0 = 0.663 +- 0.439 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.05 all KL = 0.575 +- 0.439 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.05 all L1 = 0.663 +- 0.349 (in-sample avg dev_std = 0.387)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.81
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3723026742301459
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.57
SUFF_SIMPLE for r=0.1 class 1.0 = 0.66 +- 0.443 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all KL = 0.576 +- 0.443 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all L1 = 0.66 +- 0.353 (in-sample avg dev_std = 0.364)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.81
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27737925445705025
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.571
SUFF_SIMPLE for r=0.2 class 1.0 = 0.648 +- 0.445 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 all KL = 0.563 +- 0.445 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.2 all L1 = 0.648 +- 0.355 (in-sample avg dev_std = 0.361)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.81
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20185777957860618
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.578
SUFF_SIMPLE for r=0.4 class 1.0 = 0.632 +- 0.449 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.4 all KL = 0.551 +- 0.449 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.4 all L1 = 0.632 +- 0.361 (in-sample avg dev_std = 0.328)


ratio=0.8


40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0

Model Accuracy of binarized graphs for r=0.8 =  0.811
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15045016207455428
len(reference) = 2461
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.716
SUFF_SIMPLE for r=0.8 class 1.0 = 0.78 +- 0.396 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.8 all KL = 0.757 +- 0.396 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.8 all L1 = 0.78 +- 0.332 (in-sample avg dev_std = 0.124)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7002815884476534
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.195
NEC for r=0.05 class 1.0 = 0.721 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.888 +- 0.283 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.721 +- 0.286 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6499855595667869
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.219
NEC for r=0.1 class 1.0 = 0.741 +- 0.185 (in-sample avg dev_std = 0.549)
NEC for r=0.1 all KL = 0.958 +- 0.185 (in-sample avg dev_std = 0.549)
NEC for r=0.1 all L1 = 0.741 +- 0.201 (in-sample avg dev_std = 0.549)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.49518050541516245
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.511
NEC for r=0.2 class 1.0 = 0.53 +- 0.273 (in-sample avg dev_std = 0.672)
NEC for r=0.2 all KL = 0.884 +- 0.273 (in-sample avg dev_std = 0.672)
NEC for r=0.2 all L1 = 0.53 +- 0.283 (in-sample avg dev_std = 0.672)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.3291046931407942
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.739
NEC for r=0.4 class 1.0 = 0.313 +- 0.417 (in-sample avg dev_std = 0.571)
NEC for r=0.4 all KL = 0.637 +- 0.417 (in-sample avg dev_std = 0.571)
NEC for r=0.4 all L1 = 0.313 +- 0.299 (in-sample avg dev_std = 0.571)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.2006462093862816
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.872
NEC for r=0.8 class 1.0 = 0.179 +- 0.439 (in-sample avg dev_std = 0.517)
NEC for r=0.8 all KL = 0.415 +- 0.439 (in-sample avg dev_std = 0.517)
NEC for r=0.8 all L1 = 0.179 +- 0.240 (in-sample avg dev_std = 0.517)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.782
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3456142857142857
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.013
NEC for r=0.05 class 1.0 = 0.686 +- 0.384 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.771 +- 0.384 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.686 +- 0.321 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.782
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.19230039682539685
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.154
NEC for r=0.1 class 1.0 = 0.602 +- 0.407 (in-sample avg dev_std = 0.282)
NEC for r=0.1 all KL = 0.705 +- 0.407 (in-sample avg dev_std = 0.282)
NEC for r=0.1 all L1 = 0.602 +- 0.346 (in-sample avg dev_std = 0.282)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.782
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.10410992063492062
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.392
NEC for r=0.2 class 1.0 = 0.501 +- 0.353 (in-sample avg dev_std = 0.722)
NEC for r=0.2 all KL = 0.736 +- 0.353 (in-sample avg dev_std = 0.722)
NEC for r=0.2 all L1 = 0.501 +- 0.265 (in-sample avg dev_std = 0.722)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.782
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05607619047619048
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.489
NEC for r=0.4 class 1.0 = 0.41 +- 0.365 (in-sample avg dev_std = 0.668)
NEC for r=0.4 all KL = 0.667 +- 0.365 (in-sample avg dev_std = 0.668)
NEC for r=0.4 all L1 = 0.41 +- 0.264 (in-sample avg dev_std = 0.668)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.031007936507936512
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.531
NEC for r=0.8 class 1.0 = 0.345 +- 0.388 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all KL = 0.55 +- 0.388 (in-sample avg dev_std = 0.572)
NEC for r=0.8 all L1 = 0.345 +- 0.287 (in-sample avg dev_std = 0.572)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.81
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4639323338735819
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.151
NEC for r=0.05 class 1.0 = 0.593 +- 0.428 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all KL = 0.677 +- 0.428 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all L1 = 0.593 +- 0.371 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.81
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.3723026742301459
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.149
NEC for r=0.1 class 1.0 = 0.621 +- 0.402 (in-sample avg dev_std = 0.290)
NEC for r=0.1 all KL = 0.719 +- 0.402 (in-sample avg dev_std = 0.290)
NEC for r=0.1 all L1 = 0.621 +- 0.341 (in-sample avg dev_std = 0.290)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.81
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27737925445705025
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.237
NEC for r=0.2 class 1.0 = 0.59 +- 0.377 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all KL = 0.722 +- 0.377 (in-sample avg dev_std = 0.508)
NEC for r=0.2 all L1 = 0.59 +- 0.308 (in-sample avg dev_std = 0.508)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.81
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.20185777957860618
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.419
NEC for r=0.4 class 1.0 = 0.478 +- 0.377 (in-sample avg dev_std = 0.632)
NEC for r=0.4 all KL = 0.657 +- 0.377 (in-sample avg dev_std = 0.632)
NEC for r=0.4 all L1 = 0.478 +- 0.287 (in-sample avg dev_std = 0.632)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15045016207455428
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.556
NEC for r=0.8 class 1.0 = 0.359 +- 0.380 (in-sample avg dev_std = 0.596)
NEC for r=0.8 all KL = 0.559 +- 0.380 (in-sample avg dev_std = 0.596)
NEC for r=0.8 all L1 = 0.359 +- 0.268 (in-sample avg dev_std = 0.596)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 20:56:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 08:56:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.684
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.649
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.510
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.343
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.213
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.361
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.204
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.112
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.444
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.361
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.275
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.200
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.153


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.683812274368231
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.724
SUFF_SIMPLE for r=0.05 class 1.0 = 0.694 +- 0.478 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.05 all KL = 0.483 +- 0.478 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.05 all L1 = 0.694 +- 0.340 (in-sample avg dev_std = 0.542)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6489169675090253
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.715
SUFF_SIMPLE for r=0.1 class 1.0 = 0.69 +- 0.471 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all KL = 0.476 +- 0.471 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all L1 = 0.69 +- 0.345 (in-sample avg dev_std = 0.525)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.509740072202166
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.69
SUFF_SIMPLE for r=0.2 class 1.0 = 0.678 +- 0.480 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.2 all KL = 0.485 +- 0.480 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.2 all L1 = 0.678 +- 0.359 (in-sample avg dev_std = 0.495)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.34317328519855594
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.657
SUFF_SIMPLE for r=0.4 class 1.0 = 0.649 +- 0.473 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 all KL = 0.444 +- 0.473 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 all L1 = 0.649 +- 0.363 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21292418772563176
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.745
SUFF_SIMPLE for r=0.8 class 1.0 = 0.757 +- 0.461 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.8 all KL = 0.656 +- 0.461 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.8 all L1 = 0.757 +- 0.362 (in-sample avg dev_std = 0.309)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3614865079365079
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.009
SUFF_SIMPLE for r=0.05 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 all L1 = 0.519 +- 0.378 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20410476190476193
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.01
SUFF_SIMPLE for r=0.1 class 1.0 = 0.52 +- 0.438 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.1 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.1 all L1 = 0.52 +- 0.378 (in-sample avg dev_std = 0.159)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.11228373015873015
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.011
SUFF_SIMPLE for r=0.2 class 1.0 = 0.52 +- 0.438 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.2 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.2 all L1 = 0.52 +- 0.378 (in-sample avg dev_std = 0.166)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06112817460317461
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.007
SUFF_SIMPLE for r=0.4 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all KL = 0.495 +- 0.439 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.4 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.132)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03342698412698413
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.02
SUFF_SIMPLE for r=0.8 class 1.0 = 0.53 +- 0.437 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all KL = 0.507 +- 0.437 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all L1 = 0.53 +- 0.379 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.913
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4442127228525122
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.69
SUFF_SIMPLE for r=0.05 class 1.0 = 0.736 +- 0.451 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.05 all KL = 0.663 +- 0.451 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.05 all L1 = 0.736 +- 0.367 (in-sample avg dev_std = 0.303)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.913
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36118435980551056
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.7
SUFF_SIMPLE for r=0.1 class 1.0 = 0.725 +- 0.455 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all KL = 0.663 +- 0.455 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all L1 = 0.725 +- 0.377 (in-sample avg dev_std = 0.262)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.913
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27481077795786063
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.718
SUFF_SIMPLE for r=0.2 class 1.0 = 0.716 +- 0.462 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.2 all KL = 0.652 +- 0.462 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.2 all L1 = 0.716 +- 0.384 (in-sample avg dev_std = 0.212)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.913
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1998363047001621
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.693
SUFF_SIMPLE for r=0.4 class 1.0 = 0.714 +- 0.461 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all KL = 0.641 +- 0.461 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all L1 = 0.714 +- 0.380 (in-sample avg dev_std = 0.216)


ratio=0.8


40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0

Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15321069692058348
len(reference) = 2453
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.824
SUFF_SIMPLE for r=0.8 class 1.0 = 0.864 +- 0.341 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all KL = 0.846 +- 0.341 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.8 all L1 = 0.864 +- 0.293 (in-sample avg dev_std = 0.046)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.683812274368231
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.069
NEC for r=0.05 class 1.0 = 0.815 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.967 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.815 +- 0.178 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6489169675090253
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.098
NEC for r=0.1 class 1.0 = 0.815 +- 0.108 (in-sample avg dev_std = 0.421)
NEC for r=0.1 all KL = 0.986 +- 0.108 (in-sample avg dev_std = 0.421)
NEC for r=0.1 all L1 = 0.815 +- 0.131 (in-sample avg dev_std = 0.421)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.509740072202166
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.376
NEC for r=0.2 class 1.0 = 0.659 +- 0.112 (in-sample avg dev_std = 0.741)
NEC for r=0.2 all KL = 0.978 +- 0.112 (in-sample avg dev_std = 0.741)
NEC for r=0.2 all L1 = 0.659 +- 0.204 (in-sample avg dev_std = 0.741)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.34317328519855594
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 1.0 = 0.416 +- 0.301 (in-sample avg dev_std = 0.730)
NEC for r=0.4 all KL = 0.848 +- 0.301 (in-sample avg dev_std = 0.730)
NEC for r=0.4 all L1 = 0.416 +- 0.258 (in-sample avg dev_std = 0.730)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.21292418772563176
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.848
NEC for r=0.8 class 1.0 = 0.219 +- 0.440 (in-sample avg dev_std = 0.584)
NEC for r=0.8 all KL = 0.574 +- 0.440 (in-sample avg dev_std = 0.584)
NEC for r=0.8 all L1 = 0.219 +- 0.229 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.3614865079365079
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.001
NEC for r=0.05 class 1.0 = 0.482 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.505 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.482 +- 0.381 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.20410476190476193
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.014
NEC for r=0.1 class 1.0 = 0.472 +- 0.439 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all KL = 0.495 +- 0.439 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all L1 = 0.472 +- 0.380 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.11228373015873015
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.026
NEC for r=0.2 class 1.0 = 0.476 +- 0.436 (in-sample avg dev_std = 0.248)
NEC for r=0.2 all KL = 0.505 +- 0.436 (in-sample avg dev_std = 0.248)
NEC for r=0.2 all L1 = 0.476 +- 0.373 (in-sample avg dev_std = 0.248)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06112817460317461
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.062
NEC for r=0.4 class 1.0 = 0.462 +- 0.431 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all KL = 0.503 +- 0.431 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all L1 = 0.462 +- 0.360 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.03342698412698413
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.074
NEC for r=0.8 class 1.0 = 0.458 +- 0.428 (in-sample avg dev_std = 0.392)
NEC for r=0.8 all KL = 0.502 +- 0.428 (in-sample avg dev_std = 0.392)
NEC for r=0.8 all L1 = 0.458 +- 0.355 (in-sample avg dev_std = 0.392)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.913
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.4442127228525122
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.147
NEC for r=0.05 class 1.0 = 0.695 +- 0.355 (in-sample avg dev_std = 0.154)
NEC for r=0.05 all KL = 0.831 +- 0.355 (in-sample avg dev_std = 0.154)
NEC for r=0.05 all L1 = 0.695 +- 0.306 (in-sample avg dev_std = 0.154)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.913
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.36118435980551056
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.191
NEC for r=0.1 class 1.0 = 0.686 +- 0.333 (in-sample avg dev_std = 0.436)
NEC for r=0.1 all KL = 0.848 +- 0.333 (in-sample avg dev_std = 0.436)
NEC for r=0.1 all L1 = 0.686 +- 0.289 (in-sample avg dev_std = 0.436)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.913
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.27481077795786063
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.343
NEC for r=0.2 class 1.0 = 0.593 +- 0.333 (in-sample avg dev_std = 0.602)
NEC for r=0.2 all KL = 0.827 +- 0.333 (in-sample avg dev_std = 0.602)
NEC for r=0.2 all L1 = 0.593 +- 0.293 (in-sample avg dev_std = 0.602)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.913
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1998363047001621
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.536
NEC for r=0.4 class 1.0 = 0.452 +- 0.369 (in-sample avg dev_std = 0.648)
NEC for r=0.4 all KL = 0.737 +- 0.369 (in-sample avg dev_std = 0.648)
NEC for r=0.4 all L1 = 0.452 +- 0.294 (in-sample avg dev_std = 0.648)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.15321069692058348
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.704
NEC for r=0.8 class 1.0 = 0.299 +- 0.410 (in-sample avg dev_std = 0.615)
NEC for r=0.8 all KL = 0.582 +- 0.410 (in-sample avg dev_std = 0.615)
NEC for r=0.8 all L1 = 0.299 +- 0.269 (in-sample avg dev_std = 0.615)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.414, 0.421, 0.429, 0.429, 0.699], 'all_L1': [0.639, 0.633, 0.64, 0.623, 0.765]}), defaultdict(<class 'list'>, {'all_KL': [0.517, 0.509, 0.49, 0.5, 0.7], 'all_L1': [0.709, 0.682, 0.669, 0.668, 0.772]}), defaultdict(<class 'list'>, {'all_KL': [0.5, 0.508, 0.477, 0.44, 0.582], 'all_L1': [0.695, 0.688, 0.661, 0.628, 0.688]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.393, 0.392, 0.373, 0.674], 'all_L1': [0.653, 0.651, 0.647, 0.635, 0.779]}), defaultdict(<class 'list'>, {'all_KL': [0.498, 0.507, 0.51, 0.505, 0.627], 'all_L1': [0.693, 0.685, 0.683, 0.679, 0.723]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.522, 0.526, 0.526, 0.818], 'all_L1': [0.7, 0.703, 0.695, 0.698, 0.886]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.446, 0.447, 0.43, 0.651], 'all_L1': [0.671, 0.675, 0.673, 0.637, 0.735]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.422, 0.416, 0.395, 0.655], 'all_L1': [0.631, 0.637, 0.628, 0.603, 0.746]}), defaultdict(<class 'list'>, {'all_KL': [0.511, 0.5, 0.498, 0.456, 0.628], 'all_L1': [0.702, 0.677, 0.67, 0.639, 0.723]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.476, 0.485, 0.444, 0.656], 'all_L1': [0.694, 0.69, 0.678, 0.649, 0.757]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.868, 0.954, 0.852, 0.622, 0.416], 'all_L1': [0.713, 0.722, 0.485, 0.301, 0.17]}), defaultdict(<class 'list'>, {'all_KL': [0.893, 0.964, 0.904, 0.685, 0.459], 'all_L1': [0.729, 0.763, 0.566, 0.363, 0.191]}), defaultdict(<class 'list'>, {'all_KL': [0.81, 0.934, 0.864, 0.612, 0.382], 'all_L1': [0.643, 0.704, 0.489, 0.294, 0.159]}), defaultdict(<class 'list'>, {'all_KL': [0.95, 0.986, 0.97, 0.826, 0.58], 'all_L1': [0.779, 0.802, 0.662, 0.439, 0.256]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.946, 0.79, 0.494, 0.292], 'all_L1': [0.713, 0.712, 0.448, 0.24, 0.117]}), defaultdict(<class 'list'>, {'all_KL': [0.951, 0.983, 0.984, 0.863, 0.667], 'all_L1': [0.784, 0.825, 0.722, 0.492, 0.296]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.934, 0.788, 0.506, 0.36], 'all_L1': [0.716, 0.668, 0.425, 0.227, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.951, 0.97, 0.979, 0.811, 0.635], 'all_L1': [0.779, 0.791, 0.66, 0.426, 0.269]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.958, 0.884, 0.637, 0.415], 'all_L1': [0.721, 0.741, 0.53, 0.313, 0.179]}), defaultdict(<class 'list'>, {'all_KL': [0.967, 0.986, 0.978, 0.848, 0.574], 'all_L1': [0.815, 0.815, 0.659, 0.416, 0.219]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.506, 0.507, 0.512, 0.516, 0.615], 'all_L1': [0.591, 0.593, 0.593, 0.594, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.307, 0.308, 0.308, 0.303, 0.396], 'all_L1': [0.415, 0.416, 0.412, 0.402, 0.45]}), defaultdict(<class 'list'>, {'all_KL': [0.188, 0.186, 0.173, 0.16, 0.168], 'all_L1': [0.359, 0.355, 0.339, 0.313, 0.277]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.232, 0.232, 0.233, 0.335], 'all_L1': [0.306, 0.306, 0.305, 0.305, 0.408]}), defaultdict(<class 'list'>, {'all_KL': [0.476, 0.479, 0.473, 0.471, 0.575], 'all_L1': [0.575, 0.577, 0.573, 0.566, 0.607]}), defaultdict(<class 'list'>, {'all_KL': [0.618, 0.62, 0.622, 0.62, 0.657], 'all_L1': [0.644, 0.645, 0.645, 0.644, 0.672]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.487, 0.486, 0.472, 0.596], 'all_L1': [0.614, 0.615, 0.61, 0.597, 0.631]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.402, 0.4, 0.393, 0.529], 'all_L1': [0.514, 0.512, 0.511, 0.503, 0.579]}), defaultdict(<class 'list'>, {'all_KL': [0.286, 0.285, 0.276, 0.277, 0.361], 'all_L1': [0.46, 0.45, 0.438, 0.43, 0.449]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.494, 0.494, 0.495, 0.507], 'all_L1': [0.519, 0.52, 0.52, 0.519, 0.53]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.459, 0.453, 0.491, 0.493, 0.47], 'all_L1': [0.427, 0.419, 0.412, 0.374, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.767, 0.746, 0.745, 0.671, 0.627], 'all_L1': [0.702, 0.677, 0.617, 0.51, 0.479]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.858, 0.868, 0.809, 0.721], 'all_L1': [0.767, 0.751, 0.671, 0.507, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.766, 0.767, 0.767, 0.762, 0.759], 'all_L1': [0.695, 0.695, 0.69, 0.66, 0.646]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.492, 0.535, 0.494, 0.421], 'all_L1': [0.467, 0.458, 0.426, 0.372, 0.327]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.363, 0.369, 0.374, 0.372], 'all_L1': [0.351, 0.35, 0.35, 0.338, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.635, 0.627, 0.651, 0.579, 0.479], 'all_L1': [0.585, 0.568, 0.478, 0.39, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.583, 0.582, 0.588, 0.594, 0.586], 'all_L1': [0.533, 0.532, 0.517, 0.464, 0.406]}), defaultdict(<class 'list'>, {'all_KL': [0.771, 0.705, 0.736, 0.667, 0.55], 'all_L1': [0.686, 0.602, 0.501, 0.41, 0.345]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.495, 0.505, 0.503, 0.502], 'all_L1': [0.482, 0.472, 0.476, 0.462, 0.458]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.603, 0.611, 0.616, 0.597, 0.791], 'all_L1': [0.684, 0.7, 0.699, 0.666, 0.817]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.568, 0.565, 0.546, 0.749], 'all_L1': [0.641, 0.642, 0.634, 0.612, 0.771]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.575, 0.56, 0.528, 0.666], 'all_L1': [0.645, 0.639, 0.625, 0.594, 0.702]}), defaultdict(<class 'list'>, {'all_KL': [0.672, 0.674, 0.665, 0.644, 0.819], 'all_L1': [0.719, 0.718, 0.711, 0.696, 0.828]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.563, 0.556, 0.525, 0.745], 'all_L1': [0.642, 0.642, 0.631, 0.597, 0.765]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.548, 0.518, 0.485, 0.654], 'all_L1': [0.613, 0.608, 0.584, 0.56, 0.696]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.56, 0.557, 0.564, 0.726], 'all_L1': [0.686, 0.693, 0.669, 0.644, 0.755]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.587, 0.579, 0.544, 0.729], 'all_L1': [0.67, 0.672, 0.665, 0.635, 0.77]}), defaultdict(<class 'list'>, {'all_KL': [0.575, 0.576, 0.563, 0.551, 0.757], 'all_L1': [0.663, 0.66, 0.648, 0.632, 0.78]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.663, 0.652, 0.641, 0.846], 'all_L1': [0.736, 0.725, 0.716, 0.714, 0.864]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.661, 0.73, 0.728, 0.669, 0.527], 'all_L1': [0.565, 0.591, 0.543, 0.442, 0.304]}), defaultdict(<class 'list'>, {'all_KL': [0.626, 0.674, 0.675, 0.642, 0.538], 'all_L1': [0.552, 0.589, 0.563, 0.484, 0.343]}), defaultdict(<class 'list'>, {'all_KL': [0.591, 0.624, 0.638, 0.606, 0.502], 'all_L1': [0.527, 0.545, 0.536, 0.476, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.774, 0.807, 0.787, 0.734, 0.63], 'all_L1': [0.666, 0.691, 0.644, 0.549, 0.419]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.675, 0.685, 0.611, 0.473], 'all_L1': [0.544, 0.579, 0.541, 0.421, 0.284]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.522, 0.546, 0.54, 0.515], 'all_L1': [0.427, 0.463, 0.476, 0.452, 0.401]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.732, 0.725, 0.643, 0.495], 'all_L1': [0.582, 0.614, 0.538, 0.407, 0.298]}), defaultdict(<class 'list'>, {'all_KL': [0.695, 0.737, 0.743, 0.712, 0.621], 'all_L1': [0.597, 0.628, 0.597, 0.516, 0.398]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.719, 0.722, 0.657, 0.559], 'all_L1': [0.593, 0.621, 0.59, 0.478, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.831, 0.848, 0.827, 0.737, 0.582], 'all_L1': [0.695, 0.686, 0.593, 0.452, 0.299]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.679 +- 0.027, 0.672 +- 0.022, 0.664 +- 0.020, 0.646 +- 0.027, 0.757 +- 0.050
suff_simple class all_KL  =  0.469 +- 0.046, 0.470 +- 0.044, 0.467 +- 0.042, 0.450 +- 0.046, 0.669 +- 0.060
suff_simple_acc_int  =  0.707 +- 0.028, 0.695 +- 0.026, 0.682 +- 0.020, 0.656 +- 0.028, 0.746 +- 0.057
nec class all_L1  =  0.739 +- 0.047, 0.754 +- 0.050, 0.565 +- 0.099, 0.351 +- 0.085, 0.198 +- 0.057
nec class all_KL  =  0.900 +- 0.050, 0.962 +- 0.019, 0.899 +- 0.073, 0.690 +- 0.132, 0.478 +- 0.121
nec_acc_int  =  0.172 +- 0.060, 0.194 +- 0.076, 0.475 +- 0.109, 0.709 +- 0.070, 0.861 +- 0.044

Eval split val
suff_simple class all_L1  =  0.500 +- 0.107, 0.499 +- 0.108, 0.495 +- 0.111, 0.487 +- 0.114, 0.525 +- 0.120
suff_simple class all_KL  =  0.399 +- 0.132, 0.400 +- 0.133, 0.398 +- 0.137, 0.394 +- 0.138, 0.474 +- 0.146
suff_simple_acc_int  =  0.199 +- 0.144, 0.194 +- 0.141, 0.186 +- 0.137, 0.171 +- 0.128, 0.167 +- 0.101
nec class all_L1  =  0.570 +- 0.132, 0.552 +- 0.124, 0.514 +- 0.107, 0.449 +- 0.090, 0.410 +- 0.096
nec class all_KL  =  0.622 +- 0.158, 0.609 +- 0.151, 0.625 +- 0.146, 0.595 +- 0.128, 0.549 +- 0.119
nec_acc_int  =  0.003 +- 0.004, 0.035 +- 0.043, 0.165 +- 0.130, 0.288 +- 0.166, 0.335 +- 0.174

Eval split test
suff_simple class all_L1  =  0.670 +- 0.036, 0.670 +- 0.036, 0.658 +- 0.040, 0.635 +- 0.045, 0.775 +- 0.050
suff_simple class all_KL  =  0.589 +- 0.043, 0.593 +- 0.041, 0.583 +- 0.044, 0.562 +- 0.048, 0.748 +- 0.057
suff_simple_acc_int  =  0.571 +- 0.078, 0.575 +- 0.080, 0.578 +- 0.073, 0.569 +- 0.057, 0.709 +- 0.065
nec class all_L1  =  0.575 +- 0.070, 0.601 +- 0.063, 0.562 +- 0.044, 0.468 +- 0.040, 0.345 +- 0.046
nec class all_KL  =  0.661 +- 0.092, 0.707 +- 0.087, 0.708 +- 0.074, 0.655 +- 0.059, 0.544 +- 0.050
nec_acc_int  =  0.151 +- 0.018, 0.159 +- 0.040, 0.258 +- 0.080, 0.409 +- 0.113, 0.552 +- 0.119


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.709 +- 0.025, 0.713 +- 0.028, 0.614 +- 0.050, 0.498 +- 0.047, 0.478 +- 0.050
Faith. Armon (L1)= 		  =  0.706 +- 0.024, 0.710 +- 0.027, 0.606 +- 0.059, 0.449 +- 0.074, 0.311 +- 0.075
Faith. GMean (L1)= 	  =  0.708 +- 0.025, 0.712 +- 0.027, 0.610 +- 0.055, 0.473 +- 0.061, 0.385 +- 0.066
Faith. Aritm (KL)= 		  =  0.684 +- 0.030, 0.716 +- 0.022, 0.683 +- 0.039, 0.570 +- 0.066, 0.574 +- 0.082
Faith. Armon (KL)= 		  =  0.614 +- 0.040, 0.630 +- 0.040, 0.612 +- 0.039, 0.538 +- 0.051, 0.551 +- 0.097
Faith. GMean (KL)= 	  =  0.648 +- 0.033, 0.672 +- 0.031, 0.647 +- 0.037, 0.553 +- 0.057, 0.562 +- 0.090

Eval split val
Faith. Aritm (L1)= 		  =  0.535 +- 0.034, 0.526 +- 0.029, 0.504 +- 0.018, 0.468 +- 0.029, 0.468 +- 0.049
Faith. Armon (L1)= 		  =  0.507 +- 0.046, 0.500 +- 0.042, 0.481 +- 0.031, 0.447 +- 0.030, 0.441 +- 0.046
Faith. GMean (L1)= 	  =  0.521 +- 0.038, 0.512 +- 0.033, 0.492 +- 0.023, 0.457 +- 0.028, 0.454 +- 0.047
Faith. Aritm (KL)= 		  =  0.511 +- 0.024, 0.504 +- 0.023, 0.512 +- 0.021, 0.494 +- 0.014, 0.511 +- 0.036
Faith. Armon (KL)= 		  =  0.447 +- 0.067, 0.444 +- 0.068, 0.448 +- 0.076, 0.438 +- 0.076, 0.474 +- 0.075
Faith. GMean (KL)= 	  =  0.476 +- 0.039, 0.472 +- 0.040, 0.477 +- 0.046, 0.464 +- 0.046, 0.492 +- 0.056

Eval split test
Faith. Aritm (L1)= 		  =  0.622 +- 0.052, 0.635 +- 0.048, 0.610 +- 0.039, 0.551 +- 0.034, 0.560 +- 0.030
Faith. Armon (L1)= 		  =  0.618 +- 0.056, 0.633 +- 0.050, 0.606 +- 0.040, 0.537 +- 0.035, 0.474 +- 0.043
Faith. GMean (L1)= 	  =  0.620 +- 0.054, 0.634 +- 0.049, 0.608 +- 0.039, 0.544 +- 0.034, 0.515 +- 0.035
Faith. Aritm (KL)= 		  =  0.625 +- 0.064, 0.650 +- 0.061, 0.645 +- 0.057, 0.609 +- 0.052, 0.646 +- 0.047
Faith. Armon (KL)= 		  =  0.621 +- 0.063, 0.644 +- 0.059, 0.639 +- 0.055, 0.605 +- 0.051, 0.629 +- 0.048
Faith. GMean (KL)= 	  =  0.623 +- 0.064, 0.647 +- 0.060, 0.642 +- 0.056, 0.607 +- 0.051, 0.638 +- 0.047
Computed for split load_split = id



Completed in  0:55:20.630755  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:01:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:01:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.802
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.908
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.952
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.962
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.961
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.935
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.929
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.928
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.928
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.928
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.803
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.860
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.898
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.922
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.927


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8019241877256317
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9077581227436824
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9522563176895306
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.962245487364621
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9612490974729241
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.9352785714285714
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  1.0
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9293416666666666
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9282301587301589
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.928165873015873
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9281654761904762
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8027366288492707
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.088 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.05 all KL = 0.991 +- 0.088 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.05 all L1 = 0.995 +- 0.050 (in-sample avg dev_std = 0.095)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8603431928687197
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.073 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.1 all KL = 0.994 +- 0.073 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.045 (in-sample avg dev_std = 0.072)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8978002431118315
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.028 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.999 +- 0.028 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.999 +- 0.025 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9216215559157211
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8


40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 5 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 5 0
40 4 0
40 5 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9274108589951379
len(reference) = 2419
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8019241877256317
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.31
NEC for r=0.05 class 1.0 = 0.603 +- 0.449 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.704 +- 0.449 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.603 +- 0.388 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9077581227436824
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.459
NEC for r=0.1 class 1.0 = 0.528 +- 0.381 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all KL = 0.725 +- 0.381 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all L1 = 0.528 +- 0.344 (in-sample avg dev_std = 0.558)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9522563176895306
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.726
NEC for r=0.2 class 1.0 = 0.274 +- 0.436 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all KL = 0.395 +- 0.436 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all L1 = 0.274 +- 0.349 (in-sample avg dev_std = 0.422)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.962245487364621
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.898
NEC for r=0.4 class 1.0 = 0.107 +- 0.338 (in-sample avg dev_std = 0.302)
NEC for r=0.4 all KL = 0.164 +- 0.338 (in-sample avg dev_std = 0.302)
NEC for r=0.4 all L1 = 0.107 +- 0.247 (in-sample avg dev_std = 0.302)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9612490974729241
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.987
NEC for r=0.8 class 1.0 = 0.019 +- 0.159 (in-sample avg dev_std = 0.182)
NEC for r=0.8 all KL = 0.042 +- 0.159 (in-sample avg dev_std = 0.182)
NEC for r=0.8 all L1 = 0.019 +- 0.082 (in-sample avg dev_std = 0.182)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.9352785714285714
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.852 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.962 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.852 +- 0.024 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9293416666666666
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.213
NEC for r=0.1 class 1.0 = 0.741 +- 0.177 (in-sample avg dev_std = 0.612)
NEC for r=0.1 all KL = 0.904 +- 0.177 (in-sample avg dev_std = 0.612)
NEC for r=0.1 all L1 = 0.741 +- 0.174 (in-sample avg dev_std = 0.612)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9282301587301589
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.94
NEC for r=0.2 class 1.0 = 0.097 +- 0.286 (in-sample avg dev_std = 0.440)
NEC for r=0.2 all KL = 0.196 +- 0.286 (in-sample avg dev_std = 0.440)
NEC for r=0.2 all L1 = 0.097 +- 0.141 (in-sample avg dev_std = 0.440)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.928165873015873
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.996
NEC for r=0.4 class 1.0 = 0.008 +- 0.086 (in-sample avg dev_std = 0.116)
NEC for r=0.4 all KL = 0.016 +- 0.086 (in-sample avg dev_std = 0.116)
NEC for r=0.4 all L1 = 0.008 +- 0.038 (in-sample avg dev_std = 0.116)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9281654761904762
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 1.0 = 0.002 +- 0.039 (in-sample avg dev_std = 0.053)
NEC for r=0.8 all KL = 0.003 +- 0.039 (in-sample avg dev_std = 0.053)
NEC for r=0.8 all L1 = 0.002 +- 0.018 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8027366288492707
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.452
NEC for r=0.05 class 1.0 = 0.505 +- 0.441 (in-sample avg dev_std = 0.361)
NEC for r=0.05 all KL = 0.643 +- 0.441 (in-sample avg dev_std = 0.361)
NEC for r=0.05 all L1 = 0.505 +- 0.386 (in-sample avg dev_std = 0.361)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8603431928687197
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.547
NEC for r=0.1 class 1.0 = 0.428 +- 0.451 (in-sample avg dev_std = 0.408)
NEC for r=0.1 all KL = 0.565 +- 0.451 (in-sample avg dev_std = 0.408)
NEC for r=0.1 all L1 = 0.428 +- 0.386 (in-sample avg dev_std = 0.408)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8978002431118315
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.697
NEC for r=0.2 class 1.0 = 0.297 +- 0.448 (in-sample avg dev_std = 0.391)
NEC for r=0.2 all KL = 0.41 +- 0.448 (in-sample avg dev_std = 0.391)
NEC for r=0.2 all L1 = 0.297 +- 0.365 (in-sample avg dev_std = 0.391)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9216215559157211
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.772
NEC for r=0.4 class 1.0 = 0.22 +- 0.422 (in-sample avg dev_std = 0.312)
NEC for r=0.4 all KL = 0.302 +- 0.422 (in-sample avg dev_std = 0.312)
NEC for r=0.4 all L1 = 0.22 +- 0.342 (in-sample avg dev_std = 0.312)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9274108589951379
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 1.0 = 0.087 +- 0.305 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all KL = 0.127 +- 0.305 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all L1 = 0.087 +- 0.234 (in-sample avg dev_std = 0.228)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:07:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:07:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.774
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.863
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.864
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.823
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.791
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.873
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.829
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.801
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.793
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.793
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.805
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.870
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.908
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.922
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.905


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737148014440434
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.994
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.117 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.05 all KL = 0.977 +- 0.117 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.05 all L1 = 0.99 +- 0.051 (in-sample avg dev_std = 0.140)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8632418772563176
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 1.0 = 0.994 +- 0.097 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 all KL = 0.987 +- 0.097 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 all L1 = 0.994 +- 0.050 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8642851985559569
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.995
SUFF_SIMPLE for r=0.2 class 1.0 = 0.992 +- 0.110 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all KL = 0.984 +- 0.110 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all L1 = 0.992 +- 0.060 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8229494584837544
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.99
SUFF_SIMPLE for r=0.4 class 1.0 = 0.986 +- 0.144 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all KL = 0.973 +- 0.144 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all L1 = 0.986 +- 0.081 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7911516245487364
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.977
SUFF_SIMPLE for r=0.8 class 1.0 = 0.979 +- 0.159 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 all KL = 0.972 +- 0.159 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.8 all L1 = 0.979 +- 0.124 (in-sample avg dev_std = 0.088)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8725924603174603
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.974
SUFF_SIMPLE for r=0.05 class 1.0 = 0.958 +- 0.227 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.05 all KL = 0.907 +- 0.227 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.05 all L1 = 0.958 +- 0.106 (in-sample avg dev_std = 0.299)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8285785714285714
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.976
SUFF_SIMPLE for r=0.1 class 1.0 = 0.96 +- 0.221 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all KL = 0.912 +- 0.221 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.1 all L1 = 0.96 +- 0.103 (in-sample avg dev_std = 0.290)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8014083333333333
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.975
SUFF_SIMPLE for r=0.2 class 1.0 = 0.959 +- 0.224 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all KL = 0.907 +- 0.224 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.103 (in-sample avg dev_std = 0.295)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7930813492063492
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.969
SUFF_SIMPLE for r=0.4 class 1.0 = 0.95 +- 0.246 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 all KL = 0.889 +- 0.246 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 all L1 = 0.95 +- 0.117 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7927035714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.954
SUFF_SIMPLE for r=0.8 class 1.0 = 0.953 +- 0.235 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.235 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 all L1 = 0.953 +- 0.176 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.804740680713128
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.999
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.057 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.05 all KL = 0.996 +- 0.057 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.05 all L1 = 0.997 +- 0.039 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.86992585089141
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.058 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 all KL = 0.996 +- 0.058 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 all L1 = 0.997 +- 0.041 (in-sample avg dev_std = 0.048)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9079250405186385
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 1.0 = 0.997 +- 0.059 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.2 all KL = 0.995 +- 0.059 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.2 all L1 = 0.997 +- 0.041 (in-sample avg dev_std = 0.049)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9222601296596434
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.061 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 all KL = 0.996 +- 0.061 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 all L1 = 0.997 +- 0.046 (in-sample avg dev_std = 0.043)


ratio=0.8


40 5 0
40 5 0
40 5 0
40 4 0
40 5 0
40 5 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 5 0
40 5 0
40 5 0
40 4 0
40 4 0
40 5 0
40 5 0
40 4 0
40 5 0
40 4 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 5 0
40 4 0
40 5 0
40 5 0
40 5 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9049866288492705
len(reference) = 2412
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.995
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.070 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.070 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.996 +- 0.059 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7737148014440434
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.253
NEC for r=0.05 class 1.0 = 0.646 +- 0.435 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.646 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8632418772563176
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.458
NEC for r=0.1 class 1.0 = 0.522 +- 0.402 (in-sample avg dev_std = 0.522)
NEC for r=0.1 all KL = 0.701 +- 0.402 (in-sample avg dev_std = 0.522)
NEC for r=0.1 all L1 = 0.522 +- 0.358 (in-sample avg dev_std = 0.522)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8642851985559569
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.71
NEC for r=0.2 class 1.0 = 0.293 +- 0.440 (in-sample avg dev_std = 0.452)
NEC for r=0.2 all KL = 0.425 +- 0.440 (in-sample avg dev_std = 0.452)
NEC for r=0.2 all L1 = 0.293 +- 0.352 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8229494584837544
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.884
NEC for r=0.4 class 1.0 = 0.134 +- 0.364 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all KL = 0.226 +- 0.364 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all L1 = 0.134 +- 0.250 (in-sample avg dev_std = 0.403)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7911516245487364
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.957
NEC for r=0.8 class 1.0 = 0.064 +- 0.286 (in-sample avg dev_std = 0.355)
NEC for r=0.8 all KL = 0.131 +- 0.286 (in-sample avg dev_std = 0.355)
NEC for r=0.8 all L1 = 0.064 +- 0.151 (in-sample avg dev_std = 0.355)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8725924603174603
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.023
NEC for r=0.05 class 1.0 = 0.843 +- 0.150 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.972 +- 0.150 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.843 +- 0.130 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8285785714285714
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.27
NEC for r=0.1 class 1.0 = 0.704 +- 0.224 (in-sample avg dev_std = 0.639)
NEC for r=0.1 all KL = 0.897 +- 0.224 (in-sample avg dev_std = 0.639)
NEC for r=0.1 all L1 = 0.704 +- 0.231 (in-sample avg dev_std = 0.639)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8014083333333333
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.903
NEC for r=0.2 class 1.0 = 0.153 +- 0.342 (in-sample avg dev_std = 0.564)
NEC for r=0.2 all KL = 0.318 +- 0.342 (in-sample avg dev_std = 0.564)
NEC for r=0.2 all L1 = 0.153 +- 0.179 (in-sample avg dev_std = 0.564)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7930813492063492
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.973
NEC for r=0.4 class 1.0 = 0.045 +- 0.228 (in-sample avg dev_std = 0.310)
NEC for r=0.4 all KL = 0.101 +- 0.228 (in-sample avg dev_std = 0.310)
NEC for r=0.4 all L1 = 0.045 +- 0.105 (in-sample avg dev_std = 0.310)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7927035714285714
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.983
NEC for r=0.8 class 1.0 = 0.028 +- 0.190 (in-sample avg dev_std = 0.245)
NEC for r=0.8 all KL = 0.063 +- 0.190 (in-sample avg dev_std = 0.245)
NEC for r=0.8 all L1 = 0.028 +- 0.089 (in-sample avg dev_std = 0.245)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.804740680713128
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.277
NEC for r=0.05 class 1.0 = 0.649 +- 0.386 (in-sample avg dev_std = 0.369)
NEC for r=0.05 all KL = 0.79 +- 0.386 (in-sample avg dev_std = 0.369)
NEC for r=0.05 all L1 = 0.649 +- 0.342 (in-sample avg dev_std = 0.369)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.86992585089141
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.455
NEC for r=0.1 class 1.0 = 0.506 +- 0.431 (in-sample avg dev_std = 0.427)
NEC for r=0.1 all KL = 0.656 +- 0.431 (in-sample avg dev_std = 0.427)
NEC for r=0.1 all L1 = 0.506 +- 0.381 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9079250405186385
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
NEC for r=0.2 class 1.0 = 0.354 +- 0.463 (in-sample avg dev_std = 0.385)
NEC for r=0.2 all KL = 0.469 +- 0.463 (in-sample avg dev_std = 0.385)
NEC for r=0.2 all L1 = 0.354 +- 0.387 (in-sample avg dev_std = 0.385)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9222601296596434
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.757
NEC for r=0.4 class 1.0 = 0.23 +- 0.433 (in-sample avg dev_std = 0.306)
NEC for r=0.4 all KL = 0.307 +- 0.433 (in-sample avg dev_std = 0.306)
NEC for r=0.4 all L1 = 0.23 +- 0.353 (in-sample avg dev_std = 0.306)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9049866288492705
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.904
NEC for r=0.8 class 1.0 = 0.106 +- 0.335 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all KL = 0.171 +- 0.335 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all L1 = 0.106 +- 0.237 (in-sample avg dev_std = 0.328)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:12:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:12:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.742
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.834
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.842
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.807
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.781
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.829
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.784
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.762
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.757
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.756
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.790
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.861
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.903
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.922
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.908


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.742447653429603
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.993
SUFF_SIMPLE for r=0.05 class 1.0 = 0.989 +- 0.114 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 all KL = 0.975 +- 0.114 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.05 all L1 = 0.989 +- 0.053 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8343104693140794
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 1.0 = 0.993 +- 0.093 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all KL = 0.987 +- 0.093 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.052 (in-sample avg dev_std = 0.119)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8416173285198557
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 1.0 = 0.994 +- 0.086 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 all KL = 0.987 +- 0.086 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 all L1 = 0.994 +- 0.042 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8071227436823104
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.99
SUFF_SIMPLE for r=0.4 class 1.0 = 0.988 +- 0.126 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all KL = 0.98 +- 0.126 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all L1 = 0.988 +- 0.084 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7807364620938628
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.968
SUFF_SIMPLE for r=0.8 class 1.0 = 0.972 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.972 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.86
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8292615079365078
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.86
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.026 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.05 all KL = 0.999 +- 0.026 (in-sample avg dev_std = 0.037)
SUFF_SIMPLE for r=0.05 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.037)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7837099206349206
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.859
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.032 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.032 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.015 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.86
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7617638888888889
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.86
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.020 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.2 all KL = 0.999 +- 0.020 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.009 (in-sample avg dev_std = 0.029)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.86
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7565142857142858
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.859
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.042 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 all KL = 0.997 +- 0.042 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 all L1 = 0.998 +- 0.020 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.86
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7563246031746033
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.858
SUFF_SIMPLE for r=0.8 class 1.0 = 0.998 +- 0.052 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 all KL = 0.996 +- 0.052 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.034 (in-sample avg dev_std = 0.058)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7895611831442463
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.999
SUFF_SIMPLE for r=0.05 class 1.0 = 0.992 +- 0.096 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.05 all KL = 0.99 +- 0.096 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.05 all L1 = 0.992 +- 0.079 (in-sample avg dev_std = 0.050)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8609979740680714
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 1.0 = 0.992 +- 0.095 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.1 all KL = 0.99 +- 0.095 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.079 (in-sample avg dev_std = 0.046)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9033265802269043
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.100 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.2 all KL = 0.989 +- 0.100 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.2 all L1 = 0.991 +- 0.082 (in-sample avg dev_std = 0.057)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9217548622366287
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 1.0 = 0.991 +- 0.105 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.4 all KL = 0.988 +- 0.105 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.4 all L1 = 0.991 +- 0.086 (in-sample avg dev_std = 0.062)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.907736223662885
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.984
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.127 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.983 +- 0.127 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.986 +- 0.110 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.742447653429603
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.26
NEC for r=0.05 class 1.0 = 0.639 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.737 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.639 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8343104693140794
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.455
NEC for r=0.1 class 1.0 = 0.523 +- 0.401 (in-sample avg dev_std = 0.520)
NEC for r=0.1 all KL = 0.683 +- 0.401 (in-sample avg dev_std = 0.520)
NEC for r=0.1 all L1 = 0.523 +- 0.357 (in-sample avg dev_std = 0.520)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8416173285198557
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.713
NEC for r=0.2 class 1.0 = 0.282 +- 0.436 (in-sample avg dev_std = 0.413)
NEC for r=0.2 all KL = 0.384 +- 0.436 (in-sample avg dev_std = 0.413)
NEC for r=0.2 all L1 = 0.282 +- 0.358 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8071227436823104
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.883
NEC for r=0.4 class 1.0 = 0.13 +- 0.350 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all KL = 0.197 +- 0.350 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all L1 = 0.13 +- 0.257 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7807364620938628
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.956
NEC for r=0.8 class 1.0 = 0.061 +- 0.254 (in-sample avg dev_std = 0.332)
NEC for r=0.8 all KL = 0.112 +- 0.254 (in-sample avg dev_std = 0.332)
NEC for r=0.8 all L1 = 0.061 +- 0.154 (in-sample avg dev_std = 0.332)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.86
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8292615079365078
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.776 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.856 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.776 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7837099206349206
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.18
NEC for r=0.1 class 1.0 = 0.653 +- 0.321 (in-sample avg dev_std = 0.540)
NEC for r=0.1 all KL = 0.786 +- 0.321 (in-sample avg dev_std = 0.540)
NEC for r=0.1 all L1 = 0.653 +- 0.271 (in-sample avg dev_std = 0.540)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.86
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7617638888888889
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.824
NEC for r=0.2 class 1.0 = 0.059 +- 0.223 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all KL = 0.113 +- 0.223 (in-sample avg dev_std = 0.351)
NEC for r=0.2 all L1 = 0.059 +- 0.116 (in-sample avg dev_std = 0.351)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.86
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7565142857142858
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.854
NEC for r=0.4 class 1.0 = 0.01 +- 0.097 (in-sample avg dev_std = 0.146)
NEC for r=0.4 all KL = 0.02 +- 0.097 (in-sample avg dev_std = 0.146)
NEC for r=0.4 all L1 = 0.01 +- 0.047 (in-sample avg dev_std = 0.146)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.86
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7563246031746033
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.858
NEC for r=0.8 class 1.0 = 0.003 +- 0.057 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all KL = 0.006 +- 0.057 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all L1 = 0.003 +- 0.028 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7895611831442463
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.289
NEC for r=0.05 class 1.0 = 0.632 +- 0.400 (in-sample avg dev_std = 0.374)
NEC for r=0.05 all KL = 0.762 +- 0.400 (in-sample avg dev_std = 0.374)
NEC for r=0.05 all L1 = 0.632 +- 0.351 (in-sample avg dev_std = 0.374)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8609979740680714
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.453
NEC for r=0.1 class 1.0 = 0.5 +- 0.433 (in-sample avg dev_std = 0.421)
NEC for r=0.1 all KL = 0.633 +- 0.433 (in-sample avg dev_std = 0.421)
NEC for r=0.1 all L1 = 0.5 +- 0.381 (in-sample avg dev_std = 0.421)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9033265802269043
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.61
NEC for r=0.2 class 1.0 = 0.36 +- 0.456 (in-sample avg dev_std = 0.388)
NEC for r=0.2 all KL = 0.466 +- 0.456 (in-sample avg dev_std = 0.388)
NEC for r=0.2 all L1 = 0.36 +- 0.387 (in-sample avg dev_std = 0.388)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9217548622366287
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.726
NEC for r=0.4 class 1.0 = 0.249 +- 0.436 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all KL = 0.32 +- 0.436 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all L1 = 0.249 +- 0.364 (in-sample avg dev_std = 0.307)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.907736223662885
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.863
NEC for r=0.8 class 1.0 = 0.136 +- 0.360 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.192 +- 0.360 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.136 +- 0.278 (in-sample avg dev_std = 0.330)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:17:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:17:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.754
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.837
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.856
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.851
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.843
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.727
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.666
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.638
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.632
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.632
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.787
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.850
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.888
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.909
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.910


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7539205776173286
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.905
SUFF_SIMPLE for r=0.05 class 1.0 = 0.854 +- 0.311 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.05 all KL = 0.753 +- 0.311 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.05 all L1 = 0.854 +- 0.189 (in-sample avg dev_std = 0.511)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8368375451263537
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.897
SUFF_SIMPLE for r=0.1 class 1.0 = 0.845 +- 0.312 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all KL = 0.741 +- 0.312 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all L1 = 0.845 +- 0.197 (in-sample avg dev_std = 0.523)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8557075812274368
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.884
SUFF_SIMPLE for r=0.2 class 1.0 = 0.837 +- 0.321 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all KL = 0.736 +- 0.321 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.2 all L1 = 0.837 +- 0.217 (in-sample avg dev_std = 0.518)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8506498194945848
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.832
SUFF_SIMPLE for r=0.4 class 1.0 = 0.782 +- 0.366 (in-sample avg dev_std = 0.559)
SUFF_SIMPLE for r=0.4 all KL = 0.668 +- 0.366 (in-sample avg dev_std = 0.559)
SUFF_SIMPLE for r=0.4 all L1 = 0.782 +- 0.259 (in-sample avg dev_std = 0.559)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8434440433212997
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.706
SUFF_SIMPLE for r=0.8 class 1.0 = 0.701 +- 0.439 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.8 all KL = 0.62 +- 0.439 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.8 all L1 = 0.701 +- 0.359 (in-sample avg dev_std = 0.399)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.727245634920635
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.351
SUFF_SIMPLE for r=0.05 class 1.0 = 0.485 +- 0.353 (in-sample avg dev_std = 0.770)
SUFF_SIMPLE for r=0.05 all KL = 0.351 +- 0.353 (in-sample avg dev_std = 0.770)
SUFF_SIMPLE for r=0.05 all L1 = 0.485 +- 0.234 (in-sample avg dev_std = 0.770)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6662015873015873
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.339
SUFF_SIMPLE for r=0.1 class 1.0 = 0.475 +- 0.353 (in-sample avg dev_std = 0.764)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.353 (in-sample avg dev_std = 0.764)
SUFF_SIMPLE for r=0.1 all L1 = 0.475 +- 0.234 (in-sample avg dev_std = 0.764)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6383833333333334
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.316
SUFF_SIMPLE for r=0.2 class 1.0 = 0.46 +- 0.357 (in-sample avg dev_std = 0.751)
SUFF_SIMPLE for r=0.2 all KL = 0.334 +- 0.357 (in-sample avg dev_std = 0.751)
SUFF_SIMPLE for r=0.2 all L1 = 0.46 +- 0.238 (in-sample avg dev_std = 0.751)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6318091269841271
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.267
SUFF_SIMPLE for r=0.4 class 1.0 = 0.422 +- 0.353 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.4 all KL = 0.309 +- 0.353 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.4 all L1 = 0.422 +- 0.237 (in-sample avg dev_std = 0.716)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6315694444444445
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.077
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.376 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all KL = 0.286 +- 0.376 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all L1 = 0.335 +- 0.285 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7872698541329011
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.993
SUFF_SIMPLE for r=0.05 class 1.0 = 0.968 +- 0.174 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all KL = 0.957 +- 0.174 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all L1 = 0.968 +- 0.138 (in-sample avg dev_std = 0.148)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8500944084278768
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 1.0 = 0.966 +- 0.183 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.183 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.1 all L1 = 0.966 +- 0.140 (in-sample avg dev_std = 0.169)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8876482982171798
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.987
SUFF_SIMPLE for r=0.2 class 1.0 = 0.968 +- 0.177 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 all KL = 0.958 +- 0.177 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 all L1 = 0.968 +- 0.140 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.908660453808752
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.978
SUFF_SIMPLE for r=0.4 class 1.0 = 0.955 +- 0.213 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.4 all KL = 0.943 +- 0.213 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.4 all L1 = 0.955 +- 0.169 (in-sample avg dev_std = 0.172)


ratio=0.8


40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9095417341977309
len(reference) = 2430
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.941
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.943 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.195 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7539205776173286
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.332
NEC for r=0.05 class 1.0 = 0.577 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.662 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.577 +- 0.401 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8368375451263537
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.487
NEC for r=0.1 class 1.0 = 0.504 +- 0.390 (in-sample avg dev_std = 0.544)
NEC for r=0.1 all KL = 0.654 +- 0.390 (in-sample avg dev_std = 0.544)
NEC for r=0.1 all L1 = 0.504 +- 0.346 (in-sample avg dev_std = 0.544)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8557075812274368
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.728
NEC for r=0.2 class 1.0 = 0.276 +- 0.419 (in-sample avg dev_std = 0.426)
NEC for r=0.2 all KL = 0.365 +- 0.419 (in-sample avg dev_std = 0.426)
NEC for r=0.2 all L1 = 0.276 +- 0.345 (in-sample avg dev_std = 0.426)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8506498194945848
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.882
NEC for r=0.4 class 1.0 = 0.133 +- 0.331 (in-sample avg dev_std = 0.367)
NEC for r=0.4 all KL = 0.193 +- 0.331 (in-sample avg dev_std = 0.367)
NEC for r=0.4 all L1 = 0.133 +- 0.251 (in-sample avg dev_std = 0.367)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8434440433212997
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.954
NEC for r=0.8 class 1.0 = 0.06 +- 0.236 (in-sample avg dev_std = 0.297)
NEC for r=0.8 all KL = 0.094 +- 0.236 (in-sample avg dev_std = 0.297)
NEC for r=0.8 all L1 = 0.06 +- 0.161 (in-sample avg dev_std = 0.297)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.727245634920635
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.729 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.78 +- 0.326 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.729 +- 0.221 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6662015873015873
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.132
NEC for r=0.1 class 1.0 = 0.651 +- 0.333 (in-sample avg dev_std = 0.519)
NEC for r=0.1 all KL = 0.74 +- 0.333 (in-sample avg dev_std = 0.519)
NEC for r=0.1 all L1 = 0.651 +- 0.245 (in-sample avg dev_std = 0.519)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.6383833333333334
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.556
NEC for r=0.2 class 1.0 = 0.302 +- 0.336 (in-sample avg dev_std = 0.680)
NEC for r=0.2 all KL = 0.434 +- 0.336 (in-sample avg dev_std = 0.680)
NEC for r=0.2 all L1 = 0.302 +- 0.214 (in-sample avg dev_std = 0.680)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.6318091269841271
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.573
NEC for r=0.4 class 1.0 = 0.28 +- 0.346 (in-sample avg dev_std = 0.637)
NEC for r=0.4 all KL = 0.393 +- 0.346 (in-sample avg dev_std = 0.637)
NEC for r=0.4 all L1 = 0.28 +- 0.225 (in-sample avg dev_std = 0.637)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.6315694444444445
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.46
NEC for r=0.8 class 1.0 = 0.4 +- 0.364 (in-sample avg dev_std = 0.698)
NEC for r=0.8 all KL = 0.521 +- 0.364 (in-sample avg dev_std = 0.698)
NEC for r=0.8 all L1 = 0.4 +- 0.250 (in-sample avg dev_std = 0.698)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7872698541329011
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.359
NEC for r=0.05 class 1.0 = 0.568 +- 0.437 (in-sample avg dev_std = 0.305)
NEC for r=0.05 all KL = 0.67 +- 0.437 (in-sample avg dev_std = 0.305)
NEC for r=0.05 all L1 = 0.568 +- 0.381 (in-sample avg dev_std = 0.305)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8500944084278768
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 1.0 = 0.462 +- 0.437 (in-sample avg dev_std = 0.426)
NEC for r=0.1 all KL = 0.576 +- 0.437 (in-sample avg dev_std = 0.426)
NEC for r=0.1 all L1 = 0.462 +- 0.379 (in-sample avg dev_std = 0.426)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8876482982171798
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.62
NEC for r=0.2 class 1.0 = 0.352 +- 0.437 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all KL = 0.451 +- 0.437 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all L1 = 0.352 +- 0.372 (in-sample avg dev_std = 0.409)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.908660453808752
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.733
NEC for r=0.4 class 1.0 = 0.241 +- 0.417 (in-sample avg dev_std = 0.335)
NEC for r=0.4 all KL = 0.31 +- 0.417 (in-sample avg dev_std = 0.335)
NEC for r=0.4 all L1 = 0.241 +- 0.348 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9095417341977309
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 1.0 = 0.136 +- 0.340 (in-sample avg dev_std = 0.340)
NEC for r=0.8 all KL = 0.189 +- 0.340 (in-sample avg dev_std = 0.340)
NEC for r=0.8 all L1 = 0.136 +- 0.266 (in-sample avg dev_std = 0.340)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:23:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:23:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.794
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.908
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.953
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.963
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.962
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.921
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.911
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.908
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.908
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.908
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.806
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.870
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.915
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.944
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.949


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7935848375451263
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9080577617328519
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.953259927797834
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9627220216606498
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9618158844765343
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.891
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.9212496031746031
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.89
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.034 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 all KL = 0.998 +- 0.034 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9108535714285713
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.89
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.041 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.1 all KL = 0.997 +- 0.041 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.1 all L1 = 0.998 +- 0.018 (in-sample avg dev_std = 0.049)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.891
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9080269841269841
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.89
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.037 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.2 all KL = 0.998 +- 0.037 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.2 all L1 = 0.999 +- 0.017 (in-sample avg dev_std = 0.045)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.891
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.907731746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.89
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.029 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 all KL = 0.998 +- 0.029 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.035)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.891
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9077289682539682
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.891
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.002 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.002 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8058059157212318
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  1.0
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8704558346839546
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9145097244732577
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9439432739059967
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8


40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9489671799027555
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7935848375451263
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.267
NEC for r=0.05 class 1.0 = 0.637 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.737 +- 0.436 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.637 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9080577617328519
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.445
NEC for r=0.1 class 1.0 = 0.538 +- 0.381 (in-sample avg dev_std = 0.548)
NEC for r=0.1 all KL = 0.727 +- 0.381 (in-sample avg dev_std = 0.548)
NEC for r=0.1 all L1 = 0.538 +- 0.346 (in-sample avg dev_std = 0.548)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.953259927797834
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.722
NEC for r=0.2 class 1.0 = 0.276 +- 0.441 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all KL = 0.391 +- 0.441 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all L1 = 0.276 +- 0.354 (in-sample avg dev_std = 0.422)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9627220216606498
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.884
NEC for r=0.4 class 1.0 = 0.128 +- 0.362 (in-sample avg dev_std = 0.367)
NEC for r=0.4 all KL = 0.202 +- 0.362 (in-sample avg dev_std = 0.367)
NEC for r=0.4 all L1 = 0.128 +- 0.258 (in-sample avg dev_std = 0.367)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9618158844765343
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.974
NEC for r=0.8 class 1.0 = 0.037 +- 0.222 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all KL = 0.078 +- 0.222 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all L1 = 0.037 +- 0.120 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.891
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.9212496031746031
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.802 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.874 +- 0.223 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.802 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9108535714285713
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.157
NEC for r=0.1 class 1.0 = 0.698 +- 0.275 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all KL = 0.828 +- 0.275 (in-sample avg dev_std = 0.558)
NEC for r=0.1 all L1 = 0.698 +- 0.213 (in-sample avg dev_std = 0.558)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.891
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9080269841269841
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.82
NEC for r=0.2 class 1.0 = 0.111 +- 0.291 (in-sample avg dev_std = 0.446)
NEC for r=0.2 all KL = 0.204 +- 0.291 (in-sample avg dev_std = 0.446)
NEC for r=0.2 all L1 = 0.111 +- 0.142 (in-sample avg dev_std = 0.446)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.891
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.907731746031746
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.877
NEC for r=0.4 class 1.0 = 0.022 +- 0.137 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all KL = 0.038 +- 0.137 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all L1 = 0.022 +- 0.067 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.891
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9077289682539682
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.887
NEC for r=0.8 class 1.0 = 0.006 +- 0.070 (in-sample avg dev_std = 0.096)
NEC for r=0.8 all KL = 0.01 +- 0.070 (in-sample avg dev_std = 0.096)
NEC for r=0.8 all L1 = 0.006 +- 0.033 (in-sample avg dev_std = 0.096)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8058059157212318
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.396
NEC for r=0.05 class 1.0 = 0.54 +- 0.448 (in-sample avg dev_std = 0.290)
NEC for r=0.05 all KL = 0.661 +- 0.448 (in-sample avg dev_std = 0.290)
NEC for r=0.05 all L1 = 0.54 +- 0.394 (in-sample avg dev_std = 0.290)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8704558346839546
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 1.0 = 0.464 +- 0.444 (in-sample avg dev_std = 0.440)
NEC for r=0.1 all KL = 0.61 +- 0.444 (in-sample avg dev_std = 0.440)
NEC for r=0.1 all L1 = 0.464 +- 0.381 (in-sample avg dev_std = 0.440)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9145097244732577
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.651
NEC for r=0.2 class 1.0 = 0.342 +- 0.447 (in-sample avg dev_std = 0.435)
NEC for r=0.2 all KL = 0.475 +- 0.447 (in-sample avg dev_std = 0.435)
NEC for r=0.2 all L1 = 0.342 +- 0.370 (in-sample avg dev_std = 0.435)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9439432739059967
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.729
NEC for r=0.4 class 1.0 = 0.265 +- 0.438 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all KL = 0.37 +- 0.438 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all L1 = 0.265 +- 0.355 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9489671799027555
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.868
NEC for r=0.8 class 1.0 = 0.138 +- 0.368 (in-sample avg dev_std = 0.335)
NEC for r=0.8 all KL = 0.209 +- 0.368 (in-sample avg dev_std = 0.335)
NEC for r=0.8 all L1 = 0.138 +- 0.275 (in-sample avg dev_std = 0.335)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:28:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:28:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.788
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.854
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.853
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.820
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.796
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.816
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.775
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.757
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.754
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.754
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.808
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.870
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.903
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.911
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.896


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7880902527075813
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.981
SUFF_SIMPLE for r=0.05 class 1.0 = 0.97 +- 0.190 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.190 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all L1 = 0.97 +- 0.092 (in-sample avg dev_std = 0.247)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8544801444043321
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.202 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.1 all KL = 0.931 +- 0.202 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.1 all L1 = 0.967 +- 0.103 (in-sample avg dev_std = 0.258)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8525342960288809
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.977
SUFF_SIMPLE for r=0.2 class 1.0 = 0.966 +- 0.211 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.2 all KL = 0.931 +- 0.211 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.2 all L1 = 0.966 +- 0.115 (in-sample avg dev_std = 0.260)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8203935018050541
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.948
SUFF_SIMPLE for r=0.4 class 1.0 = 0.937 +- 0.270 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.270 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all L1 = 0.937 +- 0.178 (in-sample avg dev_std = 0.290)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7958158844765343
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.893
SUFF_SIMPLE for r=0.8 class 1.0 = 0.902 +- 0.320 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all KL = 0.874 +- 0.320 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.8 all L1 = 0.902 +- 0.262 (in-sample avg dev_std = 0.167)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.94
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8160075396825397
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.724
SUFF_SIMPLE for r=0.05 class 1.0 = 0.698 +- 0.350 (in-sample avg dev_std = 0.728)
SUFF_SIMPLE for r=0.05 all KL = 0.508 +- 0.350 (in-sample avg dev_std = 0.728)
SUFF_SIMPLE for r=0.05 all L1 = 0.698 +- 0.214 (in-sample avg dev_std = 0.728)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7745194444444443
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.697
SUFF_SIMPLE for r=0.1 class 1.0 = 0.667 +- 0.348 (in-sample avg dev_std = 0.759)
SUFF_SIMPLE for r=0.1 all KL = 0.47 +- 0.348 (in-sample avg dev_std = 0.759)
SUFF_SIMPLE for r=0.1 all L1 = 0.667 +- 0.216 (in-sample avg dev_std = 0.759)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.94
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7574293650793651
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.638
SUFF_SIMPLE for r=0.2 class 1.0 = 0.603 +- 0.340 (in-sample avg dev_std = 0.807)
SUFF_SIMPLE for r=0.2 all KL = 0.397 +- 0.340 (in-sample avg dev_std = 0.807)
SUFF_SIMPLE for r=0.2 all L1 = 0.603 +- 0.222 (in-sample avg dev_std = 0.807)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.94
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7540833333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.527
SUFF_SIMPLE for r=0.4 class 1.0 = 0.498 +- 0.306 (in-sample avg dev_std = 0.852)
SUFF_SIMPLE for r=0.4 all KL = 0.295 +- 0.306 (in-sample avg dev_std = 0.852)
SUFF_SIMPLE for r=0.4 all L1 = 0.498 +- 0.212 (in-sample avg dev_std = 0.852)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.94
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7539876984126984
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.211
SUFF_SIMPLE for r=0.8 class 1.0 = 0.343 +- 0.375 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.8 all KL = 0.263 +- 0.375 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.8 all L1 = 0.343 +- 0.318 (in-sample avg dev_std = 0.280)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8080761750405187
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 1.0 = 0.977 +- 0.164 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.05 all KL = 0.966 +- 0.164 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.05 all L1 = 0.977 +- 0.123 (in-sample avg dev_std = 0.123)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8699578606158833
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.994
SUFF_SIMPLE for r=0.1 class 1.0 = 0.975 +- 0.174 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.963 +- 0.174 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.975 +- 0.129 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9029266612641814
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 1.0 = 0.974 +- 0.178 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.961 +- 0.178 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.974 +- 0.132 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9105579416531605
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.984
SUFF_SIMPLE for r=0.4 class 1.0 = 0.969 +- 0.191 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all KL = 0.958 +- 0.191 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all L1 = 0.969 +- 0.151 (in-sample avg dev_std = 0.117)


ratio=0.8


40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.981
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8959238249594813
len(reference) = 2424
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.958
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.193 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.961 +- 0.193 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.167 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7880902527075813
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.292
NEC for r=0.05 class 1.0 = 0.612 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.708 +- 0.452 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.612 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8544801444043321
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.483
NEC for r=0.1 class 1.0 = 0.497 +- 0.425 (in-sample avg dev_std = 0.510)
NEC for r=0.1 all KL = 0.658 +- 0.425 (in-sample avg dev_std = 0.510)
NEC for r=0.1 all L1 = 0.497 +- 0.368 (in-sample avg dev_std = 0.510)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8525342960288809
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.709
NEC for r=0.2 class 1.0 = 0.293 +- 0.436 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all KL = 0.416 +- 0.436 (in-sample avg dev_std = 0.457)
NEC for r=0.2 all L1 = 0.293 +- 0.352 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8203935018050541
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.881
NEC for r=0.4 class 1.0 = 0.128 +- 0.355 (in-sample avg dev_std = 0.352)
NEC for r=0.4 all KL = 0.195 +- 0.355 (in-sample avg dev_std = 0.352)
NEC for r=0.4 all L1 = 0.128 +- 0.260 (in-sample avg dev_std = 0.352)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7958158844765343
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.968
NEC for r=0.8 class 1.0 = 0.046 +- 0.236 (in-sample avg dev_std = 0.292)
NEC for r=0.8 all KL = 0.089 +- 0.236 (in-sample avg dev_std = 0.292)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.292)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.94
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8160075396825397
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.824 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.907 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.824 +- 0.084 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.7745194444444443
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.189
NEC for r=0.1 class 1.0 = 0.707 +- 0.251 (in-sample avg dev_std = 0.571)
NEC for r=0.1 all KL = 0.847 +- 0.251 (in-sample avg dev_std = 0.571)
NEC for r=0.1 all L1 = 0.707 +- 0.208 (in-sample avg dev_std = 0.571)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.94
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7574293650793651
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.844
NEC for r=0.2 class 1.0 = 0.148 +- 0.314 (in-sample avg dev_std = 0.537)
NEC for r=0.2 all KL = 0.274 +- 0.314 (in-sample avg dev_std = 0.537)
NEC for r=0.2 all L1 = 0.148 +- 0.167 (in-sample avg dev_std = 0.537)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.94
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7540833333333333
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.899
NEC for r=0.4 class 1.0 = 0.067 +- 0.244 (in-sample avg dev_std = 0.365)
NEC for r=0.4 all KL = 0.132 +- 0.244 (in-sample avg dev_std = 0.365)
NEC for r=0.4 all L1 = 0.067 +- 0.119 (in-sample avg dev_std = 0.365)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.94
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7539876984126984
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.908
NEC for r=0.8 class 1.0 = 0.05 +- 0.220 (in-sample avg dev_std = 0.309)
NEC for r=0.8 all KL = 0.093 +- 0.220 (in-sample avg dev_std = 0.309)
NEC for r=0.8 all L1 = 0.05 +- 0.115 (in-sample avg dev_std = 0.309)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8080761750405187
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.33
NEC for r=0.05 class 1.0 = 0.584 +- 0.438 (in-sample avg dev_std = 0.312)
NEC for r=0.05 all KL = 0.703 +- 0.438 (in-sample avg dev_std = 0.312)
NEC for r=0.05 all L1 = 0.584 +- 0.381 (in-sample avg dev_std = 0.312)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8699578606158833
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
NEC for r=0.1 class 1.0 = 0.456 +- 0.456 (in-sample avg dev_std = 0.401)
NEC for r=0.1 all KL = 0.582 +- 0.456 (in-sample avg dev_std = 0.401)
NEC for r=0.1 all L1 = 0.456 +- 0.392 (in-sample avg dev_std = 0.401)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9029266612641814
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.63
NEC for r=0.2 class 1.0 = 0.334 +- 0.459 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all KL = 0.439 +- 0.459 (in-sample avg dev_std = 0.375)
NEC for r=0.2 all L1 = 0.334 +- 0.383 (in-sample avg dev_std = 0.375)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9105579416531605
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.744
NEC for r=0.4 class 1.0 = 0.227 +- 0.429 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all KL = 0.298 +- 0.429 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all L1 = 0.227 +- 0.353 (in-sample avg dev_std = 0.299)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8959238249594813
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.873
NEC for r=0.8 class 1.0 = 0.122 +- 0.352 (in-sample avg dev_std = 0.327)
NEC for r=0.8 all KL = 0.18 +- 0.352 (in-sample avg dev_std = 0.327)
NEC for r=0.8 all L1 = 0.122 +- 0.262 (in-sample avg dev_std = 0.327)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:33:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:33:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.794
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.900
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.929
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.918
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.906
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.942
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.927
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.921
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.920
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.920
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.814
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.875
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.917
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.934
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.924


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7942743682310469
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.837
SUFF_SIMPLE for r=0.05 class 1.0 = 0.775 +- 0.409 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.05 all KL = 0.599 +- 0.409 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.05 all L1 = 0.775 +- 0.253 (in-sample avg dev_std = 0.647)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9004693140794224
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.896
SUFF_SIMPLE for r=0.1 class 1.0 = 0.857 +- 0.377 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.1 all KL = 0.745 +- 0.377 (in-sample avg dev_std = 0.518)
SUFF_SIMPLE for r=0.1 all L1 = 0.857 +- 0.228 (in-sample avg dev_std = 0.518)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.929148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.867
SUFF_SIMPLE for r=0.2 class 1.0 = 0.83 +- 0.402 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 all KL = 0.715 +- 0.402 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 all L1 = 0.83 +- 0.259 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9177797833935017
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.806
SUFF_SIMPLE for r=0.4 class 1.0 = 0.773 +- 0.429 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.4 all KL = 0.65 +- 0.429 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.4 all L1 = 0.773 +- 0.305 (in-sample avg dev_std = 0.564)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9056750902527076
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.67
SUFF_SIMPLE for r=0.8 class 1.0 = 0.701 +- 0.471 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 all KL = 0.635 +- 0.471 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 all L1 = 0.701 +- 0.396 (in-sample avg dev_std = 0.261)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.9420884920634921
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.776
SUFF_SIMPLE for r=0.05 class 1.0 = 0.705 +- 0.372 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.05 all KL = 0.518 +- 0.372 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.05 all L1 = 0.705 +- 0.248 (in-sample avg dev_std = 0.720)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9265166666666668
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.742
SUFF_SIMPLE for r=0.1 class 1.0 = 0.668 +- 0.373 (in-sample avg dev_std = 0.752)
SUFF_SIMPLE for r=0.1 all KL = 0.472 +- 0.373 (in-sample avg dev_std = 0.752)
SUFF_SIMPLE for r=0.1 all L1 = 0.668 +- 0.256 (in-sample avg dev_std = 0.752)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9205666666666666
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.674
SUFF_SIMPLE for r=0.2 class 1.0 = 0.598 +- 0.357 (in-sample avg dev_std = 0.803)
SUFF_SIMPLE for r=0.2 all KL = 0.387 +- 0.357 (in-sample avg dev_std = 0.803)
SUFF_SIMPLE for r=0.2 all L1 = 0.598 +- 0.259 (in-sample avg dev_std = 0.803)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9196638888888888
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.478
SUFF_SIMPLE for r=0.4 class 1.0 = 0.425 +- 0.286 (in-sample avg dev_std = 0.845)
SUFF_SIMPLE for r=0.4 all KL = 0.22 +- 0.286 (in-sample avg dev_std = 0.845)
SUFF_SIMPLE for r=0.4 all L1 = 0.425 +- 0.235 (in-sample avg dev_std = 0.845)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9196519841269842
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.309
SUFF_SIMPLE for r=0.8 class 1.0 = 0.391 +- 0.409 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.8 all KL = 0.292 +- 0.409 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.8 all L1 = 0.391 +- 0.357 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.966
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8137678282009724
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.942
SUFF_SIMPLE for r=0.05 class 1.0 = 0.901 +- 0.333 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.05 all KL = 0.833 +- 0.333 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.213 (in-sample avg dev_std = 0.398)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8747811993517018
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.96
SUFF_SIMPLE for r=0.1 class 1.0 = 0.916 +- 0.308 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.1 all KL = 0.869 +- 0.308 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.213 (in-sample avg dev_std = 0.318)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.966
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9171324959481362
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.965
SUFF_SIMPLE for r=0.2 class 1.0 = 0.93 +- 0.280 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all KL = 0.904 +- 0.280 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all L1 = 0.93 +- 0.213 (in-sample avg dev_std = 0.238)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.966
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9343938411669367
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.954
SUFF_SIMPLE for r=0.4 class 1.0 = 0.927 +- 0.282 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all KL = 0.905 +- 0.282 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.226 (in-sample avg dev_std = 0.197)


ratio=0.8


40 5 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 5 0
40 5 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.966
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9243253646677472
len(reference) = 2428
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.944
SUFF_SIMPLE for r=0.8 class 1.0 = 0.946 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.938 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.946 +- 0.207 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7942743682310469
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.144
NEC for r=0.05 class 1.0 = 0.74 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.857 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.74 +- 0.300 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9004693140794224
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.339
NEC for r=0.1 class 1.0 = 0.629 +- 0.333 (in-sample avg dev_std = 0.560)
NEC for r=0.1 all KL = 0.815 +- 0.333 (in-sample avg dev_std = 0.560)
NEC for r=0.1 all L1 = 0.629 +- 0.309 (in-sample avg dev_std = 0.560)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.929148014440433
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.585
NEC for r=0.2 class 1.0 = 0.43 +- 0.418 (in-sample avg dev_std = 0.610)
NEC for r=0.2 all KL = 0.616 +- 0.418 (in-sample avg dev_std = 0.610)
NEC for r=0.2 all L1 = 0.43 +- 0.346 (in-sample avg dev_std = 0.610)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9177797833935017
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.765
NEC for r=0.4 class 1.0 = 0.267 +- 0.422 (in-sample avg dev_std = 0.566)
NEC for r=0.4 all KL = 0.422 +- 0.422 (in-sample avg dev_std = 0.566)
NEC for r=0.4 all L1 = 0.267 +- 0.310 (in-sample avg dev_std = 0.566)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9056750902527076
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.858
NEC for r=0.8 class 1.0 = 0.187 +- 0.404 (in-sample avg dev_std = 0.576)
NEC for r=0.8 all KL = 0.326 +- 0.404 (in-sample avg dev_std = 0.576)
NEC for r=0.8 all L1 = 0.187 +- 0.254 (in-sample avg dev_std = 0.576)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.9420884920634921
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.849 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.955 +- 0.086 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.849 +- 0.031 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9265166666666668
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.196
NEC for r=0.1 class 1.0 = 0.749 +- 0.180 (in-sample avg dev_std = 0.599)
NEC for r=0.1 all KL = 0.902 +- 0.180 (in-sample avg dev_std = 0.599)
NEC for r=0.1 all L1 = 0.749 +- 0.164 (in-sample avg dev_std = 0.599)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9205666666666666
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.752
NEC for r=0.2 class 1.0 = 0.335 +- 0.343 (in-sample avg dev_std = 0.779)
NEC for r=0.2 all KL = 0.553 +- 0.343 (in-sample avg dev_std = 0.779)
NEC for r=0.2 all L1 = 0.335 +- 0.227 (in-sample avg dev_std = 0.779)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9196638888888888
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.894
NEC for r=0.4 class 1.0 = 0.157 +- 0.336 (in-sample avg dev_std = 0.558)
NEC for r=0.4 all KL = 0.288 +- 0.336 (in-sample avg dev_std = 0.558)
NEC for r=0.4 all L1 = 0.157 +- 0.190 (in-sample avg dev_std = 0.558)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9196519841269842
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.918
NEC for r=0.8 class 1.0 = 0.12 +- 0.321 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all KL = 0.219 +- 0.321 (in-sample avg dev_std = 0.485)
NEC for r=0.8 all L1 = 0.12 +- 0.184 (in-sample avg dev_std = 0.485)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.966
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8137678282009724
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.201
NEC for r=0.05 class 1.0 = 0.682 +- 0.365 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all KL = 0.818 +- 0.365 (in-sample avg dev_std = 0.341)
NEC for r=0.05 all L1 = 0.682 +- 0.324 (in-sample avg dev_std = 0.341)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8747811993517018
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.407
NEC for r=0.1 class 1.0 = 0.52 +- 0.428 (in-sample avg dev_std = 0.428)
NEC for r=0.1 all KL = 0.664 +- 0.428 (in-sample avg dev_std = 0.428)
NEC for r=0.1 all L1 = 0.52 +- 0.377 (in-sample avg dev_std = 0.428)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.966
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9171324959481362
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.582
NEC for r=0.2 class 1.0 = 0.366 +- 0.459 (in-sample avg dev_std = 0.406)
NEC for r=0.2 all KL = 0.484 +- 0.459 (in-sample avg dev_std = 0.406)
NEC for r=0.2 all L1 = 0.366 +- 0.385 (in-sample avg dev_std = 0.406)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.966
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9343938411669367
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.703
NEC for r=0.4 class 1.0 = 0.258 +- 0.443 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all KL = 0.345 +- 0.443 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all L1 = 0.258 +- 0.360 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.966
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9243253646677472
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.837
NEC for r=0.8 class 1.0 = 0.177 +- 0.405 (in-sample avg dev_std = 0.446)
NEC for r=0.8 all KL = 0.264 +- 0.405 (in-sample avg dev_std = 0.446)
NEC for r=0.8 all L1 = 0.177 +- 0.295 (in-sample avg dev_std = 0.446)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:39:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:39:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.751
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.814
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.793
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.745
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.716
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.663
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.565
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.513
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.495
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.494
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.794
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.855
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.891
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.906
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.895


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7510938628158844
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.924
SUFF_SIMPLE for r=0.05 class 1.0 = 0.891 +- 0.311 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.05 all KL = 0.808 +- 0.311 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.05 all L1 = 0.891 +- 0.190 (in-sample avg dev_std = 0.452)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.814317689530686
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.935
SUFF_SIMPLE for r=0.1 class 1.0 = 0.907 +- 0.287 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all KL = 0.834 +- 0.287 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all L1 = 0.907 +- 0.173 (in-sample avg dev_std = 0.417)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7932454873646209
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.937
SUFF_SIMPLE for r=0.2 class 1.0 = 0.913 +- 0.288 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all KL = 0.854 +- 0.288 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.185 (in-sample avg dev_std = 0.393)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7446353790613718
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.887
SUFF_SIMPLE for r=0.4 class 1.0 = 0.864 +- 0.347 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 all KL = 0.788 +- 0.347 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 all L1 = 0.864 +- 0.245 (in-sample avg dev_std = 0.439)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7158555956678699
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.836
SUFF_SIMPLE for r=0.8 class 1.0 = 0.835 +- 0.388 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.8 all KL = 0.787 +- 0.388 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.8 all L1 = 0.835 +- 0.311 (in-sample avg dev_std = 0.337)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.638
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6632099206349207
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.288
SUFF_SIMPLE for r=0.05 class 1.0 = 0.586 +- 0.418 (in-sample avg dev_std = 0.702)
SUFF_SIMPLE for r=0.05 all KL = 0.448 +- 0.418 (in-sample avg dev_std = 0.702)
SUFF_SIMPLE for r=0.05 all L1 = 0.586 +- 0.324 (in-sample avg dev_std = 0.702)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5652337301587302
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.276
SUFF_SIMPLE for r=0.1 class 1.0 = 0.576 +- 0.419 (in-sample avg dev_std = 0.702)
SUFF_SIMPLE for r=0.1 all KL = 0.438 +- 0.419 (in-sample avg dev_std = 0.702)
SUFF_SIMPLE for r=0.1 all L1 = 0.576 +- 0.327 (in-sample avg dev_std = 0.702)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.638
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5126488095238095
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.25
SUFF_SIMPLE for r=0.2 class 1.0 = 0.564 +- 0.426 (in-sample avg dev_std = 0.673)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.426 (in-sample avg dev_std = 0.673)
SUFF_SIMPLE for r=0.2 all L1 = 0.564 +- 0.338 (in-sample avg dev_std = 0.673)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.638
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.49544801587301585
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.224
SUFF_SIMPLE for r=0.4 class 1.0 = 0.556 +- 0.436 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.4 all KL = 0.436 +- 0.436 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.4 all L1 = 0.556 +- 0.354 (in-sample avg dev_std = 0.617)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.638
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4942182539682539
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.06
SUFF_SIMPLE for r=0.8 class 1.0 = 0.48 +- 0.469 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all KL = 0.417 +- 0.469 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all L1 = 0.48 +- 0.400 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7940364667747165
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 1.0 = 0.982 +- 0.138 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.05 all KL = 0.974 +- 0.138 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.05 all L1 = 0.982 +- 0.106 (in-sample avg dev_std = 0.115)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.855392220421394
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 1.0 = 0.982 +- 0.138 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 all KL = 0.974 +- 0.138 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 all L1 = 0.982 +- 0.105 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8913079416531603
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.995
SUFF_SIMPLE for r=0.2 class 1.0 = 0.981 +- 0.144 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.2 all KL = 0.973 +- 0.144 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.2 all L1 = 0.981 +- 0.109 (in-sample avg dev_std = 0.120)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9057621555915722
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.99
SUFF_SIMPLE for r=0.4 class 1.0 = 0.979 +- 0.151 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 all KL = 0.973 +- 0.151 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.4 all L1 = 0.979 +- 0.123 (in-sample avg dev_std = 0.092)


ratio=0.8


40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8947495948136144
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.967
SUFF_SIMPLE for r=0.8 class 1.0 = 0.971 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.967 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.971 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7510938628158844
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.267
NEC for r=0.05 class 1.0 = 0.632 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.729 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.632 +- 0.379 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.814317689530686
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.381
NEC for r=0.1 class 1.0 = 0.595 +- 0.351 (in-sample avg dev_std = 0.570)
NEC for r=0.1 all KL = 0.762 +- 0.351 (in-sample avg dev_std = 0.570)
NEC for r=0.1 all L1 = 0.595 +- 0.320 (in-sample avg dev_std = 0.570)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.7932454873646209
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.653
NEC for r=0.2 class 1.0 = 0.365 +- 0.413 (in-sample avg dev_std = 0.570)
NEC for r=0.2 all KL = 0.512 +- 0.413 (in-sample avg dev_std = 0.570)
NEC for r=0.2 all L1 = 0.365 +- 0.340 (in-sample avg dev_std = 0.570)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.7446353790613718
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.833
NEC for r=0.4 class 1.0 = 0.199 +- 0.370 (in-sample avg dev_std = 0.511)
NEC for r=0.4 all KL = 0.313 +- 0.370 (in-sample avg dev_std = 0.511)
NEC for r=0.4 all L1 = 0.199 +- 0.271 (in-sample avg dev_std = 0.511)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.7158555956678699
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.938
NEC for r=0.8 class 1.0 = 0.087 +- 0.279 (in-sample avg dev_std = 0.394)
NEC for r=0.8 all KL = 0.156 +- 0.279 (in-sample avg dev_std = 0.394)
NEC for r=0.8 all L1 = 0.087 +- 0.172 (in-sample avg dev_std = 0.394)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.638
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.6632099206349207
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.569 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.636 +- 0.455 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.569 +- 0.385 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.5652337301587302
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.072
NEC for r=0.1 class 1.0 = 0.54 +- 0.444 (in-sample avg dev_std = 0.418)
NEC for r=0.1 all KL = 0.623 +- 0.444 (in-sample avg dev_std = 0.418)
NEC for r=0.1 all L1 = 0.54 +- 0.368 (in-sample avg dev_std = 0.418)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.638
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5126488095238095
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.381
NEC for r=0.2 class 1.0 = 0.343 +- 0.396 (in-sample avg dev_std = 0.713)
NEC for r=0.2 all KL = 0.485 +- 0.396 (in-sample avg dev_std = 0.713)
NEC for r=0.2 all L1 = 0.343 +- 0.287 (in-sample avg dev_std = 0.713)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.638
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.49544801587301585
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.429
NEC for r=0.4 class 1.0 = 0.291 +- 0.385 (in-sample avg dev_std = 0.668)
NEC for r=0.4 all KL = 0.422 +- 0.385 (in-sample avg dev_std = 0.668)
NEC for r=0.4 all L1 = 0.291 +- 0.277 (in-sample avg dev_std = 0.668)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.638
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.4942182539682539
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.325
NEC for r=0.8 class 1.0 = 0.366 +- 0.419 (in-sample avg dev_std = 0.656)
NEC for r=0.8 all KL = 0.488 +- 0.419 (in-sample avg dev_std = 0.656)
NEC for r=0.8 all L1 = 0.366 +- 0.323 (in-sample avg dev_std = 0.656)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7940364667747165
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.292
NEC for r=0.05 class 1.0 = 0.624 +- 0.402 (in-sample avg dev_std = 0.373)
NEC for r=0.05 all KL = 0.747 +- 0.402 (in-sample avg dev_std = 0.373)
NEC for r=0.05 all L1 = 0.624 +- 0.352 (in-sample avg dev_std = 0.373)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.855392220421394
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.489
NEC for r=0.1 class 1.0 = 0.463 +- 0.443 (in-sample avg dev_std = 0.410)
NEC for r=0.1 all KL = 0.581 +- 0.443 (in-sample avg dev_std = 0.410)
NEC for r=0.1 all L1 = 0.463 +- 0.385 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8913079416531603
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.643
NEC for r=0.2 class 1.0 = 0.327 +- 0.447 (in-sample avg dev_std = 0.382)
NEC for r=0.2 all KL = 0.422 +- 0.447 (in-sample avg dev_std = 0.382)
NEC for r=0.2 all L1 = 0.327 +- 0.376 (in-sample avg dev_std = 0.382)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9057621555915722
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.728
NEC for r=0.4 class 1.0 = 0.243 +- 0.431 (in-sample avg dev_std = 0.312)
NEC for r=0.4 all KL = 0.311 +- 0.431 (in-sample avg dev_std = 0.312)
NEC for r=0.4 all L1 = 0.243 +- 0.359 (in-sample avg dev_std = 0.312)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8947495948136144
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.851
NEC for r=0.8 class 1.0 = 0.149 +- 0.368 (in-sample avg dev_std = 0.371)
NEC for r=0.8 all KL = 0.213 +- 0.368 (in-sample avg dev_std = 0.371)
NEC for r=0.8 all L1 = 0.149 +- 0.280 (in-sample avg dev_std = 0.371)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:44:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:44:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.757
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.897
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.962
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.978
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.979
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.970
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.968
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.967
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.967
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.967
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.776
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.848
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.898
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.935
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.956


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7573140794223827
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.969
SUFF_SIMPLE for r=0.05 class 1.0 = 0.965 +- 0.204 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.952 +- 0.204 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.965 +- 0.149 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.896682310469314
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.068 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.1 all KL = 0.994 +- 0.068 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.044 (in-sample avg dev_std = 0.082)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9621083032490974
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9783826714801442
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9785126353790614
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.731
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.969865476190476
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.731
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9677119047619047
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.731
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.731
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9673321428571428
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.731
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.731
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9673123015873015
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.731
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.731
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9673123015873015
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.731
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7763200972447326
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.927
SUFF_SIMPLE for r=0.05 class 1.0 = 0.925 +- 0.287 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all KL = 0.903 +- 0.287 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.223 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8477856564019449
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.966
SUFF_SIMPLE for r=0.1 class 1.0 = 0.964 +- 0.206 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.1 all KL = 0.952 +- 0.206 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.1 all L1 = 0.964 +- 0.157 (in-sample avg dev_std = 0.200)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8984473257698541
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.999
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.030 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.999 +- 0.030 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.999 +- 0.027 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9350923824959482
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.8


40 5 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9562791734197732
len(reference) = 2460
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7573140794223827
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.213
NEC for r=0.05 class 1.0 = 0.679 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.78 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.679 +- 0.351 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.896682310469314
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.199
NEC for r=0.1 class 1.0 = 0.748 +- 0.223 (in-sample avg dev_std = 0.559)
NEC for r=0.1 all KL = 0.91 +- 0.223 (in-sample avg dev_std = 0.559)
NEC for r=0.1 all L1 = 0.748 +- 0.211 (in-sample avg dev_std = 0.559)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9621083032490974
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 1.0 = 0.523 +- 0.352 (in-sample avg dev_std = 0.681)
NEC for r=0.2 all KL = 0.707 +- 0.352 (in-sample avg dev_std = 0.681)
NEC for r=0.2 all L1 = 0.523 +- 0.312 (in-sample avg dev_std = 0.681)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9783826714801442
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.744
NEC for r=0.4 class 1.0 = 0.295 +- 0.394 (in-sample avg dev_std = 0.603)
NEC for r=0.4 all KL = 0.435 +- 0.394 (in-sample avg dev_std = 0.603)
NEC for r=0.4 all L1 = 0.295 +- 0.307 (in-sample avg dev_std = 0.603)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9785126353790614
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.9
NEC for r=0.8 class 1.0 = 0.136 +- 0.333 (in-sample avg dev_std = 0.493)
NEC for r=0.8 all KL = 0.229 +- 0.333 (in-sample avg dev_std = 0.493)
NEC for r=0.8 all L1 = 0.136 +- 0.216 (in-sample avg dev_std = 0.493)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.731
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.969865476190476
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.704 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.759 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.704 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.9677119047619047
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.02
NEC for r=0.1 class 1.0 = 0.696 +- 0.358 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all KL = 0.757 +- 0.358 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all L1 = 0.696 +- 0.259 (in-sample avg dev_std = 0.263)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.731
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9673321428571428
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.424
NEC for r=0.2 class 1.0 = 0.413 +- 0.363 (in-sample avg dev_std = 0.779)
NEC for r=0.2 all KL = 0.571 +- 0.363 (in-sample avg dev_std = 0.779)
NEC for r=0.2 all L1 = 0.413 +- 0.241 (in-sample avg dev_std = 0.779)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.731
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9673123015873015
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.649
NEC for r=0.4 class 1.0 = 0.134 +- 0.288 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all KL = 0.221 +- 0.288 (in-sample avg dev_std = 0.493)
NEC for r=0.4 all L1 = 0.134 +- 0.163 (in-sample avg dev_std = 0.493)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.731
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9673123015873015
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.705
NEC for r=0.8 class 1.0 = 0.045 +- 0.185 (in-sample avg dev_std = 0.288)
NEC for r=0.8 all KL = 0.077 +- 0.185 (in-sample avg dev_std = 0.288)
NEC for r=0.8 all L1 = 0.045 +- 0.098 (in-sample avg dev_std = 0.288)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7763200972447326
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.311
NEC for r=0.05 class 1.0 = 0.624 +- 0.409 (in-sample avg dev_std = 0.414)
NEC for r=0.05 all KL = 0.743 +- 0.409 (in-sample avg dev_std = 0.414)
NEC for r=0.05 all L1 = 0.624 +- 0.354 (in-sample avg dev_std = 0.414)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8477856564019449
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.361
NEC for r=0.1 class 1.0 = 0.602 +- 0.372 (in-sample avg dev_std = 0.529)
NEC for r=0.1 all KL = 0.748 +- 0.372 (in-sample avg dev_std = 0.529)
NEC for r=0.1 all L1 = 0.602 +- 0.332 (in-sample avg dev_std = 0.529)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8984473257698541
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.47
NEC for r=0.2 class 1.0 = 0.534 +- 0.360 (in-sample avg dev_std = 0.624)
NEC for r=0.2 all KL = 0.703 +- 0.360 (in-sample avg dev_std = 0.624)
NEC for r=0.2 all L1 = 0.534 +- 0.322 (in-sample avg dev_std = 0.624)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.9350923824959482
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.597
NEC for r=0.4 class 1.0 = 0.427 +- 0.386 (in-sample avg dev_std = 0.614)
NEC for r=0.4 all KL = 0.589 +- 0.386 (in-sample avg dev_std = 0.614)
NEC for r=0.4 all L1 = 0.427 +- 0.330 (in-sample avg dev_std = 0.614)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9562791734197732
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.744
NEC for r=0.8 class 1.0 = 0.286 +- 0.387 (in-sample avg dev_std = 0.558)
NEC for r=0.8 all KL = 0.423 +- 0.387 (in-sample avg dev_std = 0.558)
NEC for r=0.8 all L1 = 0.286 +- 0.307 (in-sample avg dev_std = 0.558)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 21:49:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 09:49:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.768
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.862
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.886
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.879
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.869
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.720
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.622
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.564
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.543
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.541
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.801
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.864
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.907
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.929
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.929


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7682238267148015
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.591
SUFF_SIMPLE for r=0.05 class 1.0 = 0.494 +- 0.255 (in-sample avg dev_std = 0.858)
SUFF_SIMPLE for r=0.05 all KL = 0.172 +- 0.255 (in-sample avg dev_std = 0.858)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.229 (in-sample avg dev_std = 0.858)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8618086642599279
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.614
SUFF_SIMPLE for r=0.1 class 1.0 = 0.513 +- 0.278 (in-sample avg dev_std = 0.844)
SUFF_SIMPLE for r=0.1 all KL = 0.196 +- 0.278 (in-sample avg dev_std = 0.844)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.235 (in-sample avg dev_std = 0.844)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8857978339350182
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.59
SUFF_SIMPLE for r=0.2 class 1.0 = 0.496 +- 0.316 (in-sample avg dev_std = 0.839)
SUFF_SIMPLE for r=0.2 all KL = 0.204 +- 0.316 (in-sample avg dev_std = 0.839)
SUFF_SIMPLE for r=0.2 all L1 = 0.496 +- 0.253 (in-sample avg dev_std = 0.839)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8788086642599279
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.534
SUFF_SIMPLE for r=0.4 class 1.0 = 0.475 +- 0.332 (in-sample avg dev_std = 0.754)
SUFF_SIMPLE for r=0.4 all KL = 0.215 +- 0.332 (in-sample avg dev_std = 0.754)
SUFF_SIMPLE for r=0.4 all L1 = 0.475 +- 0.283 (in-sample avg dev_std = 0.754)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8687220216606498
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.43
SUFF_SIMPLE for r=0.8 class 1.0 = 0.467 +- 0.439 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all KL = 0.324 +- 0.439 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all L1 = 0.467 +- 0.373 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.768
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.719765873015873
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.049
SUFF_SIMPLE for r=0.05 class 1.0 = 0.315 +- 0.345 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.05 all KL = 0.247 +- 0.345 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.05 all L1 = 0.315 +- 0.272 (in-sample avg dev_std = 0.381)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6215630952380952
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.044
SUFF_SIMPLE for r=0.1 class 1.0 = 0.314 +- 0.347 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all KL = 0.248 +- 0.347 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all L1 = 0.314 +- 0.274 (in-sample avg dev_std = 0.364)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.768
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5635535714285714
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.034
SUFF_SIMPLE for r=0.2 class 1.0 = 0.312 +- 0.350 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.2 all KL = 0.248 +- 0.350 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.2 all L1 = 0.312 +- 0.277 (in-sample avg dev_std = 0.323)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.768
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5429488095238095
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.022
SUFF_SIMPLE for r=0.4 class 1.0 = 0.309 +- 0.352 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.4 all KL = 0.249 +- 0.352 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.4 all L1 = 0.309 +- 0.280 (in-sample avg dev_std = 0.264)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.768
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5409357142857143
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.005
SUFF_SIMPLE for r=0.8 class 1.0 = 0.307 +- 0.358 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.8 all KL = 0.252 +- 0.358 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.8 all L1 = 0.307 +- 0.287 (in-sample avg dev_std = 0.048)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.947
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8010619935170179
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.817
SUFF_SIMPLE for r=0.05 class 1.0 = 0.808 +- 0.419 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 all KL = 0.723 +- 0.419 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.307 (in-sample avg dev_std = 0.466)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8641928687196112
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.876
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.396 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all KL = 0.773 +- 0.396 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all L1 = 0.841 +- 0.288 (in-sample avg dev_std = 0.416)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.947
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9073561588330632
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.887
SUFF_SIMPLE for r=0.2 class 1.0 = 0.848 +- 0.384 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.2 all KL = 0.794 +- 0.384 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.2 all L1 = 0.848 +- 0.295 (in-sample avg dev_std = 0.306)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.947
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.929413695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.874
SUFF_SIMPLE for r=0.4 class 1.0 = 0.852 +- 0.376 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all KL = 0.815 +- 0.376 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all L1 = 0.852 +- 0.305 (in-sample avg dev_std = 0.229)


ratio=0.8


40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.946
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9293606158833064
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.897
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.253 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.7682238267148015
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.191
NEC for r=0.05 class 1.0 = 0.701 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.811 +- 0.391 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.701 +- 0.338 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8618086642599279
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.184
NEC for r=0.1 class 1.0 = 0.756 +- 0.233 (in-sample avg dev_std = 0.550)
NEC for r=0.1 all KL = 0.932 +- 0.233 (in-sample avg dev_std = 0.550)
NEC for r=0.1 all L1 = 0.756 +- 0.216 (in-sample avg dev_std = 0.550)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.8857978339350182
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.421
NEC for r=0.2 class 1.0 = 0.608 +- 0.230 (in-sample avg dev_std = 0.763)
NEC for r=0.2 all KL = 0.876 +- 0.230 (in-sample avg dev_std = 0.763)
NEC for r=0.2 all L1 = 0.608 +- 0.252 (in-sample avg dev_std = 0.763)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.8788086642599279
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.631
NEC for r=0.4 class 1.0 = 0.431 +- 0.353 (in-sample avg dev_std = 0.755)
NEC for r=0.4 all KL = 0.704 +- 0.353 (in-sample avg dev_std = 0.755)
NEC for r=0.4 all L1 = 0.431 +- 0.285 (in-sample avg dev_std = 0.755)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.8687220216606498
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.788
NEC for r=0.8 class 1.0 = 0.291 +- 0.378 (in-sample avg dev_std = 0.711)
NEC for r=0.8 all KL = 0.557 +- 0.378 (in-sample avg dev_std = 0.711)
NEC for r=0.8 all L1 = 0.291 +- 0.241 (in-sample avg dev_std = 0.711)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.768
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.719765873015873
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.0
NEC for r=0.05 class 1.0 = 0.696 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.75 +- 0.356 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.696 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.6215630952380952
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.023
NEC for r=0.1 class 1.0 = 0.7 +- 0.335 (in-sample avg dev_std = 0.227)
NEC for r=0.1 all KL = 0.763 +- 0.335 (in-sample avg dev_std = 0.227)
NEC for r=0.1 all L1 = 0.7 +- 0.269 (in-sample avg dev_std = 0.227)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.768
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.5635535714285714
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.194
NEC for r=0.2 class 1.0 = 0.652 +- 0.300 (in-sample avg dev_std = 0.663)
NEC for r=0.2 all KL = 0.759 +- 0.300 (in-sample avg dev_std = 0.663)
NEC for r=0.2 all L1 = 0.652 +- 0.225 (in-sample avg dev_std = 0.663)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.768
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.5429488095238095
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.2
NEC for r=0.4 class 1.0 = 0.638 +- 0.310 (in-sample avg dev_std = 0.670)
NEC for r=0.4 all KL = 0.752 +- 0.310 (in-sample avg dev_std = 0.670)
NEC for r=0.4 all L1 = 0.638 +- 0.231 (in-sample avg dev_std = 0.670)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.768
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.5409357142857143
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.169
NEC for r=0.8 class 1.0 = 0.64 +- 0.330 (in-sample avg dev_std = 0.615)
NEC for r=0.8 all KL = 0.742 +- 0.330 (in-sample avg dev_std = 0.615)
NEC for r=0.8 all L1 = 0.64 +- 0.250 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.947
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.8010619935170179
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.181
NEC for r=0.05 class 1.0 = 0.699 +- 0.370 (in-sample avg dev_std = 0.291)
NEC for r=0.05 all KL = 0.824 +- 0.370 (in-sample avg dev_std = 0.291)
NEC for r=0.05 all L1 = 0.699 +- 0.318 (in-sample avg dev_std = 0.291)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.8641928687196112
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.259
NEC for r=0.1 class 1.0 = 0.658 +- 0.340 (in-sample avg dev_std = 0.543)
NEC for r=0.1 all KL = 0.832 +- 0.340 (in-sample avg dev_std = 0.543)
NEC for r=0.1 all L1 = 0.658 +- 0.301 (in-sample avg dev_std = 0.543)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.947
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.9073561588330632
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.4
NEC for r=0.2 class 1.0 = 0.555 +- 0.353 (in-sample avg dev_std = 0.641)
NEC for r=0.2 all KL = 0.772 +- 0.353 (in-sample avg dev_std = 0.641)
NEC for r=0.2 all L1 = 0.555 +- 0.314 (in-sample avg dev_std = 0.641)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.947
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.929413695299838
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.539
NEC for r=0.4 class 1.0 = 0.435 +- 0.389 (in-sample avg dev_std = 0.644)
NEC for r=0.4 all KL = 0.661 +- 0.389 (in-sample avg dev_std = 0.644)
NEC for r=0.4 all L1 = 0.435 +- 0.323 (in-sample avg dev_std = 0.644)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.947
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.9293606158833064
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.673
NEC for r=0.8 class 1.0 = 0.329 +- 0.408 (in-sample avg dev_std = 0.615)
NEC for r=0.8 all KL = 0.537 +- 0.408 (in-sample avg dev_std = 0.615)
NEC for r=0.8 all L1 = 0.329 +- 0.311 (in-sample avg dev_std = 0.615)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.977, 0.987, 0.984, 0.973, 0.972], 'all_L1': [0.99, 0.994, 0.992, 0.986, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [0.975, 0.987, 0.987, 0.98, 0.968], 'all_L1': [0.989, 0.993, 0.994, 0.988, 0.972]}), defaultdict(<class 'list'>, {'all_KL': [0.753, 0.741, 0.736, 0.668, 0.62], 'all_L1': [0.854, 0.845, 0.837, 0.782, 0.701]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.931, 0.931, 0.892, 0.874], 'all_L1': [0.97, 0.967, 0.966, 0.937, 0.902]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.745, 0.715, 0.65, 0.635], 'all_L1': [0.775, 0.857, 0.83, 0.773, 0.701]}), defaultdict(<class 'list'>, {'all_KL': [0.808, 0.834, 0.854, 0.788, 0.787], 'all_L1': [0.891, 0.907, 0.913, 0.864, 0.835]}), defaultdict(<class 'list'>, {'all_KL': [0.952, 0.994, 1.0, 1.0, 1.0], 'all_L1': [0.965, 0.996, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.172, 0.196, 0.204, 0.215, 0.324], 'all_L1': [0.494, 0.513, 0.496, 0.475, 0.467]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.704, 0.725, 0.395, 0.164, 0.042], 'all_L1': [0.603, 0.528, 0.274, 0.107, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.701, 0.425, 0.226, 0.131], 'all_L1': [0.646, 0.522, 0.293, 0.134, 0.064]}), defaultdict(<class 'list'>, {'all_KL': [0.737, 0.683, 0.384, 0.197, 0.112], 'all_L1': [0.639, 0.523, 0.282, 0.13, 0.061]}), defaultdict(<class 'list'>, {'all_KL': [0.662, 0.654, 0.365, 0.193, 0.094], 'all_L1': [0.577, 0.504, 0.276, 0.133, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.737, 0.727, 0.391, 0.202, 0.078], 'all_L1': [0.637, 0.538, 0.276, 0.128, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.658, 0.416, 0.195, 0.089], 'all_L1': [0.612, 0.497, 0.293, 0.128, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.857, 0.815, 0.616, 0.422, 0.326], 'all_L1': [0.74, 0.629, 0.43, 0.267, 0.187]}), defaultdict(<class 'list'>, {'all_KL': [0.729, 0.762, 0.512, 0.313, 0.156], 'all_L1': [0.632, 0.595, 0.365, 0.199, 0.087]}), defaultdict(<class 'list'>, {'all_KL': [0.78, 0.91, 0.707, 0.435, 0.229], 'all_L1': [0.679, 0.748, 0.523, 0.295, 0.136]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.932, 0.876, 0.704, 0.557], 'all_L1': [0.701, 0.756, 0.608, 0.431, 0.291]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.912, 0.907, 0.889, 0.932], 'all_L1': [0.958, 0.96, 0.959, 0.95, 0.953]}), defaultdict(<class 'list'>, {'all_KL': [0.999, 0.998, 0.999, 0.997, 0.996], 'all_L1': [0.999, 0.999, 1.0, 0.998, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.344, 0.334, 0.309, 0.286], 'all_L1': [0.485, 0.475, 0.46, 0.422, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.997, 0.998, 0.998, 1.0], 'all_L1': [0.999, 0.998, 0.999, 0.999, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.508, 0.47, 0.397, 0.295, 0.263], 'all_L1': [0.698, 0.667, 0.603, 0.498, 0.343]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.472, 0.387, 0.22, 0.292], 'all_L1': [0.705, 0.668, 0.598, 0.425, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.438, 0.433, 0.436, 0.417], 'all_L1': [0.586, 0.576, 0.564, 0.556, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.248, 0.248, 0.249, 0.252], 'all_L1': [0.315, 0.314, 0.312, 0.309, 0.307]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.962, 0.904, 0.196, 0.016, 0.003], 'all_L1': [0.852, 0.741, 0.097, 0.008, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.972, 0.897, 0.318, 0.101, 0.063], 'all_L1': [0.843, 0.704, 0.153, 0.045, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.786, 0.113, 0.02, 0.006], 'all_L1': [0.776, 0.653, 0.059, 0.01, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.78, 0.74, 0.434, 0.393, 0.521], 'all_L1': [0.729, 0.651, 0.302, 0.28, 0.4]}), defaultdict(<class 'list'>, {'all_KL': [0.874, 0.828, 0.204, 0.038, 0.01], 'all_L1': [0.802, 0.698, 0.111, 0.022, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.847, 0.274, 0.132, 0.093], 'all_L1': [0.824, 0.707, 0.148, 0.067, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.955, 0.902, 0.553, 0.288, 0.219], 'all_L1': [0.849, 0.749, 0.335, 0.157, 0.12]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.623, 0.485, 0.422, 0.488], 'all_L1': [0.569, 0.54, 0.343, 0.291, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.757, 0.571, 0.221, 0.077], 'all_L1': [0.704, 0.696, 0.413, 0.134, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.75, 0.763, 0.759, 0.752, 0.742], 'all_L1': [0.696, 0.7, 0.652, 0.638, 0.64]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.991, 0.994, 0.999, 1.0, 1.0], 'all_L1': [0.995, 0.996, 0.999, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.996, 0.995, 0.996, 0.995], 'all_L1': [0.997, 0.997, 0.997, 0.997, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.99, 0.989, 0.988, 0.983], 'all_L1': [0.992, 0.992, 0.991, 0.991, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.957, 0.953, 0.958, 0.943, 0.943], 'all_L1': [0.968, 0.966, 0.968, 0.955, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.966, 0.963, 0.961, 0.958, 0.961], 'all_L1': [0.977, 0.975, 0.974, 0.969, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.833, 0.869, 0.904, 0.905, 0.938], 'all_L1': [0.901, 0.916, 0.93, 0.927, 0.946]}), defaultdict(<class 'list'>, {'all_KL': [0.974, 0.974, 0.973, 0.973, 0.967], 'all_L1': [0.982, 0.982, 0.981, 0.979, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.903, 0.952, 0.999, 1.0, 1.0], 'all_L1': [0.925, 0.964, 0.999, 1.0, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.723, 0.773, 0.794, 0.815, 0.896], 'all_L1': [0.808, 0.841, 0.848, 0.852, 0.91]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.643, 0.565, 0.41, 0.302, 0.127], 'all_L1': [0.505, 0.428, 0.297, 0.22, 0.087]}), defaultdict(<class 'list'>, {'all_KL': [0.79, 0.656, 0.469, 0.307, 0.171], 'all_L1': [0.649, 0.506, 0.354, 0.23, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.762, 0.633, 0.466, 0.32, 0.192], 'all_L1': [0.632, 0.5, 0.36, 0.249, 0.136]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.576, 0.451, 0.31, 0.189], 'all_L1': [0.568, 0.462, 0.352, 0.241, 0.136]}), defaultdict(<class 'list'>, {'all_KL': [0.661, 0.61, 0.475, 0.37, 0.209], 'all_L1': [0.54, 0.464, 0.342, 0.265, 0.138]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.582, 0.439, 0.298, 0.18], 'all_L1': [0.584, 0.456, 0.334, 0.227, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.818, 0.664, 0.484, 0.345, 0.264], 'all_L1': [0.682, 0.52, 0.366, 0.258, 0.177]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.581, 0.422, 0.311, 0.213], 'all_L1': [0.624, 0.463, 0.327, 0.243, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.748, 0.703, 0.589, 0.423], 'all_L1': [0.624, 0.602, 0.534, 0.427, 0.286]}), defaultdict(<class 'list'>, {'all_KL': [0.824, 0.832, 0.772, 0.661, 0.537], 'all_L1': [0.699, 0.658, 0.555, 0.435, 0.329]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.893 +- 0.151, 0.907 +- 0.143, 0.903 +- 0.150, 0.880 +- 0.160, 0.856 +- 0.171
suff_simple class all_KL  =  0.817 +- 0.248, 0.841 +- 0.237, 0.841 +- 0.236, 0.817 +- 0.239, 0.818 +- 0.216
suff_simple_acc_int  =  0.919 +- 0.120, 0.931 +- 0.113, 0.925 +- 0.121, 0.899 +- 0.140, 0.848 +- 0.182
nec class all_L1  =  0.647 +- 0.046, 0.584 +- 0.092, 0.362 +- 0.114, 0.195 +- 0.100, 0.099 +- 0.080
nec class all_KL  =  0.747 +- 0.053, 0.757 +- 0.094, 0.509 +- 0.163, 0.305 +- 0.162, 0.181 +- 0.148
nec_acc_int  =  0.253 +- 0.054, 0.389 +- 0.108, 0.646 +- 0.104, 0.829 +- 0.084, 0.928 +- 0.059

Eval split val
suff_simple class all_L1  =  0.774 +- 0.240, 0.766 +- 0.245, 0.750 +- 0.255, 0.716 +- 0.280, 0.681 +- 0.313
suff_simple class all_KL  =  0.698 +- 0.294, 0.688 +- 0.301, 0.670 +- 0.315, 0.639 +- 0.343, 0.644 +- 0.345
suff_simple_acc_int  =  0.664 +- 0.306, 0.655 +- 0.308, 0.637 +- 0.314, 0.597 +- 0.327, 0.510 +- 0.391
nec class all_L1  =  0.764 +- 0.086, 0.684 +- 0.056, 0.261 +- 0.174, 0.165 +- 0.186, 0.166 +- 0.212
nec class all_KL  =  0.845 +- 0.105, 0.805 +- 0.085, 0.391 +- 0.193, 0.238 +- 0.222, 0.222 +- 0.252
nec_acc_int  =  0.002 +- 0.007, 0.145 +- 0.079, 0.664 +- 0.244, 0.734 +- 0.250, 0.721 +- 0.282

Eval split test
suff_simple class all_L1  =  0.955 +- 0.058, 0.963 +- 0.047, 0.969 +- 0.045, 0.967 +- 0.045, 0.972 +- 0.029
suff_simple class all_KL  =  0.933 +- 0.086, 0.946 +- 0.068, 0.957 +- 0.061, 0.958 +- 0.056, 0.968 +- 0.033
suff_simple_acc_int  =  0.967 +- 0.056, 0.978 +- 0.037, 0.982 +- 0.033, 0.978 +- 0.037, 0.969 +- 0.032
nec class all_L1  =  0.611 +- 0.058, 0.506 +- 0.068, 0.382 +- 0.083, 0.280 +- 0.077, 0.167 +- 0.075
nec class all_KL  =  0.736 +- 0.062, 0.645 +- 0.082, 0.509 +- 0.117, 0.381 +- 0.125, 0.251 +- 0.122
nec_acc_int  =  0.309 +- 0.078, 0.447 +- 0.081, 0.593 +- 0.085, 0.703 +- 0.071, 0.839 +- 0.070


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.770 +- 0.066, 0.746 +- 0.059, 0.632 +- 0.054, 0.538 +- 0.053, 0.477 +- 0.059
Faith. Armon (L1)= 		  =  0.740 +- 0.061, 0.696 +- 0.063, 0.494 +- 0.082, 0.297 +- 0.097, 0.159 +- 0.099
Faith. GMean (L1)= 	  =  0.755 +- 0.063, 0.720 +- 0.060, 0.558 +- 0.063, 0.394 +- 0.067, 0.260 +- 0.078
Faith. Aritm (KL)= 		  =  0.782 +- 0.112, 0.799 +- 0.100, 0.675 +- 0.082, 0.561 +- 0.076, 0.500 +- 0.067
Faith. Armon (KL)= 		  =  0.748 +- 0.164, 0.762 +- 0.159, 0.580 +- 0.120, 0.383 +- 0.100, 0.246 +- 0.114
Faith. GMean (KL)= 	  =  0.764 +- 0.141, 0.779 +- 0.133, 0.625 +- 0.101, 0.461 +- 0.081, 0.340 +- 0.087

Eval split val
Faith. Aritm (L1)= 		  =  0.769 +- 0.146, 0.725 +- 0.133, 0.505 +- 0.092, 0.440 +- 0.094, 0.423 +- 0.109
Faith. Armon (L1)= 		  =  0.753 +- 0.158, 0.703 +- 0.137, 0.322 +- 0.139, 0.188 +- 0.145, 0.163 +- 0.163
Faith. GMean (L1)= 	  =  0.761 +- 0.152, 0.714 +- 0.135, 0.392 +- 0.106, 0.254 +- 0.122, 0.213 +- 0.141
Faith. Aritm (KL)= 		  =  0.771 +- 0.176, 0.746 +- 0.171, 0.531 +- 0.123, 0.439 +- 0.120, 0.433 +- 0.115
Faith. Armon (KL)= 		  =  0.734 +- 0.210, 0.708 +- 0.203, 0.406 +- 0.131, 0.227 +- 0.140, 0.188 +- 0.156
Faith. GMean (KL)= 	  =  0.752 +- 0.194, 0.726 +- 0.188, 0.459 +- 0.115, 0.289 +- 0.120, 0.243 +- 0.138

Eval split test
Faith. Aritm (L1)= 		  =  0.783 +- 0.023, 0.734 +- 0.022, 0.675 +- 0.034, 0.623 +- 0.034, 0.570 +- 0.032
Faith. Armon (L1)= 		  =  0.741 +- 0.035, 0.659 +- 0.046, 0.541 +- 0.074, 0.427 +- 0.082, 0.277 +- 0.100
Faith. GMean (L1)= 	  =  0.761 +- 0.028, 0.695 +- 0.033, 0.604 +- 0.055, 0.515 +- 0.060, 0.393 +- 0.080
Faith. Aritm (KL)= 		  =  0.835 +- 0.032, 0.796 +- 0.027, 0.733 +- 0.047, 0.670 +- 0.053, 0.609 +- 0.054
Faith. Armon (KL)= 		  =  0.818 +- 0.034, 0.760 +- 0.038, 0.654 +- 0.078, 0.532 +- 0.104, 0.383 +- 0.134
Faith. GMean (KL)= 	  =  0.826 +- 0.033, 0.778 +- 0.032, 0.692 +- 0.063, 0.596 +- 0.080, 0.479 +- 0.103
Computed for split load_split = id



Completed in  0:53:29.710327  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift
DONE all :)
