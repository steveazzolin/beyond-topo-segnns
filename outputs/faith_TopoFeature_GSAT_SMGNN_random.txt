nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 925235

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:05:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:05:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0014
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0023
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0023

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.043
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.080
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.053
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.089
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.043090252707581225
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.674
SUFF_SIMPLE for r=0.05 class 1.0 = 0.634 +- 0.419 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.05 all KL = 0.338 +- 0.419 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.05 all L1 = 0.634 +- 0.319 (in-sample avg dev_std = 0.594)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.059375451263537916
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.692
SUFF_SIMPLE for r=0.1 class 1.0 = 0.648 +- 0.428 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all KL = 0.362 +- 0.428 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.1 all L1 = 0.648 +- 0.321 (in-sample avg dev_std = 0.582)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08040072202166065
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.677
SUFF_SIMPLE for r=0.2 class 1.0 = 0.64 +- 0.427 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 all KL = 0.342 +- 0.427 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.2 all L1 = 0.64 +- 0.318 (in-sample avg dev_std = 0.581)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09111913357400722
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.73
SUFF_SIMPLE for r=0.4 class 1.0 = 0.687 +- 0.443 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.4 all KL = 0.421 +- 0.443 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.4 all L1 = 0.687 +- 0.318 (in-sample avg dev_std = 0.525)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09758122743682311
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.87
SUFF_SIMPLE for r=0.8 class 1.0 = 0.865 +- 0.387 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all KL = 0.781 +- 0.387 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all L1 = 0.865 +- 0.280 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.458
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011022222222222221
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.128
SUFF_SIMPLE for r=0.05 class 1.0 = 0.581 +- 0.440 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all KL = 0.508 +- 0.440 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.05 all L1 = 0.581 +- 0.363 (in-sample avg dev_std = 0.448)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.458
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011990873015873016
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.129
SUFF_SIMPLE for r=0.1 class 1.0 = 0.581 +- 0.439 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 all KL = 0.506 +- 0.439 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 all L1 = 0.581 +- 0.361 (in-sample avg dev_std = 0.453)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.458
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01233690476190476
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.127
SUFF_SIMPLE for r=0.2 class 1.0 = 0.578 +- 0.440 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all KL = 0.504 +- 0.440 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all L1 = 0.578 +- 0.362 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.458
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012692857142857143
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.126
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.441 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.4 all KL = 0.509 +- 0.441 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.362 (in-sample avg dev_std = 0.442)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012961507936507938
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.145
SUFF_SIMPLE for r=0.8 class 1.0 = 0.622 +- 0.443 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.443 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all L1 = 0.622 +- 0.383 (in-sample avg dev_std = 0.160)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.778
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03828525121555916
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 1.0 = 0.594 +- 0.377 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.05 all KL = 0.371 +- 0.377 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.05 all L1 = 0.594 +- 0.302 (in-sample avg dev_std = 0.553)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.778
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05304659643435981
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 1.0 = 0.595 +- 0.382 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.1 all KL = 0.376 +- 0.382 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.1 all L1 = 0.595 +- 0.302 (in-sample avg dev_std = 0.545)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.778
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07004051863857375
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.507
SUFF_SIMPLE for r=0.2 class 1.0 = 0.6 +- 0.383 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 all KL = 0.382 +- 0.383 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 all L1 = 0.6 +- 0.301 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.778
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08918030794165316
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.552
SUFF_SIMPLE for r=0.4 class 1.0 = 0.633 +- 0.401 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.4 all KL = 0.439 +- 0.401 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.4 all L1 = 0.633 +- 0.308 (in-sample avg dev_std = 0.491)


ratio=0.8


40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 5 0

Model Accuracy of binarized graphs for r=0.8 =  0.78
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10800364667747163
len(reference) = 2461
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.688
SUFF_SIMPLE for r=0.8 class 1.0 = 0.796 +- 0.382 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.8 all KL = 0.738 +- 0.382 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.8 all L1 = 0.796 +- 0.304 (in-sample avg dev_std = 0.250)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.043090252707581225
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.96
NEC for r=0.05 class 1.0 = 0.047 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.076 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.047 +- 0.171 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.059375451263537916
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
NEC for r=0.1 class 1.0 = 0.076 +- 0.310 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all KL = 0.136 +- 0.310 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all L1 = 0.076 +- 0.207 (in-sample avg dev_std = 0.178)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08040072202166065
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.9
NEC for r=0.2 class 1.0 = 0.123 +- 0.390 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all KL = 0.246 +- 0.390 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all L1 = 0.123 +- 0.242 (in-sample avg dev_std = 0.332)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09111913357400722
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.864
NEC for r=0.4 class 1.0 = 0.177 +- 0.433 (in-sample avg dev_std = 0.449)
NEC for r=0.4 all KL = 0.381 +- 0.433 (in-sample avg dev_std = 0.449)
NEC for r=0.4 all L1 = 0.177 +- 0.257 (in-sample avg dev_std = 0.449)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09758122743682311
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.865
NEC for r=0.8 class 1.0 = 0.185 +- 0.432 (in-sample avg dev_std = 0.510)
NEC for r=0.8 all KL = 0.425 +- 0.432 (in-sample avg dev_std = 0.510)
NEC for r=0.8 all L1 = 0.185 +- 0.240 (in-sample avg dev_std = 0.510)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.458
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011022222222222221
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.381
NEC for r=0.05 class 1.0 = 0.184 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.182 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.184 +- 0.288 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.458
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011990873015873016
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.281
NEC for r=0.1 class 1.0 = 0.274 +- 0.394 (in-sample avg dev_std = 0.166)
NEC for r=0.1 all KL = 0.301 +- 0.394 (in-sample avg dev_std = 0.166)
NEC for r=0.1 all L1 = 0.274 +- 0.342 (in-sample avg dev_std = 0.166)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.458
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01233690476190476
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.271
NEC for r=0.2 class 1.0 = 0.322 +- 0.409 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all KL = 0.411 +- 0.409 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all L1 = 0.322 +- 0.319 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.458
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012692857142857143
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.263
NEC for r=0.4 class 1.0 = 0.334 +- 0.409 (in-sample avg dev_std = 0.508)
NEC for r=0.4 all KL = 0.442 +- 0.409 (in-sample avg dev_std = 0.508)
NEC for r=0.4 all L1 = 0.334 +- 0.310 (in-sample avg dev_std = 0.508)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.458
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012961507936507938
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.257
NEC for r=0.8 class 1.0 = 0.342 +- 0.408 (in-sample avg dev_std = 0.536)
NEC for r=0.8 all KL = 0.459 +- 0.408 (in-sample avg dev_std = 0.536)
NEC for r=0.8 all L1 = 0.342 +- 0.305 (in-sample avg dev_std = 0.536)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.778
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03828525121555916
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.757
NEC for r=0.05 class 1.0 = 0.102 +- 0.271 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all KL = 0.11 +- 0.271 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all L1 = 0.102 +- 0.232 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.778
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05304659643435981
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.73
NEC for r=0.1 class 1.0 = 0.136 +- 0.320 (in-sample avg dev_std = 0.202)
NEC for r=0.1 all KL = 0.163 +- 0.320 (in-sample avg dev_std = 0.202)
NEC for r=0.1 all L1 = 0.136 +- 0.257 (in-sample avg dev_std = 0.202)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.778
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07004051863857375
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.7
NEC for r=0.2 class 1.0 = 0.177 +- 0.362 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all KL = 0.24 +- 0.362 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all L1 = 0.177 +- 0.271 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.778
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08918030794165316
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.647
NEC for r=0.4 class 1.0 = 0.245 +- 0.399 (in-sample avg dev_std = 0.396)
NEC for r=0.4 all KL = 0.38 +- 0.399 (in-sample avg dev_std = 0.396)
NEC for r=0.4 all L1 = 0.245 +- 0.287 (in-sample avg dev_std = 0.396)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.778
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10800364667747163
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.589
NEC for r=0.8 class 1.0 = 0.284 +- 0.401 (in-sample avg dev_std = 0.473)
NEC for r=0.8 all KL = 0.466 +- 0.401 (in-sample avg dev_std = 0.473)
NEC for r=0.8 all L1 = 0.284 +- 0.288 (in-sample avg dev_std = 0.473)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:11:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:11:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 76 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0022
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0031
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0031

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.041
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.093
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.067
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04095667870036102
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.717
SUFF_SIMPLE for r=0.05 class 1.0 = 0.657 +- 0.404 (in-sample avg dev_std = 0.619)
SUFF_SIMPLE for r=0.05 all KL = 0.346 +- 0.404 (in-sample avg dev_std = 0.619)
SUFF_SIMPLE for r=0.05 all L1 = 0.657 +- 0.291 (in-sample avg dev_std = 0.619)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05406498194945849
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.718
SUFF_SIMPLE for r=0.1 class 1.0 = 0.659 +- 0.404 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.1 all KL = 0.354 +- 0.404 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.1 all L1 = 0.659 +- 0.292 (in-sample avg dev_std = 0.614)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0607942238267148
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.732
SUFF_SIMPLE for r=0.2 class 1.0 = 0.673 +- 0.416 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.2 all KL = 0.383 +- 0.416 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.2 all L1 = 0.673 +- 0.296 (in-sample avg dev_std = 0.568)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08196389891696751
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.741
SUFF_SIMPLE for r=0.4 class 1.0 = 0.68 +- 0.413 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.4 all KL = 0.38 +- 0.413 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.4 all L1 = 0.68 +- 0.292 (in-sample avg dev_std = 0.583)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09340072202166065
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.871
SUFF_SIMPLE for r=0.8 class 1.0 = 0.858 +- 0.388 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 all KL = 0.766 +- 0.388 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.8 all L1 = 0.858 +- 0.275 (in-sample avg dev_std = 0.266)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.788
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011228968253968255
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.248
SUFF_SIMPLE for r=0.05 class 1.0 = 0.411 +- 0.353 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.05 all KL = 0.292 +- 0.353 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.05 all L1 = 0.411 +- 0.284 (in-sample avg dev_std = 0.546)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.788
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011992063492063491
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.25
SUFF_SIMPLE for r=0.1 class 1.0 = 0.413 +- 0.355 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 all KL = 0.296 +- 0.355 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 all L1 = 0.413 +- 0.286 (in-sample avg dev_std = 0.550)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.788
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012778571428571427
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.248
SUFF_SIMPLE for r=0.2 class 1.0 = 0.412 +- 0.356 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.2 all KL = 0.295 +- 0.356 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.2 all L1 = 0.412 +- 0.286 (in-sample avg dev_std = 0.546)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.788
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012926587301587304
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.25
SUFF_SIMPLE for r=0.4 class 1.0 = 0.415 +- 0.360 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.4 all KL = 0.301 +- 0.360 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.4 all L1 = 0.415 +- 0.290 (in-sample avg dev_std = 0.533)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013043253968253968
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.269
SUFF_SIMPLE for r=0.8 class 1.0 = 0.471 +- 0.418 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all KL = 0.414 +- 0.418 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all L1 = 0.471 +- 0.356 (in-sample avg dev_std = 0.203)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.735
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03642058346839546
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.439
SUFF_SIMPLE for r=0.05 class 1.0 = 0.537 +- 0.349 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 all KL = 0.349 +- 0.349 (in-sample avg dev_std = 0.598)
SUFF_SIMPLE for r=0.05 all L1 = 0.537 +- 0.266 (in-sample avg dev_std = 0.598)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.735
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05044813614262561
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.438
SUFF_SIMPLE for r=0.1 class 1.0 = 0.542 +- 0.354 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.1 all KL = 0.355 +- 0.354 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.1 all L1 = 0.542 +- 0.269 (in-sample avg dev_std = 0.584)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.735
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06671231766612642
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.45
SUFF_SIMPLE for r=0.2 class 1.0 = 0.548 +- 0.366 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.2 all KL = 0.372 +- 0.366 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.2 all L1 = 0.548 +- 0.277 (in-sample avg dev_std = 0.571)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.735
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08539748784440843
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.495
SUFF_SIMPLE for r=0.4 class 1.0 = 0.585 +- 0.387 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.4 all KL = 0.435 +- 0.387 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.4 all L1 = 0.585 +- 0.298 (in-sample avg dev_std = 0.523)


ratio=0.8


40 5 0
40 4 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10663614262560778
len(reference) = 2461
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.639
SUFF_SIMPLE for r=0.8 class 1.0 = 0.746 +- 0.387 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.8 all KL = 0.708 +- 0.387 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.8 all L1 = 0.746 +- 0.320 (in-sample avg dev_std = 0.256)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04095667870036102
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 1.0 = 0.025 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.04 +- 0.176 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.025 +- 0.126 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05406498194945849
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 1.0 = 0.036 +- 0.214 (in-sample avg dev_std = 0.114)
NEC for r=0.1 all KL = 0.07 +- 0.214 (in-sample avg dev_std = 0.114)
NEC for r=0.1 all L1 = 0.036 +- 0.136 (in-sample avg dev_std = 0.114)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0607942238267148
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.956
NEC for r=0.2 class 1.0 = 0.062 +- 0.297 (in-sample avg dev_std = 0.252)
NEC for r=0.2 all KL = 0.134 +- 0.297 (in-sample avg dev_std = 0.252)
NEC for r=0.2 all L1 = 0.062 +- 0.165 (in-sample avg dev_std = 0.252)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08196389891696751
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.913
NEC for r=0.4 class 1.0 = 0.129 +- 0.395 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all KL = 0.288 +- 0.395 (in-sample avg dev_std = 0.403)
NEC for r=0.4 all L1 = 0.129 +- 0.214 (in-sample avg dev_std = 0.403)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09340072202166065
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.883
NEC for r=0.8 class 1.0 = 0.17 +- 0.424 (in-sample avg dev_std = 0.504)
NEC for r=0.8 all KL = 0.395 +- 0.424 (in-sample avg dev_std = 0.504)
NEC for r=0.8 all L1 = 0.17 +- 0.219 (in-sample avg dev_std = 0.504)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.788
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011228968253968255
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.609
NEC for r=0.05 class 1.0 = 0.263 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.257 +- 0.354 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.263 +- 0.317 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.788
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011992063492063491
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.462
NEC for r=0.1 class 1.0 = 0.383 +- 0.407 (in-sample avg dev_std = 0.212)
NEC for r=0.1 all KL = 0.417 +- 0.407 (in-sample avg dev_std = 0.212)
NEC for r=0.1 all L1 = 0.383 +- 0.348 (in-sample avg dev_std = 0.212)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.788
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012778571428571427
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.434
NEC for r=0.2 class 1.0 = 0.445 +- 0.372 (in-sample avg dev_std = 0.513)
NEC for r=0.2 all KL = 0.551 +- 0.372 (in-sample avg dev_std = 0.513)
NEC for r=0.2 all L1 = 0.445 +- 0.298 (in-sample avg dev_std = 0.513)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.788
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012926587301587304
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.427
NEC for r=0.4 class 1.0 = 0.462 +- 0.353 (in-sample avg dev_std = 0.568)
NEC for r=0.4 all KL = 0.591 +- 0.353 (in-sample avg dev_std = 0.568)
NEC for r=0.4 all L1 = 0.462 +- 0.280 (in-sample avg dev_std = 0.568)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.788
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013043253968253968
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.434
NEC for r=0.8 class 1.0 = 0.462 +- 0.341 (in-sample avg dev_std = 0.583)
NEC for r=0.8 all KL = 0.602 +- 0.341 (in-sample avg dev_std = 0.583)
NEC for r=0.8 all L1 = 0.462 +- 0.272 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.735
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03642058346839546
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.707
NEC for r=0.05 class 1.0 = 0.121 +- 0.272 (in-sample avg dev_std = 0.063)
NEC for r=0.05 all KL = 0.118 +- 0.272 (in-sample avg dev_std = 0.063)
NEC for r=0.05 all L1 = 0.121 +- 0.237 (in-sample avg dev_std = 0.063)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.735
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05044813614262561
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.693
NEC for r=0.1 class 1.0 = 0.16 +- 0.318 (in-sample avg dev_std = 0.193)
NEC for r=0.1 all KL = 0.174 +- 0.318 (in-sample avg dev_std = 0.193)
NEC for r=0.1 all L1 = 0.16 +- 0.263 (in-sample avg dev_std = 0.193)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.735
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06671231766612642
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.654
NEC for r=0.2 class 1.0 = 0.218 +- 0.367 (in-sample avg dev_std = 0.336)
NEC for r=0.2 all KL = 0.268 +- 0.367 (in-sample avg dev_std = 0.336)
NEC for r=0.2 all L1 = 0.218 +- 0.283 (in-sample avg dev_std = 0.336)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.735
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08539748784440843
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.609
NEC for r=0.4 class 1.0 = 0.275 +- 0.388 (in-sample avg dev_std = 0.429)
NEC for r=0.4 all KL = 0.38 +- 0.388 (in-sample avg dev_std = 0.429)
NEC for r=0.4 all L1 = 0.275 +- 0.282 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.735
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10663614262560778
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.536
NEC for r=0.8 class 1.0 = 0.34 +- 0.381 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all KL = 0.508 +- 0.381 (in-sample avg dev_std = 0.540)
NEC for r=0.8 all L1 = 0.34 +- 0.267 (in-sample avg dev_std = 0.540)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:17:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:17:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0069
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0175
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0175

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.082
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.090
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.051
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.067
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.106


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05238628158844766
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.749
SUFF_SIMPLE for r=0.05 class 1.0 = 0.696 +- 0.453 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.05 all KL = 0.406 +- 0.453 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.05 all L1 = 0.696 +- 0.304 (in-sample avg dev_std = 0.572)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06747653429602887
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.734
SUFF_SIMPLE for r=0.1 class 1.0 = 0.689 +- 0.448 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.1 all KL = 0.414 +- 0.448 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.1 all L1 = 0.689 +- 0.315 (in-sample avg dev_std = 0.563)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08185920577617327
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.732
SUFF_SIMPLE for r=0.2 class 1.0 = 0.688 +- 0.438 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.2 all KL = 0.389 +- 0.438 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.2 all L1 = 0.688 +- 0.311 (in-sample avg dev_std = 0.556)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09033935018050541
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.757
SUFF_SIMPLE for r=0.4 class 1.0 = 0.704 +- 0.443 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.4 all KL = 0.42 +- 0.443 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.4 all L1 = 0.704 +- 0.312 (in-sample avg dev_std = 0.510)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09774368231046933
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.916
SUFF_SIMPLE for r=0.8 class 1.0 = 0.899 +- 0.360 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.8 all KL = 0.818 +- 0.360 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.8 all L1 = 0.899 +- 0.238 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.874
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010894444444444444
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.228
SUFF_SIMPLE for r=0.05 class 1.0 = 0.364 +- 0.346 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.05 all KL = 0.185 +- 0.346 (in-sample avg dev_std = 0.548)
SUFF_SIMPLE for r=0.05 all L1 = 0.364 +- 0.295 (in-sample avg dev_std = 0.548)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.874
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011903174603174605
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.232
SUFF_SIMPLE for r=0.1 class 1.0 = 0.365 +- 0.349 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.1 all KL = 0.188 +- 0.349 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.1 all L1 = 0.365 +- 0.295 (in-sample avg dev_std = 0.553)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.874
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012680952380952383
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.235
SUFF_SIMPLE for r=0.2 class 1.0 = 0.368 +- 0.349 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.2 all KL = 0.189 +- 0.349 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.2 all L1 = 0.368 +- 0.297 (in-sample avg dev_std = 0.549)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.874
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01272619047619048
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.242
SUFF_SIMPLE for r=0.4 class 1.0 = 0.373 +- 0.354 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.4 all KL = 0.196 +- 0.354 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.4 all L1 = 0.373 +- 0.301 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012990873015873013
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.258
SUFF_SIMPLE for r=0.8 class 1.0 = 0.428 +- 0.428 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all KL = 0.313 +- 0.428 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.8 all L1 = 0.428 +- 0.370 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.741
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037198946515397076
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.455
SUFF_SIMPLE for r=0.05 class 1.0 = 0.556 +- 0.358 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 all KL = 0.401 +- 0.358 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.05 all L1 = 0.556 +- 0.282 (in-sample avg dev_std = 0.568)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.741
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05059319286871961
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.454
SUFF_SIMPLE for r=0.1 class 1.0 = 0.556 +- 0.361 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 all KL = 0.407 +- 0.361 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 all L1 = 0.556 +- 0.286 (in-sample avg dev_std = 0.557)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.741
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06748014586709887
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.455
SUFF_SIMPLE for r=0.2 class 1.0 = 0.561 +- 0.368 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.2 all KL = 0.415 +- 0.368 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.2 all L1 = 0.561 +- 0.292 (in-sample avg dev_std = 0.541)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.741
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08758306320907619
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 1.0 = 0.604 +- 0.388 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all KL = 0.482 +- 0.388 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.4 all L1 = 0.604 +- 0.305 (in-sample avg dev_std = 0.496)


ratio=0.8


40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 5 0

Model Accuracy of binarized graphs for r=0.8 =  0.743
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10623095623987033
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.661
SUFF_SIMPLE for r=0.8 class 1.0 = 0.766 +- 0.363 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.8 all KL = 0.738 +- 0.363 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.8 all L1 = 0.766 +- 0.306 (in-sample avg dev_std = 0.234)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05238628158844766
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.975
NEC for r=0.05 class 1.0 = 0.027 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.046 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.027 +- 0.132 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06747653429602887
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.944
NEC for r=0.1 class 1.0 = 0.063 +- 0.291 (in-sample avg dev_std = 0.172)
NEC for r=0.1 all KL = 0.107 +- 0.291 (in-sample avg dev_std = 0.172)
NEC for r=0.1 all L1 = 0.063 +- 0.195 (in-sample avg dev_std = 0.172)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08185920577617327
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.909
NEC for r=0.2 class 1.0 = 0.104 +- 0.368 (in-sample avg dev_std = 0.277)
NEC for r=0.2 all KL = 0.193 +- 0.368 (in-sample avg dev_std = 0.277)
NEC for r=0.2 all L1 = 0.104 +- 0.235 (in-sample avg dev_std = 0.277)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09033935018050541
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.897
NEC for r=0.4 class 1.0 = 0.135 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.4 all KL = 0.307 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.4 all L1 = 0.135 +- 0.229 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09774368231046933
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.878
NEC for r=0.8 class 1.0 = 0.155 +- 0.433 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all KL = 0.351 +- 0.433 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all L1 = 0.155 +- 0.239 (in-sample avg dev_std = 0.455)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.874
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010894444444444444
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.674
NEC for r=0.05 class 1.0 = 0.216 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.26 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.216 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.874
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011903174603174605
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
NEC for r=0.1 class 1.0 = 0.372 +- 0.454 (in-sample avg dev_std = 0.244)
NEC for r=0.1 all KL = 0.481 +- 0.454 (in-sample avg dev_std = 0.244)
NEC for r=0.1 all L1 = 0.372 +- 0.377 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.874
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012680952380952383
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.48
NEC for r=0.2 class 1.0 = 0.438 +- 0.420 (in-sample avg dev_std = 0.549)
NEC for r=0.2 all KL = 0.653 +- 0.420 (in-sample avg dev_std = 0.549)
NEC for r=0.2 all L1 = 0.438 +- 0.330 (in-sample avg dev_std = 0.549)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.874
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01272619047619048
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.476
NEC for r=0.4 class 1.0 = 0.454 +- 0.389 (in-sample avg dev_std = 0.610)
NEC for r=0.4 all KL = 0.709 +- 0.389 (in-sample avg dev_std = 0.610)
NEC for r=0.4 all L1 = 0.454 +- 0.308 (in-sample avg dev_std = 0.610)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.874
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012990873015873013
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.48
NEC for r=0.8 class 1.0 = 0.456 +- 0.376 (in-sample avg dev_std = 0.624)
NEC for r=0.8 all KL = 0.728 +- 0.376 (in-sample avg dev_std = 0.624)
NEC for r=0.8 all L1 = 0.456 +- 0.301 (in-sample avg dev_std = 0.624)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.741
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037198946515397076
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.715
NEC for r=0.05 class 1.0 = 0.12 +- 0.258 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all KL = 0.111 +- 0.258 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all L1 = 0.12 +- 0.231 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.741
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05059319286871961
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.693
NEC for r=0.1 class 1.0 = 0.161 +- 0.304 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all KL = 0.167 +- 0.304 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all L1 = 0.161 +- 0.260 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.741
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06748014586709887
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.659
NEC for r=0.2 class 1.0 = 0.212 +- 0.349 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all KL = 0.247 +- 0.349 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all L1 = 0.212 +- 0.282 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.741
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08758306320907619
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.603
NEC for r=0.4 class 1.0 = 0.267 +- 0.377 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all KL = 0.346 +- 0.377 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all L1 = 0.267 +- 0.288 (in-sample avg dev_std = 0.394)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.741
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10623095623987033
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.549
NEC for r=0.8 class 1.0 = 0.327 +- 0.383 (in-sample avg dev_std = 0.503)
NEC for r=0.8 all KL = 0.462 +- 0.383 (in-sample avg dev_std = 0.503)
NEC for r=0.8 all L1 = 0.327 +- 0.280 (in-sample avg dev_std = 0.503)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:23:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:23:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0005
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0005

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.043
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.096
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.039
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.090
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.043444043321299634
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.58
SUFF_SIMPLE for r=0.05 class 1.0 = 0.52 +- 0.274 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.05 all KL = 0.15 +- 0.274 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.279 (in-sample avg dev_std = 0.677)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05826714801444043
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.579
SUFF_SIMPLE for r=0.1 class 1.0 = 0.524 +- 0.308 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.1 all KL = 0.173 +- 0.308 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.1 all L1 = 0.524 +- 0.285 (in-sample avg dev_std = 0.674)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193862815884476
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.558
SUFF_SIMPLE for r=0.2 class 1.0 = 0.507 +- 0.314 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.2 all KL = 0.172 +- 0.314 (in-sample avg dev_std = 0.660)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.291 (in-sample avg dev_std = 0.660)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08111552346570397
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.579
SUFF_SIMPLE for r=0.4 class 1.0 = 0.522 +- 0.294 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.4 all KL = 0.169 +- 0.294 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.288 (in-sample avg dev_std = 0.636)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09571119133574008
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.758
SUFF_SIMPLE for r=0.8 class 1.0 = 0.731 +- 0.457 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.8 all KL = 0.572 +- 0.457 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.8 all L1 = 0.731 +- 0.337 (in-sample avg dev_std = 0.372)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.775
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.01109047619047619
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.011
SUFF_SIMPLE for r=0.05 class 1.0 = 0.305 +- 0.367 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all KL = 0.232 +- 0.367 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all L1 = 0.305 +- 0.296 (in-sample avg dev_std = 0.179)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.775
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012137301587301589
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.012
SUFF_SIMPLE for r=0.1 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.1 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.187)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.775
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012564285714285714
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.013
SUFF_SIMPLE for r=0.2 class 1.0 = 0.306 +- 0.365 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all KL = 0.231 +- 0.365 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all L1 = 0.306 +- 0.295 (in-sample avg dev_std = 0.187)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.775
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012869444444444446
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.013
SUFF_SIMPLE for r=0.4 class 1.0 = 0.306 +- 0.366 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.232 +- 0.366 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.306 +- 0.296 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013025793650793652
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.019
SUFF_SIMPLE for r=0.8 class 1.0 = 0.314 +- 0.372 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.8 all KL = 0.241 +- 0.372 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.8 all L1 = 0.314 +- 0.304 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.845
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03930226904376013
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.405
SUFF_SIMPLE for r=0.05 class 1.0 = 0.478 +- 0.335 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.05 all KL = 0.28 +- 0.335 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.05 all L1 = 0.478 +- 0.266 (in-sample avg dev_std = 0.653)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.845
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05404173419773096
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.409
SUFF_SIMPLE for r=0.1 class 1.0 = 0.482 +- 0.341 (in-sample avg dev_std = 0.644)
SUFF_SIMPLE for r=0.1 all KL = 0.287 +- 0.341 (in-sample avg dev_std = 0.644)
SUFF_SIMPLE for r=0.1 all L1 = 0.482 +- 0.270 (in-sample avg dev_std = 0.644)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.845
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07093679092382496
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.408
SUFF_SIMPLE for r=0.2 class 1.0 = 0.485 +- 0.351 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.2 all KL = 0.298 +- 0.351 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.2 all L1 = 0.485 +- 0.279 (in-sample avg dev_std = 0.635)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.845
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09004335494327391
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.414
SUFF_SIMPLE for r=0.4 class 1.0 = 0.5 +- 0.370 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.4 all KL = 0.327 +- 0.370 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.4 all L1 = 0.5 +- 0.294 (in-sample avg dev_std = 0.597)


ratio=0.8


40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.847
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10868354943273906
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.629
SUFF_SIMPLE for r=0.8 class 1.0 = 0.717 +- 0.413 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 all KL = 0.65 +- 0.413 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 all L1 = 0.717 +- 0.329 (in-sample avg dev_std = 0.300)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.043444043321299634
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.975
NEC for r=0.05 class 1.0 = 0.031 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.188 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.031 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05826714801444043
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.943
NEC for r=0.1 class 1.0 = 0.074 +- 0.303 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all KL = 0.141 +- 0.303 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all L1 = 0.074 +- 0.194 (in-sample avg dev_std = 0.180)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193862815884476
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.896
NEC for r=0.2 class 1.0 = 0.134 +- 0.389 (in-sample avg dev_std = 0.321)
NEC for r=0.2 all KL = 0.263 +- 0.389 (in-sample avg dev_std = 0.321)
NEC for r=0.2 all L1 = 0.134 +- 0.245 (in-sample avg dev_std = 0.321)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08111552346570397
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.859
NEC for r=0.4 class 1.0 = 0.183 +- 0.414 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all KL = 0.378 +- 0.414 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all L1 = 0.183 +- 0.263 (in-sample avg dev_std = 0.414)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09571119133574008
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.834
NEC for r=0.8 class 1.0 = 0.222 +- 0.414 (in-sample avg dev_std = 0.515)
NEC for r=0.8 all KL = 0.491 +- 0.414 (in-sample avg dev_std = 0.515)
NEC for r=0.8 all L1 = 0.222 +- 0.258 (in-sample avg dev_std = 0.515)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.775
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.01109047619047619
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.383
NEC for r=0.05 class 1.0 = 0.407 +- 0.422 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.457 +- 0.422 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.407 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.775
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012137301587301589
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.153
NEC for r=0.1 class 1.0 = 0.592 +- 0.402 (in-sample avg dev_std = 0.158)
NEC for r=0.1 all KL = 0.674 +- 0.402 (in-sample avg dev_std = 0.158)
NEC for r=0.1 all L1 = 0.592 +- 0.337 (in-sample avg dev_std = 0.158)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.775
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012564285714285714
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.117
NEC for r=0.2 class 1.0 = 0.645 +- 0.365 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all KL = 0.753 +- 0.365 (in-sample avg dev_std = 0.441)
NEC for r=0.2 all L1 = 0.645 +- 0.288 (in-sample avg dev_std = 0.441)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.775
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012869444444444446
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.116
NEC for r=0.4 class 1.0 = 0.649 +- 0.364 (in-sample avg dev_std = 0.480)
NEC for r=0.4 all KL = 0.759 +- 0.364 (in-sample avg dev_std = 0.480)
NEC for r=0.4 all L1 = 0.649 +- 0.283 (in-sample avg dev_std = 0.480)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.775
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013025793650793652
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.113
NEC for r=0.8 class 1.0 = 0.652 +- 0.365 (in-sample avg dev_std = 0.490)
NEC for r=0.8 all KL = 0.76 +- 0.365 (in-sample avg dev_std = 0.490)
NEC for r=0.8 all L1 = 0.652 +- 0.282 (in-sample avg dev_std = 0.490)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.845
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03930226904376013
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.765
NEC for r=0.05 class 1.0 = 0.126 +- 0.303 (in-sample avg dev_std = 0.096)
NEC for r=0.05 all KL = 0.139 +- 0.303 (in-sample avg dev_std = 0.096)
NEC for r=0.05 all L1 = 0.126 +- 0.249 (in-sample avg dev_std = 0.096)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.845
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05404173419773096
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.724
NEC for r=0.1 class 1.0 = 0.18 +- 0.359 (in-sample avg dev_std = 0.246)
NEC for r=0.1 all KL = 0.218 +- 0.359 (in-sample avg dev_std = 0.246)
NEC for r=0.1 all L1 = 0.18 +- 0.281 (in-sample avg dev_std = 0.246)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.845
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07093679092382496
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.659
NEC for r=0.2 class 1.0 = 0.253 +- 0.398 (in-sample avg dev_std = 0.381)
NEC for r=0.2 all KL = 0.337 +- 0.398 (in-sample avg dev_std = 0.381)
NEC for r=0.2 all L1 = 0.253 +- 0.300 (in-sample avg dev_std = 0.381)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.845
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09004335494327391
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.571
NEC for r=0.4 class 1.0 = 0.348 +- 0.408 (in-sample avg dev_std = 0.514)
NEC for r=0.4 all KL = 0.499 +- 0.408 (in-sample avg dev_std = 0.514)
NEC for r=0.4 all L1 = 0.348 +- 0.301 (in-sample avg dev_std = 0.514)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.845
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10868354943273906
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.551
NEC for r=0.8 class 1.0 = 0.379 +- 0.376 (in-sample avg dev_std = 0.587)
NEC for r=0.8 all KL = 0.574 +- 0.376 (in-sample avg dev_std = 0.587)
NEC for r=0.8 all L1 = 0.379 +- 0.280 (in-sample avg dev_std = 0.587)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:29:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:29:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0006
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0006
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0007
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0006
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0007

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.043
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.055
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.068
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.089
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.043259927797833934
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.815
SUFF_SIMPLE for r=0.05 class 1.0 = 0.748 +- 0.446 (in-sample avg dev_std = 0.589)
SUFF_SIMPLE for r=0.05 all KL = 0.508 +- 0.446 (in-sample avg dev_std = 0.589)
SUFF_SIMPLE for r=0.05 all L1 = 0.748 +- 0.278 (in-sample avg dev_std = 0.589)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0546028880866426
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.822
SUFF_SIMPLE for r=0.1 class 1.0 = 0.759 +- 0.441 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.1 all KL = 0.514 +- 0.441 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.1 all L1 = 0.759 +- 0.269 (in-sample avg dev_std = 0.560)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06774729241877256
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.808
SUFF_SIMPLE for r=0.2 class 1.0 = 0.755 +- 0.450 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.2 all KL = 0.535 +- 0.450 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.2 all L1 = 0.755 +- 0.288 (in-sample avg dev_std = 0.546)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08208664259927798
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.808
SUFF_SIMPLE for r=0.4 class 1.0 = 0.769 +- 0.451 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all KL = 0.563 +- 0.451 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.4 all L1 = 0.769 +- 0.292 (in-sample avg dev_std = 0.505)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09465703971119134
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.905
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.365 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all KL = 0.81 +- 0.365 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.242 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.497
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011067460317460318
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.31
SUFF_SIMPLE for r=0.05 class 1.0 = 0.576 +- 0.406 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.05 all KL = 0.477 +- 0.406 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.05 all L1 = 0.576 +- 0.318 (in-sample avg dev_std = 0.570)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.497
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011974206349206349
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.313
SUFF_SIMPLE for r=0.1 class 1.0 = 0.576 +- 0.407 (in-sample avg dev_std = 0.565)
SUFF_SIMPLE for r=0.1 all KL = 0.479 +- 0.407 (in-sample avg dev_std = 0.565)
SUFF_SIMPLE for r=0.1 all L1 = 0.576 +- 0.320 (in-sample avg dev_std = 0.565)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.497
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01221468253968254
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.308
SUFF_SIMPLE for r=0.2 class 1.0 = 0.575 +- 0.406 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.2 all KL = 0.477 +- 0.406 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.320 (in-sample avg dev_std = 0.564)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.497
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012639682539682541
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.312
SUFF_SIMPLE for r=0.4 class 1.0 = 0.579 +- 0.409 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.4 all KL = 0.485 +- 0.409 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.4 all L1 = 0.579 +- 0.324 (in-sample avg dev_std = 0.553)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012959126984126986
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.337
SUFF_SIMPLE for r=0.8 class 1.0 = 0.647 +- 0.421 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 all KL = 0.622 +- 0.421 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 all L1 = 0.647 +- 0.365 (in-sample avg dev_std = 0.208)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.745
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03640316045380875
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.623
SUFF_SIMPLE for r=0.05 class 1.0 = 0.599 +- 0.343 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.05 all KL = 0.385 +- 0.343 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.05 all L1 = 0.599 +- 0.255 (in-sample avg dev_std = 0.605)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.745
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05039384116693679
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.603
SUFF_SIMPLE for r=0.1 class 1.0 = 0.599 +- 0.358 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.1 all KL = 0.407 +- 0.358 (in-sample avg dev_std = 0.570)
SUFF_SIMPLE for r=0.1 all L1 = 0.599 +- 0.271 (in-sample avg dev_std = 0.570)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.745
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0690453808752026
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.577
SUFF_SIMPLE for r=0.2 class 1.0 = 0.602 +- 0.375 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.375 (in-sample avg dev_std = 0.534)
SUFF_SIMPLE for r=0.2 all L1 = 0.602 +- 0.288 (in-sample avg dev_std = 0.534)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.745
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0887714748784441
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.581
SUFF_SIMPLE for r=0.4 class 1.0 = 0.633 +- 0.396 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.4 all KL = 0.497 +- 0.396 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.4 all L1 = 0.633 +- 0.304 (in-sample avg dev_std = 0.485)


ratio=0.8


40 5 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.746
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1076503241491086
len(reference) = 2463
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.701
SUFF_SIMPLE for r=0.8 class 1.0 = 0.779 +- 0.370 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all KL = 0.742 +- 0.370 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all L1 = 0.779 +- 0.299 (in-sample avg dev_std = 0.278)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.043259927797833934
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.968
NEC for r=0.05 class 1.0 = 0.033 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.033 +- 0.151 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0546028880866426
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.957
NEC for r=0.1 class 1.0 = 0.052 +- 0.255 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all KL = 0.083 +- 0.255 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all L1 = 0.052 +- 0.180 (in-sample avg dev_std = 0.133)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06774729241877256
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.926
NEC for r=0.2 class 1.0 = 0.092 +- 0.340 (in-sample avg dev_std = 0.283)
NEC for r=0.2 all KL = 0.167 +- 0.340 (in-sample avg dev_std = 0.283)
NEC for r=0.2 all L1 = 0.092 +- 0.216 (in-sample avg dev_std = 0.283)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08208664259927798
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.909
NEC for r=0.4 class 1.0 = 0.114 +- 0.378 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all KL = 0.247 +- 0.378 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all L1 = 0.114 +- 0.216 (in-sample avg dev_std = 0.356)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09465703971119134
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.911
NEC for r=0.8 class 1.0 = 0.131 +- 0.391 (in-sample avg dev_std = 0.435)
NEC for r=0.8 all KL = 0.305 +- 0.391 (in-sample avg dev_std = 0.435)
NEC for r=0.8 all L1 = 0.131 +- 0.208 (in-sample avg dev_std = 0.435)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.497
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011067460317460318
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.483
NEC for r=0.05 class 1.0 = 0.199 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.182 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.199 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.497
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011974206349206349
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.437
NEC for r=0.1 class 1.0 = 0.271 +- 0.375 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all KL = 0.282 +- 0.375 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all L1 = 0.271 +- 0.325 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.497
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01221468253968254
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.437
NEC for r=0.2 class 1.0 = 0.312 +- 0.381 (in-sample avg dev_std = 0.448)
NEC for r=0.2 all KL = 0.372 +- 0.381 (in-sample avg dev_std = 0.448)
NEC for r=0.2 all L1 = 0.312 +- 0.304 (in-sample avg dev_std = 0.448)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.497
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012639682539682541
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.428
NEC for r=0.4 class 1.0 = 0.327 +- 0.377 (in-sample avg dev_std = 0.506)
NEC for r=0.4 all KL = 0.411 +- 0.377 (in-sample avg dev_std = 0.506)
NEC for r=0.4 all L1 = 0.327 +- 0.293 (in-sample avg dev_std = 0.506)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.497
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012959126984126986
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.432
NEC for r=0.8 class 1.0 = 0.325 +- 0.370 (in-sample avg dev_std = 0.522)
NEC for r=0.8 all KL = 0.417 +- 0.370 (in-sample avg dev_std = 0.522)
NEC for r=0.8 all L1 = 0.325 +- 0.284 (in-sample avg dev_std = 0.522)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.745
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03640316045380875
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.739
NEC for r=0.05 class 1.0 = 0.119 +- 0.270 (in-sample avg dev_std = 0.081)
NEC for r=0.05 all KL = 0.116 +- 0.270 (in-sample avg dev_std = 0.081)
NEC for r=0.05 all L1 = 0.119 +- 0.234 (in-sample avg dev_std = 0.081)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.745
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05039384116693679
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.722
NEC for r=0.1 class 1.0 = 0.16 +- 0.323 (in-sample avg dev_std = 0.221)
NEC for r=0.1 all KL = 0.179 +- 0.323 (in-sample avg dev_std = 0.221)
NEC for r=0.1 all L1 = 0.16 +- 0.261 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.745
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0690453808752026
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.691
NEC for r=0.2 class 1.0 = 0.2 +- 0.357 (in-sample avg dev_std = 0.323)
NEC for r=0.2 all KL = 0.246 +- 0.357 (in-sample avg dev_std = 0.323)
NEC for r=0.2 all L1 = 0.2 +- 0.275 (in-sample avg dev_std = 0.323)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.745
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0887714748784441
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.645
NEC for r=0.4 class 1.0 = 0.259 +- 0.387 (in-sample avg dev_std = 0.405)
NEC for r=0.4 all KL = 0.355 +- 0.387 (in-sample avg dev_std = 0.405)
NEC for r=0.4 all L1 = 0.259 +- 0.287 (in-sample avg dev_std = 0.405)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.745
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1076503241491086
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.636
NEC for r=0.8 class 1.0 = 0.305 +- 0.378 (in-sample avg dev_std = 0.517)
NEC for r=0.8 all KL = 0.466 +- 0.378 (in-sample avg dev_std = 0.517)
NEC for r=0.8 all L1 = 0.305 +- 0.267 (in-sample avg dev_std = 0.517)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:35:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:35:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0018
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0003
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0010
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0003
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0010

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.051
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.068
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.087
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042223826714801446
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.577
SUFF_SIMPLE for r=0.05 class 1.0 = 0.503 +- 0.261 (in-sample avg dev_std = 0.715)
SUFF_SIMPLE for r=0.05 all KL = 0.142 +- 0.261 (in-sample avg dev_std = 0.715)
SUFF_SIMPLE for r=0.05 all L1 = 0.503 +- 0.259 (in-sample avg dev_std = 0.715)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05196389891696751
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.579
SUFF_SIMPLE for r=0.1 class 1.0 = 0.501 +- 0.239 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.1 all KL = 0.132 +- 0.239 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.1 all L1 = 0.501 +- 0.252 (in-sample avg dev_std = 0.719)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0686173285198556
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.58
SUFF_SIMPLE for r=0.2 class 1.0 = 0.508 +- 0.259 (in-sample avg dev_std = 0.699)
SUFF_SIMPLE for r=0.2 all KL = 0.15 +- 0.259 (in-sample avg dev_std = 0.699)
SUFF_SIMPLE for r=0.2 all L1 = 0.508 +- 0.263 (in-sample avg dev_std = 0.699)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08082310469314079
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.581
SUFF_SIMPLE for r=0.4 class 1.0 = 0.517 +- 0.317 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.4 all KL = 0.188 +- 0.317 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.4 all L1 = 0.517 +- 0.282 (in-sample avg dev_std = 0.668)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09448375451263538
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.795
SUFF_SIMPLE for r=0.8 class 1.0 = 0.756 +- 0.442 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.8 all KL = 0.608 +- 0.442 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.8 all L1 = 0.756 +- 0.321 (in-sample avg dev_std = 0.329)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.362
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011165079365079364
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.017
SUFF_SIMPLE for r=0.05 class 1.0 = 0.646 +- 0.428 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.05 all KL = 0.625 +- 0.428 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.05 all L1 = 0.646 +- 0.378 (in-sample avg dev_std = 0.197)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.362
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011731746031746032
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.018
SUFF_SIMPLE for r=0.1 class 1.0 = 0.646 +- 0.428 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.624 +- 0.428 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.646 +- 0.378 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.362
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01225
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.016
SUFF_SIMPLE for r=0.2 class 1.0 = 0.646 +- 0.428 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all KL = 0.626 +- 0.428 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all L1 = 0.646 +- 0.378 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.362
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01252698412698413
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.017
SUFF_SIMPLE for r=0.4 class 1.0 = 0.646 +- 0.427 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all KL = 0.624 +- 0.427 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all L1 = 0.646 +- 0.377 (in-sample avg dev_std = 0.194)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012926587301587304
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.026
SUFF_SIMPLE for r=0.8 class 1.0 = 0.659 +- 0.427 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 all KL = 0.645 +- 0.427 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 all L1 = 0.659 +- 0.379 (in-sample avg dev_std = 0.070)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.562
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03624230145867099
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.223
SUFF_SIMPLE for r=0.05 class 1.0 = 0.508 +- 0.378 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.05 all KL = 0.385 +- 0.378 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.05 all L1 = 0.508 +- 0.308 (in-sample avg dev_std = 0.551)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.562
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051428687196110205
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.22
SUFF_SIMPLE for r=0.1 class 1.0 = 0.51 +- 0.381 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.1 all KL = 0.389 +- 0.381 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.1 all L1 = 0.51 +- 0.311 (in-sample avg dev_std = 0.538)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.562
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06763654781199352
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.218
SUFF_SIMPLE for r=0.2 class 1.0 = 0.511 +- 0.384 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.2 all KL = 0.395 +- 0.384 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.2 all L1 = 0.511 +- 0.317 (in-sample avg dev_std = 0.521)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.562
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08660575364667747
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.24
SUFF_SIMPLE for r=0.4 class 1.0 = 0.533 +- 0.395 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.4 all KL = 0.427 +- 0.395 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.4 all L1 = 0.533 +- 0.327 (in-sample avg dev_std = 0.472)


ratio=0.8


40 5 0
40 5 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10682698541329011
len(reference) = 2461
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.417
SUFF_SIMPLE for r=0.8 class 1.0 = 0.715 +- 0.388 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all KL = 0.676 +- 0.388 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.8 all L1 = 0.715 +- 0.332 (in-sample avg dev_std = 0.203)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042223826714801446
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.96
NEC for r=0.05 class 1.0 = 0.054 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.09 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05196389891696751
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.937
NEC for r=0.1 class 1.0 = 0.087 +- 0.321 (in-sample avg dev_std = 0.188)
NEC for r=0.1 all KL = 0.15 +- 0.321 (in-sample avg dev_std = 0.188)
NEC for r=0.1 all L1 = 0.087 +- 0.214 (in-sample avg dev_std = 0.188)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0686173285198556
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.867
NEC for r=0.2 class 1.0 = 0.167 +- 0.405 (in-sample avg dev_std = 0.363)
NEC for r=0.2 all KL = 0.318 +- 0.405 (in-sample avg dev_std = 0.363)
NEC for r=0.2 all L1 = 0.167 +- 0.262 (in-sample avg dev_std = 0.363)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08082310469314079
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.821
NEC for r=0.4 class 1.0 = 0.238 +- 0.404 (in-sample avg dev_std = 0.505)
NEC for r=0.4 all KL = 0.506 +- 0.404 (in-sample avg dev_std = 0.505)
NEC for r=0.4 all L1 = 0.238 +- 0.262 (in-sample avg dev_std = 0.505)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09448375451263538
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.829
NEC for r=0.8 class 1.0 = 0.246 +- 0.393 (in-sample avg dev_std = 0.571)
NEC for r=0.8 all KL = 0.554 +- 0.393 (in-sample avg dev_std = 0.571)
NEC for r=0.8 all L1 = 0.246 +- 0.238 (in-sample avg dev_std = 0.571)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.362
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011165079365079364
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.227
NEC for r=0.05 class 1.0 = 0.205 +- 0.317 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.189 +- 0.317 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.205 +- 0.294 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.362
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011731746031746032
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.117
NEC for r=0.1 class 1.0 = 0.293 +- 0.393 (in-sample avg dev_std = 0.111)
NEC for r=0.1 all KL = 0.302 +- 0.393 (in-sample avg dev_std = 0.111)
NEC for r=0.1 all L1 = 0.293 +- 0.349 (in-sample avg dev_std = 0.111)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.362
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01225
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.102
NEC for r=0.2 class 1.0 = 0.322 +- 0.402 (in-sample avg dev_std = 0.348)
NEC for r=0.2 all KL = 0.356 +- 0.402 (in-sample avg dev_std = 0.348)
NEC for r=0.2 all L1 = 0.322 +- 0.341 (in-sample avg dev_std = 0.348)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.362
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01252698412698413
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.1
NEC for r=0.4 class 1.0 = 0.329 +- 0.405 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all KL = 0.368 +- 0.405 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all L1 = 0.329 +- 0.340 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.362
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012926587301587304
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.1
NEC for r=0.8 class 1.0 = 0.328 +- 0.406 (in-sample avg dev_std = 0.406)
NEC for r=0.8 all KL = 0.369 +- 0.406 (in-sample avg dev_std = 0.406)
NEC for r=0.8 all L1 = 0.328 +- 0.338 (in-sample avg dev_std = 0.406)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.562
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03624230145867099
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.521
NEC for r=0.05 class 1.0 = 0.151 +- 0.290 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all KL = 0.144 +- 0.290 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all L1 = 0.151 +- 0.260 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.562
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051428687196110205
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.475
NEC for r=0.1 class 1.0 = 0.209 +- 0.343 (in-sample avg dev_std = 0.159)
NEC for r=0.1 all KL = 0.22 +- 0.343 (in-sample avg dev_std = 0.159)
NEC for r=0.1 all L1 = 0.209 +- 0.295 (in-sample avg dev_std = 0.159)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.562
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06763654781199352
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.413
NEC for r=0.2 class 1.0 = 0.271 +- 0.378 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all KL = 0.309 +- 0.378 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all L1 = 0.271 +- 0.312 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.562
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08660575364667747
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.352
NEC for r=0.4 class 1.0 = 0.348 +- 0.394 (in-sample avg dev_std = 0.451)
NEC for r=0.4 all KL = 0.434 +- 0.394 (in-sample avg dev_std = 0.451)
NEC for r=0.4 all L1 = 0.348 +- 0.310 (in-sample avg dev_std = 0.451)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.562
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10682698541329011
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.312
NEC for r=0.8 class 1.0 = 0.395 +- 0.393 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all KL = 0.508 +- 0.393 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all L1 = 0.395 +- 0.299 (in-sample avg dev_std = 0.547)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:41:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:41:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0031
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0007
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0041
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0007
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0041

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.045
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.053
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.089
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044779783393501804
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.769
SUFF_SIMPLE for r=0.05 class 1.0 = 0.712 +- 0.445 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.05 all KL = 0.435 +- 0.445 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.05 all L1 = 0.712 +- 0.292 (in-sample avg dev_std = 0.611)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05328158844765343
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.754
SUFF_SIMPLE for r=0.1 class 1.0 = 0.703 +- 0.450 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.1 all KL = 0.43 +- 0.450 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.1 all L1 = 0.703 +- 0.300 (in-sample avg dev_std = 0.599)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07056678700361012
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.773
SUFF_SIMPLE for r=0.2 class 1.0 = 0.724 +- 0.443 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.2 all KL = 0.457 +- 0.443 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.2 all L1 = 0.724 +- 0.297 (in-sample avg dev_std = 0.555)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08809747292418772
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.788
SUFF_SIMPLE for r=0.4 class 1.0 = 0.746 +- 0.452 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.4 all KL = 0.513 +- 0.452 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.4 all L1 = 0.746 +- 0.303 (in-sample avg dev_std = 0.515)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09771841155234658
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.91
SUFF_SIMPLE for r=0.8 class 1.0 = 0.909 +- 0.331 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 all KL = 0.866 +- 0.331 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 all L1 = 0.909 +- 0.243 (in-sample avg dev_std = 0.205)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.637
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011253571428571427
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.419
SUFF_SIMPLE for r=0.05 class 1.0 = 0.574 +- 0.379 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.05 all KL = 0.422 +- 0.379 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.05 all L1 = 0.574 +- 0.285 (in-sample avg dev_std = 0.609)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.637
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012086111111111112
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.419
SUFF_SIMPLE for r=0.1 class 1.0 = 0.572 +- 0.381 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.1 all KL = 0.42 +- 0.381 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.1 all L1 = 0.572 +- 0.287 (in-sample avg dev_std = 0.608)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.637
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012442857142857143
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.411
SUFF_SIMPLE for r=0.2 class 1.0 = 0.571 +- 0.382 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.2 all KL = 0.422 +- 0.382 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.2 all L1 = 0.571 +- 0.289 (in-sample avg dev_std = 0.602)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.637
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012867857142857143
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.416
SUFF_SIMPLE for r=0.4 class 1.0 = 0.575 +- 0.387 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.4 all KL = 0.433 +- 0.387 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.4 all L1 = 0.575 +- 0.293 (in-sample avg dev_std = 0.588)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012890476190476188
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.45
SUFF_SIMPLE for r=0.8 class 1.0 = 0.654 +- 0.413 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.8 all KL = 0.612 +- 0.413 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.8 all L1 = 0.654 +- 0.350 (in-sample avg dev_std = 0.248)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.796
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037990275526742306
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.586
SUFF_SIMPLE for r=0.05 class 1.0 = 0.6 +- 0.357 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 all KL = 0.378 +- 0.357 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 all L1 = 0.6 +- 0.275 (in-sample avg dev_std = 0.574)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.796
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05209359805510535
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.588
SUFF_SIMPLE for r=0.1 class 1.0 = 0.613 +- 0.363 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.1 all KL = 0.39 +- 0.363 (in-sample avg dev_std = 0.554)
SUFF_SIMPLE for r=0.1 all L1 = 0.613 +- 0.278 (in-sample avg dev_std = 0.554)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.796
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06892868719611021
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.596
SUFF_SIMPLE for r=0.2 class 1.0 = 0.628 +- 0.379 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.2 all KL = 0.422 +- 0.379 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.2 all L1 = 0.628 +- 0.291 (in-sample avg dev_std = 0.520)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.796
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08911223662884928
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.628
SUFF_SIMPLE for r=0.4 class 1.0 = 0.668 +- 0.401 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.4 all KL = 0.505 +- 0.401 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.4 all L1 = 0.668 +- 0.305 (in-sample avg dev_std = 0.473)


ratio=0.8


40 5 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10905064829821717
len(reference) = 2466
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.731
SUFF_SIMPLE for r=0.8 class 1.0 = 0.799 +- 0.373 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.8 all KL = 0.755 +- 0.373 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.8 all L1 = 0.799 +- 0.299 (in-sample avg dev_std = 0.290)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044779783393501804
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.968
NEC for r=0.05 class 1.0 = 0.031 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.041 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.031 +- 0.155 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05328158844765343
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 1.0 = 0.064 +- 0.287 (in-sample avg dev_std = 0.150)
NEC for r=0.1 all KL = 0.102 +- 0.287 (in-sample avg dev_std = 0.150)
NEC for r=0.1 all L1 = 0.064 +- 0.202 (in-sample avg dev_std = 0.150)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07056678700361012
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.92
NEC for r=0.2 class 1.0 = 0.096 +- 0.354 (in-sample avg dev_std = 0.265)
NEC for r=0.2 all KL = 0.177 +- 0.354 (in-sample avg dev_std = 0.265)
NEC for r=0.2 all L1 = 0.096 +- 0.225 (in-sample avg dev_std = 0.265)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08809747292418772
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.913
NEC for r=0.4 class 1.0 = 0.126 +- 0.403 (in-sample avg dev_std = 0.402)
NEC for r=0.4 all KL = 0.295 +- 0.403 (in-sample avg dev_std = 0.402)
NEC for r=0.4 all L1 = 0.126 +- 0.214 (in-sample avg dev_std = 0.402)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09771841155234658
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.896
NEC for r=0.8 class 1.0 = 0.153 +- 0.432 (in-sample avg dev_std = 0.491)
NEC for r=0.8 all KL = 0.367 +- 0.432 (in-sample avg dev_std = 0.491)
NEC for r=0.8 all L1 = 0.153 +- 0.219 (in-sample avg dev_std = 0.491)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.637
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011253571428571427
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.606
NEC for r=0.05 class 1.0 = 0.181 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.165 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.181 +- 0.273 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.637
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012086111111111112
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.571
NEC for r=0.1 class 1.0 = 0.243 +- 0.358 (in-sample avg dev_std = 0.196)
NEC for r=0.1 all KL = 0.255 +- 0.358 (in-sample avg dev_std = 0.196)
NEC for r=0.1 all L1 = 0.243 +- 0.308 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.637
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012442857142857143
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.556
NEC for r=0.2 class 1.0 = 0.285 +- 0.361 (in-sample avg dev_std = 0.466)
NEC for r=0.2 all KL = 0.363 +- 0.361 (in-sample avg dev_std = 0.466)
NEC for r=0.2 all L1 = 0.285 +- 0.275 (in-sample avg dev_std = 0.466)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.637
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012867857142857143
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.551
NEC for r=0.4 class 1.0 = 0.305 +- 0.351 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all KL = 0.418 +- 0.351 (in-sample avg dev_std = 0.526)
NEC for r=0.4 all L1 = 0.305 +- 0.259 (in-sample avg dev_std = 0.526)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.637
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012890476190476188
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.552
NEC for r=0.8 class 1.0 = 0.306 +- 0.340 (in-sample avg dev_std = 0.541)
NEC for r=0.8 all KL = 0.438 +- 0.340 (in-sample avg dev_std = 0.541)
NEC for r=0.8 all L1 = 0.306 +- 0.246 (in-sample avg dev_std = 0.541)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.796
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037990275526742306
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.785
NEC for r=0.05 class 1.0 = 0.11 +- 0.272 (in-sample avg dev_std = 0.087)
NEC for r=0.05 all KL = 0.111 +- 0.272 (in-sample avg dev_std = 0.087)
NEC for r=0.05 all L1 = 0.11 +- 0.240 (in-sample avg dev_std = 0.087)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.796
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05209359805510535
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.757
NEC for r=0.1 class 1.0 = 0.147 +- 0.322 (in-sample avg dev_std = 0.216)
NEC for r=0.1 all KL = 0.167 +- 0.322 (in-sample avg dev_std = 0.216)
NEC for r=0.1 all L1 = 0.147 +- 0.266 (in-sample avg dev_std = 0.216)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.796
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06892868719611021
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.744
NEC for r=0.2 class 1.0 = 0.178 +- 0.354 (in-sample avg dev_std = 0.300)
NEC for r=0.2 all KL = 0.227 +- 0.354 (in-sample avg dev_std = 0.300)
NEC for r=0.2 all L1 = 0.178 +- 0.273 (in-sample avg dev_std = 0.300)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.796
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08911223662884928
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.697
NEC for r=0.4 class 1.0 = 0.225 +- 0.383 (in-sample avg dev_std = 0.388)
NEC for r=0.4 all KL = 0.333 +- 0.383 (in-sample avg dev_std = 0.388)
NEC for r=0.4 all L1 = 0.225 +- 0.275 (in-sample avg dev_std = 0.388)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.796
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10905064829821717
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 1.0 = 0.289 +- 0.394 (in-sample avg dev_std = 0.492)
NEC for r=0.8 all KL = 0.462 +- 0.394 (in-sample avg dev_std = 0.492)
NEC for r=0.8 all L1 = 0.289 +- 0.275 (in-sample avg dev_std = 0.492)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:46:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:47:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0006
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0006

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.051
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.078
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.090
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.099
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.040
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.089
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.051014440433212994
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.56
SUFF_SIMPLE for r=0.05 class 1.0 = 0.515 +- 0.328 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.05 all KL = 0.183 +- 0.328 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.300 (in-sample avg dev_std = 0.670)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06476895306859207
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.576
SUFF_SIMPLE for r=0.1 class 1.0 = 0.524 +- 0.298 (in-sample avg dev_std = 0.679)
SUFF_SIMPLE for r=0.1 all KL = 0.163 +- 0.298 (in-sample avg dev_std = 0.679)
SUFF_SIMPLE for r=0.1 all L1 = 0.524 +- 0.290 (in-sample avg dev_std = 0.679)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07805415162454873
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.575
SUFF_SIMPLE for r=0.2 class 1.0 = 0.522 +- 0.309 (in-sample avg dev_std = 0.672)
SUFF_SIMPLE for r=0.2 all KL = 0.172 +- 0.309 (in-sample avg dev_std = 0.672)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.292 (in-sample avg dev_std = 0.672)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0895956678700361
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.599
SUFF_SIMPLE for r=0.4 class 1.0 = 0.548 +- 0.344 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.4 all KL = 0.207 +- 0.344 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.4 all L1 = 0.548 +- 0.301 (in-sample avg dev_std = 0.637)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09893501805054151
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.792
SUFF_SIMPLE for r=0.8 class 1.0 = 0.766 +- 0.452 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.8 all KL = 0.611 +- 0.452 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.8 all L1 = 0.766 +- 0.324 (in-sample avg dev_std = 0.349)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.588
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011097222222222222
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.137
SUFF_SIMPLE for r=0.05 class 1.0 = 0.492 +- 0.423 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.05 all KL = 0.395 +- 0.423 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.05 all L1 = 0.492 +- 0.345 (in-sample avg dev_std = 0.525)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.588
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011927380952380951
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.139
SUFF_SIMPLE for r=0.1 class 1.0 = 0.495 +- 0.425 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 all KL = 0.399 +- 0.425 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.345 (in-sample avg dev_std = 0.522)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.588
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012725396825396824
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.138
SUFF_SIMPLE for r=0.2 class 1.0 = 0.497 +- 0.428 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.2 all KL = 0.405 +- 0.428 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.2 all L1 = 0.497 +- 0.348 (in-sample avg dev_std = 0.515)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.588
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012896428571428569
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.137
SUFF_SIMPLE for r=0.4 class 1.0 = 0.497 +- 0.425 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.4 all KL = 0.401 +- 0.425 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.4 all L1 = 0.497 +- 0.347 (in-sample avg dev_std = 0.510)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013026984126984128
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.163
SUFF_SIMPLE for r=0.8 class 1.0 = 0.549 +- 0.447 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 all KL = 0.493 +- 0.447 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 all L1 = 0.549 +- 0.382 (in-sample avg dev_std = 0.210)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03987641815235008
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.384
SUFF_SIMPLE for r=0.05 class 1.0 = 0.496 +- 0.350 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.05 all KL = 0.28 +- 0.350 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.05 all L1 = 0.496 +- 0.282 (in-sample avg dev_std = 0.647)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.053931523500810374
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.389
SUFF_SIMPLE for r=0.1 class 1.0 = 0.499 +- 0.353 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.1 all KL = 0.284 +- 0.353 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.1 all L1 = 0.499 +- 0.284 (in-sample avg dev_std = 0.646)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07019408427876823
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.388
SUFF_SIMPLE for r=0.2 class 1.0 = 0.499 +- 0.359 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.2 all KL = 0.289 +- 0.359 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.2 all L1 = 0.499 +- 0.288 (in-sample avg dev_std = 0.634)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08869408427876822
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.409
SUFF_SIMPLE for r=0.4 class 1.0 = 0.53 +- 0.383 (in-sample avg dev_std = 0.586)
SUFF_SIMPLE for r=0.4 all KL = 0.337 +- 0.383 (in-sample avg dev_std = 0.586)
SUFF_SIMPLE for r=0.4 all L1 = 0.53 +- 0.307 (in-sample avg dev_std = 0.586)


ratio=0.8


40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10808995137763372
len(reference) = 2465
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.604
SUFF_SIMPLE for r=0.8 class 1.0 = 0.729 +- 0.419 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 all KL = 0.654 +- 0.419 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 all L1 = 0.729 +- 0.337 (in-sample avg dev_std = 0.300)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.051014440433212994
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.953
NEC for r=0.05 class 1.0 = 0.051 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.079 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.051 +- 0.184 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06476895306859207
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.904
NEC for r=0.1 class 1.0 = 0.104 +- 0.342 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all KL = 0.174 +- 0.342 (in-sample avg dev_std = 0.199)
NEC for r=0.1 all L1 = 0.104 +- 0.245 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07805415162454873
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.855
NEC for r=0.2 class 1.0 = 0.179 +- 0.424 (in-sample avg dev_std = 0.387)
NEC for r=0.2 all KL = 0.352 +- 0.424 (in-sample avg dev_std = 0.387)
NEC for r=0.2 all L1 = 0.179 +- 0.276 (in-sample avg dev_std = 0.387)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0895956678700361
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.814
NEC for r=0.4 class 1.0 = 0.241 +- 0.430 (in-sample avg dev_std = 0.518)
NEC for r=0.4 all KL = 0.518 +- 0.430 (in-sample avg dev_std = 0.518)
NEC for r=0.4 all L1 = 0.241 +- 0.273 (in-sample avg dev_std = 0.518)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09893501805054151
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.818
NEC for r=0.8 class 1.0 = 0.249 +- 0.409 (in-sample avg dev_std = 0.581)
NEC for r=0.8 all KL = 0.563 +- 0.409 (in-sample avg dev_std = 0.581)
NEC for r=0.8 all L1 = 0.249 +- 0.255 (in-sample avg dev_std = 0.581)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.588
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011097222222222222
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.533
NEC for r=0.05 class 1.0 = 0.202 +- 0.336 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.201 +- 0.336 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.202 +- 0.300 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.588
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.011927380952380951
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.424
NEC for r=0.1 class 1.0 = 0.298 +- 0.404 (in-sample avg dev_std = 0.213)
NEC for r=0.1 all KL = 0.337 +- 0.404 (in-sample avg dev_std = 0.213)
NEC for r=0.1 all L1 = 0.298 +- 0.343 (in-sample avg dev_std = 0.213)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.588
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012725396825396824
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.39
NEC for r=0.2 class 1.0 = 0.369 +- 0.394 (in-sample avg dev_std = 0.557)
NEC for r=0.2 all KL = 0.494 +- 0.394 (in-sample avg dev_std = 0.557)
NEC for r=0.2 all L1 = 0.369 +- 0.300 (in-sample avg dev_std = 0.557)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.588
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012896428571428569
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.391
NEC for r=0.4 class 1.0 = 0.387 +- 0.374 (in-sample avg dev_std = 0.625)
NEC for r=0.4 all KL = 0.55 +- 0.374 (in-sample avg dev_std = 0.625)
NEC for r=0.4 all L1 = 0.387 +- 0.275 (in-sample avg dev_std = 0.625)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.588
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013026984126984128
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.39
NEC for r=0.8 class 1.0 = 0.391 +- 0.366 (in-sample avg dev_std = 0.653)
NEC for r=0.8 all KL = 0.567 +- 0.366 (in-sample avg dev_std = 0.653)
NEC for r=0.8 all L1 = 0.391 +- 0.264 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03987641815235008
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.702
NEC for r=0.05 class 1.0 = 0.134 +- 0.318 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all KL = 0.15 +- 0.318 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all L1 = 0.134 +- 0.265 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.053931523500810374
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.663
NEC for r=0.1 class 1.0 = 0.185 +- 0.368 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all KL = 0.226 +- 0.368 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all L1 = 0.185 +- 0.294 (in-sample avg dev_std = 0.225)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07019408427876823
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.614
NEC for r=0.2 class 1.0 = 0.247 +- 0.406 (in-sample avg dev_std = 0.370)
NEC for r=0.2 all KL = 0.334 +- 0.406 (in-sample avg dev_std = 0.370)
NEC for r=0.2 all L1 = 0.247 +- 0.310 (in-sample avg dev_std = 0.370)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08869408427876822
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.535
NEC for r=0.4 class 1.0 = 0.329 +- 0.416 (in-sample avg dev_std = 0.501)
NEC for r=0.4 all KL = 0.488 +- 0.416 (in-sample avg dev_std = 0.501)
NEC for r=0.4 all L1 = 0.329 +- 0.309 (in-sample avg dev_std = 0.501)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10808995137763372
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 1.0 = 0.373 +- 0.390 (in-sample avg dev_std = 0.587)
NEC for r=0.8 all KL = 0.579 +- 0.390 (in-sample avg dev_std = 0.587)
NEC for r=0.8 all L1 = 0.373 +- 0.290 (in-sample avg dev_std = 0.587)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:52:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:52:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0005
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0003
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0005
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0003

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.046
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.061
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.076
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.097
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04555595667870036
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.711
SUFF_SIMPLE for r=0.05 class 1.0 = 0.668 +- 0.441 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.05 all KL = 0.379 +- 0.441 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.05 all L1 = 0.668 +- 0.315 (in-sample avg dev_std = 0.587)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06126353790613718
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.703
SUFF_SIMPLE for r=0.1 class 1.0 = 0.658 +- 0.432 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.1 all KL = 0.364 +- 0.432 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.314 (in-sample avg dev_std = 0.592)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07561371841155234
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.712
SUFF_SIMPLE for r=0.2 class 1.0 = 0.668 +- 0.439 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.2 all KL = 0.386 +- 0.439 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.2 all L1 = 0.668 +- 0.320 (in-sample avg dev_std = 0.573)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09065703971119134
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.743
SUFF_SIMPLE for r=0.4 class 1.0 = 0.701 +- 0.449 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.449 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all L1 = 0.701 +- 0.319 (in-sample avg dev_std = 0.507)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09688808664259928
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.91
SUFF_SIMPLE for r=0.8 class 1.0 = 0.887 +- 0.370 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 all KL = 0.796 +- 0.370 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.246 (in-sample avg dev_std = 0.223)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.782
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011899999999999999
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.283
SUFF_SIMPLE for r=0.05 class 1.0 = 0.458 +- 0.389 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.05 all KL = 0.281 +- 0.389 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.05 all L1 = 0.458 +- 0.312 (in-sample avg dev_std = 0.596)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.782
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01253452380952381
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.288
SUFF_SIMPLE for r=0.1 class 1.0 = 0.459 +- 0.384 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.1 all KL = 0.276 +- 0.384 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.1 all L1 = 0.459 +- 0.309 (in-sample avg dev_std = 0.600)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.782
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.013086904761904761
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.289
SUFF_SIMPLE for r=0.2 class 1.0 = 0.461 +- 0.386 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.2 all KL = 0.28 +- 0.386 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.2 all L1 = 0.461 +- 0.311 (in-sample avg dev_std = 0.590)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.782
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013005158730158728
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.291
SUFF_SIMPLE for r=0.4 class 1.0 = 0.465 +- 0.391 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.4 all KL = 0.287 +- 0.391 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.4 all L1 = 0.465 +- 0.316 (in-sample avg dev_std = 0.579)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013074206349206351
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.325
SUFF_SIMPLE for r=0.8 class 1.0 = 0.544 +- 0.451 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.8 all KL = 0.46 +- 0.451 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.8 all L1 = 0.544 +- 0.385 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.81
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037346839546191245
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.466
SUFF_SIMPLE for r=0.05 class 1.0 = 0.541 +- 0.351 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.05 all KL = 0.342 +- 0.351 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.05 all L1 = 0.541 +- 0.275 (in-sample avg dev_std = 0.616)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.81
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05398460291734197
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.47
SUFF_SIMPLE for r=0.1 class 1.0 = 0.548 +- 0.355 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.1 all KL = 0.353 +- 0.355 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.1 all L1 = 0.548 +- 0.279 (in-sample avg dev_std = 0.606)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.81
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06904619124797406
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.475
SUFF_SIMPLE for r=0.2 class 1.0 = 0.55 +- 0.357 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.2 all KL = 0.356 +- 0.357 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.2 all L1 = 0.55 +- 0.281 (in-sample avg dev_std = 0.600)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.81
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08848257698541329
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.524
SUFF_SIMPLE for r=0.4 class 1.0 = 0.591 +- 0.388 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 all KL = 0.423 +- 0.388 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 all L1 = 0.591 +- 0.297 (in-sample avg dev_std = 0.551)


ratio=0.8


40 5 0
40 4 0
40 5 0
40 5 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.811
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10666247974068072
len(reference) = 2463
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.685
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.385 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all KL = 0.719 +- 0.385 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all L1 = 0.765 +- 0.311 (in-sample avg dev_std = 0.287)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04555595667870036
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 1.0 = 0.026 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.043 +- 0.185 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.026 +- 0.135 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06126353790613718
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.96
NEC for r=0.1 class 1.0 = 0.044 +- 0.250 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all KL = 0.078 +- 0.250 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all L1 = 0.044 +- 0.164 (in-sample avg dev_std = 0.140)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07561371841155234
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.933
NEC for r=0.2 class 1.0 = 0.085 +- 0.350 (in-sample avg dev_std = 0.293)
NEC for r=0.2 all KL = 0.169 +- 0.350 (in-sample avg dev_std = 0.293)
NEC for r=0.2 all L1 = 0.085 +- 0.203 (in-sample avg dev_std = 0.293)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09065703971119134
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.882
NEC for r=0.4 class 1.0 = 0.151 +- 0.422 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all KL = 0.316 +- 0.422 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all L1 = 0.151 +- 0.248 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09688808664259928
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.872
NEC for r=0.8 class 1.0 = 0.177 +- 0.444 (in-sample avg dev_std = 0.521)
NEC for r=0.8 all KL = 0.398 +- 0.444 (in-sample avg dev_std = 0.521)
NEC for r=0.8 all L1 = 0.177 +- 0.241 (in-sample avg dev_std = 0.521)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.782
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011899999999999999
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.655
NEC for r=0.05 class 1.0 = 0.18 +- 0.338 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.192 +- 0.338 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.18 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.782
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01253452380952381
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.544
NEC for r=0.1 class 1.0 = 0.281 +- 0.417 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all KL = 0.334 +- 0.417 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all L1 = 0.281 +- 0.348 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.782
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.013086904761904761
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.521
NEC for r=0.2 class 1.0 = 0.335 +- 0.420 (in-sample avg dev_std = 0.493)
NEC for r=0.2 all KL = 0.473 +- 0.420 (in-sample avg dev_std = 0.493)
NEC for r=0.2 all L1 = 0.335 +- 0.321 (in-sample avg dev_std = 0.493)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.782
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013005158730158728
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.521
NEC for r=0.4 class 1.0 = 0.348 +- 0.405 (in-sample avg dev_std = 0.556)
NEC for r=0.4 all KL = 0.532 +- 0.405 (in-sample avg dev_std = 0.556)
NEC for r=0.4 all L1 = 0.348 +- 0.299 (in-sample avg dev_std = 0.556)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.782
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013074206349206351
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.521
NEC for r=0.8 class 1.0 = 0.353 +- 0.395 (in-sample avg dev_std = 0.577)
NEC for r=0.8 all KL = 0.557 +- 0.395 (in-sample avg dev_std = 0.577)
NEC for r=0.8 all L1 = 0.353 +- 0.291 (in-sample avg dev_std = 0.577)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.81
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037346839546191245
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.763
NEC for r=0.05 class 1.0 = 0.117 +- 0.282 (in-sample avg dev_std = 0.100)
NEC for r=0.05 all KL = 0.121 +- 0.282 (in-sample avg dev_std = 0.100)
NEC for r=0.05 all L1 = 0.117 +- 0.240 (in-sample avg dev_std = 0.100)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.81
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05398460291734197
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.741
NEC for r=0.1 class 1.0 = 0.159 +- 0.329 (in-sample avg dev_std = 0.235)
NEC for r=0.1 all KL = 0.182 +- 0.329 (in-sample avg dev_std = 0.235)
NEC for r=0.1 all L1 = 0.159 +- 0.265 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.81
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06904619124797406
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.693
NEC for r=0.2 class 1.0 = 0.216 +- 0.375 (in-sample avg dev_std = 0.358)
NEC for r=0.2 all KL = 0.278 +- 0.375 (in-sample avg dev_std = 0.358)
NEC for r=0.2 all L1 = 0.216 +- 0.284 (in-sample avg dev_std = 0.358)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.81
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08848257698541329
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.638
NEC for r=0.4 class 1.0 = 0.274 +- 0.394 (in-sample avg dev_std = 0.451)
NEC for r=0.4 all KL = 0.398 +- 0.394 (in-sample avg dev_std = 0.451)
NEC for r=0.4 all L1 = 0.274 +- 0.284 (in-sample avg dev_std = 0.451)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.81
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10666247974068072
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.583
NEC for r=0.8 class 1.0 = 0.328 +- 0.387 (in-sample avg dev_std = 0.541)
NEC for r=0.8 all KL = 0.504 +- 0.387 (in-sample avg dev_std = 0.541)
NEC for r=0.8 all L1 = 0.328 +- 0.279 (in-sample avg dev_std = 0.541)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 17:58:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 05:58:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0062
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0008
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0187
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0008
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0187

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.087
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.095
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.039
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.067
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.087
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03759927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.655
SUFF_SIMPLE for r=0.05 class 1.0 = 0.581 +- 0.311 (in-sample avg dev_std = 0.715)
SUFF_SIMPLE for r=0.05 all KL = 0.169 +- 0.311 (in-sample avg dev_std = 0.715)
SUFF_SIMPLE for r=0.05 all L1 = 0.581 +- 0.277 (in-sample avg dev_std = 0.715)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05360649819494584
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.655
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.339 (in-sample avg dev_std = 0.695)
SUFF_SIMPLE for r=0.1 all KL = 0.201 +- 0.339 (in-sample avg dev_std = 0.695)
SUFF_SIMPLE for r=0.1 all L1 = 0.583 +- 0.290 (in-sample avg dev_std = 0.695)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0723898916967509
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.664
SUFF_SIMPLE for r=0.2 class 1.0 = 0.597 +- 0.357 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.2 all KL = 0.215 +- 0.357 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.2 all L1 = 0.597 +- 0.291 (in-sample avg dev_std = 0.678)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08672202166064982
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.645
SUFF_SIMPLE for r=0.4 class 1.0 = 0.591 +- 0.399 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.4 all KL = 0.264 +- 0.399 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.4 all L1 = 0.591 +- 0.312 (in-sample avg dev_std = 0.649)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0951841155234657
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.862
SUFF_SIMPLE for r=0.8 class 1.0 = 0.842 +- 0.424 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 all KL = 0.712 +- 0.424 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.8 all L1 = 0.842 +- 0.282 (in-sample avg dev_std = 0.285)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011773412698412698
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.009
SUFF_SIMPLE for r=0.05 class 1.0 = 0.519 +- 0.439 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 all KL = 0.495 +- 0.439 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.156)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012296825396825396
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.009
SUFF_SIMPLE for r=0.1 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.1 all L1 = 0.519 +- 0.378 (in-sample avg dev_std = 0.161)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012719047619047621
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.008
SUFF_SIMPLE for r=0.2 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all L1 = 0.519 +- 0.379 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012902777777777779
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.01
SUFF_SIMPLE for r=0.4 class 1.0 = 0.519 +- 0.438 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all KL = 0.494 +- 0.438 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all L1 = 0.519 +- 0.378 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012966666666666668
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.018
SUFF_SIMPLE for r=0.8 class 1.0 = 0.528 +- 0.438 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.8 all KL = 0.505 +- 0.438 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.8 all L1 = 0.528 +- 0.380 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.913
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03883387358184765
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.557
SUFF_SIMPLE for r=0.05 class 1.0 = 0.56 +- 0.357 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.05 all KL = 0.261 +- 0.357 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.05 all L1 = 0.56 +- 0.291 (in-sample avg dev_std = 0.664)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.913
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05212398703403565
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.552
SUFF_SIMPLE for r=0.1 class 1.0 = 0.562 +- 0.369 (in-sample avg dev_std = 0.638)
SUFF_SIMPLE for r=0.1 all KL = 0.276 +- 0.369 (in-sample avg dev_std = 0.638)
SUFF_SIMPLE for r=0.1 all L1 = 0.562 +- 0.301 (in-sample avg dev_std = 0.638)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.913
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0669793354943274
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.554
SUFF_SIMPLE for r=0.2 class 1.0 = 0.57 +- 0.384 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.2 all KL = 0.298 +- 0.384 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.2 all L1 = 0.57 +- 0.310 (in-sample avg dev_std = 0.608)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.913
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08731807131280388
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.57
SUFF_SIMPLE for r=0.4 class 1.0 = 0.594 +- 0.406 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.4 all KL = 0.345 +- 0.406 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.4 all L1 = 0.594 +- 0.321 (in-sample avg dev_std = 0.560)


ratio=0.8


40 5 0
40 5 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.914
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10684197730956241
len(reference) = 2464
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.772
SUFF_SIMPLE for r=0.8 class 1.0 = 0.804 +- 0.409 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.8 all KL = 0.712 +- 0.409 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.8 all L1 = 0.804 +- 0.307 (in-sample avg dev_std = 0.292)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03759927797833935
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.975
NEC for r=0.05 class 1.0 = 0.03 +- 0.212 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.212 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.03 +- 0.135 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05360649819494584
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 1.0 = 0.067 +- 0.308 (in-sample avg dev_std = 0.130)
NEC for r=0.1 all KL = 0.13 +- 0.308 (in-sample avg dev_std = 0.130)
NEC for r=0.1 all L1 = 0.067 +- 0.196 (in-sample avg dev_std = 0.130)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0723898916967509
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.916
NEC for r=0.2 class 1.0 = 0.103 +- 0.382 (in-sample avg dev_std = 0.279)
NEC for r=0.2 all KL = 0.237 +- 0.382 (in-sample avg dev_std = 0.279)
NEC for r=0.2 all L1 = 0.103 +- 0.222 (in-sample avg dev_std = 0.279)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08672202166064982
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.864
NEC for r=0.4 class 1.0 = 0.172 +- 0.439 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all KL = 0.388 +- 0.439 (in-sample avg dev_std = 0.444)
NEC for r=0.4 all L1 = 0.172 +- 0.256 (in-sample avg dev_std = 0.444)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0951841155234657
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 1.0 = 0.196 +- 0.443 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all KL = 0.524 +- 0.443 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all L1 = 0.196 +- 0.227 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011773412698412698
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.221
NEC for r=0.05 class 1.0 = 0.325 +- 0.383 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.326 +- 0.383 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.325 +- 0.340 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012296825396825396
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.099
NEC for r=0.1 class 1.0 = 0.419 +- 0.425 (in-sample avg dev_std = 0.094)
NEC for r=0.1 all KL = 0.439 +- 0.425 (in-sample avg dev_std = 0.094)
NEC for r=0.1 all L1 = 0.419 +- 0.370 (in-sample avg dev_std = 0.094)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012719047619047621
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.076
NEC for r=0.2 class 1.0 = 0.45 +- 0.426 (in-sample avg dev_std = 0.341)
NEC for r=0.2 all KL = 0.492 +- 0.426 (in-sample avg dev_std = 0.341)
NEC for r=0.2 all L1 = 0.45 +- 0.358 (in-sample avg dev_std = 0.341)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012902777777777779
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.076
NEC for r=0.4 class 1.0 = 0.454 +- 0.428 (in-sample avg dev_std = 0.376)
NEC for r=0.4 all KL = 0.498 +- 0.428 (in-sample avg dev_std = 0.376)
NEC for r=0.4 all L1 = 0.454 +- 0.356 (in-sample avg dev_std = 0.376)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012966666666666668
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.073
NEC for r=0.8 class 1.0 = 0.456 +- 0.430 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all KL = 0.5 +- 0.430 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all L1 = 0.456 +- 0.356 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.913
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03883387358184765
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.867
NEC for r=0.05 class 1.0 = 0.082 +- 0.277 (in-sample avg dev_std = 0.075)
NEC for r=0.05 all KL = 0.108 +- 0.277 (in-sample avg dev_std = 0.075)
NEC for r=0.05 all L1 = 0.082 +- 0.215 (in-sample avg dev_std = 0.075)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.913
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05212398703403565
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.837
NEC for r=0.1 class 1.0 = 0.123 +- 0.344 (in-sample avg dev_std = 0.229)
NEC for r=0.1 all KL = 0.179 +- 0.344 (in-sample avg dev_std = 0.229)
NEC for r=0.1 all L1 = 0.123 +- 0.251 (in-sample avg dev_std = 0.229)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.913
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0669793354943274
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.793
NEC for r=0.2 class 1.0 = 0.178 +- 0.400 (in-sample avg dev_std = 0.331)
NEC for r=0.2 all KL = 0.289 +- 0.400 (in-sample avg dev_std = 0.331)
NEC for r=0.2 all L1 = 0.178 +- 0.281 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.913
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08731807131280388
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.71
NEC for r=0.4 class 1.0 = 0.26 +- 0.433 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all KL = 0.447 +- 0.433 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all L1 = 0.26 +- 0.307 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.913
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10684197730956241
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.68
NEC for r=0.8 class 1.0 = 0.308 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 all KL = 0.562 +- 0.416 (in-sample avg dev_std = 0.548)
NEC for r=0.8 all L1 = 0.308 +- 0.298 (in-sample avg dev_std = 0.548)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.338, 0.362, 0.342, 0.421, 0.781], 'all_L1': [0.634, 0.648, 0.64, 0.687, 0.865]}), defaultdict(<class 'list'>, {'all_KL': [0.346, 0.354, 0.383, 0.38, 0.766], 'all_L1': [0.657, 0.659, 0.673, 0.68, 0.858]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.414, 0.389, 0.42, 0.818], 'all_L1': [0.696, 0.689, 0.688, 0.704, 0.899]}), defaultdict(<class 'list'>, {'all_KL': [0.15, 0.173, 0.172, 0.169, 0.572], 'all_L1': [0.52, 0.524, 0.507, 0.522, 0.731]}), defaultdict(<class 'list'>, {'all_KL': [0.508, 0.514, 0.535, 0.563, 0.81], 'all_L1': [0.748, 0.759, 0.755, 0.769, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.132, 0.15, 0.188, 0.608], 'all_L1': [0.503, 0.501, 0.508, 0.517, 0.756]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.43, 0.457, 0.513, 0.866], 'all_L1': [0.712, 0.703, 0.724, 0.746, 0.909]}), defaultdict(<class 'list'>, {'all_KL': [0.183, 0.163, 0.172, 0.207, 0.611], 'all_L1': [0.515, 0.524, 0.522, 0.548, 0.766]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.364, 0.386, 0.454, 0.796], 'all_L1': [0.668, 0.658, 0.668, 0.701, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.169, 0.201, 0.215, 0.264, 0.712], 'all_L1': [0.581, 0.583, 0.597, 0.591, 0.842]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.076, 0.136, 0.246, 0.381, 0.425], 'all_L1': [0.047, 0.076, 0.123, 0.177, 0.185]}), defaultdict(<class 'list'>, {'all_KL': [0.04, 0.07, 0.134, 0.288, 0.395], 'all_L1': [0.025, 0.036, 0.062, 0.129, 0.17]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.107, 0.193, 0.307, 0.351], 'all_L1': [0.027, 0.063, 0.104, 0.135, 0.155]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.141, 0.263, 0.378, 0.491], 'all_L1': [0.031, 0.074, 0.134, 0.183, 0.222]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.083, 0.167, 0.247, 0.305], 'all_L1': [0.033, 0.052, 0.092, 0.114, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.15, 0.318, 0.506, 0.554], 'all_L1': [0.054, 0.087, 0.167, 0.238, 0.246]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.102, 0.177, 0.295, 0.367], 'all_L1': [0.031, 0.064, 0.096, 0.126, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.174, 0.352, 0.518, 0.563], 'all_L1': [0.051, 0.104, 0.179, 0.241, 0.249]}), defaultdict(<class 'list'>, {'all_KL': [0.043, 0.078, 0.169, 0.316, 0.398], 'all_L1': [0.026, 0.044, 0.085, 0.151, 0.177]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.13, 0.237, 0.388, 0.524], 'all_L1': [0.03, 0.067, 0.103, 0.172, 0.196]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.508, 0.506, 0.504, 0.509, 0.582], 'all_L1': [0.581, 0.581, 0.578, 0.583, 0.622]}), defaultdict(<class 'list'>, {'all_KL': [0.292, 0.296, 0.295, 0.301, 0.414], 'all_L1': [0.411, 0.413, 0.412, 0.415, 0.471]}), defaultdict(<class 'list'>, {'all_KL': [0.185, 0.188, 0.189, 0.196, 0.313], 'all_L1': [0.364, 0.365, 0.368, 0.373, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.232, 0.231, 0.232, 0.241], 'all_L1': [0.305, 0.306, 0.306, 0.306, 0.314]}), defaultdict(<class 'list'>, {'all_KL': [0.477, 0.479, 0.477, 0.485, 0.622], 'all_L1': [0.576, 0.576, 0.575, 0.579, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.625, 0.624, 0.626, 0.624, 0.645], 'all_L1': [0.646, 0.646, 0.646, 0.646, 0.659]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.42, 0.422, 0.433, 0.612], 'all_L1': [0.574, 0.572, 0.571, 0.575, 0.654]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.399, 0.405, 0.401, 0.493], 'all_L1': [0.492, 0.495, 0.497, 0.497, 0.549]}), defaultdict(<class 'list'>, {'all_KL': [0.281, 0.276, 0.28, 0.287, 0.46], 'all_L1': [0.458, 0.459, 0.461, 0.465, 0.544]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.494, 0.494, 0.494, 0.505], 'all_L1': [0.519, 0.519, 0.519, 0.519, 0.528]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.182, 0.301, 0.411, 0.442, 0.459], 'all_L1': [0.184, 0.274, 0.322, 0.334, 0.342]}), defaultdict(<class 'list'>, {'all_KL': [0.257, 0.417, 0.551, 0.591, 0.602], 'all_L1': [0.263, 0.383, 0.445, 0.462, 0.462]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.481, 0.653, 0.709, 0.728], 'all_L1': [0.216, 0.372, 0.438, 0.454, 0.456]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.674, 0.753, 0.759, 0.76], 'all_L1': [0.407, 0.592, 0.645, 0.649, 0.652]}), defaultdict(<class 'list'>, {'all_KL': [0.182, 0.282, 0.372, 0.411, 0.417], 'all_L1': [0.199, 0.271, 0.312, 0.327, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.189, 0.302, 0.356, 0.368, 0.369], 'all_L1': [0.205, 0.293, 0.322, 0.329, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.255, 0.363, 0.418, 0.438], 'all_L1': [0.181, 0.243, 0.285, 0.305, 0.306]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.337, 0.494, 0.55, 0.567], 'all_L1': [0.202, 0.298, 0.369, 0.387, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.192, 0.334, 0.473, 0.532, 0.557], 'all_L1': [0.18, 0.281, 0.335, 0.348, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.439, 0.492, 0.498, 0.5], 'all_L1': [0.325, 0.419, 0.45, 0.454, 0.456]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.371, 0.376, 0.382, 0.439, 0.738], 'all_L1': [0.594, 0.595, 0.6, 0.633, 0.796]}), defaultdict(<class 'list'>, {'all_KL': [0.349, 0.355, 0.372, 0.435, 0.708], 'all_L1': [0.537, 0.542, 0.548, 0.585, 0.746]}), defaultdict(<class 'list'>, {'all_KL': [0.401, 0.407, 0.415, 0.482, 0.738], 'all_L1': [0.556, 0.556, 0.561, 0.604, 0.766]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.287, 0.298, 0.327, 0.65], 'all_L1': [0.478, 0.482, 0.485, 0.5, 0.717]}), defaultdict(<class 'list'>, {'all_KL': [0.385, 0.407, 0.433, 0.497, 0.742], 'all_L1': [0.599, 0.599, 0.602, 0.633, 0.779]}), defaultdict(<class 'list'>, {'all_KL': [0.385, 0.389, 0.395, 0.427, 0.676], 'all_L1': [0.508, 0.51, 0.511, 0.533, 0.715]}), defaultdict(<class 'list'>, {'all_KL': [0.378, 0.39, 0.422, 0.505, 0.755], 'all_L1': [0.6, 0.613, 0.628, 0.668, 0.799]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.284, 0.289, 0.337, 0.654], 'all_L1': [0.496, 0.499, 0.499, 0.53, 0.729]}), defaultdict(<class 'list'>, {'all_KL': [0.342, 0.353, 0.356, 0.423, 0.719], 'all_L1': [0.541, 0.548, 0.55, 0.591, 0.765]}), defaultdict(<class 'list'>, {'all_KL': [0.261, 0.276, 0.298, 0.345, 0.712], 'all_L1': [0.56, 0.562, 0.57, 0.594, 0.804]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.11, 0.163, 0.24, 0.38, 0.466], 'all_L1': [0.102, 0.136, 0.177, 0.245, 0.284]}), defaultdict(<class 'list'>, {'all_KL': [0.118, 0.174, 0.268, 0.38, 0.508], 'all_L1': [0.121, 0.16, 0.218, 0.275, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.111, 0.167, 0.247, 0.346, 0.462], 'all_L1': [0.12, 0.161, 0.212, 0.267, 0.327]}), defaultdict(<class 'list'>, {'all_KL': [0.139, 0.218, 0.337, 0.499, 0.574], 'all_L1': [0.126, 0.18, 0.253, 0.348, 0.379]}), defaultdict(<class 'list'>, {'all_KL': [0.116, 0.179, 0.246, 0.355, 0.466], 'all_L1': [0.119, 0.16, 0.2, 0.259, 0.305]}), defaultdict(<class 'list'>, {'all_KL': [0.144, 0.22, 0.309, 0.434, 0.508], 'all_L1': [0.151, 0.209, 0.271, 0.348, 0.395]}), defaultdict(<class 'list'>, {'all_KL': [0.111, 0.167, 0.227, 0.333, 0.462], 'all_L1': [0.11, 0.147, 0.178, 0.225, 0.289]}), defaultdict(<class 'list'>, {'all_KL': [0.15, 0.226, 0.334, 0.488, 0.579], 'all_L1': [0.134, 0.185, 0.247, 0.329, 0.373]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.182, 0.278, 0.398, 0.504], 'all_L1': [0.117, 0.159, 0.216, 0.274, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.179, 0.289, 0.447, 0.562], 'all_L1': [0.082, 0.123, 0.178, 0.26, 0.308]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.623 +- 0.084, 0.625 +- 0.083, 0.628 +- 0.086, 0.646 +- 0.089, 0.840 +- 0.062
suff_simple class all_KL  =  0.306 +- 0.127, 0.311 +- 0.126, 0.320 +- 0.127, 0.358 +- 0.134, 0.734 +- 0.098
suff_simple_acc_int  =  0.681 +- 0.083, 0.681 +- 0.079, 0.681 +- 0.082, 0.697 +- 0.083, 0.859 +- 0.054
nec class all_L1  =  0.035 +- 0.010, 0.067 +- 0.019, 0.115 +- 0.035, 0.167 +- 0.043, 0.188 +- 0.038
nec class all_KL  =  0.058 +- 0.017, 0.117 +- 0.033, 0.226 +- 0.067, 0.362 +- 0.086, 0.437 +- 0.086
nec_acc_int  =  0.969 +- 0.008, 0.945 +- 0.018, 0.908 +- 0.029, 0.874 +- 0.034, 0.865 +- 0.028

Eval split val
suff_simple class all_L1  =  0.493 +- 0.103, 0.493 +- 0.102, 0.493 +- 0.101, 0.496 +- 0.101, 0.542 +- 0.107
suff_simple class all_KL  =  0.391 +- 0.133, 0.391 +- 0.132, 0.392 +- 0.132, 0.396 +- 0.131, 0.489 +- 0.128
suff_simple_acc_int  =  0.179 +- 0.134, 0.181 +- 0.135, 0.179 +- 0.133, 0.181 +- 0.135, 0.201 +- 0.143
nec class all_L1  =  0.236 +- 0.071, 0.343 +- 0.099, 0.392 +- 0.102, 0.405 +- 0.099, 0.407 +- 0.099
nec class all_KL  =  0.241 +- 0.086, 0.382 +- 0.120, 0.492 +- 0.124, 0.528 +- 0.123, 0.540 +- 0.123
nec_acc_int  =  0.477 +- 0.159, 0.359 +- 0.172, 0.338 +- 0.173, 0.335 +- 0.172, 0.335 +- 0.175

Eval split test
suff_simple class all_L1  =  0.547 +- 0.041, 0.551 +- 0.042, 0.555 +- 0.045, 0.587 +- 0.050, 0.762 +- 0.032
suff_simple class all_KL  =  0.343 +- 0.049, 0.352 +- 0.049, 0.366 +- 0.051, 0.422 +- 0.062, 0.709 +- 0.035
suff_simple_acc_int  =  0.463 +- 0.109, 0.462 +- 0.106, 0.463 +- 0.105, 0.491 +- 0.107, 0.653 +- 0.092
nec class all_L1  =  0.118 +- 0.017, 0.162 +- 0.023, 0.215 +- 0.032, 0.283 +- 0.041, 0.333 +- 0.037
nec class all_KL  =  0.123 +- 0.015, 0.188 +- 0.023, 0.278 +- 0.037, 0.406 +- 0.055, 0.509 +- 0.045
nec_acc_int  =  0.732 +- 0.084, 0.704 +- 0.088, 0.662 +- 0.096, 0.601 +- 0.097, 0.560 +- 0.099


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.329 +- 0.039, 0.346 +- 0.035, 0.371 +- 0.031, 0.407 +- 0.028, 0.514 +- 0.016
Faith. Armon (L1)= 		  =  0.067 +- 0.018, 0.119 +- 0.029, 0.189 +- 0.044, 0.259 +- 0.044, 0.304 +- 0.046
Faith. GMean (L1)= 	  =  0.146 +- 0.016, 0.200 +- 0.022, 0.262 +- 0.027, 0.322 +- 0.023, 0.394 +- 0.027
Faith. Aritm (KL)= 		  =  0.182 +- 0.058, 0.214 +- 0.051, 0.273 +- 0.040, 0.360 +- 0.040, 0.586 +- 0.025
Faith. Armon (KL)= 		  =  0.090 +- 0.017, 0.154 +- 0.022, 0.236 +- 0.027, 0.329 +- 0.048, 0.535 +- 0.045
Faith. GMean (KL)= 	  =  0.125 +- 0.021, 0.180 +- 0.027, 0.253 +- 0.030, 0.344 +- 0.043, 0.559 +- 0.031

Eval split val
Faith. Aritm (L1)= 		  =  0.364 +- 0.041, 0.418 +- 0.035, 0.443 +- 0.029, 0.450 +- 0.027, 0.474 +- 0.017
Faith. Armon (L1)= 		  =  0.305 +- 0.041, 0.384 +- 0.033, 0.416 +- 0.027, 0.426 +- 0.024, 0.444 +- 0.021
Faith. GMean (L1)= 	  =  0.333 +- 0.036, 0.400 +- 0.032, 0.429 +- 0.026, 0.438 +- 0.023, 0.458 +- 0.014
Faith. Aritm (KL)= 		  =  0.316 +- 0.061, 0.387 +- 0.055, 0.442 +- 0.040, 0.462 +- 0.029, 0.514 +- 0.010
Faith. Armon (KL)= 		  =  0.274 +- 0.048, 0.355 +- 0.052, 0.404 +- 0.057, 0.420 +- 0.057, 0.482 +- 0.046
Faith. GMean (KL)= 	  =  0.294 +- 0.051, 0.370 +- 0.051, 0.422 +- 0.044, 0.440 +- 0.038, 0.497 +- 0.027

Eval split test
Faith. Aritm (L1)= 		  =  0.333 +- 0.017, 0.356 +- 0.015, 0.385 +- 0.011, 0.435 +- 0.007, 0.547 +- 0.005
Faith. Armon (L1)= 		  =  0.193 +- 0.022, 0.248 +- 0.025, 0.307 +- 0.026, 0.378 +- 0.025, 0.461 +- 0.029
Faith. GMean (L1)= 	  =  0.253 +- 0.016, 0.297 +- 0.016, 0.343 +- 0.014, 0.405 +- 0.013, 0.502 +- 0.017
Faith. Aritm (KL)= 		  =  0.233 +- 0.023, 0.270 +- 0.021, 0.322 +- 0.015, 0.414 +- 0.009, 0.609 +- 0.011
Faith. Armon (KL)= 		  =  0.179 +- 0.015, 0.242 +- 0.016, 0.310 +- 0.015, 0.406 +- 0.011, 0.590 +- 0.020
Faith. GMean (KL)= 	  =  0.204 +- 0.016, 0.255 +- 0.017, 0.316 +- 0.014, 0.410 +- 0.009, 0.600 +- 0.015
Computed for split load_split = id



Completed in  0:59:35.310844  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:04:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:04:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.072
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.079
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.091
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.103
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.047
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.061
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.076
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.092
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07176895306859206
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.98
SUFF_SIMPLE for r=0.05 class 1.0 = 0.971 +- 0.204 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.05 all KL = 0.944 +- 0.204 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.05 all L1 = 0.971 +- 0.115 (in-sample avg dev_std = 0.237)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0794187725631769
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.135 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.977 +- 0.135 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.078 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09116245487364621
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.985
SUFF_SIMPLE for r=0.2 class 1.0 = 0.986 +- 0.131 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.2 all KL = 0.979 +- 0.131 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.2 all L1 = 0.986 +- 0.102 (in-sample avg dev_std = 0.087)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10047292418772565
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.033 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.4 all KL = 0.998 +- 0.033 (in-sample avg dev_std = 0.039)
SUFF_SIMPLE for r=0.4 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.039)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10295306859205774
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012415476190476192
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  1.0
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.003 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 all KL = 1.0 +- 0.003 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 all L1 = 1.0 +- 0.003 (in-sample avg dev_std = 0.005)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012440873015873016
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  1.0
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.013 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 all KL = 1.0 +- 0.013 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.1 all L1 = 1.0 +- 0.007 (in-sample avg dev_std = 0.019)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012421031746031748
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.012 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all KL = 1.0 +- 0.012 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all L1 = 1.0 +- 0.005 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012417063492063491
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  1.0
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.006 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all KL = 1.0 +- 0.006 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all L1 = 1.0 +- 0.005 (in-sample avg dev_std = 0.011)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012417063492063491
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  1.0
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.020 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.8 all KL = 1.0 +- 0.020 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.023)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0473743922204214
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.974
SUFF_SIMPLE for r=0.05 class 1.0 = 0.965 +- 0.210 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.210 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all L1 = 0.965 +- 0.124 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060837115072933545
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.977
SUFF_SIMPLE for r=0.1 class 1.0 = 0.969 +- 0.190 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.190 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all L1 = 0.969 +- 0.113 (in-sample avg dev_std = 0.204)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07588897893030795
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.984
SUFF_SIMPLE for r=0.2 class 1.0 = 0.979 +- 0.155 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.2 all KL = 0.956 +- 0.155 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.2 all L1 = 0.979 +- 0.089 (in-sample avg dev_std = 0.167)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09154173419773096
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.98
SUFF_SIMPLE for r=0.4 class 1.0 = 0.969 +- 0.190 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all KL = 0.932 +- 0.190 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all L1 = 0.969 +- 0.095 (in-sample avg dev_std = 0.225)


ratio=0.8


40 5 0

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10853808752025933
len(reference) = 2467
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.74
SUFF_SIMPLE for r=0.8 class 1.0 = 0.774 +- 0.438 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.737 +- 0.438 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.774 +- 0.379 (in-sample avg dev_std = 0.031)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07176895306859206
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0794187725631769
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09116245487364621
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 1.0 = 0.002 +- 0.059 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all KL = 0.004 +- 0.059 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.10047292418772565
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.992
NEC for r=0.4 class 1.0 = 0.008 +- 0.099 (in-sample avg dev_std = 0.055)
NEC for r=0.4 all KL = 0.011 +- 0.099 (in-sample avg dev_std = 0.055)
NEC for r=0.4 all L1 = 0.008 +- 0.078 (in-sample avg dev_std = 0.055)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10295306859205774
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.991
NEC for r=0.8 class 1.0 = 0.011 +- 0.123 (in-sample avg dev_std = 0.129)
NEC for r=0.8 all KL = 0.023 +- 0.123 (in-sample avg dev_std = 0.129)
NEC for r=0.8 all L1 = 0.011 +- 0.073 (in-sample avg dev_std = 0.129)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012415476190476192
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.002 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012440873015873016
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.015 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.0 +- 0.015 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.0 +- 0.016 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012421031746031748
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 1.0 = 0.0 +- 0.013 (in-sample avg dev_std = 0.019)
NEC for r=0.2 all KL = 0.0 +- 0.013 (in-sample avg dev_std = 0.019)
NEC for r=0.2 all L1 = 0.0 +- 0.007 (in-sample avg dev_std = 0.019)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012417063492063491
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 1.0 = 0.001 +- 0.025 (in-sample avg dev_std = 0.034)
NEC for r=0.4 all KL = 0.001 +- 0.025 (in-sample avg dev_std = 0.034)
NEC for r=0.4 all L1 = 0.001 +- 0.011 (in-sample avg dev_std = 0.034)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012417063492063491
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 1.0 = 0.001 +- 0.026 (in-sample avg dev_std = 0.034)
NEC for r=0.8 all KL = 0.001 +- 0.026 (in-sample avg dev_std = 0.034)
NEC for r=0.8 all L1 = 0.001 +- 0.011 (in-sample avg dev_std = 0.034)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0473743922204214
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.0 +- 0.008 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.008 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.004 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060837115072933545
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 1.0 = 0.002 +- 0.047 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.003 +- 0.047 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.002 +- 0.032 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07588897893030795
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 1.0 = 0.003 +- 0.056 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all KL = 0.005 +- 0.056 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all L1 = 0.003 +- 0.034 (in-sample avg dev_std = 0.053)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09154173419773096
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.997
NEC for r=0.4 class 1.0 = 0.004 +- 0.070 (in-sample avg dev_std = 0.068)
NEC for r=0.4 all KL = 0.008 +- 0.070 (in-sample avg dev_std = 0.068)
NEC for r=0.4 all L1 = 0.004 +- 0.044 (in-sample avg dev_std = 0.068)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10853808752025933
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 1.0 = 0.016 +- 0.142 (in-sample avg dev_std = 0.123)
NEC for r=0.8 all KL = 0.027 +- 0.142 (in-sample avg dev_std = 0.123)
NEC for r=0.8 all L1 = 0.016 +- 0.097 (in-sample avg dev_std = 0.123)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:10:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:10:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:10:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:10:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:10:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.061
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.076
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.082
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.086
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.090
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.049
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06053429602888087
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.921
SUFF_SIMPLE for r=0.05 class 1.0 = 0.888 +- 0.350 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.05 all KL = 0.783 +- 0.350 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.05 all L1 = 0.888 +- 0.200 (in-sample avg dev_std = 0.464)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07590974729241877
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.931
SUFF_SIMPLE for r=0.1 class 1.0 = 0.903 +- 0.328 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all KL = 0.813 +- 0.328 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.1 all L1 = 0.903 +- 0.189 (in-sample avg dev_std = 0.417)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08191696750902527
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.919
SUFF_SIMPLE for r=0.2 class 1.0 = 0.899 +- 0.333 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.2 all KL = 0.817 +- 0.333 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.2 all L1 = 0.899 +- 0.209 (in-sample avg dev_std = 0.385)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08611191335740073
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.92
SUFF_SIMPLE for r=0.4 class 1.0 = 0.906 +- 0.324 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.4 all KL = 0.841 +- 0.324 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.4 all L1 = 0.906 +- 0.217 (in-sample avg dev_std = 0.347)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09004693140794225
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.965
SUFF_SIMPLE for r=0.8 class 1.0 = 0.965 +- 0.206 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.8 all KL = 0.951 +- 0.206 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.158 (in-sample avg dev_std = 0.157)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011984126984126986
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.95
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.290 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 all KL = 0.82 +- 0.290 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.140 (in-sample avg dev_std = 0.417)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012125000000000002
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.946
SUFF_SIMPLE for r=0.1 class 1.0 = 0.913 +- 0.299 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 all KL = 0.812 +- 0.299 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.147 (in-sample avg dev_std = 0.429)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012169444444444445
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.947
SUFF_SIMPLE for r=0.2 class 1.0 = 0.914 +- 0.297 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.2 all KL = 0.813 +- 0.297 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.144 (in-sample avg dev_std = 0.427)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012170238095238095
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.946
SUFF_SIMPLE for r=0.4 class 1.0 = 0.914 +- 0.298 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.4 all KL = 0.817 +- 0.298 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.148 (in-sample avg dev_std = 0.424)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012170238095238097
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.953
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.241 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.8 all KL = 0.925 +- 0.241 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.178 (in-sample avg dev_std = 0.212)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04935858995137764
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.946
SUFF_SIMPLE for r=0.05 class 1.0 = 0.927 +- 0.296 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.05 all KL = 0.863 +- 0.296 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.05 all L1 = 0.927 +- 0.178 (in-sample avg dev_std = 0.349)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05854011345218801
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.948
SUFF_SIMPLE for r=0.1 class 1.0 = 0.934 +- 0.281 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 all KL = 0.882 +- 0.281 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.1 all L1 = 0.934 +- 0.179 (in-sample avg dev_std = 0.305)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07189708265802269
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.954
SUFF_SIMPLE for r=0.2 class 1.0 = 0.945 +- 0.258 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 all KL = 0.908 +- 0.258 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 all L1 = 0.945 +- 0.172 (in-sample avg dev_std = 0.253)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09092666126418153
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.957
SUFF_SIMPLE for r=0.4 class 1.0 = 0.952 +- 0.241 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all KL = 0.924 +- 0.241 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all L1 = 0.952 +- 0.171 (in-sample avg dev_std = 0.216)


ratio=0.8


40 5 0
40 5 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10760777957860616
len(reference) = 2465
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.9
SUFF_SIMPLE for r=0.8 class 1.0 = 0.912 +- 0.302 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 all KL = 0.898 +- 0.302 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 all L1 = 0.912 +- 0.260 (in-sample avg dev_std = 0.066)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06053429602888087
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.996
NEC for r=0.05 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07590974729241877
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.986
NEC for r=0.1 class 1.0 = 0.013 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.015 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.013 +- 0.103 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08191696750902527
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.994
NEC for r=0.2 class 1.0 = 0.008 +- 0.103 (in-sample avg dev_std = 0.099)
NEC for r=0.2 all KL = 0.014 +- 0.103 (in-sample avg dev_std = 0.099)
NEC for r=0.2 all L1 = 0.008 +- 0.064 (in-sample avg dev_std = 0.099)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08611191335740073
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.974
NEC for r=0.4 class 1.0 = 0.03 +- 0.193 (in-sample avg dev_std = 0.180)
NEC for r=0.4 all KL = 0.051 +- 0.193 (in-sample avg dev_std = 0.180)
NEC for r=0.4 all L1 = 0.03 +- 0.130 (in-sample avg dev_std = 0.180)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09004693140794225
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.964
NEC for r=0.8 class 1.0 = 0.055 +- 0.269 (in-sample avg dev_std = 0.337)
NEC for r=0.8 all KL = 0.114 +- 0.269 (in-sample avg dev_std = 0.337)
NEC for r=0.8 all L1 = 0.055 +- 0.138 (in-sample avg dev_std = 0.337)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011984126984126986
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 1.0 = 0.001 +- 0.035 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.001 +- 0.035 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.001 +- 0.027 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012125000000000002
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.989
NEC for r=0.1 class 1.0 = 0.012 +- 0.119 (in-sample avg dev_std = 0.086)
NEC for r=0.1 all KL = 0.016 +- 0.119 (in-sample avg dev_std = 0.086)
NEC for r=0.1 all L1 = 0.012 +- 0.092 (in-sample avg dev_std = 0.086)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012169444444444445
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.984
NEC for r=0.2 class 1.0 = 0.024 +- 0.177 (in-sample avg dev_std = 0.212)
NEC for r=0.2 all KL = 0.046 +- 0.177 (in-sample avg dev_std = 0.212)
NEC for r=0.2 all L1 = 0.024 +- 0.099 (in-sample avg dev_std = 0.212)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012170238095238095
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.985
NEC for r=0.4 class 1.0 = 0.024 +- 0.177 (in-sample avg dev_std = 0.220)
NEC for r=0.4 all KL = 0.05 +- 0.177 (in-sample avg dev_std = 0.220)
NEC for r=0.4 all L1 = 0.024 +- 0.090 (in-sample avg dev_std = 0.220)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012170238095238097
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.986
NEC for r=0.8 class 1.0 = 0.023 +- 0.175 (in-sample avg dev_std = 0.219)
NEC for r=0.8 all KL = 0.05 +- 0.175 (in-sample avg dev_std = 0.219)
NEC for r=0.8 all L1 = 0.023 +- 0.082 (in-sample avg dev_std = 0.219)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04935858995137764
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 1.0 = 0.007 +- 0.092 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.009 +- 0.092 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.007 +- 0.079 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05854011345218801
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.989
NEC for r=0.1 class 1.0 = 0.012 +- 0.118 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all KL = 0.014 +- 0.118 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all L1 = 0.012 +- 0.099 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07189708265802269
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.976
NEC for r=0.2 class 1.0 = 0.023 +- 0.166 (in-sample avg dev_std = 0.091)
NEC for r=0.2 all KL = 0.03 +- 0.166 (in-sample avg dev_std = 0.091)
NEC for r=0.2 all L1 = 0.023 +- 0.135 (in-sample avg dev_std = 0.091)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09092666126418153
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.969
NEC for r=0.4 class 1.0 = 0.032 +- 0.197 (in-sample avg dev_std = 0.145)
NEC for r=0.4 all KL = 0.046 +- 0.197 (in-sample avg dev_std = 0.145)
NEC for r=0.4 all L1 = 0.032 +- 0.148 (in-sample avg dev_std = 0.145)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10760777957860616
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.962
NEC for r=0.8 class 1.0 = 0.048 +- 0.249 (in-sample avg dev_std = 0.269)
NEC for r=0.8 all KL = 0.087 +- 0.249 (in-sample avg dev_std = 0.269)
NEC for r=0.8 all L1 = 0.048 +- 0.154 (in-sample avg dev_std = 0.269)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:16:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:16:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.074
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.087
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.095
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.100
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.101
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.044
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.056
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07385920577617329
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.932
SUFF_SIMPLE for r=0.05 class 1.0 = 0.903 +- 0.312 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.826 +- 0.312 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.903 +- 0.189 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08676895306859204
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.934
SUFF_SIMPLE for r=0.1 class 1.0 = 0.909 +- 0.303 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.1 all KL = 0.838 +- 0.303 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.1 all L1 = 0.909 +- 0.187 (in-sample avg dev_std = 0.407)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09529241877256318
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.926
SUFF_SIMPLE for r=0.2 class 1.0 = 0.911 +- 0.297 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.2 all KL = 0.851 +- 0.297 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.2 all L1 = 0.911 +- 0.202 (in-sample avg dev_std = 0.354)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1001768953068592
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.936
SUFF_SIMPLE for r=0.4 class 1.0 = 0.927 +- 0.278 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.278 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.196 (in-sample avg dev_std = 0.297)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10087364620938628
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.986
SUFF_SIMPLE for r=0.8 class 1.0 = 0.984 +- 0.136 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 all KL = 0.978 +- 0.136 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 all L1 = 0.984 +- 0.104 (in-sample avg dev_std = 0.101)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.86
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012636507936507937
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.857
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.073 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.05 all KL = 0.989 +- 0.073 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.05 all L1 = 0.995 +- 0.035 (in-sample avg dev_std = 0.106)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012714682539682541
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.857
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.074 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 all KL = 0.989 +- 0.074 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.034 (in-sample avg dev_std = 0.104)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.86
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012746428571428572
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.857
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.076 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all KL = 0.989 +- 0.076 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all L1 = 0.995 +- 0.037 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.86
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012764682539682541
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.857
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.070 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.4 all KL = 0.99 +- 0.070 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.4 all L1 = 0.995 +- 0.033 (in-sample avg dev_std = 0.100)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.86
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012760714285714287
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.855
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.074 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.8 all KL = 0.994 +- 0.074 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.8 all L1 = 0.995 +- 0.060 (in-sample avg dev_std = 0.054)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044214748784440844
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.946
SUFF_SIMPLE for r=0.05 class 1.0 = 0.924 +- 0.284 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.05 all KL = 0.873 +- 0.284 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.05 all L1 = 0.924 +- 0.187 (in-sample avg dev_std = 0.344)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.055960696920583475
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.948
SUFF_SIMPLE for r=0.1 class 1.0 = 0.933 +- 0.268 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.1 all KL = 0.893 +- 0.268 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.1 all L1 = 0.933 +- 0.188 (in-sample avg dev_std = 0.288)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07071272285251216
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.945
SUFF_SIMPLE for r=0.2 class 1.0 = 0.939 +- 0.255 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 all KL = 0.911 +- 0.255 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 all L1 = 0.939 +- 0.191 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08842260940032413
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.946
SUFF_SIMPLE for r=0.4 class 1.0 = 0.944 +- 0.246 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.923 +- 0.246 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.191)


ratio=0.8


40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10786304700162075
len(reference) = 2464
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.946
SUFF_SIMPLE for r=0.8 class 1.0 = 0.954 +- 0.224 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 all KL = 0.946 +- 0.224 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.192 (in-sample avg dev_std = 0.058)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07385920577617329
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.986
NEC for r=0.05 class 1.0 = 0.012 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.014 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.012 +- 0.103 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08676895306859204
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 1.0 = 0.017 +- 0.142 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all KL = 0.021 +- 0.142 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all L1 = 0.017 +- 0.117 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09529241877256318
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.969
NEC for r=0.2 class 1.0 = 0.03 +- 0.187 (in-sample avg dev_std = 0.133)
NEC for r=0.2 all KL = 0.038 +- 0.187 (in-sample avg dev_std = 0.133)
NEC for r=0.2 all L1 = 0.03 +- 0.149 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.1001768953068592
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.958
NEC for r=0.4 class 1.0 = 0.046 +- 0.230 (in-sample avg dev_std = 0.223)
NEC for r=0.4 all KL = 0.07 +- 0.230 (in-sample avg dev_std = 0.223)
NEC for r=0.4 all L1 = 0.046 +- 0.166 (in-sample avg dev_std = 0.223)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10087364620938628
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.963
NEC for r=0.8 class 1.0 = 0.05 +- 0.241 (in-sample avg dev_std = 0.302)
NEC for r=0.8 all KL = 0.086 +- 0.241 (in-sample avg dev_std = 0.302)
NEC for r=0.8 all L1 = 0.05 +- 0.149 (in-sample avg dev_std = 0.302)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.86
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012636507936507937
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.86
NEC for r=0.05 class 1.0 = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.020 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.018 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.86
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012714682539682541
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.859
NEC for r=0.1 class 1.0 = 0.001 +- 0.037 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all KL = 0.002 +- 0.037 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all L1 = 0.001 +- 0.025 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.86
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012746428571428572
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.857
NEC for r=0.2 class 1.0 = 0.004 +- 0.068 (in-sample avg dev_std = 0.088)
NEC for r=0.2 all KL = 0.007 +- 0.068 (in-sample avg dev_std = 0.088)
NEC for r=0.2 all L1 = 0.004 +- 0.038 (in-sample avg dev_std = 0.088)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.86
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012764682539682541
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.858
NEC for r=0.4 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.083)
NEC for r=0.4 all KL = 0.006 +- 0.060 (in-sample avg dev_std = 0.083)
NEC for r=0.4 all L1 = 0.003 +- 0.029 (in-sample avg dev_std = 0.083)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.86
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012760714285714287
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.858
NEC for r=0.8 class 1.0 = 0.003 +- 0.052 (in-sample avg dev_std = 0.073)
NEC for r=0.8 all KL = 0.005 +- 0.052 (in-sample avg dev_std = 0.073)
NEC for r=0.8 all L1 = 0.003 +- 0.025 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044214748784440844
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 1.0 = 0.015 +- 0.128 (in-sample avg dev_std = 0.026)
NEC for r=0.05 all KL = 0.017 +- 0.128 (in-sample avg dev_std = 0.026)
NEC for r=0.05 all L1 = 0.015 +- 0.110 (in-sample avg dev_std = 0.026)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.055960696920583475
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.982
NEC for r=0.1 class 1.0 = 0.018 +- 0.144 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all KL = 0.022 +- 0.144 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all L1 = 0.018 +- 0.122 (in-sample avg dev_std = 0.058)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07071272285251216
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.973
NEC for r=0.2 class 1.0 = 0.027 +- 0.173 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.033 +- 0.173 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.027 +- 0.145 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08842260940032413
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.96
NEC for r=0.4 class 1.0 = 0.042 +- 0.215 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.055 +- 0.215 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.042 +- 0.173 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10786304700162075
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.961
NEC for r=0.8 class 1.0 = 0.053 +- 0.243 (in-sample avg dev_std = 0.262)
NEC for r=0.8 all KL = 0.085 +- 0.243 (in-sample avg dev_std = 0.262)
NEC for r=0.8 all L1 = 0.053 +- 0.168 (in-sample avg dev_std = 0.262)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:21:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:21:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.072
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.081
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.081
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.088
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.012
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.046
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.087
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07235379061371841
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.867
SUFF_SIMPLE for r=0.05 class 1.0 = 0.814 +- 0.341 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all KL = 0.697 +- 0.341 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all L1 = 0.814 +- 0.224 (in-sample avg dev_std = 0.567)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08079783393501805
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.861
SUFF_SIMPLE for r=0.1 class 1.0 = 0.81 +- 0.337 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 all KL = 0.697 +- 0.337 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.1 all L1 = 0.81 +- 0.233 (in-sample avg dev_std = 0.547)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08149097472924188
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.857
SUFF_SIMPLE for r=0.2 class 1.0 = 0.815 +- 0.351 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.2 all KL = 0.716 +- 0.351 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.2 all L1 = 0.815 +- 0.248 (in-sample avg dev_std = 0.515)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08770758122743683
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.842
SUFF_SIMPLE for r=0.4 class 1.0 = 0.815 +- 0.362 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.4 all KL = 0.731 +- 0.362 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.4 all L1 = 0.815 +- 0.272 (in-sample avg dev_std = 0.462)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09398194945848376
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.928
SUFF_SIMPLE for r=0.8 class 1.0 = 0.919 +- 0.274 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 all KL = 0.89 +- 0.274 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.206 (in-sample avg dev_std = 0.274)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011840079365079364
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.361
SUFF_SIMPLE for r=0.05 class 1.0 = 0.494 +- 0.352 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.05 all KL = 0.358 +- 0.352 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.231 (in-sample avg dev_std = 0.774)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012061507936507936
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.366
SUFF_SIMPLE for r=0.1 class 1.0 = 0.495 +- 0.349 (in-sample avg dev_std = 0.781)
SUFF_SIMPLE for r=0.1 all KL = 0.357 +- 0.349 (in-sample avg dev_std = 0.781)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.227 (in-sample avg dev_std = 0.781)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012176984126984128
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.362
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.349 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.2 all KL = 0.355 +- 0.349 (in-sample avg dev_std = 0.777)
SUFF_SIMPLE for r=0.2 all L1 = 0.493 +- 0.229 (in-sample avg dev_std = 0.777)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012189285714285715
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.357
SUFF_SIMPLE for r=0.4 class 1.0 = 0.492 +- 0.352 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.4 all KL = 0.357 +- 0.352 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.4 all L1 = 0.492 +- 0.234 (in-sample avg dev_std = 0.765)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.01219920634920635
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.319
SUFF_SIMPLE for r=0.8 class 1.0 = 0.548 +- 0.438 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.8 all KL = 0.498 +- 0.438 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.8 all L1 = 0.548 +- 0.363 (in-sample avg dev_std = 0.334)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046019854132901133
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.938
SUFF_SIMPLE for r=0.05 class 1.0 = 0.905 +- 0.290 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.05 all KL = 0.855 +- 0.290 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.05 all L1 = 0.905 +- 0.207 (in-sample avg dev_std = 0.356)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05863371150729335
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.927
SUFF_SIMPLE for r=0.1 class 1.0 = 0.901 +- 0.294 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all KL = 0.856 +- 0.294 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all L1 = 0.901 +- 0.222 (in-sample avg dev_std = 0.315)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07184319286871962
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.924
SUFF_SIMPLE for r=0.2 class 1.0 = 0.912 +- 0.283 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.2 all KL = 0.88 +- 0.283 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.2 all L1 = 0.912 +- 0.221 (in-sample avg dev_std = 0.255)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08737965964343598
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 1.0 = 0.905 +- 0.293 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 all KL = 0.873 +- 0.293 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 all L1 = 0.905 +- 0.233 (in-sample avg dev_std = 0.256)


ratio=0.8


40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1068634521880065
len(reference) = 2465
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.817
SUFF_SIMPLE for r=0.8 class 1.0 = 0.844 +- 0.375 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all KL = 0.822 +- 0.375 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all L1 = 0.844 +- 0.326 (in-sample avg dev_std = 0.030)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07235379061371841
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08079783393501805
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.002 +- 0.018 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all KL = 0.001 +- 0.018 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all L1 = 0.002 +- 0.014 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08149097472924188
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.991
NEC for r=0.2 class 1.0 = 0.015 +- 0.114 (in-sample avg dev_std = 0.124)
NEC for r=0.2 all KL = 0.022 +- 0.114 (in-sample avg dev_std = 0.124)
NEC for r=0.2 all L1 = 0.015 +- 0.076 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08770758122743683
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.963
NEC for r=0.4 class 1.0 = 0.047 +- 0.223 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all KL = 0.07 +- 0.223 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all L1 = 0.047 +- 0.155 (in-sample avg dev_std = 0.255)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09398194945848376
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.946
NEC for r=0.8 class 1.0 = 0.071 +- 0.259 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all KL = 0.111 +- 0.259 (in-sample avg dev_std = 0.328)
NEC for r=0.8 all L1 = 0.071 +- 0.176 (in-sample avg dev_std = 0.328)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.011840079365079364
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.633
NEC for r=0.05 class 1.0 = 0.149 +- 0.317 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.147 +- 0.317 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.149 +- 0.279 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012061507936507936
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.42
NEC for r=0.1 class 1.0 = 0.365 +- 0.424 (in-sample avg dev_std = 0.288)
NEC for r=0.1 all KL = 0.399 +- 0.424 (in-sample avg dev_std = 0.288)
NEC for r=0.1 all L1 = 0.365 +- 0.354 (in-sample avg dev_std = 0.288)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012176984126984128
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.395
NEC for r=0.2 class 1.0 = 0.449 +- 0.379 (in-sample avg dev_std = 0.647)
NEC for r=0.2 all KL = 0.553 +- 0.379 (in-sample avg dev_std = 0.647)
NEC for r=0.2 all L1 = 0.449 +- 0.275 (in-sample avg dev_std = 0.647)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012189285714285715
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.392
NEC for r=0.4 class 1.0 = 0.461 +- 0.365 (in-sample avg dev_std = 0.694)
NEC for r=0.4 all KL = 0.576 +- 0.365 (in-sample avg dev_std = 0.694)
NEC for r=0.4 all L1 = 0.461 +- 0.257 (in-sample avg dev_std = 0.694)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.01219920634920635
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.388
NEC for r=0.8 class 1.0 = 0.469 +- 0.361 (in-sample avg dev_std = 0.707)
NEC for r=0.8 all KL = 0.589 +- 0.361 (in-sample avg dev_std = 0.707)
NEC for r=0.8 all L1 = 0.469 +- 0.250 (in-sample avg dev_std = 0.707)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046019854132901133
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.968
NEC for r=0.05 class 1.0 = 0.022 +- 0.145 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.024 +- 0.145 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.022 +- 0.127 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05863371150729335
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.966
NEC for r=0.1 class 1.0 = 0.027 +- 0.161 (in-sample avg dev_std = 0.068)
NEC for r=0.1 all KL = 0.031 +- 0.161 (in-sample avg dev_std = 0.068)
NEC for r=0.1 all L1 = 0.027 +- 0.139 (in-sample avg dev_std = 0.068)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07184319286871962
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.958
NEC for r=0.2 class 1.0 = 0.04 +- 0.198 (in-sample avg dev_std = 0.084)
NEC for r=0.2 all KL = 0.047 +- 0.198 (in-sample avg dev_std = 0.084)
NEC for r=0.2 all L1 = 0.04 +- 0.168 (in-sample avg dev_std = 0.084)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08737965964343598
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.942
NEC for r=0.4 class 1.0 = 0.06 +- 0.242 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all KL = 0.075 +- 0.242 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all L1 = 0.06 +- 0.201 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1068634521880065
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.947
NEC for r=0.8 class 1.0 = 0.075 +- 0.267 (in-sample avg dev_std = 0.268)
NEC for r=0.8 all KL = 0.105 +- 0.267 (in-sample avg dev_std = 0.268)
NEC for r=0.8 all L1 = 0.075 +- 0.203 (in-sample avg dev_std = 0.268)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:27:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:27:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.075
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.080
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.081
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.089
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.090
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.050
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.060
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.074
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0753104693140794
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.967
SUFF_SIMPLE for r=0.05 class 1.0 = 0.954 +- 0.243 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 all KL = 0.91 +- 0.243 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.140 (in-sample avg dev_std = 0.292)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08007581227436823
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.96
SUFF_SIMPLE for r=0.1 class 1.0 = 0.954 +- 0.239 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 all KL = 0.922 +- 0.239 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.159 (in-sample avg dev_std = 0.224)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08079422382671479
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.971
SUFF_SIMPLE for r=0.2 class 1.0 = 0.967 +- 0.203 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all KL = 0.944 +- 0.203 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.2 all L1 = 0.967 +- 0.137 (in-sample avg dev_std = 0.187)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08869675090252707
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.985
SUFF_SIMPLE for r=0.4 class 1.0 = 0.981 +- 0.159 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.159 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 all L1 = 0.981 +- 0.096 (in-sample avg dev_std = 0.164)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09033212996389893
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.977
SUFF_SIMPLE for r=0.8 class 1.0 = 0.978 +- 0.159 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.159 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all L1 = 0.978 +- 0.131 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.891
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012490079365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.884
SUFF_SIMPLE for r=0.05 class 1.0 = 0.988 +- 0.111 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all KL = 0.976 +- 0.111 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all L1 = 0.988 +- 0.049 (in-sample avg dev_std = 0.145)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012537698412698412
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.883
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.112 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 all KL = 0.975 +- 0.112 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.049 (in-sample avg dev_std = 0.147)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.891
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012501587301587302
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.883
SUFF_SIMPLE for r=0.2 class 1.0 = 0.987 +- 0.118 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all KL = 0.973 +- 0.118 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.2 all L1 = 0.987 +- 0.050 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.891
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012491269841269841
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.883
SUFF_SIMPLE for r=0.4 class 1.0 = 0.988 +- 0.110 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all KL = 0.977 +- 0.110 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.4 all L1 = 0.988 +- 0.049 (in-sample avg dev_std = 0.145)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.891
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012491269841269841
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.884
SUFF_SIMPLE for r=0.8 class 1.0 = 0.993 +- 0.088 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all KL = 0.991 +- 0.088 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.069 (in-sample avg dev_std = 0.057)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05038411669367909
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.95
SUFF_SIMPLE for r=0.05 class 1.0 = 0.933 +- 0.283 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all KL = 0.873 +- 0.283 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all L1 = 0.933 +- 0.168 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06037034035656403
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.957
SUFF_SIMPLE for r=0.1 class 1.0 = 0.945 +- 0.256 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all KL = 0.895 +- 0.256 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all L1 = 0.945 +- 0.156 (in-sample avg dev_std = 0.283)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0736482982171799
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.964
SUFF_SIMPLE for r=0.2 class 1.0 = 0.955 +- 0.231 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all KL = 0.916 +- 0.231 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all L1 = 0.955 +- 0.143 (in-sample avg dev_std = 0.243)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09099473257698541
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.971
SUFF_SIMPLE for r=0.4 class 1.0 = 0.957 +- 0.232 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.4 all KL = 0.913 +- 0.232 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.4 all L1 = 0.957 +- 0.127 (in-sample avg dev_std = 0.272)


ratio=0.8


40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10704254457050245
len(reference) = 2466
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.776
SUFF_SIMPLE for r=0.8 class 1.0 = 0.806 +- 0.416 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all KL = 0.775 +- 0.416 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all L1 = 0.806 +- 0.360 (in-sample avg dev_std = 0.035)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0753104693140794
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.08007581227436823
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08079422382671479
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.996
NEC for r=0.2 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.004 +- 0.060 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08869675090252707
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.994
NEC for r=0.4 class 1.0 = 0.007 +- 0.095 (in-sample avg dev_std = 0.086)
NEC for r=0.4 all KL = 0.012 +- 0.095 (in-sample avg dev_std = 0.086)
NEC for r=0.4 all L1 = 0.007 +- 0.062 (in-sample avg dev_std = 0.086)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09033212996389893
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.987
NEC for r=0.8 class 1.0 = 0.021 +- 0.176 (in-sample avg dev_std = 0.215)
NEC for r=0.8 all KL = 0.048 +- 0.176 (in-sample avg dev_std = 0.215)
NEC for r=0.8 all L1 = 0.021 +- 0.082 (in-sample avg dev_std = 0.215)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.891
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012490079365079365
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.889
NEC for r=0.05 class 1.0 = 0.001 +- 0.036 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.001 +- 0.036 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.001 +- 0.033 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.891
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012537698412698412
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.888
NEC for r=0.1 class 1.0 = 0.003 +- 0.050 (in-sample avg dev_std = 0.026)
NEC for r=0.1 all KL = 0.003 +- 0.050 (in-sample avg dev_std = 0.026)
NEC for r=0.1 all L1 = 0.003 +- 0.043 (in-sample avg dev_std = 0.026)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.891
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.012501587301587302
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.888
NEC for r=0.2 class 1.0 = 0.004 +- 0.058 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.005 +- 0.058 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.004 +- 0.034 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.891
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012491269841269841
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.889
NEC for r=0.4 class 1.0 = 0.004 +- 0.058 (in-sample avg dev_std = 0.073)
NEC for r=0.4 all KL = 0.006 +- 0.058 (in-sample avg dev_std = 0.073)
NEC for r=0.4 all L1 = 0.004 +- 0.029 (in-sample avg dev_std = 0.073)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.891
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012491269841269841
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.889
NEC for r=0.8 class 1.0 = 0.003 +- 0.058 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all KL = 0.006 +- 0.058 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all L1 = 0.003 +- 0.027 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05038411669367909
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.991
NEC for r=0.05 class 1.0 = 0.008 +- 0.095 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all KL = 0.009 +- 0.095 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all L1 = 0.008 +- 0.079 (in-sample avg dev_std = 0.028)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06037034035656403
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.991
NEC for r=0.1 class 1.0 = 0.009 +- 0.104 (in-sample avg dev_std = 0.065)
NEC for r=0.1 all KL = 0.012 +- 0.104 (in-sample avg dev_std = 0.065)
NEC for r=0.1 all L1 = 0.009 +- 0.083 (in-sample avg dev_std = 0.065)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0736482982171799
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.989
NEC for r=0.2 class 1.0 = 0.013 +- 0.128 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all KL = 0.019 +- 0.128 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all L1 = 0.013 +- 0.090 (in-sample avg dev_std = 0.111)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09099473257698541
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.988
NEC for r=0.4 class 1.0 = 0.015 +- 0.143 (in-sample avg dev_std = 0.143)
NEC for r=0.4 all KL = 0.028 +- 0.143 (in-sample avg dev_std = 0.143)
NEC for r=0.4 all L1 = 0.015 +- 0.089 (in-sample avg dev_std = 0.143)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10704254457050245
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.977
NEC for r=0.8 class 1.0 = 0.029 +- 0.195 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all KL = 0.054 +- 0.195 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all L1 = 0.029 +- 0.121 (in-sample avg dev_std = 0.201)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:32:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:32:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.064
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.075
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.084
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.091
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.014
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.014
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.046
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.089
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.107


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055974729241877255
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.915
SUFF_SIMPLE for r=0.05 class 1.0 = 0.883 +- 0.346 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.05 all KL = 0.785 +- 0.346 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.05 all L1 = 0.883 +- 0.209 (in-sample avg dev_std = 0.465)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06358844765342961
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.917
SUFF_SIMPLE for r=0.1 class 1.0 = 0.891 +- 0.336 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all KL = 0.802 +- 0.336 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all L1 = 0.891 +- 0.207 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07472202166064983
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.879
SUFF_SIMPLE for r=0.2 class 1.0 = 0.858 +- 0.370 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.2 all KL = 0.766 +- 0.370 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.2 all L1 = 0.858 +- 0.251 (in-sample avg dev_std = 0.428)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0842418772563177
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.907
SUFF_SIMPLE for r=0.4 class 1.0 = 0.895 +- 0.330 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.330 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.4 all L1 = 0.895 +- 0.232 (in-sample avg dev_std = 0.339)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09085559566787005
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.965
SUFF_SIMPLE for r=0.8 class 1.0 = 0.968 +- 0.192 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.96 +- 0.192 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.968 +- 0.158 (in-sample avg dev_std = 0.089)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.94
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013423809523809525
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.727
SUFF_SIMPLE for r=0.05 class 1.0 = 0.7 +- 0.352 (in-sample avg dev_std = 0.730)
SUFF_SIMPLE for r=0.05 all KL = 0.51 +- 0.352 (in-sample avg dev_std = 0.730)
SUFF_SIMPLE for r=0.05 all L1 = 0.7 +- 0.213 (in-sample avg dev_std = 0.730)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013458730158730158
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.729
SUFF_SIMPLE for r=0.1 class 1.0 = 0.703 +- 0.350 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.1 all KL = 0.511 +- 0.350 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.1 all L1 = 0.703 +- 0.211 (in-sample avg dev_std = 0.729)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.94
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01355952380952381
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.731
SUFF_SIMPLE for r=0.2 class 1.0 = 0.707 +- 0.349 (in-sample avg dev_std = 0.723)
SUFF_SIMPLE for r=0.2 all KL = 0.518 +- 0.349 (in-sample avg dev_std = 0.723)
SUFF_SIMPLE for r=0.2 all L1 = 0.707 +- 0.212 (in-sample avg dev_std = 0.723)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.94
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013532539682539684
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.72
SUFF_SIMPLE for r=0.4 class 1.0 = 0.695 +- 0.357 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.4 all KL = 0.507 +- 0.357 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.4 all L1 = 0.695 +- 0.221 (in-sample avg dev_std = 0.732)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.94
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013536507936507937
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.729
SUFF_SIMPLE for r=0.8 class 1.0 = 0.788 +- 0.400 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.8 all KL = 0.733 +- 0.400 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.8 all L1 = 0.788 +- 0.325 (in-sample avg dev_std = 0.340)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046376418152350087
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.935
SUFF_SIMPLE for r=0.05 class 1.0 = 0.909 +- 0.315 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.05 all KL = 0.848 +- 0.315 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.05 all L1 = 0.909 +- 0.210 (in-sample avg dev_std = 0.357)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057987844408427865
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.932
SUFF_SIMPLE for r=0.1 class 1.0 = 0.917 +- 0.301 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.212 (in-sample avg dev_std = 0.297)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0724663695299838
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.935
SUFF_SIMPLE for r=0.2 class 1.0 = 0.932 +- 0.274 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.2 all KL = 0.895 +- 0.274 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.2 all L1 = 0.932 +- 0.199 (in-sample avg dev_std = 0.250)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08920502431118316
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.942
SUFF_SIMPLE for r=0.4 class 1.0 = 0.934 +- 0.270 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all KL = 0.907 +- 0.270 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all L1 = 0.934 +- 0.208 (in-sample avg dev_std = 0.206)


ratio=0.8


40 5 0
40 5 0
40 5 0
40 5 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1072597244732577
len(reference) = 2461
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.845
SUFF_SIMPLE for r=0.8 class 1.0 = 0.871 +- 0.355 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.8 all KL = 0.851 +- 0.355 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.8 all L1 = 0.871 +- 0.306 (in-sample avg dev_std = 0.042)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055974729241877255
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.001 +- 0.026 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.026 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.001 +- 0.018 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06358844765342961
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.992
NEC for r=0.1 class 1.0 = 0.006 +- 0.085 (in-sample avg dev_std = 0.026)
NEC for r=0.1 all KL = 0.008 +- 0.085 (in-sample avg dev_std = 0.026)
NEC for r=0.1 all L1 = 0.006 +- 0.067 (in-sample avg dev_std = 0.026)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07472202166064983
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.995
NEC for r=0.2 class 1.0 = 0.006 +- 0.091 (in-sample avg dev_std = 0.104)
NEC for r=0.2 all KL = 0.011 +- 0.091 (in-sample avg dev_std = 0.104)
NEC for r=0.2 all L1 = 0.006 +- 0.057 (in-sample avg dev_std = 0.104)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0842418772563177
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.972
NEC for r=0.4 class 1.0 = 0.03 +- 0.191 (in-sample avg dev_std = 0.172)
NEC for r=0.4 all KL = 0.044 +- 0.191 (in-sample avg dev_std = 0.172)
NEC for r=0.4 all L1 = 0.03 +- 0.142 (in-sample avg dev_std = 0.172)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09085559566787005
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.968
NEC for r=0.8 class 1.0 = 0.045 +- 0.239 (in-sample avg dev_std = 0.287)
NEC for r=0.8 all KL = 0.082 +- 0.239 (in-sample avg dev_std = 0.287)
NEC for r=0.8 all L1 = 0.045 +- 0.139 (in-sample avg dev_std = 0.287)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.94
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013423809523809525
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.934
NEC for r=0.05 class 1.0 = 0.005 +- 0.070 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.005 +- 0.070 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.005 +- 0.064 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.94
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013458730158730158
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.907
NEC for r=0.1 class 1.0 = 0.031 +- 0.176 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.038 +- 0.176 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.031 +- 0.147 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.94
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01355952380952381
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.902
NEC for r=0.2 class 1.0 = 0.051 +- 0.229 (in-sample avg dev_std = 0.295)
NEC for r=0.2 all KL = 0.085 +- 0.229 (in-sample avg dev_std = 0.295)
NEC for r=0.2 all L1 = 0.051 +- 0.141 (in-sample avg dev_std = 0.295)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.94
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013532539682539684
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.904
NEC for r=0.4 class 1.0 = 0.052 +- 0.224 (in-sample avg dev_std = 0.310)
NEC for r=0.4 all KL = 0.094 +- 0.224 (in-sample avg dev_std = 0.310)
NEC for r=0.4 all L1 = 0.052 +- 0.125 (in-sample avg dev_std = 0.310)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.94
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013536507936507937
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.902
NEC for r=0.8 class 1.0 = 0.057 +- 0.231 (in-sample avg dev_std = 0.324)
NEC for r=0.8 all KL = 0.103 +- 0.231 (in-sample avg dev_std = 0.324)
NEC for r=0.8 all L1 = 0.057 +- 0.128 (in-sample avg dev_std = 0.324)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046376418152350087
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 1.0 = 0.012 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.014 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.012 +- 0.099 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057987844408427865
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 1.0 = 0.014 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.016 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.014 +- 0.110 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0724663695299838
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.966
NEC for r=0.2 class 1.0 = 0.032 +- 0.187 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.037 +- 0.187 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.032 +- 0.161 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08920502431118316
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.951
NEC for r=0.4 class 1.0 = 0.052 +- 0.238 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all KL = 0.065 +- 0.238 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all L1 = 0.052 +- 0.197 (in-sample avg dev_std = 0.114)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.1072597244732577
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.956
NEC for r=0.8 class 1.0 = 0.064 +- 0.272 (in-sample avg dev_std = 0.266)
NEC for r=0.8 all KL = 0.101 +- 0.272 (in-sample avg dev_std = 0.266)
NEC for r=0.8 all L1 = 0.064 +- 0.190 (in-sample avg dev_std = 0.266)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:38:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:38:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.067
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.073
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.088
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.091
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.014
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.014
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.049
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.060
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.076
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.092
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.109


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06663176895306859
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.673
SUFF_SIMPLE for r=0.05 class 1.0 = 0.607 +- 0.404 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.05 all KL = 0.382 +- 0.404 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.05 all L1 = 0.607 +- 0.298 (in-sample avg dev_std = 0.767)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07288808664259928
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.673
SUFF_SIMPLE for r=0.1 class 1.0 = 0.614 +- 0.408 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.1 all KL = 0.399 +- 0.408 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.1 all L1 = 0.614 +- 0.306 (in-sample avg dev_std = 0.742)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08837184115523465
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.688
SUFF_SIMPLE for r=0.2 class 1.0 = 0.644 +- 0.434 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.2 all KL = 0.46 +- 0.434 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.2 all L1 = 0.644 +- 0.324 (in-sample avg dev_std = 0.680)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09068953068592057
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.702
SUFF_SIMPLE for r=0.4 class 1.0 = 0.662 +- 0.428 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.4 all KL = 0.479 +- 0.428 (in-sample avg dev_std = 0.647)
SUFF_SIMPLE for r=0.4 all L1 = 0.662 +- 0.323 (in-sample avg dev_std = 0.647)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09361732851985559
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.819
SUFF_SIMPLE for r=0.8 class 1.0 = 0.829 +- 0.401 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.8 all KL = 0.779 +- 0.401 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.8 all L1 = 0.829 +- 0.324 (in-sample avg dev_std = 0.273)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013957936507936511
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.634
SUFF_SIMPLE for r=0.05 class 1.0 = 0.547 +- 0.311 (in-sample avg dev_std = 0.857)
SUFF_SIMPLE for r=0.05 all KL = 0.317 +- 0.311 (in-sample avg dev_std = 0.857)
SUFF_SIMPLE for r=0.05 all L1 = 0.547 +- 0.229 (in-sample avg dev_std = 0.857)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013938095238095239
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.636
SUFF_SIMPLE for r=0.1 class 1.0 = 0.549 +- 0.320 (in-sample avg dev_std = 0.856)
SUFF_SIMPLE for r=0.1 all KL = 0.322 +- 0.320 (in-sample avg dev_std = 0.856)
SUFF_SIMPLE for r=0.1 all L1 = 0.549 +- 0.234 (in-sample avg dev_std = 0.856)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01389325396825397
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.636
SUFF_SIMPLE for r=0.2 class 1.0 = 0.551 +- 0.320 (in-sample avg dev_std = 0.851)
SUFF_SIMPLE for r=0.2 all KL = 0.325 +- 0.320 (in-sample avg dev_std = 0.851)
SUFF_SIMPLE for r=0.2 all L1 = 0.551 +- 0.235 (in-sample avg dev_std = 0.851)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013865873015873015
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.635
SUFF_SIMPLE for r=0.4 class 1.0 = 0.556 +- 0.336 (in-sample avg dev_std = 0.834)
SUFF_SIMPLE for r=0.4 all KL = 0.34 +- 0.336 (in-sample avg dev_std = 0.834)
SUFF_SIMPLE for r=0.4 all L1 = 0.556 +- 0.248 (in-sample avg dev_std = 0.834)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013863095238095239
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.661
SUFF_SIMPLE for r=0.8 class 1.0 = 0.685 +- 0.451 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.8 all KL = 0.615 +- 0.451 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.8 all L1 = 0.685 +- 0.380 (in-sample avg dev_std = 0.364)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.966
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04896839546191248
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.798
SUFF_SIMPLE for r=0.05 class 1.0 = 0.788 +- 0.420 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.05 all KL = 0.683 +- 0.420 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.05 all L1 = 0.788 +- 0.310 (in-sample avg dev_std = 0.479)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06017139384116693
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.82
SUFF_SIMPLE for r=0.1 class 1.0 = 0.807 +- 0.413 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 all KL = 0.723 +- 0.413 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 all L1 = 0.807 +- 0.313 (in-sample avg dev_std = 0.422)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.966
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0760692868719611
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.84
SUFF_SIMPLE for r=0.2 class 1.0 = 0.827 +- 0.399 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 all KL = 0.761 +- 0.399 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 all L1 = 0.827 +- 0.311 (in-sample avg dev_std = 0.363)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.966
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09234238249594814
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.817
SUFF_SIMPLE for r=0.4 class 1.0 = 0.815 +- 0.407 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all KL = 0.756 +- 0.407 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all L1 = 0.815 +- 0.327 (in-sample avg dev_std = 0.305)


ratio=0.8


40 5 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.966
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10874959481361426
len(reference) = 2462
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.809
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.385 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 all KL = 0.816 +- 0.385 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 all L1 = 0.841 +- 0.332 (in-sample avg dev_std = 0.061)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06663176895306859
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 1.0 = 0.02 +- 0.150 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.024 +- 0.150 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.02 +- 0.128 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07288808664259928
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.921
NEC for r=0.1 class 1.0 = 0.074 +- 0.286 (in-sample avg dev_std = 0.185)
NEC for r=0.1 all KL = 0.098 +- 0.286 (in-sample avg dev_std = 0.185)
NEC for r=0.1 all L1 = 0.074 +- 0.225 (in-sample avg dev_std = 0.185)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08837184115523465
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.864
NEC for r=0.2 class 1.0 = 0.137 +- 0.371 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all KL = 0.188 +- 0.371 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all L1 = 0.137 +- 0.287 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09068953068592057
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.843
NEC for r=0.4 class 1.0 = 0.176 +- 0.404 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all KL = 0.268 +- 0.404 (in-sample avg dev_std = 0.454)
NEC for r=0.4 all L1 = 0.176 +- 0.290 (in-sample avg dev_std = 0.454)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09361732851985559
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.841
NEC for r=0.8 class 1.0 = 0.198 +- 0.411 (in-sample avg dev_std = 0.564)
NEC for r=0.8 all KL = 0.331 +- 0.411 (in-sample avg dev_std = 0.564)
NEC for r=0.8 all L1 = 0.198 +- 0.273 (in-sample avg dev_std = 0.564)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013957936507936511
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.986
NEC for r=0.05 class 1.0 = 0.012 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.014 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.012 +- 0.100 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013938095238095239
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.928
NEC for r=0.1 class 1.0 = 0.068 +- 0.264 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all KL = 0.084 +- 0.264 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all L1 = 0.068 +- 0.218 (in-sample avg dev_std = 0.180)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01389325396825397
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.92
NEC for r=0.2 class 1.0 = 0.104 +- 0.319 (in-sample avg dev_std = 0.418)
NEC for r=0.2 all KL = 0.171 +- 0.319 (in-sample avg dev_std = 0.418)
NEC for r=0.2 all L1 = 0.104 +- 0.206 (in-sample avg dev_std = 0.418)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013865873015873015
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.917
NEC for r=0.4 class 1.0 = 0.116 +- 0.326 (in-sample avg dev_std = 0.466)
NEC for r=0.4 all KL = 0.202 +- 0.326 (in-sample avg dev_std = 0.466)
NEC for r=0.4 all L1 = 0.116 +- 0.197 (in-sample avg dev_std = 0.466)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013863095238095239
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.914
NEC for r=0.8 class 1.0 = 0.122 +- 0.326 (in-sample avg dev_std = 0.480)
NEC for r=0.8 all KL = 0.216 +- 0.326 (in-sample avg dev_std = 0.480)
NEC for r=0.8 all L1 = 0.122 +- 0.193 (in-sample avg dev_std = 0.480)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.966
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04896839546191248
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.94
NEC for r=0.05 class 1.0 = 0.039 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.045 +- 0.205 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.039 +- 0.178 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.966
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06017139384116693
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.935
NEC for r=0.1 class 1.0 = 0.051 +- 0.233 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all KL = 0.059 +- 0.233 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all L1 = 0.051 +- 0.201 (in-sample avg dev_std = 0.047)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.966
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0760692868719611
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.9
NEC for r=0.2 class 1.0 = 0.084 +- 0.294 (in-sample avg dev_std = 0.096)
NEC for r=0.2 all KL = 0.099 +- 0.294 (in-sample avg dev_std = 0.096)
NEC for r=0.2 all L1 = 0.084 +- 0.250 (in-sample avg dev_std = 0.096)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.966
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09234238249594814
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.866
NEC for r=0.4 class 1.0 = 0.132 +- 0.360 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all KL = 0.17 +- 0.360 (in-sample avg dev_std = 0.231)
NEC for r=0.4 all L1 = 0.132 +- 0.293 (in-sample avg dev_std = 0.231)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.966
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10874959481361426
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.86
NEC for r=0.8 class 1.0 = 0.16 +- 0.392 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all KL = 0.234 +- 0.392 (in-sample avg dev_std = 0.408)
NEC for r=0.8 all L1 = 0.16 +- 0.289 (in-sample avg dev_std = 0.408)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:44:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:44:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.072
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.078
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.094
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.097
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.101
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.013
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.045
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.055
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.087
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.108


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07236462093862815
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.811
SUFF_SIMPLE for r=0.05 class 1.0 = 0.755 +- 0.381 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.05 all KL = 0.6 +- 0.381 (in-sample avg dev_std = 0.645)
SUFF_SIMPLE for r=0.05 all L1 = 0.755 +- 0.260 (in-sample avg dev_std = 0.645)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07790252707581227
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.813
SUFF_SIMPLE for r=0.1 class 1.0 = 0.755 +- 0.374 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.1 all KL = 0.599 +- 0.374 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.1 all L1 = 0.755 +- 0.258 (in-sample avg dev_std = 0.642)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09429963898916968
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.829
SUFF_SIMPLE for r=0.2 class 1.0 = 0.782 +- 0.379 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 all KL = 0.649 +- 0.379 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.2 all L1 = 0.782 +- 0.262 (in-sample avg dev_std = 0.585)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09696750902527075
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.826
SUFF_SIMPLE for r=0.4 class 1.0 = 0.79 +- 0.387 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.4 all KL = 0.675 +- 0.387 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.4 all L1 = 0.79 +- 0.277 (in-sample avg dev_std = 0.549)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10066064981949459
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.874
SUFF_SIMPLE for r=0.8 class 1.0 = 0.871 +- 0.352 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.8 all KL = 0.825 +- 0.352 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.8 all L1 = 0.871 +- 0.275 (in-sample avg dev_std = 0.326)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.638
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013167857142857143
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.206
SUFF_SIMPLE for r=0.05 class 1.0 = 0.526 +- 0.428 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.05 all KL = 0.398 +- 0.428 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.05 all L1 = 0.526 +- 0.337 (in-sample avg dev_std = 0.684)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01306626984126984
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.212
SUFF_SIMPLE for r=0.1 class 1.0 = 0.532 +- 0.428 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.1 all KL = 0.405 +- 0.428 (in-sample avg dev_std = 0.681)
SUFF_SIMPLE for r=0.1 all L1 = 0.532 +- 0.337 (in-sample avg dev_std = 0.681)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.638
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.013200396825396825
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.21
SUFF_SIMPLE for r=0.2 class 1.0 = 0.53 +- 0.429 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.2 all KL = 0.403 +- 0.429 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.2 all L1 = 0.53 +- 0.338 (in-sample avg dev_std = 0.682)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.638
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013128174603174602
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.208
SUFF_SIMPLE for r=0.4 class 1.0 = 0.532 +- 0.428 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.4 all KL = 0.407 +- 0.428 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.4 all L1 = 0.532 +- 0.339 (in-sample avg dev_std = 0.666)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.638
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013113095238095238
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.189
SUFF_SIMPLE for r=0.8 class 1.0 = 0.576 +- 0.469 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.8 all KL = 0.514 +- 0.469 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.8 all L1 = 0.576 +- 0.401 (in-sample avg dev_std = 0.271)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04462398703403566
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.922
SUFF_SIMPLE for r=0.05 class 1.0 = 0.893 +- 0.321 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.05 all KL = 0.83 +- 0.321 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.05 all L1 = 0.893 +- 0.221 (in-sample avg dev_std = 0.397)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05516247974068071
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.914
SUFF_SIMPLE for r=0.1 class 1.0 = 0.896 +- 0.317 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.1 all KL = 0.844 +- 0.317 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.1 all L1 = 0.896 +- 0.231 (in-sample avg dev_std = 0.341)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06934440842787683
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.908
SUFF_SIMPLE for r=0.2 class 1.0 = 0.899 +- 0.315 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 all KL = 0.857 +- 0.315 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.2 all L1 = 0.899 +- 0.241 (in-sample avg dev_std = 0.296)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08659724473257699
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.903
SUFF_SIMPLE for r=0.4 class 1.0 = 0.903 +- 0.311 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 all KL = 0.873 +- 0.311 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.250 (in-sample avg dev_std = 0.234)


ratio=0.8


40 4 0
40 4 0
40 5 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10841531604538088
len(reference) = 2460
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.933
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.241 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.241 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.8 all L1 = 0.945 +- 0.208 (in-sample avg dev_std = 0.051)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.07236462093862815
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07790252707581227
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 1.0 = 0.021 +- 0.154 (in-sample avg dev_std = 0.131)
NEC for r=0.1 all KL = 0.029 +- 0.154 (in-sample avg dev_std = 0.131)
NEC for r=0.1 all L1 = 0.021 +- 0.119 (in-sample avg dev_std = 0.131)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.09429963898916968
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.959
NEC for r=0.2 class 1.0 = 0.045 +- 0.221 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.065 +- 0.221 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.045 +- 0.162 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09696750902527075
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.937
NEC for r=0.4 class 1.0 = 0.074 +- 0.270 (in-sample avg dev_std = 0.311)
NEC for r=0.4 all KL = 0.119 +- 0.270 (in-sample avg dev_std = 0.311)
NEC for r=0.4 all L1 = 0.074 +- 0.187 (in-sample avg dev_std = 0.311)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10066064981949459
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.929
NEC for r=0.8 class 1.0 = 0.1 +- 0.296 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all KL = 0.174 +- 0.296 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all L1 = 0.1 +- 0.187 (in-sample avg dev_std = 0.427)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.638
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013167857142857143
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.434
NEC for r=0.05 class 1.0 = 0.186 +- 0.390 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.206 +- 0.390 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.186 +- 0.341 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.638
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.01306626984126984
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.261
NEC for r=0.1 class 1.0 = 0.351 +- 0.461 (in-sample avg dev_std = 0.246)
NEC for r=0.1 all KL = 0.401 +- 0.461 (in-sample avg dev_std = 0.246)
NEC for r=0.1 all L1 = 0.351 +- 0.395 (in-sample avg dev_std = 0.246)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.638
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.013200396825396825
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.245
NEC for r=0.2 class 1.0 = 0.412 +- 0.441 (in-sample avg dev_std = 0.558)
NEC for r=0.2 all KL = 0.513 +- 0.441 (in-sample avg dev_std = 0.558)
NEC for r=0.2 all L1 = 0.412 +- 0.357 (in-sample avg dev_std = 0.558)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.638
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013128174603174602
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.245
NEC for r=0.4 class 1.0 = 0.423 +- 0.435 (in-sample avg dev_std = 0.615)
NEC for r=0.4 all KL = 0.536 +- 0.435 (in-sample avg dev_std = 0.615)
NEC for r=0.4 all L1 = 0.423 +- 0.346 (in-sample avg dev_std = 0.615)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.638
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013113095238095238
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.241
NEC for r=0.8 class 1.0 = 0.429 +- 0.432 (in-sample avg dev_std = 0.631)
NEC for r=0.8 all KL = 0.544 +- 0.432 (in-sample avg dev_std = 0.631)
NEC for r=0.8 all L1 = 0.429 +- 0.343 (in-sample avg dev_std = 0.631)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04462398703403566
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 1.0 = 0.01 +- 0.107 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all KL = 0.012 +- 0.107 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all L1 = 0.01 +- 0.092 (in-sample avg dev_std = 0.028)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05516247974068071
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.981
NEC for r=0.1 class 1.0 = 0.014 +- 0.124 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all KL = 0.016 +- 0.124 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all L1 = 0.014 +- 0.107 (in-sample avg dev_std = 0.035)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06934440842787683
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.962
NEC for r=0.2 class 1.0 = 0.032 +- 0.187 (in-sample avg dev_std = 0.029)
NEC for r=0.2 all KL = 0.038 +- 0.187 (in-sample avg dev_std = 0.029)
NEC for r=0.2 all L1 = 0.032 +- 0.161 (in-sample avg dev_std = 0.029)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08659724473257699
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.937
NEC for r=0.4 class 1.0 = 0.06 +- 0.253 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all KL = 0.077 +- 0.253 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all L1 = 0.06 +- 0.205 (in-sample avg dev_std = 0.165)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10841531604538088
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.935
NEC for r=0.8 class 1.0 = 0.081 +- 0.289 (in-sample avg dev_std = 0.313)
NEC for r=0.8 all KL = 0.122 +- 0.289 (in-sample avg dev_std = 0.313)
NEC for r=0.8 all L1 = 0.081 +- 0.207 (in-sample avg dev_std = 0.313)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:49:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:49:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.063
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.070
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.083
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.096
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.098
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.014
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.014
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.085
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.106


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06256317689530685
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.864
SUFF_SIMPLE for r=0.05 class 1.0 = 0.824 +- 0.356 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.05 all KL = 0.718 +- 0.356 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.05 all L1 = 0.824 +- 0.246 (in-sample avg dev_std = 0.533)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06996389891696751
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.869
SUFF_SIMPLE for r=0.1 class 1.0 = 0.832 +- 0.342 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all KL = 0.726 +- 0.342 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all L1 = 0.832 +- 0.238 (in-sample avg dev_std = 0.506)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0828158844765343
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.866
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.346 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.346 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.2 all L1 = 0.836 +- 0.252 (in-sample avg dev_std = 0.458)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09562454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.912
SUFF_SIMPLE for r=0.4 class 1.0 = 0.891 +- 0.306 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.306 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all L1 = 0.891 +- 0.217 (in-sample avg dev_std = 0.385)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09832129963898917
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.94
SUFF_SIMPLE for r=0.8 class 1.0 = 0.942 +- 0.250 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.250 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.204 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.731
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.01360634920634921
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.695
SUFF_SIMPLE for r=0.05 class 1.0 = 0.936 +- 0.208 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.05 all KL = 0.891 +- 0.208 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.05 all L1 = 0.936 +- 0.111 (in-sample avg dev_std = 0.337)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013574603174603173
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.695
SUFF_SIMPLE for r=0.1 class 1.0 = 0.937 +- 0.208 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all KL = 0.893 +- 0.208 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all L1 = 0.937 +- 0.110 (in-sample avg dev_std = 0.335)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.731
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01355952380952381
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.694
SUFF_SIMPLE for r=0.2 class 1.0 = 0.935 +- 0.211 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 all KL = 0.89 +- 0.211 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 all L1 = 0.935 +- 0.114 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.731
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013558333333333334
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.695
SUFF_SIMPLE for r=0.4 class 1.0 = 0.937 +- 0.211 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 all KL = 0.896 +- 0.211 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 all L1 = 0.937 +- 0.117 (in-sample avg dev_std = 0.330)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.731
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.01355793650793651
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.695
SUFF_SIMPLE for r=0.8 class 1.0 = 0.96 +- 0.184 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.184 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 all L1 = 0.96 +- 0.158 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035782414910859
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.709
SUFF_SIMPLE for r=0.05 class 1.0 = 0.665 +- 0.369 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.05 all KL = 0.497 +- 0.369 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.05 all L1 = 0.665 +- 0.295 (in-sample avg dev_std = 0.643)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05038411669367909
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.741
SUFF_SIMPLE for r=0.1 class 1.0 = 0.7 +- 0.372 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.1 all KL = 0.548 +- 0.372 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.1 all L1 = 0.7 +- 0.294 (in-sample avg dev_std = 0.597)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06593760129659643
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.783
SUFF_SIMPLE for r=0.2 class 1.0 = 0.74 +- 0.374 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.2 all KL = 0.602 +- 0.374 (in-sample avg dev_std = 0.580)
SUFF_SIMPLE for r=0.2 all L1 = 0.74 +- 0.281 (in-sample avg dev_std = 0.580)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08535089141004863
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.808
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.384 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.4 all KL = 0.636 +- 0.384 (in-sample avg dev_std = 0.594)
SUFF_SIMPLE for r=0.4 all L1 = 0.761 +- 0.276 (in-sample avg dev_std = 0.594)


ratio=0.8


40 5 0
40 4 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 5 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0
40 4 0

Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10605672609400324
len(reference) = 2452
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.648
SUFF_SIMPLE for r=0.8 class 1.0 = 0.694 +- 0.471 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all KL = 0.648 +- 0.471 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all L1 = 0.694 +- 0.409 (in-sample avg dev_std = 0.104)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06256317689530685
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.989
NEC for r=0.05 class 1.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.089 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06996389891696751
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
NEC for r=0.1 class 1.0 = 0.02 +- 0.151 (in-sample avg dev_std = 0.111)
NEC for r=0.1 all KL = 0.024 +- 0.151 (in-sample avg dev_std = 0.111)
NEC for r=0.1 all L1 = 0.02 +- 0.124 (in-sample avg dev_std = 0.111)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0828158844765343
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.959
NEC for r=0.2 class 1.0 = 0.048 +- 0.228 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all KL = 0.066 +- 0.228 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all L1 = 0.048 +- 0.170 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09562454873646209
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.949
NEC for r=0.4 class 1.0 = 0.062 +- 0.252 (in-sample avg dev_std = 0.301)
NEC for r=0.4 all KL = 0.097 +- 0.252 (in-sample avg dev_std = 0.301)
NEC for r=0.4 all L1 = 0.062 +- 0.176 (in-sample avg dev_std = 0.301)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09832129963898917
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.926
NEC for r=0.8 class 1.0 = 0.1 +- 0.302 (in-sample avg dev_std = 0.419)
NEC for r=0.8 all KL = 0.169 +- 0.302 (in-sample avg dev_std = 0.419)
NEC for r=0.8 all L1 = 0.1 +- 0.194 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.731
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.01360634920634921
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.721
NEC for r=0.05 class 1.0 = 0.009 +- 0.092 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.092 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.083 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.731
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013574603174603173
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.713
NEC for r=0.1 class 1.0 = 0.018 +- 0.128 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all KL = 0.019 +- 0.128 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all L1 = 0.018 +- 0.111 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.731
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.01355952380952381
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.715
NEC for r=0.2 class 1.0 = 0.023 +- 0.150 (in-sample avg dev_std = 0.189)
NEC for r=0.2 all KL = 0.033 +- 0.150 (in-sample avg dev_std = 0.189)
NEC for r=0.2 all L1 = 0.023 +- 0.100 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.731
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013558333333333334
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.714
NEC for r=0.4 class 1.0 = 0.029 +- 0.158 (in-sample avg dev_std = 0.227)
NEC for r=0.4 all KL = 0.047 +- 0.158 (in-sample avg dev_std = 0.227)
NEC for r=0.4 all L1 = 0.029 +- 0.091 (in-sample avg dev_std = 0.227)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.731
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.01355793650793651
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.715
NEC for r=0.8 class 1.0 = 0.027 +- 0.148 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all KL = 0.047 +- 0.148 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all L1 = 0.027 +- 0.078 (in-sample avg dev_std = 0.226)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035782414910859
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.976
NEC for r=0.05 class 1.0 = 0.022 +- 0.156 (in-sample avg dev_std = 0.088)
NEC for r=0.05 all KL = 0.026 +- 0.156 (in-sample avg dev_std = 0.088)
NEC for r=0.05 all L1 = 0.022 +- 0.131 (in-sample avg dev_std = 0.088)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05038411669367909
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.958
NEC for r=0.1 class 1.0 = 0.04 +- 0.209 (in-sample avg dev_std = 0.138)
NEC for r=0.1 all KL = 0.049 +- 0.209 (in-sample avg dev_std = 0.138)
NEC for r=0.1 all L1 = 0.04 +- 0.173 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06593760129659643
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.943
NEC for r=0.2 class 1.0 = 0.063 +- 0.260 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all KL = 0.088 +- 0.260 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all L1 = 0.063 +- 0.195 (in-sample avg dev_std = 0.263)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08535089141004863
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.923
NEC for r=0.4 class 1.0 = 0.092 +- 0.297 (in-sample avg dev_std = 0.343)
NEC for r=0.4 all KL = 0.138 +- 0.297 (in-sample avg dev_std = 0.343)
NEC for r=0.4 all L1 = 0.092 +- 0.212 (in-sample avg dev_std = 0.343)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10605672609400324
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.843
NEC for r=0.8 class 1.0 = 0.182 +- 0.368 (in-sample avg dev_std = 0.470)
NEC for r=0.8 all KL = 0.275 +- 0.368 (in-sample avg dev_std = 0.470)
NEC for r=0.8 all L1 = 0.182 +- 0.273 (in-sample avg dev_std = 0.470)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  1 18:55:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/01/2024 06:55:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.062
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.072
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.083
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.092
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.094
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.013
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.013
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.047
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.069
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.087
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.106


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06164981949458483
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.542
SUFF_SIMPLE for r=0.05 class 1.0 = 0.453 +- 0.185 (in-sample avg dev_std = 0.873)
SUFF_SIMPLE for r=0.05 all KL = 0.126 +- 0.185 (in-sample avg dev_std = 0.873)
SUFF_SIMPLE for r=0.05 all L1 = 0.453 +- 0.211 (in-sample avg dev_std = 0.873)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07235018050541517
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.549
SUFF_SIMPLE for r=0.1 class 1.0 = 0.463 +- 0.251 (in-sample avg dev_std = 0.854)
SUFF_SIMPLE for r=0.1 all KL = 0.154 +- 0.251 (in-sample avg dev_std = 0.854)
SUFF_SIMPLE for r=0.1 all L1 = 0.463 +- 0.233 (in-sample avg dev_std = 0.854)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08306498194945848
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.551
SUFF_SIMPLE for r=0.2 class 1.0 = 0.47 +- 0.268 (in-sample avg dev_std = 0.834)
SUFF_SIMPLE for r=0.2 all KL = 0.168 +- 0.268 (in-sample avg dev_std = 0.834)
SUFF_SIMPLE for r=0.2 all L1 = 0.47 +- 0.242 (in-sample avg dev_std = 0.834)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09206498194945847
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.588
SUFF_SIMPLE for r=0.4 class 1.0 = 0.512 +- 0.321 (in-sample avg dev_std = 0.792)
SUFF_SIMPLE for r=0.4 all KL = 0.225 +- 0.321 (in-sample avg dev_std = 0.792)
SUFF_SIMPLE for r=0.4 all L1 = 0.512 +- 0.267 (in-sample avg dev_std = 0.792)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09435018050541517
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.725
SUFF_SIMPLE for r=0.8 class 1.0 = 0.723 +- 0.462 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.8 all KL = 0.627 +- 0.462 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.8 all L1 = 0.723 +- 0.361 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.768
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013622222222222223
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.062
SUFF_SIMPLE for r=0.05 class 1.0 = 0.317 +- 0.342 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all KL = 0.246 +- 0.342 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all L1 = 0.317 +- 0.268 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013465079365079366
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.059
SUFF_SIMPLE for r=0.1 class 1.0 = 0.316 +- 0.342 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 all KL = 0.246 +- 0.342 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 all L1 = 0.316 +- 0.268 (in-sample avg dev_std = 0.413)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.768
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.013399603174603173
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.064
SUFF_SIMPLE for r=0.2 class 1.0 = 0.317 +- 0.338 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all KL = 0.244 +- 0.338 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all L1 = 0.317 +- 0.266 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.768
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013396428571428575
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.061
SUFF_SIMPLE for r=0.4 class 1.0 = 0.317 +- 0.340 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.4 all KL = 0.246 +- 0.340 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.4 all L1 = 0.317 +- 0.268 (in-sample avg dev_std = 0.421)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.768
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.01338095238095238
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.062
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.369 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.8 all KL = 0.279 +- 0.369 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.8 all L1 = 0.335 +- 0.301 (in-sample avg dev_std = 0.180)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.947
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04666166936790924
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.6
SUFF_SIMPLE for r=0.05 class 1.0 = 0.59 +- 0.384 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.05 all KL = 0.353 +- 0.384 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.05 all L1 = 0.59 +- 0.309 (in-sample avg dev_std = 0.693)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0568529173419773
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.607
SUFF_SIMPLE for r=0.1 class 1.0 = 0.597 +- 0.389 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.1 all KL = 0.366 +- 0.389 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.1 all L1 = 0.597 +- 0.313 (in-sample avg dev_std = 0.668)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.947
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0693561588330632
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.612
SUFF_SIMPLE for r=0.2 class 1.0 = 0.612 +- 0.406 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.2 all KL = 0.396 +- 0.406 (in-sample avg dev_std = 0.631)
SUFF_SIMPLE for r=0.2 all L1 = 0.612 +- 0.321 (in-sample avg dev_std = 0.631)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.947
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08666085899513776
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.642
SUFF_SIMPLE for r=0.4 class 1.0 = 0.635 +- 0.429 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.4 all KL = 0.443 +- 0.429 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.4 all L1 = 0.635 +- 0.331 (in-sample avg dev_std = 0.595)


ratio=0.8


40 5 0
40 5 0
40 4 0
40 5 0

Model Accuracy of binarized graphs for r=0.8 =  0.947
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10613978930307943
len(reference) = 2464
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.656
SUFF_SIMPLE for r=0.8 class 1.0 = 0.703 +- 0.469 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 all KL = 0.647 +- 0.469 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 all L1 = 0.703 +- 0.398 (in-sample avg dev_std = 0.191)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.06164981949458483
len(reference) = 277
Effective ratio: 0.054 +- 0.006
Model Accuracy over intervened graphs for r=0.05 =  0.971
NEC for r=0.05 class 1.0 = 0.028 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.034 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.028 +- 0.146 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.07235018050541517
len(reference) = 277
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 1.0 = 0.063 +- 0.270 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all KL = 0.093 +- 0.270 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all L1 = 0.063 +- 0.194 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.08306498194945848
len(reference) = 277
Effective ratio: 0.203 +- 0.004
Model Accuracy over intervened graphs for r=0.2 =  0.879
NEC for r=0.2 class 1.0 = 0.15 +- 0.382 (in-sample avg dev_std = 0.437)
NEC for r=0.2 all KL = 0.261 +- 0.382 (in-sample avg dev_std = 0.437)
NEC for r=0.2 all L1 = 0.15 +- 0.248 (in-sample avg dev_std = 0.437)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.09206498194945847
len(reference) = 277
Effective ratio: 0.404 +- 0.005
Model Accuracy over intervened graphs for r=0.4 =  0.852
NEC for r=0.4 class 1.0 = 0.203 +- 0.396 (in-sample avg dev_std = 0.572)
NEC for r=0.4 all KL = 0.384 +- 0.396 (in-sample avg dev_std = 0.572)
NEC for r=0.4 all L1 = 0.203 +- 0.243 (in-sample avg dev_std = 0.572)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.09435018050541517
len(reference) = 277
Effective ratio: 0.804 +- 0.006
Model Accuracy over intervened graphs for r=0.8 =  0.823
NEC for r=0.8 class 1.0 = 0.249 +- 0.401 (in-sample avg dev_std = 0.663)
NEC for r=0.8 all KL = 0.476 +- 0.401 (in-sample avg dev_std = 0.663)
NEC for r=0.8 all L1 = 0.249 +- 0.245 (in-sample avg dev_std = 0.663)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.768
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.013622222222222223
len(reference) = 2520
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.358
NEC for r=0.05 class 1.0 = 0.442 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.466 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.442 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.768
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013465079365079366
len(reference) = 2520
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.16
NEC for r=0.1 class 1.0 = 0.592 +- 0.398 (in-sample avg dev_std = 0.188)
NEC for r=0.1 all KL = 0.643 +- 0.398 (in-sample avg dev_std = 0.188)
NEC for r=0.1 all L1 = 0.592 +- 0.332 (in-sample avg dev_std = 0.188)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.768
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.013399603174603173
len(reference) = 2520
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.138
NEC for r=0.2 class 1.0 = 0.644 +- 0.339 (in-sample avg dev_std = 0.533)
NEC for r=0.2 all KL = 0.736 +- 0.339 (in-sample avg dev_std = 0.533)
NEC for r=0.2 all L1 = 0.644 +- 0.263 (in-sample avg dev_std = 0.533)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.768
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.013396428571428575
len(reference) = 2520
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.139
NEC for r=0.4 class 1.0 = 0.649 +- 0.335 (in-sample avg dev_std = 0.567)
NEC for r=0.4 all KL = 0.744 +- 0.335 (in-sample avg dev_std = 0.567)
NEC for r=0.4 all L1 = 0.649 +- 0.257 (in-sample avg dev_std = 0.567)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.768
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.01338095238095238
len(reference) = 2520
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.134
NEC for r=0.8 class 1.0 = 0.651 +- 0.337 (in-sample avg dev_std = 0.567)
NEC for r=0.8 all KL = 0.744 +- 0.337 (in-sample avg dev_std = 0.567)
NEC for r=0.8 all L1 = 0.651 +- 0.257 (in-sample avg dev_std = 0.567)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.947
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04666166936790924
len(reference) = 2468
Effective ratio: 0.055 +- 0.008
Model Accuracy over intervened graphs for r=0.05 =  0.905
NEC for r=0.05 class 1.0 = 0.077 +- 0.275 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all KL = 0.087 +- 0.275 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all L1 = 0.077 +- 0.239 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.947
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0568529173419773
len(reference) = 2468
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.87
NEC for r=0.1 class 1.0 = 0.109 +- 0.329 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all KL = 0.133 +- 0.329 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all L1 = 0.109 +- 0.271 (in-sample avg dev_std = 0.189)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.947
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0693561588330632
len(reference) = 2468
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.838
NEC for r=0.2 class 1.0 = 0.162 +- 0.391 (in-sample avg dev_std = 0.303)
NEC for r=0.2 all KL = 0.216 +- 0.391 (in-sample avg dev_std = 0.303)
NEC for r=0.2 all L1 = 0.162 +- 0.306 (in-sample avg dev_std = 0.303)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.947
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08666085899513776
len(reference) = 2468
Effective ratio: 0.404 +- 0.008
Model Accuracy over intervened graphs for r=0.4 =  0.793
NEC for r=0.4 class 1.0 = 0.22 +- 0.425 (in-sample avg dev_std = 0.435)
NEC for r=0.4 all KL = 0.33 +- 0.425 (in-sample avg dev_std = 0.435)
NEC for r=0.4 all L1 = 0.22 +- 0.314 (in-sample avg dev_std = 0.435)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.947
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.10613978930307943
len(reference) = 2468
Effective ratio: 0.805 +- 0.010
Model Accuracy over intervened graphs for r=0.8 =  0.725
NEC for r=0.8 class 1.0 = 0.285 +- 0.425 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all KL = 0.462 +- 0.425 (in-sample avg dev_std = 0.586)
NEC for r=0.8 all L1 = 0.285 +- 0.309 (in-sample avg dev_std = 0.586)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.944, 0.977, 0.979, 0.998, 1.0], 'all_L1': [0.971, 0.988, 0.986, 0.999, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.783, 0.813, 0.817, 0.841, 0.951], 'all_L1': [0.888, 0.903, 0.899, 0.906, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.838, 0.851, 0.885, 0.978], 'all_L1': [0.903, 0.909, 0.911, 0.927, 0.984]}), defaultdict(<class 'list'>, {'all_KL': [0.697, 0.697, 0.716, 0.731, 0.89], 'all_L1': [0.814, 0.81, 0.815, 0.815, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.91, 0.922, 0.944, 0.964, 0.973], 'all_L1': [0.954, 0.954, 0.967, 0.981, 0.978]}), defaultdict(<class 'list'>, {'all_KL': [0.785, 0.802, 0.766, 0.83, 0.96], 'all_L1': [0.883, 0.891, 0.858, 0.895, 0.968]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.399, 0.46, 0.479, 0.779], 'all_L1': [0.607, 0.614, 0.644, 0.662, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.599, 0.649, 0.675, 0.825], 'all_L1': [0.755, 0.755, 0.782, 0.79, 0.871]}), defaultdict(<class 'list'>, {'all_KL': [0.718, 0.726, 0.745, 0.83, 0.928], 'all_L1': [0.824, 0.832, 0.836, 0.891, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.126, 0.154, 0.168, 0.225, 0.627], 'all_L1': [0.453, 0.463, 0.47, 0.512, 0.723]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.004, 0.011, 0.023], 'all_L1': [0.0, 0.0, 0.002, 0.008, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.015, 0.014, 0.051, 0.114], 'all_L1': [0.003, 0.013, 0.008, 0.03, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.021, 0.038, 0.07, 0.086], 'all_L1': [0.012, 0.017, 0.03, 0.046, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.001, 0.022, 0.07, 0.111], 'all_L1': [0.0, 0.002, 0.015, 0.047, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.004, 0.012, 0.048], 'all_L1': [0.0, 0.0, 0.003, 0.007, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.008, 0.011, 0.044, 0.082], 'all_L1': [0.001, 0.006, 0.006, 0.03, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.098, 0.188, 0.268, 0.331], 'all_L1': [0.02, 0.074, 0.137, 0.176, 0.198]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.029, 0.065, 0.119, 0.174], 'all_L1': [0.0, 0.021, 0.045, 0.074, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.024, 0.066, 0.097, 0.169], 'all_L1': [0.009, 0.02, 0.048, 0.062, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.093, 0.261, 0.384, 0.476], 'all_L1': [0.028, 0.063, 0.15, 0.203, 0.249]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [1.0, 1.0, 1.0, 1.0, 1.0], 'all_L1': [1.0, 1.0, 1.0, 1.0, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.82, 0.812, 0.813, 0.817, 0.925], 'all_L1': [0.918, 0.913, 0.914, 0.914, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.989, 0.989, 0.99, 0.994], 'all_L1': [0.995, 0.995, 0.995, 0.995, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.358, 0.357, 0.355, 0.357, 0.498], 'all_L1': [0.494, 0.495, 0.493, 0.492, 0.548]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.975, 0.973, 0.977, 0.991], 'all_L1': [0.988, 0.988, 0.987, 0.988, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.511, 0.518, 0.507, 0.733], 'all_L1': [0.7, 0.703, 0.707, 0.695, 0.788]}), defaultdict(<class 'list'>, {'all_KL': [0.317, 0.322, 0.325, 0.34, 0.615], 'all_L1': [0.547, 0.549, 0.551, 0.556, 0.685]}), defaultdict(<class 'list'>, {'all_KL': [0.398, 0.405, 0.403, 0.407, 0.514], 'all_L1': [0.526, 0.532, 0.53, 0.532, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.891, 0.893, 0.89, 0.896, 0.956], 'all_L1': [0.936, 0.937, 0.935, 0.937, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.246, 0.246, 0.244, 0.246, 0.279], 'all_L1': [0.317, 0.316, 0.317, 0.317, 0.335]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.001, 0.001], 'all_L1': [0.0, 0.0, 0.0, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.016, 0.046, 0.05, 0.05], 'all_L1': [0.001, 0.012, 0.024, 0.024, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.002, 0.007, 0.006, 0.005], 'all_L1': [0.0, 0.001, 0.004, 0.003, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.147, 0.399, 0.553, 0.576, 0.589], 'all_L1': [0.149, 0.365, 0.449, 0.461, 0.469]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.003, 0.005, 0.006, 0.006], 'all_L1': [0.001, 0.003, 0.004, 0.004, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.038, 0.085, 0.094, 0.103], 'all_L1': [0.005, 0.031, 0.051, 0.052, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.084, 0.171, 0.202, 0.216], 'all_L1': [0.012, 0.068, 0.104, 0.116, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.206, 0.401, 0.513, 0.536, 0.544], 'all_L1': [0.186, 0.351, 0.412, 0.423, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.019, 0.033, 0.047, 0.047], 'all_L1': [0.009, 0.018, 0.023, 0.029, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.643, 0.736, 0.744, 0.744], 'all_L1': [0.442, 0.592, 0.644, 0.649, 0.651]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.934, 0.939, 0.956, 0.932, 0.737], 'all_L1': [0.965, 0.969, 0.979, 0.969, 0.774]}), defaultdict(<class 'list'>, {'all_KL': [0.863, 0.882, 0.908, 0.924, 0.898], 'all_L1': [0.927, 0.934, 0.945, 0.952, 0.912]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.893, 0.911, 0.923, 0.946], 'all_L1': [0.924, 0.933, 0.939, 0.944, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.855, 0.856, 0.88, 0.873, 0.822], 'all_L1': [0.905, 0.901, 0.912, 0.905, 0.844]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.895, 0.916, 0.913, 0.775], 'all_L1': [0.933, 0.945, 0.955, 0.957, 0.806]}), defaultdict(<class 'list'>, {'all_KL': [0.848, 0.868, 0.895, 0.907, 0.851], 'all_L1': [0.909, 0.917, 0.932, 0.934, 0.871]}), defaultdict(<class 'list'>, {'all_KL': [0.683, 0.723, 0.761, 0.756, 0.816], 'all_L1': [0.788, 0.807, 0.827, 0.815, 0.841]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.844, 0.857, 0.873, 0.936], 'all_L1': [0.893, 0.896, 0.899, 0.903, 0.945]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.548, 0.602, 0.636, 0.648], 'all_L1': [0.665, 0.7, 0.74, 0.761, 0.694]}), defaultdict(<class 'list'>, {'all_KL': [0.353, 0.366, 0.396, 0.443, 0.647], 'all_L1': [0.59, 0.597, 0.612, 0.635, 0.703]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.003, 0.005, 0.008, 0.027], 'all_L1': [0.0, 0.002, 0.003, 0.004, 0.016]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.014, 0.03, 0.046, 0.087], 'all_L1': [0.007, 0.012, 0.023, 0.032, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.022, 0.033, 0.055, 0.085], 'all_L1': [0.015, 0.018, 0.027, 0.042, 0.053]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.031, 0.047, 0.075, 0.105], 'all_L1': [0.022, 0.027, 0.04, 0.06, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.012, 0.019, 0.028, 0.054], 'all_L1': [0.008, 0.009, 0.013, 0.015, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.016, 0.037, 0.065, 0.101], 'all_L1': [0.012, 0.014, 0.032, 0.052, 0.064]}), defaultdict(<class 'list'>, {'all_KL': [0.045, 0.059, 0.099, 0.17, 0.234], 'all_L1': [0.039, 0.051, 0.084, 0.132, 0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.016, 0.038, 0.077, 0.122], 'all_L1': [0.01, 0.014, 0.032, 0.06, 0.081]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.049, 0.088, 0.138, 0.275], 'all_L1': [0.022, 0.04, 0.063, 0.092, 0.182]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.133, 0.216, 0.33, 0.462], 'all_L1': [0.077, 0.109, 0.162, 0.22, 0.285]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.805 +- 0.154, 0.812 +- 0.155, 0.817 +- 0.148, 0.838 +- 0.143, 0.918 +- 0.083
suff_simple class all_KL  =  0.677 +- 0.239, 0.693 +- 0.238, 0.710 +- 0.229, 0.746 +- 0.224, 0.891 +- 0.111
suff_simple_acc_int  =  0.847 +- 0.132, 0.850 +- 0.132, 0.847 +- 0.127, 0.862 +- 0.122, 0.918 +- 0.083
nec class all_L1  =  0.007 +- 0.009, 0.022 +- 0.025, 0.044 +- 0.052, 0.068 +- 0.064, 0.090 +- 0.073
nec class all_KL  =  0.009 +- 0.011, 0.029 +- 0.035, 0.067 +- 0.083, 0.113 +- 0.114, 0.161 +- 0.133
nec_acc_int  =  0.992 +- 0.010, 0.978 +- 0.024, 0.961 +- 0.047, 0.943 +- 0.051, 0.934 +- 0.055

Eval split val
suff_simple class all_L1  =  0.742 +- 0.243, 0.743 +- 0.242, 0.743 +- 0.241, 0.743 +- 0.241, 0.783 +- 0.224
suff_simple class all_KL  =  0.650 +- 0.295, 0.651 +- 0.294, 0.651 +- 0.294, 0.654 +- 0.293, 0.750 +- 0.248
suff_simple_acc_int  =  0.638 +- 0.307, 0.638 +- 0.306, 0.638 +- 0.306, 0.636 +- 0.307, 0.635 +- 0.314
nec class all_L1  =  0.080 +- 0.137, 0.144 +- 0.201, 0.171 +- 0.225, 0.176 +- 0.228, 0.178 +- 0.230
nec class all_KL  =  0.085 +- 0.145, 0.161 +- 0.220, 0.215 +- 0.262, 0.226 +- 0.267, 0.230 +- 0.270
nec_acc_int  =  0.781 +- 0.224, 0.713 +- 0.298, 0.704 +- 0.306, 0.704 +- 0.306, 0.703 +- 0.308

Eval split test
suff_simple class all_L1  =  0.850 +- 0.121, 0.860 +- 0.116, 0.874 +- 0.110, 0.877 +- 0.103, 0.834 +- 0.087
suff_simple class all_KL  =  0.761 +- 0.181, 0.781 +- 0.175, 0.808 +- 0.168, 0.818 +- 0.154, 0.808 +- 0.102
suff_simple_acc_int  =  0.872 +- 0.120, 0.877 +- 0.113, 0.885 +- 0.108, 0.888 +- 0.099, 0.807 +- 0.100
nec class all_L1  =  0.021 +- 0.021, 0.030 +- 0.030, 0.048 +- 0.044, 0.071 +- 0.061, 0.099 +- 0.080
nec class all_KL  =  0.024 +- 0.024, 0.035 +- 0.036, 0.061 +- 0.058, 0.099 +- 0.090, 0.155 +- 0.126
nec_acc_int  =  0.972 +- 0.028, 0.965 +- 0.036, 0.950 +- 0.045, 0.933 +- 0.058, 0.915 +- 0.078


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.406 +- 0.073, 0.417 +- 0.067, 0.431 +- 0.051, 0.453 +- 0.042, 0.504 +- 0.012
Faith. Armon (L1)= 		  =  0.014 +- 0.018, 0.040 +- 0.044, 0.075 +- 0.081, 0.114 +- 0.093, 0.153 +- 0.108
Faith. GMean (L1)= 	  =  0.049 +- 0.047, 0.098 +- 0.067, 0.148 +- 0.085, 0.204 +- 0.081, 0.260 +- 0.097
Faith. Aritm (KL)= 		  =  0.343 +- 0.115, 0.361 +- 0.104, 0.388 +- 0.076, 0.429 +- 0.058, 0.526 +- 0.020
Faith. Armon (KL)= 		  =  0.016 +- 0.019, 0.046 +- 0.050, 0.089 +- 0.084, 0.149 +- 0.100, 0.243 +- 0.149
Faith. GMean (KL)= 	  =  0.045 +- 0.041, 0.093 +- 0.062, 0.156 +- 0.074, 0.231 +- 0.077, 0.341 +- 0.115

Eval split val
Faith. Aritm (L1)= 		  =  0.411 +- 0.078, 0.443 +- 0.059, 0.457 +- 0.054, 0.459 +- 0.054, 0.481 +- 0.035
Faith. Armon (L1)= 		  =  0.093 +- 0.134, 0.150 +- 0.179, 0.174 +- 0.189, 0.178 +- 0.191, 0.186 +- 0.201
Faith. GMean (L1)= 	  =  0.125 +- 0.132, 0.195 +- 0.163, 0.224 +- 0.169, 0.231 +- 0.168, 0.242 +- 0.179
Faith. Aritm (KL)= 		  =  0.368 +- 0.113, 0.406 +- 0.093, 0.433 +- 0.083, 0.440 +- 0.080, 0.490 +- 0.040
Faith. Armon (KL)= 		  =  0.086 +- 0.122, 0.142 +- 0.160, 0.179 +- 0.169, 0.189 +- 0.171, 0.218 +- 0.203
Faith. GMean (KL)= 	  =  0.113 +- 0.118, 0.182 +- 0.145, 0.228 +- 0.155, 0.242 +- 0.153, 0.277 +- 0.180

Eval split test
Faith. Aritm (L1)= 		  =  0.436 +- 0.052, 0.445 +- 0.044, 0.461 +- 0.035, 0.474 +- 0.024, 0.467 +- 0.037
Faith. Armon (L1)= 		  =  0.040 +- 0.038, 0.054 +- 0.051, 0.085 +- 0.070, 0.122 +- 0.091, 0.165 +- 0.112
Faith. GMean (L1)= 	  =  0.113 +- 0.055, 0.138 +- 0.057, 0.180 +- 0.070, 0.221 +- 0.087, 0.263 +- 0.097
Faith. Aritm (KL)= 		  =  0.393 +- 0.080, 0.408 +- 0.071, 0.435 +- 0.057, 0.459 +- 0.037, 0.481 +- 0.051
Faith. Armon (KL)= 		  =  0.044 +- 0.039, 0.062 +- 0.054, 0.101 +- 0.076, 0.155 +- 0.104, 0.234 +- 0.142
Faith. GMean (KL)= 	  =  0.111 +- 0.048, 0.140 +- 0.048, 0.190 +- 0.062, 0.247 +- 0.083, 0.324 +- 0.112
Computed for split load_split = id



Completed in  0:56:04.018998  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN TopoFeature/basis/no_shift
DONE all :)
