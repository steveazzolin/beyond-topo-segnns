nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 113539

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:17:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:17:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5775376666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.803
SUFF_SIMPLE for r=0.3 class 0 = 0.659 +- 0.284 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 class 1 = 0.876 +- 0.284 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 class 2 = 0.719 +- 0.284 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 all KL = 0.743 +- 0.284 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 all L1 = 0.752 +- 0.215 (in-sample avg dev_std = 0.454)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4840433333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.879
SUFF_SIMPLE for r=0.6 class 0 = 0.78 +- 0.197 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.6 class 1 = 0.943 +- 0.197 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.6 class 2 = 0.843 +- 0.197 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.6 all KL = 0.887 +- 0.197 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.6 all L1 = 0.856 +- 0.165 (in-sample avg dev_std = 0.265)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34274733333333335
len(reference) = 2630
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.911
SUFF_SIMPLE for r=0.9 class 0 = 0.907 +- 0.101 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 class 1 = 0.953 +- 0.101 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 class 2 = 0.935 +- 0.101 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 all KL = 0.968 +- 0.101 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 all L1 = 0.933 +- 0.100 (in-sample avg dev_std = 0.128)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.782935
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.658
SUFF_SIMPLE for r=0.3 class 0 = 0.734 +- 0.183 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.3 class 1 = 0.951 +- 0.183 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.3 class 2 = 0.728 +- 0.183 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.3 all KL = 0.877 +- 0.183 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.3 all L1 = 0.803 +- 0.167 (in-sample avg dev_std = 0.291)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934813333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.692
SUFF_SIMPLE for r=0.6 class 0 = 0.806 +- 0.050 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.6 class 1 = 0.976 +- 0.050 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.6 class 2 = 0.848 +- 0.050 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.6 all KL = 0.969 +- 0.050 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.6 all L1 = 0.876 +- 0.110 (in-sample avg dev_std = 0.063)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.567
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.477399
len(reference) = 1306
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
SUFF_SIMPLE for r=0.9 class 0 = 0.909 +- 0.092 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 class 1 = 0.936 +- 0.092 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 class 2 = 0.919 +- 0.092 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 all KL = 0.983 +- 0.092 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 all L1 = 0.917 +- 0.091 (in-sample avg dev_std = 0.008)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5775376666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.37
NEC for r=0.3 class 0 = 0.692 +- 0.219 (in-sample avg dev_std = 0.578)
NEC for r=0.3 class 1 = 0.577 +- 0.219 (in-sample avg dev_std = 0.578)
NEC for r=0.3 class 2 = 0.711 +- 0.219 (in-sample avg dev_std = 0.578)
NEC for r=0.3 all KL = 0.761 +- 0.219 (in-sample avg dev_std = 0.578)
NEC for r=0.3 all L1 = 0.66 +- 0.177 (in-sample avg dev_std = 0.578)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4840433333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.532
NEC for r=0.6 class 0 = 0.592 +- 0.270 (in-sample avg dev_std = 0.640)
NEC for r=0.6 class 1 = 0.43 +- 0.270 (in-sample avg dev_std = 0.640)
NEC for r=0.6 class 2 = 0.587 +- 0.270 (in-sample avg dev_std = 0.640)
NEC for r=0.6 all KL = 0.626 +- 0.270 (in-sample avg dev_std = 0.640)
NEC for r=0.6 all L1 = 0.536 +- 0.212 (in-sample avg dev_std = 0.640)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34274733333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.645
NEC for r=0.9 class 0 = 0.505 +- 0.279 (in-sample avg dev_std = 0.666)
NEC for r=0.9 class 1 = 0.333 +- 0.279 (in-sample avg dev_std = 0.666)
NEC for r=0.9 class 2 = 0.484 +- 0.279 (in-sample avg dev_std = 0.666)
NEC for r=0.9 all KL = 0.52 +- 0.279 (in-sample avg dev_std = 0.666)
NEC for r=0.9 all L1 = 0.44 +- 0.209 (in-sample avg dev_std = 0.666)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.782935
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.283
NEC for r=0.3 class 0 = 0.509 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 1 = 0.466 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 2 = 0.666 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 all KL = 0.517 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 all L1 = 0.547 +- 0.200 (in-sample avg dev_std = 0.239)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934813333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.47
NEC for r=0.6 class 0 = 0.409 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 1 = 0.29 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 2 = 0.5 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all KL = 0.366 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all L1 = 0.4 +- 0.214 (in-sample avg dev_std = 0.422)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.477399
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.361 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 class 1 = 0.227 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 class 2 = 0.451 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 all KL = 0.302 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 all L1 = 0.347 +- 0.190 (in-sample avg dev_std = 0.437)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:19:46 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:19:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.592653
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.852
SUFF_SIMPLE for r=0.3 class 0 = 0.716 +- 0.214 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 class 1 = 0.884 +- 0.214 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 class 2 = 0.798 +- 0.214 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 all KL = 0.84 +- 0.214 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 all L1 = 0.8 +- 0.170 (in-sample avg dev_std = 0.348)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48828733333333335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.902
SUFF_SIMPLE for r=0.6 class 0 = 0.831 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.6 class 1 = 0.891 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.6 class 2 = 0.882 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.6 all KL = 0.929 +- 0.116 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.6 all L1 = 0.869 +- 0.116 (in-sample avg dev_std = 0.191)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.351097
len(reference) = 2629
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.912
SUFF_SIMPLE for r=0.9 class 0 = 0.912 +- 0.075 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.9 class 1 = 0.907 +- 0.075 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.9 class 2 = 0.925 +- 0.075 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.9 all KL = 0.971 +- 0.075 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.9 all L1 = 0.915 +- 0.100 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7830843333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.768
SUFF_SIMPLE for r=0.3 class 0 = 0.76 +- 0.127 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 class 1 = 0.932 +- 0.127 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 class 2 = 0.707 +- 0.127 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 all KL = 0.899 +- 0.127 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 all L1 = 0.799 +- 0.148 (in-sample avg dev_std = 0.254)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6946836666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.829
SUFF_SIMPLE for r=0.6 class 0 = 0.847 +- 0.044 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.937 +- 0.044 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.044 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.946 +- 0.044 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.837 +- 0.120 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48258500000000004
len(reference) = 18
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF_SIMPLE for r=0.9 class 1 = 0.971 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.971 +- 0.007 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.592653
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
NEC for r=0.3 class 0 = 0.66 +- 0.229 (in-sample avg dev_std = 0.502)
NEC for r=0.3 class 1 = 0.521 +- 0.229 (in-sample avg dev_std = 0.502)
NEC for r=0.3 class 2 = 0.694 +- 0.229 (in-sample avg dev_std = 0.502)
NEC for r=0.3 all KL = 0.669 +- 0.229 (in-sample avg dev_std = 0.502)
NEC for r=0.3 all L1 = 0.625 +- 0.170 (in-sample avg dev_std = 0.502)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48828733333333335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.564
NEC for r=0.6 class 0 = 0.552 +- 0.260 (in-sample avg dev_std = 0.584)
NEC for r=0.6 class 1 = 0.379 +- 0.260 (in-sample avg dev_std = 0.584)
NEC for r=0.6 class 2 = 0.549 +- 0.260 (in-sample avg dev_std = 0.584)
NEC for r=0.6 all KL = 0.521 +- 0.260 (in-sample avg dev_std = 0.584)
NEC for r=0.6 all L1 = 0.493 +- 0.195 (in-sample avg dev_std = 0.584)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.351097
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.677
NEC for r=0.9 class 0 = 0.453 +- 0.254 (in-sample avg dev_std = 0.596)
NEC for r=0.9 class 1 = 0.3 +- 0.254 (in-sample avg dev_std = 0.596)
NEC for r=0.9 class 2 = 0.446 +- 0.254 (in-sample avg dev_std = 0.596)
NEC for r=0.9 all KL = 0.415 +- 0.254 (in-sample avg dev_std = 0.596)
NEC for r=0.9 all L1 = 0.399 +- 0.186 (in-sample avg dev_std = 0.596)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7830843333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.677 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 1 = 0.363 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 2 = 0.536 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all KL = 0.428 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all L1 = 0.526 +- 0.219 (in-sample avg dev_std = 0.176)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6946836666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.528
NEC for r=0.6 class 0 = 0.497 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.228 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.455 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.3 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.394 +- 0.211 (in-sample avg dev_std = 0.407)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48258500000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.421 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 1 = 0.186 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 2 = 0.409 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all KL = 0.241 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all L1 = 0.339 +- 0.179 (in-sample avg dev_std = 0.419)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:21:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:21:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5834053333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.833
SUFF_SIMPLE for r=0.3 class 0 = 0.69 +- 0.229 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.3 class 1 = 0.872 +- 0.229 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.3 class 2 = 0.773 +- 0.229 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.3 all KL = 0.806 +- 0.229 (in-sample avg dev_std = 0.398)
SUFF_SIMPLE for r=0.3 all L1 = 0.78 +- 0.176 (in-sample avg dev_std = 0.398)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48694733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.886
SUFF_SIMPLE for r=0.6 class 0 = 0.805 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.6 class 1 = 0.905 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.6 class 2 = 0.859 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.6 all KL = 0.904 +- 0.155 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.6 all L1 = 0.857 +- 0.134 (in-sample avg dev_std = 0.256)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3473106666666666
len(reference) = 2449
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.923
SUFF_SIMPLE for r=0.9 class 0 = 0.904 +- 0.070 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.9 class 1 = 0.924 +- 0.070 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.9 class 2 = 0.912 +- 0.070 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.9 all KL = 0.97 +- 0.070 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.9 all L1 = 0.913 +- 0.090 (in-sample avg dev_std = 0.082)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7835050000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.7
SUFF_SIMPLE for r=0.3 class 0 = 0.738 +- 0.098 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.3 class 1 = 0.901 +- 0.098 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.3 class 2 = 0.708 +- 0.098 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.3 all KL = 0.912 +- 0.098 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.3 all L1 = 0.782 +- 0.117 (in-sample avg dev_std = 0.215)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.697728
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.746
SUFF_SIMPLE for r=0.6 class 0 = 0.785 +- 0.027 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.896 +- 0.027 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.721 +- 0.027 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.943 +- 0.027 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.8 +- 0.100 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5834053333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.394
NEC for r=0.3 class 0 = 0.646 +- 0.232 (in-sample avg dev_std = 0.546)
NEC for r=0.3 class 1 = 0.52 +- 0.232 (in-sample avg dev_std = 0.546)
NEC for r=0.3 class 2 = 0.697 +- 0.232 (in-sample avg dev_std = 0.546)
NEC for r=0.3 all KL = 0.687 +- 0.232 (in-sample avg dev_std = 0.546)
NEC for r=0.3 all L1 = 0.622 +- 0.179 (in-sample avg dev_std = 0.546)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48694733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.574
NEC for r=0.6 class 0 = 0.548 +- 0.257 (in-sample avg dev_std = 0.620)
NEC for r=0.6 class 1 = 0.373 +- 0.257 (in-sample avg dev_std = 0.620)
NEC for r=0.6 class 2 = 0.565 +- 0.257 (in-sample avg dev_std = 0.620)
NEC for r=0.6 all KL = 0.545 +- 0.257 (in-sample avg dev_std = 0.620)
NEC for r=0.6 all L1 = 0.495 +- 0.194 (in-sample avg dev_std = 0.620)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3473106666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.671
NEC for r=0.9 class 0 = 0.471 +- 0.252 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 1 = 0.302 +- 0.252 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 2 = 0.462 +- 0.252 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all KL = 0.448 +- 0.252 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all L1 = 0.411 +- 0.185 (in-sample avg dev_std = 0.625)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7835050000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.387 +- 0.264 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1 = 0.261 +- 0.264 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 2 = 0.588 +- 0.264 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.32 +- 0.264 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.413 +- 0.246 (in-sample avg dev_std = 0.153)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.697728
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.355 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 1 = 0.191 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 2 = 0.473 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 all KL = 0.234 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 all L1 = 0.34 +- 0.204 (in-sample avg dev_std = 0.325)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4849546666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.569
NEC for r=0.9 class 0 = 0.315 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 class 1 = 0.166 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 class 2 = 0.423 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 all KL = 0.188 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 all L1 = 0.302 +- 0.168 (in-sample avg dev_std = 0.333)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:24:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:24:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5827606666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.854
SUFF_SIMPLE for r=0.3 class 0 = 0.736 +- 0.209 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 class 1 = 0.901 +- 0.209 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 class 2 = 0.762 +- 0.209 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 all KL = 0.838 +- 0.209 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 all L1 = 0.8 +- 0.168 (in-sample avg dev_std = 0.354)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.47364300000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.899
SUFF_SIMPLE for r=0.6 class 0 = 0.845 +- 0.126 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 class 1 = 0.928 +- 0.126 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 class 2 = 0.841 +- 0.126 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 all KL = 0.923 +- 0.126 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 all L1 = 0.871 +- 0.120 (in-sample avg dev_std = 0.201)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34097
len(reference) = 2658
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.919
SUFF_SIMPLE for r=0.9 class 0 = 0.895 +- 0.078 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 class 1 = 0.952 +- 0.078 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 class 2 = 0.911 +- 0.078 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 all KL = 0.969 +- 0.078 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 all L1 = 0.92 +- 0.097 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821599999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.869
SUFF_SIMPLE for r=0.3 class 0 = 0.722 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 class 1 = 0.89 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 class 2 = 0.77 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 all KL = 0.918 +- 0.109 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 all L1 = 0.794 +- 0.109 (in-sample avg dev_std = 0.223)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6963326666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.906
SUFF_SIMPLE for r=0.6 class 0 = 0.777 +- 0.028 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.6 class 1 = 0.897 +- 0.028 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.6 class 2 = 0.794 +- 0.028 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.6 all KL = 0.956 +- 0.028 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.6 all L1 = 0.822 +- 0.066 (in-sample avg dev_std = 0.010)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4825026666666667
len(reference) = 72
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.917
SUFF_SIMPLE for r=0.9 class 0 = 0.96 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.954 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.96 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.96 +- 0.002 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5827606666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.373
NEC for r=0.3 class 0 = 0.668 +- 0.219 (in-sample avg dev_std = 0.565)
NEC for r=0.3 class 1 = 0.558 +- 0.219 (in-sample avg dev_std = 0.565)
NEC for r=0.3 class 2 = 0.683 +- 0.219 (in-sample avg dev_std = 0.565)
NEC for r=0.3 all KL = 0.723 +- 0.219 (in-sample avg dev_std = 0.565)
NEC for r=0.3 all L1 = 0.637 +- 0.179 (in-sample avg dev_std = 0.565)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.47364300000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.566
NEC for r=0.6 class 0 = 0.549 +- 0.256 (in-sample avg dev_std = 0.627)
NEC for r=0.6 class 1 = 0.405 +- 0.256 (in-sample avg dev_std = 0.627)
NEC for r=0.6 class 2 = 0.544 +- 0.256 (in-sample avg dev_std = 0.627)
NEC for r=0.6 all KL = 0.563 +- 0.256 (in-sample avg dev_std = 0.627)
NEC for r=0.6 all L1 = 0.499 +- 0.200 (in-sample avg dev_std = 0.627)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34097
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.669
NEC for r=0.9 class 0 = 0.453 +- 0.252 (in-sample avg dev_std = 0.630)
NEC for r=0.9 class 1 = 0.316 +- 0.252 (in-sample avg dev_std = 0.630)
NEC for r=0.9 class 2 = 0.459 +- 0.252 (in-sample avg dev_std = 0.630)
NEC for r=0.9 all KL = 0.458 +- 0.252 (in-sample avg dev_std = 0.630)
NEC for r=0.9 all L1 = 0.409 +- 0.191 (in-sample avg dev_std = 0.630)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821599999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.669 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 class 1 = 0.468 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 class 2 = 0.651 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 all KL = 0.489 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 all L1 = 0.597 +- 0.138 (in-sample avg dev_std = 0.234)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6963326666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.592
NEC for r=0.6 class 0 = 0.505 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 class 1 = 0.311 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 class 2 = 0.474 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 all KL = 0.321 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 all L1 = 0.43 +- 0.167 (in-sample avg dev_std = 0.431)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4825026666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.68
NEC for r=0.9 class 0 = 0.439 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 class 1 = 0.256 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 class 2 = 0.416 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 all KL = 0.254 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 all L1 = 0.371 +- 0.145 (in-sample avg dev_std = 0.427)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:25:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:25:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.534
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.449
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.534472
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.849
SUFF_SIMPLE for r=0.3 class 0 = 0.715 +- 0.230 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 class 1 = 0.836 +- 0.230 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 class 2 = 0.788 +- 0.230 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 all KL = 0.809 +- 0.230 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 all L1 = 0.781 +- 0.169 (in-sample avg dev_std = 0.369)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44946433333333335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.912
SUFF_SIMPLE for r=0.6 class 0 = 0.827 +- 0.099 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 class 1 = 0.872 +- 0.099 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 class 2 = 0.884 +- 0.099 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all KL = 0.923 +- 0.099 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.6 all L1 = 0.862 +- 0.109 (in-sample avg dev_std = 0.168)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329827
len(reference) = 2615
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.919
SUFF_SIMPLE for r=0.9 class 0 = 0.781 +- 0.110 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.9 class 1 = 0.885 +- 0.110 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.9 class 2 = 0.935 +- 0.110 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.9 all KL = 0.933 +- 0.110 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.9 all L1 = 0.87 +- 0.134 (in-sample avg dev_std = 0.084)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7837400000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.6
SUFF_SIMPLE for r=0.3 class 0 = 0.813 +- 0.133 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.3 class 1 = 0.938 +- 0.133 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.3 class 2 = 0.715 +- 0.133 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.3 all KL = 0.9 +- 0.133 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.3 all L1 = 0.822 +- 0.152 (in-sample avg dev_std = 0.231)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7064046666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.642
SUFF_SIMPLE for r=0.6 class 0 = 0.86 +- 0.051 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 class 1 = 0.956 +- 0.051 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 class 2 = 0.725 +- 0.051 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.944 +- 0.051 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.847 +- 0.136 (in-sample avg dev_std = 0.002)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.893
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.49540433333333334
len(reference) = 84
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.893
SUFF_SIMPLE for r=0.9 class 0 = 0.989 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.984 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.979 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.983 +- 0.009 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.534472
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.653 +- 0.236 (in-sample avg dev_std = 0.557)
NEC for r=0.3 class 1 = 0.549 +- 0.236 (in-sample avg dev_std = 0.557)
NEC for r=0.3 class 2 = 0.702 +- 0.236 (in-sample avg dev_std = 0.557)
NEC for r=0.3 all KL = 0.706 +- 0.236 (in-sample avg dev_std = 0.557)
NEC for r=0.3 all L1 = 0.635 +- 0.182 (in-sample avg dev_std = 0.557)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44946433333333335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.542 +- 0.268 (in-sample avg dev_std = 0.626)
NEC for r=0.6 class 1 = 0.422 +- 0.268 (in-sample avg dev_std = 0.626)
NEC for r=0.6 class 2 = 0.556 +- 0.268 (in-sample avg dev_std = 0.626)
NEC for r=0.6 all KL = 0.562 +- 0.268 (in-sample avg dev_std = 0.626)
NEC for r=0.6 all L1 = 0.507 +- 0.198 (in-sample avg dev_std = 0.626)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329827
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0 = 0.452 +- 0.259 (in-sample avg dev_std = 0.638)
NEC for r=0.9 class 1 = 0.34 +- 0.259 (in-sample avg dev_std = 0.638)
NEC for r=0.9 class 2 = 0.461 +- 0.259 (in-sample avg dev_std = 0.638)
NEC for r=0.9 all KL = 0.462 +- 0.259 (in-sample avg dev_std = 0.638)
NEC for r=0.9 all L1 = 0.418 +- 0.184 (in-sample avg dev_std = 0.638)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7837400000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.444 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 1 = 0.239 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 2 = 0.465 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all KL = 0.336 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all L1 = 0.383 +- 0.278 (in-sample avg dev_std = 0.127)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7064046666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.443
NEC for r=0.6 class 0 = 0.343 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 class 1 = 0.163 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 class 2 = 0.41 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 all KL = 0.252 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 all L1 = 0.306 +- 0.239 (in-sample avg dev_std = 0.337)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.557
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.49540433333333334
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.29 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 class 1 = 0.134 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 class 2 = 0.37 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 all KL = 0.203 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 all L1 = 0.265 +- 0.205 (in-sample avg dev_std = 0.343)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:27:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:27:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.569
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.345
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.479


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5692403333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.827
SUFF_SIMPLE for r=0.3 class 0 = 0.694 +- 0.233 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.3 class 1 = 0.842 +- 0.233 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.3 class 2 = 0.757 +- 0.233 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.3 all KL = 0.793 +- 0.233 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.3 all L1 = 0.765 +- 0.184 (in-sample avg dev_std = 0.401)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474551
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.899
SUFF_SIMPLE for r=0.6 class 0 = 0.821 +- 0.137 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 1 = 0.878 +- 0.137 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 2 = 0.862 +- 0.137 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all KL = 0.906 +- 0.137 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all L1 = 0.854 +- 0.125 (in-sample avg dev_std = 0.216)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.344536
len(reference) = 2587
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.91
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.117 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.9 class 1 = 0.913 +- 0.117 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.9 class 2 = 0.926 +- 0.117 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.9 all KL = 0.955 +- 0.117 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.9 all L1 = 0.909 +- 0.118 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821423333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.592
SUFF_SIMPLE for r=0.3 class 0 = 0.773 +- 0.114 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.3 class 1 = 0.851 +- 0.114 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.3 class 2 = 0.654 +- 0.114 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.3 all KL = 0.88 +- 0.114 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.3 all L1 = 0.759 +- 0.139 (in-sample avg dev_std = 0.227)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.693346
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.65
SUFF_SIMPLE for r=0.6 class 0 = 0.834 +- 0.051 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.88 +- 0.051 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.668 +- 0.051 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.923 +- 0.051 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.794 +- 0.125 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5692403333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.386
NEC for r=0.3 class 0 = 0.672 +- 0.216 (in-sample avg dev_std = 0.564)
NEC for r=0.3 class 1 = 0.52 +- 0.216 (in-sample avg dev_std = 0.564)
NEC for r=0.3 class 2 = 0.686 +- 0.216 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all KL = 0.689 +- 0.216 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all L1 = 0.626 +- 0.170 (in-sample avg dev_std = 0.564)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474551
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.549
NEC for r=0.6 class 0 = 0.559 +- 0.253 (in-sample avg dev_std = 0.602)
NEC for r=0.6 class 1 = 0.39 +- 0.253 (in-sample avg dev_std = 0.602)
NEC for r=0.6 class 2 = 0.565 +- 0.253 (in-sample avg dev_std = 0.602)
NEC for r=0.6 all KL = 0.548 +- 0.253 (in-sample avg dev_std = 0.602)
NEC for r=0.6 all L1 = 0.505 +- 0.201 (in-sample avg dev_std = 0.602)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.344536
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.467 +- 0.244 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.319 +- 0.244 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.46 +- 0.244 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.445 +- 0.244 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.415 +- 0.187 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821423333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.45 +- 0.225 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1 = 0.252 +- 0.225 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 2 = 0.462 +- 0.225 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.275 +- 0.225 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.388 +- 0.224 (in-sample avg dev_std = 0.159)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.693346
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.435
NEC for r=0.6 class 0 = 0.364 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 1 = 0.213 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 2 = 0.43 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 all KL = 0.221 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 all L1 = 0.336 +- 0.200 (in-sample avg dev_std = 0.281)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.559
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4792123333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.501
NEC for r=0.9 class 0 = 0.313 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 class 1 = 0.187 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 class 2 = 0.402 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 all KL = 0.182 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 all L1 = 0.301 +- 0.169 (in-sample avg dev_std = 0.295)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:29:11 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:29:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.460
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.342
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.694
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.484


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5559223333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.848
SUFF_SIMPLE for r=0.3 class 0 = 0.75 +- 0.210 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 class 1 = 0.843 +- 0.210 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 class 2 = 0.776 +- 0.210 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 all KL = 0.826 +- 0.210 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 all L1 = 0.79 +- 0.166 (in-sample avg dev_std = 0.368)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45964499999999997
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.906
SUFF_SIMPLE for r=0.6 class 0 = 0.865 +- 0.109 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.6 class 1 = 0.875 +- 0.109 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.6 class 2 = 0.859 +- 0.109 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.6 all KL = 0.924 +- 0.109 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.6 all L1 = 0.866 +- 0.115 (in-sample avg dev_std = 0.182)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34182766666666664
len(reference) = 2457
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.912
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.093 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 1 = 0.887 +- 0.093 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 2 = 0.937 +- 0.093 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all KL = 0.954 +- 0.093 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all L1 = 0.901 +- 0.120 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7827820000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.751
SUFF_SIMPLE for r=0.3 class 0 = 0.822 +- 0.112 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.3 class 1 = 0.887 +- 0.112 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.3 class 2 = 0.648 +- 0.112 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.3 all KL = 0.892 +- 0.112 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.3 all L1 = 0.785 +- 0.148 (in-sample avg dev_std = 0.248)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.694314
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.818
SUFF_SIMPLE for r=0.6 class 0 = 0.886 +- 0.047 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.912 +- 0.047 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.671 +- 0.047 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.938 +- 0.047 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.823 +- 0.131 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5559223333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.7 +- 0.204 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 1 = 0.539 +- 0.204 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 2 = 0.706 +- 0.204 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all KL = 0.718 +- 0.204 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all L1 = 0.648 +- 0.163 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45964499999999997
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.558 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 1 = 0.394 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 2 = 0.561 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all KL = 0.553 +- 0.246 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all L1 = 0.504 +- 0.192 (in-sample avg dev_std = 0.617)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34182766666666664
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.666
NEC for r=0.9 class 0 = 0.455 +- 0.241 (in-sample avg dev_std = 0.626)
NEC for r=0.9 class 1 = 0.326 +- 0.241 (in-sample avg dev_std = 0.626)
NEC for r=0.9 class 2 = 0.469 +- 0.241 (in-sample avg dev_std = 0.626)
NEC for r=0.9 all KL = 0.452 +- 0.241 (in-sample avg dev_std = 0.626)
NEC for r=0.9 all L1 = 0.417 +- 0.180 (in-sample avg dev_std = 0.626)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7827820000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.648 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.307 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.491 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.374 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.483 +- 0.216 (in-sample avg dev_std = 0.214)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.694314
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.523
NEC for r=0.6 class 0 = 0.455 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 1 = 0.22 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 2 = 0.446 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all KL = 0.27 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all L1 = 0.374 +- 0.197 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.681
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48428000000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.607
NEC for r=0.9 class 0 = 0.381 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 1 = 0.188 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 2 = 0.415 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all KL = 0.221 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all L1 = 0.328 +- 0.168 (in-sample avg dev_std = 0.396)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:30:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:30:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.553
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.441
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.480


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5528086666666666
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.853
SUFF_SIMPLE for r=0.3 class 0 = 0.742 +- 0.205 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 class 1 = 0.865 +- 0.205 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 class 2 = 0.761 +- 0.205 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 all KL = 0.837 +- 0.205 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.3 all L1 = 0.79 +- 0.164 (in-sample avg dev_std = 0.354)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441395
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.906
SUFF_SIMPLE for r=0.6 class 0 = 0.861 +- 0.122 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.6 class 1 = 0.898 +- 0.122 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.6 class 2 = 0.846 +- 0.122 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.6 all KL = 0.931 +- 0.122 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.6 all L1 = 0.868 +- 0.112 (in-sample avg dev_std = 0.177)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33657966666666667
len(reference) = 2731
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.924
SUFF_SIMPLE for r=0.9 class 0 = 0.851 +- 0.071 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.9 class 1 = 0.915 +- 0.071 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.9 class 2 = 0.928 +- 0.071 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.9 all KL = 0.96 +- 0.071 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.9 all L1 = 0.899 +- 0.101 (in-sample avg dev_std = 0.079)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7829750000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.508
SUFF_SIMPLE for r=0.3 class 0 = 0.803 +- 0.100 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.3 class 1 = 0.931 +- 0.100 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.3 class 2 = 0.74 +- 0.100 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.3 all KL = 0.913 +- 0.100 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.3 all L1 = 0.824 +- 0.150 (in-sample avg dev_std = 0.205)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.69091
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.555
SUFF_SIMPLE for r=0.6 class 0 = 0.846 +- 0.066 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 class 1 = 0.945 +- 0.066 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 class 2 = 0.728 +- 0.066 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.939 +- 0.066 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.839 +- 0.145 (in-sample avg dev_std = 0.002)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4804170000000001
len(reference) = 76
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF_SIMPLE for r=0.9 class 0 = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.992 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.995 +- 0.005 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5528086666666666
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.367
NEC for r=0.3 class 0 = 0.696 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.3 class 1 = 0.512 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.3 class 2 = 0.687 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.3 all KL = 0.693 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.3 all L1 = 0.631 +- 0.170 (in-sample avg dev_std = 0.546)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441395
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.555
NEC for r=0.6 class 0 = 0.559 +- 0.245 (in-sample avg dev_std = 0.598)
NEC for r=0.6 class 1 = 0.383 +- 0.245 (in-sample avg dev_std = 0.598)
NEC for r=0.6 class 2 = 0.557 +- 0.245 (in-sample avg dev_std = 0.598)
NEC for r=0.6 all KL = 0.536 +- 0.245 (in-sample avg dev_std = 0.598)
NEC for r=0.6 all L1 = 0.499 +- 0.198 (in-sample avg dev_std = 0.598)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33657966666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.671
NEC for r=0.9 class 0 = 0.459 +- 0.237 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 1 = 0.303 +- 0.237 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 2 = 0.466 +- 0.237 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all KL = 0.431 +- 0.237 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all L1 = 0.409 +- 0.182 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7829750000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.325
NEC for r=0.3 class 0 = 0.393 +- 0.253 (in-sample avg dev_std = 0.142)
NEC for r=0.3 class 1 = 0.163 +- 0.253 (in-sample avg dev_std = 0.142)
NEC for r=0.3 class 2 = 0.285 +- 0.253 (in-sample avg dev_std = 0.142)
NEC for r=0.3 all KL = 0.222 +- 0.253 (in-sample avg dev_std = 0.142)
NEC for r=0.3 all L1 = 0.281 +- 0.270 (in-sample avg dev_std = 0.142)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.69091
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.325 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 class 1 = 0.123 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 class 2 = 0.28 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 all KL = 0.174 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 all L1 = 0.243 +- 0.225 (in-sample avg dev_std = 0.277)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4804170000000001
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
NEC for r=0.9 class 0 = 0.28 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 1 = 0.104 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 2 = 0.278 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all KL = 0.144 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all L1 = 0.221 +- 0.196 (in-sample avg dev_std = 0.278)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:33:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:33:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 151 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9293 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.563
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.702
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.563064
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.841
SUFF_SIMPLE for r=0.3 class 0 = 0.712 +- 0.216 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 1 = 0.857 +- 0.216 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 2 = 0.771 +- 0.216 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all KL = 0.818 +- 0.216 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all L1 = 0.781 +- 0.173 (in-sample avg dev_std = 0.371)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4744376666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.901
SUFF_SIMPLE for r=0.6 class 0 = 0.842 +- 0.118 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.6 class 1 = 0.893 +- 0.118 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.6 class 2 = 0.861 +- 0.118 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.6 all KL = 0.923 +- 0.118 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.6 all L1 = 0.866 +- 0.115 (in-sample avg dev_std = 0.185)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.345834
len(reference) = 2446
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.917
SUFF_SIMPLE for r=0.9 class 0 = 0.888 +- 0.092 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 1 = 0.925 +- 0.092 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 2 = 0.93 +- 0.092 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all KL = 0.963 +- 0.092 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all L1 = 0.915 +- 0.105 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.783864
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.747
SUFF_SIMPLE for r=0.3 class 0 = 0.754 +- 0.102 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.3 class 1 = 0.89 +- 0.102 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.3 class 2 = 0.679 +- 0.102 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.3 all KL = 0.899 +- 0.102 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.3 all L1 = 0.774 +- 0.122 (in-sample avg dev_std = 0.236)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7022463333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.805
SUFF_SIMPLE for r=0.6 class 0 = 0.809 +- 0.033 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.891 +- 0.033 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.714 +- 0.033 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.938 +- 0.033 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.804 +- 0.100 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.563064
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.362
NEC for r=0.3 class 0 = 0.685 +- 0.208 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 1 = 0.534 +- 0.208 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 2 = 0.7 +- 0.208 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all KL = 0.705 +- 0.208 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all L1 = 0.64 +- 0.168 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4744376666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.549
NEC for r=0.6 class 0 = 0.566 +- 0.248 (in-sample avg dev_std = 0.603)
NEC for r=0.6 class 1 = 0.391 +- 0.248 (in-sample avg dev_std = 0.603)
NEC for r=0.6 class 2 = 0.568 +- 0.248 (in-sample avg dev_std = 0.603)
NEC for r=0.6 all KL = 0.552 +- 0.248 (in-sample avg dev_std = 0.603)
NEC for r=0.6 all L1 = 0.508 +- 0.195 (in-sample avg dev_std = 0.603)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.345834
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.665
NEC for r=0.9 class 0 = 0.464 +- 0.238 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.32 +- 0.238 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.467 +- 0.238 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.447 +- 0.238 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.417 +- 0.181 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.783864
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.324
NEC for r=0.3 class 0 = 0.566 +- 0.248 (in-sample avg dev_std = 0.173)
NEC for r=0.3 class 1 = 0.336 +- 0.248 (in-sample avg dev_std = 0.173)
NEC for r=0.3 class 2 = 0.588 +- 0.248 (in-sample avg dev_std = 0.173)
NEC for r=0.3 all KL = 0.394 +- 0.248 (in-sample avg dev_std = 0.173)
NEC for r=0.3 all L1 = 0.497 +- 0.221 (in-sample avg dev_std = 0.173)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7022463333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0 = 0.444 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 1 = 0.239 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 2 = 0.496 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 all KL = 0.284 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 all L1 = 0.393 +- 0.201 (in-sample avg dev_std = 0.366)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4908126666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
NEC for r=0.9 class 0 = 0.383 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 1 = 0.207 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 2 = 0.441 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all KL = 0.229 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all L1 = 0.344 +- 0.167 (in-sample avg dev_std = 0.379)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:35:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:35:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.544
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.452
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.335
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.487


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.54449
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.838
SUFF_SIMPLE for r=0.3 class 0 = 0.736 +- 0.228 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 class 1 = 0.861 +- 0.228 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 class 2 = 0.768 +- 0.228 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 all KL = 0.82 +- 0.228 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 all L1 = 0.789 +- 0.177 (in-sample avg dev_std = 0.368)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45220400000000005
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.89
SUFF_SIMPLE for r=0.6 class 0 = 0.849 +- 0.149 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.6 class 1 = 0.9 +- 0.149 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.6 class 2 = 0.839 +- 0.149 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.6 all KL = 0.913 +- 0.149 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.6 all L1 = 0.863 +- 0.128 (in-sample avg dev_std = 0.222)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33499466666666666
len(reference) = 2657
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.925
SUFF_SIMPLE for r=0.9 class 0 = 0.854 +- 0.090 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 class 1 = 0.928 +- 0.090 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 class 2 = 0.929 +- 0.090 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 all KL = 0.957 +- 0.090 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 all L1 = 0.904 +- 0.109 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7838663333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.629
SUFF_SIMPLE for r=0.3 class 0 = 0.838 +- 0.116 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 class 1 = 0.918 +- 0.116 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 class 2 = 0.729 +- 0.116 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 all KL = 0.904 +- 0.116 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.3 all L1 = 0.828 +- 0.153 (in-sample avg dev_std = 0.254)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6968573333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.682
SUFF_SIMPLE for r=0.6 class 0 = 0.909 +- 0.057 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 class 1 = 0.955 +- 0.057 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 class 2 = 0.722 +- 0.057 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all KL = 0.948 +- 0.057 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.6 all L1 = 0.861 +- 0.142 (in-sample avg dev_std = 0.002)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.941
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48747699999999994
len(reference) = 850
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.941
SUFF_SIMPLE for r=0.9 class 0 = 0.98 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.977 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.973 +- 0.024 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.54449
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.378
NEC for r=0.3 class 0 = 0.678 +- 0.209 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 1 = 0.545 +- 0.209 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 2 = 0.674 +- 0.209 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all KL = 0.707 +- 0.209 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all L1 = 0.632 +- 0.168 (in-sample avg dev_std = 0.581)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45220400000000005
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.563
NEC for r=0.6 class 0 = 0.552 +- 0.242 (in-sample avg dev_std = 0.644)
NEC for r=0.6 class 1 = 0.411 +- 0.242 (in-sample avg dev_std = 0.644)
NEC for r=0.6 class 2 = 0.544 +- 0.242 (in-sample avg dev_std = 0.644)
NEC for r=0.6 all KL = 0.557 +- 0.242 (in-sample avg dev_std = 0.644)
NEC for r=0.6 all L1 = 0.502 +- 0.187 (in-sample avg dev_std = 0.644)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33499466666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.451 +- 0.247 (in-sample avg dev_std = 0.636)
NEC for r=0.9 class 1 = 0.329 +- 0.247 (in-sample avg dev_std = 0.636)
NEC for r=0.9 class 2 = 0.458 +- 0.247 (in-sample avg dev_std = 0.636)
NEC for r=0.9 all KL = 0.452 +- 0.247 (in-sample avg dev_std = 0.636)
NEC for r=0.9 all L1 = 0.413 +- 0.184 (in-sample avg dev_std = 0.636)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7838663333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.299
NEC for r=0.3 class 0 = 0.627 +- 0.260 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 1 = 0.3 +- 0.260 (in-sample avg dev_std = 0.219)
NEC for r=0.3 class 2 = 0.393 +- 0.260 (in-sample avg dev_std = 0.219)
NEC for r=0.3 all KL = 0.36 +- 0.260 (in-sample avg dev_std = 0.219)
NEC for r=0.3 all L1 = 0.441 +- 0.248 (in-sample avg dev_std = 0.219)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6968573333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.437
NEC for r=0.6 class 0 = 0.435 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 class 1 = 0.195 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 class 2 = 0.355 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 all KL = 0.255 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 all L1 = 0.329 +- 0.219 (in-sample avg dev_std = 0.398)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48747699999999994
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.359 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 1 = 0.17 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 2 = 0.331 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 all KL = 0.209 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 all L1 = 0.287 +- 0.187 (in-sample avg dev_std = 0.395)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.743, 0.887, 0.968], 'all_L1': [0.752, 0.856, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.84, 0.929, 0.971], 'all_L1': [0.8, 0.869, 0.915]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.904, 0.97], 'all_L1': [0.78, 0.857, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.838, 0.923, 0.969], 'all_L1': [0.8, 0.871, 0.92]}), defaultdict(<class 'list'>, {'all_KL': [0.809, 0.923, 0.933], 'all_L1': [0.781, 0.862, 0.87]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.906, 0.955], 'all_L1': [0.765, 0.854, 0.909]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.924, 0.954], 'all_L1': [0.79, 0.866, 0.901]}), defaultdict(<class 'list'>, {'all_KL': [0.837, 0.931, 0.96], 'all_L1': [0.79, 0.868, 0.899]}), defaultdict(<class 'list'>, {'all_KL': [0.818, 0.923, 0.963], 'all_L1': [0.781, 0.866, 0.915]}), defaultdict(<class 'list'>, {'all_KL': [0.82, 0.913, 0.957], 'all_L1': [0.789, 0.863, 0.904]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.761, 0.626, 0.52], 'all_L1': [0.66, 0.536, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.521, 0.415], 'all_L1': [0.625, 0.493, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.687, 0.545, 0.448], 'all_L1': [0.622, 0.495, 0.411]}), defaultdict(<class 'list'>, {'all_KL': [0.723, 0.563, 0.458], 'all_L1': [0.637, 0.499, 0.409]}), defaultdict(<class 'list'>, {'all_KL': [0.706, 0.562, 0.462], 'all_L1': [0.635, 0.507, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.689, 0.548, 0.445], 'all_L1': [0.626, 0.505, 0.415]}), defaultdict(<class 'list'>, {'all_KL': [0.718, 0.553, 0.452], 'all_L1': [0.648, 0.504, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.536, 0.431], 'all_L1': [0.631, 0.499, 0.409]}), defaultdict(<class 'list'>, {'all_KL': [0.705, 0.552, 0.447], 'all_L1': [0.64, 0.508, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.557, 0.452], 'all_L1': [0.632, 0.502, 0.413]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.877, 0.969, 0.983], 'all_L1': [0.803, 0.876, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.946, 0.996], 'all_L1': [0.799, 0.837, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.943, 1.0], 'all_L1': [0.782, 0.8, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.918, 0.956, 0.998], 'all_L1': [0.794, 0.822, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.9, 0.944, 0.996], 'all_L1': [0.822, 0.847, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.923, 1.0], 'all_L1': [0.759, 0.794, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.938, 1.0], 'all_L1': [0.785, 0.823, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.913, 0.939, 0.999], 'all_L1': [0.824, 0.839, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.938, 1.0], 'all_L1': [0.774, 0.804, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.948, 0.996], 'all_L1': [0.828, 0.861, 0.973]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.517, 0.366, 0.302], 'all_L1': [0.547, 0.4, 0.347]}), defaultdict(<class 'list'>, {'all_KL': [0.428, 0.3, 0.241], 'all_L1': [0.526, 0.394, 0.339]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.234, 0.188], 'all_L1': [0.413, 0.34, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.321, 0.254], 'all_L1': [0.597, 0.43, 0.371]}), defaultdict(<class 'list'>, {'all_KL': [0.336, 0.252, 0.203], 'all_L1': [0.383, 0.306, 0.265]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.221, 0.182], 'all_L1': [0.388, 0.336, 0.301]}), defaultdict(<class 'list'>, {'all_KL': [0.374, 0.27, 0.221], 'all_L1': [0.483, 0.374, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.222, 0.174, 0.144], 'all_L1': [0.281, 0.243, 0.221]}), defaultdict(<class 'list'>, {'all_KL': [0.394, 0.284, 0.229], 'all_L1': [0.497, 0.393, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.255, 0.209], 'all_L1': [0.441, 0.329, 0.287]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.783 +- 0.014, 0.863 +- 0.006, 0.908 +- 0.016
suff_simple class all_KL  =  0.813 +- 0.027, 0.916 +- 0.013, 0.960 +- 0.011
[[0.8027083277702332, 0.8791666626930237, 0.9105038046836853], [0.8522499799728394, 0.9021666646003723, 0.9117059707641602], [0.8328333497047424, 0.8855416774749756, 0.922621488571167], [0.8544583320617676, 0.8987083435058594, 0.9192531704902649], [0.8494583368301392, 0.9119166731834412, 0.9185468554496765], [0.8272500038146973, 0.8990833163261414, 0.910127580165863], [0.8484583497047424, 0.90645831823349, 0.9123423099517822], [0.8527083396911621, 0.905916690826416, 0.9242951273918152], [0.8414583206176758, 0.9012916684150696, 0.9167518615722656], [0.8378750085830688, 0.8901666402816772, 0.9249623417854309]]
[[0.743, 0.887, 0.968], [0.84, 0.929, 0.971], [0.806, 0.904, 0.97], [0.838, 0.923, 0.969], [0.809, 0.923, 0.933], [0.793, 0.906, 0.955], [0.826, 0.924, 0.954], [0.837, 0.931, 0.96], [0.818, 0.923, 0.963], [0.82, 0.913, 0.957]]
suff_simple_acc_int  =  0.840 +- 0.015, 0.898 +- 0.010, 0.917 +- 0.005
nec class all_L1  =  0.636 +- 0.011, 0.505 +- 0.011, 0.415 +- 0.010
nec class all_KL  =  0.706 +- 0.024, 0.556 +- 0.026, 0.453 +- 0.026
[[0.37045833468437195, 0.5320000052452087, 0.6449999809265137], [0.3804583251476288, 0.5644166469573975, 0.6766250133514404], [0.39366665482521057, 0.5739166736602783, 0.6706666946411133], [0.37295833230018616, 0.565833330154419, 0.6692916750907898], [0.3675000071525574, 0.5587083101272583, 0.6723750233650208], [0.3855416774749756, 0.5491666793823242, 0.6627916693687439], [0.35091665387153625, 0.5590833425521851, 0.6657083630561829], [0.36666667461395264, 0.5552083253860474, 0.6706249713897705], [0.3623749911785126, 0.5487499833106995, 0.6648333072662354], [0.37841665744781494, 0.5632500052452087, 0.6632500290870667]]
[[0.761, 0.626, 0.52], [0.669, 0.521, 0.415], [0.687, 0.545, 0.448], [0.723, 0.563, 0.458], [0.706, 0.562, 0.462], [0.689, 0.548, 0.445], [0.718, 0.553, 0.452], [0.693, 0.536, 0.431], [0.705, 0.552, 0.447], [0.707, 0.557, 0.452]]
nec_acc_int  =  0.373 +- 0.012, 0.557 +- 0.011, 0.666 +- 0.008

Eval split val
suff_simple class all_L1  =  0.797 +- 0.022, 0.830 +- 0.025, 0.980 +- 0.025
suff_simple class all_KL  =  0.899 +- 0.013, 0.944 +- 0.012, 0.997 +- 0.005
[[0.6581666469573975, 0.6919999718666077, 0.5980091691017151], [0.7681249976158142, 0.8286666870117188, 1.0], [0.699791669845581, 0.7456666827201843, -1.0], [0.8694166541099548, 0.906333327293396, 0.9166666865348816], [0.6000416874885559, 0.6420000195503235, 0.8928571343421936], [0.5919583439826965, 0.6496666669845581, -1.0], [0.7513750195503235, 0.8183333277702332, -1.0], [0.5078333616256714, 0.5546666383743286, 0.8815789222717285], [0.7474583387374878, 0.8046666383743286, -1.0], [0.6291666626930237, 0.6816666722297668, 0.9411764740943909]]
[[0.877, 0.969, 0.983], [0.899, 0.946, 0.996], [0.912, 0.943, 1.0], [0.918, 0.956, 0.998], [0.9, 0.944, 0.996], [0.88, 0.923, 1.0], [0.892, 0.938, 1.0], [0.913, 0.939, 0.999], [0.899, 0.938, 1.0], [0.904, 0.948, 0.996]]
suff_simple_acc_int  =  0.682 +- 0.100, 0.732 +- 0.102, 0.123 +- 0.922
nec class all_L1  =  0.456 +- 0.088, 0.355 +- 0.052, 0.310 +- 0.042
nec class all_KL  =  0.371 +- 0.086, 0.268 +- 0.051, 0.217 +- 0.041
[[0.28337499499320984, 0.46958333253860474, 0.5305833220481873], [0.31975001096725464, 0.5276250243186951, 0.6140833497047424], [0.31995832920074463, 0.4947499930858612, 0.5690416693687439], [0.3173750042915344, 0.5920416712760925, 0.6804999709129333], [0.33024999499320984, 0.4429166615009308, 0.5051249861717224], [0.33420833945274353, 0.4351249933242798, 0.5005833506584167], [0.33399999141693115, 0.5230416655540466, 0.6069999933242798], [0.3246249854564667, 0.38462498784065247, 0.44191667437553406], [0.32362499833106995, 0.5129166841506958, 0.5979166626930237], [0.2991666793823242, 0.437375009059906, 0.515375018119812]]
[[0.517, 0.366, 0.302], [0.428, 0.3, 0.241], [0.32, 0.234, 0.188], [0.489, 0.321, 0.254], [0.336, 0.252, 0.203], [0.275, 0.221, 0.182], [0.374, 0.27, 0.221], [0.222, 0.174, 0.144], [0.394, 0.284, 0.229], [0.36, 0.255, 0.209]]
nec_acc_int  =  0.319 +- 0.015, 0.482 +- 0.057, 0.556 +- 0.067


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.709 +- 0.007, 0.684 +- 0.005, 0.661 +- 0.010
Faith. Armon (L1)= 		  =  0.701 +- 0.007, 0.637 +- 0.008, 0.569 +- 0.011
Faith. GMean (L1)= 	  =  0.705 +- 0.007, 0.660 +- 0.007, 0.614 +- 0.010
Faith. Aritm (KL)= 		  =  0.759 +- 0.011, 0.736 +- 0.009, 0.706 +- 0.014
Faith. Armon (KL)= 		  =  0.755 +- 0.011, 0.692 +- 0.017, 0.615 +- 0.023
Faith. GMean (KL)= 	  =  0.757 +- 0.011, 0.714 +- 0.013, 0.659 +- 0.019

Eval split val
Faith. Aritm (L1)= 		  =  0.626 +- 0.043, 0.592 +- 0.028, 0.645 +- 0.020
Faith. Armon (L1)= 		  =  0.574 +- 0.074, 0.494 +- 0.053, 0.470 +- 0.049
Faith. GMean (L1)= 	  =  0.599 +- 0.059, 0.541 +- 0.042, 0.550 +- 0.037
Faith. Aritm (KL)= 		  =  0.635 +- 0.042, 0.606 +- 0.030, 0.607 +- 0.019
Faith. Armon (KL)= 		  =  0.520 +- 0.087, 0.415 +- 0.063, 0.355 +- 0.055
Faith. GMean (KL)= 	  =  0.574 +- 0.067, 0.501 +- 0.051, 0.463 +- 0.043
Computed for split load_split = id



Completed in  0:21:09.207875  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GSAT GOODMotif/basis/covariate NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:38:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:38:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.199
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17762033333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.652
SUFF_SIMPLE for r=0.3 class 0 = 0.519 +- 0.282 (in-sample avg dev_std = 0.656)
SUFF_SIMPLE for r=0.3 class 1 = 0.673 +- 0.282 (in-sample avg dev_std = 0.656)
SUFF_SIMPLE for r=0.3 class 2 = 0.529 +- 0.282 (in-sample avg dev_std = 0.656)
SUFF_SIMPLE for r=0.3 all KL = 0.498 +- 0.282 (in-sample avg dev_std = 0.656)
SUFF_SIMPLE for r=0.3 all L1 = 0.574 +- 0.212 (in-sample avg dev_std = 0.656)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24807933333333335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.655
SUFF_SIMPLE for r=0.6 class 0 = 0.515 +- 0.300 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.6 class 1 = 0.685 +- 0.300 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.6 class 2 = 0.541 +- 0.300 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.6 all KL = 0.514 +- 0.300 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.6 all L1 = 0.581 +- 0.227 (in-sample avg dev_std = 0.625)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29458399999999996
len(reference) = 2710
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.676
SUFF_SIMPLE for r=0.9 class 0 = 0.589 +- 0.365 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.365 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.9 class 2 = 0.601 +- 0.365 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.9 all KL = 0.641 +- 0.365 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.9 all L1 = 0.65 +- 0.298 (in-sample avg dev_std = 0.375)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19912633333333335
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
SUFF_SIMPLE for r=0.3 class 0 = 0.636 +- 0.242 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 class 1 = 0.767 +- 0.242 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 class 2 = 0.533 +- 0.242 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 all KL = 0.688 +- 0.242 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 all L1 = 0.645 +- 0.197 (in-sample avg dev_std = 0.437)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3169956666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.516
SUFF_SIMPLE for r=0.6 class 0 = 0.636 +- 0.245 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.6 class 1 = 0.758 +- 0.245 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.6 class 2 = 0.548 +- 0.245 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.6 all KL = 0.694 +- 0.245 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.6 all L1 = 0.647 +- 0.199 (in-sample avg dev_std = 0.411)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36216099999999996
len(reference) = 2689
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.43
SUFF_SIMPLE for r=0.9 class 0 = 0.573 +- 0.308 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 class 1 = 0.551 +- 0.308 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 class 2 = 0.515 +- 0.308 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 all KL = 0.595 +- 0.308 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 all L1 = 0.545 +- 0.238 (in-sample avg dev_std = 0.051)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17762033333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.668
NEC for r=0.3 class 0 = 0.47 +- 0.306 (in-sample avg dev_std = 0.616)
NEC for r=0.3 class 1 = 0.302 +- 0.306 (in-sample avg dev_std = 0.616)
NEC for r=0.3 class 2 = 0.445 +- 0.306 (in-sample avg dev_std = 0.616)
NEC for r=0.3 all KL = 0.468 +- 0.306 (in-sample avg dev_std = 0.616)
NEC for r=0.3 all L1 = 0.405 +- 0.231 (in-sample avg dev_std = 0.616)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24807933333333335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.661
NEC for r=0.6 class 0 = 0.488 +- 0.284 (in-sample avg dev_std = 0.651)
NEC for r=0.6 class 1 = 0.319 +- 0.284 (in-sample avg dev_std = 0.651)
NEC for r=0.6 class 2 = 0.459 +- 0.284 (in-sample avg dev_std = 0.651)
NEC for r=0.6 all KL = 0.496 +- 0.284 (in-sample avg dev_std = 0.651)
NEC for r=0.6 all L1 = 0.421 +- 0.212 (in-sample avg dev_std = 0.651)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29458399999999996
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.659
NEC for r=0.9 class 0 = 0.489 +- 0.278 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 1 = 0.32 +- 0.278 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 2 = 0.469 +- 0.278 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all KL = 0.504 +- 0.278 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all L1 = 0.426 +- 0.207 (in-sample avg dev_std = 0.665)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19912633333333335
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.562
NEC for r=0.3 class 0 = 0.342 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 1 = 0.2 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 2 = 0.378 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all KL = 0.253 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all L1 = 0.307 +- 0.194 (in-sample avg dev_std = 0.388)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3169956666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.544
NEC for r=0.6 class 0 = 0.348 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 class 1 = 0.217 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 class 2 = 0.424 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 all KL = 0.284 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 all L1 = 0.33 +- 0.190 (in-sample avg dev_std = 0.425)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36216099999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.352 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 1 = 0.209 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 2 = 0.432 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all KL = 0.284 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all L1 = 0.331 +- 0.188 (in-sample avg dev_std = 0.436)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:40:52 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:40:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18396600000000002
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.691
SUFF_SIMPLE for r=0.3 class 0 = 0.558 +- 0.260 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.3 class 1 = 0.714 +- 0.260 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.3 class 2 = 0.576 +- 0.260 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.3 all KL = 0.604 +- 0.260 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.3 all L1 = 0.616 +- 0.193 (in-sample avg dev_std = 0.578)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.252917
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.688
SUFF_SIMPLE for r=0.6 class 0 = 0.562 +- 0.274 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.6 class 1 = 0.716 +- 0.274 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.6 class 2 = 0.583 +- 0.274 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.6 all KL = 0.613 +- 0.274 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.6 all L1 = 0.621 +- 0.207 (in-sample avg dev_std = 0.552)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29539166666666666
len(reference) = 2709
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.712
SUFF_SIMPLE for r=0.9 class 0 = 0.64 +- 0.327 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.9 class 1 = 0.757 +- 0.327 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.9 class 2 = 0.645 +- 0.327 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.9 all KL = 0.713 +- 0.327 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.9 all L1 = 0.681 +- 0.271 (in-sample avg dev_std = 0.316)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21260500000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.607
SUFF_SIMPLE for r=0.3 class 0 = 0.573 +- 0.200 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 class 1 = 0.806 +- 0.200 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 class 2 = 0.589 +- 0.200 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 all KL = 0.754 +- 0.200 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 all L1 = 0.655 +- 0.184 (in-sample avg dev_std = 0.417)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3208033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.604
SUFF_SIMPLE for r=0.6 class 0 = 0.579 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.6 class 1 = 0.799 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.6 class 2 = 0.588 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.6 all KL = 0.754 +- 0.210 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.6 all L1 = 0.655 +- 0.194 (in-sample avg dev_std = 0.388)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.352682
len(reference) = 2606
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.371
SUFF_SIMPLE for r=0.9 class 0 = 0.402 +- 0.253 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.9 class 1 = 0.635 +- 0.253 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.253 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.9 all KL = 0.636 +- 0.253 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.9 all L1 = 0.519 +- 0.227 (in-sample avg dev_std = 0.038)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18396600000000002
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.691
NEC for r=0.3 class 0 = 0.43 +- 0.272 (in-sample avg dev_std = 0.554)
NEC for r=0.3 class 1 = 0.285 +- 0.272 (in-sample avg dev_std = 0.554)
NEC for r=0.3 class 2 = 0.417 +- 0.272 (in-sample avg dev_std = 0.554)
NEC for r=0.3 all KL = 0.385 +- 0.272 (in-sample avg dev_std = 0.554)
NEC for r=0.3 all L1 = 0.377 +- 0.206 (in-sample avg dev_std = 0.554)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.252917
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
NEC for r=0.6 class 0 = 0.437 +- 0.257 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 1 = 0.285 +- 0.257 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 2 = 0.427 +- 0.257 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all KL = 0.395 +- 0.257 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all L1 = 0.383 +- 0.191 (in-sample avg dev_std = 0.579)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29539166666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.691
NEC for r=0.9 class 0 = 0.437 +- 0.256 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 1 = 0.286 +- 0.256 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 2 = 0.429 +- 0.256 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all KL = 0.396 +- 0.256 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all L1 = 0.384 +- 0.188 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21260500000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.63
NEC for r=0.3 class 0 = 0.406 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 1 = 0.169 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 2 = 0.393 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all KL = 0.224 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all L1 = 0.323 +- 0.195 (in-sample avg dev_std = 0.379)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3208033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.621
NEC for r=0.6 class 0 = 0.414 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.173 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.399 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.231 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.329 +- 0.184 (in-sample avg dev_std = 0.407)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.352682
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.63
NEC for r=0.9 class 0 = 0.405 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 1 = 0.168 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 2 = 0.402 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all KL = 0.228 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all L1 = 0.325 +- 0.182 (in-sample avg dev_std = 0.413)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:43:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:43:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.319
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18159266666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.686
SUFF_SIMPLE for r=0.3 class 0 = 0.558 +- 0.260 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.3 class 1 = 0.719 +- 0.260 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.3 class 2 = 0.559 +- 0.260 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.3 all KL = 0.582 +- 0.260 (in-sample avg dev_std = 0.603)
SUFF_SIMPLE for r=0.3 all L1 = 0.612 +- 0.192 (in-sample avg dev_std = 0.603)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25062633333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.685
SUFF_SIMPLE for r=0.6 class 0 = 0.56 +- 0.275 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.6 class 1 = 0.719 +- 0.275 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.6 class 2 = 0.562 +- 0.275 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.6 all KL = 0.587 +- 0.275 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.6 all L1 = 0.614 +- 0.207 (in-sample avg dev_std = 0.579)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29474066666666665
len(reference) = 2716
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.707
SUFF_SIMPLE for r=0.9 class 0 = 0.621 +- 0.340 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.9 class 1 = 0.766 +- 0.340 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.9 class 2 = 0.631 +- 0.340 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.9 all KL = 0.691 +- 0.340 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.9 all L1 = 0.673 +- 0.276 (in-sample avg dev_std = 0.344)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21290133333333336
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.56
SUFF_SIMPLE for r=0.3 class 0 = 0.683 +- 0.181 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 1 = 0.832 +- 0.181 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 2 = 0.574 +- 0.181 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all KL = 0.809 +- 0.181 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all L1 = 0.696 +- 0.172 (in-sample avg dev_std = 0.331)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3194286666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.546
SUFF_SIMPLE for r=0.6 class 0 = 0.682 +- 0.197 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 class 1 = 0.831 +- 0.197 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 class 2 = 0.558 +- 0.197 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 all KL = 0.803 +- 0.197 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 all L1 = 0.69 +- 0.186 (in-sample avg dev_std = 0.311)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.582
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35187466666666667
len(reference) = 2591
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF_SIMPLE for r=0.9 class 0 = 0.69 +- 0.244 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.9 class 1 = 0.755 +- 0.244 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.9 class 2 = 0.472 +- 0.244 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.9 all KL = 0.748 +- 0.244 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.9 all L1 = 0.637 +- 0.234 (in-sample avg dev_std = 0.018)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18159266666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.688
NEC for r=0.3 class 0 = 0.432 +- 0.283 (in-sample avg dev_std = 0.574)
NEC for r=0.3 class 1 = 0.278 +- 0.283 (in-sample avg dev_std = 0.574)
NEC for r=0.3 class 2 = 0.422 +- 0.283 (in-sample avg dev_std = 0.574)
NEC for r=0.3 all KL = 0.402 +- 0.283 (in-sample avg dev_std = 0.574)
NEC for r=0.3 all L1 = 0.377 +- 0.213 (in-sample avg dev_std = 0.574)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25062633333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
NEC for r=0.6 class 0 = 0.439 +- 0.264 (in-sample avg dev_std = 0.604)
NEC for r=0.6 class 1 = 0.287 +- 0.264 (in-sample avg dev_std = 0.604)
NEC for r=0.6 class 2 = 0.436 +- 0.264 (in-sample avg dev_std = 0.604)
NEC for r=0.6 all KL = 0.417 +- 0.264 (in-sample avg dev_std = 0.604)
NEC for r=0.6 all L1 = 0.387 +- 0.195 (in-sample avg dev_std = 0.604)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29474066666666665
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.679
NEC for r=0.9 class 0 = 0.45 +- 0.253 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 1 = 0.295 +- 0.253 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 2 = 0.45 +- 0.253 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all KL = 0.433 +- 0.253 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all L1 = 0.398 +- 0.184 (in-sample avg dev_std = 0.621)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21290133333333336
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.586
NEC for r=0.3 class 0 = 0.306 +- 0.184 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 1 = 0.157 +- 0.184 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 2 = 0.407 +- 0.184 (in-sample avg dev_std = 0.298)
NEC for r=0.3 all KL = 0.175 +- 0.184 (in-sample avg dev_std = 0.298)
NEC for r=0.3 all L1 = 0.291 +- 0.175 (in-sample avg dev_std = 0.298)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3194286666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.582
NEC for r=0.6 class 0 = 0.313 +- 0.175 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 1 = 0.162 +- 0.175 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 2 = 0.411 +- 0.175 (in-sample avg dev_std = 0.323)
NEC for r=0.6 all KL = 0.181 +- 0.175 (in-sample avg dev_std = 0.323)
NEC for r=0.6 all L1 = 0.296 +- 0.167 (in-sample avg dev_std = 0.323)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35187466666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.58
NEC for r=0.9 class 0 = 0.316 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 class 1 = 0.157 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 class 2 = 0.413 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 all KL = 0.181 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 all L1 = 0.296 +- 0.168 (in-sample avg dev_std = 0.328)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:45:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:45:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.318
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18085366666666663
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.681
SUFF_SIMPLE for r=0.3 class 0 = 0.56 +- 0.258 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.3 class 1 = 0.697 +- 0.258 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.3 class 2 = 0.555 +- 0.258 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.3 all KL = 0.561 +- 0.258 (in-sample avg dev_std = 0.618)
SUFF_SIMPLE for r=0.3 all L1 = 0.604 +- 0.194 (in-sample avg dev_std = 0.618)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2496743333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.682
SUFF_SIMPLE for r=0.6 class 0 = 0.571 +- 0.278 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 1 = 0.7 +- 0.278 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 2 = 0.561 +- 0.278 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all KL = 0.575 +- 0.278 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all L1 = 0.611 +- 0.210 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2942963333333333
len(reference) = 2707
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.697
SUFF_SIMPLE for r=0.9 class 0 = 0.627 +- 0.345 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.9 class 1 = 0.751 +- 0.345 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.9 class 2 = 0.629 +- 0.345 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.9 all KL = 0.682 +- 0.345 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.9 all L1 = 0.67 +- 0.280 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21671533333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.673
SUFF_SIMPLE for r=0.3 class 0 = 0.563 +- 0.174 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 class 1 = 0.735 +- 0.174 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 class 2 = 0.575 +- 0.174 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 all KL = 0.741 +- 0.174 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 all L1 = 0.624 +- 0.148 (in-sample avg dev_std = 0.423)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31824933333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.655
SUFF_SIMPLE for r=0.6 class 0 = 0.558 +- 0.193 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.6 class 1 = 0.726 +- 0.193 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.6 class 2 = 0.562 +- 0.193 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.6 all KL = 0.732 +- 0.193 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.6 all L1 = 0.615 +- 0.164 (in-sample avg dev_std = 0.404)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3517643333333334
len(reference) = 2637
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.407
SUFF_SIMPLE for r=0.9 class 0 = 0.446 +- 0.225 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 class 1 = 0.527 +- 0.225 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 class 2 = 0.404 +- 0.225 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 all KL = 0.596 +- 0.225 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 all L1 = 0.458 +- 0.188 (in-sample avg dev_std = 0.053)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18085366666666663
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.697
NEC for r=0.3 class 0 = 0.421 +- 0.281 (in-sample avg dev_std = 0.574)
NEC for r=0.3 class 1 = 0.277 +- 0.281 (in-sample avg dev_std = 0.574)
NEC for r=0.3 class 2 = 0.427 +- 0.281 (in-sample avg dev_std = 0.574)
NEC for r=0.3 all KL = 0.404 +- 0.281 (in-sample avg dev_std = 0.574)
NEC for r=0.3 all L1 = 0.375 +- 0.212 (in-sample avg dev_std = 0.574)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2496743333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.692
NEC for r=0.6 class 0 = 0.427 +- 0.260 (in-sample avg dev_std = 0.614)
NEC for r=0.6 class 1 = 0.302 +- 0.260 (in-sample avg dev_std = 0.614)
NEC for r=0.6 class 2 = 0.429 +- 0.260 (in-sample avg dev_std = 0.614)
NEC for r=0.6 all KL = 0.428 +- 0.260 (in-sample avg dev_std = 0.614)
NEC for r=0.6 all L1 = 0.386 +- 0.194 (in-sample avg dev_std = 0.614)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2942963333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.687
NEC for r=0.9 class 0 = 0.443 +- 0.257 (in-sample avg dev_std = 0.622)
NEC for r=0.9 class 1 = 0.3 +- 0.257 (in-sample avg dev_std = 0.622)
NEC for r=0.9 class 2 = 0.436 +- 0.257 (in-sample avg dev_std = 0.622)
NEC for r=0.9 all KL = 0.436 +- 0.257 (in-sample avg dev_std = 0.622)
NEC for r=0.9 all L1 = 0.393 +- 0.191 (in-sample avg dev_std = 0.622)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21671533333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.701
NEC for r=0.3 class 0 = 0.424 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.239 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.384 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.233 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.35 +- 0.166 (in-sample avg dev_std = 0.389)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31824933333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.694
NEC for r=0.6 class 0 = 0.432 +- 0.175 (in-sample avg dev_std = 0.413)
NEC for r=0.6 class 1 = 0.243 +- 0.175 (in-sample avg dev_std = 0.413)
NEC for r=0.6 class 2 = 0.398 +- 0.175 (in-sample avg dev_std = 0.413)
NEC for r=0.6 all KL = 0.241 +- 0.175 (in-sample avg dev_std = 0.413)
NEC for r=0.6 all L1 = 0.358 +- 0.151 (in-sample avg dev_std = 0.413)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3517643333333334
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.702
NEC for r=0.9 class 0 = 0.423 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 1 = 0.236 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 2 = 0.397 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 all KL = 0.237 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 all L1 = 0.353 +- 0.148 (in-sample avg dev_std = 0.417)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:46:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:46:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.212
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.314
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18097233333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.685
SUFF_SIMPLE for r=0.3 class 0 = 0.566 +- 0.267 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.3 class 1 = 0.669 +- 0.267 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.3 class 2 = 0.558 +- 0.267 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.3 all KL = 0.561 +- 0.267 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.3 all L1 = 0.598 +- 0.191 (in-sample avg dev_std = 0.616)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2492123333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.682
SUFF_SIMPLE for r=0.6 class 0 = 0.564 +- 0.283 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.6 class 1 = 0.68 +- 0.283 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.6 class 2 = 0.563 +- 0.283 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.6 all KL = 0.57 +- 0.283 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.6 all L1 = 0.602 +- 0.206 (in-sample avg dev_std = 0.592)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29534666666666665
len(reference) = 2708
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.703
SUFF_SIMPLE for r=0.9 class 0 = 0.63 +- 0.345 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.9 class 1 = 0.719 +- 0.345 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.9 class 2 = 0.646 +- 0.345 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.9 all KL = 0.684 +- 0.345 (in-sample avg dev_std = 0.342)
SUFF_SIMPLE for r=0.9 all L1 = 0.665 +- 0.281 (in-sample avg dev_std = 0.342)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21238000000000004
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF_SIMPLE for r=0.3 class 0 = 0.706 +- 0.212 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 class 1 = 0.868 +- 0.212 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 class 2 = 0.625 +- 0.212 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 all KL = 0.795 +- 0.212 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 all L1 = 0.733 +- 0.209 (in-sample avg dev_std = 0.339)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3144793333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.493
SUFF_SIMPLE for r=0.6 class 0 = 0.704 +- 0.228 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 1 = 0.859 +- 0.228 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 2 = 0.613 +- 0.228 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all KL = 0.788 +- 0.228 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all L1 = 0.725 +- 0.222 (in-sample avg dev_std = 0.314)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.538
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35299
len(reference) = 2647
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.383
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.276 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 class 1 = 0.79 +- 0.276 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 class 2 = 0.601 +- 0.276 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 all KL = 0.737 +- 0.276 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 all L1 = 0.683 +- 0.263 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18097233333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.688
NEC for r=0.3 class 0 = 0.436 +- 0.289 (in-sample avg dev_std = 0.580)
NEC for r=0.3 class 1 = 0.314 +- 0.289 (in-sample avg dev_std = 0.580)
NEC for r=0.3 class 2 = 0.414 +- 0.289 (in-sample avg dev_std = 0.580)
NEC for r=0.3 all KL = 0.416 +- 0.289 (in-sample avg dev_std = 0.580)
NEC for r=0.3 all L1 = 0.387 +- 0.212 (in-sample avg dev_std = 0.580)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2492123333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
NEC for r=0.6 class 0 = 0.437 +- 0.266 (in-sample avg dev_std = 0.612)
NEC for r=0.6 class 1 = 0.332 +- 0.266 (in-sample avg dev_std = 0.612)
NEC for r=0.6 class 2 = 0.425 +- 0.266 (in-sample avg dev_std = 0.612)
NEC for r=0.6 all KL = 0.434 +- 0.266 (in-sample avg dev_std = 0.612)
NEC for r=0.6 all L1 = 0.398 +- 0.190 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29534666666666665
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.685
NEC for r=0.9 class 0 = 0.434 +- 0.262 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 1 = 0.328 +- 0.262 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 2 = 0.435 +- 0.262 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all KL = 0.438 +- 0.262 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all L1 = 0.399 +- 0.187 (in-sample avg dev_std = 0.621)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21238000000000004
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.518
NEC for r=0.3 class 0 = 0.279 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1 = 0.122 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 2 = 0.357 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.187 +- 0.210 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.253 +- 0.207 (in-sample avg dev_std = 0.309)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3144793333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.511
NEC for r=0.6 class 0 = 0.283 +- 0.202 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 1 = 0.125 +- 0.202 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 2 = 0.361 +- 0.202 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all KL = 0.193 +- 0.202 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all L1 = 0.257 +- 0.202 (in-sample avg dev_std = 0.333)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.557
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35299
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.509
NEC for r=0.9 class 0 = 0.286 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 class 1 = 0.122 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 class 2 = 0.37 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 all KL = 0.196 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 all L1 = 0.26 +- 0.204 (in-sample avg dev_std = 0.340)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:48:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:48:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18091666666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.674
SUFF_SIMPLE for r=0.3 class 0 = 0.553 +- 0.252 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.3 class 1 = 0.691 +- 0.252 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.3 class 2 = 0.56 +- 0.252 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.3 all KL = 0.576 +- 0.252 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.3 all L1 = 0.601 +- 0.194 (in-sample avg dev_std = 0.597)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25043699999999997
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.663
SUFF_SIMPLE for r=0.6 class 0 = 0.54 +- 0.270 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 class 1 = 0.697 +- 0.270 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 class 2 = 0.553 +- 0.270 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 all KL = 0.573 +- 0.270 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 all L1 = 0.597 +- 0.209 (in-sample avg dev_std = 0.582)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29582533333333333
len(reference) = 2712
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.687
SUFF_SIMPLE for r=0.9 class 0 = 0.611 +- 0.340 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.340 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.9 class 2 = 0.624 +- 0.340 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.9 all KL = 0.675 +- 0.340 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.9 all L1 = 0.66 +- 0.278 (in-sample avg dev_std = 0.358)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21709066666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.496
SUFF_SIMPLE for r=0.3 class 0 = 0.684 +- 0.165 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 class 1 = 0.809 +- 0.165 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 class 2 = 0.596 +- 0.165 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 all KL = 0.814 +- 0.165 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 all L1 = 0.696 +- 0.174 (in-sample avg dev_std = 0.288)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32173900000000005
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.492
SUFF_SIMPLE for r=0.6 class 0 = 0.688 +- 0.175 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.6 class 1 = 0.805 +- 0.175 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.6 class 2 = 0.59 +- 0.175 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.6 all KL = 0.812 +- 0.175 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.6 all L1 = 0.694 +- 0.181 (in-sample avg dev_std = 0.269)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.545
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3521206666666667
len(reference) = 2611
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.369
SUFF_SIMPLE for r=0.9 class 0 = 0.621 +- 0.217 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 class 1 = 0.73 +- 0.217 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 class 2 = 0.587 +- 0.217 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 all KL = 0.761 +- 0.217 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 all L1 = 0.645 +- 0.215 (in-sample avg dev_std = 0.010)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18091666666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.684
NEC for r=0.3 class 0 = 0.444 +- 0.270 (in-sample avg dev_std = 0.570)
NEC for r=0.3 class 1 = 0.289 +- 0.270 (in-sample avg dev_std = 0.570)
NEC for r=0.3 class 2 = 0.422 +- 0.270 (in-sample avg dev_std = 0.570)
NEC for r=0.3 all KL = 0.405 +- 0.270 (in-sample avg dev_std = 0.570)
NEC for r=0.3 all L1 = 0.385 +- 0.210 (in-sample avg dev_std = 0.570)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25043699999999997
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.681
NEC for r=0.6 class 0 = 0.452 +- 0.252 (in-sample avg dev_std = 0.599)
NEC for r=0.6 class 1 = 0.304 +- 0.252 (in-sample avg dev_std = 0.599)
NEC for r=0.6 class 2 = 0.433 +- 0.252 (in-sample avg dev_std = 0.599)
NEC for r=0.6 all KL = 0.422 +- 0.252 (in-sample avg dev_std = 0.599)
NEC for r=0.6 all L1 = 0.396 +- 0.193 (in-sample avg dev_std = 0.599)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29582533333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0 = 0.46 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 1 = 0.314 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 2 = 0.444 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all KL = 0.435 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all L1 = 0.405 +- 0.189 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21709066666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.508
NEC for r=0.3 class 0 = 0.307 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1 = 0.177 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 2 = 0.396 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.175 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.294 +- 0.179 (in-sample avg dev_std = 0.263)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32173900000000005
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.509
NEC for r=0.6 class 0 = 0.31 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 1 = 0.183 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 2 = 0.394 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all KL = 0.177 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all L1 = 0.296 +- 0.171 (in-sample avg dev_std = 0.283)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.559
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3521206666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.306 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 1 = 0.181 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 2 = 0.401 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all KL = 0.178 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all L1 = 0.297 +- 0.171 (in-sample avg dev_std = 0.292)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:50:27 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:50:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.183
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.216
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18288666666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.683
SUFF_SIMPLE for r=0.3 class 0 = 0.57 +- 0.252 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 class 1 = 0.693 +- 0.252 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 class 2 = 0.56 +- 0.252 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 all KL = 0.579 +- 0.252 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 all L1 = 0.607 +- 0.191 (in-sample avg dev_std = 0.601)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.252325
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.676
SUFF_SIMPLE for r=0.6 class 0 = 0.569 +- 0.271 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 class 1 = 0.703 +- 0.271 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 class 2 = 0.553 +- 0.271 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 all KL = 0.583 +- 0.271 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.6 all L1 = 0.608 +- 0.206 (in-sample avg dev_std = 0.582)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2948713333333333
len(reference) = 2705
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF_SIMPLE for r=0.9 class 0 = 0.621 +- 0.340 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.9 class 1 = 0.739 +- 0.340 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.9 class 2 = 0.629 +- 0.340 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.9 all KL = 0.678 +- 0.340 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.9 all L1 = 0.663 +- 0.281 (in-sample avg dev_std = 0.347)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216452
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.602
SUFF_SIMPLE for r=0.3 class 0 = 0.617 +- 0.179 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.3 class 1 = 0.809 +- 0.179 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.3 class 2 = 0.582 +- 0.179 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.3 all KL = 0.777 +- 0.179 (in-sample avg dev_std = 0.387)
SUFF_SIMPLE for r=0.3 all L1 = 0.669 +- 0.172 (in-sample avg dev_std = 0.387)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31742833333333337
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.585
SUFF_SIMPLE for r=0.6 class 0 = 0.61 +- 0.197 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 class 1 = 0.803 +- 0.197 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 class 2 = 0.572 +- 0.197 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 all KL = 0.769 +- 0.197 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 all L1 = 0.661 +- 0.188 (in-sample avg dev_std = 0.367)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3511043333333333
len(reference) = 2613
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.405
SUFF_SIMPLE for r=0.9 class 0 = 0.496 +- 0.236 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 class 1 = 0.671 +- 0.236 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 class 2 = 0.537 +- 0.236 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 all KL = 0.689 +- 0.236 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 all L1 = 0.567 +- 0.223 (in-sample avg dev_std = 0.045)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18288666666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.686
NEC for r=0.3 class 0 = 0.426 +- 0.270 (in-sample avg dev_std = 0.572)
NEC for r=0.3 class 1 = 0.304 +- 0.270 (in-sample avg dev_std = 0.572)
NEC for r=0.3 class 2 = 0.428 +- 0.270 (in-sample avg dev_std = 0.572)
NEC for r=0.3 all KL = 0.408 +- 0.270 (in-sample avg dev_std = 0.572)
NEC for r=0.3 all L1 = 0.386 +- 0.207 (in-sample avg dev_std = 0.572)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.252325
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.69
NEC for r=0.6 class 0 = 0.424 +- 0.250 (in-sample avg dev_std = 0.599)
NEC for r=0.6 class 1 = 0.31 +- 0.250 (in-sample avg dev_std = 0.599)
NEC for r=0.6 class 2 = 0.435 +- 0.250 (in-sample avg dev_std = 0.599)
NEC for r=0.6 all KL = 0.416 +- 0.250 (in-sample avg dev_std = 0.599)
NEC for r=0.6 all L1 = 0.39 +- 0.187 (in-sample avg dev_std = 0.599)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2948713333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.681
NEC for r=0.9 class 0 = 0.442 +- 0.245 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.309 +- 0.245 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.447 +- 0.245 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.43 +- 0.245 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.399 +- 0.184 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216452
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.619
NEC for r=0.3 class 0 = 0.355 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 class 1 = 0.178 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 class 2 = 0.405 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 all KL = 0.205 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 all L1 = 0.313 +- 0.183 (in-sample avg dev_std = 0.357)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31742833333333337
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.619
NEC for r=0.6 class 0 = 0.372 +- 0.174 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 1 = 0.18 +- 0.174 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 2 = 0.403 +- 0.174 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all KL = 0.211 +- 0.174 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all L1 = 0.319 +- 0.169 (in-sample avg dev_std = 0.385)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.681
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3511043333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.619
NEC for r=0.9 class 0 = 0.364 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 class 1 = 0.173 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 class 2 = 0.409 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 all KL = 0.209 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 all L1 = 0.316 +- 0.169 (in-sample avg dev_std = 0.389)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:53:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:53:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.183
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18264300000000003
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.687
SUFF_SIMPLE for r=0.3 class 0 = 0.566 +- 0.244 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 class 1 = 0.706 +- 0.244 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 class 2 = 0.559 +- 0.244 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 all KL = 0.594 +- 0.244 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 all L1 = 0.61 +- 0.188 (in-sample avg dev_std = 0.595)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251622
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.686
SUFF_SIMPLE for r=0.6 class 0 = 0.571 +- 0.263 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 class 1 = 0.714 +- 0.263 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 class 2 = 0.564 +- 0.263 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 all KL = 0.606 +- 0.263 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 all L1 = 0.616 +- 0.205 (in-sample avg dev_std = 0.564)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294696
len(reference) = 2715
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.692
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.337 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.9 class 1 = 0.746 +- 0.337 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.9 class 2 = 0.617 +- 0.337 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.9 all KL = 0.684 +- 0.337 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.9 all L1 = 0.662 +- 0.276 (in-sample avg dev_std = 0.359)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21689799999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.443
SUFF_SIMPLE for r=0.3 class 0 = 0.72 +- 0.167 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 class 1 = 0.893 +- 0.167 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 class 2 = 0.725 +- 0.167 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 all KL = 0.856 +- 0.167 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 all L1 = 0.779 +- 0.197 (in-sample avg dev_std = 0.275)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32082733333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.432
SUFF_SIMPLE for r=0.6 class 0 = 0.718 +- 0.181 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 class 1 = 0.89 +- 0.181 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 class 2 = 0.719 +- 0.181 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 all KL = 0.851 +- 0.181 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 all L1 = 0.775 +- 0.207 (in-sample avg dev_std = 0.258)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35269999999999996
len(reference) = 2623
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.373
SUFF_SIMPLE for r=0.9 class 0 = 0.711 +- 0.225 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 class 1 = 0.86 +- 0.225 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 class 2 = 0.763 +- 0.225 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 all KL = 0.839 +- 0.225 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 all L1 = 0.778 +- 0.245 (in-sample avg dev_std = 0.002)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18264300000000003
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.695
NEC for r=0.3 class 0 = 0.423 +- 0.264 (in-sample avg dev_std = 0.563)
NEC for r=0.3 class 1 = 0.283 +- 0.264 (in-sample avg dev_std = 0.563)
NEC for r=0.3 class 2 = 0.422 +- 0.264 (in-sample avg dev_std = 0.563)
NEC for r=0.3 all KL = 0.386 +- 0.264 (in-sample avg dev_std = 0.563)
NEC for r=0.3 all L1 = 0.376 +- 0.205 (in-sample avg dev_std = 0.563)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251622
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.689
NEC for r=0.6 class 0 = 0.434 +- 0.245 (in-sample avg dev_std = 0.590)
NEC for r=0.6 class 1 = 0.284 +- 0.245 (in-sample avg dev_std = 0.590)
NEC for r=0.6 class 2 = 0.436 +- 0.245 (in-sample avg dev_std = 0.590)
NEC for r=0.6 all KL = 0.4 +- 0.245 (in-sample avg dev_std = 0.590)
NEC for r=0.6 all L1 = 0.385 +- 0.189 (in-sample avg dev_std = 0.590)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294696
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.689
NEC for r=0.9 class 0 = 0.435 +- 0.238 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 1 = 0.293 +- 0.238 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 2 = 0.442 +- 0.238 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all KL = 0.408 +- 0.238 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all L1 = 0.39 +- 0.181 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21689799999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.441
NEC for r=0.3 class 0 = 0.275 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 class 1 = 0.098 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 class 2 = 0.28 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all KL = 0.14 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all L1 = 0.218 +- 0.202 (in-sample avg dev_std = 0.253)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32082733333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.451
NEC for r=0.6 class 0 = 0.273 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 1 = 0.099 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 2 = 0.274 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all KL = 0.137 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all L1 = 0.216 +- 0.192 (in-sample avg dev_std = 0.270)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35269999999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.447
NEC for r=0.9 class 0 = 0.278 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 1 = 0.102 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 2 = 0.278 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all KL = 0.141 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all L1 = 0.22 +- 0.193 (in-sample avg dev_std = 0.280)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:56:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:56:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 151 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9293 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.219
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.186139
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.677
SUFF_SIMPLE for r=0.3 class 0 = 0.556 +- 0.248 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 class 1 = 0.692 +- 0.248 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 class 2 = 0.555 +- 0.248 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 all KL = 0.576 +- 0.248 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.3 all L1 = 0.601 +- 0.189 (in-sample avg dev_std = 0.601)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2529276666666666
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.675
SUFF_SIMPLE for r=0.6 class 0 = 0.56 +- 0.265 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.6 class 1 = 0.701 +- 0.265 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.6 class 2 = 0.552 +- 0.265 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.6 all KL = 0.585 +- 0.265 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.6 all L1 = 0.604 +- 0.205 (in-sample avg dev_std = 0.572)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2951496666666667
len(reference) = 2698
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.696
SUFF_SIMPLE for r=0.9 class 0 = 0.63 +- 0.339 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.9 class 1 = 0.741 +- 0.339 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.9 class 2 = 0.608 +- 0.339 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.9 all KL = 0.677 +- 0.339 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.9 all L1 = 0.66 +- 0.279 (in-sample avg dev_std = 0.354)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21901266666666666
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.586
SUFF_SIMPLE for r=0.3 class 0 = 0.616 +- 0.185 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 1 = 0.797 +- 0.185 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 2 = 0.55 +- 0.185 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all KL = 0.768 +- 0.185 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all L1 = 0.654 +- 0.174 (in-sample avg dev_std = 0.371)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31970533333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.578
SUFF_SIMPLE for r=0.6 class 0 = 0.62 +- 0.203 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 class 1 = 0.792 +- 0.203 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 class 2 = 0.536 +- 0.203 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 all KL = 0.763 +- 0.203 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.6 all L1 = 0.649 +- 0.187 (in-sample avg dev_std = 0.349)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35219999999999996
len(reference) = 2631
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.382
SUFF_SIMPLE for r=0.9 class 0 = 0.536 +- 0.244 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.9 class 1 = 0.684 +- 0.244 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.9 class 2 = 0.468 +- 0.244 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.9 all KL = 0.677 +- 0.244 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.9 all L1 = 0.56 +- 0.227 (in-sample avg dev_std = 0.019)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.186139
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.683
NEC for r=0.3 class 0 = 0.431 +- 0.271 (in-sample avg dev_std = 0.563)
NEC for r=0.3 class 1 = 0.3 +- 0.271 (in-sample avg dev_std = 0.563)
NEC for r=0.3 class 2 = 0.431 +- 0.271 (in-sample avg dev_std = 0.563)
NEC for r=0.3 all KL = 0.405 +- 0.271 (in-sample avg dev_std = 0.563)
NEC for r=0.3 all L1 = 0.387 +- 0.209 (in-sample avg dev_std = 0.563)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2529276666666666
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
NEC for r=0.6 class 0 = 0.447 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=0.6 class 1 = 0.3 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=0.6 class 2 = 0.431 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=0.6 all KL = 0.414 +- 0.249 (in-sample avg dev_std = 0.594)
NEC for r=0.6 all L1 = 0.392 +- 0.189 (in-sample avg dev_std = 0.594)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2951496666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.679
NEC for r=0.9 class 0 = 0.448 +- 0.242 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 1 = 0.305 +- 0.242 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 2 = 0.446 +- 0.242 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all KL = 0.424 +- 0.242 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all L1 = 0.399 +- 0.184 (in-sample avg dev_std = 0.604)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21901266666666666
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.617
NEC for r=0.3 class 0 = 0.364 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 1 = 0.196 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 2 = 0.425 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all KL = 0.212 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all L1 = 0.329 +- 0.177 (in-sample avg dev_std = 0.343)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31970533333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.61
NEC for r=0.6 class 0 = 0.375 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 1 = 0.196 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 2 = 0.427 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 all KL = 0.217 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 all L1 = 0.333 +- 0.167 (in-sample avg dev_std = 0.368)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35219999999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.372 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 class 1 = 0.193 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 class 2 = 0.438 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 all KL = 0.22 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 all L1 = 0.335 +- 0.168 (in-sample avg dev_std = 0.374)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:58:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:58:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.185
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.318
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18505633333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.681
SUFF_SIMPLE for r=0.3 class 0 = 0.569 +- 0.253 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.3 class 1 = 0.685 +- 0.253 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.3 class 2 = 0.569 +- 0.253 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.3 all KL = 0.574 +- 0.253 (in-sample avg dev_std = 0.617)
SUFF_SIMPLE for r=0.3 all L1 = 0.608 +- 0.189 (in-sample avg dev_std = 0.617)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2514186666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.673
SUFF_SIMPLE for r=0.6 class 0 = 0.573 +- 0.272 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 1 = 0.682 +- 0.272 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 2 = 0.572 +- 0.272 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all KL = 0.58 +- 0.272 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all L1 = 0.609 +- 0.206 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.296163
len(reference) = 2715
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.701
SUFF_SIMPLE for r=0.9 class 0 = 0.641 +- 0.339 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.9 class 1 = 0.746 +- 0.339 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.9 class 2 = 0.645 +- 0.339 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.9 all KL = 0.694 +- 0.339 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.9 all L1 = 0.678 +- 0.276 (in-sample avg dev_std = 0.353)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21300999999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.642 +- 0.190 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 class 1 = 0.831 +- 0.190 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 class 2 = 0.667 +- 0.190 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 all KL = 0.79 +- 0.190 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 all L1 = 0.713 +- 0.193 (in-sample avg dev_std = 0.388)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3184493333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.498
SUFF_SIMPLE for r=0.6 class 0 = 0.635 +- 0.200 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.6 class 1 = 0.819 +- 0.200 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.6 class 2 = 0.659 +- 0.200 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.6 all KL = 0.783 +- 0.200 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.6 all L1 = 0.704 +- 0.201 (in-sample avg dev_std = 0.371)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3610393333333333
len(reference) = 2677
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.398
SUFF_SIMPLE for r=0.9 class 0 = 0.526 +- 0.265 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 class 1 = 0.797 +- 0.265 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 class 2 = 0.678 +- 0.265 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 all KL = 0.753 +- 0.265 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.9 all L1 = 0.669 +- 0.275 (in-sample avg dev_std = 0.045)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18505633333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0 = 0.417 +- 0.274 (in-sample avg dev_std = 0.583)
NEC for r=0.3 class 1 = 0.301 +- 0.274 (in-sample avg dev_std = 0.583)
NEC for r=0.3 class 2 = 0.413 +- 0.274 (in-sample avg dev_std = 0.583)
NEC for r=0.3 all KL = 0.403 +- 0.274 (in-sample avg dev_std = 0.583)
NEC for r=0.3 all L1 = 0.377 +- 0.208 (in-sample avg dev_std = 0.583)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2514186666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.686
NEC for r=0.6 class 0 = 0.432 +- 0.252 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 1 = 0.308 +- 0.252 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 2 = 0.429 +- 0.252 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all KL = 0.423 +- 0.252 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all L1 = 0.389 +- 0.188 (in-sample avg dev_std = 0.617)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.296163
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.687
NEC for r=0.9 class 0 = 0.429 +- 0.251 (in-sample avg dev_std = 0.618)
NEC for r=0.9 class 1 = 0.31 +- 0.251 (in-sample avg dev_std = 0.618)
NEC for r=0.9 class 2 = 0.424 +- 0.251 (in-sample avg dev_std = 0.618)
NEC for r=0.9 all KL = 0.421 +- 0.251 (in-sample avg dev_std = 0.618)
NEC for r=0.9 all L1 = 0.387 +- 0.187 (in-sample avg dev_std = 0.618)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21300999999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.529
NEC for r=0.3 class 0 = 0.335 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 1 = 0.15 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 2 = 0.321 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all KL = 0.191 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all L1 = 0.27 +- 0.200 (in-sample avg dev_std = 0.355)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3184493333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.527
NEC for r=0.6 class 0 = 0.348 +- 0.186 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.154 +- 0.186 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.322 +- 0.186 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.197 +- 0.186 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.275 +- 0.190 (in-sample avg dev_std = 0.383)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3610393333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.348 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 1 = 0.158 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 2 = 0.331 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all KL = 0.202 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all L1 = 0.28 +- 0.186 (in-sample avg dev_std = 0.393)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.498, 0.514, 0.641], 'all_L1': [0.574, 0.581, 0.65]}), defaultdict(<class 'list'>, {'all_KL': [0.604, 0.613, 0.713], 'all_L1': [0.616, 0.621, 0.681]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.587, 0.691], 'all_L1': [0.612, 0.614, 0.673]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.575, 0.682], 'all_L1': [0.604, 0.611, 0.67]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.57, 0.684], 'all_L1': [0.598, 0.602, 0.665]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.573, 0.675], 'all_L1': [0.601, 0.597, 0.66]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.583, 0.678], 'all_L1': [0.607, 0.608, 0.663]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.606, 0.684], 'all_L1': [0.61, 0.616, 0.662]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.585, 0.677], 'all_L1': [0.601, 0.604, 0.66]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.58, 0.694], 'all_L1': [0.608, 0.609, 0.678]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.468, 0.496, 0.504], 'all_L1': [0.405, 0.421, 0.426]}), defaultdict(<class 'list'>, {'all_KL': [0.385, 0.395, 0.396], 'all_L1': [0.377, 0.383, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.417, 0.433], 'all_L1': [0.377, 0.387, 0.398]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.428, 0.436], 'all_L1': [0.375, 0.386, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.434, 0.438], 'all_L1': [0.387, 0.398, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.422, 0.435], 'all_L1': [0.385, 0.396, 0.405]}), defaultdict(<class 'list'>, {'all_KL': [0.408, 0.416, 0.43], 'all_L1': [0.386, 0.39, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.4, 0.408], 'all_L1': [0.376, 0.385, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.414, 0.424], 'all_L1': [0.387, 0.392, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.403, 0.423, 0.421], 'all_L1': [0.377, 0.389, 0.387]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.688, 0.694, 0.595], 'all_L1': [0.645, 0.647, 0.545]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.754, 0.636], 'all_L1': [0.655, 0.655, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.809, 0.803, 0.748], 'all_L1': [0.696, 0.69, 0.637]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.732, 0.596], 'all_L1': [0.624, 0.615, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.795, 0.788, 0.737], 'all_L1': [0.733, 0.725, 0.683]}), defaultdict(<class 'list'>, {'all_KL': [0.814, 0.812, 0.761], 'all_L1': [0.696, 0.694, 0.645]}), defaultdict(<class 'list'>, {'all_KL': [0.777, 0.769, 0.689], 'all_L1': [0.669, 0.661, 0.567]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.851, 0.839], 'all_L1': [0.779, 0.775, 0.778]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.763, 0.677], 'all_L1': [0.654, 0.649, 0.56]}), defaultdict(<class 'list'>, {'all_KL': [0.79, 0.783, 0.753], 'all_L1': [0.713, 0.704, 0.669]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.253, 0.284, 0.284], 'all_L1': [0.307, 0.33, 0.331]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.231, 0.228], 'all_L1': [0.323, 0.329, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.181, 0.181], 'all_L1': [0.291, 0.296, 0.296]}), defaultdict(<class 'list'>, {'all_KL': [0.233, 0.241, 0.237], 'all_L1': [0.35, 0.358, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.193, 0.196], 'all_L1': [0.253, 0.257, 0.26]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.177, 0.178], 'all_L1': [0.294, 0.296, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.211, 0.209], 'all_L1': [0.313, 0.319, 0.316]}), defaultdict(<class 'list'>, {'all_KL': [0.14, 0.137, 0.141], 'all_L1': [0.218, 0.216, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.217, 0.22], 'all_L1': [0.329, 0.333, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.197, 0.202], 'all_L1': [0.27, 0.275, 0.28]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.603 +- 0.011, 0.606 +- 0.011, 0.666 +- 0.009
suff_simple class all_KL  =  0.570 +- 0.027, 0.579 +- 0.025, 0.682 +- 0.017
[[0.6521666646003723, 0.6549583077430725, 0.6763376593589783], [0.6914166808128357, 0.6884583234786987, 0.7121170163154602], [0.6861249804496765, 0.6853333115577698, 0.7073361277580261], [0.6812916398048401, 0.6819166541099548, 0.6973125338554382], [0.6846666932106018, 0.6819166541099548, 0.7032403945922852], [0.6740833520889282, 0.6628333330154419, 0.6871312856674194], [0.6827499866485596, 0.6761666536331177, 0.6914048194885254], [0.6865833401679993, 0.6863750219345093, 0.6917587518692017], [0.6769583225250244, 0.6752499938011169, 0.6962564587593079], [0.6807500123977661, 0.6729166507720947, 0.700920820236206]]
[[0.498, 0.514, 0.641], [0.604, 0.613, 0.713], [0.582, 0.587, 0.691], [0.561, 0.575, 0.682], [0.561, 0.57, 0.684], [0.576, 0.573, 0.675], [0.579, 0.583, 0.678], [0.594, 0.606, 0.684], [0.576, 0.585, 0.677], [0.574, 0.58, 0.694]]
suff_simple_acc_int  =  0.680 +- 0.010, 0.677 +- 0.010, 0.696 +- 0.010
nec class all_L1  =  0.383 +- 0.009, 0.393 +- 0.010, 0.398 +- 0.011
nec class all_KL  =  0.408 +- 0.022, 0.424 +- 0.026, 0.432 +- 0.027
[[0.6677916646003723, 0.6607916951179504, 0.6590416431427002], [0.6910833120346069, 0.687208354473114, 0.6910833120346069], [0.6880000233650208, 0.68729168176651, 0.6793749928474426], [0.6965416669845581, 0.6924166679382324, 0.6868333220481873], [0.6879583597183228, 0.687333345413208, 0.6847500205039978], [0.684208333492279, 0.6812499761581421, 0.6704999804496765], [0.6855416893959045, 0.6903333067893982, 0.6806250214576721], [0.6952083110809326, 0.6893333196640015, 0.6885833144187927], [0.6825833320617676, 0.6869166493415833, 0.6789583563804626], [0.6923750042915344, 0.6855833530426025, 0.687166690826416]]
[[0.468, 0.496, 0.504], [0.385, 0.395, 0.396], [0.402, 0.417, 0.433], [0.404, 0.428, 0.436], [0.416, 0.434, 0.438], [0.405, 0.422, 0.435], [0.408, 0.416, 0.43], [0.386, 0.4, 0.408], [0.405, 0.414, 0.424], [0.403, 0.423, 0.421]]
nec_acc_int  =  0.687 +- 0.008, 0.685 +- 0.008, 0.681 +- 0.009

Eval split val
suff_simple class all_L1  =  0.686 +- 0.044, 0.681 +- 0.044, 0.606 +- 0.089
suff_simple class all_KL  =  0.779 +- 0.043, 0.775 +- 0.041, 0.703 +- 0.075
[[0.515541672706604, 0.515916645526886, 0.4298066198825836], [0.6068333387374878, 0.6042083501815796, 0.3714505136013031], [0.5604583621025085, 0.5462916493415833, 0.37360092997550964], [0.6725000143051147, 0.6545416712760925, 0.40652257204055786], [0.499875009059906, 0.4933333396911621, 0.3826974034309387], [0.4960416555404663, 0.492000013589859, 0.36882421374320984], [0.6022083163261414, 0.5853333473205566, 0.4045158922672272], [0.44316667318344116, 0.4321666657924652, 0.373236745595932], [0.5857083201408386, 0.578416645526886, 0.38198402523994446], [0.5108749866485596, 0.4975000023841858, 0.3978334069252014]]
[[0.688, 0.694, 0.595], [0.754, 0.754, 0.636], [0.809, 0.803, 0.748], [0.741, 0.732, 0.596], [0.795, 0.788, 0.737], [0.814, 0.812, 0.761], [0.777, 0.769, 0.689], [0.856, 0.851, 0.839], [0.768, 0.763, 0.677], [0.79, 0.783, 0.753]]
suff_simple_acc_int  =  0.549 +- 0.065, 0.540 +- 0.063, 0.389 +- 0.019
nec class all_L1  =  0.295 +- 0.037, 0.301 +- 0.040, 0.301 +- 0.038
nec class all_KL  =  0.200 +- 0.031, 0.207 +- 0.038, 0.208 +- 0.037
[[0.562208354473114, 0.5441250205039978, 0.5423333048820496], [0.6297500133514404, 0.6213333606719971, 0.6298750042915344], [0.5864999890327454, 0.5816666483879089, 0.5797500014305115], [0.7007916569709778, 0.6940833330154419, 0.7023333311080933], [0.5181249976158142, 0.5108749866485596, 0.5087916851043701], [0.5084583163261414, 0.5092916488647461, 0.5096666812896729], [0.6192083358764648, 0.6188333630561829, 0.6194999814033508], [0.44091665744781494, 0.4508333206176758, 0.44737499952316284], [0.6170833110809326, 0.6101250052452087, 0.609541654586792], [0.5291666388511658, 0.5273749828338623, 0.5225416421890259]]
[[0.253, 0.284, 0.284], [0.224, 0.231, 0.228], [0.175, 0.181, 0.181], [0.233, 0.241, 0.237], [0.187, 0.193, 0.196], [0.175, 0.177, 0.178], [0.205, 0.211, 0.209], [0.14, 0.137, 0.141], [0.212, 0.217, 0.22], [0.191, 0.197, 0.202]]
nec_acc_int  =  0.571 +- 0.071, 0.567 +- 0.068, 0.567 +- 0.071


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.493 +- 0.002, 0.499 +- 0.002, 0.532 +- 0.003
Faith. Armon (L1)= 		  =  0.468 +- 0.003, 0.476 +- 0.004, 0.498 +- 0.007
Faith. GMean (L1)= 	  =  0.481 +- 0.002, 0.488 +- 0.002, 0.515 +- 0.005
Faith. Aritm (KL)= 		  =  0.489 +- 0.004, 0.502 +- 0.002, 0.557 +- 0.007
Faith. Armon (KL)= 		  =  0.475 +- 0.004, 0.488 +- 0.007, 0.528 +- 0.014
Faith. GMean (KL)= 	  =  0.482 +- 0.003, 0.495 +- 0.004, 0.543 +- 0.011

Eval split val
Faith. Aritm (L1)= 		  =  0.491 +- 0.006, 0.491 +- 0.003, 0.454 +- 0.027
Faith. Armon (L1)= 		  =  0.409 +- 0.031, 0.414 +- 0.033, 0.396 +- 0.021
Faith. GMean (L1)= 	  =  0.448 +- 0.016, 0.451 +- 0.018, 0.423 +- 0.011
Faith. Aritm (KL)= 		  =  0.489 +- 0.007, 0.491 +- 0.002, 0.455 +- 0.021
Faith. Armon (KL)= 		  =  0.315 +- 0.036, 0.324 +- 0.043, 0.316 +- 0.036
Faith. GMean (KL)= 	  =  0.392 +- 0.021, 0.398 +- 0.026, 0.378 +- 0.016
Computed for split load_split = id



Completed in  0:22:35.229603  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GSAT GOODMotif/basis/covariate NEC_ALPHA 0.01 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:01:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:01:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9243 0.9243 0.9243 0.9243 0.9267 0.9267[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.496
SUFF_SIMPLE for r=0.3 class 0 = 0.431 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 class 1 = 0.592 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 class 2 = 0.411 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 all KL = 0.346 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 all L1 = 0.478 +- 0.233 (in-sample avg dev_std = 0.763)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.363
SUFF_SIMPLE for r=0.6 class 0 = 0.415 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 class 1 = 0.426 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 class 2 = 0.272 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 all KL = 0.233 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 all L1 = 0.369 +- 0.199 (in-sample avg dev_std = 0.722)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.282
SUFF_SIMPLE for r=0.9 class 0 = 0.719 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 class 1 = 0.268 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 class 2 = 0.193 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 all KL = 0.287 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 all L1 = 0.373 +- 0.327 (in-sample avg dev_std = 0.307)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
SUFF_SIMPLE for r=0.3 class 0 = 0.51 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 1 = 0.678 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 2 = 0.248 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all KL = 0.385 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all L1 = 0.478 +- 0.312 (in-sample avg dev_std = 0.609)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.254
SUFF_SIMPLE for r=0.6 class 0 = 0.497 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 class 1 = 0.616 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 class 2 = 0.202 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 all KL = 0.35 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 all L1 = 0.437 +- 0.322 (in-sample avg dev_std = 0.500)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.318
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.195 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.492 +- 0.388 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.845
NEC for r=0.3 class 0 = 0.314 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.016 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.057 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.157 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.125 +- 0.219 (in-sample avg dev_std = 0.389)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.778
NEC for r=0.6 class 0 = 0.391 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.043 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.188 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.257 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.204 +- 0.263 (in-sample avg dev_std = 0.508)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.668
NEC for r=0.9 class 0 = 0.473 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 class 1 = 0.215 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 class 2 = 0.382 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 all KL = 0.46 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 all L1 = 0.355 +- 0.248 (in-sample avg dev_std = 0.710)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.649
NEC for r=0.3 class 0 = 0.295 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.122 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.107 +- 0.263 (in-sample avg dev_std = 0.207)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.628
NEC for r=0.6 class 0 = 0.306 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 1 = 0.015 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 2 = 0.089 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.163 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.138 +- 0.275 (in-sample avg dev_std = 0.302)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.388 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 1 = 0.177 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 2 = 0.419 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all KL = 0.411 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all L1 = 0.329 +- 0.277 (in-sample avg dev_std = 0.639)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:03:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:03:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.9267 0.9267 0.9267 0.9273 0.9273[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF_SIMPLE for r=0.3 class 0 = 0.48 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 class 1 = 0.593 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 class 2 = 0.399 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 all KL = 0.357 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 all L1 = 0.49 +- 0.234 (in-sample avg dev_std = 0.757)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.38
SUFF_SIMPLE for r=0.6 class 0 = 0.463 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 class 1 = 0.427 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 class 2 = 0.268 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 all L1 = 0.384 +- 0.209 (in-sample avg dev_std = 0.716)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.301
SUFF_SIMPLE for r=0.9 class 0 = 0.803 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 class 2 = 0.193 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 all KL = 0.31 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.341 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.316
SUFF_SIMPLE for r=0.3 class 0 = 0.214 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 1 = 0.446 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 2 = 0.361 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all KL = 0.216 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all L1 = 0.339 +- 0.190 (in-sample avg dev_std = 0.648)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.244
SUFF_SIMPLE for r=0.6 class 0 = 0.218 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 1 = 0.34 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 2 = 0.304 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all KL = 0.165 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all L1 = 0.287 +- 0.155 (in-sample avg dev_std = 0.583)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.239 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.185 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.344 +- 0.292 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.86
NEC for r=0.3 class 0 = 0.201 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.014 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.102 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.13 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.104 +- 0.189 (in-sample avg dev_std = 0.364)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 0 = 0.308 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.041 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.227 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.244 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.191 +- 0.247 (in-sample avg dev_std = 0.505)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.686
NEC for r=0.9 class 0 = 0.396 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 1 = 0.213 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 2 = 0.407 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all KL = 0.444 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all L1 = 0.339 +- 0.238 (in-sample avg dev_std = 0.704)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.874
NEC for r=0.3 class 0 = 0.185 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 1 = 0.012 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 2 = 0.007 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all KL = 0.063 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all L1 = 0.069 +- 0.182 (in-sample avg dev_std = 0.132)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.822
NEC for r=0.6 class 0 = 0.33 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.021 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.081 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.173 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.145 +- 0.225 (in-sample avg dev_std = 0.390)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.55 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.257 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.356 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.496 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.388 +- 0.229 (in-sample avg dev_std = 0.720)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:04:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:04:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9287 0.9287[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.47 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 class 2 = 0.398 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 all KL = 0.341 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 all L1 = 0.484 +- 0.232 (in-sample avg dev_std = 0.782)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.389
SUFF_SIMPLE for r=0.6 class 0 = 0.467 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 class 1 = 0.426 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 class 2 = 0.269 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 all KL = 0.241 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 all L1 = 0.385 +- 0.209 (in-sample avg dev_std = 0.744)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.287
SUFF_SIMPLE for r=0.9 class 0 = 0.77 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 class 1 = 0.255 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 class 2 = 0.189 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all KL = 0.289 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all L1 = 0.382 +- 0.343 (in-sample avg dev_std = 0.295)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
SUFF_SIMPLE for r=0.3 class 0 = 0.337 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 class 1 = 0.461 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 class 2 = 0.39 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 all KL = 0.272 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 all L1 = 0.395 +- 0.243 (in-sample avg dev_std = 0.682)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.257
SUFF_SIMPLE for r=0.6 class 0 = 0.339 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 class 1 = 0.392 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 class 2 = 0.352 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 all KL = 0.243 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.247 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 0 = 0.832 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.339 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.553 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.474 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.518 +- 0.386 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.854
NEC for r=0.3 class 0 = 0.247 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 1 = 0.015 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 2 = 0.083 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all KL = 0.142 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all L1 = 0.113 +- 0.203 (in-sample avg dev_std = 0.397)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.784
NEC for r=0.6 class 0 = 0.348 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 1 = 0.052 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 2 = 0.213 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all KL = 0.263 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all L1 = 0.203 +- 0.257 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.685
NEC for r=0.9 class 0 = 0.426 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 class 1 = 0.211 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 class 2 = 0.402 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 all KL = 0.46 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 all L1 = 0.346 +- 0.246 (in-sample avg dev_std = 0.725)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.79
NEC for r=0.3 class 0 = 0.103 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1 = 0.037 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 2 = 0.008 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.042 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.05 +- 0.138 (in-sample avg dev_std = 0.159)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.743
NEC for r=0.6 class 0 = 0.239 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 1 = 0.052 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 2 = 0.086 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all KL = 0.151 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all L1 = 0.126 +- 0.195 (in-sample avg dev_std = 0.406)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.436 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.254 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.348 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.45 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.346 +- 0.231 (in-sample avg dev_std = 0.715)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:06:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:06:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9250 0.9250[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.535
SUFF_SIMPLE for r=0.3 class 0 = 0.475 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 class 2 = 0.423 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 all KL = 0.364 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 all L1 = 0.495 +- 0.217 (in-sample avg dev_std = 0.773)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.466
SUFF_SIMPLE for r=0.6 class 0 = 0.489 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 class 1 = 0.427 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 class 2 = 0.441 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 all KL = 0.333 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 all L1 = 0.452 +- 0.248 (in-sample avg dev_std = 0.714)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.322
SUFF_SIMPLE for r=0.9 class 0 = 0.774 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 class 1 = 0.243 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 class 2 = 0.257 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 all KL = 0.333 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 all L1 = 0.404 +- 0.339 (in-sample avg dev_std = 0.281)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.384
SUFF_SIMPLE for r=0.3 class 0 = 0.384 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 class 1 = 0.439 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 class 2 = 0.398 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 all KL = 0.263 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 all L1 = 0.407 +- 0.144 (in-sample avg dev_std = 0.836)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.377
SUFF_SIMPLE for r=0.6 class 0 = 0.434 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 class 1 = 0.346 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 class 2 = 0.536 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 all KL = 0.315 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 all L1 = 0.439 +- 0.201 (in-sample avg dev_std = 0.775)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.742 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.561 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.363 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.72
NEC for r=0.3 class 0 = 0.357 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 class 1 = 0.034 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 class 2 = 0.407 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 all KL = 0.315 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 all L1 = 0.266 +- 0.297 (in-sample avg dev_std = 0.518)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.691
NEC for r=0.6 class 0 = 0.404 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.056 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.434 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.358 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.298 +- 0.305 (in-sample avg dev_std = 0.546)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0 = 0.457 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 class 1 = 0.219 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 class 2 = 0.492 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 all KL = 0.491 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 all L1 = 0.39 +- 0.259 (in-sample avg dev_std = 0.695)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.709
NEC for r=0.3 class 0 = 0.48 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1 = 0.039 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 2 = 0.68 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.419 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.401 +- 0.353 (in-sample avg dev_std = 0.312)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.679
NEC for r=0.6 class 0 = 0.515 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 1 = 0.04 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 2 = 0.699 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.451 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.42 +- 0.355 (in-sample avg dev_std = 0.339)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.596
NEC for r=0.9 class 0 = 0.554 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 1 = 0.259 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 2 = 0.672 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all KL = 0.591 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all L1 = 0.496 +- 0.252 (in-sample avg dev_std = 0.671)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:08:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:08:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF_SIMPLE for r=0.3 class 0 = 0.476 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 1 = 0.571 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 2 = 0.363 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all KL = 0.341 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all L1 = 0.468 +- 0.224 (in-sample avg dev_std = 0.747)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.411
SUFF_SIMPLE for r=0.6 class 0 = 0.483 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 1 = 0.399 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 2 = 0.299 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all KL = 0.262 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all L1 = 0.392 +- 0.195 (in-sample avg dev_std = 0.727)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.329
SUFF_SIMPLE for r=0.9 class 0 = 0.785 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 class 1 = 0.233 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 class 2 = 0.253 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 all KL = 0.337 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 all L1 = 0.403 +- 0.338 (in-sample avg dev_std = 0.270)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.369 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 class 1 = 0.427 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 class 2 = 0.339 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 all KL = 0.237 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 all L1 = 0.378 +- 0.147 (in-sample avg dev_std = 0.804)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.301
SUFF_SIMPLE for r=0.6 class 0 = 0.428 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 class 1 = 0.332 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 class 2 = 0.385 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 all KL = 0.25 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 all L1 = 0.382 +- 0.157 (in-sample avg dev_std = 0.774)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.898 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.193 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.735 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.380 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.758
NEC for r=0.3 class 0 = 0.321 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 1 = 0.034 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 2 = 0.396 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all KL = 0.29 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all L1 = 0.251 +- 0.279 (in-sample avg dev_std = 0.485)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.711
NEC for r=0.6 class 0 = 0.38 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 1 = 0.059 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 2 = 0.433 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all KL = 0.345 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all L1 = 0.291 +- 0.296 (in-sample avg dev_std = 0.534)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.631
NEC for r=0.9 class 0 = 0.434 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 class 1 = 0.233 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 class 2 = 0.529 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 all KL = 0.5 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 all L1 = 0.4 +- 0.257 (in-sample avg dev_std = 0.682)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.731
NEC for r=0.3 class 0 = 0.38 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 1 = 0.094 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 2 = 0.666 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all KL = 0.405 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all L1 = 0.381 +- 0.334 (in-sample avg dev_std = 0.319)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.696
NEC for r=0.6 class 0 = 0.434 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 1 = 0.094 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 2 = 0.686 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all KL = 0.445 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all L1 = 0.406 +- 0.334 (in-sample avg dev_std = 0.370)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.506 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.299 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.693 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.6 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.5 +- 0.245 (in-sample avg dev_std = 0.650)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:10:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:10:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9280 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.492
SUFF_SIMPLE for r=0.3 class 0 = 0.431 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 class 1 = 0.609 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 class 2 = 0.381 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 all KL = 0.358 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 all L1 = 0.473 +- 0.228 (in-sample avg dev_std = 0.737)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.362
SUFF_SIMPLE for r=0.6 class 0 = 0.397 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 class 1 = 0.459 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 class 2 = 0.274 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 all KL = 0.259 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 all L1 = 0.375 +- 0.201 (in-sample avg dev_std = 0.687)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF_SIMPLE for r=0.9 class 0 = 0.694 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 class 1 = 0.286 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 class 2 = 0.197 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 all KL = 0.299 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 all L1 = 0.373 +- 0.315 (in-sample avg dev_std = 0.301)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.299
SUFF_SIMPLE for r=0.3 class 0 = 0.331 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 class 1 = 0.448 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 class 2 = 0.365 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 all KL = 0.252 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 all L1 = 0.381 +- 0.177 (in-sample avg dev_std = 0.742)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.217
SUFF_SIMPLE for r=0.6 class 0 = 0.345 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 class 1 = 0.349 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 class 2 = 0.323 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 all KL = 0.217 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 all L1 = 0.339 +- 0.170 (in-sample avg dev_std = 0.670)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.197 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.475 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.386 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.436 +- 0.360 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.834
NEC for r=0.3 class 0 = 0.296 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.017 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.154 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.185 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.153 +- 0.225 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.765
NEC for r=0.6 class 0 = 0.388 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 1 = 0.045 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 2 = 0.267 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all KL = 0.287 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all L1 = 0.231 +- 0.267 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.662
NEC for r=0.9 class 0 = 0.458 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 class 1 = 0.2 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 class 2 = 0.437 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 all KL = 0.457 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 all L1 = 0.364 +- 0.250 (in-sample avg dev_std = 0.691)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.764
NEC for r=0.3 class 0 = 0.28 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.01 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.012 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.081 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.101 +- 0.210 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.723
NEC for r=0.6 class 0 = 0.376 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 1 = 0.016 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 2 = 0.088 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all KL = 0.172 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all L1 = 0.161 +- 0.247 (in-sample avg dev_std = 0.359)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.494 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 1 = 0.248 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 2 = 0.356 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all KL = 0.455 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all L1 = 0.367 +- 0.230 (in-sample avg dev_std = 0.687)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:12:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:12:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF_SIMPLE for r=0.3 class 0 = 0.439 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 class 1 = 0.614 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 class 2 = 0.389 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 all KL = 0.357 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 all L1 = 0.48 +- 0.237 (in-sample avg dev_std = 0.748)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.369
SUFF_SIMPLE for r=0.6 class 0 = 0.419 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 class 1 = 0.451 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 class 2 = 0.262 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 all L1 = 0.376 +- 0.207 (in-sample avg dev_std = 0.705)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.303
SUFF_SIMPLE for r=0.9 class 0 = 0.755 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 1 = 0.284 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 2 = 0.194 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.335 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.256
SUFF_SIMPLE for r=0.3 class 0 = 0.291 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 class 1 = 0.436 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 class 2 = 0.275 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 all KL = 0.204 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 all L1 = 0.334 +- 0.160 (in-sample avg dev_std = 0.718)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.174
SUFF_SIMPLE for r=0.6 class 0 = 0.289 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 class 1 = 0.332 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 class 2 = 0.227 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 all KL = 0.163 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 all L1 = 0.283 +- 0.134 (in-sample avg dev_std = 0.616)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.074
SUFF_SIMPLE for r=0.9 class 0 = 0.81 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.182 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.269 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.252 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.328 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.826
NEC for r=0.3 class 0 = 0.279 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 1 = 0.017 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 2 = 0.149 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all KL = 0.178 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all L1 = 0.146 +- 0.224 (in-sample avg dev_std = 0.433)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.756
NEC for r=0.6 class 0 = 0.389 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.044 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.267 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.288 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.231 +- 0.268 (in-sample avg dev_std = 0.548)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0 = 0.459 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 class 1 = 0.2 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 class 2 = 0.436 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 all KL = 0.463 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 all L1 = 0.364 +- 0.253 (in-sample avg dev_std = 0.708)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0 = 0.138 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 1 = 0.007 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 2 = 0.005 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all KL = 0.025 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all L1 = 0.05 +- 0.116 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.698
NEC for r=0.6 class 0 = 0.286 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.016 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.081 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.139 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.128 +- 0.195 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.543
NEC for r=0.9 class 0 = 0.468 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 1 = 0.251 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 2 = 0.402 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all KL = 0.474 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all L1 = 0.374 +- 0.210 (in-sample avg dev_std = 0.735)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:15:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:15:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.9253 0.9253 0.9253 0.9260 0.9260[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.468
SUFF_SIMPLE for r=0.3 class 0 = 0.429 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 class 1 = 0.602 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 class 2 = 0.357 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 all KL = 0.349 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 all L1 = 0.462 +- 0.231 (in-sample avg dev_std = 0.722)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.347
SUFF_SIMPLE for r=0.6 class 0 = 0.387 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 class 1 = 0.444 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 class 2 = 0.264 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.190 (in-sample avg dev_std = 0.686)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.264
SUFF_SIMPLE for r=0.9 class 0 = 0.646 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 1 = 0.273 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 2 = 0.2 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all KL = 0.281 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all L1 = 0.355 +- 0.298 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.244
SUFF_SIMPLE for r=0.3 class 0 = 0.233 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 class 1 = 0.451 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 class 2 = 0.202 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 all KL = 0.179 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 all L1 = 0.295 +- 0.162 (in-sample avg dev_std = 0.587)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.186
SUFF_SIMPLE for r=0.6 class 0 = 0.224 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 class 1 = 0.34 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 class 2 = 0.196 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 all KL = 0.142 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 all L1 = 0.253 +- 0.120 (in-sample avg dev_std = 0.521)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.047
SUFF_SIMPLE for r=0.9 class 0 = 0.269 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.101 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.196 +- 0.097 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.813
NEC for r=0.3 class 0 = 0.261 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 class 1 = 0.02 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 class 2 = 0.22 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 all KL = 0.206 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 all L1 = 0.166 +- 0.230 (in-sample avg dev_std = 0.471)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.75
NEC for r=0.6 class 0 = 0.353 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 1 = 0.044 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 2 = 0.328 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all KL = 0.301 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all L1 = 0.241 +- 0.268 (in-sample avg dev_std = 0.558)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.644
NEC for r=0.9 class 0 = 0.453 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 class 1 = 0.204 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 class 2 = 0.467 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 all KL = 0.468 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 all L1 = 0.375 +- 0.254 (in-sample avg dev_std = 0.698)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.898
NEC for r=0.3 class 0 = 0.134 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1 = 0.005 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 2 = 0.025 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.055 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.055 +- 0.153 (in-sample avg dev_std = 0.194)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.827
NEC for r=0.6 class 0 = 0.254 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.014 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.19 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.196 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.153 +- 0.217 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.492 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 1 = 0.25 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 2 = 0.468 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all KL = 0.518 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all L1 = 0.404 +- 0.217 (in-sample avg dev_std = 0.755)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:17:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:17:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9277 0.9277[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF_SIMPLE for r=0.3 class 0 = 0.49 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 class 1 = 0.554 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 class 2 = 0.389 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 all KL = 0.343 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 all L1 = 0.476 +- 0.227 (in-sample avg dev_std = 0.765)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.373
SUFF_SIMPLE for r=0.6 class 0 = 0.472 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 class 1 = 0.39 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 class 2 = 0.27 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 all KL = 0.241 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 all L1 = 0.375 +- 0.204 (in-sample avg dev_std = 0.719)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.297
SUFF_SIMPLE for r=0.9 class 0 = 0.812 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 class 1 = 0.238 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 class 2 = 0.193 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 all KL = 0.309 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 all L1 = 0.39 +- 0.347 (in-sample avg dev_std = 0.243)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.291
SUFF_SIMPLE for r=0.3 class 0 = 0.258 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 class 1 = 0.337 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 class 2 = 0.333 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 all KL = 0.183 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 all L1 = 0.309 +- 0.147 (in-sample avg dev_std = 0.676)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.217
SUFF_SIMPLE for r=0.6 class 0 = 0.267 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 class 1 = 0.299 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 class 2 = 0.277 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 all KL = 0.157 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 all L1 = 0.281 +- 0.140 (in-sample avg dev_std = 0.606)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.253
SUFF_SIMPLE for r=0.9 class 0 = 0.204 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.438 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.841
NEC for r=0.3 class 0 = 0.23 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 class 1 = 0.019 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 class 2 = 0.121 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 all KL = 0.146 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 all L1 = 0.122 +- 0.208 (in-sample avg dev_std = 0.370)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.785
NEC for r=0.6 class 0 = 0.305 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.056 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.236 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.25 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.198 +- 0.246 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.674
NEC for r=0.9 class 0 = 0.405 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 class 1 = 0.228 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 class 2 = 0.418 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 all KL = 0.456 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 all L1 = 0.35 +- 0.241 (in-sample avg dev_std = 0.709)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.775
NEC for r=0.3 class 0 = 0.309 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1 = 0.318 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 2 = 0.02 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.235 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.216 +- 0.319 (in-sample avg dev_std = 0.236)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.739
NEC for r=0.6 class 0 = 0.393 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.331 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.093 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.316 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.272 +- 0.315 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.809
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.575
NEC for r=0.9 class 0 = 0.556 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 1 = 0.502 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 2 = 0.371 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all KL = 0.593 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all L1 = 0.477 +- 0.228 (in-sample avg dev_std = 0.722)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:19:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:19:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.518
SUFF_SIMPLE for r=0.3 class 0 = 0.5 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 class 1 = 0.593 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 class 2 = 0.409 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 all KL = 0.371 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 all L1 = 0.499 +- 0.234 (in-sample avg dev_std = 0.755)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.396
SUFF_SIMPLE for r=0.6 class 0 = 0.497 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 1 = 0.429 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 2 = 0.279 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all KL = 0.265 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all L1 = 0.399 +- 0.214 (in-sample avg dev_std = 0.727)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.298
SUFF_SIMPLE for r=0.9 class 0 = 0.827 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 class 2 = 0.201 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 all KL = 0.316 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 all L1 = 0.401 +- 0.349 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.294
SUFF_SIMPLE for r=0.3 class 0 = 0.268 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 class 1 = 0.458 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 class 2 = 0.237 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 all KL = 0.196 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 all L1 = 0.32 +- 0.157 (in-sample avg dev_std = 0.708)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.209
SUFF_SIMPLE for r=0.6 class 0 = 0.277 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 class 1 = 0.349 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 class 2 = 0.183 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 all KL = 0.152 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 all L1 = 0.27 +- 0.128 (in-sample avg dev_std = 0.601)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.038
SUFF_SIMPLE for r=0.9 class 0 = 0.324 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.172 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.131 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.208 +- 0.076 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.817
NEC for r=0.3 class 0 = 0.296 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 1 = 0.022 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 2 = 0.11 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all KL = 0.163 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all L1 = 0.14 +- 0.226 (in-sample avg dev_std = 0.378)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.767
NEC for r=0.6 class 0 = 0.348 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 1 = 0.048 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 2 = 0.225 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all KL = 0.251 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all L1 = 0.205 +- 0.263 (in-sample avg dev_std = 0.487)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.671
NEC for r=0.9 class 0 = 0.41 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 1 = 0.213 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 2 = 0.408 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all KL = 0.441 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all L1 = 0.343 +- 0.248 (in-sample avg dev_std = 0.685)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.791
NEC for r=0.3 class 0 = 0.331 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.015 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.012 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.124 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.12 +- 0.245 (in-sample avg dev_std = 0.161)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 0 = 0.393 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1 = 0.019 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 2 = 0.08 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.189 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.165 +- 0.267 (in-sample avg dev_std = 0.319)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.54 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.247 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.428 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.515 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.406 +- 0.229 (in-sample avg dev_std = 0.720)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.346, 0.233, 0.287], 'all_L1': [0.478, 0.369, 0.373]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.248, 0.31], 'all_L1': [0.49, 0.384, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.241, 0.289], 'all_L1': [0.484, 0.385, 0.382]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.333, 0.333], 'all_L1': [0.495, 0.452, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.262, 0.337], 'all_L1': [0.468, 0.392, 0.403]}), defaultdict(<class 'list'>, {'all_KL': [0.358, 0.259, 0.299], 'all_L1': [0.473, 0.375, 0.373]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.248, 0.308], 'all_L1': [0.48, 0.376, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.349, 0.248, 0.281], 'all_L1': [0.462, 0.364, 0.355]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.241, 0.309], 'all_L1': [0.476, 0.375, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.371, 0.265, 0.316], 'all_L1': [0.499, 0.399, 0.401]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.157, 0.257, 0.46], 'all_L1': [0.125, 0.204, 0.355]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.244, 0.444], 'all_L1': [0.104, 0.191, 0.339]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.263, 0.46], 'all_L1': [0.113, 0.203, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.358, 0.491], 'all_L1': [0.266, 0.298, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.29, 0.345, 0.5], 'all_L1': [0.251, 0.291, 0.4]}), defaultdict(<class 'list'>, {'all_KL': [0.185, 0.287, 0.457], 'all_L1': [0.153, 0.231, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.178, 0.288, 0.463], 'all_L1': [0.146, 0.231, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.206, 0.301, 0.468], 'all_L1': [0.166, 0.241, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.25, 0.456], 'all_L1': [0.122, 0.198, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.163, 0.251, 0.441], 'all_L1': [0.14, 0.205, 0.343]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.385, 0.35, 0.444], 'all_L1': [0.478, 0.437, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.216, 0.165, 0.283], 'all_L1': [0.339, 0.287, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.243, 0.474], 'all_L1': [0.395, 0.361, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.315, 0.561], 'all_L1': [0.407, 0.439, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.237, 0.25, 0.542], 'all_L1': [0.378, 0.382, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.217, 0.386], 'all_L1': [0.381, 0.339, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.204, 0.163, 0.252], 'all_L1': [0.334, 0.283, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.142, 0.101], 'all_L1': [0.295, 0.253, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.183, 0.157, 0.246], 'all_L1': [0.309, 0.281, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.196, 0.152, 0.131], 'all_L1': [0.32, 0.27, 0.208]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.122, 0.163, 0.411], 'all_L1': [0.107, 0.138, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.173, 0.496], 'all_L1': [0.069, 0.145, 0.388]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.151, 0.45], 'all_L1': [0.05, 0.126, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.451, 0.591], 'all_L1': [0.401, 0.42, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.445, 0.6], 'all_L1': [0.381, 0.406, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.172, 0.455], 'all_L1': [0.101, 0.161, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.139, 0.474], 'all_L1': [0.05, 0.128, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.196, 0.518], 'all_L1': [0.055, 0.153, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.316, 0.593], 'all_L1': [0.216, 0.272, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.189, 0.515], 'all_L1': [0.12, 0.165, 0.406]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.480 +- 0.011, 0.387 +- 0.024, 0.386 +- 0.015
suff_simple class all_KL  =  0.353 +- 0.010, 0.258 +- 0.027, 0.307 +- 0.018
[[0.4962916672229767, 0.36283332109451294, 0.28247714042663574], [0.5117499828338623, 0.37966665625572205, 0.3011699914932251], [0.5109583139419556, 0.38862499594688416, 0.2866460382938385], [0.5347916483879089, 0.4658749997615814, 0.3215438425540924], [0.500041663646698, 0.41087499260902405, 0.3291420042514801], [0.49158334732055664, 0.3622083365917206, 0.2841581404209137], [0.4985416531562805, 0.36929166316986084, 0.3029854893684387], [0.46812498569488525, 0.3472500145435333, 0.2636498212814331], [0.4985833466053009, 0.37279167771339417, 0.29720279574394226], [0.5180416703224182, 0.3957499861717224, 0.2976062297821045]]
[[0.346, 0.233, 0.287], [0.357, 0.248, 0.31], [0.341, 0.241, 0.289], [0.364, 0.333, 0.333], [0.341, 0.262, 0.337], [0.358, 0.259, 0.299], [0.357, 0.248, 0.308], [0.349, 0.248, 0.281], [0.343, 0.241, 0.309], [0.371, 0.265, 0.316]]
suff_simple_acc_int  =  0.503 +- 0.017, 0.386 +- 0.032, 0.297 +- 0.018
nec class all_L1  =  0.159 +- 0.053, 0.229 +- 0.036, 0.363 +- 0.019
nec class all_KL  =  0.191 +- 0.060, 0.284 +- 0.038, 0.464 +- 0.018
[[0.8453333377838135, 0.778249979019165, 0.6684583425521851], [0.85958331823349, 0.7927916646003723, 0.6860833168029785], [0.8536666631698608, 0.784250020980835, 0.6853749752044678], [0.7201666831970215, 0.690708339214325, 0.6345416903495789], [0.7579583525657654, 0.7113333344459534, 0.6314166784286499], [0.8342916369438171, 0.76541668176651, 0.6622916460037231], [0.8261666893959045, 0.7560416460037231, 0.6599166393280029], [0.8131666779518127, 0.749958336353302, 0.6442499756813049], [0.840624988079071, 0.7854583263397217, 0.6738333106040955], [0.8168333172798157, 0.7673749923706055, 0.6710416674613953]]
[[0.157, 0.257, 0.46], [0.13, 0.244, 0.444], [0.142, 0.263, 0.46], [0.315, 0.358, 0.491], [0.29, 0.345, 0.5], [0.185, 0.287, 0.457], [0.178, 0.288, 0.463], [0.206, 0.301, 0.468], [0.146, 0.25, 0.456], [0.163, 0.251, 0.441]]
nec_acc_int  =  0.817 +- 0.042, 0.758 +- 0.032, 0.662 +- 0.018

Eval split val
suff_simple class all_L1  =  0.364 +- 0.052, 0.333 +- 0.066, 0.393 +- 0.130
suff_simple class all_KL  =  0.239 +- 0.058, 0.215 +- 0.069, 0.342 +- 0.155
[[0.3109999895095825, 0.2540833353996277, 0.3183828294277191], [0.3162083327770233, 0.24391666054725647, 0.23878711462020874], [0.3114583194255829, 0.25699999928474426, 0.25457990169525146], [0.3839583396911621, 0.3766666650772095, 0.21920403838157654], [0.3292083442211151, 0.30133333802223206, 0.1711939424276352], [0.2994999885559082, 0.21699999272823334, 0.19835755228996277], [0.2563333213329315, 0.17399999499320984, 0.07391029596328735], [0.24416667222976685, 0.18574999272823334, 0.04737839475274086], [0.2907083332538605, 0.21674999594688416, 0.2533164918422699], [0.2940416634082794, 0.20916666090488434, 0.03790271654725075]]
[[0.385, 0.35, 0.444], [0.216, 0.165, 0.283], [0.272, 0.243, 0.474], [0.263, 0.315, 0.561], [0.237, 0.25, 0.542], [0.252, 0.217, 0.386], [0.204, 0.163, 0.252], [0.179, 0.142, 0.101], [0.183, 0.157, 0.246], [0.196, 0.152, 0.131]]
suff_simple_acc_int  =  0.304 +- 0.037, 0.244 +- 0.057, 0.181 +- 0.092
nec class all_L1  =  0.155 +- 0.127, 0.211 +- 0.108, 0.409 +- 0.059
nec class all_KL  =  0.157 +- 0.139, 0.239 +- 0.114, 0.510 +- 0.063
[[0.6487916707992554, 0.6278333067893982, 0.5097083449363708], [0.8736249804496765, 0.8216249942779541, 0.6402083039283752], [0.7904166579246521, 0.7432916760444641, 0.5920833349227905], [0.7092499732971191, 0.6792916655540466, 0.5962083339691162], [0.7305416464805603, 0.6957916617393494, 0.5852916836738586], [0.7642916440963745, 0.7228333353996277, 0.5662916898727417], [0.7418749928474426, 0.6977083086967468, 0.5426250100135803], [0.8976666927337646, 0.8272083401679993, 0.6355000138282776], [0.7747083306312561, 0.7391666769981384, 0.575208306312561], [0.7914999723434448, 0.7635833621025085, 0.6010833382606506]]
[[0.122, 0.163, 0.411], [0.063, 0.173, 0.496], [0.042, 0.151, 0.45], [0.419, 0.451, 0.591], [0.405, 0.445, 0.6], [0.081, 0.172, 0.455], [0.025, 0.139, 0.474], [0.055, 0.196, 0.518], [0.235, 0.316, 0.593], [0.124, 0.189, 0.515]]
nec_acc_int  =  0.772 +- 0.070, 0.732 +- 0.059, 0.584 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.320 +- 0.027, 0.308 +- 0.027, 0.374 +- 0.013
Faith. Armon (L1)= 		  =  0.234 +- 0.056, 0.287 +- 0.032, 0.374 +- 0.013
Faith. GMean (L1)= 	  =  0.273 +- 0.043, 0.297 +- 0.030, 0.374 +- 0.013
Faith. Aritm (KL)= 		  =  0.272 +- 0.031, 0.271 +- 0.030, 0.385 +- 0.015
Faith. Armon (KL)= 		  =  0.243 +- 0.046, 0.270 +- 0.030, 0.369 +- 0.017
Faith. GMean (KL)= 	  =  0.257 +- 0.039, 0.270 +- 0.030, 0.377 +- 0.016

Eval split val
Faith. Aritm (L1)= 		  =  0.259 +- 0.074, 0.272 +- 0.075, 0.401 +- 0.074
Faith. Armon (L1)= 		  =  0.193 +- 0.111, 0.248 +- 0.086, 0.388 +- 0.083
Faith. GMean (L1)= 	  =  0.221 +- 0.095, 0.259 +- 0.080, 0.394 +- 0.079
Faith. Aritm (KL)= 		  =  0.198 +- 0.077, 0.227 +- 0.076, 0.426 +- 0.086
Faith. Armon (KL)= 		  =  0.159 +- 0.090, 0.215 +- 0.069, 0.387 +- 0.127
Faith. GMean (KL)= 	  =  0.176 +- 0.085, 0.221 +- 0.072, 0.404 +- 0.108
Computed for split load_split = id



Completed in  0:20:50.377748  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN simple_concept2temperature GOODMotif/basis/covariate NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:22:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:22:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9243 0.9243 0.9243 0.9243 0.9267 0.9267[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.496
SUFF_SIMPLE for r=0.3 class 0 = 0.431 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 class 1 = 0.592 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 class 2 = 0.411 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 all KL = 0.346 +- 0.257 (in-sample avg dev_std = 0.763)
SUFF_SIMPLE for r=0.3 all L1 = 0.478 +- 0.233 (in-sample avg dev_std = 0.763)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.363
SUFF_SIMPLE for r=0.6 class 0 = 0.415 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 class 1 = 0.426 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 class 2 = 0.272 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 all KL = 0.233 +- 0.202 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.6 all L1 = 0.369 +- 0.199 (in-sample avg dev_std = 0.722)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.282
SUFF_SIMPLE for r=0.9 class 0 = 0.719 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 class 1 = 0.268 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 class 2 = 0.193 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 all KL = 0.287 +- 0.373 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.9 all L1 = 0.373 +- 0.327 (in-sample avg dev_std = 0.307)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
SUFF_SIMPLE for r=0.3 class 0 = 0.51 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 1 = 0.678 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 2 = 0.248 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all KL = 0.385 +- 0.360 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all L1 = 0.478 +- 0.312 (in-sample avg dev_std = 0.609)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.254
SUFF_SIMPLE for r=0.6 class 0 = 0.497 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 class 1 = 0.616 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 class 2 = 0.202 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 all KL = 0.35 +- 0.367 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.6 all L1 = 0.437 +- 0.322 (in-sample avg dev_std = 0.500)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.318
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.195 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.492 +- 0.388 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.845
NEC for r=0.3 class 0 = 0.314 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.016 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.057 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.157 +- 0.273 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.125 +- 0.219 (in-sample avg dev_std = 0.389)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.778
NEC for r=0.6 class 0 = 0.391 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.043 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.188 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.257 +- 0.326 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.204 +- 0.263 (in-sample avg dev_std = 0.508)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.668
NEC for r=0.9 class 0 = 0.473 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 class 1 = 0.215 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 class 2 = 0.382 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 all KL = 0.46 +- 0.302 (in-sample avg dev_std = 0.710)
NEC for r=0.9 all L1 = 0.355 +- 0.248 (in-sample avg dev_std = 0.710)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.649
NEC for r=0.3 class 0 = 0.295 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.122 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.107 +- 0.263 (in-sample avg dev_std = 0.207)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.628
NEC for r=0.6 class 0 = 0.306 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 1 = 0.015 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 2 = 0.089 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.163 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.138 +- 0.275 (in-sample avg dev_std = 0.302)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.388 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 1 = 0.177 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 2 = 0.419 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all KL = 0.411 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all L1 = 0.329 +- 0.277 (in-sample avg dev_std = 0.639)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:23:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:23:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.9267 0.9267 0.9267 0.9273 0.9273[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF_SIMPLE for r=0.3 class 0 = 0.48 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 class 1 = 0.593 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 class 2 = 0.399 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 all KL = 0.357 +- 0.262 (in-sample avg dev_std = 0.757)
SUFF_SIMPLE for r=0.3 all L1 = 0.49 +- 0.234 (in-sample avg dev_std = 0.757)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.38
SUFF_SIMPLE for r=0.6 class 0 = 0.463 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 class 1 = 0.427 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 class 2 = 0.268 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.216 (in-sample avg dev_std = 0.716)
SUFF_SIMPLE for r=0.6 all L1 = 0.384 +- 0.209 (in-sample avg dev_std = 0.716)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.301
SUFF_SIMPLE for r=0.9 class 0 = 0.803 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 class 2 = 0.193 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 all KL = 0.31 +- 0.391 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.341 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.316
SUFF_SIMPLE for r=0.3 class 0 = 0.214 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 1 = 0.446 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 2 = 0.361 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all KL = 0.216 +- 0.197 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all L1 = 0.339 +- 0.190 (in-sample avg dev_std = 0.648)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.244
SUFF_SIMPLE for r=0.6 class 0 = 0.218 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 1 = 0.34 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 2 = 0.304 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all KL = 0.165 +- 0.155 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all L1 = 0.287 +- 0.155 (in-sample avg dev_std = 0.583)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.239 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.185 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.344 +- 0.292 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.86
NEC for r=0.3 class 0 = 0.201 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 1 = 0.014 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 class 2 = 0.102 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all KL = 0.13 +- 0.242 (in-sample avg dev_std = 0.364)
NEC for r=0.3 all L1 = 0.104 +- 0.189 (in-sample avg dev_std = 0.364)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 0 = 0.308 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.041 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.227 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.244 +- 0.316 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.191 +- 0.247 (in-sample avg dev_std = 0.505)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.686
NEC for r=0.9 class 0 = 0.396 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 1 = 0.213 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 2 = 0.407 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all KL = 0.444 +- 0.298 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all L1 = 0.339 +- 0.238 (in-sample avg dev_std = 0.704)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.874
NEC for r=0.3 class 0 = 0.185 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 1 = 0.012 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 2 = 0.007 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all KL = 0.063 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all L1 = 0.069 +- 0.182 (in-sample avg dev_std = 0.132)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.822
NEC for r=0.6 class 0 = 0.33 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.021 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.081 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.173 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.145 +- 0.225 (in-sample avg dev_std = 0.390)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.55 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.257 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.356 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.496 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.388 +- 0.229 (in-sample avg dev_std = 0.720)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:25:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:25:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9287 0.9287[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.47 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 class 2 = 0.398 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 all KL = 0.341 +- 0.258 (in-sample avg dev_std = 0.782)
SUFF_SIMPLE for r=0.3 all L1 = 0.484 +- 0.232 (in-sample avg dev_std = 0.782)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.389
SUFF_SIMPLE for r=0.6 class 0 = 0.467 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 class 1 = 0.426 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 class 2 = 0.269 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 all KL = 0.241 +- 0.221 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.6 all L1 = 0.385 +- 0.209 (in-sample avg dev_std = 0.744)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.287
SUFF_SIMPLE for r=0.9 class 0 = 0.77 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 class 1 = 0.255 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 class 2 = 0.189 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all KL = 0.289 +- 0.392 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.9 all L1 = 0.382 +- 0.343 (in-sample avg dev_std = 0.295)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
SUFF_SIMPLE for r=0.3 class 0 = 0.337 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 class 1 = 0.461 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 class 2 = 0.39 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 all KL = 0.272 +- 0.279 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 all L1 = 0.395 +- 0.243 (in-sample avg dev_std = 0.682)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.257
SUFF_SIMPLE for r=0.6 class 0 = 0.339 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 class 1 = 0.392 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 class 2 = 0.352 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 all KL = 0.243 +- 0.286 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.247 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 0 = 0.832 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.339 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.553 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.474 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.518 +- 0.386 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.854
NEC for r=0.3 class 0 = 0.247 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 1 = 0.015 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 2 = 0.083 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all KL = 0.142 +- 0.256 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all L1 = 0.113 +- 0.203 (in-sample avg dev_std = 0.397)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.784
NEC for r=0.6 class 0 = 0.348 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 1 = 0.052 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 2 = 0.213 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all KL = 0.263 +- 0.326 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all L1 = 0.203 +- 0.257 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.685
NEC for r=0.9 class 0 = 0.426 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 class 1 = 0.211 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 class 2 = 0.402 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 all KL = 0.46 +- 0.308 (in-sample avg dev_std = 0.725)
NEC for r=0.9 all L1 = 0.346 +- 0.246 (in-sample avg dev_std = 0.725)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.79
NEC for r=0.3 class 0 = 0.103 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1 = 0.037 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 2 = 0.008 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.042 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.05 +- 0.138 (in-sample avg dev_std = 0.159)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.743
NEC for r=0.6 class 0 = 0.239 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 1 = 0.052 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 2 = 0.086 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all KL = 0.151 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all L1 = 0.126 +- 0.195 (in-sample avg dev_std = 0.406)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.436 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.254 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.348 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.45 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.346 +- 0.231 (in-sample avg dev_std = 0.715)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:26:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:26:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9250 0.9250[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.535
SUFF_SIMPLE for r=0.3 class 0 = 0.475 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 class 2 = 0.423 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 all KL = 0.364 +- 0.251 (in-sample avg dev_std = 0.773)
SUFF_SIMPLE for r=0.3 all L1 = 0.495 +- 0.217 (in-sample avg dev_std = 0.773)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.466
SUFF_SIMPLE for r=0.6 class 0 = 0.489 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 class 1 = 0.427 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 class 2 = 0.441 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 all KL = 0.333 +- 0.291 (in-sample avg dev_std = 0.714)
SUFF_SIMPLE for r=0.6 all L1 = 0.452 +- 0.248 (in-sample avg dev_std = 0.714)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.322
SUFF_SIMPLE for r=0.9 class 0 = 0.774 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 class 1 = 0.243 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 class 2 = 0.257 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 all KL = 0.333 +- 0.398 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.9 all L1 = 0.404 +- 0.339 (in-sample avg dev_std = 0.281)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.384
SUFF_SIMPLE for r=0.3 class 0 = 0.384 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 class 1 = 0.439 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 class 2 = 0.398 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 all KL = 0.263 +- 0.154 (in-sample avg dev_std = 0.836)
SUFF_SIMPLE for r=0.3 all L1 = 0.407 +- 0.144 (in-sample avg dev_std = 0.836)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.377
SUFF_SIMPLE for r=0.6 class 0 = 0.434 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 class 1 = 0.346 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 class 2 = 0.536 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 all KL = 0.315 +- 0.240 (in-sample avg dev_std = 0.775)
SUFF_SIMPLE for r=0.6 all L1 = 0.439 +- 0.201 (in-sample avg dev_std = 0.775)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.742 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.561 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.363 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.72
NEC for r=0.3 class 0 = 0.357 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 class 1 = 0.034 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 class 2 = 0.407 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 all KL = 0.315 +- 0.364 (in-sample avg dev_std = 0.518)
NEC for r=0.3 all L1 = 0.266 +- 0.297 (in-sample avg dev_std = 0.518)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.691
NEC for r=0.6 class 0 = 0.404 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.056 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.434 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.358 +- 0.372 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.298 +- 0.305 (in-sample avg dev_std = 0.546)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0 = 0.457 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 class 1 = 0.219 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 class 2 = 0.492 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 all KL = 0.491 +- 0.318 (in-sample avg dev_std = 0.695)
NEC for r=0.9 all L1 = 0.39 +- 0.259 (in-sample avg dev_std = 0.695)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.709
NEC for r=0.3 class 0 = 0.48 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1 = 0.039 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 2 = 0.68 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.419 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.401 +- 0.353 (in-sample avg dev_std = 0.312)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.679
NEC for r=0.6 class 0 = 0.515 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 1 = 0.04 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 2 = 0.699 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.451 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.42 +- 0.355 (in-sample avg dev_std = 0.339)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.596
NEC for r=0.9 class 0 = 0.554 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 1 = 0.259 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 2 = 0.672 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all KL = 0.591 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all L1 = 0.496 +- 0.252 (in-sample avg dev_std = 0.671)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:28:52 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:28:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF_SIMPLE for r=0.3 class 0 = 0.476 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 1 = 0.571 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 2 = 0.363 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all KL = 0.341 +- 0.255 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all L1 = 0.468 +- 0.224 (in-sample avg dev_std = 0.747)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.411
SUFF_SIMPLE for r=0.6 class 0 = 0.483 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 1 = 0.399 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 2 = 0.299 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all KL = 0.262 +- 0.213 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all L1 = 0.392 +- 0.195 (in-sample avg dev_std = 0.727)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.329
SUFF_SIMPLE for r=0.9 class 0 = 0.785 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 class 1 = 0.233 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 class 2 = 0.253 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 all KL = 0.337 +- 0.400 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.9 all L1 = 0.403 +- 0.338 (in-sample avg dev_std = 0.270)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.369 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 class 1 = 0.427 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 class 2 = 0.339 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 all KL = 0.237 +- 0.154 (in-sample avg dev_std = 0.804)
SUFF_SIMPLE for r=0.3 all L1 = 0.378 +- 0.147 (in-sample avg dev_std = 0.804)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.301
SUFF_SIMPLE for r=0.6 class 0 = 0.428 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 class 1 = 0.332 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 class 2 = 0.385 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 all KL = 0.25 +- 0.169 (in-sample avg dev_std = 0.774)
SUFF_SIMPLE for r=0.6 all L1 = 0.382 +- 0.157 (in-sample avg dev_std = 0.774)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.898 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.193 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.735 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.380 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.758
NEC for r=0.3 class 0 = 0.321 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 1 = 0.034 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 class 2 = 0.396 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all KL = 0.29 +- 0.336 (in-sample avg dev_std = 0.485)
NEC for r=0.3 all L1 = 0.251 +- 0.279 (in-sample avg dev_std = 0.485)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.711
NEC for r=0.6 class 0 = 0.38 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 1 = 0.059 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 2 = 0.433 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all KL = 0.345 +- 0.358 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all L1 = 0.291 +- 0.296 (in-sample avg dev_std = 0.534)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.631
NEC for r=0.9 class 0 = 0.434 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 class 1 = 0.233 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 class 2 = 0.529 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 all KL = 0.5 +- 0.307 (in-sample avg dev_std = 0.682)
NEC for r=0.9 all L1 = 0.4 +- 0.257 (in-sample avg dev_std = 0.682)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.731
NEC for r=0.3 class 0 = 0.38 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 1 = 0.094 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 2 = 0.666 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all KL = 0.405 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all L1 = 0.381 +- 0.334 (in-sample avg dev_std = 0.319)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.696
NEC for r=0.6 class 0 = 0.434 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 1 = 0.094 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 2 = 0.686 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all KL = 0.445 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all L1 = 0.406 +- 0.334 (in-sample avg dev_std = 0.370)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.506 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.299 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.693 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.6 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.5 +- 0.245 (in-sample avg dev_std = 0.650)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:31:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:31:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9280 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.492
SUFF_SIMPLE for r=0.3 class 0 = 0.431 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 class 1 = 0.609 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 class 2 = 0.381 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 all KL = 0.358 +- 0.256 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 all L1 = 0.473 +- 0.228 (in-sample avg dev_std = 0.737)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.362
SUFF_SIMPLE for r=0.6 class 0 = 0.397 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 class 1 = 0.459 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 class 2 = 0.274 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 all KL = 0.259 +- 0.215 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 all L1 = 0.375 +- 0.201 (in-sample avg dev_std = 0.687)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF_SIMPLE for r=0.9 class 0 = 0.694 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 class 1 = 0.286 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 class 2 = 0.197 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 all KL = 0.299 +- 0.361 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.9 all L1 = 0.373 +- 0.315 (in-sample avg dev_std = 0.301)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.299
SUFF_SIMPLE for r=0.3 class 0 = 0.331 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 class 1 = 0.448 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 class 2 = 0.365 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 all KL = 0.252 +- 0.182 (in-sample avg dev_std = 0.742)
SUFF_SIMPLE for r=0.3 all L1 = 0.381 +- 0.177 (in-sample avg dev_std = 0.742)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.217
SUFF_SIMPLE for r=0.6 class 0 = 0.345 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 class 1 = 0.349 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 class 2 = 0.323 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 all KL = 0.217 +- 0.177 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.6 all L1 = 0.339 +- 0.170 (in-sample avg dev_std = 0.670)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.197 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.475 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.386 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.436 +- 0.360 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.834
NEC for r=0.3 class 0 = 0.296 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.017 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.154 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.185 +- 0.277 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.153 +- 0.225 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.765
NEC for r=0.6 class 0 = 0.388 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 1 = 0.045 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 class 2 = 0.267 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all KL = 0.287 +- 0.330 (in-sample avg dev_std = 0.536)
NEC for r=0.6 all L1 = 0.231 +- 0.267 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.662
NEC for r=0.9 class 0 = 0.458 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 class 1 = 0.2 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 class 2 = 0.437 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 all KL = 0.457 +- 0.303 (in-sample avg dev_std = 0.691)
NEC for r=0.9 all L1 = 0.364 +- 0.250 (in-sample avg dev_std = 0.691)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.764
NEC for r=0.3 class 0 = 0.28 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.01 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.012 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.081 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.101 +- 0.210 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.723
NEC for r=0.6 class 0 = 0.376 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 1 = 0.016 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 2 = 0.088 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all KL = 0.172 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all L1 = 0.161 +- 0.247 (in-sample avg dev_std = 0.359)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.494 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 1 = 0.248 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 2 = 0.356 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all KL = 0.455 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all L1 = 0.367 +- 0.230 (in-sample avg dev_std = 0.687)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:33:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:33:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF_SIMPLE for r=0.3 class 0 = 0.439 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 class 1 = 0.614 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 class 2 = 0.389 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 all KL = 0.357 +- 0.263 (in-sample avg dev_std = 0.748)
SUFF_SIMPLE for r=0.3 all L1 = 0.48 +- 0.237 (in-sample avg dev_std = 0.748)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.369
SUFF_SIMPLE for r=0.6 class 0 = 0.419 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 class 1 = 0.451 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 class 2 = 0.262 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.220 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 all L1 = 0.376 +- 0.207 (in-sample avg dev_std = 0.705)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.303
SUFF_SIMPLE for r=0.9 class 0 = 0.755 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 1 = 0.284 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 2 = 0.194 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.389 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.335 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.256
SUFF_SIMPLE for r=0.3 class 0 = 0.291 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 class 1 = 0.436 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 class 2 = 0.275 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 all KL = 0.204 +- 0.155 (in-sample avg dev_std = 0.718)
SUFF_SIMPLE for r=0.3 all L1 = 0.334 +- 0.160 (in-sample avg dev_std = 0.718)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.174
SUFF_SIMPLE for r=0.6 class 0 = 0.289 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 class 1 = 0.332 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 class 2 = 0.227 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 all KL = 0.163 +- 0.136 (in-sample avg dev_std = 0.616)
SUFF_SIMPLE for r=0.6 all L1 = 0.283 +- 0.134 (in-sample avg dev_std = 0.616)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.074
SUFF_SIMPLE for r=0.9 class 0 = 0.81 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.182 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.269 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.252 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.328 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.826
NEC for r=0.3 class 0 = 0.279 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 1 = 0.017 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 2 = 0.149 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all KL = 0.178 +- 0.275 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all L1 = 0.146 +- 0.224 (in-sample avg dev_std = 0.433)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.756
NEC for r=0.6 class 0 = 0.389 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.044 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.267 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.288 +- 0.331 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.231 +- 0.268 (in-sample avg dev_std = 0.548)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0 = 0.459 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 class 1 = 0.2 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 class 2 = 0.436 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 all KL = 0.463 +- 0.308 (in-sample avg dev_std = 0.708)
NEC for r=0.9 all L1 = 0.364 +- 0.253 (in-sample avg dev_std = 0.708)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0 = 0.138 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 1 = 0.007 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 2 = 0.005 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all KL = 0.025 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all L1 = 0.05 +- 0.116 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.698
NEC for r=0.6 class 0 = 0.286 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.016 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.081 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.139 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.128 +- 0.195 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.543
NEC for r=0.9 class 0 = 0.468 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 1 = 0.251 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 2 = 0.402 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all KL = 0.474 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all L1 = 0.374 +- 0.210 (in-sample avg dev_std = 0.735)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:36:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:36:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.9253 0.9253 0.9253 0.9260 0.9260[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.468
SUFF_SIMPLE for r=0.3 class 0 = 0.429 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 class 1 = 0.602 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 class 2 = 0.357 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 all KL = 0.349 +- 0.257 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 all L1 = 0.462 +- 0.231 (in-sample avg dev_std = 0.722)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.347
SUFF_SIMPLE for r=0.6 class 0 = 0.387 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 class 1 = 0.444 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 class 2 = 0.264 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.202 (in-sample avg dev_std = 0.686)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.190 (in-sample avg dev_std = 0.686)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.264
SUFF_SIMPLE for r=0.9 class 0 = 0.646 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 1 = 0.273 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 class 2 = 0.2 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all KL = 0.281 +- 0.346 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.9 all L1 = 0.355 +- 0.298 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.244
SUFF_SIMPLE for r=0.3 class 0 = 0.233 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 class 1 = 0.451 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 class 2 = 0.202 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 all KL = 0.179 +- 0.169 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 all L1 = 0.295 +- 0.162 (in-sample avg dev_std = 0.587)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.186
SUFF_SIMPLE for r=0.6 class 0 = 0.224 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 class 1 = 0.34 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 class 2 = 0.196 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 all KL = 0.142 +- 0.135 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.6 all L1 = 0.253 +- 0.120 (in-sample avg dev_std = 0.521)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.047
SUFF_SIMPLE for r=0.9 class 0 = 0.269 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.101 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.196 +- 0.097 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.813
NEC for r=0.3 class 0 = 0.261 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 class 1 = 0.02 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 class 2 = 0.22 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 all KL = 0.206 +- 0.286 (in-sample avg dev_std = 0.471)
NEC for r=0.3 all L1 = 0.166 +- 0.230 (in-sample avg dev_std = 0.471)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.75
NEC for r=0.6 class 0 = 0.353 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 1 = 0.044 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 2 = 0.328 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all KL = 0.301 +- 0.331 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all L1 = 0.241 +- 0.268 (in-sample avg dev_std = 0.558)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.644
NEC for r=0.9 class 0 = 0.453 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 class 1 = 0.204 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 class 2 = 0.467 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 all KL = 0.468 +- 0.306 (in-sample avg dev_std = 0.698)
NEC for r=0.9 all L1 = 0.375 +- 0.254 (in-sample avg dev_std = 0.698)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.898
NEC for r=0.3 class 0 = 0.134 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1 = 0.005 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 2 = 0.025 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.055 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.055 +- 0.153 (in-sample avg dev_std = 0.194)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.827
NEC for r=0.6 class 0 = 0.254 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.014 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.19 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.196 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.153 +- 0.217 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.492 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 1 = 0.25 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 2 = 0.468 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all KL = 0.518 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all L1 = 0.404 +- 0.217 (in-sample avg dev_std = 0.755)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:38:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:38:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9277 0.9277[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF_SIMPLE for r=0.3 class 0 = 0.49 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 class 1 = 0.554 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 class 2 = 0.389 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 all KL = 0.343 +- 0.252 (in-sample avg dev_std = 0.765)
SUFF_SIMPLE for r=0.3 all L1 = 0.476 +- 0.227 (in-sample avg dev_std = 0.765)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.373
SUFF_SIMPLE for r=0.6 class 0 = 0.472 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 class 1 = 0.39 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 class 2 = 0.27 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 all KL = 0.241 +- 0.214 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.6 all L1 = 0.375 +- 0.204 (in-sample avg dev_std = 0.719)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.297
SUFF_SIMPLE for r=0.9 class 0 = 0.812 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 class 1 = 0.238 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 class 2 = 0.193 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 all KL = 0.309 +- 0.397 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.9 all L1 = 0.39 +- 0.347 (in-sample avg dev_std = 0.243)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.291
SUFF_SIMPLE for r=0.3 class 0 = 0.258 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 class 1 = 0.337 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 class 2 = 0.333 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 all KL = 0.183 +- 0.162 (in-sample avg dev_std = 0.676)
SUFF_SIMPLE for r=0.3 all L1 = 0.309 +- 0.147 (in-sample avg dev_std = 0.676)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.217
SUFF_SIMPLE for r=0.6 class 0 = 0.267 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 class 1 = 0.299 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 class 2 = 0.277 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 all KL = 0.157 +- 0.150 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.6 all L1 = 0.281 +- 0.140 (in-sample avg dev_std = 0.606)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.253
SUFF_SIMPLE for r=0.9 class 0 = 0.204 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.438 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.841
NEC for r=0.3 class 0 = 0.23 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 class 1 = 0.019 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 class 2 = 0.121 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 all KL = 0.146 +- 0.252 (in-sample avg dev_std = 0.370)
NEC for r=0.3 all L1 = 0.122 +- 0.208 (in-sample avg dev_std = 0.370)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.785
NEC for r=0.6 class 0 = 0.305 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.056 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.236 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.25 +- 0.307 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.198 +- 0.246 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.674
NEC for r=0.9 class 0 = 0.405 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 class 1 = 0.228 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 class 2 = 0.418 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 all KL = 0.456 +- 0.296 (in-sample avg dev_std = 0.709)
NEC for r=0.9 all L1 = 0.35 +- 0.241 (in-sample avg dev_std = 0.709)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.775
NEC for r=0.3 class 0 = 0.309 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1 = 0.318 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 2 = 0.02 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.235 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.216 +- 0.319 (in-sample avg dev_std = 0.236)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.739
NEC for r=0.6 class 0 = 0.393 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.331 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.093 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.316 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.272 +- 0.315 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.809
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.575
NEC for r=0.9 class 0 = 0.556 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 1 = 0.502 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 2 = 0.371 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all KL = 0.593 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all L1 = 0.477 +- 0.228 (in-sample avg dev_std = 0.722)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:40:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:40:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.518
SUFF_SIMPLE for r=0.3 class 0 = 0.5 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 class 1 = 0.593 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 class 2 = 0.409 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 all KL = 0.371 +- 0.263 (in-sample avg dev_std = 0.755)
SUFF_SIMPLE for r=0.3 all L1 = 0.499 +- 0.234 (in-sample avg dev_std = 0.755)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.396
SUFF_SIMPLE for r=0.6 class 0 = 0.497 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 1 = 0.429 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 class 2 = 0.279 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all KL = 0.265 +- 0.228 (in-sample avg dev_std = 0.727)
SUFF_SIMPLE for r=0.6 all L1 = 0.399 +- 0.214 (in-sample avg dev_std = 0.727)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.298
SUFF_SIMPLE for r=0.9 class 0 = 0.827 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 class 2 = 0.201 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 all KL = 0.316 +- 0.397 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.9 all L1 = 0.401 +- 0.349 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.294
SUFF_SIMPLE for r=0.3 class 0 = 0.268 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 class 1 = 0.458 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 class 2 = 0.237 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 all KL = 0.196 +- 0.170 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 all L1 = 0.32 +- 0.157 (in-sample avg dev_std = 0.708)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.209
SUFF_SIMPLE for r=0.6 class 0 = 0.277 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 class 1 = 0.349 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 class 2 = 0.183 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 all KL = 0.152 +- 0.134 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.6 all L1 = 0.27 +- 0.128 (in-sample avg dev_std = 0.601)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.038
SUFF_SIMPLE for r=0.9 class 0 = 0.324 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.172 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.131 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.208 +- 0.076 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.817
NEC for r=0.3 class 0 = 0.296 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 1 = 0.022 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 class 2 = 0.11 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all KL = 0.163 +- 0.264 (in-sample avg dev_std = 0.378)
NEC for r=0.3 all L1 = 0.14 +- 0.226 (in-sample avg dev_std = 0.378)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.767
NEC for r=0.6 class 0 = 0.348 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 1 = 0.048 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 2 = 0.225 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all KL = 0.251 +- 0.317 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all L1 = 0.205 +- 0.263 (in-sample avg dev_std = 0.487)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.671
NEC for r=0.9 class 0 = 0.41 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 1 = 0.213 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 2 = 0.408 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all KL = 0.441 +- 0.301 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all L1 = 0.343 +- 0.248 (in-sample avg dev_std = 0.685)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.791
NEC for r=0.3 class 0 = 0.331 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.015 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.012 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.124 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.12 +- 0.245 (in-sample avg dev_std = 0.161)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 0 = 0.393 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1 = 0.019 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 2 = 0.08 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.189 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.165 +- 0.267 (in-sample avg dev_std = 0.319)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.54 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.247 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.428 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.515 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.406 +- 0.229 (in-sample avg dev_std = 0.720)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.346, 0.233, 0.287], 'all_L1': [0.478, 0.369, 0.373]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.248, 0.31], 'all_L1': [0.49, 0.384, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.241, 0.289], 'all_L1': [0.484, 0.385, 0.382]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.333, 0.333], 'all_L1': [0.495, 0.452, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.262, 0.337], 'all_L1': [0.468, 0.392, 0.403]}), defaultdict(<class 'list'>, {'all_KL': [0.358, 0.259, 0.299], 'all_L1': [0.473, 0.375, 0.373]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.248, 0.308], 'all_L1': [0.48, 0.376, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.349, 0.248, 0.281], 'all_L1': [0.462, 0.364, 0.355]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.241, 0.309], 'all_L1': [0.476, 0.375, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.371, 0.265, 0.316], 'all_L1': [0.499, 0.399, 0.401]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.157, 0.257, 0.46], 'all_L1': [0.125, 0.204, 0.355]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.244, 0.444], 'all_L1': [0.104, 0.191, 0.339]}), defaultdict(<class 'list'>, {'all_KL': [0.142, 0.263, 0.46], 'all_L1': [0.113, 0.203, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.358, 0.491], 'all_L1': [0.266, 0.298, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.29, 0.345, 0.5], 'all_L1': [0.251, 0.291, 0.4]}), defaultdict(<class 'list'>, {'all_KL': [0.185, 0.287, 0.457], 'all_L1': [0.153, 0.231, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.178, 0.288, 0.463], 'all_L1': [0.146, 0.231, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.206, 0.301, 0.468], 'all_L1': [0.166, 0.241, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.25, 0.456], 'all_L1': [0.122, 0.198, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.163, 0.251, 0.441], 'all_L1': [0.14, 0.205, 0.343]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.385, 0.35, 0.444], 'all_L1': [0.478, 0.437, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.216, 0.165, 0.283], 'all_L1': [0.339, 0.287, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.243, 0.474], 'all_L1': [0.395, 0.361, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.315, 0.561], 'all_L1': [0.407, 0.439, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.237, 0.25, 0.542], 'all_L1': [0.378, 0.382, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.217, 0.386], 'all_L1': [0.381, 0.339, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.204, 0.163, 0.252], 'all_L1': [0.334, 0.283, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.179, 0.142, 0.101], 'all_L1': [0.295, 0.253, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.183, 0.157, 0.246], 'all_L1': [0.309, 0.281, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.196, 0.152, 0.131], 'all_L1': [0.32, 0.27, 0.208]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.122, 0.163, 0.411], 'all_L1': [0.107, 0.138, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.173, 0.496], 'all_L1': [0.069, 0.145, 0.388]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.151, 0.45], 'all_L1': [0.05, 0.126, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.451, 0.591], 'all_L1': [0.401, 0.42, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.445, 0.6], 'all_L1': [0.381, 0.406, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.172, 0.455], 'all_L1': [0.101, 0.161, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.139, 0.474], 'all_L1': [0.05, 0.128, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.196, 0.518], 'all_L1': [0.055, 0.153, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.316, 0.593], 'all_L1': [0.216, 0.272, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.189, 0.515], 'all_L1': [0.12, 0.165, 0.406]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.480 +- 0.011, 0.387 +- 0.024, 0.386 +- 0.015
suff_simple class all_KL  =  0.353 +- 0.010, 0.258 +- 0.027, 0.307 +- 0.018
[[0.4962916672229767, 0.36283332109451294, 0.28247714042663574], [0.5117499828338623, 0.37966665625572205, 0.3011699914932251], [0.5109583139419556, 0.38862499594688416, 0.2866460382938385], [0.5347916483879089, 0.4658749997615814, 0.3215438425540924], [0.500041663646698, 0.41087499260902405, 0.3291420042514801], [0.49158334732055664, 0.3622083365917206, 0.2841581404209137], [0.4985416531562805, 0.36929166316986084, 0.3029854893684387], [0.46812498569488525, 0.3472500145435333, 0.2636498212814331], [0.4985833466053009, 0.37279167771339417, 0.29720279574394226], [0.5180416703224182, 0.3957499861717224, 0.2976062297821045]]
[[0.346, 0.233, 0.287], [0.357, 0.248, 0.31], [0.341, 0.241, 0.289], [0.364, 0.333, 0.333], [0.341, 0.262, 0.337], [0.358, 0.259, 0.299], [0.357, 0.248, 0.308], [0.349, 0.248, 0.281], [0.343, 0.241, 0.309], [0.371, 0.265, 0.316]]
suff_simple_acc_int  =  0.503 +- 0.017, 0.386 +- 0.032, 0.297 +- 0.018
nec class all_L1  =  0.159 +- 0.053, 0.229 +- 0.036, 0.363 +- 0.019
nec class all_KL  =  0.191 +- 0.060, 0.284 +- 0.038, 0.464 +- 0.018
[[0.8453333377838135, 0.778249979019165, 0.6684583425521851], [0.85958331823349, 0.7927916646003723, 0.6860833168029785], [0.8536666631698608, 0.784250020980835, 0.6853749752044678], [0.7201666831970215, 0.690708339214325, 0.6345416903495789], [0.7579583525657654, 0.7113333344459534, 0.6314166784286499], [0.8342916369438171, 0.76541668176651, 0.6622916460037231], [0.8261666893959045, 0.7560416460037231, 0.6599166393280029], [0.8131666779518127, 0.749958336353302, 0.6442499756813049], [0.840624988079071, 0.7854583263397217, 0.6738333106040955], [0.8168333172798157, 0.7673749923706055, 0.6710416674613953]]
[[0.157, 0.257, 0.46], [0.13, 0.244, 0.444], [0.142, 0.263, 0.46], [0.315, 0.358, 0.491], [0.29, 0.345, 0.5], [0.185, 0.287, 0.457], [0.178, 0.288, 0.463], [0.206, 0.301, 0.468], [0.146, 0.25, 0.456], [0.163, 0.251, 0.441]]
nec_acc_int  =  0.817 +- 0.042, 0.758 +- 0.032, 0.662 +- 0.018

Eval split val
suff_simple class all_L1  =  0.364 +- 0.052, 0.333 +- 0.066, 0.393 +- 0.130
suff_simple class all_KL  =  0.239 +- 0.058, 0.215 +- 0.069, 0.342 +- 0.155
[[0.3109999895095825, 0.2540833353996277, 0.3183828294277191], [0.3162083327770233, 0.24391666054725647, 0.23878711462020874], [0.3114583194255829, 0.25699999928474426, 0.25457990169525146], [0.3839583396911621, 0.3766666650772095, 0.21920403838157654], [0.3292083442211151, 0.30133333802223206, 0.1711939424276352], [0.2994999885559082, 0.21699999272823334, 0.19835755228996277], [0.2563333213329315, 0.17399999499320984, 0.07391029596328735], [0.24416667222976685, 0.18574999272823334, 0.04737839475274086], [0.2907083332538605, 0.21674999594688416, 0.2533164918422699], [0.2940416634082794, 0.20916666090488434, 0.03790271654725075]]
[[0.385, 0.35, 0.444], [0.216, 0.165, 0.283], [0.272, 0.243, 0.474], [0.263, 0.315, 0.561], [0.237, 0.25, 0.542], [0.252, 0.217, 0.386], [0.204, 0.163, 0.252], [0.179, 0.142, 0.101], [0.183, 0.157, 0.246], [0.196, 0.152, 0.131]]
suff_simple_acc_int  =  0.304 +- 0.037, 0.244 +- 0.057, 0.181 +- 0.092
nec class all_L1  =  0.155 +- 0.127, 0.211 +- 0.108, 0.409 +- 0.059
nec class all_KL  =  0.157 +- 0.139, 0.239 +- 0.114, 0.510 +- 0.063
[[0.6487916707992554, 0.6278333067893982, 0.5097083449363708], [0.8736249804496765, 0.8216249942779541, 0.6402083039283752], [0.7904166579246521, 0.7432916760444641, 0.5920833349227905], [0.7092499732971191, 0.6792916655540466, 0.5962083339691162], [0.7305416464805603, 0.6957916617393494, 0.5852916836738586], [0.7642916440963745, 0.7228333353996277, 0.5662916898727417], [0.7418749928474426, 0.6977083086967468, 0.5426250100135803], [0.8976666927337646, 0.8272083401679993, 0.6355000138282776], [0.7747083306312561, 0.7391666769981384, 0.575208306312561], [0.7914999723434448, 0.7635833621025085, 0.6010833382606506]]
[[0.122, 0.163, 0.411], [0.063, 0.173, 0.496], [0.042, 0.151, 0.45], [0.419, 0.451, 0.591], [0.405, 0.445, 0.6], [0.081, 0.172, 0.455], [0.025, 0.139, 0.474], [0.055, 0.196, 0.518], [0.235, 0.316, 0.593], [0.124, 0.189, 0.515]]
nec_acc_int  =  0.772 +- 0.070, 0.732 +- 0.059, 0.584 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.320 +- 0.027, 0.308 +- 0.027, 0.374 +- 0.013
Faith. Armon (L1)= 		  =  0.234 +- 0.056, 0.287 +- 0.032, 0.374 +- 0.013
Faith. GMean (L1)= 	  =  0.273 +- 0.043, 0.297 +- 0.030, 0.374 +- 0.013
Faith. Aritm (KL)= 		  =  0.272 +- 0.031, 0.271 +- 0.030, 0.385 +- 0.015
Faith. Armon (KL)= 		  =  0.243 +- 0.046, 0.270 +- 0.030, 0.369 +- 0.017
Faith. GMean (KL)= 	  =  0.257 +- 0.039, 0.270 +- 0.030, 0.377 +- 0.016

Eval split val
Faith. Aritm (L1)= 		  =  0.259 +- 0.074, 0.272 +- 0.075, 0.401 +- 0.074
Faith. Armon (L1)= 		  =  0.193 +- 0.111, 0.248 +- 0.086, 0.388 +- 0.083
Faith. GMean (L1)= 	  =  0.221 +- 0.095, 0.259 +- 0.080, 0.394 +- 0.079
Faith. Aritm (KL)= 		  =  0.198 +- 0.077, 0.227 +- 0.076, 0.426 +- 0.086
Faith. Armon (KL)= 		  =  0.159 +- 0.090, 0.215 +- 0.069, 0.387 +- 0.127
Faith. GMean (KL)= 	  =  0.176 +- 0.085, 0.221 +- 0.072, 0.404 +- 0.108
Computed for split load_split = id



Completed in  0:20:28.809166  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN simple_concept2temperature GOODMotif/basis/covariate NEC_ALPHA 0.01 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:42:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:42:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.474 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 class 1 = 0.473 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 class 2 = 0.38 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 all KL = 0.348 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 all L1 = 0.441 +- 0.199 (in-sample avg dev_std = 0.674)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.394
SUFF_SIMPLE for r=0.6 class 0 = 0.49 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 class 1 = 0.338 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 class 2 = 0.27 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 all KL = 0.277 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.186 (in-sample avg dev_std = 0.587)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.3
SUFF_SIMPLE for r=0.9 class 0 = 0.72 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 class 1 = 0.249 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 class 2 = 0.213 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 all KL = 0.351 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 all L1 = 0.374 +- 0.282 (in-sample avg dev_std = 0.173)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.603 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 class 1 = 0.534 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 class 2 = 0.382 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 all KL = 0.477 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 all L1 = 0.506 +- 0.250 (in-sample avg dev_std = 0.453)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.283
SUFF_SIMPLE for r=0.6 class 0 = 0.656 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 class 1 = 0.613 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 class 2 = 0.369 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 all KL = 0.544 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 all L1 = 0.546 +- 0.296 (in-sample avg dev_std = 0.274)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.401
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.884 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.806 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.416 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.72 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.287 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.783
NEC for r=0.3 class 0 = 0.375 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.264 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.181 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.259 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.271 +- 0.217 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.74
NEC for r=0.6 class 0 = 0.407 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 1 = 0.267 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 2 = 0.297 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all KL = 0.336 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all L1 = 0.322 +- 0.239 (in-sample avg dev_std = 0.481)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.649
NEC for r=0.9 class 0 = 0.461 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.395 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.453 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.509 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.436 +- 0.211 (in-sample avg dev_std = 0.650)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.495
NEC for r=0.3 class 0 = 0.628 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 1 = 0.65 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 2 = 0.439 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all KL = 0.597 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all L1 = 0.572 +- 0.223 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.489
NEC for r=0.6 class 0 = 0.625 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 1 = 0.645 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 2 = 0.481 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all KL = 0.624 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all L1 = 0.584 +- 0.199 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.559 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.624 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.581 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.65 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.588 +- 0.150 (in-sample avg dev_std = 0.571)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:44:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:44:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.485
SUFF_SIMPLE for r=0.3 class 0 = 0.471 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 class 1 = 0.436 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 class 2 = 0.383 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 all KL = 0.352 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 all L1 = 0.429 +- 0.195 (in-sample avg dev_std = 0.626)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.375
SUFF_SIMPLE for r=0.6 class 0 = 0.489 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 1 = 0.318 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 2 = 0.275 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all KL = 0.285 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all L1 = 0.358 +- 0.186 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.263
SUFF_SIMPLE for r=0.9 class 0 = 0.638 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 1 = 0.221 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 2 = 0.212 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all KL = 0.307 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.252 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.298
SUFF_SIMPLE for r=0.3 class 0 = 0.696 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 class 1 = 0.584 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 class 2 = 0.688 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 all KL = 0.665 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 all L1 = 0.656 +- 0.308 (in-sample avg dev_std = 0.272)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.29
SUFF_SIMPLE for r=0.6 class 0 = 0.733 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 class 1 = 0.563 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 class 2 = 0.674 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 all KL = 0.669 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 all L1 = 0.657 +- 0.316 (in-sample avg dev_std = 0.188)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.493
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF_SIMPLE for r=0.9 class 0 = 0.975 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.873 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.838
NEC for r=0.3 class 0 = 0.277 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 class 1 = 0.229 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 class 2 = 0.199 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 all KL = 0.196 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 all L1 = 0.234 +- 0.178 (in-sample avg dev_std = 0.346)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.763
NEC for r=0.6 class 0 = 0.37 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 1 = 0.273 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 2 = 0.308 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all KL = 0.31 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all L1 = 0.316 +- 0.220 (in-sample avg dev_std = 0.474)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.664
NEC for r=0.9 class 0 = 0.423 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 class 1 = 0.406 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 class 2 = 0.456 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 all KL = 0.482 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 all L1 = 0.429 +- 0.201 (in-sample avg dev_std = 0.624)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.581
NEC for r=0.3 class 0 = 0.182 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 1 = 0.113 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 2 = 0.043 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all KL = 0.072 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all L1 = 0.113 +- 0.147 (in-sample avg dev_std = 0.145)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.528
NEC for r=0.6 class 0 = 0.235 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.153 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.108 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.137 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.165 +- 0.194 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.532
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.45
NEC for r=0.9 class 0 = 0.249 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 1 = 0.279 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 2 = 0.201 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all KL = 0.237 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all L1 = 0.243 +- 0.237 (in-sample avg dev_std = 0.400)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:45:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:45:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mChartInfo 0.9250 0.9250 0.9250 0.9250 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.507
SUFF_SIMPLE for r=0.3 class 0 = 0.483 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 class 1 = 0.471 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 class 2 = 0.384 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 all KL = 0.356 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 all L1 = 0.445 +- 0.197 (in-sample avg dev_std = 0.677)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF_SIMPLE for r=0.6 class 0 = 0.495 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 1 = 0.343 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 2 = 0.268 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all L1 = 0.366 +- 0.186 (in-sample avg dev_std = 0.583)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.299
SUFF_SIMPLE for r=0.9 class 0 = 0.712 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 class 1 = 0.25 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 class 2 = 0.207 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 all KL = 0.347 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.279 (in-sample avg dev_std = 0.172)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.275
SUFF_SIMPLE for r=0.3 class 0 = 0.552 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 class 1 = 0.604 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 class 2 = 0.516 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 all KL = 0.548 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 all L1 = 0.557 +- 0.278 (in-sample avg dev_std = 0.380)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.251
SUFF_SIMPLE for r=0.6 class 0 = 0.587 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 class 1 = 0.598 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 class 2 = 0.484 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 all KL = 0.564 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 all L1 = 0.556 +- 0.282 (in-sample avg dev_std = 0.281)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.23
SUFF_SIMPLE for r=0.9 class 0 = 0.88 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.675 +- 0.293 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.775
NEC for r=0.3 class 0 = 0.375 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1 = 0.267 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 2 = 0.188 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.267 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.274 +- 0.215 (in-sample avg dev_std = 0.414)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.731
NEC for r=0.6 class 0 = 0.408 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.275 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.288 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.336 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.322 +- 0.240 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.651
NEC for r=0.9 class 0 = 0.459 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 class 1 = 0.389 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 class 2 = 0.45 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 all KL = 0.501 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 all L1 = 0.432 +- 0.212 (in-sample avg dev_std = 0.649)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
NEC for r=0.3 class 0 = 0.517 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 1 = 0.311 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 2 = 0.085 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all KL = 0.27 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all L1 = 0.305 +- 0.291 (in-sample avg dev_std = 0.245)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.523 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1 = 0.323 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 2 = 0.141 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.31 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.329 +- 0.293 (in-sample avg dev_std = 0.304)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.492 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.354 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.305 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.394 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.384 +- 0.268 (in-sample avg dev_std = 0.445)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:47:54 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:47:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.9247 0.9247 0.9247 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.504
SUFF_SIMPLE for r=0.3 class 0 = 0.466 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 class 1 = 0.467 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 class 2 = 0.386 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 all KL = 0.36 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 all L1 = 0.439 +- 0.196 (in-sample avg dev_std = 0.632)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
SUFF_SIMPLE for r=0.6 class 0 = 0.47 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 1 = 0.342 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 2 = 0.275 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all KL = 0.286 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all L1 = 0.36 +- 0.180 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.278
SUFF_SIMPLE for r=0.9 class 0 = 0.626 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 class 1 = 0.241 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 class 2 = 0.219 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 all KL = 0.327 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 all L1 = 0.346 +- 0.237 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.305
SUFF_SIMPLE for r=0.3 class 0 = 0.646 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 class 1 = 0.603 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 class 2 = 0.329 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 all KL = 0.539 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 all L1 = 0.526 +- 0.292 (in-sample avg dev_std = 0.306)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.284
SUFF_SIMPLE for r=0.6 class 0 = 0.661 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 1 = 0.583 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 2 = 0.312 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all KL = 0.534 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all L1 = 0.519 +- 0.296 (in-sample avg dev_std = 0.216)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.804 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.764 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.348 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.587 +- 0.277 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.86
NEC for r=0.3 class 0 = 0.276 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 class 1 = 0.215 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 class 2 = 0.167 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 all KL = 0.178 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 all L1 = 0.218 +- 0.168 (in-sample avg dev_std = 0.334)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.783
NEC for r=0.6 class 0 = 0.373 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.246 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.287 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.299 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.3 +- 0.208 (in-sample avg dev_std = 0.483)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.679
NEC for r=0.9 class 0 = 0.435 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 class 1 = 0.377 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 class 2 = 0.443 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 all KL = 0.474 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 all L1 = 0.418 +- 0.200 (in-sample avg dev_std = 0.630)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.717
NEC for r=0.3 class 0 = 0.108 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.241 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.277 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.109 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.209 +- 0.138 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0 = 0.194 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.268 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.357 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.202 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.273 +- 0.169 (in-sample avg dev_std = 0.399)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.25 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 1 = 0.336 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 2 = 0.497 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all KL = 0.322 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all L1 = 0.361 +- 0.218 (in-sample avg dev_std = 0.487)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:50:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:50:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9270 0.9270[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF_SIMPLE for r=0.3 class 0 = 0.478 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 class 1 = 0.472 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 class 2 = 0.397 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 all KL = 0.375 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.203 (in-sample avg dev_std = 0.641)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.381
SUFF_SIMPLE for r=0.6 class 0 = 0.484 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 1 = 0.343 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 2 = 0.288 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all KL = 0.301 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all L1 = 0.37 +- 0.182 (in-sample avg dev_std = 0.567)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.296
SUFF_SIMPLE for r=0.9 class 0 = 0.681 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 class 1 = 0.249 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 class 2 = 0.223 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 all KL = 0.352 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 all L1 = 0.366 +- 0.259 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.255
SUFF_SIMPLE for r=0.3 class 0 = 0.395 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 class 1 = 0.478 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 class 2 = 0.34 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 all KL = 0.422 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 all L1 = 0.404 +- 0.124 (in-sample avg dev_std = 0.484)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.197
SUFF_SIMPLE for r=0.6 class 0 = 0.441 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 class 1 = 0.504 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 class 2 = 0.291 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 all KL = 0.456 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 all L1 = 0.411 +- 0.159 (in-sample avg dev_std = 0.367)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.042
SUFF_SIMPLE for r=0.9 class 0 = 0.473 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.238 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.481 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.383 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.776
NEC for r=0.3 class 0 = 0.373 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1 = 0.303 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 2 = 0.158 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.255 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.275 +- 0.231 (in-sample avg dev_std = 0.414)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.739
NEC for r=0.6 class 0 = 0.409 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.298 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.264 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.326 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.322 +- 0.242 (in-sample avg dev_std = 0.483)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.642
NEC for r=0.9 class 0 = 0.454 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 class 1 = 0.403 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 class 2 = 0.436 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 all KL = 0.484 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 all L1 = 0.431 +- 0.216 (in-sample avg dev_std = 0.631)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.726 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 1 = 0.577 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 2 = 0.143 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all KL = 0.42 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all L1 = 0.482 +- 0.281 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.73 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 1 = 0.572 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 2 = 0.201 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all KL = 0.459 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all L1 = 0.501 +- 0.265 (in-sample avg dev_std = 0.342)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.329
NEC for r=0.9 class 0 = 0.692 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.565 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.41 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.54 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.556 +- 0.167 (in-sample avg dev_std = 0.508)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:53:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:53:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 69 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9247 0.9247[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.489
SUFF_SIMPLE for r=0.3 class 0 = 0.466 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 1 = 0.432 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 2 = 0.385 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all KL = 0.338 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all L1 = 0.427 +- 0.202 (in-sample avg dev_std = 0.665)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.375
SUFF_SIMPLE for r=0.6 class 0 = 0.473 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 class 1 = 0.318 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 class 2 = 0.273 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 all KL = 0.272 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 all L1 = 0.352 +- 0.181 (in-sample avg dev_std = 0.566)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.297
SUFF_SIMPLE for r=0.9 class 0 = 0.699 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 1 = 0.25 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 2 = 0.215 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all KL = 0.352 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.272 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.193
SUFF_SIMPLE for r=0.3 class 0 = 0.364 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 class 1 = 0.45 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 class 2 = 0.331 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 all KL = 0.404 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 all L1 = 0.381 +- 0.134 (in-sample avg dev_std = 0.456)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.167
SUFF_SIMPLE for r=0.6 class 0 = 0.4 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 1 = 0.415 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 2 = 0.277 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all KL = 0.398 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.131 (in-sample avg dev_std = 0.351)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.037
SUFF_SIMPLE for r=0.9 class 0 = 0.414 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.44 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.225 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.428 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.128 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.799
NEC for r=0.3 class 0 = 0.375 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.246 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.183 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.244 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.265 +- 0.210 (in-sample avg dev_std = 0.403)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.738
NEC for r=0.6 class 0 = 0.417 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 1 = 0.295 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 2 = 0.288 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all KL = 0.344 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all L1 = 0.331 +- 0.241 (in-sample avg dev_std = 0.507)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.643
NEC for r=0.9 class 0 = 0.464 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 1 = 0.426 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 2 = 0.45 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all KL = 0.515 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all L1 = 0.447 +- 0.213 (in-sample avg dev_std = 0.665)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
NEC for r=0.3 class 0 = 0.729 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1 = 0.45 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 2 = 0.132 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.387 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.437 +- 0.284 (in-sample avg dev_std = 0.309)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.732 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 1 = 0.462 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 2 = 0.192 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all KL = 0.436 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all L1 = 0.463 +- 0.268 (in-sample avg dev_std = 0.389)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.332
NEC for r=0.9 class 0 = 0.698 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 1 = 0.512 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 2 = 0.413 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all KL = 0.538 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all L1 = 0.541 +- 0.183 (in-sample avg dev_std = 0.536)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:55:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:55:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
SUFF_SIMPLE for r=0.3 class 0 = 0.458 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 1 = 0.478 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 2 = 0.391 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all KL = 0.35 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all L1 = 0.441 +- 0.200 (in-sample avg dev_std = 0.665)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.398
SUFF_SIMPLE for r=0.6 class 0 = 0.471 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 class 1 = 0.347 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 class 2 = 0.268 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 all KL = 0.277 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 all L1 = 0.359 +- 0.181 (in-sample avg dev_std = 0.571)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.293
SUFF_SIMPLE for r=0.9 class 0 = 0.666 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 class 1 = 0.256 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 class 2 = 0.21 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 all KL = 0.332 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 all L1 = 0.359 +- 0.261 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.254
SUFF_SIMPLE for r=0.3 class 0 = 0.455 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 class 1 = 0.581 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 class 2 = 0.515 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 all KL = 0.516 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 all L1 = 0.517 +- 0.257 (in-sample avg dev_std = 0.372)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.233
SUFF_SIMPLE for r=0.6 class 0 = 0.487 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 class 1 = 0.561 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 class 2 = 0.483 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 all KL = 0.519 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 all L1 = 0.51 +- 0.255 (in-sample avg dev_std = 0.298)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.28
SUFF_SIMPLE for r=0.9 class 0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.516 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.611 +- 0.244 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.77
NEC for r=0.3 class 0 = 0.389 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 class 1 = 0.273 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 class 2 = 0.193 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 all KL = 0.276 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 all L1 = 0.282 +- 0.238 (in-sample avg dev_std = 0.431)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.726
NEC for r=0.6 class 0 = 0.425 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 class 1 = 0.269 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 class 2 = 0.293 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 all KL = 0.34 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 all L1 = 0.327 +- 0.255 (in-sample avg dev_std = 0.495)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.647
NEC for r=0.9 class 0 = 0.482 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 1 = 0.386 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 2 = 0.447 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all KL = 0.507 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all L1 = 0.438 +- 0.224 (in-sample avg dev_std = 0.644)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.58 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 1 = 0.345 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 2 = 0.104 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all KL = 0.305 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all L1 = 0.343 +- 0.298 (in-sample avg dev_std = 0.266)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.589 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.346 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.155 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.34 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.364 +- 0.298 (in-sample avg dev_std = 0.309)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.314
NEC for r=0.9 class 0 = 0.57 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 1 = 0.371 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 2 = 0.304 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all KL = 0.413 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all L1 = 0.416 +- 0.271 (in-sample avg dev_std = 0.416)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:57:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:57:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.487
SUFF_SIMPLE for r=0.3 class 0 = 0.48 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 class 1 = 0.455 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 class 2 = 0.373 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 all KL = 0.346 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 all L1 = 0.435 +- 0.206 (in-sample avg dev_std = 0.662)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.38
SUFF_SIMPLE for r=0.6 class 0 = 0.487 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 class 1 = 0.332 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 class 2 = 0.271 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 all KL = 0.28 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.189 (in-sample avg dev_std = 0.577)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.299
SUFF_SIMPLE for r=0.9 class 0 = 0.708 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 class 1 = 0.243 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 class 2 = 0.218 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 all KL = 0.349 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 all L1 = 0.37 +- 0.275 (in-sample avg dev_std = 0.182)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
SUFF_SIMPLE for r=0.3 class 0 = 0.474 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 class 1 = 0.506 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 class 2 = 0.29 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 all KL = 0.422 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 all L1 = 0.423 +- 0.183 (in-sample avg dev_std = 0.462)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.278
SUFF_SIMPLE for r=0.6 class 0 = 0.536 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 class 1 = 0.568 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 class 2 = 0.249 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 all KL = 0.473 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 all L1 = 0.451 +- 0.234 (in-sample avg dev_std = 0.276)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.222 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.464 +- 0.247 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.778
NEC for r=0.3 class 0 = 0.369 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.254 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.195 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.27 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.27 +- 0.227 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.734
NEC for r=0.6 class 0 = 0.404 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 1 = 0.262 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 2 = 0.302 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all KL = 0.342 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all L1 = 0.321 +- 0.247 (in-sample avg dev_std = 0.486)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.461 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 class 1 = 0.392 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 class 2 = 0.461 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 all KL = 0.51 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 all L1 = 0.438 +- 0.225 (in-sample avg dev_std = 0.648)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.757 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 1 = 0.655 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 2 = 0.274 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all KL = 0.558 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all L1 = 0.562 +- 0.256 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.752 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.663 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.326 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.595 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.581 +- 0.232 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.693 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 1 = 0.639 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 2 = 0.513 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all KL = 0.648 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all L1 = 0.615 +- 0.127 (in-sample avg dev_std = 0.608)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:00:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:00:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.503
SUFF_SIMPLE for r=0.3 class 0 = 0.476 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 class 1 = 0.468 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 class 2 = 0.379 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 all KL = 0.345 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 all L1 = 0.44 +- 0.203 (in-sample avg dev_std = 0.680)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF_SIMPLE for r=0.6 class 0 = 0.491 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 class 1 = 0.337 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 class 2 = 0.271 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 all KL = 0.275 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.190 (in-sample avg dev_std = 0.590)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.294
SUFF_SIMPLE for r=0.9 class 0 = 0.714 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 class 1 = 0.246 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 class 2 = 0.205 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 all KL = 0.339 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 all L1 = 0.368 +- 0.282 (in-sample avg dev_std = 0.174)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.643 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 class 1 = 0.561 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 class 2 = 0.373 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 all KL = 0.522 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 all L1 = 0.525 +- 0.236 (in-sample avg dev_std = 0.437)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.298
SUFF_SIMPLE for r=0.6 class 0 = 0.71 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 class 1 = 0.671 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 class 2 = 0.373 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 all KL = 0.619 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 all L1 = 0.585 +- 0.287 (in-sample avg dev_std = 0.226)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.406
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.831 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.412 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.729 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.286 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.765
NEC for r=0.3 class 0 = 0.384 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 1 = 0.313 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 2 = 0.179 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all KL = 0.288 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all L1 = 0.289 +- 0.241 (in-sample avg dev_std = 0.448)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.73
NEC for r=0.6 class 0 = 0.407 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.307 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.279 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.349 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.329 +- 0.253 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.646
NEC for r=0.9 class 0 = 0.459 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 1 = 0.407 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 2 = 0.442 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all KL = 0.51 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all L1 = 0.436 +- 0.224 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.755 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.75 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.456 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.693 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.653 +- 0.222 (in-sample avg dev_std = 0.403)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.746 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.739 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.496 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.716 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.66 +- 0.189 (in-sample avg dev_std = 0.468)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
NEC for r=0.9 class 0 = 0.647 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 1 = 0.681 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 2 = 0.587 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all KL = 0.712 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all L1 = 0.638 +- 0.113 (in-sample avg dev_std = 0.656)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:01:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:01:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 82 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.474
SUFF_SIMPLE for r=0.3 class 0 = 0.453 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 1 = 0.441 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 2 = 0.377 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all KL = 0.339 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all L1 = 0.423 +- 0.208 (in-sample avg dev_std = 0.648)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.354
SUFF_SIMPLE for r=0.6 class 0 = 0.445 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 class 1 = 0.321 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 class 2 = 0.263 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 all KL = 0.263 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 all L1 = 0.341 +- 0.176 (in-sample avg dev_std = 0.550)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.305
SUFF_SIMPLE for r=0.9 class 0 = 0.646 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 class 1 = 0.255 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 class 2 = 0.216 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 all KL = 0.341 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 all L1 = 0.355 +- 0.246 (in-sample avg dev_std = 0.184)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.19
SUFF_SIMPLE for r=0.3 class 0 = 0.328 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 class 1 = 0.442 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 class 2 = 0.359 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 all KL = 0.383 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 all L1 = 0.376 +- 0.141 (in-sample avg dev_std = 0.455)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.162
SUFF_SIMPLE for r=0.6 class 0 = 0.346 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 class 1 = 0.398 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 class 2 = 0.306 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all KL = 0.368 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all L1 = 0.35 +- 0.125 (in-sample avg dev_std = 0.373)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.05
SUFF_SIMPLE for r=0.9 class 0 = 0.347 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.382 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.124 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.77
NEC for r=0.3 class 0 = 0.379 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.278 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.181 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.266 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.277 +- 0.233 (in-sample avg dev_std = 0.411)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.721
NEC for r=0.6 class 0 = 0.416 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 1 = 0.3 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 2 = 0.297 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all KL = 0.353 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all L1 = 0.336 +- 0.255 (in-sample avg dev_std = 0.504)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.626
NEC for r=0.9 class 0 = 0.471 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 1 = 0.422 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 2 = 0.463 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all KL = 0.523 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all L1 = 0.452 +- 0.223 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.71 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 1 = 0.403 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 2 = 0.085 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all KL = 0.354 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all L1 = 0.4 +- 0.295 (in-sample avg dev_std = 0.287)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.715 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 1 = 0.408 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 2 = 0.142 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all KL = 0.399 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all L1 = 0.422 +- 0.285 (in-sample avg dev_std = 0.356)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.319
NEC for r=0.9 class 0 = 0.697 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 1 = 0.47 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 2 = 0.369 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all KL = 0.521 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all L1 = 0.512 +- 0.210 (in-sample avg dev_std = 0.501)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.348, 0.277, 0.351], 'all_L1': [0.441, 0.363, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.352, 0.285, 0.307], 'all_L1': [0.429, 0.358, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.284, 0.347], 'all_L1': [0.445, 0.366, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.286, 0.327], 'all_L1': [0.439, 0.36, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.301, 0.352], 'all_L1': [0.448, 0.37, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.338, 0.272, 0.352], 'all_L1': [0.427, 0.352, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.35, 0.277, 0.332], 'all_L1': [0.441, 0.359, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.346, 0.28, 0.349], 'all_L1': [0.435, 0.361, 0.37]}), defaultdict(<class 'list'>, {'all_KL': [0.345, 0.275, 0.339], 'all_L1': [0.44, 0.364, 0.368]}), defaultdict(<class 'list'>, {'all_KL': [0.339, 0.263, 0.341], 'all_L1': [0.423, 0.341, 0.355]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.259, 0.336, 0.509], 'all_L1': [0.271, 0.322, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.196, 0.31, 0.482], 'all_L1': [0.234, 0.316, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.267, 0.336, 0.501], 'all_L1': [0.274, 0.322, 0.432]}), defaultdict(<class 'list'>, {'all_KL': [0.178, 0.299, 0.474], 'all_L1': [0.218, 0.3, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.326, 0.484], 'all_L1': [0.275, 0.322, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.244, 0.344, 0.515], 'all_L1': [0.265, 0.331, 0.447]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.34, 0.507], 'all_L1': [0.282, 0.327, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.342, 0.51], 'all_L1': [0.27, 0.321, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.288, 0.349, 0.51], 'all_L1': [0.289, 0.329, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.353, 0.523], 'all_L1': [0.277, 0.336, 0.452]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.477, 0.544, 0.72], 'all_L1': [0.506, 0.546, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.669, 0.873], 'all_L1': [0.656, 0.657, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.564, 0.667], 'all_L1': [0.557, 0.556, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.534, 0.667], 'all_L1': [0.526, 0.519, 0.587]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.456, 0.481], 'all_L1': [0.404, 0.411, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.398, 0.428], 'all_L1': [0.381, 0.364, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.519, 0.625], 'all_L1': [0.517, 0.51, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.473, 0.542], 'all_L1': [0.423, 0.451, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.619, 0.729], 'all_L1': [0.525, 0.585, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.368, 0.345], 'all_L1': [0.376, 0.35, 0.314]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.597, 0.624, 0.65], 'all_L1': [0.572, 0.584, 0.588]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.137, 0.237], 'all_L1': [0.113, 0.165, 0.243]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.31, 0.394], 'all_L1': [0.305, 0.329, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.202, 0.322], 'all_L1': [0.209, 0.273, 0.361]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.459, 0.54], 'all_L1': [0.482, 0.501, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.436, 0.538], 'all_L1': [0.437, 0.463, 0.541]}), defaultdict(<class 'list'>, {'all_KL': [0.305, 0.34, 0.413], 'all_L1': [0.343, 0.364, 0.416]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.595, 0.648], 'all_L1': [0.562, 0.581, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.716, 0.712], 'all_L1': [0.653, 0.66, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.354, 0.399, 0.521], 'all_L1': [0.4, 0.422, 0.512]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.437 +- 0.008, 0.359 +- 0.008, 0.362 +- 0.011
suff_simple class all_KL  =  0.351 +- 0.010, 0.280 +- 0.010, 0.340 +- 0.014
[[0.5110416412353516, 0.39408332109451294, 0.2995562255382538], [0.48512500524520874, 0.374875009059906, 0.26264119148254395], [0.5073750019073486, 0.3934166729450226, 0.2992200255393982], [0.5039166808128357, 0.38716667890548706, 0.278308242559433], [0.500333309173584, 0.38108333945274353, 0.2963958978652954], [0.48904165625572205, 0.375041663646698, 0.29679936170578003], [0.515958309173584, 0.39766666293144226, 0.2932355999946594], [0.4870833456516266, 0.37966665625572205, 0.29948896169662476], [0.503083348274231, 0.3934166729450226, 0.2942442297935486], [0.4735833406448364, 0.3540416657924652, 0.30500268936157227]]
[[0.348, 0.277, 0.351], [0.352, 0.285, 0.307], [0.356, 0.284, 0.347], [0.36, 0.286, 0.327], [0.375, 0.301, 0.352], [0.338, 0.272, 0.352], [0.35, 0.277, 0.332], [0.346, 0.28, 0.349], [0.345, 0.275, 0.339], [0.339, 0.263, 0.341]]
suff_simple_acc_int  =  0.498 +- 0.013, 0.383 +- 0.012, 0.292 +- 0.012
nec class all_L1  =  0.266 +- 0.021, 0.323 +- 0.009, 0.436 +- 0.009
nec class all_KL  =  0.250 +- 0.034, 0.334 +- 0.016, 0.501 +- 0.015
[[0.7826666831970215, 0.7397916913032532, 0.6490833163261414], [0.8379583358764648, 0.7627916932106018, 0.6635000109672546], [0.7745833396911621, 0.731083333492279, 0.6505833268165588], [0.8599583506584167, 0.7833750247955322, 0.6793749928474426], [0.7760000228881836, 0.7391666769981384, 0.6423749923706055], [0.7989166378974915, 0.737541675567627, 0.6434166431427002], [0.7698333263397217, 0.7258333563804626, 0.6471666693687439], [0.777958333492279, 0.734125018119812, 0.6357083320617676], [0.765250027179718, 0.7297083139419556, 0.6458333134651184], [0.7700833082199097, 0.7211666703224182, 0.6258749961853027]]
[[0.259, 0.336, 0.509], [0.196, 0.31, 0.482], [0.267, 0.336, 0.501], [0.178, 0.299, 0.474], [0.255, 0.326, 0.484], [0.244, 0.344, 0.515], [0.276, 0.34, 0.507], [0.27, 0.342, 0.51], [0.288, 0.349, 0.51], [0.266, 0.353, 0.523]]
nec_acc_int  =  0.791 +- 0.031, 0.740 +- 0.018, 0.648 +- 0.014

Eval split val
suff_simple class all_L1  =  0.487 +- 0.085, 0.495 +- 0.094, 0.553 +- 0.163
suff_simple class all_KL  =  0.490 +- 0.081, 0.514 +- 0.089, 0.608 +- 0.151
[[0.3384166657924652, 0.2826249897480011, 0.1711939424276352], [0.29766666889190674, 0.2904999852180481, 0.44219836592674255], [0.27529168128967285, 0.2513749897480011, 0.2299431413412094], [0.304625004529953, 0.2836250066757202, 0.16929879784584045], [0.2550833225250244, 0.1967083364725113, 0.042324699461460114], [0.1928333342075348, 0.1665416657924652, 0.03727100417017937], [0.2542916536331177, 0.23250000178813934, 0.2804800868034363], [0.31066668033599854, 0.27787500619888306, 0.16929879784584045], [0.3356666564941406, 0.29774999618530273, 0.1711939424276352], [0.18987500667572021, 0.16224999725818634, 0.04990524426102638]]
[[0.477, 0.544, 0.72], [0.665, 0.669, 0.873], [0.548, 0.564, 0.667], [0.539, 0.534, 0.667], [0.422, 0.456, 0.481], [0.404, 0.398, 0.428], [0.516, 0.519, 0.625], [0.422, 0.473, 0.542], [0.522, 0.619, 0.729], [0.383, 0.368, 0.345]]
suff_simple_acc_int  =  0.275 +- 0.050, 0.244 +- 0.049, 0.176 +- 0.117
nec class all_L1  =  0.408 +- 0.161, 0.434 +- 0.147, 0.485 +- 0.122
nec class all_KL  =  0.377 +- 0.191, 0.422 +- 0.176, 0.497 +- 0.146
[[0.4949583411216736, 0.48887500166893005, 0.429791659116745], [0.5809166431427002, 0.528291642665863, 0.44975000619888306], [0.40820834040641785, 0.3961666524410248, 0.35329166054725647], [0.7173749804496765, 0.6555416584014893, 0.5415833592414856], [0.3761250078678131, 0.38350000977516174, 0.32850000262260437], [0.4335416555404663, 0.4047916531562805, 0.3317916691303253], [0.36545833945274353, 0.3543750047683716, 0.3139166533946991], [0.39508333802223206, 0.3866666555404663, 0.3577916622161865], [0.37679165601730347, 0.3813750147819519, 0.367041677236557], [0.40429165959358215, 0.38337498903274536, 0.3189166784286499]]
[[0.597, 0.624, 0.65], [0.072, 0.137, 0.237], [0.27, 0.31, 0.394], [0.109, 0.202, 0.322], [0.42, 0.459, 0.54], [0.387, 0.436, 0.538], [0.305, 0.34, 0.413], [0.558, 0.595, 0.648], [0.693, 0.716, 0.712], [0.354, 0.399, 0.521]]
nec_acc_int  =  0.455 +- 0.107, 0.436 +- 0.089, 0.379 +- 0.069


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.351 +- 0.012, 0.341 +- 0.005, 0.399 +- 0.008
Faith. Armon (L1)= 		  =  0.330 +- 0.017, 0.340 +- 0.005, 0.395 +- 0.009
Faith. GMean (L1)= 	  =  0.340 +- 0.015, 0.340 +- 0.005, 0.397 +- 0.008
Faith. Aritm (KL)= 		  =  0.300 +- 0.016, 0.307 +- 0.006, 0.421 +- 0.013
Faith. Armon (KL)= 		  =  0.290 +- 0.024, 0.304 +- 0.006, 0.405 +- 0.013
Faith. GMean (KL)= 	  =  0.295 +- 0.020, 0.305 +- 0.006, 0.413 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.447 +- 0.068, 0.465 +- 0.074, 0.519 +- 0.070
Faith. Armon (L1)= 		  =  0.413 +- 0.106, 0.439 +- 0.098, 0.486 +- 0.085
Faith. GMean (L1)= 	  =  0.429 +- 0.087, 0.451 +- 0.085, 0.502 +- 0.075
Faith. Aritm (KL)= 		  =  0.433 +- 0.082, 0.468 +- 0.092, 0.553 +- 0.086
Faith. Armon (KL)= 		  =  0.385 +- 0.135, 0.436 +- 0.123, 0.519 +- 0.107
Faith. GMean (KL)= 	  =  0.405 +- 0.112, 0.451 +- 0.107, 0.535 +- 0.094
Computed for split load_split = id



Completed in  0:20:32.131181  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN PLAIN GOODMotif/basis/covariate NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:03:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:03:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.474 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 class 1 = 0.473 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 class 2 = 0.38 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 all KL = 0.348 +- 0.280 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.3 all L1 = 0.441 +- 0.199 (in-sample avg dev_std = 0.674)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.394
SUFF_SIMPLE for r=0.6 class 0 = 0.49 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 class 1 = 0.338 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 class 2 = 0.27 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 all KL = 0.277 +- 0.256 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.186 (in-sample avg dev_std = 0.587)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.3
SUFF_SIMPLE for r=0.9 class 0 = 0.72 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 class 1 = 0.249 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 class 2 = 0.213 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 all KL = 0.351 +- 0.368 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.9 all L1 = 0.374 +- 0.282 (in-sample avg dev_std = 0.173)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.603 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 class 1 = 0.534 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 class 2 = 0.382 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 all KL = 0.477 +- 0.303 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.3 all L1 = 0.506 +- 0.250 (in-sample avg dev_std = 0.453)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.283
SUFF_SIMPLE for r=0.6 class 0 = 0.656 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 class 1 = 0.613 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 class 2 = 0.369 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 all KL = 0.544 +- 0.354 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 all L1 = 0.546 +- 0.296 (in-sample avg dev_std = 0.274)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.401
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.884 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.806 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.416 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.72 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.287 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.783
NEC for r=0.3 class 0 = 0.375 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.264 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.181 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.259 +- 0.290 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.271 +- 0.217 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.74
NEC for r=0.6 class 0 = 0.407 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 1 = 0.267 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 class 2 = 0.297 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all KL = 0.336 +- 0.324 (in-sample avg dev_std = 0.481)
NEC for r=0.6 all L1 = 0.322 +- 0.239 (in-sample avg dev_std = 0.481)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.649
NEC for r=0.9 class 0 = 0.461 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.395 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.453 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.509 +- 0.308 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.436 +- 0.211 (in-sample avg dev_std = 0.650)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.495
NEC for r=0.3 class 0 = 0.628 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 1 = 0.65 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 2 = 0.439 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all KL = 0.597 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all L1 = 0.572 +- 0.223 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.489
NEC for r=0.6 class 0 = 0.625 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 1 = 0.645 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 2 = 0.481 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all KL = 0.624 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all L1 = 0.584 +- 0.199 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.559 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.624 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.581 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.65 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.588 +- 0.150 (in-sample avg dev_std = 0.571)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:04:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:04:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.485
SUFF_SIMPLE for r=0.3 class 0 = 0.471 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 class 1 = 0.436 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 class 2 = 0.383 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 all KL = 0.352 +- 0.273 (in-sample avg dev_std = 0.626)
SUFF_SIMPLE for r=0.3 all L1 = 0.429 +- 0.195 (in-sample avg dev_std = 0.626)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.375
SUFF_SIMPLE for r=0.6 class 0 = 0.489 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 1 = 0.318 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 2 = 0.275 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all KL = 0.285 +- 0.259 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all L1 = 0.358 +- 0.186 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.263
SUFF_SIMPLE for r=0.9 class 0 = 0.638 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 1 = 0.221 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 2 = 0.212 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all KL = 0.307 +- 0.339 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.252 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.298
SUFF_SIMPLE for r=0.3 class 0 = 0.696 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 class 1 = 0.584 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 class 2 = 0.688 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 all KL = 0.665 +- 0.350 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.3 all L1 = 0.656 +- 0.308 (in-sample avg dev_std = 0.272)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.29
SUFF_SIMPLE for r=0.6 class 0 = 0.733 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 class 1 = 0.563 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 class 2 = 0.674 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 all KL = 0.669 +- 0.362 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.6 all L1 = 0.657 +- 0.316 (in-sample avg dev_std = 0.188)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.493
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF_SIMPLE for r=0.9 class 0 = 0.975 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.873 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.838
NEC for r=0.3 class 0 = 0.277 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 class 1 = 0.229 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 class 2 = 0.199 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 all KL = 0.196 +- 0.225 (in-sample avg dev_std = 0.346)
NEC for r=0.3 all L1 = 0.234 +- 0.178 (in-sample avg dev_std = 0.346)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.763
NEC for r=0.6 class 0 = 0.37 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 1 = 0.273 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 class 2 = 0.308 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all KL = 0.31 +- 0.296 (in-sample avg dev_std = 0.474)
NEC for r=0.6 all L1 = 0.316 +- 0.220 (in-sample avg dev_std = 0.474)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.664
NEC for r=0.9 class 0 = 0.423 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 class 1 = 0.406 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 class 2 = 0.456 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 all KL = 0.482 +- 0.293 (in-sample avg dev_std = 0.624)
NEC for r=0.9 all L1 = 0.429 +- 0.201 (in-sample avg dev_std = 0.624)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.581
NEC for r=0.3 class 0 = 0.182 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 1 = 0.113 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 2 = 0.043 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all KL = 0.072 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all L1 = 0.113 +- 0.147 (in-sample avg dev_std = 0.145)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.528
NEC for r=0.6 class 0 = 0.235 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.153 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.108 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.137 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.165 +- 0.194 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.532
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.45
NEC for r=0.9 class 0 = 0.249 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 1 = 0.279 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 2 = 0.201 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all KL = 0.237 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all L1 = 0.243 +- 0.237 (in-sample avg dev_std = 0.400)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:06:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:06:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mChartInfo 0.9250 0.9250 0.9250 0.9250 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.507
SUFF_SIMPLE for r=0.3 class 0 = 0.483 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 class 1 = 0.471 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 class 2 = 0.384 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 all KL = 0.356 +- 0.276 (in-sample avg dev_std = 0.677)
SUFF_SIMPLE for r=0.3 all L1 = 0.445 +- 0.197 (in-sample avg dev_std = 0.677)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF_SIMPLE for r=0.6 class 0 = 0.495 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 1 = 0.343 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 class 2 = 0.268 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all KL = 0.284 +- 0.256 (in-sample avg dev_std = 0.583)
SUFF_SIMPLE for r=0.6 all L1 = 0.366 +- 0.186 (in-sample avg dev_std = 0.583)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.299
SUFF_SIMPLE for r=0.9 class 0 = 0.712 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 class 1 = 0.25 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 class 2 = 0.207 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 all KL = 0.347 +- 0.367 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.279 (in-sample avg dev_std = 0.172)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.275
SUFF_SIMPLE for r=0.3 class 0 = 0.552 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 class 1 = 0.604 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 class 2 = 0.516 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 all KL = 0.548 +- 0.345 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.3 all L1 = 0.557 +- 0.278 (in-sample avg dev_std = 0.380)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.251
SUFF_SIMPLE for r=0.6 class 0 = 0.587 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 class 1 = 0.598 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 class 2 = 0.484 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 all KL = 0.564 +- 0.352 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.6 all L1 = 0.556 +- 0.282 (in-sample avg dev_std = 0.281)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.23
SUFF_SIMPLE for r=0.9 class 0 = 0.88 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.675 +- 0.293 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.775
NEC for r=0.3 class 0 = 0.375 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1 = 0.267 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 2 = 0.188 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.267 +- 0.292 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.274 +- 0.215 (in-sample avg dev_std = 0.414)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.731
NEC for r=0.6 class 0 = 0.408 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.275 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.288 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.336 +- 0.324 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.322 +- 0.240 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.651
NEC for r=0.9 class 0 = 0.459 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 class 1 = 0.389 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 class 2 = 0.45 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 all KL = 0.501 +- 0.307 (in-sample avg dev_std = 0.649)
NEC for r=0.9 all L1 = 0.432 +- 0.212 (in-sample avg dev_std = 0.649)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
NEC for r=0.3 class 0 = 0.517 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 1 = 0.311 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 2 = 0.085 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all KL = 0.27 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all L1 = 0.305 +- 0.291 (in-sample avg dev_std = 0.245)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.523 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1 = 0.323 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 2 = 0.141 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.31 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.329 +- 0.293 (in-sample avg dev_std = 0.304)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.492 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.354 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.305 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.394 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.384 +- 0.268 (in-sample avg dev_std = 0.445)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:09:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:09:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.9247 0.9247 0.9247 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.504
SUFF_SIMPLE for r=0.3 class 0 = 0.466 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 class 1 = 0.467 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 class 2 = 0.386 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 all KL = 0.36 +- 0.283 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.3 all L1 = 0.439 +- 0.196 (in-sample avg dev_std = 0.632)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
SUFF_SIMPLE for r=0.6 class 0 = 0.47 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 1 = 0.342 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 2 = 0.275 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all KL = 0.286 +- 0.258 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all L1 = 0.36 +- 0.180 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.278
SUFF_SIMPLE for r=0.9 class 0 = 0.626 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 class 1 = 0.241 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 class 2 = 0.219 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 all KL = 0.327 +- 0.344 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.9 all L1 = 0.346 +- 0.237 (in-sample avg dev_std = 0.164)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.305
SUFF_SIMPLE for r=0.3 class 0 = 0.646 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 class 1 = 0.603 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 class 2 = 0.329 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 all KL = 0.539 +- 0.343 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.3 all L1 = 0.526 +- 0.292 (in-sample avg dev_std = 0.306)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.284
SUFF_SIMPLE for r=0.6 class 0 = 0.661 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 1 = 0.583 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 2 = 0.312 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all KL = 0.534 +- 0.340 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all L1 = 0.519 +- 0.296 (in-sample avg dev_std = 0.216)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.804 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.764 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.348 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.587 +- 0.277 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.86
NEC for r=0.3 class 0 = 0.276 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 class 1 = 0.215 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 class 2 = 0.167 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 all KL = 0.178 +- 0.212 (in-sample avg dev_std = 0.334)
NEC for r=0.3 all L1 = 0.218 +- 0.168 (in-sample avg dev_std = 0.334)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.783
NEC for r=0.6 class 0 = 0.373 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.246 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.287 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.299 +- 0.287 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.3 +- 0.208 (in-sample avg dev_std = 0.483)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.679
NEC for r=0.9 class 0 = 0.435 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 class 1 = 0.377 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 class 2 = 0.443 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 all KL = 0.474 +- 0.299 (in-sample avg dev_std = 0.630)
NEC for r=0.9 all L1 = 0.418 +- 0.200 (in-sample avg dev_std = 0.630)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.717
NEC for r=0.3 class 0 = 0.108 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.241 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.277 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.109 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.209 +- 0.138 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0 = 0.194 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.268 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.357 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.202 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.273 +- 0.169 (in-sample avg dev_std = 0.399)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.25 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 1 = 0.336 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 2 = 0.497 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all KL = 0.322 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all L1 = 0.361 +- 0.218 (in-sample avg dev_std = 0.487)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:11:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:11:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9270 0.9270[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.5
SUFF_SIMPLE for r=0.3 class 0 = 0.478 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 class 1 = 0.472 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 class 2 = 0.397 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 all KL = 0.375 +- 0.284 (in-sample avg dev_std = 0.641)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.203 (in-sample avg dev_std = 0.641)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.381
SUFF_SIMPLE for r=0.6 class 0 = 0.484 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 1 = 0.343 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 2 = 0.288 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all KL = 0.301 +- 0.259 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all L1 = 0.37 +- 0.182 (in-sample avg dev_std = 0.567)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.296
SUFF_SIMPLE for r=0.9 class 0 = 0.681 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 class 1 = 0.249 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 class 2 = 0.223 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 all KL = 0.352 +- 0.354 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.9 all L1 = 0.366 +- 0.259 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.255
SUFF_SIMPLE for r=0.3 class 0 = 0.395 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 class 1 = 0.478 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 class 2 = 0.34 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 all KL = 0.422 +- 0.231 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.3 all L1 = 0.404 +- 0.124 (in-sample avg dev_std = 0.484)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.197
SUFF_SIMPLE for r=0.6 class 0 = 0.441 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 class 1 = 0.504 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 class 2 = 0.291 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 all KL = 0.456 +- 0.285 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.6 all L1 = 0.411 +- 0.159 (in-sample avg dev_std = 0.367)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.042
SUFF_SIMPLE for r=0.9 class 0 = 0.473 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.238 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.481 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.383 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.776
NEC for r=0.3 class 0 = 0.373 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1 = 0.303 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 2 = 0.158 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.255 +- 0.297 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.275 +- 0.231 (in-sample avg dev_std = 0.414)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.739
NEC for r=0.6 class 0 = 0.409 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.298 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.264 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.326 +- 0.324 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.322 +- 0.242 (in-sample avg dev_std = 0.483)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.642
NEC for r=0.9 class 0 = 0.454 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 class 1 = 0.403 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 class 2 = 0.436 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 all KL = 0.484 +- 0.308 (in-sample avg dev_std = 0.631)
NEC for r=0.9 all L1 = 0.431 +- 0.216 (in-sample avg dev_std = 0.631)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.726 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 1 = 0.577 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 2 = 0.143 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all KL = 0.42 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all L1 = 0.482 +- 0.281 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.73 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 1 = 0.572 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 2 = 0.201 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all KL = 0.459 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all L1 = 0.501 +- 0.265 (in-sample avg dev_std = 0.342)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.329
NEC for r=0.9 class 0 = 0.692 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.565 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.41 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.54 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.556 +- 0.167 (in-sample avg dev_std = 0.508)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:14:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:14:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 69 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9247 0.9247[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.489
SUFF_SIMPLE for r=0.3 class 0 = 0.466 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 1 = 0.432 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 2 = 0.385 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all KL = 0.338 +- 0.280 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all L1 = 0.427 +- 0.202 (in-sample avg dev_std = 0.665)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.375
SUFF_SIMPLE for r=0.6 class 0 = 0.473 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 class 1 = 0.318 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 class 2 = 0.273 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 all KL = 0.272 +- 0.250 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.6 all L1 = 0.352 +- 0.181 (in-sample avg dev_std = 0.566)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.297
SUFF_SIMPLE for r=0.9 class 0 = 0.699 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 1 = 0.25 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 class 2 = 0.215 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all KL = 0.352 +- 0.361 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.272 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.193
SUFF_SIMPLE for r=0.3 class 0 = 0.364 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 class 1 = 0.45 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 class 2 = 0.331 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 all KL = 0.404 +- 0.278 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 all L1 = 0.381 +- 0.134 (in-sample avg dev_std = 0.456)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.167
SUFF_SIMPLE for r=0.6 class 0 = 0.4 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 1 = 0.415 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 2 = 0.277 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all KL = 0.398 +- 0.277 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.131 (in-sample avg dev_std = 0.351)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.037
SUFF_SIMPLE for r=0.9 class 0 = 0.414 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.44 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.225 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.428 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.128 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.799
NEC for r=0.3 class 0 = 0.375 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.246 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.183 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.244 +- 0.277 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.265 +- 0.210 (in-sample avg dev_std = 0.403)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.738
NEC for r=0.6 class 0 = 0.417 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 1 = 0.295 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 2 = 0.288 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all KL = 0.344 +- 0.330 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all L1 = 0.331 +- 0.241 (in-sample avg dev_std = 0.507)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.643
NEC for r=0.9 class 0 = 0.464 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 1 = 0.426 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 2 = 0.45 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all KL = 0.515 +- 0.309 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all L1 = 0.447 +- 0.213 (in-sample avg dev_std = 0.665)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
NEC for r=0.3 class 0 = 0.729 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1 = 0.45 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 2 = 0.132 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.387 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.437 +- 0.284 (in-sample avg dev_std = 0.309)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.732 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 1 = 0.462 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 2 = 0.192 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all KL = 0.436 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all L1 = 0.463 +- 0.268 (in-sample avg dev_std = 0.389)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.332
NEC for r=0.9 class 0 = 0.698 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 1 = 0.512 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 2 = 0.413 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all KL = 0.538 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all L1 = 0.541 +- 0.183 (in-sample avg dev_std = 0.536)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:16:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:16:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
SUFF_SIMPLE for r=0.3 class 0 = 0.458 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 1 = 0.478 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 class 2 = 0.391 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all KL = 0.35 +- 0.274 (in-sample avg dev_std = 0.665)
SUFF_SIMPLE for r=0.3 all L1 = 0.441 +- 0.200 (in-sample avg dev_std = 0.665)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.398
SUFF_SIMPLE for r=0.6 class 0 = 0.471 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 class 1 = 0.347 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 class 2 = 0.268 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 all KL = 0.277 +- 0.250 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.6 all L1 = 0.359 +- 0.181 (in-sample avg dev_std = 0.571)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.293
SUFF_SIMPLE for r=0.9 class 0 = 0.666 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 class 1 = 0.256 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 class 2 = 0.21 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 all KL = 0.332 +- 0.360 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.9 all L1 = 0.359 +- 0.261 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.254
SUFF_SIMPLE for r=0.3 class 0 = 0.455 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 class 1 = 0.581 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 class 2 = 0.515 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 all KL = 0.516 +- 0.321 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.3 all L1 = 0.517 +- 0.257 (in-sample avg dev_std = 0.372)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.233
SUFF_SIMPLE for r=0.6 class 0 = 0.487 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 class 1 = 0.561 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 class 2 = 0.483 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 all KL = 0.519 +- 0.320 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 all L1 = 0.51 +- 0.255 (in-sample avg dev_std = 0.298)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.28
SUFF_SIMPLE for r=0.9 class 0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.516 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.611 +- 0.244 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.77
NEC for r=0.3 class 0 = 0.389 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 class 1 = 0.273 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 class 2 = 0.193 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 all KL = 0.276 +- 0.318 (in-sample avg dev_std = 0.431)
NEC for r=0.3 all L1 = 0.282 +- 0.238 (in-sample avg dev_std = 0.431)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.726
NEC for r=0.6 class 0 = 0.425 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 class 1 = 0.269 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 class 2 = 0.293 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 all KL = 0.34 +- 0.337 (in-sample avg dev_std = 0.495)
NEC for r=0.6 all L1 = 0.327 +- 0.255 (in-sample avg dev_std = 0.495)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.647
NEC for r=0.9 class 0 = 0.482 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 1 = 0.386 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 2 = 0.447 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all KL = 0.507 +- 0.314 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all L1 = 0.438 +- 0.224 (in-sample avg dev_std = 0.644)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.58 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 1 = 0.345 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 2 = 0.104 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all KL = 0.305 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all L1 = 0.343 +- 0.298 (in-sample avg dev_std = 0.266)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.589 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.346 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.155 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.34 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.364 +- 0.298 (in-sample avg dev_std = 0.309)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.314
NEC for r=0.9 class 0 = 0.57 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 1 = 0.371 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 2 = 0.304 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all KL = 0.413 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all L1 = 0.416 +- 0.271 (in-sample avg dev_std = 0.416)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:18:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:18:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.487
SUFF_SIMPLE for r=0.3 class 0 = 0.48 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 class 1 = 0.455 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 class 2 = 0.373 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 all KL = 0.346 +- 0.284 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 all L1 = 0.435 +- 0.206 (in-sample avg dev_std = 0.662)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.38
SUFF_SIMPLE for r=0.6 class 0 = 0.487 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 class 1 = 0.332 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 class 2 = 0.271 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 all KL = 0.28 +- 0.257 (in-sample avg dev_std = 0.577)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.189 (in-sample avg dev_std = 0.577)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.299
SUFF_SIMPLE for r=0.9 class 0 = 0.708 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 class 1 = 0.243 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 class 2 = 0.218 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 all KL = 0.349 +- 0.363 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.9 all L1 = 0.37 +- 0.275 (in-sample avg dev_std = 0.182)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
SUFF_SIMPLE for r=0.3 class 0 = 0.474 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 class 1 = 0.506 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 class 2 = 0.29 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 all KL = 0.422 +- 0.266 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.3 all L1 = 0.423 +- 0.183 (in-sample avg dev_std = 0.462)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.278
SUFF_SIMPLE for r=0.6 class 0 = 0.536 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 class 1 = 0.568 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 class 2 = 0.249 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 all KL = 0.473 +- 0.318 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 all L1 = 0.451 +- 0.234 (in-sample avg dev_std = 0.276)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.222 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.464 +- 0.247 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.778
NEC for r=0.3 class 0 = 0.369 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.254 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.195 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.27 +- 0.307 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.27 +- 0.227 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.734
NEC for r=0.6 class 0 = 0.404 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 1 = 0.262 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 2 = 0.302 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all KL = 0.342 +- 0.333 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all L1 = 0.321 +- 0.247 (in-sample avg dev_std = 0.486)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.461 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 class 1 = 0.392 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 class 2 = 0.461 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 all KL = 0.51 +- 0.317 (in-sample avg dev_std = 0.648)
NEC for r=0.9 all L1 = 0.438 +- 0.225 (in-sample avg dev_std = 0.648)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.757 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 1 = 0.655 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 2 = 0.274 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all KL = 0.558 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all L1 = 0.562 +- 0.256 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.752 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.663 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.326 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.595 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.581 +- 0.232 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.693 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 1 = 0.639 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 2 = 0.513 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all KL = 0.648 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all L1 = 0.615 +- 0.127 (in-sample avg dev_std = 0.608)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:20:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:20:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.503
SUFF_SIMPLE for r=0.3 class 0 = 0.476 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 class 1 = 0.468 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 class 2 = 0.379 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 all KL = 0.345 +- 0.282 (in-sample avg dev_std = 0.680)
SUFF_SIMPLE for r=0.3 all L1 = 0.44 +- 0.203 (in-sample avg dev_std = 0.680)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.393
SUFF_SIMPLE for r=0.6 class 0 = 0.491 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 class 1 = 0.337 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 class 2 = 0.271 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 all KL = 0.275 +- 0.256 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.190 (in-sample avg dev_std = 0.590)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.294
SUFF_SIMPLE for r=0.9 class 0 = 0.714 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 class 1 = 0.246 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 class 2 = 0.205 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 all KL = 0.339 +- 0.368 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.9 all L1 = 0.368 +- 0.282 (in-sample avg dev_std = 0.174)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.643 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 class 1 = 0.561 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 class 2 = 0.373 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 all KL = 0.522 +- 0.284 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.3 all L1 = 0.525 +- 0.236 (in-sample avg dev_std = 0.437)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.298
SUFF_SIMPLE for r=0.6 class 0 = 0.71 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 class 1 = 0.671 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 class 2 = 0.373 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 all KL = 0.619 +- 0.334 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.6 all L1 = 0.585 +- 0.287 (in-sample avg dev_std = 0.226)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.406
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.831 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.412 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.729 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.286 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.765
NEC for r=0.3 class 0 = 0.384 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 1 = 0.313 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 2 = 0.179 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all KL = 0.288 +- 0.321 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all L1 = 0.289 +- 0.241 (in-sample avg dev_std = 0.448)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.73
NEC for r=0.6 class 0 = 0.407 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.307 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.279 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.349 +- 0.340 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.329 +- 0.253 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.646
NEC for r=0.9 class 0 = 0.459 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 1 = 0.407 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 2 = 0.442 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all KL = 0.51 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all L1 = 0.436 +- 0.224 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.755 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.75 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.456 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.693 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.653 +- 0.222 (in-sample avg dev_std = 0.403)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.746 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.739 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.496 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.716 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.66 +- 0.189 (in-sample avg dev_std = 0.468)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
NEC for r=0.9 class 0 = 0.647 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 1 = 0.681 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 2 = 0.587 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all KL = 0.712 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all L1 = 0.638 +- 0.113 (in-sample avg dev_std = 0.656)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:22:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:22:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 82 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.474
SUFF_SIMPLE for r=0.3 class 0 = 0.453 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 1 = 0.441 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 class 2 = 0.377 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all KL = 0.339 +- 0.288 (in-sample avg dev_std = 0.648)
SUFF_SIMPLE for r=0.3 all L1 = 0.423 +- 0.208 (in-sample avg dev_std = 0.648)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.354
SUFF_SIMPLE for r=0.6 class 0 = 0.445 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 class 1 = 0.321 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 class 2 = 0.263 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 all KL = 0.263 +- 0.245 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.6 all L1 = 0.341 +- 0.176 (in-sample avg dev_std = 0.550)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.305
SUFF_SIMPLE for r=0.9 class 0 = 0.646 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 class 1 = 0.255 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 class 2 = 0.216 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 all KL = 0.341 +- 0.342 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.9 all L1 = 0.355 +- 0.246 (in-sample avg dev_std = 0.184)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.19
SUFF_SIMPLE for r=0.3 class 0 = 0.328 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 class 1 = 0.442 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 class 2 = 0.359 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 all KL = 0.383 +- 0.263 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.3 all L1 = 0.376 +- 0.141 (in-sample avg dev_std = 0.455)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.162
SUFF_SIMPLE for r=0.6 class 0 = 0.346 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 class 1 = 0.398 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 class 2 = 0.306 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all KL = 0.368 +- 0.258 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all L1 = 0.35 +- 0.125 (in-sample avg dev_std = 0.373)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.05
SUFF_SIMPLE for r=0.9 class 0 = 0.347 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.382 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.124 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.77
NEC for r=0.3 class 0 = 0.379 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.278 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.181 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.266 +- 0.306 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.277 +- 0.233 (in-sample avg dev_std = 0.411)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.721
NEC for r=0.6 class 0 = 0.416 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 1 = 0.3 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 2 = 0.297 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all KL = 0.353 +- 0.346 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all L1 = 0.336 +- 0.255 (in-sample avg dev_std = 0.504)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.626
NEC for r=0.9 class 0 = 0.471 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 1 = 0.422 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 2 = 0.463 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all KL = 0.523 +- 0.318 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all L1 = 0.452 +- 0.223 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.71 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 1 = 0.403 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 2 = 0.085 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all KL = 0.354 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all L1 = 0.4 +- 0.295 (in-sample avg dev_std = 0.287)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.715 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 1 = 0.408 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 2 = 0.142 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all KL = 0.399 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all L1 = 0.422 +- 0.285 (in-sample avg dev_std = 0.356)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.319
NEC for r=0.9 class 0 = 0.697 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 1 = 0.47 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 2 = 0.369 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all KL = 0.521 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all L1 = 0.512 +- 0.210 (in-sample avg dev_std = 0.501)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.348, 0.277, 0.351], 'all_L1': [0.441, 0.363, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.352, 0.285, 0.307], 'all_L1': [0.429, 0.358, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.284, 0.347], 'all_L1': [0.445, 0.366, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.286, 0.327], 'all_L1': [0.439, 0.36, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.301, 0.352], 'all_L1': [0.448, 0.37, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.338, 0.272, 0.352], 'all_L1': [0.427, 0.352, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.35, 0.277, 0.332], 'all_L1': [0.441, 0.359, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.346, 0.28, 0.349], 'all_L1': [0.435, 0.361, 0.37]}), defaultdict(<class 'list'>, {'all_KL': [0.345, 0.275, 0.339], 'all_L1': [0.44, 0.364, 0.368]}), defaultdict(<class 'list'>, {'all_KL': [0.339, 0.263, 0.341], 'all_L1': [0.423, 0.341, 0.355]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.259, 0.336, 0.509], 'all_L1': [0.271, 0.322, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.196, 0.31, 0.482], 'all_L1': [0.234, 0.316, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.267, 0.336, 0.501], 'all_L1': [0.274, 0.322, 0.432]}), defaultdict(<class 'list'>, {'all_KL': [0.178, 0.299, 0.474], 'all_L1': [0.218, 0.3, 0.418]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.326, 0.484], 'all_L1': [0.275, 0.322, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.244, 0.344, 0.515], 'all_L1': [0.265, 0.331, 0.447]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.34, 0.507], 'all_L1': [0.282, 0.327, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.342, 0.51], 'all_L1': [0.27, 0.321, 0.438]}), defaultdict(<class 'list'>, {'all_KL': [0.288, 0.349, 0.51], 'all_L1': [0.289, 0.329, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.353, 0.523], 'all_L1': [0.277, 0.336, 0.452]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.477, 0.544, 0.72], 'all_L1': [0.506, 0.546, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.669, 0.873], 'all_L1': [0.656, 0.657, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.548, 0.564, 0.667], 'all_L1': [0.557, 0.556, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.534, 0.667], 'all_L1': [0.526, 0.519, 0.587]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.456, 0.481], 'all_L1': [0.404, 0.411, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.398, 0.428], 'all_L1': [0.381, 0.364, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.519, 0.625], 'all_L1': [0.517, 0.51, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.473, 0.542], 'all_L1': [0.423, 0.451, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.619, 0.729], 'all_L1': [0.525, 0.585, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.383, 0.368, 0.345], 'all_L1': [0.376, 0.35, 0.314]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.597, 0.624, 0.65], 'all_L1': [0.572, 0.584, 0.588]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.137, 0.237], 'all_L1': [0.113, 0.165, 0.243]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.31, 0.394], 'all_L1': [0.305, 0.329, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.202, 0.322], 'all_L1': [0.209, 0.273, 0.361]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.459, 0.54], 'all_L1': [0.482, 0.501, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.436, 0.538], 'all_L1': [0.437, 0.463, 0.541]}), defaultdict(<class 'list'>, {'all_KL': [0.305, 0.34, 0.413], 'all_L1': [0.343, 0.364, 0.416]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.595, 0.648], 'all_L1': [0.562, 0.581, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.716, 0.712], 'all_L1': [0.653, 0.66, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.354, 0.399, 0.521], 'all_L1': [0.4, 0.422, 0.512]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.437 +- 0.008, 0.359 +- 0.008, 0.362 +- 0.011
suff_simple class all_KL  =  0.351 +- 0.010, 0.280 +- 0.010, 0.340 +- 0.014
[[0.5110416412353516, 0.39408332109451294, 0.2995562255382538], [0.48512500524520874, 0.374875009059906, 0.26264119148254395], [0.5073750019073486, 0.3934166729450226, 0.2992200255393982], [0.5039166808128357, 0.38716667890548706, 0.278308242559433], [0.500333309173584, 0.38108333945274353, 0.2963958978652954], [0.48904165625572205, 0.375041663646698, 0.29679936170578003], [0.515958309173584, 0.39766666293144226, 0.2932355999946594], [0.4870833456516266, 0.37966665625572205, 0.29948896169662476], [0.503083348274231, 0.3934166729450226, 0.2942442297935486], [0.4735833406448364, 0.3540416657924652, 0.30500268936157227]]
[[0.348, 0.277, 0.351], [0.352, 0.285, 0.307], [0.356, 0.284, 0.347], [0.36, 0.286, 0.327], [0.375, 0.301, 0.352], [0.338, 0.272, 0.352], [0.35, 0.277, 0.332], [0.346, 0.28, 0.349], [0.345, 0.275, 0.339], [0.339, 0.263, 0.341]]
suff_simple_acc_int  =  0.498 +- 0.013, 0.383 +- 0.012, 0.292 +- 0.012
nec class all_L1  =  0.266 +- 0.021, 0.323 +- 0.009, 0.436 +- 0.009
nec class all_KL  =  0.250 +- 0.034, 0.334 +- 0.016, 0.501 +- 0.015
[[0.7826666831970215, 0.7397916913032532, 0.6490833163261414], [0.8379583358764648, 0.7627916932106018, 0.6635000109672546], [0.7745833396911621, 0.731083333492279, 0.6505833268165588], [0.8599583506584167, 0.7833750247955322, 0.6793749928474426], [0.7760000228881836, 0.7391666769981384, 0.6423749923706055], [0.7989166378974915, 0.737541675567627, 0.6434166431427002], [0.7698333263397217, 0.7258333563804626, 0.6471666693687439], [0.777958333492279, 0.734125018119812, 0.6357083320617676], [0.765250027179718, 0.7297083139419556, 0.6458333134651184], [0.7700833082199097, 0.7211666703224182, 0.6258749961853027]]
[[0.259, 0.336, 0.509], [0.196, 0.31, 0.482], [0.267, 0.336, 0.501], [0.178, 0.299, 0.474], [0.255, 0.326, 0.484], [0.244, 0.344, 0.515], [0.276, 0.34, 0.507], [0.27, 0.342, 0.51], [0.288, 0.349, 0.51], [0.266, 0.353, 0.523]]
nec_acc_int  =  0.791 +- 0.031, 0.740 +- 0.018, 0.648 +- 0.014

Eval split val
suff_simple class all_L1  =  0.487 +- 0.085, 0.495 +- 0.094, 0.553 +- 0.163
suff_simple class all_KL  =  0.490 +- 0.081, 0.514 +- 0.089, 0.608 +- 0.151
[[0.3384166657924652, 0.2826249897480011, 0.1711939424276352], [0.29766666889190674, 0.2904999852180481, 0.44219836592674255], [0.27529168128967285, 0.2513749897480011, 0.2299431413412094], [0.304625004529953, 0.2836250066757202, 0.16929879784584045], [0.2550833225250244, 0.1967083364725113, 0.042324699461460114], [0.1928333342075348, 0.1665416657924652, 0.03727100417017937], [0.2542916536331177, 0.23250000178813934, 0.2804800868034363], [0.31066668033599854, 0.27787500619888306, 0.16929879784584045], [0.3356666564941406, 0.29774999618530273, 0.1711939424276352], [0.18987500667572021, 0.16224999725818634, 0.04990524426102638]]
[[0.477, 0.544, 0.72], [0.665, 0.669, 0.873], [0.548, 0.564, 0.667], [0.539, 0.534, 0.667], [0.422, 0.456, 0.481], [0.404, 0.398, 0.428], [0.516, 0.519, 0.625], [0.422, 0.473, 0.542], [0.522, 0.619, 0.729], [0.383, 0.368, 0.345]]
suff_simple_acc_int  =  0.275 +- 0.050, 0.244 +- 0.049, 0.176 +- 0.117
nec class all_L1  =  0.408 +- 0.161, 0.434 +- 0.147, 0.485 +- 0.122
nec class all_KL  =  0.377 +- 0.191, 0.422 +- 0.176, 0.497 +- 0.146
[[0.4949583411216736, 0.48887500166893005, 0.429791659116745], [0.5809166431427002, 0.528291642665863, 0.44975000619888306], [0.40820834040641785, 0.3961666524410248, 0.35329166054725647], [0.7173749804496765, 0.6555416584014893, 0.5415833592414856], [0.3761250078678131, 0.38350000977516174, 0.32850000262260437], [0.4335416555404663, 0.4047916531562805, 0.3317916691303253], [0.36545833945274353, 0.3543750047683716, 0.3139166533946991], [0.39508333802223206, 0.3866666555404663, 0.3577916622161865], [0.37679165601730347, 0.3813750147819519, 0.367041677236557], [0.40429165959358215, 0.38337498903274536, 0.3189166784286499]]
[[0.597, 0.624, 0.65], [0.072, 0.137, 0.237], [0.27, 0.31, 0.394], [0.109, 0.202, 0.322], [0.42, 0.459, 0.54], [0.387, 0.436, 0.538], [0.305, 0.34, 0.413], [0.558, 0.595, 0.648], [0.693, 0.716, 0.712], [0.354, 0.399, 0.521]]
nec_acc_int  =  0.455 +- 0.107, 0.436 +- 0.089, 0.379 +- 0.069


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.351 +- 0.012, 0.341 +- 0.005, 0.399 +- 0.008
Faith. Armon (L1)= 		  =  0.330 +- 0.017, 0.340 +- 0.005, 0.395 +- 0.009
Faith. GMean (L1)= 	  =  0.340 +- 0.015, 0.340 +- 0.005, 0.397 +- 0.008
Faith. Aritm (KL)= 		  =  0.300 +- 0.016, 0.307 +- 0.006, 0.421 +- 0.013
Faith. Armon (KL)= 		  =  0.290 +- 0.024, 0.304 +- 0.006, 0.405 +- 0.013
Faith. GMean (KL)= 	  =  0.295 +- 0.020, 0.305 +- 0.006, 0.413 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.447 +- 0.068, 0.465 +- 0.074, 0.519 +- 0.070
Faith. Armon (L1)= 		  =  0.413 +- 0.106, 0.439 +- 0.098, 0.486 +- 0.085
Faith. GMean (L1)= 	  =  0.429 +- 0.087, 0.451 +- 0.085, 0.502 +- 0.075
Faith. Aritm (KL)= 		  =  0.433 +- 0.082, 0.468 +- 0.092, 0.553 +- 0.086
Faith. Armon (KL)= 		  =  0.385 +- 0.135, 0.436 +- 0.123, 0.519 +- 0.107
Faith. GMean (KL)= 	  =  0.405 +- 0.112, 0.451 +- 0.107, 0.535 +- 0.094
Computed for split load_split = id



Completed in  0:20:34.290095  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN PLAIN GOODMotif/basis/covariate NEC_ALPHA 0.01 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:23:54 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:23:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.9297 0.9297 0.9297 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.507
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.428
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.787
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5065726666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.852
SUFF_SIMPLE for r=0.3 class 0 = 0.807 +- 0.251 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.3 class 1 = 0.979 +- 0.251 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.3 class 2 = 0.849 +- 0.251 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.3 all KL = 0.847 +- 0.251 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.3 all L1 = 0.879 +- 0.195 (in-sample avg dev_std = 0.424)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4277166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.905
SUFF_SIMPLE for r=0.6 class 0 = 0.917 +- 0.161 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 class 1 = 0.988 +- 0.161 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 class 2 = 0.969 +- 0.161 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 all KL = 0.949 +- 0.161 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 all L1 = 0.959 +- 0.126 (in-sample avg dev_std = 0.243)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3305153333333333
len(reference) = 2654
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.928
SUFF_SIMPLE for r=0.9 class 0 = 0.987 +- 0.050 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.9 class 1 = 0.995 +- 0.050 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.9 class 2 = 0.998 +- 0.050 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.9 all KL = 0.995 +- 0.050 (in-sample avg dev_std = 0.072)
SUFF_SIMPLE for r=0.9 all L1 = 0.993 +- 0.041 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7874073333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.682
SUFF_SIMPLE for r=0.3 class 0 = 0.71 +- 0.232 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 class 1 = 0.923 +- 0.232 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 class 2 = 0.907 +- 0.232 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 all KL = 0.858 +- 0.232 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 all L1 = 0.846 +- 0.217 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989473333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.707
SUFF_SIMPLE for r=0.6 class 0 = 0.757 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.929 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.989 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.927 +- 0.189 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.891 +- 0.208 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4847123333333333
len(reference) = 681
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.93
SUFF_SIMPLE for r=0.9 class 0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5065726666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.362
NEC for r=0.3 class 0 = 0.647 +- 0.211 (in-sample avg dev_std = 0.700)
NEC for r=0.3 class 1 = 0.543 +- 0.211 (in-sample avg dev_std = 0.700)
NEC for r=0.3 class 2 = 0.704 +- 0.211 (in-sample avg dev_std = 0.700)
NEC for r=0.3 all KL = 0.768 +- 0.211 (in-sample avg dev_std = 0.700)
NEC for r=0.3 all L1 = 0.632 +- 0.207 (in-sample avg dev_std = 0.700)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4277166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.57
NEC for r=0.6 class 0 = 0.499 +- 0.260 (in-sample avg dev_std = 0.771)
NEC for r=0.6 class 1 = 0.363 +- 0.260 (in-sample avg dev_std = 0.771)
NEC for r=0.6 class 2 = 0.534 +- 0.260 (in-sample avg dev_std = 0.771)
NEC for r=0.6 all KL = 0.597 +- 0.260 (in-sample avg dev_std = 0.771)
NEC for r=0.6 all L1 = 0.466 +- 0.228 (in-sample avg dev_std = 0.771)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3305153333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.666
NEC for r=0.9 class 0 = 0.414 +- 0.269 (in-sample avg dev_std = 0.749)
NEC for r=0.9 class 1 = 0.272 +- 0.269 (in-sample avg dev_std = 0.749)
NEC for r=0.9 class 2 = 0.429 +- 0.269 (in-sample avg dev_std = 0.749)
NEC for r=0.9 all KL = 0.491 +- 0.269 (in-sample avg dev_std = 0.749)
NEC for r=0.9 all L1 = 0.372 +- 0.221 (in-sample avg dev_std = 0.749)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7874073333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.615 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 class 1 = 0.591 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 class 2 = 0.542 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 all KL = 0.623 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 all L1 = 0.582 +- 0.205 (in-sample avg dev_std = 0.541)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989473333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.51
NEC for r=0.6 class 0 = 0.489 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 class 1 = 0.364 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 class 2 = 0.352 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 all KL = 0.436 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 all L1 = 0.402 +- 0.229 (in-sample avg dev_std = 0.605)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4847123333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.564
NEC for r=0.9 class 0 = 0.425 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 1 = 0.304 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 2 = 0.294 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all KL = 0.368 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all L1 = 0.341 +- 0.215 (in-sample avg dev_std = 0.584)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:25:52 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:25:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9273 0.9273 0.9273 0.9273 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.426
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.322
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.786
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.629
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.447


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.559169
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.821
SUFF_SIMPLE for r=0.3 class 0 = 0.711 +- 0.282 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 class 1 = 0.981 +- 0.282 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 class 2 = 0.815 +- 0.282 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 all KL = 0.801 +- 0.282 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 all L1 = 0.837 +- 0.227 (in-sample avg dev_std = 0.460)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4257253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.888
SUFF_SIMPLE for r=0.6 class 0 = 0.832 +- 0.192 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.6 class 1 = 0.987 +- 0.192 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.6 class 2 = 0.953 +- 0.192 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.6 all KL = 0.918 +- 0.192 (in-sample avg dev_std = 0.301)
SUFF_SIMPLE for r=0.6 all L1 = 0.926 +- 0.157 (in-sample avg dev_std = 0.301)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32249099999999997
len(reference) = 2343
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.921
SUFF_SIMPLE for r=0.9 class 0 = 0.948 +- 0.086 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.9 class 1 = 0.987 +- 0.086 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.9 class 2 = 0.992 +- 0.086 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.9 all KL = 0.985 +- 0.086 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.9 all L1 = 0.974 +- 0.079 (in-sample avg dev_std = 0.113)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7860260000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.618
SUFF_SIMPLE for r=0.3 class 0 = 0.732 +- 0.266 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.3 class 1 = 0.863 +- 0.266 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.3 class 2 = 0.905 +- 0.266 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.3 all KL = 0.845 +- 0.266 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.3 all L1 = 0.833 +- 0.261 (in-sample avg dev_std = 0.278)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6294076666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.671
SUFF_SIMPLE for r=0.6 class 0 = 0.725 +- 0.260 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.6 class 1 = 0.866 +- 0.260 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.6 class 2 = 0.986 +- 0.260 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.6 all KL = 0.881 +- 0.260 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.6 all L1 = 0.859 +- 0.259 (in-sample avg dev_std = 0.184)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4472193333333333
len(reference) = 2400
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.621
SUFF_SIMPLE for r=0.9 class 0 = 0.774 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.982 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.991 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.941 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.9 +- 0.197 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.559169
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.332
NEC for r=0.3 class 0 = 0.706 +- 0.216 (in-sample avg dev_std = 0.670)
NEC for r=0.3 class 1 = 0.509 +- 0.216 (in-sample avg dev_std = 0.670)
NEC for r=0.3 class 2 = 0.733 +- 0.216 (in-sample avg dev_std = 0.670)
NEC for r=0.3 all KL = 0.777 +- 0.216 (in-sample avg dev_std = 0.670)
NEC for r=0.3 all L1 = 0.649 +- 0.208 (in-sample avg dev_std = 0.670)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4257253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.523
NEC for r=0.6 class 0 = 0.576 +- 0.277 (in-sample avg dev_std = 0.732)
NEC for r=0.6 class 1 = 0.34 +- 0.277 (in-sample avg dev_std = 0.732)
NEC for r=0.6 class 2 = 0.575 +- 0.277 (in-sample avg dev_std = 0.732)
NEC for r=0.6 all KL = 0.618 +- 0.277 (in-sample avg dev_std = 0.732)
NEC for r=0.6 all L1 = 0.497 +- 0.246 (in-sample avg dev_std = 0.732)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32249099999999997
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.642
NEC for r=0.9 class 0 = 0.485 +- 0.282 (in-sample avg dev_std = 0.739)
NEC for r=0.9 class 1 = 0.249 +- 0.282 (in-sample avg dev_std = 0.739)
NEC for r=0.9 class 2 = 0.449 +- 0.282 (in-sample avg dev_std = 0.739)
NEC for r=0.9 all KL = 0.506 +- 0.282 (in-sample avg dev_std = 0.739)
NEC for r=0.9 all L1 = 0.394 +- 0.236 (in-sample avg dev_std = 0.739)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7860260000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.236
NEC for r=0.3 class 0 = 0.662 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 class 1 = 0.596 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 class 2 = 0.636 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 all KL = 0.742 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 all L1 = 0.632 +- 0.240 (in-sample avg dev_std = 0.633)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6294076666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.433
NEC for r=0.6 class 0 = 0.464 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 1 = 0.406 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 2 = 0.429 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all KL = 0.521 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all L1 = 0.433 +- 0.250 (in-sample avg dev_std = 0.699)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4472193333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.478
NEC for r=0.9 class 0 = 0.44 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 class 1 = 0.366 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 class 2 = 0.372 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 all KL = 0.474 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 all L1 = 0.393 +- 0.247 (in-sample avg dev_std = 0.681)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:28:20 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:28:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 108 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.527
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.445
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.334
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.526898
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.855
SUFF_SIMPLE for r=0.3 class 0 = 0.826 +- 0.256 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 class 1 = 0.982 +- 0.256 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 class 2 = 0.838 +- 0.256 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 all KL = 0.847 +- 0.256 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 all L1 = 0.882 +- 0.196 (in-sample avg dev_std = 0.426)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44542099999999996
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.904
SUFF_SIMPLE for r=0.6 class 0 = 0.908 +- 0.158 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.6 class 1 = 0.99 +- 0.158 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.6 class 2 = 0.964 +- 0.158 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.6 all KL = 0.946 +- 0.158 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.6 all L1 = 0.954 +- 0.129 (in-sample avg dev_std = 0.245)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3343913333333333
len(reference) = 2628
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.906
SUFF_SIMPLE for r=0.9 class 0 = 0.924 +- 0.160 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.9 class 1 = 0.993 +- 0.160 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.9 class 2 = 0.976 +- 0.160 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.9 all KL = 0.96 +- 0.160 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.9 all L1 = 0.964 +- 0.135 (in-sample avg dev_std = 0.186)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839849999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.751
SUFF_SIMPLE for r=0.3 class 0 = 0.855 +- 0.208 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 class 1 = 0.96 +- 0.208 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 class 2 = 0.913 +- 0.208 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 all KL = 0.882 +- 0.208 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.3 all L1 = 0.909 +- 0.153 (in-sample avg dev_std = 0.388)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6988479999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.767
SUFF_SIMPLE for r=0.6 class 0 = 0.951 +- 0.212 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.6 class 1 = 0.827 +- 0.212 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.6 class 2 = 0.992 +- 0.212 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.6 all KL = 0.924 +- 0.212 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.6 all L1 = 0.924 +- 0.198 (in-sample avg dev_std = 0.219)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48528600000000005
len(reference) = 1945
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF_SIMPLE for r=0.9 class 0 = 0.872 +- 0.322 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.9 class 1 = 0.512 +- 0.322 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.9 class 2 = 0.988 +- 0.322 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.9 all KL = 0.839 +- 0.322 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.9 all L1 = 0.839 +- 0.307 (in-sample avg dev_std = 0.021)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.526898
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.353
NEC for r=0.3 class 0 = 0.649 +- 0.212 (in-sample avg dev_std = 0.697)
NEC for r=0.3 class 1 = 0.555 +- 0.212 (in-sample avg dev_std = 0.697)
NEC for r=0.3 class 2 = 0.707 +- 0.212 (in-sample avg dev_std = 0.697)
NEC for r=0.3 all KL = 0.773 +- 0.212 (in-sample avg dev_std = 0.697)
NEC for r=0.3 all L1 = 0.637 +- 0.207 (in-sample avg dev_std = 0.697)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44542099999999996
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.568
NEC for r=0.6 class 0 = 0.485 +- 0.276 (in-sample avg dev_std = 0.762)
NEC for r=0.6 class 1 = 0.355 +- 0.276 (in-sample avg dev_std = 0.762)
NEC for r=0.6 class 2 = 0.546 +- 0.276 (in-sample avg dev_std = 0.762)
NEC for r=0.6 all KL = 0.593 +- 0.276 (in-sample avg dev_std = 0.762)
NEC for r=0.6 all L1 = 0.463 +- 0.240 (in-sample avg dev_std = 0.762)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3343913333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.678
NEC for r=0.9 class 0 = 0.391 +- 0.276 (in-sample avg dev_std = 0.749)
NEC for r=0.9 class 1 = 0.264 +- 0.276 (in-sample avg dev_std = 0.749)
NEC for r=0.9 class 2 = 0.43 +- 0.276 (in-sample avg dev_std = 0.749)
NEC for r=0.9 all KL = 0.481 +- 0.276 (in-sample avg dev_std = 0.749)
NEC for r=0.9 all L1 = 0.362 +- 0.224 (in-sample avg dev_std = 0.749)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839849999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.304
NEC for r=0.3 class 0 = 0.689 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 1 = 0.635 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 2 = 0.537 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all KL = 0.741 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all L1 = 0.621 +- 0.206 (in-sample avg dev_std = 0.688)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6988479999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.535
NEC for r=0.6 class 0 = 0.461 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 class 1 = 0.345 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 class 2 = 0.351 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 all KL = 0.492 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 all L1 = 0.386 +- 0.242 (in-sample avg dev_std = 0.732)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.797
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48528600000000005
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
NEC for r=0.9 class 0 = 0.388 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.296 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.293 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.428 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.326 +- 0.213 (in-sample avg dev_std = 0.720)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:30:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:30:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.787
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.689
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5505693333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.828
SUFF_SIMPLE for r=0.3 class 0 = 0.738 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.3 class 1 = 0.98 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.3 class 2 = 0.832 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.3 all KL = 0.806 +- 0.285 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.3 all L1 = 0.852 +- 0.220 (in-sample avg dev_std = 0.482)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.43598000000000003
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.868
SUFF_SIMPLE for r=0.6 class 0 = 0.797 +- 0.231 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 class 1 = 0.986 +- 0.231 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 class 2 = 0.929 +- 0.231 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 all KL = 0.878 +- 0.231 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 all L1 = 0.906 +- 0.177 (in-sample avg dev_std = 0.385)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3292326666666667
len(reference) = 2324
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.908
SUFF_SIMPLE for r=0.9 class 0 = 0.957 +- 0.147 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.147 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.9 class 2 = 0.964 +- 0.147 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.9 all KL = 0.967 +- 0.147 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.9 all L1 = 0.972 +- 0.123 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7866436666666665
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.634
SUFF_SIMPLE for r=0.3 class 0 = 0.773 +- 0.284 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.3 class 1 = 0.862 +- 0.284 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.3 class 2 = 0.961 +- 0.284 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.3 all KL = 0.84 +- 0.284 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.3 all L1 = 0.865 +- 0.243 (in-sample avg dev_std = 0.336)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6890256666666668
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.654
SUFF_SIMPLE for r=0.6 class 0 = 0.8 +- 0.253 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.6 class 1 = 0.922 +- 0.253 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.6 class 2 = 0.99 +- 0.253 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.6 all KL = 0.906 +- 0.253 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.6 all L1 = 0.904 +- 0.236 (in-sample avg dev_std = 0.027)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.47692266666666666
len(reference) = 295
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.932
SUFF_SIMPLE for r=0.9 class 0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5505693333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.386
NEC for r=0.3 class 0 = 0.598 +- 0.230 (in-sample avg dev_std = 0.702)
NEC for r=0.3 class 1 = 0.53 +- 0.230 (in-sample avg dev_std = 0.702)
NEC for r=0.3 class 2 = 0.691 +- 0.230 (in-sample avg dev_std = 0.702)
NEC for r=0.3 all KL = 0.741 +- 0.230 (in-sample avg dev_std = 0.702)
NEC for r=0.3 all L1 = 0.607 +- 0.219 (in-sample avg dev_std = 0.702)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.43598000000000003
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.57
NEC for r=0.6 class 0 = 0.482 +- 0.279 (in-sample avg dev_std = 0.754)
NEC for r=0.6 class 1 = 0.361 +- 0.279 (in-sample avg dev_std = 0.754)
NEC for r=0.6 class 2 = 0.524 +- 0.279 (in-sample avg dev_std = 0.754)
NEC for r=0.6 all KL = 0.584 +- 0.279 (in-sample avg dev_std = 0.754)
NEC for r=0.6 all L1 = 0.456 +- 0.243 (in-sample avg dev_std = 0.754)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3292326666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.665
NEC for r=0.9 class 0 = 0.423 +- 0.277 (in-sample avg dev_std = 0.743)
NEC for r=0.9 class 1 = 0.27 +- 0.277 (in-sample avg dev_std = 0.743)
NEC for r=0.9 class 2 = 0.409 +- 0.277 (in-sample avg dev_std = 0.743)
NEC for r=0.9 all KL = 0.485 +- 0.277 (in-sample avg dev_std = 0.743)
NEC for r=0.9 all L1 = 0.367 +- 0.229 (in-sample avg dev_std = 0.743)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7866436666666665
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.575 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 1 = 0.593 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 2 = 0.42 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all KL = 0.647 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all L1 = 0.529 +- 0.276 (in-sample avg dev_std = 0.688)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6890256666666668
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.474
NEC for r=0.6 class 0 = 0.422 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 class 1 = 0.428 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 class 2 = 0.26 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 all KL = 0.476 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 all L1 = 0.37 +- 0.265 (in-sample avg dev_std = 0.698)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.47692266666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.517
NEC for r=0.9 class 0 = 0.377 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 1 = 0.374 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 2 = 0.203 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all KL = 0.411 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all L1 = 0.318 +- 0.256 (in-sample avg dev_std = 0.652)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:33:22 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:33:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.678
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.469


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.535273
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.814
SUFF_SIMPLE for r=0.3 class 0 = 0.685 +- 0.287 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 class 1 = 0.981 +- 0.287 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 class 2 = 0.863 +- 0.287 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 all KL = 0.806 +- 0.287 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.3 all L1 = 0.846 +- 0.231 (in-sample avg dev_std = 0.456)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4337976666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.864
SUFF_SIMPLE for r=0.6 class 0 = 0.788 +- 0.226 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.6 class 1 = 0.989 +- 0.226 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.6 class 2 = 0.954 +- 0.226 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.6 all KL = 0.892 +- 0.226 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.6 all L1 = 0.913 +- 0.184 (in-sample avg dev_std = 0.331)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266133333333333
len(reference) = 2254
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.889
SUFF_SIMPLE for r=0.9 class 0 = 0.891 +- 0.194 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 class 1 = 0.987 +- 0.194 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 class 2 = 0.992 +- 0.194 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 all KL = 0.949 +- 0.194 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 all L1 = 0.955 +- 0.168 (in-sample avg dev_std = 0.152)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839269999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.568
SUFF_SIMPLE for r=0.3 class 0 = 0.78 +- 0.274 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.3 class 1 = 0.911 +- 0.274 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.3 class 2 = 0.98 +- 0.274 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.3 all KL = 0.881 +- 0.274 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.3 all L1 = 0.89 +- 0.244 (in-sample avg dev_std = 0.245)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6781923333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.525
SUFF_SIMPLE for r=0.6 class 0 = 0.781 +- 0.314 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.6 class 1 = 0.83 +- 0.314 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.6 class 2 = 0.989 +- 0.314 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.6 all KL = 0.853 +- 0.314 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.6 all L1 = 0.867 +- 0.277 (in-sample avg dev_std = 0.244)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.823
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46883966666666665
len(reference) = 1830
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.692
SUFF_SIMPLE for r=0.9 class 0 = 0.95 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.995 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.884 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.888 +- 0.274 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.535273
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.652 +- 0.213 (in-sample avg dev_std = 0.696)
NEC for r=0.3 class 1 = 0.537 +- 0.213 (in-sample avg dev_std = 0.696)
NEC for r=0.3 class 2 = 0.692 +- 0.213 (in-sample avg dev_std = 0.696)
NEC for r=0.3 all KL = 0.752 +- 0.213 (in-sample avg dev_std = 0.696)
NEC for r=0.3 all L1 = 0.627 +- 0.204 (in-sample avg dev_std = 0.696)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4337976666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.547
NEC for r=0.6 class 0 = 0.555 +- 0.272 (in-sample avg dev_std = 0.728)
NEC for r=0.6 class 1 = 0.34 +- 0.272 (in-sample avg dev_std = 0.728)
NEC for r=0.6 class 2 = 0.524 +- 0.272 (in-sample avg dev_std = 0.728)
NEC for r=0.6 all KL = 0.588 +- 0.272 (in-sample avg dev_std = 0.728)
NEC for r=0.6 all L1 = 0.472 +- 0.242 (in-sample avg dev_std = 0.728)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266133333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.645
NEC for r=0.9 class 0 = 0.478 +- 0.282 (in-sample avg dev_std = 0.725)
NEC for r=0.9 class 1 = 0.255 +- 0.282 (in-sample avg dev_std = 0.725)
NEC for r=0.9 class 2 = 0.41 +- 0.282 (in-sample avg dev_std = 0.725)
NEC for r=0.9 all KL = 0.485 +- 0.282 (in-sample avg dev_std = 0.725)
NEC for r=0.9 all L1 = 0.38 +- 0.236 (in-sample avg dev_std = 0.725)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839269999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.481 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 class 1 = 0.567 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 class 2 = 0.331 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 all KL = 0.555 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 all L1 = 0.459 +- 0.310 (in-sample avg dev_std = 0.629)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6781923333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.46
NEC for r=0.6 class 0 = 0.351 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 class 1 = 0.348 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 class 2 = 0.209 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 all KL = 0.38 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 all L1 = 0.303 +- 0.271 (in-sample avg dev_std = 0.604)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46883966666666665
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.477
NEC for r=0.9 class 0 = 0.33 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.323 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.166 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.344 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.273 +- 0.264 (in-sample avg dev_std = 0.570)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:35:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:35:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.423
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.323
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.736
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.620
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.450


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5451613333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.817
SUFF_SIMPLE for r=0.3 class 0 = 0.734 +- 0.285 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 class 1 = 0.98 +- 0.285 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 class 2 = 0.802 +- 0.285 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 all KL = 0.797 +- 0.285 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 all L1 = 0.84 +- 0.223 (in-sample avg dev_std = 0.479)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4227086666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.869
SUFF_SIMPLE for r=0.6 class 0 = 0.807 +- 0.218 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.6 class 1 = 0.987 +- 0.218 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.6 class 2 = 0.936 +- 0.218 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.6 all KL = 0.896 +- 0.218 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.6 all L1 = 0.912 +- 0.176 (in-sample avg dev_std = 0.336)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.322803
len(reference) = 2475
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.916
SUFF_SIMPLE for r=0.9 class 0 = 0.969 +- 0.118 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.9 class 1 = 0.989 +- 0.118 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.9 class 2 = 0.967 +- 0.118 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.9 all KL = 0.978 +- 0.118 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.9 all L1 = 0.975 +- 0.101 (in-sample avg dev_std = 0.137)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.735587
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.761
SUFF_SIMPLE for r=0.3 class 0 = 0.733 +- 0.209 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 class 1 = 0.989 +- 0.209 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 class 2 = 0.898 +- 0.209 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 all KL = 0.871 +- 0.209 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 all L1 = 0.872 +- 0.189 (in-sample avg dev_std = 0.356)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6201556666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.795
SUFF_SIMPLE for r=0.6 class 0 = 0.73 +- 0.207 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 class 1 = 0.993 +- 0.207 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 class 2 = 0.97 +- 0.207 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 all KL = 0.918 +- 0.207 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 all L1 = 0.897 +- 0.209 (in-sample avg dev_std = 0.209)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.595
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.44953000000000004
len(reference) = 927
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.63
SUFF_SIMPLE for r=0.9 class 0 = 0.906 +- 0.227 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.227 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.9 class 2 = 0.833 +- 0.227 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.9 all KL = 0.925 +- 0.227 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.9 all L1 = 0.929 +- 0.181 (in-sample avg dev_std = 0.264)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5451613333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.364
NEC for r=0.3 class 0 = 0.63 +- 0.236 (in-sample avg dev_std = 0.680)
NEC for r=0.3 class 1 = 0.518 +- 0.236 (in-sample avg dev_std = 0.680)
NEC for r=0.3 class 2 = 0.717 +- 0.236 (in-sample avg dev_std = 0.680)
NEC for r=0.3 all KL = 0.751 +- 0.236 (in-sample avg dev_std = 0.680)
NEC for r=0.3 all L1 = 0.622 +- 0.224 (in-sample avg dev_std = 0.680)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4227086666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.553
NEC for r=0.6 class 0 = 0.522 +- 0.276 (in-sample avg dev_std = 0.761)
NEC for r=0.6 class 1 = 0.35 +- 0.276 (in-sample avg dev_std = 0.761)
NEC for r=0.6 class 2 = 0.554 +- 0.276 (in-sample avg dev_std = 0.761)
NEC for r=0.6 all KL = 0.601 +- 0.276 (in-sample avg dev_std = 0.761)
NEC for r=0.6 all L1 = 0.476 +- 0.241 (in-sample avg dev_std = 0.761)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.322803
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0 = 0.445 +- 0.277 (in-sample avg dev_std = 0.749)
NEC for r=0.9 class 1 = 0.251 +- 0.277 (in-sample avg dev_std = 0.749)
NEC for r=0.9 class 2 = 0.445 +- 0.277 (in-sample avg dev_std = 0.749)
NEC for r=0.9 all KL = 0.495 +- 0.277 (in-sample avg dev_std = 0.749)
NEC for r=0.9 all L1 = 0.38 +- 0.228 (in-sample avg dev_std = 0.749)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.735587
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.25
NEC for r=0.3 class 0 = 0.504 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.333 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.801 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.617 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.547 +- 0.345 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6201556666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0 = 0.4 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 class 1 = 0.202 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 class 2 = 0.553 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 all KL = 0.463 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 all L1 = 0.386 +- 0.276 (in-sample avg dev_std = 0.676)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.44953000000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.583
NEC for r=0.9 class 0 = 0.383 +- 0.308 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 1 = 0.17 +- 0.308 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 2 = 0.45 +- 0.308 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all KL = 0.407 +- 0.308 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all L1 = 0.335 +- 0.248 (in-sample avg dev_std = 0.667)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:37:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:37:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.339
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.669
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.598
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.444


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.556131
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.827
SUFF_SIMPLE for r=0.3 class 0 = 0.753 +- 0.285 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 class 1 = 0.982 +- 0.285 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 class 2 = 0.806 +- 0.285 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 all KL = 0.805 +- 0.285 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 all L1 = 0.848 +- 0.218 (in-sample avg dev_std = 0.473)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4336723333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.883
SUFF_SIMPLE for r=0.6 class 0 = 0.849 +- 0.200 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 class 1 = 0.991 +- 0.200 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 class 2 = 0.93 +- 0.200 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 all KL = 0.913 +- 0.200 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.6 all L1 = 0.924 +- 0.158 (in-sample avg dev_std = 0.311)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33863600000000005
len(reference) = 2592
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.876
SUFF_SIMPLE for r=0.9 class 0 = 0.855 +- 0.215 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.9 class 1 = 0.987 +- 0.215 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.9 class 2 = 0.982 +- 0.215 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.9 all KL = 0.942 +- 0.215 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.9 all L1 = 0.941 +- 0.191 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.6694983333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.621
SUFF_SIMPLE for r=0.3 class 0 = 0.785 +- 0.283 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.3 class 1 = 0.915 +- 0.283 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.3 class 2 = 0.905 +- 0.283 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.3 all KL = 0.842 +- 0.283 (in-sample avg dev_std = 0.361)
SUFF_SIMPLE for r=0.3 all L1 = 0.868 +- 0.238 (in-sample avg dev_std = 0.361)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.5981513333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.66
SUFF_SIMPLE for r=0.6 class 0 = 0.866 +- 0.226 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.6 class 1 = 0.919 +- 0.226 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.6 class 2 = 0.991 +- 0.226 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.6 all KL = 0.929 +- 0.226 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.6 all L1 = 0.925 +- 0.207 (in-sample avg dev_std = 0.166)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.276
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4435263333333333
len(reference) = 1119
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.283
SUFF_SIMPLE for r=0.9 class 0 = 0.969 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.999 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.982 +- 0.093 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.556131
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
NEC for r=0.3 class 0 = 0.698 +- 0.211 (in-sample avg dev_std = 0.682)
NEC for r=0.3 class 1 = 0.517 +- 0.211 (in-sample avg dev_std = 0.682)
NEC for r=0.3 class 2 = 0.735 +- 0.211 (in-sample avg dev_std = 0.682)
NEC for r=0.3 all KL = 0.781 +- 0.211 (in-sample avg dev_std = 0.682)
NEC for r=0.3 all L1 = 0.65 +- 0.206 (in-sample avg dev_std = 0.682)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4336723333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.536
NEC for r=0.6 class 0 = 0.554 +- 0.272 (in-sample avg dev_std = 0.769)
NEC for r=0.6 class 1 = 0.349 +- 0.272 (in-sample avg dev_std = 0.769)
NEC for r=0.6 class 2 = 0.575 +- 0.272 (in-sample avg dev_std = 0.769)
NEC for r=0.6 all KL = 0.621 +- 0.272 (in-sample avg dev_std = 0.769)
NEC for r=0.6 all L1 = 0.493 +- 0.239 (in-sample avg dev_std = 0.769)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33863600000000005
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.653
NEC for r=0.9 class 0 = 0.447 +- 0.281 (in-sample avg dev_std = 0.751)
NEC for r=0.9 class 1 = 0.251 +- 0.281 (in-sample avg dev_std = 0.751)
NEC for r=0.9 class 2 = 0.456 +- 0.281 (in-sample avg dev_std = 0.751)
NEC for r=0.9 all KL = 0.5 +- 0.281 (in-sample avg dev_std = 0.751)
NEC for r=0.9 all L1 = 0.384 +- 0.232 (in-sample avg dev_std = 0.751)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.6694983333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.294
NEC for r=0.3 class 0 = 0.424 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 1 = 0.487 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 2 = 0.394 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all KL = 0.52 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all L1 = 0.435 +- 0.350 (in-sample avg dev_std = 0.538)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.5981513333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.446
NEC for r=0.6 class 0 = 0.362 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 class 1 = 0.324 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 class 2 = 0.295 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 all KL = 0.408 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 all L1 = 0.327 +- 0.311 (in-sample avg dev_std = 0.606)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4435263333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.514
NEC for r=0.9 class 0 = 0.311 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 1 = 0.276 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 2 = 0.231 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all KL = 0.349 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all L1 = 0.273 +- 0.274 (in-sample avg dev_std = 0.604)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:39:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:39:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9310 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.573
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731906666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.859
SUFF_SIMPLE for r=0.3 class 0 = 0.822 +- 0.248 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.3 class 1 = 0.982 +- 0.248 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.3 class 2 = 0.863 +- 0.248 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.3 all KL = 0.862 +- 0.248 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.3 all L1 = 0.89 +- 0.191 (in-sample avg dev_std = 0.402)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441644
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.906
SUFF_SIMPLE for r=0.6 class 0 = 0.901 +- 0.158 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.6 class 1 = 0.991 +- 0.158 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.6 class 2 = 0.965 +- 0.158 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.6 all KL = 0.947 +- 0.158 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.6 all L1 = 0.953 +- 0.123 (in-sample avg dev_std = 0.248)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3306806666666666
len(reference) = 2547
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.927
SUFF_SIMPLE for r=0.9 class 0 = 0.976 +- 0.049 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 1 = 0.997 +- 0.049 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 2 = 0.993 +- 0.049 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all KL = 0.995 +- 0.049 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all L1 = 0.988 +- 0.048 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7852763333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.824
SUFF_SIMPLE for r=0.3 class 0 = 0.702 +- 0.246 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.3 class 1 = 0.977 +- 0.246 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.3 class 2 = 0.917 +- 0.246 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.3 all KL = 0.851 +- 0.246 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.3 all L1 = 0.865 +- 0.223 (in-sample avg dev_std = 0.338)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.699089
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.854
SUFF_SIMPLE for r=0.6 class 0 = 0.785 +- 0.193 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.983 +- 0.193 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.991 +- 0.193 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.934 +- 0.193 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.919 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4848166666666667
len(reference) = 515
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.92
SUFF_SIMPLE for r=0.9 class 0 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731906666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.37
NEC for r=0.3 class 0 = 0.65 +- 0.217 (in-sample avg dev_std = 0.703)
NEC for r=0.3 class 1 = 0.524 +- 0.217 (in-sample avg dev_std = 0.703)
NEC for r=0.3 class 2 = 0.703 +- 0.217 (in-sample avg dev_std = 0.703)
NEC for r=0.3 all KL = 0.76 +- 0.217 (in-sample avg dev_std = 0.703)
NEC for r=0.3 all L1 = 0.626 +- 0.210 (in-sample avg dev_std = 0.703)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441644
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.567
NEC for r=0.6 class 0 = 0.486 +- 0.276 (in-sample avg dev_std = 0.757)
NEC for r=0.6 class 1 = 0.356 +- 0.276 (in-sample avg dev_std = 0.757)
NEC for r=0.6 class 2 = 0.545 +- 0.276 (in-sample avg dev_std = 0.757)
NEC for r=0.6 all KL = 0.589 +- 0.276 (in-sample avg dev_std = 0.757)
NEC for r=0.6 all L1 = 0.463 +- 0.240 (in-sample avg dev_std = 0.757)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3306806666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.675
NEC for r=0.9 class 0 = 0.408 +- 0.273 (in-sample avg dev_std = 0.747)
NEC for r=0.9 class 1 = 0.265 +- 0.273 (in-sample avg dev_std = 0.747)
NEC for r=0.9 class 2 = 0.413 +- 0.273 (in-sample avg dev_std = 0.747)
NEC for r=0.9 all KL = 0.478 +- 0.273 (in-sample avg dev_std = 0.747)
NEC for r=0.9 all L1 = 0.362 +- 0.221 (in-sample avg dev_std = 0.747)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7852763333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.186
NEC for r=0.3 class 0 = 0.795 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 1 = 0.588 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 2 = 0.81 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all KL = 0.829 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all L1 = 0.732 +- 0.145 (in-sample avg dev_std = 0.482)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.699089
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.517
NEC for r=0.6 class 0 = 0.629 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 1 = 0.336 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 2 = 0.54 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all KL = 0.615 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all L1 = 0.502 +- 0.213 (in-sample avg dev_std = 0.766)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4848166666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.548 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 class 1 = 0.281 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 class 2 = 0.461 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 all KL = 0.537 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 all L1 = 0.431 +- 0.207 (in-sample avg dev_std = 0.752)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:41:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:41:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.527
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.406
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.786
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.479


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5265093333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.835
SUFF_SIMPLE for r=0.3 class 0 = 0.762 +- 0.273 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 class 1 = 0.979 +- 0.273 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 class 2 = 0.838 +- 0.273 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 all KL = 0.822 +- 0.273 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 all L1 = 0.861 +- 0.212 (in-sample avg dev_std = 0.454)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.40593533333333337
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.892
SUFF_SIMPLE for r=0.6 class 0 = 0.888 +- 0.171 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.6 class 1 = 0.983 +- 0.171 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.6 class 2 = 0.953 +- 0.171 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.6 all KL = 0.935 +- 0.171 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.6 all L1 = 0.942 +- 0.144 (in-sample avg dev_std = 0.255)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32962033333333335
len(reference) = 2641
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.917
SUFF_SIMPLE for r=0.9 class 0 = 0.96 +- 0.114 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.9 class 1 = 0.988 +- 0.114 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.9 class 2 = 0.98 +- 0.114 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.9 all KL = 0.976 +- 0.114 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.9 all L1 = 0.976 +- 0.097 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7857369999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.79
SUFF_SIMPLE for r=0.3 class 0 = 0.859 +- 0.196 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 1 = 0.992 +- 0.196 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 2 = 0.907 +- 0.196 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all KL = 0.899 +- 0.196 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all L1 = 0.919 +- 0.149 (in-sample avg dev_std = 0.352)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6914119999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.839
SUFF_SIMPLE for r=0.6 class 0 = 0.956 +- 0.037 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.6 class 1 = 0.999 +- 0.037 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.6 class 2 = 0.996 +- 0.037 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.6 all KL = 0.993 +- 0.037 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.6 all L1 = 0.984 +- 0.064 (in-sample avg dev_std = 0.050)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4790656666666667
len(reference) = 1750
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.927
SUFF_SIMPLE for r=0.9 class 0 = 0.94 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.974 +- 0.098 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5265093333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.625 +- 0.228 (in-sample avg dev_std = 0.695)
NEC for r=0.3 class 1 = 0.542 +- 0.228 (in-sample avg dev_std = 0.695)
NEC for r=0.3 class 2 = 0.705 +- 0.228 (in-sample avg dev_std = 0.695)
NEC for r=0.3 all KL = 0.761 +- 0.228 (in-sample avg dev_std = 0.695)
NEC for r=0.3 all L1 = 0.625 +- 0.218 (in-sample avg dev_std = 0.695)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.40593533333333337
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.56
NEC for r=0.6 class 0 = 0.516 +- 0.274 (in-sample avg dev_std = 0.753)
NEC for r=0.6 class 1 = 0.349 +- 0.274 (in-sample avg dev_std = 0.753)
NEC for r=0.6 class 2 = 0.536 +- 0.274 (in-sample avg dev_std = 0.753)
NEC for r=0.6 all KL = 0.599 +- 0.274 (in-sample avg dev_std = 0.753)
NEC for r=0.6 all L1 = 0.467 +- 0.242 (in-sample avg dev_std = 0.753)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32962033333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.424 +- 0.280 (in-sample avg dev_std = 0.750)
NEC for r=0.9 class 1 = 0.263 +- 0.280 (in-sample avg dev_std = 0.750)
NEC for r=0.9 class 2 = 0.427 +- 0.280 (in-sample avg dev_std = 0.750)
NEC for r=0.9 all KL = 0.492 +- 0.280 (in-sample avg dev_std = 0.750)
NEC for r=0.9 all L1 = 0.371 +- 0.229 (in-sample avg dev_std = 0.750)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7857369999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.268
NEC for r=0.3 class 0 = 0.635 +- 0.364 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 1 = 0.397 +- 0.364 (in-sample avg dev_std = 0.377)
NEC for r=0.3 class 2 = 0.794 +- 0.364 (in-sample avg dev_std = 0.377)
NEC for r=0.3 all KL = 0.66 +- 0.364 (in-sample avg dev_std = 0.377)
NEC for r=0.3 all L1 = 0.609 +- 0.276 (in-sample avg dev_std = 0.377)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6914119999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.543
NEC for r=0.6 class 0 = 0.433 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 class 1 = 0.222 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 class 2 = 0.524 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 all KL = 0.474 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 all L1 = 0.394 +- 0.252 (in-sample avg dev_std = 0.700)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4790656666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.386 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 class 1 = 0.187 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 class 2 = 0.45 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 all KL = 0.42 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 all L1 = 0.341 +- 0.232 (in-sample avg dev_std = 0.692)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:42:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:42:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.552
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.427
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.326
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.661
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.462


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5520200000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.845
SUFF_SIMPLE for r=0.3 class 0 = 0.797 +- 0.257 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 class 1 = 0.96 +- 0.257 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 class 2 = 0.846 +- 0.257 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 all KL = 0.83 +- 0.257 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 all L1 = 0.868 +- 0.200 (in-sample avg dev_std = 0.450)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4274783333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.893
SUFF_SIMPLE for r=0.6 class 0 = 0.891 +- 0.175 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 class 1 = 0.967 +- 0.175 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 class 2 = 0.966 +- 0.175 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 all KL = 0.933 +- 0.175 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 all L1 = 0.942 +- 0.148 (in-sample avg dev_std = 0.272)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32574766666666666
len(reference) = 2630
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.926
SUFF_SIMPLE for r=0.9 class 0 = 0.995 +- 0.090 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.9 class 1 = 0.968 +- 0.090 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.9 class 2 = 0.994 +- 0.090 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.9 all KL = 0.986 +- 0.090 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.9 all L1 = 0.986 +- 0.086 (in-sample avg dev_std = 0.071)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7801553333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.415
SUFF_SIMPLE for r=0.3 class 0 = 0.924 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 class 1 = 0.906 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 class 2 = 0.968 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 all KL = 0.936 +- 0.167 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.3 all L1 = 0.932 +- 0.167 (in-sample avg dev_std = 0.223)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6607156666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.431
SUFF_SIMPLE for r=0.6 class 0 = 0.962 +- 0.119 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.6 class 1 = 0.894 +- 0.119 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.6 class 2 = 0.997 +- 0.119 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.6 all KL = 0.964 +- 0.119 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.6 all L1 = 0.951 +- 0.153 (in-sample avg dev_std = 0.067)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.217
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46197466666666664
len(reference) = 814
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.131
SUFF_SIMPLE for r=0.9 class 0 = 0.928 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.946 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.94 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.932 +- 0.214 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5520200000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.389
NEC for r=0.3 class 0 = 0.635 +- 0.242 (in-sample avg dev_std = 0.698)
NEC for r=0.3 class 1 = 0.487 +- 0.242 (in-sample avg dev_std = 0.698)
NEC for r=0.3 class 2 = 0.705 +- 0.242 (in-sample avg dev_std = 0.698)
NEC for r=0.3 all KL = 0.743 +- 0.242 (in-sample avg dev_std = 0.698)
NEC for r=0.3 all L1 = 0.61 +- 0.225 (in-sample avg dev_std = 0.698)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4274783333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.58
NEC for r=0.6 class 0 = 0.495 +- 0.280 (in-sample avg dev_std = 0.759)
NEC for r=0.6 class 1 = 0.325 +- 0.280 (in-sample avg dev_std = 0.759)
NEC for r=0.6 class 2 = 0.54 +- 0.280 (in-sample avg dev_std = 0.759)
NEC for r=0.6 all KL = 0.583 +- 0.280 (in-sample avg dev_std = 0.759)
NEC for r=0.6 all L1 = 0.454 +- 0.240 (in-sample avg dev_std = 0.759)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32574766666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0 = 0.411 +- 0.279 (in-sample avg dev_std = 0.744)
NEC for r=0.9 class 1 = 0.251 +- 0.279 (in-sample avg dev_std = 0.744)
NEC for r=0.9 class 2 = 0.426 +- 0.279 (in-sample avg dev_std = 0.744)
NEC for r=0.9 all KL = 0.48 +- 0.279 (in-sample avg dev_std = 0.744)
NEC for r=0.9 all L1 = 0.363 +- 0.226 (in-sample avg dev_std = 0.744)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7801553333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.35
NEC for r=0.3 class 0 = 0.139 +- 0.257 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 1 = 0.113 +- 0.257 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 2 = 0.045 +- 0.257 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all KL = 0.1 +- 0.257 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all L1 = 0.099 +- 0.248 (in-sample avg dev_std = 0.141)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6607156666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.373
NEC for r=0.6 class 0 = 0.123 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 1 = 0.109 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 2 = 0.047 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all KL = 0.096 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all L1 = 0.093 +- 0.217 (in-sample avg dev_std = 0.256)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.437
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46197466666666664
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.395
NEC for r=0.9 class 0 = 0.106 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 class 1 = 0.109 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 class 2 = 0.036 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all KL = 0.084 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all L1 = 0.084 +- 0.191 (in-sample avg dev_std = 0.261)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.847, 0.949, 0.995], 'all_L1': [0.879, 0.959, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.801, 0.918, 0.985], 'all_L1': [0.837, 0.926, 0.974]}), defaultdict(<class 'list'>, {'all_KL': [0.847, 0.946, 0.96], 'all_L1': [0.882, 0.954, 0.964]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.878, 0.967], 'all_L1': [0.852, 0.906, 0.972]}), defaultdict(<class 'list'>, {'all_KL': [0.806, 0.892, 0.949], 'all_L1': [0.846, 0.913, 0.955]}), defaultdict(<class 'list'>, {'all_KL': [0.797, 0.896, 0.978], 'all_L1': [0.84, 0.912, 0.975]}), defaultdict(<class 'list'>, {'all_KL': [0.805, 0.913, 0.942], 'all_L1': [0.848, 0.924, 0.941]}), defaultdict(<class 'list'>, {'all_KL': [0.862, 0.947, 0.995], 'all_L1': [0.89, 0.953, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.822, 0.935, 0.976], 'all_L1': [0.861, 0.942, 0.976]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.933, 0.986], 'all_L1': [0.868, 0.942, 0.986]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.768, 0.597, 0.491], 'all_L1': [0.632, 0.466, 0.372]}), defaultdict(<class 'list'>, {'all_KL': [0.777, 0.618, 0.506], 'all_L1': [0.649, 0.497, 0.394]}), defaultdict(<class 'list'>, {'all_KL': [0.773, 0.593, 0.481], 'all_L1': [0.637, 0.463, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.584, 0.485], 'all_L1': [0.607, 0.456, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.752, 0.588, 0.485], 'all_L1': [0.627, 0.472, 0.38]}), defaultdict(<class 'list'>, {'all_KL': [0.751, 0.601, 0.495], 'all_L1': [0.622, 0.476, 0.38]}), defaultdict(<class 'list'>, {'all_KL': [0.781, 0.621, 0.5], 'all_L1': [0.65, 0.493, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.76, 0.589, 0.478], 'all_L1': [0.626, 0.463, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.599, 0.492], 'all_L1': [0.625, 0.467, 0.371]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.583, 0.48], 'all_L1': [0.61, 0.454, 0.363]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.858, 0.927, 1.0], 'all_L1': [0.846, 0.891, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.845, 0.881, 0.941], 'all_L1': [0.833, 0.859, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.882, 0.924, 0.839], 'all_L1': [0.909, 0.924, 0.839]}), defaultdict(<class 'list'>, {'all_KL': [0.84, 0.906, 1.0], 'all_L1': [0.865, 0.904, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.853, 0.884], 'all_L1': [0.89, 0.867, 0.888]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.918, 0.925], 'all_L1': [0.872, 0.897, 0.929]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.929, 0.99], 'all_L1': [0.868, 0.925, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.851, 0.934, 1.0], 'all_L1': [0.865, 0.919, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.899, 0.993, 0.99], 'all_L1': [0.919, 0.984, 0.974]}), defaultdict(<class 'list'>, {'all_KL': [0.936, 0.964, 0.94], 'all_L1': [0.932, 0.951, 0.932]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.623, 0.436, 0.368], 'all_L1': [0.582, 0.402, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.521, 0.474], 'all_L1': [0.632, 0.433, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.492, 0.428], 'all_L1': [0.621, 0.386, 0.326]}), defaultdict(<class 'list'>, {'all_KL': [0.647, 0.476, 0.411], 'all_L1': [0.529, 0.37, 0.318]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.38, 0.344], 'all_L1': [0.459, 0.303, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.617, 0.463, 0.407], 'all_L1': [0.547, 0.386, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.408, 0.349], 'all_L1': [0.435, 0.327, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.829, 0.615, 0.537], 'all_L1': [0.732, 0.502, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.474, 0.42], 'all_L1': [0.609, 0.394, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.1, 0.096, 0.084], 'all_L1': [0.099, 0.093, 0.084]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.860 +- 0.018, 0.933 +- 0.018, 0.972 +- 0.015
suff_simple class all_KL  =  0.822 +- 0.022, 0.921 +- 0.024, 0.973 +- 0.017
[[0.8517916798591614, 0.9049583077430725, 0.928033173084259], [0.8205833435058594, 0.8880833387374878, 0.921308159828186], [0.8550416827201843, 0.9038333296775818, 0.906440258026123], [0.828083336353302, 0.8681666851043701, 0.9084014892578125], [0.8140000104904175, 0.8638333082199097, 0.8885869383811951], [0.8172083497047424, 0.8692916631698608, 0.9162626266479492], [0.8274999856948853, 0.8832916617393494, 0.8764950037002563], [0.859458327293396, 0.9055416584014893, 0.927316427230835], [0.8349166512489319, 0.8924166560173035, 0.9167928695678711], [0.8445416688919067, 0.8934999704360962, 0.9255228042602539]]
[[0.847, 0.949, 0.995], [0.801, 0.918, 0.985], [0.847, 0.946, 0.96], [0.806, 0.878, 0.967], [0.806, 0.892, 0.949], [0.797, 0.896, 0.978], [0.805, 0.913, 0.942], [0.862, 0.947, 0.995], [0.822, 0.935, 0.976], [0.83, 0.933, 0.986]]
suff_simple_acc_int  =  0.835 +- 0.016, 0.887 +- 0.015, 0.912 +- 0.016
nec class all_L1  =  0.629 +- 0.014, 0.471 +- 0.014, 0.373 +- 0.010
nec class all_KL  =  0.761 +- 0.013, 0.597 +- 0.012, 0.489 +- 0.009
[[0.3617083430290222, 0.5703333616256714, 0.6660416722297668], [0.3321250081062317, 0.5225833058357239, 0.6417916417121887], [0.35345834493637085, 0.5679166913032532, 0.6778333187103271], [0.38612499833106995, 0.5698750019073486, 0.6645833253860474], [0.3645833432674408, 0.546791672706604, 0.6452083587646484], [0.36383333802223206, 0.5529166460037231, 0.6539166569709778], [0.3373749852180481, 0.5355833172798157, 0.6526250243186951], [0.37029168009757996, 0.5674583315849304, 0.6753333210945129], [0.36795833706855774, 0.5602083206176758, 0.6627916693687439], [0.3891249895095825, 0.5797916650772095, 0.6732083559036255]]
[[0.768, 0.597, 0.491], [0.777, 0.618, 0.506], [0.773, 0.593, 0.481], [0.741, 0.584, 0.485], [0.752, 0.588, 0.485], [0.751, 0.601, 0.495], [0.781, 0.621, 0.5], [0.76, 0.589, 0.478], [0.761, 0.599, 0.492], [0.743, 0.583, 0.48]]
nec_acc_int  =  0.363 +- 0.017, 0.557 +- 0.017, 0.661 +- 0.012

Eval split val
suff_simple class all_L1  =  0.880 +- 0.030, 0.912 +- 0.036, 0.944 +- 0.053
suff_simple class all_KL  =  0.871 +- 0.029, 0.923 +- 0.037, 0.951 +- 0.053
[[0.6816666722297668, 0.7070000171661377, 0.9295154213905334], [0.6182916760444641, 0.6708750128746033, 0.6212499737739563], [0.7513750195503235, 0.7670000195503235, 0.6912596225738525], [0.6338333487510681, 0.6536666750907898, 0.9322034120559692], [0.5680416822433472, 0.5247499942779541, 0.6918032765388489], [0.7605416774749756, 0.7950416803359985, 0.630124032497406], [0.6212916374206543, 0.6602916717529297, 0.2832886576652527], [0.8241666555404663, 0.8543333411216736, 0.9203883409500122], [0.7899583578109741, 0.8394166827201843, 0.9274285435676575], [0.4154583215713501, 0.4310416579246521, 0.1314496248960495]]
[[0.858, 0.927, 1.0], [0.845, 0.881, 0.941], [0.882, 0.924, 0.839], [0.84, 0.906, 1.0], [0.881, 0.853, 0.884], [0.871, 0.918, 0.925], [0.842, 0.929, 0.99], [0.851, 0.934, 1.0], [0.899, 0.993, 0.99], [0.936, 0.964, 0.94]]
suff_simple_acc_int  =  0.666 +- 0.116, 0.690 +- 0.128, 0.676 +- 0.266
nec class all_L1  =  0.524 +- 0.164, 0.360 +- 0.103, 0.312 +- 0.088
nec class all_KL  =  0.603 +- 0.189, 0.436 +- 0.129, 0.382 +- 0.114
[[0.3413749933242798, 0.5096250176429749, 0.5635416507720947], [0.2356666624546051, 0.4326666593551636, 0.4780416786670685], [0.3044166564941406, 0.5351250171661377, 0.5975416898727417], [0.3087500035762787, 0.47350001335144043, 0.5168750286102295], [0.32637500762939453, 0.46012499928474426, 0.476666659116745], [0.25041666626930237, 0.5130416750907898, 0.5831666588783264], [0.2943750023841858, 0.44595834612846375, 0.5140416622161865], [0.18579167127609253, 0.5170416831970215, 0.5999166369438171], [0.2684166729450226, 0.5431666374206543, 0.5999166369438171], [0.3501250147819519, 0.37291666865348816, 0.3949166536331177]]
[[0.623, 0.436, 0.368], [0.742, 0.521, 0.474], [0.741, 0.492, 0.428], [0.647, 0.476, 0.411], [0.555, 0.38, 0.344], [0.617, 0.463, 0.407], [0.52, 0.408, 0.349], [0.829, 0.615, 0.537], [0.66, 0.474, 0.42], [0.1, 0.096, 0.084]]
nec_acc_int  =  0.287 +- 0.049, 0.480 +- 0.051, 0.532 +- 0.065


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.744 +- 0.010, 0.702 +- 0.010, 0.673 +- 0.007
Faith. Armon (L1)= 		  =  0.726 +- 0.010, 0.626 +- 0.011, 0.540 +- 0.010
Faith. GMean (L1)= 	  =  0.735 +- 0.010, 0.663 +- 0.010, 0.603 +- 0.007
Faith. Aritm (KL)= 		  =  0.791 +- 0.013, 0.759 +- 0.014, 0.731 +- 0.009
Faith. Armon (KL)= 		  =  0.790 +- 0.013, 0.724 +- 0.012, 0.651 +- 0.008
Faith. GMean (KL)= 	  =  0.791 +- 0.013, 0.741 +- 0.012, 0.690 +- 0.008

Eval split val
Faith. Aritm (L1)= 		  =  0.702 +- 0.075, 0.636 +- 0.050, 0.628 +- 0.055
Faith. Armon (L1)= 		  =  0.636 +- 0.164, 0.505 +- 0.123, 0.461 +- 0.114
Faith. GMean (L1)= 	  =  0.665 +- 0.131, 0.563 +- 0.098, 0.535 +- 0.095
Faith. Aritm (KL)= 		  =  0.737 +- 0.085, 0.679 +- 0.063, 0.667 +- 0.066
Faith. Armon (KL)= 		  =  0.688 +- 0.178, 0.578 +- 0.145, 0.534 +- 0.138
Faith. GMean (KL)= 	  =  0.708 +- 0.143, 0.623 +- 0.116, 0.593 +- 0.114
Computed for split load_split = id



Completed in  0:20:56.551231  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GL-GSAT temp GOODMotif/basis/covariate NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:44:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:44:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.9297 0.9297 0.9297 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.180
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.200
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18005533333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.685
SUFF_SIMPLE for r=0.3 class 0 = 0.609 +- 0.282 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 class 1 = 0.743 +- 0.282 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 class 2 = 0.607 +- 0.282 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 all KL = 0.542 +- 0.282 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.3 all L1 = 0.653 +- 0.230 (in-sample avg dev_std = 0.722)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25207666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF_SIMPLE for r=0.6 class 0 = 0.614 +- 0.308 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.6 class 1 = 0.753 +- 0.308 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.6 class 2 = 0.607 +- 0.308 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.6 all KL = 0.554 +- 0.308 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.6 all L1 = 0.658 +- 0.251 (in-sample avg dev_std = 0.698)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2950156666666667
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.703
SUFF_SIMPLE for r=0.9 class 0 = 0.71 +- 0.394 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.9 class 1 = 0.803 +- 0.394 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.9 class 2 = 0.709 +- 0.394 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.9 all KL = 0.693 +- 0.394 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.9 all L1 = 0.741 +- 0.334 (in-sample avg dev_std = 0.408)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20002166666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.558
SUFF_SIMPLE for r=0.3 class 0 = 0.576 +- 0.270 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.3 class 1 = 0.687 +- 0.270 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.3 class 2 = 0.679 +- 0.270 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.3 all KL = 0.62 +- 0.270 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.3 all L1 = 0.647 +- 0.218 (in-sample avg dev_std = 0.584)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32059566666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.547
SUFF_SIMPLE for r=0.6 class 0 = 0.569 +- 0.292 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 class 1 = 0.677 +- 0.292 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 class 2 = 0.704 +- 0.292 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 all KL = 0.625 +- 0.292 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.6 all L1 = 0.65 +- 0.239 (in-sample avg dev_std = 0.564)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3559523333333333
len(reference) = 2659
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.444
SUFF_SIMPLE for r=0.9 class 0 = 0.556 +- 0.388 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 class 1 = 0.537 +- 0.388 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 class 2 = 0.604 +- 0.388 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 all KL = 0.577 +- 0.388 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.9 all L1 = 0.566 +- 0.336 (in-sample avg dev_std = 0.128)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18005533333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.697
NEC for r=0.3 class 0 = 0.373 +- 0.311 (in-sample avg dev_std = 0.681)
NEC for r=0.3 class 1 = 0.221 +- 0.311 (in-sample avg dev_std = 0.681)
NEC for r=0.3 class 2 = 0.375 +- 0.311 (in-sample avg dev_std = 0.681)
NEC for r=0.3 all KL = 0.42 +- 0.311 (in-sample avg dev_std = 0.681)
NEC for r=0.3 all L1 = 0.323 +- 0.251 (in-sample avg dev_std = 0.681)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25207666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.688
NEC for r=0.6 class 0 = 0.389 +- 0.286 (in-sample avg dev_std = 0.717)
NEC for r=0.6 class 1 = 0.252 +- 0.286 (in-sample avg dev_std = 0.717)
NEC for r=0.6 class 2 = 0.388 +- 0.286 (in-sample avg dev_std = 0.717)
NEC for r=0.6 all KL = 0.452 +- 0.286 (in-sample avg dev_std = 0.717)
NEC for r=0.6 all L1 = 0.343 +- 0.232 (in-sample avg dev_std = 0.717)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2950156666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.396 +- 0.278 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 1 = 0.253 +- 0.278 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 2 = 0.403 +- 0.278 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all KL = 0.464 +- 0.278 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all L1 = 0.351 +- 0.225 (in-sample avg dev_std = 0.733)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20002166666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.588
NEC for r=0.3 class 0 = 0.411 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 1 = 0.253 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 2 = 0.213 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all KL = 0.306 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all L1 = 0.293 +- 0.244 (in-sample avg dev_std = 0.513)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32059566666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.573
NEC for r=0.6 class 0 = 0.427 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 class 1 = 0.28 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 class 2 = 0.27 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 all KL = 0.349 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 all L1 = 0.326 +- 0.224 (in-sample avg dev_std = 0.562)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3559523333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.425 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.278 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.271 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.348 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.325 +- 0.215 (in-sample avg dev_std = 0.568)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:47:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:47:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9273 0.9273 0.9273 0.9273 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.374


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18401433333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.657
SUFF_SIMPLE for r=0.3 class 0 = 0.549 +- 0.294 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 class 1 = 0.765 +- 0.294 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 class 2 = 0.574 +- 0.294 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 all KL = 0.526 +- 0.294 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 all L1 = 0.63 +- 0.244 (in-sample avg dev_std = 0.713)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25301033333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.659
SUFF_SIMPLE for r=0.6 class 0 = 0.555 +- 0.313 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 class 1 = 0.776 +- 0.313 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 class 2 = 0.581 +- 0.313 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 all KL = 0.54 +- 0.313 (in-sample avg dev_std = 0.687)
SUFF_SIMPLE for r=0.6 all L1 = 0.638 +- 0.259 (in-sample avg dev_std = 0.687)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2957666666666667
len(reference) = 2706
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.67
SUFF_SIMPLE for r=0.9 class 0 = 0.63 +- 0.399 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 class 1 = 0.835 +- 0.399 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 class 2 = 0.667 +- 0.399 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 all KL = 0.663 +- 0.399 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 all L1 = 0.711 +- 0.341 (in-sample avg dev_std = 0.417)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.201028
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.469
SUFF_SIMPLE for r=0.3 class 0 = 0.562 +- 0.287 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 class 1 = 0.629 +- 0.287 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 class 2 = 0.614 +- 0.287 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 all KL = 0.52 +- 0.287 (in-sample avg dev_std = 0.682)
SUFF_SIMPLE for r=0.3 all L1 = 0.601 +- 0.252 (in-sample avg dev_std = 0.682)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32370699999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.47
SUFF_SIMPLE for r=0.6 class 0 = 0.559 +- 0.309 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.6 class 1 = 0.621 +- 0.309 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.6 class 2 = 0.633 +- 0.309 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.6 all KL = 0.529 +- 0.309 (in-sample avg dev_std = 0.663)
SUFF_SIMPLE for r=0.6 all L1 = 0.604 +- 0.267 (in-sample avg dev_std = 0.663)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.37379733333333337
len(reference) = 2828
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.348
SUFF_SIMPLE for r=0.9 class 0 = 0.606 +- 0.440 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.9 class 1 = 0.581 +- 0.440 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.9 class 2 = 0.654 +- 0.440 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.9 all KL = 0.594 +- 0.440 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.9 all L1 = 0.614 +- 0.387 (in-sample avg dev_std = 0.149)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18401433333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.662
NEC for r=0.3 class 0 = 0.449 +- 0.320 (in-sample avg dev_std = 0.678)
NEC for r=0.3 class 1 = 0.22 +- 0.320 (in-sample avg dev_std = 0.678)
NEC for r=0.3 class 2 = 0.406 +- 0.320 (in-sample avg dev_std = 0.678)
NEC for r=0.3 all KL = 0.452 +- 0.320 (in-sample avg dev_std = 0.678)
NEC for r=0.3 all L1 = 0.357 +- 0.264 (in-sample avg dev_std = 0.678)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25301033333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.664
NEC for r=0.6 class 0 = 0.457 +- 0.292 (in-sample avg dev_std = 0.714)
NEC for r=0.6 class 1 = 0.229 +- 0.292 (in-sample avg dev_std = 0.714)
NEC for r=0.6 class 2 = 0.416 +- 0.292 (in-sample avg dev_std = 0.714)
NEC for r=0.6 all KL = 0.471 +- 0.292 (in-sample avg dev_std = 0.714)
NEC for r=0.6 all L1 = 0.367 +- 0.242 (in-sample avg dev_std = 0.714)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2957666666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.658
NEC for r=0.9 class 0 = 0.465 +- 0.285 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 1 = 0.233 +- 0.285 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 2 = 0.433 +- 0.285 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all KL = 0.484 +- 0.285 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all L1 = 0.376 +- 0.236 (in-sample avg dev_std = 0.728)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.201028
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
NEC for r=0.3 class 0 = 0.42 +- 0.320 (in-sample avg dev_std = 0.598)
NEC for r=0.3 class 1 = 0.305 +- 0.320 (in-sample avg dev_std = 0.598)
NEC for r=0.3 class 2 = 0.276 +- 0.320 (in-sample avg dev_std = 0.598)
NEC for r=0.3 all KL = 0.392 +- 0.320 (in-sample avg dev_std = 0.598)
NEC for r=0.3 all L1 = 0.334 +- 0.278 (in-sample avg dev_std = 0.598)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32370699999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.491
NEC for r=0.6 class 0 = 0.432 +- 0.291 (in-sample avg dev_std = 0.658)
NEC for r=0.6 class 1 = 0.343 +- 0.291 (in-sample avg dev_std = 0.658)
NEC for r=0.6 class 2 = 0.348 +- 0.291 (in-sample avg dev_std = 0.658)
NEC for r=0.6 all KL = 0.449 +- 0.291 (in-sample avg dev_std = 0.658)
NEC for r=0.6 all L1 = 0.375 +- 0.255 (in-sample avg dev_std = 0.658)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.37379733333333337
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.499
NEC for r=0.9 class 0 = 0.438 +- 0.283 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 1 = 0.336 +- 0.283 (in-sample avg dev_std = 0.665)
NEC for r=0.9 class 2 = 0.347 +- 0.283 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all KL = 0.451 +- 0.283 (in-sample avg dev_std = 0.665)
NEC for r=0.9 all L1 = 0.374 +- 0.250 (in-sample avg dev_std = 0.665)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:50:25 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:50:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 108 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.254
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.205
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.372


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18163966666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.689
SUFF_SIMPLE for r=0.3 class 0 = 0.622 +- 0.287 (in-sample avg dev_std = 0.726)
SUFF_SIMPLE for r=0.3 class 1 = 0.756 +- 0.287 (in-sample avg dev_std = 0.726)
SUFF_SIMPLE for r=0.3 class 2 = 0.592 +- 0.287 (in-sample avg dev_std = 0.726)
SUFF_SIMPLE for r=0.3 all KL = 0.544 +- 0.287 (in-sample avg dev_std = 0.726)
SUFF_SIMPLE for r=0.3 all L1 = 0.656 +- 0.232 (in-sample avg dev_std = 0.726)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.254193
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.684
SUFF_SIMPLE for r=0.6 class 0 = 0.628 +- 0.314 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.6 class 1 = 0.763 +- 0.314 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.6 class 2 = 0.598 +- 0.314 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.6 all KL = 0.56 +- 0.314 (in-sample avg dev_std = 0.693)
SUFF_SIMPLE for r=0.6 all L1 = 0.663 +- 0.254 (in-sample avg dev_std = 0.693)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294624
len(reference) = 2703
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF_SIMPLE for r=0.9 class 0 = 0.695 +- 0.400 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 class 1 = 0.814 +- 0.400 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 class 2 = 0.695 +- 0.400 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 all KL = 0.684 +- 0.400 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.9 all L1 = 0.735 +- 0.338 (in-sample avg dev_std = 0.417)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2054476666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.593
SUFF_SIMPLE for r=0.3 class 0 = 0.601 +- 0.279 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 class 1 = 0.692 +- 0.279 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 class 2 = 0.705 +- 0.279 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 all KL = 0.566 +- 0.279 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 all L1 = 0.666 +- 0.221 (in-sample avg dev_std = 0.719)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31712000000000007
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.578
SUFF_SIMPLE for r=0.6 class 0 = 0.599 +- 0.312 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.6 class 1 = 0.672 +- 0.312 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.6 class 2 = 0.714 +- 0.312 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.6 all KL = 0.569 +- 0.312 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.6 all L1 = 0.661 +- 0.250 (in-sample avg dev_std = 0.692)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3715286666666667
len(reference) = 2722
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.47
SUFF_SIMPLE for r=0.9 class 0 = 0.607 +- 0.448 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.9 class 1 = 0.6 +- 0.448 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.9 class 2 = 0.762 +- 0.448 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.9 all KL = 0.622 +- 0.448 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.9 all L1 = 0.659 +- 0.390 (in-sample avg dev_std = 0.199)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18163966666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0 = 0.36 +- 0.315 (in-sample avg dev_std = 0.689)
NEC for r=0.3 class 1 = 0.239 +- 0.315 (in-sample avg dev_std = 0.689)
NEC for r=0.3 class 2 = 0.378 +- 0.315 (in-sample avg dev_std = 0.689)
NEC for r=0.3 all KL = 0.427 +- 0.315 (in-sample avg dev_std = 0.689)
NEC for r=0.3 all L1 = 0.326 +- 0.254 (in-sample avg dev_std = 0.689)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.254193
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.689
NEC for r=0.6 class 0 = 0.376 +- 0.292 (in-sample avg dev_std = 0.726)
NEC for r=0.6 class 1 = 0.248 +- 0.292 (in-sample avg dev_std = 0.726)
NEC for r=0.6 class 2 = 0.403 +- 0.292 (in-sample avg dev_std = 0.726)
NEC for r=0.6 all KL = 0.453 +- 0.292 (in-sample avg dev_std = 0.726)
NEC for r=0.6 all L1 = 0.342 +- 0.234 (in-sample avg dev_std = 0.726)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294624
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0 = 0.379 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 1 = 0.249 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 2 = 0.4 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all KL = 0.457 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all L1 = 0.343 +- 0.225 (in-sample avg dev_std = 0.734)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2054476666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0 = 0.349 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 class 1 = 0.255 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 class 2 = 0.228 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 all KL = 0.356 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 all L1 = 0.278 +- 0.249 (in-sample avg dev_std = 0.641)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31712000000000007
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.617
NEC for r=0.6 class 0 = 0.355 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 class 1 = 0.271 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 class 2 = 0.259 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 all KL = 0.385 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 all L1 = 0.296 +- 0.227 (in-sample avg dev_std = 0.680)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.797
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3715286666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.611
NEC for r=0.9 class 0 = 0.367 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 1 = 0.285 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 2 = 0.278 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all KL = 0.406 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all L1 = 0.31 +- 0.213 (in-sample avg dev_std = 0.704)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:52:54 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:52:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.180
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1804796666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.68
SUFF_SIMPLE for r=0.3 class 0 = 0.601 +- 0.290 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.3 class 1 = 0.755 +- 0.290 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.3 class 2 = 0.601 +- 0.290 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.3 all KL = 0.541 +- 0.290 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.3 all L1 = 0.653 +- 0.237 (in-sample avg dev_std = 0.721)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24993733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.669
SUFF_SIMPLE for r=0.6 class 0 = 0.606 +- 0.312 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 class 1 = 0.752 +- 0.312 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 class 2 = 0.603 +- 0.312 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 all KL = 0.549 +- 0.312 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 all L1 = 0.654 +- 0.257 (in-sample avg dev_std = 0.694)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2941033333333333
len(reference) = 2711
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.693
SUFF_SIMPLE for r=0.9 class 0 = 0.68 +- 0.397 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.9 class 1 = 0.834 +- 0.397 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.9 class 2 = 0.688 +- 0.397 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.9 all KL = 0.681 +- 0.397 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.9 all L1 = 0.734 +- 0.336 (in-sample avg dev_std = 0.426)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20728599999999997
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.51
SUFF_SIMPLE for r=0.3 class 0 = 0.625 +- 0.317 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 class 1 = 0.626 +- 0.317 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 class 2 = 0.791 +- 0.317 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 all KL = 0.589 +- 0.317 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 all L1 = 0.681 +- 0.261 (in-sample avg dev_std = 0.646)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3202776666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.512
SUFF_SIMPLE for r=0.6 class 0 = 0.635 +- 0.341 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.6 class 1 = 0.629 +- 0.341 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.6 class 2 = 0.805 +- 0.341 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.6 all KL = 0.607 +- 0.341 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.6 all L1 = 0.69 +- 0.280 (in-sample avg dev_std = 0.615)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35268933333333335
len(reference) = 2654
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
SUFF_SIMPLE for r=0.9 class 0 = 0.651 +- 0.454 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.9 class 1 = 0.515 +- 0.454 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.9 class 2 = 0.816 +- 0.454 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.454 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.9 all L1 = 0.663 +- 0.397 (in-sample avg dev_std = 0.107)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1804796666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.684
NEC for r=0.3 class 0 = 0.391 +- 0.314 (in-sample avg dev_std = 0.686)
NEC for r=0.3 class 1 = 0.223 +- 0.314 (in-sample avg dev_std = 0.686)
NEC for r=0.3 class 2 = 0.381 +- 0.314 (in-sample avg dev_std = 0.686)
NEC for r=0.3 all KL = 0.433 +- 0.314 (in-sample avg dev_std = 0.686)
NEC for r=0.3 all L1 = 0.331 +- 0.256 (in-sample avg dev_std = 0.686)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24993733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.681
NEC for r=0.6 class 0 = 0.402 +- 0.287 (in-sample avg dev_std = 0.722)
NEC for r=0.6 class 1 = 0.246 +- 0.287 (in-sample avg dev_std = 0.722)
NEC for r=0.6 class 2 = 0.39 +- 0.287 (in-sample avg dev_std = 0.722)
NEC for r=0.6 all KL = 0.457 +- 0.287 (in-sample avg dev_std = 0.722)
NEC for r=0.6 all L1 = 0.346 +- 0.234 (in-sample avg dev_std = 0.722)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2941033333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.679
NEC for r=0.9 class 0 = 0.406 +- 0.282 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 1 = 0.252 +- 0.282 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 2 = 0.396 +- 0.282 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all KL = 0.466 +- 0.282 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all L1 = 0.351 +- 0.229 (in-sample avg dev_std = 0.735)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20728599999999997
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.536
NEC for r=0.3 class 0 = 0.36 +- 0.342 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 1 = 0.315 +- 0.342 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 2 = 0.166 +- 0.342 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all KL = 0.354 +- 0.342 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all L1 = 0.28 +- 0.281 (in-sample avg dev_std = 0.581)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3202776666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.525
NEC for r=0.6 class 0 = 0.369 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 class 1 = 0.346 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 class 2 = 0.186 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 all KL = 0.386 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 all L1 = 0.3 +- 0.265 (in-sample avg dev_std = 0.624)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35268933333333335
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.528
NEC for r=0.9 class 0 = 0.368 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 class 1 = 0.341 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 class 2 = 0.206 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 all KL = 0.396 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 all L1 = 0.305 +- 0.253 (in-sample avg dev_std = 0.640)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:55:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:55:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.177
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.293
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.203
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.311
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.366


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17740333333333336
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.66
SUFF_SIMPLE for r=0.3 class 0 = 0.549 +- 0.288 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 class 1 = 0.752 +- 0.288 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 class 2 = 0.611 +- 0.288 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 all KL = 0.538 +- 0.288 (in-sample avg dev_std = 0.708)
SUFF_SIMPLE for r=0.3 all L1 = 0.639 +- 0.240 (in-sample avg dev_std = 0.708)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24933566666666668
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.655
SUFF_SIMPLE for r=0.6 class 0 = 0.552 +- 0.314 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.6 class 1 = 0.771 +- 0.314 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.6 class 2 = 0.603 +- 0.314 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.6 all KL = 0.55 +- 0.314 (in-sample avg dev_std = 0.674)
SUFF_SIMPLE for r=0.6 all L1 = 0.643 +- 0.263 (in-sample avg dev_std = 0.674)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2931806666666667
len(reference) = 2697
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.677
SUFF_SIMPLE for r=0.9 class 0 = 0.634 +- 0.392 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.9 class 1 = 0.843 +- 0.392 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.9 class 2 = 0.683 +- 0.392 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.9 all KL = 0.672 +- 0.392 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.9 all L1 = 0.721 +- 0.336 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20274833333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.474
SUFF_SIMPLE for r=0.3 class 0 = 0.669 +- 0.326 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.3 class 1 = 0.679 +- 0.326 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.3 class 2 = 0.838 +- 0.326 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.3 all KL = 0.661 +- 0.326 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.3 all L1 = 0.729 +- 0.273 (in-sample avg dev_std = 0.562)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31096066666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.473
SUFF_SIMPLE for r=0.6 class 0 = 0.679 +- 0.342 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.6 class 1 = 0.674 +- 0.342 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.6 class 2 = 0.853 +- 0.342 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.6 all KL = 0.674 +- 0.342 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.6 all L1 = 0.735 +- 0.286 (in-sample avg dev_std = 0.533)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36591
len(reference) = 2769
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.444
SUFF_SIMPLE for r=0.9 class 0 = 0.71 +- 0.405 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 class 1 = 0.694 +- 0.405 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.405 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 all KL = 0.745 +- 0.405 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 all L1 = 0.764 +- 0.362 (in-sample avg dev_std = 0.044)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17740333333333336
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.664
NEC for r=0.3 class 0 = 0.448 +- 0.315 (in-sample avg dev_std = 0.669)
NEC for r=0.3 class 1 = 0.229 +- 0.315 (in-sample avg dev_std = 0.669)
NEC for r=0.3 class 2 = 0.364 +- 0.315 (in-sample avg dev_std = 0.669)
NEC for r=0.3 all KL = 0.438 +- 0.315 (in-sample avg dev_std = 0.669)
NEC for r=0.3 all L1 = 0.346 +- 0.262 (in-sample avg dev_std = 0.669)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24933566666666668
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.662
NEC for r=0.6 class 0 = 0.451 +- 0.292 (in-sample avg dev_std = 0.704)
NEC for r=0.6 class 1 = 0.241 +- 0.292 (in-sample avg dev_std = 0.704)
NEC for r=0.6 class 2 = 0.38 +- 0.292 (in-sample avg dev_std = 0.704)
NEC for r=0.6 all KL = 0.456 +- 0.292 (in-sample avg dev_std = 0.704)
NEC for r=0.6 all L1 = 0.356 +- 0.242 (in-sample avg dev_std = 0.704)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2931806666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.659
NEC for r=0.9 class 0 = 0.459 +- 0.286 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.247 +- 0.286 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.391 +- 0.286 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.468 +- 0.286 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.364 +- 0.238 (in-sample avg dev_std = 0.715)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20274833333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.486
NEC for r=0.3 class 0 = 0.312 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 1 = 0.282 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 2 = 0.144 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all KL = 0.302 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all L1 = 0.246 +- 0.284 (in-sample avg dev_std = 0.513)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31096066666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.484
NEC for r=0.6 class 0 = 0.328 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.301 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.149 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.323 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.259 +- 0.272 (in-sample avg dev_std = 0.548)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36591
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.484
NEC for r=0.9 class 0 = 0.33 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.307 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.152 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.331 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.263 +- 0.263 (in-sample avg dev_std = 0.561)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:57:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:57:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.363


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18112699999999998
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.659
SUFF_SIMPLE for r=0.3 class 0 = 0.568 +- 0.291 (in-sample avg dev_std = 0.734)
SUFF_SIMPLE for r=0.3 class 1 = 0.741 +- 0.291 (in-sample avg dev_std = 0.734)
SUFF_SIMPLE for r=0.3 class 2 = 0.577 +- 0.291 (in-sample avg dev_std = 0.734)
SUFF_SIMPLE for r=0.3 all KL = 0.518 +- 0.291 (in-sample avg dev_std = 0.734)
SUFF_SIMPLE for r=0.3 all L1 = 0.629 +- 0.239 (in-sample avg dev_std = 0.734)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25049066666666664
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.665
SUFF_SIMPLE for r=0.6 class 0 = 0.591 +- 0.313 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 class 1 = 0.759 +- 0.313 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 class 2 = 0.587 +- 0.313 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 all KL = 0.545 +- 0.313 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.6 all L1 = 0.646 +- 0.258 (in-sample avg dev_std = 0.694)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29535733333333336
len(reference) = 2708
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.685
SUFF_SIMPLE for r=0.9 class 0 = 0.667 +- 0.398 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 class 1 = 0.833 +- 0.398 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 class 2 = 0.673 +- 0.398 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 all KL = 0.676 +- 0.398 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 all L1 = 0.725 +- 0.339 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2040293333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.573
SUFF_SIMPLE for r=0.3 class 0 = 0.614 +- 0.317 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.3 class 1 = 0.832 +- 0.317 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.3 class 2 = 0.51 +- 0.317 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.3 all KL = 0.578 +- 0.317 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.3 all L1 = 0.651 +- 0.256 (in-sample avg dev_std = 0.670)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32442
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.573
SUFF_SIMPLE for r=0.6 class 0 = 0.619 +- 0.333 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.6 class 1 = 0.837 +- 0.333 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.6 class 2 = 0.538 +- 0.333 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.6 all KL = 0.599 +- 0.333 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.6 all L1 = 0.664 +- 0.272 (in-sample avg dev_std = 0.635)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634516666666667
len(reference) = 2682
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
SUFF_SIMPLE for r=0.9 class 0 = 0.646 +- 0.460 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.9 class 1 = 0.793 +- 0.460 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.9 class 2 = 0.298 +- 0.460 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.9 all KL = 0.543 +- 0.460 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.9 all L1 = 0.581 +- 0.399 (in-sample avg dev_std = 0.077)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18112699999999998
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.673
NEC for r=0.3 class 0 = 0.409 +- 0.314 (in-sample avg dev_std = 0.692)
NEC for r=0.3 class 1 = 0.226 +- 0.314 (in-sample avg dev_std = 0.692)
NEC for r=0.3 class 2 = 0.401 +- 0.314 (in-sample avg dev_std = 0.692)
NEC for r=0.3 all KL = 0.444 +- 0.314 (in-sample avg dev_std = 0.692)
NEC for r=0.3 all L1 = 0.345 +- 0.257 (in-sample avg dev_std = 0.692)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25049066666666664
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.668
NEC for r=0.6 class 0 = 0.428 +- 0.289 (in-sample avg dev_std = 0.730)
NEC for r=0.6 class 1 = 0.242 +- 0.289 (in-sample avg dev_std = 0.730)
NEC for r=0.6 class 2 = 0.418 +- 0.289 (in-sample avg dev_std = 0.730)
NEC for r=0.6 all KL = 0.471 +- 0.289 (in-sample avg dev_std = 0.730)
NEC for r=0.6 all L1 = 0.362 +- 0.236 (in-sample avg dev_std = 0.730)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29535733333333336
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.666
NEC for r=0.9 class 0 = 0.428 +- 0.280 (in-sample avg dev_std = 0.739)
NEC for r=0.9 class 1 = 0.248 +- 0.280 (in-sample avg dev_std = 0.739)
NEC for r=0.9 class 2 = 0.421 +- 0.280 (in-sample avg dev_std = 0.739)
NEC for r=0.9 all KL = 0.477 +- 0.280 (in-sample avg dev_std = 0.739)
NEC for r=0.9 all L1 = 0.366 +- 0.229 (in-sample avg dev_std = 0.739)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2040293333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.615
NEC for r=0.3 class 0 = 0.36 +- 0.321 (in-sample avg dev_std = 0.587)
NEC for r=0.3 class 1 = 0.135 +- 0.321 (in-sample avg dev_std = 0.587)
NEC for r=0.3 class 2 = 0.361 +- 0.321 (in-sample avg dev_std = 0.587)
NEC for r=0.3 all KL = 0.337 +- 0.321 (in-sample avg dev_std = 0.587)
NEC for r=0.3 all L1 = 0.286 +- 0.264 (in-sample avg dev_std = 0.587)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32442
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.593
NEC for r=0.6 class 0 = 0.364 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 class 1 = 0.158 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 class 2 = 0.434 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 all KL = 0.385 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 all L1 = 0.319 +- 0.251 (in-sample avg dev_std = 0.643)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634516666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.604
NEC for r=0.9 class 0 = 0.373 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 1 = 0.153 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 2 = 0.418 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all KL = 0.382 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all L1 = 0.315 +- 0.240 (in-sample avg dev_std = 0.652)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:59:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:59:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.369


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18235933333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.659
SUFF_SIMPLE for r=0.3 class 0 = 0.568 +- 0.289 (in-sample avg dev_std = 0.735)
SUFF_SIMPLE for r=0.3 class 1 = 0.759 +- 0.289 (in-sample avg dev_std = 0.735)
SUFF_SIMPLE for r=0.3 class 2 = 0.557 +- 0.289 (in-sample avg dev_std = 0.735)
SUFF_SIMPLE for r=0.3 all KL = 0.517 +- 0.289 (in-sample avg dev_std = 0.735)
SUFF_SIMPLE for r=0.3 all L1 = 0.628 +- 0.238 (in-sample avg dev_std = 0.735)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251305
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.66
SUFF_SIMPLE for r=0.6 class 0 = 0.575 +- 0.316 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 class 1 = 0.768 +- 0.316 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 class 2 = 0.568 +- 0.316 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 all KL = 0.534 +- 0.316 (in-sample avg dev_std = 0.705)
SUFF_SIMPLE for r=0.6 all L1 = 0.637 +- 0.259 (in-sample avg dev_std = 0.705)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2955293333333333
len(reference) = 2705
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.679
SUFF_SIMPLE for r=0.9 class 0 = 0.64 +- 0.401 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.9 class 1 = 0.847 +- 0.401 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.9 class 2 = 0.668 +- 0.401 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.9 all KL = 0.669 +- 0.401 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.9 all L1 = 0.719 +- 0.341 (in-sample avg dev_std = 0.424)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19703299999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.501
SUFF_SIMPLE for r=0.3 class 0 = 0.686 +- 0.349 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 class 1 = 0.723 +- 0.349 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 class 2 = 0.757 +- 0.349 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 all KL = 0.648 +- 0.349 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 all L1 = 0.722 +- 0.285 (in-sample avg dev_std = 0.596)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31633333333333336
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.508
SUFF_SIMPLE for r=0.6 class 0 = 0.69 +- 0.359 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.6 class 1 = 0.734 +- 0.359 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.6 class 2 = 0.772 +- 0.359 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.6 all KL = 0.665 +- 0.359 (in-sample avg dev_std = 0.560)
SUFF_SIMPLE for r=0.6 all L1 = 0.732 +- 0.295 (in-sample avg dev_std = 0.560)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.578
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36851400000000006
len(reference) = 2696
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF_SIMPLE for r=0.9 class 0 = 0.725 +- 0.430 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 class 1 = 0.716 +- 0.430 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 class 2 = 0.765 +- 0.430 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 all KL = 0.708 +- 0.430 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 all L1 = 0.735 +- 0.381 (in-sample avg dev_std = 0.053)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18235933333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.664
NEC for r=0.3 class 0 = 0.424 +- 0.322 (in-sample avg dev_std = 0.693)
NEC for r=0.3 class 1 = 0.231 +- 0.322 (in-sample avg dev_std = 0.693)
NEC for r=0.3 class 2 = 0.411 +- 0.322 (in-sample avg dev_std = 0.693)
NEC for r=0.3 all KL = 0.455 +- 0.322 (in-sample avg dev_std = 0.693)
NEC for r=0.3 all L1 = 0.355 +- 0.264 (in-sample avg dev_std = 0.693)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251305
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 0 = 0.414 +- 0.297 (in-sample avg dev_std = 0.723)
NEC for r=0.6 class 1 = 0.232 +- 0.297 (in-sample avg dev_std = 0.723)
NEC for r=0.6 class 2 = 0.431 +- 0.297 (in-sample avg dev_std = 0.723)
NEC for r=0.6 all KL = 0.466 +- 0.297 (in-sample avg dev_std = 0.723)
NEC for r=0.6 all L1 = 0.359 +- 0.242 (in-sample avg dev_std = 0.723)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2955293333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0 = 0.428 +- 0.286 (in-sample avg dev_std = 0.739)
NEC for r=0.9 class 1 = 0.242 +- 0.286 (in-sample avg dev_std = 0.739)
NEC for r=0.9 class 2 = 0.433 +- 0.286 (in-sample avg dev_std = 0.739)
NEC for r=0.9 all KL = 0.479 +- 0.286 (in-sample avg dev_std = 0.739)
NEC for r=0.9 all L1 = 0.367 +- 0.233 (in-sample avg dev_std = 0.739)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19703299999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.528
NEC for r=0.3 class 0 = 0.287 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 1 = 0.248 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 2 = 0.19 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all KL = 0.301 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all L1 = 0.242 +- 0.285 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31633333333333336
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.514
NEC for r=0.6 class 0 = 0.306 +- 0.341 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 1 = 0.266 +- 0.341 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 2 = 0.219 +- 0.341 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all KL = 0.336 +- 0.341 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all L1 = 0.264 +- 0.277 (in-sample avg dev_std = 0.586)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36851400000000006
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.519
NEC for r=0.9 class 0 = 0.306 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 class 1 = 0.255 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 class 2 = 0.23 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 all KL = 0.336 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 all L1 = 0.264 +- 0.274 (in-sample avg dev_std = 0.590)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:00:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:00:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9310 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.214
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.326
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1816133333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.685
SUFF_SIMPLE for r=0.3 class 0 = 0.613 +- 0.291 (in-sample avg dev_std = 0.723)
SUFF_SIMPLE for r=0.3 class 1 = 0.752 +- 0.291 (in-sample avg dev_std = 0.723)
SUFF_SIMPLE for r=0.3 class 2 = 0.594 +- 0.291 (in-sample avg dev_std = 0.723)
SUFF_SIMPLE for r=0.3 all KL = 0.544 +- 0.291 (in-sample avg dev_std = 0.723)
SUFF_SIMPLE for r=0.3 all L1 = 0.653 +- 0.234 (in-sample avg dev_std = 0.723)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25266666666666665
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.686
SUFF_SIMPLE for r=0.6 class 0 = 0.635 +- 0.311 (in-sample avg dev_std = 0.689)
SUFF_SIMPLE for r=0.6 class 1 = 0.755 +- 0.311 (in-sample avg dev_std = 0.689)
SUFF_SIMPLE for r=0.6 class 2 = 0.608 +- 0.311 (in-sample avg dev_std = 0.689)
SUFF_SIMPLE for r=0.6 all KL = 0.565 +- 0.311 (in-sample avg dev_std = 0.689)
SUFF_SIMPLE for r=0.6 all L1 = 0.666 +- 0.252 (in-sample avg dev_std = 0.689)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29447033333333333
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.702
SUFF_SIMPLE for r=0.9 class 0 = 0.716 +- 0.392 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.9 class 1 = 0.835 +- 0.392 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.9 class 2 = 0.688 +- 0.392 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.9 all KL = 0.702 +- 0.392 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.9 all L1 = 0.746 +- 0.332 (in-sample avg dev_std = 0.402)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21388133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF_SIMPLE for r=0.3 class 0 = 0.453 +- 0.256 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.3 class 1 = 0.725 +- 0.256 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.3 class 2 = 0.521 +- 0.256 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.3 all KL = 0.461 +- 0.256 (in-sample avg dev_std = 0.744)
SUFF_SIMPLE for r=0.3 all L1 = 0.566 +- 0.219 (in-sample avg dev_std = 0.744)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3259273333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.587
SUFF_SIMPLE for r=0.6 class 0 = 0.461 +- 0.285 (in-sample avg dev_std = 0.711)
SUFF_SIMPLE for r=0.6 class 1 = 0.721 +- 0.285 (in-sample avg dev_std = 0.711)
SUFF_SIMPLE for r=0.6 class 2 = 0.547 +- 0.285 (in-sample avg dev_std = 0.711)
SUFF_SIMPLE for r=0.6 all KL = 0.48 +- 0.285 (in-sample avg dev_std = 0.711)
SUFF_SIMPLE for r=0.6 all L1 = 0.576 +- 0.243 (in-sample avg dev_std = 0.711)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3549536666666666
len(reference) = 2665
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.271
SUFF_SIMPLE for r=0.9 class 0 = 0.368 +- 0.389 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.9 class 1 = 0.45 +- 0.389 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.9 class 2 = 0.357 +- 0.389 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.9 all KL = 0.333 +- 0.389 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.339 (in-sample avg dev_std = 0.126)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1816133333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0 = 0.37 +- 0.316 (in-sample avg dev_std = 0.678)
NEC for r=0.3 class 1 = 0.226 +- 0.316 (in-sample avg dev_std = 0.678)
NEC for r=0.3 class 2 = 0.374 +- 0.316 (in-sample avg dev_std = 0.678)
NEC for r=0.3 all KL = 0.421 +- 0.316 (in-sample avg dev_std = 0.678)
NEC for r=0.3 all L1 = 0.323 +- 0.254 (in-sample avg dev_std = 0.678)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25266666666666665
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.689
NEC for r=0.6 class 0 = 0.385 +- 0.289 (in-sample avg dev_std = 0.719)
NEC for r=0.6 class 1 = 0.242 +- 0.289 (in-sample avg dev_std = 0.719)
NEC for r=0.6 class 2 = 0.399 +- 0.289 (in-sample avg dev_std = 0.719)
NEC for r=0.6 all KL = 0.45 +- 0.289 (in-sample avg dev_std = 0.719)
NEC for r=0.6 all L1 = 0.342 +- 0.233 (in-sample avg dev_std = 0.719)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29447033333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.688
NEC for r=0.9 class 0 = 0.386 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 1 = 0.25 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 2 = 0.404 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all KL = 0.459 +- 0.279 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all L1 = 0.347 +- 0.223 (in-sample avg dev_std = 0.734)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21388133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0 = 0.51 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 class 1 = 0.229 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 class 2 = 0.351 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 all KL = 0.446 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 all L1 = 0.364 +- 0.260 (in-sample avg dev_std = 0.658)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3259273333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.622
NEC for r=0.6 class 0 = 0.525 +- 0.268 (in-sample avg dev_std = 0.718)
NEC for r=0.6 class 1 = 0.255 +- 0.268 (in-sample avg dev_std = 0.718)
NEC for r=0.6 class 2 = 0.419 +- 0.268 (in-sample avg dev_std = 0.718)
NEC for r=0.6 all KL = 0.498 +- 0.268 (in-sample avg dev_std = 0.718)
NEC for r=0.6 all L1 = 0.4 +- 0.227 (in-sample avg dev_std = 0.718)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3549536666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.627
NEC for r=0.9 class 0 = 0.522 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 class 1 = 0.24 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 class 2 = 0.426 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 all KL = 0.497 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 all L1 = 0.397 +- 0.218 (in-sample avg dev_std = 0.724)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:02:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:02:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.209
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.363


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18593866666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.681
SUFF_SIMPLE for r=0.3 class 0 = 0.6 +- 0.295 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 class 1 = 0.762 +- 0.295 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 class 2 = 0.599 +- 0.295 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 all KL = 0.543 +- 0.295 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 all L1 = 0.654 +- 0.239 (in-sample avg dev_std = 0.720)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25253366666666666
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.673
SUFF_SIMPLE for r=0.6 class 0 = 0.601 +- 0.312 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.6 class 1 = 0.759 +- 0.312 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.6 class 2 = 0.6 +- 0.312 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.6 all KL = 0.547 +- 0.312 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.6 all L1 = 0.654 +- 0.255 (in-sample avg dev_std = 0.696)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947846666666667
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.682
SUFF_SIMPLE for r=0.9 class 0 = 0.682 +- 0.402 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 class 1 = 0.813 +- 0.402 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 class 2 = 0.677 +- 0.402 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 all KL = 0.672 +- 0.402 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.9 all L1 = 0.724 +- 0.341 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20861033333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.593
SUFF_SIMPLE for r=0.3 class 0 = 0.623 +- 0.315 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.3 class 1 = 0.818 +- 0.315 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.3 class 2 = 0.522 +- 0.315 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.3 all KL = 0.578 +- 0.315 (in-sample avg dev_std = 0.684)
SUFF_SIMPLE for r=0.3 all L1 = 0.654 +- 0.241 (in-sample avg dev_std = 0.684)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3217973333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.584
SUFF_SIMPLE for r=0.6 class 0 = 0.632 +- 0.336 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.6 class 1 = 0.815 +- 0.336 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.6 class 2 = 0.523 +- 0.336 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.6 all KL = 0.587 +- 0.336 (in-sample avg dev_std = 0.653)
SUFF_SIMPLE for r=0.6 all L1 = 0.656 +- 0.262 (in-sample avg dev_std = 0.653)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.828
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634806666666667
len(reference) = 2745
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.494
SUFF_SIMPLE for r=0.9 class 0 = 0.65 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 class 1 = 0.677 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 class 2 = 0.525 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 all KL = 0.607 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.9 all L1 = 0.615 +- 0.360 (in-sample avg dev_std = 0.152)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18593866666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.682
NEC for r=0.3 class 0 = 0.393 +- 0.317 (in-sample avg dev_std = 0.685)
NEC for r=0.3 class 1 = 0.234 +- 0.317 (in-sample avg dev_std = 0.685)
NEC for r=0.3 class 2 = 0.383 +- 0.317 (in-sample avg dev_std = 0.685)
NEC for r=0.3 all KL = 0.439 +- 0.317 (in-sample avg dev_std = 0.685)
NEC for r=0.3 all L1 = 0.336 +- 0.258 (in-sample avg dev_std = 0.685)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25253366666666666
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.679
NEC for r=0.6 class 0 = 0.397 +- 0.288 (in-sample avg dev_std = 0.724)
NEC for r=0.6 class 1 = 0.251 +- 0.288 (in-sample avg dev_std = 0.724)
NEC for r=0.6 class 2 = 0.397 +- 0.288 (in-sample avg dev_std = 0.724)
NEC for r=0.6 all KL = 0.462 +- 0.288 (in-sample avg dev_std = 0.724)
NEC for r=0.6 all L1 = 0.348 +- 0.234 (in-sample avg dev_std = 0.724)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947846666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.678
NEC for r=0.9 class 0 = 0.407 +- 0.280 (in-sample avg dev_std = 0.736)
NEC for r=0.9 class 1 = 0.248 +- 0.280 (in-sample avg dev_std = 0.736)
NEC for r=0.9 class 2 = 0.406 +- 0.280 (in-sample avg dev_std = 0.736)
NEC for r=0.9 all KL = 0.47 +- 0.280 (in-sample avg dev_std = 0.736)
NEC for r=0.9 all L1 = 0.353 +- 0.227 (in-sample avg dev_std = 0.736)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20861033333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.645
NEC for r=0.3 class 0 = 0.336 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 class 1 = 0.152 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 class 2 = 0.343 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 all KL = 0.337 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 all L1 = 0.277 +- 0.250 (in-sample avg dev_std = 0.606)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3217973333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.626
NEC for r=0.6 class 0 = 0.354 +- 0.306 (in-sample avg dev_std = 0.662)
NEC for r=0.6 class 1 = 0.165 +- 0.306 (in-sample avg dev_std = 0.662)
NEC for r=0.6 class 2 = 0.41 +- 0.306 (in-sample avg dev_std = 0.662)
NEC for r=0.6 all KL = 0.382 +- 0.306 (in-sample avg dev_std = 0.662)
NEC for r=0.6 all L1 = 0.31 +- 0.233 (in-sample avg dev_std = 0.662)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634806666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.621
NEC for r=0.9 class 0 = 0.359 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 class 1 = 0.165 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 class 2 = 0.424 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 all KL = 0.393 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 all L1 = 0.317 +- 0.230 (in-sample avg dev_std = 0.675)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:05:11 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:05:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.255
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.297
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.183873
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
SUFF_SIMPLE for r=0.3 class 0 = 0.625 +- 0.288 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 class 1 = 0.759 +- 0.288 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 class 2 = 0.606 +- 0.288 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 all KL = 0.552 +- 0.288 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 all L1 = 0.663 +- 0.231 (in-sample avg dev_std = 0.719)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.254652
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.69
SUFF_SIMPLE for r=0.6 class 0 = 0.632 +- 0.311 (in-sample avg dev_std = 0.688)
SUFF_SIMPLE for r=0.6 class 1 = 0.762 +- 0.311 (in-sample avg dev_std = 0.688)
SUFF_SIMPLE for r=0.6 class 2 = 0.614 +- 0.311 (in-sample avg dev_std = 0.688)
SUFF_SIMPLE for r=0.6 all KL = 0.567 +- 0.311 (in-sample avg dev_std = 0.688)
SUFF_SIMPLE for r=0.6 all L1 = 0.669 +- 0.251 (in-sample avg dev_std = 0.688)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.297082
len(reference) = 2702
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.702
SUFF_SIMPLE for r=0.9 class 0 = 0.722 +- 0.391 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.9 class 1 = 0.813 +- 0.391 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.9 class 2 = 0.708 +- 0.391 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.9 all KL = 0.698 +- 0.391 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.9 all L1 = 0.748 +- 0.332 (in-sample avg dev_std = 0.411)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20652433333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.391
SUFF_SIMPLE for r=0.3 class 0 = 0.892 +- 0.203 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.3 class 1 = 0.892 +- 0.203 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.3 class 2 = 0.964 +- 0.203 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.3 all KL = 0.915 +- 0.203 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.3 all L1 = 0.916 +- 0.194 (in-sample avg dev_std = 0.257)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321243
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.392
SUFF_SIMPLE for r=0.6 class 0 = 0.901 +- 0.200 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.6 class 1 = 0.896 +- 0.200 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.6 class 2 = 0.962 +- 0.200 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.6 all KL = 0.921 +- 0.200 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.6 all L1 = 0.92 +- 0.194 (in-sample avg dev_std = 0.237)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.424
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35940666666666665
len(reference) = 2678
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.366
SUFF_SIMPLE for r=0.9 class 0 = 0.914 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.924 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.963 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.937 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.933 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.183873
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.696
NEC for r=0.3 class 0 = 0.372 +- 0.314 (in-sample avg dev_std = 0.684)
NEC for r=0.3 class 1 = 0.223 +- 0.314 (in-sample avg dev_std = 0.684)
NEC for r=0.3 class 2 = 0.376 +- 0.314 (in-sample avg dev_std = 0.684)
NEC for r=0.3 all KL = 0.424 +- 0.314 (in-sample avg dev_std = 0.684)
NEC for r=0.3 all L1 = 0.324 +- 0.253 (in-sample avg dev_std = 0.684)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.254652
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.694
NEC for r=0.6 class 0 = 0.379 +- 0.289 (in-sample avg dev_std = 0.716)
NEC for r=0.6 class 1 = 0.23 +- 0.289 (in-sample avg dev_std = 0.716)
NEC for r=0.6 class 2 = 0.398 +- 0.289 (in-sample avg dev_std = 0.716)
NEC for r=0.6 all KL = 0.445 +- 0.289 (in-sample avg dev_std = 0.716)
NEC for r=0.6 all L1 = 0.336 +- 0.232 (in-sample avg dev_std = 0.716)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.297082
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0 = 0.386 +- 0.278 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 1 = 0.239 +- 0.278 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 2 = 0.393 +- 0.278 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all KL = 0.452 +- 0.278 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all L1 = 0.339 +- 0.223 (in-sample avg dev_std = 0.728)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20652433333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.101 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 1 = 0.104 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 2 = 0.033 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.078 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.079 +- 0.193 (in-sample avg dev_std = 0.231)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321243
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.393
NEC for r=0.6 class 0 = 0.106 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 1 = 0.111 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 2 = 0.033 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all KL = 0.084 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all L1 = 0.083 +- 0.193 (in-sample avg dev_std = 0.255)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.437
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35940666666666665
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.395
NEC for r=0.9 class 0 = 0.104 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.114 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.035 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.085 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.084 +- 0.193 (in-sample avg dev_std = 0.259)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.542, 0.554, 0.693], 'all_L1': [0.653, 0.658, 0.741]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.54, 0.663], 'all_L1': [0.63, 0.638, 0.711]}), defaultdict(<class 'list'>, {'all_KL': [0.544, 0.56, 0.684], 'all_L1': [0.656, 0.663, 0.735]}), defaultdict(<class 'list'>, {'all_KL': [0.541, 0.549, 0.681], 'all_L1': [0.653, 0.654, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.55, 0.672], 'all_L1': [0.639, 0.643, 0.721]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.545, 0.676], 'all_L1': [0.629, 0.646, 0.725]}), defaultdict(<class 'list'>, {'all_KL': [0.517, 0.534, 0.669], 'all_L1': [0.628, 0.637, 0.719]}), defaultdict(<class 'list'>, {'all_KL': [0.544, 0.565, 0.702], 'all_L1': [0.653, 0.666, 0.746]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.547, 0.672], 'all_L1': [0.654, 0.654, 0.724]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.567, 0.698], 'all_L1': [0.663, 0.669, 0.748]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.42, 0.452, 0.464], 'all_L1': [0.323, 0.343, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.452, 0.471, 0.484], 'all_L1': [0.357, 0.367, 0.376]}), defaultdict(<class 'list'>, {'all_KL': [0.427, 0.453, 0.457], 'all_L1': [0.326, 0.342, 0.343]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.457, 0.466], 'all_L1': [0.331, 0.346, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.456, 0.468], 'all_L1': [0.346, 0.356, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.471, 0.477], 'all_L1': [0.345, 0.362, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.455, 0.466, 0.479], 'all_L1': [0.355, 0.359, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.45, 0.459], 'all_L1': [0.323, 0.342, 0.347]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.462, 0.47], 'all_L1': [0.336, 0.348, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.424, 0.445, 0.452], 'all_L1': [0.324, 0.336, 0.339]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.62, 0.625, 0.577], 'all_L1': [0.647, 0.65, 0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.529, 0.594], 'all_L1': [0.601, 0.604, 0.614]}), defaultdict(<class 'list'>, {'all_KL': [0.566, 0.569, 0.622], 'all_L1': [0.666, 0.661, 0.659]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.607, 0.625], 'all_L1': [0.681, 0.69, 0.663]}), defaultdict(<class 'list'>, {'all_KL': [0.661, 0.674, 0.745], 'all_L1': [0.729, 0.735, 0.764]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.599, 0.543], 'all_L1': [0.651, 0.664, 0.581]}), defaultdict(<class 'list'>, {'all_KL': [0.648, 0.665, 0.708], 'all_L1': [0.722, 0.732, 0.735]}), defaultdict(<class 'list'>, {'all_KL': [0.461, 0.48, 0.333], 'all_L1': [0.566, 0.576, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.587, 0.607], 'all_L1': [0.654, 0.656, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.915, 0.921, 0.937], 'all_L1': [0.916, 0.92, 0.933]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.306, 0.349, 0.348], 'all_L1': [0.293, 0.326, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.392, 0.449, 0.451], 'all_L1': [0.334, 0.375, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.385, 0.406], 'all_L1': [0.278, 0.296, 0.31]}), defaultdict(<class 'list'>, {'all_KL': [0.354, 0.386, 0.396], 'all_L1': [0.28, 0.3, 0.305]}), defaultdict(<class 'list'>, {'all_KL': [0.302, 0.323, 0.331], 'all_L1': [0.246, 0.259, 0.263]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.385, 0.382], 'all_L1': [0.286, 0.319, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.301, 0.336, 0.336], 'all_L1': [0.242, 0.264, 0.264]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.498, 0.497], 'all_L1': [0.364, 0.4, 0.397]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.382, 0.393], 'all_L1': [0.277, 0.31, 0.317]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.084, 0.085], 'all_L1': [0.079, 0.083, 0.084]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.646 +- 0.012, 0.653 +- 0.011, 0.730 +- 0.012
suff_simple class all_KL  =  0.536 +- 0.011, 0.551 +- 0.010, 0.681 +- 0.012
[[0.6850833296775818, 0.6796666383743286, 0.7025893926620483], [0.6570416688919067, 0.6589999794960022, 0.669623076915741], [0.6886249780654907, 0.6840000152587891, 0.6907602548599243], [0.6796249747276306, 0.668958306312561, 0.6929638385772705], [0.6602916717529297, 0.6549999713897705, 0.6766314506530762], [0.6585416793823242, 0.6645416617393494, 0.6852381825447083], [0.6586666703224182, 0.6596666574478149, 0.6785120368003845], [0.6846250295639038, 0.6857500076293945, 0.7020364999771118], [0.6813333630561829, 0.6727083325386047, 0.6824087500572205], [0.6921666860580444, 0.6899999976158142, 0.7019799947738647]]
[[0.542, 0.554, 0.693], [0.526, 0.54, 0.663], [0.544, 0.56, 0.684], [0.541, 0.549, 0.681], [0.538, 0.55, 0.672], [0.518, 0.545, 0.676], [0.517, 0.534, 0.669], [0.544, 0.565, 0.702], [0.543, 0.547, 0.672], [0.552, 0.567, 0.698]]
suff_simple_acc_int  =  0.675 +- 0.013, 0.672 +- 0.012, 0.688 +- 0.011
nec class all_L1  =  0.337 +- 0.013, 0.350 +- 0.010, 0.356 +- 0.011
nec class all_KL  =  0.435 +- 0.012, 0.458 +- 0.008, 0.468 +- 0.010
[[0.6974583268165588, 0.6875, 0.6822083592414856], [0.6620416641235352, 0.6640416383743286, 0.6577083468437195], [0.6919166445732117, 0.6885833144187927, 0.6939166784286499], [0.6838750243186951, 0.6809166669845581, 0.6792083382606506], [0.6638333201408386, 0.6618750095367432, 0.6590416431427002], [0.6725833415985107, 0.6675833463668823, 0.6663749814033508], [0.6643750071525574, 0.6707916855812073, 0.6699166893959045], [0.6928333044052124, 0.6887916922569275, 0.687583327293396], [0.6819583177566528, 0.6791250109672546, 0.6783750057220459], [0.6960833072662354, 0.6935833096504211, 0.6935416460037231]]
[[0.42, 0.452, 0.464], [0.452, 0.471, 0.484], [0.427, 0.453, 0.457], [0.433, 0.457, 0.466], [0.438, 0.456, 0.468], [0.444, 0.471, 0.477], [0.455, 0.466, 0.479], [0.421, 0.45, 0.459], [0.439, 0.462, 0.47], [0.424, 0.445, 0.452]]
nec_acc_int  =  0.681 +- 0.013, 0.678 +- 0.011, 0.677 +- 0.013

Eval split val
suff_simple class all_L1  =  0.683 +- 0.090, 0.689 +- 0.090, 0.652 +- 0.135
suff_simple class all_KL  =  0.614 +- 0.115, 0.626 +- 0.113, 0.629 +- 0.146
[[0.5580000281333923, 0.546708345413208, 0.444104939699173], [0.46908333897590637, 0.4703333377838135, 0.34781646728515625], [0.593416690826416, 0.578166663646698, 0.4696454703807831], [0.5103333592414856, 0.5115416646003723, 0.3670874238014221], [0.4737499952316284, 0.47325000166893005, 0.44447454810142517], [0.5732083320617676, 0.5731250047683716, 0.35822147130966187], [0.5006250143051147, 0.5077083110809326, 0.37365540862083435], [0.590458333492279, 0.5872499942779541, 0.27082550525665283], [0.5931666493415833, 0.5837916731834412, 0.4936247766017914], [0.39116665720939636, 0.39154165983200073, 0.36631813645362854]]
[[0.62, 0.625, 0.577], [0.52, 0.529, 0.594], [0.566, 0.569, 0.622], [0.589, 0.607, 0.625], [0.661, 0.674, 0.745], [0.578, 0.599, 0.543], [0.648, 0.665, 0.708], [0.461, 0.48, 0.333], [0.578, 0.587, 0.607], [0.915, 0.921, 0.937]]
suff_simple_acc_int  =  0.525 +- 0.064, 0.522 +- 0.061, 0.394 +- 0.064
nec class all_L1  =  0.268 +- 0.072, 0.293 +- 0.081, 0.295 +- 0.081
nec class all_KL  =  0.321 +- 0.091, 0.358 +- 0.104, 0.362 +- 0.104
[[0.5880833268165588, 0.5732083320617676, 0.5768333077430725], [0.515625, 0.4905416667461395, 0.49908334016799927], [0.62479168176651, 0.6173750162124634, 0.6114166378974915], [0.5364583134651184, 0.5248333215713501, 0.5283750295639038], [0.4856249988079071, 0.48362499475479126, 0.48362499475479126], [0.6148750185966492, 0.5929583311080933, 0.6036666631698608], [0.5278333425521851, 0.5137916803359985, 0.518666684627533], [0.6440416574478149, 0.6221250295639038, 0.6270833611488342], [0.6445833444595337, 0.6256250143051147, 0.6205416917800903], [0.39529165625572205, 0.3934583365917206, 0.3948749899864197]]
[[0.306, 0.349, 0.348], [0.392, 0.449, 0.451], [0.356, 0.385, 0.406], [0.354, 0.386, 0.396], [0.302, 0.323, 0.331], [0.337, 0.385, 0.382], [0.301, 0.336, 0.336], [0.446, 0.498, 0.497], [0.337, 0.382, 0.393], [0.078, 0.084, 0.085]]
nec_acc_int  =  0.558 +- 0.076, 0.544 +- 0.072, 0.546 +- 0.071


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.491 +- 0.003, 0.501 +- 0.002, 0.543 +- 0.003
Faith. Armon (L1)= 		  =  0.442 +- 0.008, 0.456 +- 0.006, 0.478 +- 0.008
Faith. GMean (L1)= 	  =  0.466 +- 0.005, 0.478 +- 0.003, 0.510 +- 0.005
Faith. Aritm (KL)= 		  =  0.486 +- 0.003, 0.505 +- 0.002, 0.574 +- 0.003
Faith. Armon (KL)= 		  =  0.480 +- 0.004, 0.500 +- 0.002, 0.554 +- 0.004
Faith. GMean (KL)= 	  =  0.483 +- 0.004, 0.502 +- 0.002, 0.564 +- 0.003

Eval split val
Faith. Aritm (L1)= 		  =  0.476 +- 0.010, 0.491 +- 0.007, 0.474 +- 0.035
Faith. Armon (L1)= 		  =  0.373 +- 0.079, 0.397 +- 0.086, 0.387 +- 0.080
Faith. GMean (L1)= 	  =  0.417 +- 0.050, 0.438 +- 0.056, 0.424 +- 0.052
Faith. Aritm (KL)= 		  =  0.467 +- 0.013, 0.492 +- 0.008, 0.496 +- 0.036
Faith. Armon (KL)= 		  =  0.401 +- 0.087, 0.432 +- 0.094, 0.432 +- 0.097
Faith. GMean (KL)= 	  =  0.428 +- 0.054, 0.457 +- 0.060, 0.458 +- 0.066
Computed for split load_split = id



Completed in  0:22:59.852448  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GL-GSAT temp GOODMotif/basis/covariate NEC_ALPHA 0.01 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:08:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:08:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5775376666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.571
SUFF_SIMPLE for r=0.3 class 0 = 0.328 +- 0.358 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.3 class 1 = 0.759 +- 0.358 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.3 class 2 = 0.526 +- 0.358 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.3 all KL = 0.496 +- 0.358 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.3 all L1 = 0.541 +- 0.288 (in-sample avg dev_std = 0.447)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4840433333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.674
SUFF_SIMPLE for r=0.6 class 0 = 0.369 +- 0.346 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.6 class 1 = 0.788 +- 0.346 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.6 class 2 = 0.775 +- 0.346 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.6 all KL = 0.64 +- 0.346 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.6 all L1 = 0.65 +- 0.286 (in-sample avg dev_std = 0.353)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34274733333333335
len(reference) = 2632
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF_SIMPLE for r=0.9 class 0 = 0.793 +- 0.197 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 class 1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 class 2 = 0.91 +- 0.197 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 all KL = 0.92 +- 0.197 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 all L1 = 0.876 +- 0.187 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.782935
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.569
SUFF_SIMPLE for r=0.3 class 0 = 0.464 +- 0.276 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 1 = 0.833 +- 0.276 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 2 = 0.561 +- 0.276 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all KL = 0.678 +- 0.276 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all L1 = 0.618 +- 0.229 (in-sample avg dev_std = 0.331)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934813333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.631
SUFF_SIMPLE for r=0.6 class 0 = 0.536 +- 0.236 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.6 class 1 = 0.907 +- 0.236 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.6 class 2 = 0.703 +- 0.236 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.6 all KL = 0.807 +- 0.236 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.6 all L1 = 0.714 +- 0.218 (in-sample avg dev_std = 0.014)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.567
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.477399
len(reference) = 1306
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
SUFF_SIMPLE for r=0.9 class 0 = 0.908 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.934 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.919 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.983 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.916 +- 0.091 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5775376666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.261
NEC for r=0.3 class 0 = 0.688 +- 0.160 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 1 = 0.695 +- 0.160 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 2 = 0.757 +- 0.160 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all KL = 0.811 +- 0.160 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all L1 = 0.714 +- 0.118 (in-sample avg dev_std = 0.494)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4840433333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.675 +- 0.205 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 1 = 0.562 +- 0.205 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 2 = 0.692 +- 0.205 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all KL = 0.739 +- 0.205 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all L1 = 0.643 +- 0.163 (in-sample avg dev_std = 0.595)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34274733333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.47
NEC for r=0.9 class 0 = 0.644 +- 0.230 (in-sample avg dev_std = 0.649)
NEC for r=0.9 class 1 = 0.488 +- 0.230 (in-sample avg dev_std = 0.649)
NEC for r=0.9 class 2 = 0.615 +- 0.230 (in-sample avg dev_std = 0.649)
NEC for r=0.9 all KL = 0.678 +- 0.230 (in-sample avg dev_std = 0.649)
NEC for r=0.9 all L1 = 0.582 +- 0.180 (in-sample avg dev_std = 0.649)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.782935
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.283
NEC for r=0.3 class 0 = 0.509 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 1 = 0.466 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 2 = 0.666 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 all KL = 0.516 +- 0.264 (in-sample avg dev_std = 0.239)
NEC for r=0.3 all L1 = 0.547 +- 0.200 (in-sample avg dev_std = 0.239)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934813333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.47
NEC for r=0.6 class 0 = 0.409 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 1 = 0.29 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 class 2 = 0.5 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all KL = 0.366 +- 0.274 (in-sample avg dev_std = 0.422)
NEC for r=0.6 all L1 = 0.4 +- 0.214 (in-sample avg dev_std = 0.422)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.477399
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.361 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 class 1 = 0.227 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 class 2 = 0.451 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 all KL = 0.302 +- 0.235 (in-sample avg dev_std = 0.437)
NEC for r=0.9 all L1 = 0.347 +- 0.190 (in-sample avg dev_std = 0.437)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:10:37 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:10:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.592697
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.656
SUFF_SIMPLE for r=0.3 class 0 = 0.397 +- 0.314 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 class 1 = 0.645 +- 0.314 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 class 2 = 0.708 +- 0.314 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 all KL = 0.609 +- 0.314 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.3 all L1 = 0.587 +- 0.243 (in-sample avg dev_std = 0.348)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.488279
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.681
SUFF_SIMPLE for r=0.6 class 0 = 0.435 +- 0.332 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 class 1 = 0.659 +- 0.332 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 class 2 = 0.809 +- 0.332 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 all KL = 0.666 +- 0.332 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 all L1 = 0.639 +- 0.265 (in-sample avg dev_std = 0.288)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.351097
len(reference) = 2631
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF_SIMPLE for r=0.9 class 0 = 0.79 +- 0.185 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.9 class 1 = 0.866 +- 0.185 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.9 class 2 = 0.888 +- 0.185 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.9 all KL = 0.912 +- 0.185 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.9 all L1 = 0.851 +- 0.182 (in-sample avg dev_std = 0.033)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7830843333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.653
SUFF_SIMPLE for r=0.3 class 0 = 0.431 +- 0.229 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.3 class 1 = 0.699 +- 0.229 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.3 class 2 = 0.472 +- 0.229 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.3 all KL = 0.556 +- 0.229 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.3 all L1 = 0.533 +- 0.197 (in-sample avg dev_std = 0.212)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6946836666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.657
SUFF_SIMPLE for r=0.6 class 0 = 0.458 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.657 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.498 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.546 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.537 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48258500000000004
len(reference) = 18
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF_SIMPLE for r=0.9 class 1 = 0.971 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.971 +- 0.007 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.592697
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.256
NEC for r=0.3 class 0 = 0.717 +- 0.158 (in-sample avg dev_std = 0.437)
NEC for r=0.3 class 1 = 0.658 +- 0.158 (in-sample avg dev_std = 0.437)
NEC for r=0.3 class 2 = 0.746 +- 0.158 (in-sample avg dev_std = 0.437)
NEC for r=0.3 all KL = 0.768 +- 0.158 (in-sample avg dev_std = 0.437)
NEC for r=0.3 all L1 = 0.707 +- 0.107 (in-sample avg dev_std = 0.437)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.488279
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.421
NEC for r=0.6 class 0 = 0.663 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.534 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.652 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.66 +- 0.205 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.616 +- 0.145 (in-sample avg dev_std = 0.546)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.351097
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.516
NEC for r=0.9 class 0 = 0.609 +- 0.232 (in-sample avg dev_std = 0.579)
NEC for r=0.9 class 1 = 0.46 +- 0.232 (in-sample avg dev_std = 0.579)
NEC for r=0.9 class 2 = 0.572 +- 0.232 (in-sample avg dev_std = 0.579)
NEC for r=0.9 all KL = 0.58 +- 0.232 (in-sample avg dev_std = 0.579)
NEC for r=0.9 all L1 = 0.546 +- 0.167 (in-sample avg dev_std = 0.579)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7830843333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.676 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 1 = 0.362 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 class 2 = 0.536 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all KL = 0.427 +- 0.256 (in-sample avg dev_std = 0.176)
NEC for r=0.3 all L1 = 0.526 +- 0.219 (in-sample avg dev_std = 0.176)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6946836666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.528
NEC for r=0.6 class 0 = 0.497 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.228 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.455 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.3 +- 0.240 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.394 +- 0.211 (in-sample avg dev_std = 0.407)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48258500000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.614
NEC for r=0.9 class 0 = 0.421 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 1 = 0.186 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 2 = 0.409 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all KL = 0.241 +- 0.195 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all L1 = 0.339 +- 0.179 (in-sample avg dev_std = 0.419)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:12:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:12:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5832693333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.613
SUFF_SIMPLE for r=0.3 class 0 = 0.36 +- 0.337 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.3 class 1 = 0.611 +- 0.337 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.3 class 2 = 0.701 +- 0.337 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.3 all KL = 0.559 +- 0.337 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.3 all L1 = 0.562 +- 0.262 (in-sample avg dev_std = 0.376)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48694733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.68
SUFF_SIMPLE for r=0.6 class 0 = 0.393 +- 0.342 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.6 class 1 = 0.647 +- 0.342 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.6 class 2 = 0.797 +- 0.342 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.6 all KL = 0.622 +- 0.342 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.6 all L1 = 0.617 +- 0.275 (in-sample avg dev_std = 0.316)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3473106666666666
len(reference) = 2449
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.897
SUFF_SIMPLE for r=0.9 class 0 = 0.824 +- 0.159 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 class 1 = 0.866 +- 0.159 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 class 2 = 0.876 +- 0.159 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 all KL = 0.921 +- 0.159 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 all L1 = 0.856 +- 0.161 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7835050000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.624
SUFF_SIMPLE for r=0.3 class 0 = 0.372 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.3 class 1 = 0.554 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.3 class 2 = 0.518 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.3 all KL = 0.569 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.3 all L1 = 0.481 +- 0.133 (in-sample avg dev_std = 0.201)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.697728
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.606
SUFF_SIMPLE for r=0.6 class 0 = 0.359 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.508 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.53 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.541 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.465 +- 0.160 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5832693333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.272
NEC for r=0.3 class 0 = 0.697 +- 0.161 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 1 = 0.655 +- 0.161 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 2 = 0.755 +- 0.161 (in-sample avg dev_std = 0.466)
NEC for r=0.3 all KL = 0.775 +- 0.161 (in-sample avg dev_std = 0.466)
NEC for r=0.3 all L1 = 0.703 +- 0.115 (in-sample avg dev_std = 0.466)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48694733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.666 +- 0.207 (in-sample avg dev_std = 0.559)
NEC for r=0.6 class 1 = 0.532 +- 0.207 (in-sample avg dev_std = 0.559)
NEC for r=0.6 class 2 = 0.674 +- 0.207 (in-sample avg dev_std = 0.559)
NEC for r=0.6 all KL = 0.686 +- 0.207 (in-sample avg dev_std = 0.559)
NEC for r=0.6 all L1 = 0.624 +- 0.150 (in-sample avg dev_std = 0.559)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3473106666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.526
NEC for r=0.9 class 0 = 0.615 +- 0.228 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 1 = 0.453 +- 0.228 (in-sample avg dev_std = 0.602)
NEC for r=0.9 class 2 = 0.588 +- 0.228 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all KL = 0.604 +- 0.228 (in-sample avg dev_std = 0.602)
NEC for r=0.9 all L1 = 0.552 +- 0.167 (in-sample avg dev_std = 0.602)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7835050000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.388 +- 0.264 (in-sample avg dev_std = 0.152)
NEC for r=0.3 class 1 = 0.262 +- 0.264 (in-sample avg dev_std = 0.152)
NEC for r=0.3 class 2 = 0.589 +- 0.264 (in-sample avg dev_std = 0.152)
NEC for r=0.3 all KL = 0.32 +- 0.264 (in-sample avg dev_std = 0.152)
NEC for r=0.3 all L1 = 0.413 +- 0.246 (in-sample avg dev_std = 0.152)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.697728
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.355 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 1 = 0.191 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 class 2 = 0.473 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 all KL = 0.234 +- 0.223 (in-sample avg dev_std = 0.325)
NEC for r=0.6 all L1 = 0.34 +- 0.204 (in-sample avg dev_std = 0.325)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4849546666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.569
NEC for r=0.9 class 0 = 0.315 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 class 1 = 0.166 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 class 2 = 0.423 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 all KL = 0.188 +- 0.176 (in-sample avg dev_std = 0.333)
NEC for r=0.9 all L1 = 0.302 +- 0.168 (in-sample avg dev_std = 0.333)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:15:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:15:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5827426666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.646
SUFF_SIMPLE for r=0.3 class 0 = 0.391 +- 0.326 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.3 class 1 = 0.682 +- 0.326 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.3 class 2 = 0.668 +- 0.326 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.3 all KL = 0.596 +- 0.326 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.3 all L1 = 0.584 +- 0.250 (in-sample avg dev_std = 0.364)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.47364300000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.702
SUFF_SIMPLE for r=0.6 class 0 = 0.409 +- 0.332 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 1 = 0.729 +- 0.332 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 2 = 0.733 +- 0.332 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all KL = 0.645 +- 0.332 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all L1 = 0.628 +- 0.261 (in-sample avg dev_std = 0.314)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34096933333333335
len(reference) = 2658
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.889
SUFF_SIMPLE for r=0.9 class 0 = 0.777 +- 0.173 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 class 1 = 0.917 +- 0.173 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 class 2 = 0.871 +- 0.173 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 all KL = 0.915 +- 0.173 (in-sample avg dev_std = 0.042)
SUFF_SIMPLE for r=0.9 all L1 = 0.857 +- 0.179 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821599999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.629
SUFF_SIMPLE for r=0.3 class 0 = 0.389 +- 0.203 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.203 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.3 class 2 = 0.599 +- 0.203 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.3 all KL = 0.663 +- 0.203 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.3 all L1 = 0.525 +- 0.132 (in-sample avg dev_std = 0.185)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6963326666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.609
SUFF_SIMPLE for r=0.6 class 0 = 0.357 +- 0.230 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 class 1 = 0.578 +- 0.230 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 class 2 = 0.619 +- 0.230 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all KL = 0.643 +- 0.230 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.6 all L1 = 0.518 +- 0.156 (in-sample avg dev_std = 0.001)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4825026666666667
len(reference) = 72
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.917
SUFF_SIMPLE for r=0.9 class 0 = 0.96 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.954 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.96 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.96 +- 0.002 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5827426666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.245
NEC for r=0.3 class 0 = 0.71 +- 0.142 (in-sample avg dev_std = 0.491)
NEC for r=0.3 class 1 = 0.693 +- 0.142 (in-sample avg dev_std = 0.491)
NEC for r=0.3 class 2 = 0.737 +- 0.142 (in-sample avg dev_std = 0.491)
NEC for r=0.3 all KL = 0.802 +- 0.142 (in-sample avg dev_std = 0.491)
NEC for r=0.3 all L1 = 0.714 +- 0.107 (in-sample avg dev_std = 0.491)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.47364300000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.401
NEC for r=0.6 class 0 = 0.663 +- 0.194 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 1 = 0.571 +- 0.194 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 2 = 0.655 +- 0.194 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all KL = 0.706 +- 0.194 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all L1 = 0.629 +- 0.148 (in-sample avg dev_std = 0.579)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34096933333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.499
NEC for r=0.9 class 0 = 0.602 +- 0.222 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 1 = 0.476 +- 0.222 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 2 = 0.589 +- 0.222 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all KL = 0.619 +- 0.222 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all L1 = 0.556 +- 0.171 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821599999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.669 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 class 1 = 0.467 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 class 2 = 0.652 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 all KL = 0.488 +- 0.189 (in-sample avg dev_std = 0.234)
NEC for r=0.3 all L1 = 0.597 +- 0.138 (in-sample avg dev_std = 0.234)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6963326666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.592
NEC for r=0.6 class 0 = 0.505 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 class 1 = 0.311 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 class 2 = 0.474 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 all KL = 0.321 +- 0.208 (in-sample avg dev_std = 0.431)
NEC for r=0.6 all L1 = 0.43 +- 0.167 (in-sample avg dev_std = 0.431)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4825026666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.68
NEC for r=0.9 class 0 = 0.439 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 class 1 = 0.256 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 class 2 = 0.416 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 all KL = 0.254 +- 0.169 (in-sample avg dev_std = 0.427)
NEC for r=0.9 all L1 = 0.371 +- 0.145 (in-sample avg dev_std = 0.427)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:16:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:16:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.534
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.449
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.534472
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.64
SUFF_SIMPLE for r=0.3 class 0 = 0.389 +- 0.323 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.3 class 1 = 0.616 +- 0.323 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.3 class 2 = 0.709 +- 0.323 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.3 all KL = 0.579 +- 0.323 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.3 all L1 = 0.576 +- 0.245 (in-sample avg dev_std = 0.375)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44942833333333326
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.667
SUFF_SIMPLE for r=0.6 class 0 = 0.418 +- 0.344 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 class 1 = 0.635 +- 0.344 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 class 2 = 0.799 +- 0.344 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 all KL = 0.638 +- 0.344 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 all L1 = 0.622 +- 0.269 (in-sample avg dev_std = 0.295)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329853
len(reference) = 2616
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF_SIMPLE for r=0.9 class 0 = 0.629 +- 0.187 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 class 1 = 0.828 +- 0.187 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 class 2 = 0.894 +- 0.187 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 all KL = 0.863 +- 0.187 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 all L1 = 0.789 +- 0.194 (in-sample avg dev_std = 0.041)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7837400000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.536
SUFF_SIMPLE for r=0.3 class 0 = 0.473 +- 0.247 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.3 class 1 = 0.649 +- 0.247 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.3 class 2 = 0.451 +- 0.247 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.3 all KL = 0.516 +- 0.247 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.3 all L1 = 0.524 +- 0.211 (in-sample avg dev_std = 0.224)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7064046666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.601
SUFF_SIMPLE for r=0.6 class 0 = 0.459 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.73 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.469 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.548 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.552 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.893
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.49540433333333334
len(reference) = 84
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.893
SUFF_SIMPLE for r=0.9 class 0 = 0.989 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.984 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.979 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.983 +- 0.009 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.534472
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.218
NEC for r=0.3 class 0 = 0.736 +- 0.161 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 1 = 0.671 +- 0.161 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 2 = 0.745 +- 0.161 (in-sample avg dev_std = 0.455)
NEC for r=0.3 all KL = 0.794 +- 0.161 (in-sample avg dev_std = 0.455)
NEC for r=0.3 all L1 = 0.717 +- 0.112 (in-sample avg dev_std = 0.455)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44942833333333326
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.391
NEC for r=0.6 class 0 = 0.659 +- 0.212 (in-sample avg dev_std = 0.565)
NEC for r=0.6 class 1 = 0.566 +- 0.212 (in-sample avg dev_std = 0.565)
NEC for r=0.6 class 2 = 0.666 +- 0.212 (in-sample avg dev_std = 0.565)
NEC for r=0.6 all KL = 0.696 +- 0.212 (in-sample avg dev_std = 0.565)
NEC for r=0.6 all L1 = 0.63 +- 0.149 (in-sample avg dev_std = 0.565)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329853
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.501
NEC for r=0.9 class 0 = 0.593 +- 0.235 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 1 = 0.504 +- 0.235 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 2 = 0.58 +- 0.235 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all KL = 0.617 +- 0.235 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all L1 = 0.559 +- 0.167 (in-sample avg dev_std = 0.611)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7837400000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.445 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 1 = 0.237 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 2 = 0.465 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all KL = 0.336 +- 0.293 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all L1 = 0.383 +- 0.278 (in-sample avg dev_std = 0.127)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7064046666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.443
NEC for r=0.6 class 0 = 0.343 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 class 1 = 0.163 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 class 2 = 0.41 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 all KL = 0.252 +- 0.254 (in-sample avg dev_std = 0.337)
NEC for r=0.6 all L1 = 0.306 +- 0.239 (in-sample avg dev_std = 0.337)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.557
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.49540433333333334
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.29 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 class 1 = 0.134 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 class 2 = 0.37 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 all KL = 0.203 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.9 all L1 = 0.265 +- 0.205 (in-sample avg dev_std = 0.343)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:18:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:18:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.569
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.345
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.479


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5692370000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.6
SUFF_SIMPLE for r=0.3 class 0 = 0.373 +- 0.349 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.3 class 1 = 0.588 +- 0.349 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.3 class 2 = 0.715 +- 0.349 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.3 all KL = 0.559 +- 0.349 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.3 all L1 = 0.563 +- 0.273 (in-sample avg dev_std = 0.357)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474551
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.624
SUFF_SIMPLE for r=0.6 class 0 = 0.397 +- 0.360 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 1 = 0.6 +- 0.360 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 2 = 0.799 +- 0.360 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all KL = 0.604 +- 0.360 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all L1 = 0.604 +- 0.289 (in-sample avg dev_std = 0.314)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3445743333333333
len(reference) = 2585
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF_SIMPLE for r=0.9 class 0 = 0.773 +- 0.223 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 class 1 = 0.858 +- 0.223 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 class 2 = 0.894 +- 0.223 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 all KL = 0.894 +- 0.223 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.9 all L1 = 0.843 +- 0.203 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821423333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.488
SUFF_SIMPLE for r=0.3 class 0 = 0.387 +- 0.215 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.3 class 1 = 0.43 +- 0.215 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.3 class 2 = 0.427 +- 0.215 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.3 all KL = 0.417 +- 0.215 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.3 all L1 = 0.415 +- 0.161 (in-sample avg dev_std = 0.173)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.693346
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.495
SUFF_SIMPLE for r=0.6 class 0 = 0.385 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.455 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.419 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.419 +- 0.217 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.419 +- 0.175 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5692370000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.251
NEC for r=0.3 class 0 = 0.723 +- 0.134 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 1 = 0.67 +- 0.134 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 2 = 0.743 +- 0.134 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all KL = 0.781 +- 0.134 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all L1 = 0.712 +- 0.100 (in-sample avg dev_std = 0.461)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474551
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.675 +- 0.182 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.569 +- 0.182 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.664 +- 0.182 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.699 +- 0.182 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.636 +- 0.145 (in-sample avg dev_std = 0.548)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3445743333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.489
NEC for r=0.9 class 0 = 0.623 +- 0.206 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 1 = 0.498 +- 0.206 (in-sample avg dev_std = 0.592)
NEC for r=0.9 class 2 = 0.578 +- 0.206 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all KL = 0.618 +- 0.206 (in-sample avg dev_std = 0.592)
NEC for r=0.9 all L1 = 0.566 +- 0.163 (in-sample avg dev_std = 0.592)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821423333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.45 +- 0.225 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 1 = 0.251 +- 0.225 (in-sample avg dev_std = 0.160)
NEC for r=0.3 class 2 = 0.461 +- 0.225 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all KL = 0.275 +- 0.225 (in-sample avg dev_std = 0.160)
NEC for r=0.3 all L1 = 0.388 +- 0.224 (in-sample avg dev_std = 0.160)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.693346
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.435
NEC for r=0.6 class 0 = 0.364 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 1 = 0.213 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 2 = 0.43 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 all KL = 0.221 +- 0.202 (in-sample avg dev_std = 0.281)
NEC for r=0.6 all L1 = 0.336 +- 0.200 (in-sample avg dev_std = 0.281)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.559
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4792123333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.501
NEC for r=0.9 class 0 = 0.313 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 class 1 = 0.187 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 class 2 = 0.402 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 all KL = 0.182 +- 0.158 (in-sample avg dev_std = 0.295)
NEC for r=0.9 all L1 = 0.301 +- 0.169 (in-sample avg dev_std = 0.295)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:20:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:20:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.460
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.342
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.694
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.484


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5559223333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.635
SUFF_SIMPLE for r=0.3 class 0 = 0.41 +- 0.326 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.3 class 1 = 0.603 +- 0.326 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.3 class 2 = 0.702 +- 0.326 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.3 all KL = 0.583 +- 0.326 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.3 all L1 = 0.575 +- 0.255 (in-sample avg dev_std = 0.370)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45966266666666666
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.668
SUFF_SIMPLE for r=0.6 class 0 = 0.44 +- 0.343 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 class 1 = 0.625 +- 0.343 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 class 2 = 0.801 +- 0.343 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 all KL = 0.641 +- 0.343 (in-sample avg dev_std = 0.296)
SUFF_SIMPLE for r=0.6 all L1 = 0.627 +- 0.276 (in-sample avg dev_std = 0.296)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34182766666666664
len(reference) = 2456
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.884
SUFF_SIMPLE for r=0.9 class 0 = 0.753 +- 0.199 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 class 1 = 0.852 +- 0.199 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 class 2 = 0.913 +- 0.199 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 all KL = 0.895 +- 0.199 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.9 all L1 = 0.842 +- 0.190 (in-sample avg dev_std = 0.041)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7827820000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.631
SUFF_SIMPLE for r=0.3 class 0 = 0.452 +- 0.222 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.3 class 1 = 0.518 +- 0.222 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.3 class 2 = 0.486 +- 0.222 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.3 all KL = 0.515 +- 0.222 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.3 all L1 = 0.485 +- 0.157 (in-sample avg dev_std = 0.269)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.694314
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.624
SUFF_SIMPLE for r=0.6 class 0 = 0.434 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.518 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.43 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.478 +- 0.218 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.461 +- 0.168 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5559223333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.221
NEC for r=0.3 class 0 = 0.738 +- 0.139 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 1 = 0.674 +- 0.139 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 2 = 0.76 +- 0.139 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all KL = 0.799 +- 0.139 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all L1 = 0.724 +- 0.101 (in-sample avg dev_std = 0.438)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45966266666666666
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.669 +- 0.188 (in-sample avg dev_std = 0.557)
NEC for r=0.6 class 1 = 0.562 +- 0.188 (in-sample avg dev_std = 0.557)
NEC for r=0.6 class 2 = 0.675 +- 0.188 (in-sample avg dev_std = 0.557)
NEC for r=0.6 all KL = 0.698 +- 0.188 (in-sample avg dev_std = 0.557)
NEC for r=0.6 all L1 = 0.635 +- 0.142 (in-sample avg dev_std = 0.557)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34182766666666664
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.602 +- 0.208 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 1 = 0.492 +- 0.208 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 2 = 0.596 +- 0.208 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all KL = 0.613 +- 0.208 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all L1 = 0.563 +- 0.157 (in-sample avg dev_std = 0.600)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7827820000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.648 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 1 = 0.307 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 class 2 = 0.492 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all KL = 0.374 +- 0.246 (in-sample avg dev_std = 0.214)
NEC for r=0.3 all L1 = 0.484 +- 0.216 (in-sample avg dev_std = 0.214)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.694314
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.523
NEC for r=0.6 class 0 = 0.455 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 1 = 0.22 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 2 = 0.446 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all KL = 0.27 +- 0.217 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all L1 = 0.374 +- 0.197 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.681
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48428000000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.607
NEC for r=0.9 class 0 = 0.381 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 1 = 0.188 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 2 = 0.415 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all KL = 0.221 +- 0.175 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all L1 = 0.328 +- 0.168 (in-sample avg dev_std = 0.396)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:21:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:21:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.553
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.441
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.480


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5528443333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.631
SUFF_SIMPLE for r=0.3 class 0 = 0.391 +- 0.316 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.3 class 1 = 0.632 +- 0.316 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.3 class 2 = 0.678 +- 0.316 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.3 all KL = 0.596 +- 0.316 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.3 all L1 = 0.571 +- 0.247 (in-sample avg dev_std = 0.355)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441395
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.678
SUFF_SIMPLE for r=0.6 class 0 = 0.464 +- 0.320 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 class 1 = 0.662 +- 0.320 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 class 2 = 0.771 +- 0.320 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 all KL = 0.67 +- 0.320 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 all L1 = 0.636 +- 0.258 (in-sample avg dev_std = 0.280)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3365766666666667
len(reference) = 2731
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.888
SUFF_SIMPLE for r=0.9 class 0 = 0.726 +- 0.182 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.9 class 1 = 0.872 +- 0.182 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.9 class 2 = 0.889 +- 0.182 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.9 all KL = 0.898 +- 0.182 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.9 all L1 = 0.831 +- 0.184 (in-sample avg dev_std = 0.035)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7829750000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.562
SUFF_SIMPLE for r=0.3 class 0 = 0.508 +- 0.234 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.3 class 1 = 0.672 +- 0.234 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.3 class 2 = 0.464 +- 0.234 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.3 all KL = 0.539 +- 0.234 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.3 all L1 = 0.547 +- 0.203 (in-sample avg dev_std = 0.255)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.69091
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.621
SUFF_SIMPLE for r=0.6 class 0 = 0.489 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.675 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.417 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.503 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.526 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4804170000000001
len(reference) = 76
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF_SIMPLE for r=0.9 class 0 = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.992 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.995 +- 0.005 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5528443333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.246
NEC for r=0.3 class 0 = 0.742 +- 0.130 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 1 = 0.666 +- 0.130 (in-sample avg dev_std = 0.466)
NEC for r=0.3 class 2 = 0.741 +- 0.130 (in-sample avg dev_std = 0.466)
NEC for r=0.3 all KL = 0.784 +- 0.130 (in-sample avg dev_std = 0.466)
NEC for r=0.3 all L1 = 0.716 +- 0.100 (in-sample avg dev_std = 0.466)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441395
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.676 +- 0.185 (in-sample avg dev_std = 0.554)
NEC for r=0.6 class 1 = 0.541 +- 0.185 (in-sample avg dev_std = 0.554)
NEC for r=0.6 class 2 = 0.661 +- 0.185 (in-sample avg dev_std = 0.554)
NEC for r=0.6 all KL = 0.676 +- 0.185 (in-sample avg dev_std = 0.554)
NEC for r=0.6 all L1 = 0.625 +- 0.146 (in-sample avg dev_std = 0.554)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3365766666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.613 +- 0.214 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 1 = 0.465 +- 0.214 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 2 = 0.582 +- 0.214 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all KL = 0.588 +- 0.214 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all L1 = 0.553 +- 0.166 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7829750000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.324
NEC for r=0.3 class 0 = 0.393 +- 0.253 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 1 = 0.163 +- 0.253 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 2 = 0.285 +- 0.253 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all KL = 0.222 +- 0.253 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all L1 = 0.281 +- 0.270 (in-sample avg dev_std = 0.141)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.69091
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.325 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 class 1 = 0.123 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 class 2 = 0.28 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 all KL = 0.174 +- 0.206 (in-sample avg dev_std = 0.277)
NEC for r=0.6 all L1 = 0.243 +- 0.225 (in-sample avg dev_std = 0.277)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4804170000000001
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
NEC for r=0.9 class 0 = 0.28 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 1 = 0.104 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 2 = 0.278 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all KL = 0.144 +- 0.166 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all L1 = 0.221 +- 0.196 (in-sample avg dev_std = 0.278)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:24:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:24:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 151 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9293 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.563
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.702
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5630186666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.62
SUFF_SIMPLE for r=0.3 class 0 = 0.375 +- 0.327 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 class 1 = 0.608 +- 0.327 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 class 2 = 0.697 +- 0.327 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 all KL = 0.57 +- 0.327 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.3 all L1 = 0.564 +- 0.258 (in-sample avg dev_std = 0.368)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474451
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.692
SUFF_SIMPLE for r=0.6 class 0 = 0.398 +- 0.330 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.6 class 1 = 0.662 +- 0.330 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.6 class 2 = 0.808 +- 0.330 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.6 all KL = 0.645 +- 0.330 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.6 all L1 = 0.628 +- 0.268 (in-sample avg dev_std = 0.305)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.345834
len(reference) = 2445
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF_SIMPLE for r=0.9 class 0 = 0.759 +- 0.206 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.9 class 1 = 0.867 +- 0.206 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.9 class 2 = 0.891 +- 0.206 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.9 all KL = 0.894 +- 0.206 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.9 all L1 = 0.841 +- 0.194 (in-sample avg dev_std = 0.048)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.783864
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.62
SUFF_SIMPLE for r=0.3 class 0 = 0.376 +- 0.191 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.3 class 1 = 0.532 +- 0.191 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.3 class 2 = 0.509 +- 0.191 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.3 all KL = 0.532 +- 0.191 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.3 all L1 = 0.472 +- 0.138 (in-sample avg dev_std = 0.211)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7022463333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.573
SUFF_SIMPLE for r=0.6 class 0 = 0.371 +- 0.213 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.489 +- 0.213 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.521 +- 0.213 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.506 +- 0.213 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.46 +- 0.169 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5630186666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.243
NEC for r=0.3 class 0 = 0.731 +- 0.136 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.671 +- 0.136 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.748 +- 0.136 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.79 +- 0.136 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.717 +- 0.101 (in-sample avg dev_std = 0.452)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474451
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.677 +- 0.188 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 1 = 0.551 +- 0.188 (in-sample avg dev_std = 0.544)
NEC for r=0.6 class 2 = 0.671 +- 0.188 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all KL = 0.691 +- 0.188 (in-sample avg dev_std = 0.544)
NEC for r=0.6 all L1 = 0.633 +- 0.144 (in-sample avg dev_std = 0.544)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.345834
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.608 +- 0.212 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 1 = 0.483 +- 0.212 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 2 = 0.586 +- 0.212 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all KL = 0.605 +- 0.212 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all L1 = 0.559 +- 0.162 (in-sample avg dev_std = 0.589)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.783864
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.324
NEC for r=0.3 class 0 = 0.565 +- 0.248 (in-sample avg dev_std = 0.175)
NEC for r=0.3 class 1 = 0.334 +- 0.248 (in-sample avg dev_std = 0.175)
NEC for r=0.3 class 2 = 0.588 +- 0.248 (in-sample avg dev_std = 0.175)
NEC for r=0.3 all KL = 0.394 +- 0.248 (in-sample avg dev_std = 0.175)
NEC for r=0.3 all L1 = 0.496 +- 0.221 (in-sample avg dev_std = 0.175)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7022463333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0 = 0.444 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 1 = 0.239 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 class 2 = 0.496 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 all KL = 0.284 +- 0.224 (in-sample avg dev_std = 0.366)
NEC for r=0.6 all L1 = 0.393 +- 0.201 (in-sample avg dev_std = 0.366)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4908126666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
NEC for r=0.9 class 0 = 0.383 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 1 = 0.207 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 2 = 0.441 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all KL = 0.229 +- 0.179 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all L1 = 0.344 +- 0.167 (in-sample avg dev_std = 0.379)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:26:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:26:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.544
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.452
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.335
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.487


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5444593333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.631
SUFF_SIMPLE for r=0.3 class 0 = 0.391 +- 0.323 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.3 class 1 = 0.636 +- 0.323 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.3 class 2 = 0.688 +- 0.323 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.3 all KL = 0.586 +- 0.323 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.3 all L1 = 0.576 +- 0.254 (in-sample avg dev_std = 0.363)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4521923333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
SUFF_SIMPLE for r=0.6 class 0 = 0.466 +- 0.319 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.6 class 1 = 0.672 +- 0.319 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.6 class 2 = 0.775 +- 0.319 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.6 all KL = 0.664 +- 0.319 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.6 all L1 = 0.642 +- 0.254 (in-sample avg dev_std = 0.302)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33499466666666666
len(reference) = 2657
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.885
SUFF_SIMPLE for r=0.9 class 0 = 0.74 +- 0.198 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.9 class 1 = 0.86 +- 0.198 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.9 class 2 = 0.9 +- 0.198 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.9 all KL = 0.891 +- 0.198 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.9 all L1 = 0.835 +- 0.189 (in-sample avg dev_std = 0.046)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7838663333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.607
SUFF_SIMPLE for r=0.3 class 0 = 0.555 +- 0.251 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.3 class 1 = 0.683 +- 0.251 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.3 class 2 = 0.454 +- 0.251 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.3 all KL = 0.552 +- 0.251 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.3 all L1 = 0.564 +- 0.225 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6968573333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.621
SUFF_SIMPLE for r=0.6 class 0 = 0.551 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.765 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.43 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.565 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.581 +- 0.258 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.941
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48747699999999994
len(reference) = 850
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.941
SUFF_SIMPLE for r=0.9 class 0 = 0.98 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.977 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.973 +- 0.024 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5444593333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.242
NEC for r=0.3 class 0 = 0.73 +- 0.135 (in-sample avg dev_std = 0.469)
NEC for r=0.3 class 1 = 0.692 +- 0.135 (in-sample avg dev_std = 0.469)
NEC for r=0.3 class 2 = 0.746 +- 0.135 (in-sample avg dev_std = 0.469)
NEC for r=0.3 all KL = 0.801 +- 0.135 (in-sample avg dev_std = 0.469)
NEC for r=0.3 all L1 = 0.723 +- 0.099 (in-sample avg dev_std = 0.469)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4521923333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.422
NEC for r=0.6 class 0 = 0.674 +- 0.187 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 1 = 0.563 +- 0.187 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 2 = 0.656 +- 0.187 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all KL = 0.695 +- 0.187 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all L1 = 0.631 +- 0.140 (in-sample avg dev_std = 0.576)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33499466666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.52
NEC for r=0.9 class 0 = 0.609 +- 0.212 (in-sample avg dev_std = 0.619)
NEC for r=0.9 class 1 = 0.487 +- 0.212 (in-sample avg dev_std = 0.619)
NEC for r=0.9 class 2 = 0.583 +- 0.212 (in-sample avg dev_std = 0.619)
NEC for r=0.9 all KL = 0.613 +- 0.212 (in-sample avg dev_std = 0.619)
NEC for r=0.9 all L1 = 0.559 +- 0.159 (in-sample avg dev_std = 0.619)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7838663333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.298
NEC for r=0.3 class 0 = 0.628 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 1 = 0.297 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.3 class 2 = 0.393 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.3 all KL = 0.36 +- 0.260 (in-sample avg dev_std = 0.220)
NEC for r=0.3 all L1 = 0.44 +- 0.248 (in-sample avg dev_std = 0.220)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6968573333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.437
NEC for r=0.6 class 0 = 0.435 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 class 1 = 0.195 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 class 2 = 0.355 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 all KL = 0.255 +- 0.228 (in-sample avg dev_std = 0.398)
NEC for r=0.6 all L1 = 0.329 +- 0.219 (in-sample avg dev_std = 0.398)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48747699999999994
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.359 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 1 = 0.17 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 class 2 = 0.331 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 all KL = 0.209 +- 0.185 (in-sample avg dev_std = 0.395)
NEC for r=0.9 all L1 = 0.287 +- 0.187 (in-sample avg dev_std = 0.395)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.496, 0.64, 0.92], 'all_L1': [0.541, 0.65, 0.876]}), defaultdict(<class 'list'>, {'all_KL': [0.609, 0.666, 0.912], 'all_L1': [0.587, 0.639, 0.851]}), defaultdict(<class 'list'>, {'all_KL': [0.559, 0.622, 0.921], 'all_L1': [0.562, 0.617, 0.856]}), defaultdict(<class 'list'>, {'all_KL': [0.596, 0.645, 0.915], 'all_L1': [0.584, 0.628, 0.857]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.638, 0.863], 'all_L1': [0.576, 0.622, 0.789]}), defaultdict(<class 'list'>, {'all_KL': [0.559, 0.604, 0.894], 'all_L1': [0.563, 0.604, 0.843]}), defaultdict(<class 'list'>, {'all_KL': [0.583, 0.641, 0.895], 'all_L1': [0.575, 0.627, 0.842]}), defaultdict(<class 'list'>, {'all_KL': [0.596, 0.67, 0.898], 'all_L1': [0.571, 0.636, 0.831]}), defaultdict(<class 'list'>, {'all_KL': [0.57, 0.645, 0.894], 'all_L1': [0.564, 0.628, 0.841]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.664, 0.891], 'all_L1': [0.576, 0.642, 0.835]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.811, 0.739, 0.678], 'all_L1': [0.714, 0.643, 0.582]}), defaultdict(<class 'list'>, {'all_KL': [0.768, 0.66, 0.58], 'all_L1': [0.707, 0.616, 0.546]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.686, 0.604], 'all_L1': [0.703, 0.624, 0.552]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.706, 0.619], 'all_L1': [0.714, 0.629, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.794, 0.696, 0.617], 'all_L1': [0.717, 0.63, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.781, 0.699, 0.618], 'all_L1': [0.712, 0.636, 0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.799, 0.698, 0.613], 'all_L1': [0.724, 0.635, 0.563]}), defaultdict(<class 'list'>, {'all_KL': [0.784, 0.676, 0.588], 'all_L1': [0.716, 0.625, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.79, 0.691, 0.605], 'all_L1': [0.717, 0.633, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.801, 0.695, 0.613], 'all_L1': [0.723, 0.631, 0.559]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.678, 0.807, 0.983], 'all_L1': [0.618, 0.714, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.556, 0.546, 0.996], 'all_L1': [0.533, 0.537, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.541, 1.0], 'all_L1': [0.481, 0.465, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.643, 0.998], 'all_L1': [0.525, 0.518, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.548, 0.996], 'all_L1': [0.524, 0.552, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.417, 0.419, 1.0], 'all_L1': [0.415, 0.419, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.515, 0.478, 1.0], 'all_L1': [0.485, 0.461, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.503, 0.999], 'all_L1': [0.547, 0.526, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.506, 1.0], 'all_L1': [0.472, 0.46, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.565, 0.996], 'all_L1': [0.564, 0.581, 0.973]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.516, 0.366, 0.302], 'all_L1': [0.547, 0.4, 0.347]}), defaultdict(<class 'list'>, {'all_KL': [0.427, 0.3, 0.241], 'all_L1': [0.526, 0.394, 0.339]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.234, 0.188], 'all_L1': [0.413, 0.34, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.321, 0.254], 'all_L1': [0.597, 0.43, 0.371]}), defaultdict(<class 'list'>, {'all_KL': [0.336, 0.252, 0.203], 'all_L1': [0.383, 0.306, 0.265]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.221, 0.182], 'all_L1': [0.388, 0.336, 0.301]}), defaultdict(<class 'list'>, {'all_KL': [0.374, 0.27, 0.221], 'all_L1': [0.484, 0.374, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.222, 0.174, 0.144], 'all_L1': [0.281, 0.243, 0.221]}), defaultdict(<class 'list'>, {'all_KL': [0.394, 0.284, 0.229], 'all_L1': [0.496, 0.393, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.255, 0.209], 'all_L1': [0.44, 0.329, 0.287]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.570 +- 0.013, 0.629 +- 0.013, 0.842 +- 0.022
suff_simple class all_KL  =  0.573 +- 0.030, 0.643 +- 0.019, 0.900 +- 0.017
[[0.5705416798591614, 0.6743749976158142, 0.8725304007530212], [0.6558333039283752, 0.6812916398048401, 0.8743823766708374], [0.6127916574478149, 0.6802499890327454, 0.8972029685974121], [0.6462916731834412, 0.7020833492279053, 0.8891083598136902], [0.6398333311080933, 0.6672916412353516, 0.8704128265380859], [0.6000000238418579, 0.6238333582878113, 0.8628626465797424], [0.6345416903495789, 0.6675000190734863, 0.8836522698402405], [0.6307083368301392, 0.6780416369438171, 0.8877700567245483], [0.6200000047683716, 0.6918749809265137, 0.8715234994888306], [0.6311666369438171, 0.68729168176651, 0.8849736452102661]]
[[0.496, 0.64, 0.92], [0.609, 0.666, 0.912], [0.559, 0.622, 0.921], [0.596, 0.645, 0.915], [0.579, 0.638, 0.863], [0.559, 0.604, 0.894], [0.583, 0.641, 0.895], [0.596, 0.67, 0.898], [0.57, 0.645, 0.894], [0.586, 0.664, 0.891]]
suff_simple_acc_int  =  0.624 +- 0.024, 0.675 +- 0.020, 0.879 +- 0.010
nec class all_L1  =  0.715 +- 0.006, 0.630 +- 0.007, 0.560 +- 0.009
nec class all_KL  =  0.790 +- 0.013, 0.695 +- 0.019, 0.613 +- 0.025
[[0.2607083320617676, 0.3789166808128357, 0.4704166650772095], [0.25570833683013916, 0.4208333194255829, 0.515958309173584], [0.2722499966621399, 0.41866666078567505, 0.5262083411216736], [0.2447083294391632, 0.4009583294391632, 0.4988333284854889], [0.21779166162014008, 0.39100000262260437, 0.5008333325386047], [0.2511250078678131, 0.37941667437553406, 0.4892916679382324], [0.22062499821186066, 0.38733333349227905, 0.5052083134651184], [0.2462083399295807, 0.40704166889190674, 0.5145000219345093], [0.24300000071525574, 0.39887499809265137, 0.5102916955947876], [0.24195833504199982, 0.421958327293396, 0.5195000171661377]]
[[0.811, 0.739, 0.678], [0.768, 0.66, 0.58], [0.775, 0.686, 0.604], [0.802, 0.706, 0.619], [0.794, 0.696, 0.617], [0.781, 0.699, 0.618], [0.799, 0.698, 0.613], [0.784, 0.676, 0.588], [0.79, 0.691, 0.605], [0.801, 0.695, 0.613]]
nec_acc_int  =  0.245 +- 0.016, 0.400 +- 0.016, 0.505 +- 0.015

Eval split val
suff_simple class all_L1  =  0.516 +- 0.053, 0.523 +- 0.079, 0.980 +- 0.025
suff_simple class all_KL  =  0.554 +- 0.071, 0.556 +- 0.101, 0.997 +- 0.005
[[0.5686666369438171, 0.6306666731834412, 0.5980091691017151], [0.6526666879653931, 0.6570000052452087, 1.0], [0.6241666674613953, 0.6060000061988831, -1.0], [0.6293333172798157, 0.609333336353302, 0.9166666865348816], [0.5357499718666077, 0.6013333201408386, 0.8928571343421936], [0.4884583353996277, 0.4946666657924652, -1.0], [0.6305416822433472, 0.6243333220481873, -1.0], [0.5617499947547913, 0.6206666827201843, 0.8815789222717285], [0.6197916865348816, 0.5726666450500488, -1.0], [0.6074166893959045, 0.6213333606719971, 0.9411764740943909]]
[[0.678, 0.807, 0.983], [0.556, 0.546, 0.996], [0.569, 0.541, 1.0], [0.663, 0.643, 0.998], [0.516, 0.548, 0.996], [0.417, 0.419, 1.0], [0.515, 0.478, 1.0], [0.539, 0.503, 0.999], [0.532, 0.506, 1.0], [0.552, 0.565, 0.996]]
suff_simple_acc_int  =  0.592 +- 0.049, 0.604 +- 0.042, 0.123 +- 0.922
nec class all_L1  =  0.456 +- 0.088, 0.355 +- 0.052, 0.310 +- 0.042
nec class all_KL  =  0.371 +- 0.086, 0.268 +- 0.051, 0.217 +- 0.041
[[0.28337499499320984, 0.46958333253860474, 0.5305833220481873], [0.320208340883255, 0.5276250243186951, 0.6140833497047424], [0.3200416564941406, 0.4947499930858612, 0.5690416693687439], [0.31712499260902405, 0.5920416712760925, 0.6804999709129333], [0.33020833134651184, 0.4429166615009308, 0.5051249861717224], [0.3345833420753479, 0.4351249933242798, 0.5005833506584167], [0.3335833251476288, 0.5230416655540466, 0.6069999933242798], [0.3243333399295807, 0.38462498784065247, 0.44191667437553406], [0.3242083191871643, 0.5129166841506958, 0.5979166626930237], [0.2984583377838135, 0.437375009059906, 0.515375018119812]]
[[0.516, 0.366, 0.302], [0.427, 0.3, 0.241], [0.32, 0.234, 0.188], [0.488, 0.321, 0.254], [0.336, 0.252, 0.203], [0.275, 0.221, 0.182], [0.374, 0.27, 0.221], [0.222, 0.174, 0.144], [0.394, 0.284, 0.229], [0.36, 0.255, 0.209]]
nec_acc_int  =  0.319 +- 0.015, 0.482 +- 0.057, 0.556 +- 0.067


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.642 +- 0.007, 0.630 +- 0.007, 0.701 +- 0.013
Faith. Armon (L1)= 		  =  0.634 +- 0.008, 0.630 +- 0.007, 0.672 +- 0.011
Faith. GMean (L1)= 	  =  0.638 +- 0.008, 0.630 +- 0.007, 0.686 +- 0.012
Faith. Aritm (KL)= 		  =  0.682 +- 0.013, 0.669 +- 0.011, 0.757 +- 0.016
Faith. Armon (KL)= 		  =  0.664 +- 0.020, 0.668 +- 0.011, 0.729 +- 0.019
Faith. GMean (KL)= 	  =  0.673 +- 0.016, 0.668 +- 0.011, 0.743 +- 0.017

Eval split val
Faith. Aritm (L1)= 		  =  0.486 +- 0.057, 0.439 +- 0.050, 0.645 +- 0.020
Faith. Armon (L1)= 		  =  0.479 +- 0.063, 0.419 +- 0.049, 0.470 +- 0.049
Faith. GMean (L1)= 	  =  0.482 +- 0.060, 0.429 +- 0.048, 0.550 +- 0.037
Faith. Aritm (KL)= 		  =  0.462 +- 0.073, 0.412 +- 0.072, 0.607 +- 0.019
Faith. Armon (KL)= 		  =  0.442 +- 0.082, 0.360 +- 0.066, 0.355 +- 0.055
Faith. GMean (KL)= 	  =  0.452 +- 0.078, 0.385 +- 0.068, 0.463 +- 0.043
Computed for split load_split = id



Completed in  0:21:13.988399  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GSAT GOODMotif/basis/covariate NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:29:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:29:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.199
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17759633333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.386
SUFF_SIMPLE for r=0.3 class 0 = 0.266 +- 0.223 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.3 class 1 = 0.424 +- 0.223 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.3 class 2 = 0.396 +- 0.223 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.3 all KL = 0.27 +- 0.223 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.3 all L1 = 0.364 +- 0.177 (in-sample avg dev_std = 0.546)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.248032
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.371
SUFF_SIMPLE for r=0.6 class 0 = 0.274 +- 0.251 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.6 class 1 = 0.431 +- 0.251 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.6 class 2 = 0.382 +- 0.251 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.6 all KL = 0.281 +- 0.251 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.197 (in-sample avg dev_std = 0.480)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2945986666666666
len(reference) = 2709
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.544
SUFF_SIMPLE for r=0.9 class 0 = 0.458 +- 0.403 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.9 class 1 = 0.69 +- 0.403 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.9 class 2 = 0.499 +- 0.403 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.9 all KL = 0.547 +- 0.403 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.9 all L1 = 0.55 +- 0.335 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19912633333333335
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.295
SUFF_SIMPLE for r=0.3 class 0 = 0.468 +- 0.255 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.3 class 1 = 0.46 +- 0.255 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.3 class 2 = 0.455 +- 0.255 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.3 all KL = 0.479 +- 0.255 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.3 all L1 = 0.461 +- 0.155 (in-sample avg dev_std = 0.359)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3169956666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.289
SUFF_SIMPLE for r=0.6 class 0 = 0.475 +- 0.268 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 1 = 0.453 +- 0.268 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 class 2 = 0.462 +- 0.268 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all KL = 0.485 +- 0.268 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.6 all L1 = 0.463 +- 0.169 (in-sample avg dev_std = 0.314)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36216099999999996
len(reference) = 2689
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.415
SUFF_SIMPLE for r=0.9 class 0 = 0.562 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.544 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.501 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.586 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.535 +- 0.231 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17759633333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.498
NEC for r=0.3 class 0 = 0.62 +- 0.287 (in-sample avg dev_std = 0.592)
NEC for r=0.3 class 1 = 0.438 +- 0.287 (in-sample avg dev_std = 0.592)
NEC for r=0.3 class 2 = 0.578 +- 0.287 (in-sample avg dev_std = 0.592)
NEC for r=0.3 all KL = 0.624 +- 0.287 (in-sample avg dev_std = 0.592)
NEC for r=0.3 all L1 = 0.545 +- 0.224 (in-sample avg dev_std = 0.592)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.248032
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.496
NEC for r=0.6 class 0 = 0.623 +- 0.253 (in-sample avg dev_std = 0.639)
NEC for r=0.6 class 1 = 0.461 +- 0.253 (in-sample avg dev_std = 0.639)
NEC for r=0.6 class 2 = 0.592 +- 0.253 (in-sample avg dev_std = 0.639)
NEC for r=0.6 all KL = 0.648 +- 0.253 (in-sample avg dev_std = 0.639)
NEC for r=0.6 all L1 = 0.558 +- 0.196 (in-sample avg dev_std = 0.639)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2945986666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.496
NEC for r=0.9 class 0 = 0.628 +- 0.242 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.466 +- 0.242 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.595 +- 0.242 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.655 +- 0.242 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.562 +- 0.187 (in-sample avg dev_std = 0.650)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19912633333333335
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.562
NEC for r=0.3 class 0 = 0.342 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 1 = 0.2 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 2 = 0.378 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all KL = 0.253 +- 0.239 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all L1 = 0.307 +- 0.194 (in-sample avg dev_std = 0.388)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3169956666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.544
NEC for r=0.6 class 0 = 0.348 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 class 1 = 0.217 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 class 2 = 0.424 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 all KL = 0.284 +- 0.235 (in-sample avg dev_std = 0.425)
NEC for r=0.6 all L1 = 0.33 +- 0.190 (in-sample avg dev_std = 0.425)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36216099999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.352 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 1 = 0.209 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 2 = 0.432 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all KL = 0.284 +- 0.231 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all L1 = 0.331 +- 0.188 (in-sample avg dev_std = 0.436)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:31:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:31:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18386266666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.406
SUFF_SIMPLE for r=0.3 class 0 = 0.299 +- 0.219 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.3 class 1 = 0.41 +- 0.219 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.3 class 2 = 0.434 +- 0.219 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.3 all KL = 0.348 +- 0.219 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.155 (in-sample avg dev_std = 0.495)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2530386666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.394
SUFF_SIMPLE for r=0.6 class 0 = 0.301 +- 0.244 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.6 class 1 = 0.416 +- 0.244 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.6 class 2 = 0.426 +- 0.244 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.6 all KL = 0.353 +- 0.244 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.6 all L1 = 0.383 +- 0.174 (in-sample avg dev_std = 0.442)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2953873333333333
len(reference) = 2709
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.593
SUFF_SIMPLE for r=0.9 class 0 = 0.526 +- 0.367 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.9 class 1 = 0.69 +- 0.367 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.9 class 2 = 0.562 +- 0.367 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.9 all KL = 0.63 +- 0.367 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.9 all L1 = 0.594 +- 0.311 (in-sample avg dev_std = 0.054)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21260500000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.359
SUFF_SIMPLE for r=0.3 class 0 = 0.344 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 class 1 = 0.534 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 class 2 = 0.519 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 all KL = 0.516 +- 0.234 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 all L1 = 0.465 +- 0.175 (in-sample avg dev_std = 0.286)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3208033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.353
SUFF_SIMPLE for r=0.6 class 0 = 0.348 +- 0.244 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 class 1 = 0.532 +- 0.244 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 class 2 = 0.515 +- 0.244 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all KL = 0.518 +- 0.244 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all L1 = 0.465 +- 0.183 (in-sample avg dev_std = 0.247)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.352682
len(reference) = 2606
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.371
SUFF_SIMPLE for r=0.9 class 0 = 0.404 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.628 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.52 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.635 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.516 +- 0.224 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18386266666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.54
NEC for r=0.3 class 0 = 0.581 +- 0.275 (in-sample avg dev_std = 0.528)
NEC for r=0.3 class 1 = 0.43 +- 0.275 (in-sample avg dev_std = 0.528)
NEC for r=0.3 class 2 = 0.535 +- 0.275 (in-sample avg dev_std = 0.528)
NEC for r=0.3 all KL = 0.536 +- 0.275 (in-sample avg dev_std = 0.528)
NEC for r=0.3 all L1 = 0.514 +- 0.206 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2530386666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.537
NEC for r=0.6 class 0 = 0.586 +- 0.244 (in-sample avg dev_std = 0.573)
NEC for r=0.6 class 1 = 0.441 +- 0.244 (in-sample avg dev_std = 0.573)
NEC for r=0.6 class 2 = 0.551 +- 0.244 (in-sample avg dev_std = 0.573)
NEC for r=0.6 all KL = 0.555 +- 0.244 (in-sample avg dev_std = 0.573)
NEC for r=0.6 all L1 = 0.525 +- 0.179 (in-sample avg dev_std = 0.573)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2953873333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.538
NEC for r=0.9 class 0 = 0.59 +- 0.234 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 1 = 0.448 +- 0.234 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 2 = 0.551 +- 0.234 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all KL = 0.56 +- 0.234 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all L1 = 0.529 +- 0.170 (in-sample avg dev_std = 0.584)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21260500000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.63
NEC for r=0.3 class 0 = 0.406 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 1 = 0.169 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 2 = 0.393 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all KL = 0.224 +- 0.206 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all L1 = 0.323 +- 0.195 (in-sample avg dev_std = 0.379)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3208033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.621
NEC for r=0.6 class 0 = 0.414 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.173 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.399 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.231 +- 0.196 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.329 +- 0.184 (in-sample avg dev_std = 0.407)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.352682
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.63
NEC for r=0.9 class 0 = 0.405 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 1 = 0.168 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 2 = 0.402 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all KL = 0.228 +- 0.194 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all L1 = 0.325 +- 0.182 (in-sample avg dev_std = 0.413)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:34:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:34:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.319
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.181415
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.4
SUFF_SIMPLE for r=0.3 class 0 = 0.282 +- 0.225 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.3 class 1 = 0.414 +- 0.225 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.3 class 2 = 0.424 +- 0.225 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.3 all KL = 0.323 +- 0.225 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.3 all L1 = 0.375 +- 0.164 (in-sample avg dev_std = 0.501)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25067
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.39
SUFF_SIMPLE for r=0.6 class 0 = 0.288 +- 0.247 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 class 1 = 0.42 +- 0.247 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 class 2 = 0.412 +- 0.247 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 all KL = 0.328 +- 0.247 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 all L1 = 0.375 +- 0.181 (in-sample avg dev_std = 0.451)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29473733333333335
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.59
SUFF_SIMPLE for r=0.9 class 0 = 0.5 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 1 = 0.703 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 2 = 0.547 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all KL = 0.604 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all L1 = 0.585 +- 0.318 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2129186666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.36
SUFF_SIMPLE for r=0.3 class 0 = 0.476 +- 0.218 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.3 class 1 = 0.474 +- 0.218 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.3 class 2 = 0.539 +- 0.218 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.3 all KL = 0.573 +- 0.218 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.3 all L1 = 0.496 +- 0.144 (in-sample avg dev_std = 0.318)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31939033333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.353
SUFF_SIMPLE for r=0.6 class 0 = 0.486 +- 0.233 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 class 1 = 0.483 +- 0.233 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 class 2 = 0.532 +- 0.233 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 all KL = 0.578 +- 0.233 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.6 all L1 = 0.5 +- 0.164 (in-sample avg dev_std = 0.276)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.582
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35187466666666667
len(reference) = 2591
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF_SIMPLE for r=0.9 class 0 = 0.691 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.746 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.473 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.746 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.635 +- 0.233 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.181415
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.549
NEC for r=0.3 class 0 = 0.589 +- 0.276 (in-sample avg dev_std = 0.542)
NEC for r=0.3 class 1 = 0.423 +- 0.276 (in-sample avg dev_std = 0.542)
NEC for r=0.3 class 2 = 0.546 +- 0.276 (in-sample avg dev_std = 0.542)
NEC for r=0.3 all KL = 0.555 +- 0.276 (in-sample avg dev_std = 0.542)
NEC for r=0.3 all L1 = 0.519 +- 0.209 (in-sample avg dev_std = 0.542)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25067
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.549
NEC for r=0.6 class 0 = 0.593 +- 0.244 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 1 = 0.443 +- 0.244 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 2 = 0.56 +- 0.244 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all KL = 0.578 +- 0.244 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all L1 = 0.532 +- 0.180 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29473733333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.544
NEC for r=0.9 class 0 = 0.601 +- 0.235 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 1 = 0.441 +- 0.235 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 2 = 0.572 +- 0.235 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all KL = 0.587 +- 0.235 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all L1 = 0.537 +- 0.172 (in-sample avg dev_std = 0.604)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2129186666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.591
NEC for r=0.3 class 0 = 0.307 +- 0.184 (in-sample avg dev_std = 0.301)
NEC for r=0.3 class 1 = 0.158 +- 0.184 (in-sample avg dev_std = 0.301)
NEC for r=0.3 class 2 = 0.406 +- 0.184 (in-sample avg dev_std = 0.301)
NEC for r=0.3 all KL = 0.175 +- 0.184 (in-sample avg dev_std = 0.301)
NEC for r=0.3 all L1 = 0.291 +- 0.174 (in-sample avg dev_std = 0.301)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31939033333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.582
NEC for r=0.6 class 0 = 0.313 +- 0.174 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 1 = 0.162 +- 0.174 (in-sample avg dev_std = 0.323)
NEC for r=0.6 class 2 = 0.411 +- 0.174 (in-sample avg dev_std = 0.323)
NEC for r=0.6 all KL = 0.181 +- 0.174 (in-sample avg dev_std = 0.323)
NEC for r=0.6 all L1 = 0.296 +- 0.167 (in-sample avg dev_std = 0.323)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35187466666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.58
NEC for r=0.9 class 0 = 0.316 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 class 1 = 0.157 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 class 2 = 0.413 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 all KL = 0.181 +- 0.175 (in-sample avg dev_std = 0.328)
NEC for r=0.9 all L1 = 0.296 +- 0.168 (in-sample avg dev_std = 0.328)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:36:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:36:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.318
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18083733333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.405
SUFF_SIMPLE for r=0.3 class 0 = 0.299 +- 0.222 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.3 class 1 = 0.402 +- 0.222 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.3 class 2 = 0.426 +- 0.222 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.3 all KL = 0.322 +- 0.222 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.3 all L1 = 0.377 +- 0.161 (in-sample avg dev_std = 0.522)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24976833333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.389
SUFF_SIMPLE for r=0.6 class 0 = 0.311 +- 0.243 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 class 1 = 0.412 +- 0.243 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 class 2 = 0.405 +- 0.243 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 all KL = 0.329 +- 0.243 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 all L1 = 0.377 +- 0.177 (in-sample avg dev_std = 0.470)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2943286666666667
len(reference) = 2707
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.577
SUFF_SIMPLE for r=0.9 class 0 = 0.51 +- 0.386 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.9 class 1 = 0.68 +- 0.386 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.9 class 2 = 0.544 +- 0.386 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.9 all KL = 0.6 +- 0.386 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.9 all L1 = 0.579 +- 0.320 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
SUFF_SIMPLE for r=0.3 class 0 = 0.357 +- 0.205 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.3 class 1 = 0.412 +- 0.205 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.3 class 2 = 0.506 +- 0.205 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.3 all KL = 0.547 +- 0.205 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.3 all L1 = 0.425 +- 0.112 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.318293
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.309
SUFF_SIMPLE for r=0.6 class 0 = 0.36 +- 0.213 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 class 1 = 0.406 +- 0.213 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 class 2 = 0.504 +- 0.213 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 all KL = 0.546 +- 0.213 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 all L1 = 0.423 +- 0.122 (in-sample avg dev_std = 0.215)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3517643333333334
len(reference) = 2637
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.394
SUFF_SIMPLE for r=0.9 class 0 = 0.449 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.52 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.409 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.598 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.459 +- 0.187 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18083733333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.531
NEC for r=0.3 class 0 = 0.575 +- 0.272 (in-sample avg dev_std = 0.555)
NEC for r=0.3 class 1 = 0.436 +- 0.272 (in-sample avg dev_std = 0.555)
NEC for r=0.3 class 2 = 0.551 +- 0.272 (in-sample avg dev_std = 0.555)
NEC for r=0.3 all KL = 0.564 +- 0.272 (in-sample avg dev_std = 0.555)
NEC for r=0.3 all L1 = 0.521 +- 0.208 (in-sample avg dev_std = 0.555)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24976833333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.536
NEC for r=0.6 class 0 = 0.58 +- 0.245 (in-sample avg dev_std = 0.599)
NEC for r=0.6 class 1 = 0.447 +- 0.245 (in-sample avg dev_std = 0.599)
NEC for r=0.6 class 2 = 0.558 +- 0.245 (in-sample avg dev_std = 0.599)
NEC for r=0.6 all KL = 0.582 +- 0.245 (in-sample avg dev_std = 0.599)
NEC for r=0.6 all L1 = 0.528 +- 0.186 (in-sample avg dev_std = 0.599)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2943286666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.527
NEC for r=0.9 class 0 = 0.592 +- 0.228 (in-sample avg dev_std = 0.614)
NEC for r=0.9 class 1 = 0.456 +- 0.228 (in-sample avg dev_std = 0.614)
NEC for r=0.9 class 2 = 0.563 +- 0.228 (in-sample avg dev_std = 0.614)
NEC for r=0.9 all KL = 0.596 +- 0.228 (in-sample avg dev_std = 0.614)
NEC for r=0.9 all L1 = 0.536 +- 0.175 (in-sample avg dev_std = 0.614)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.702
NEC for r=0.3 class 0 = 0.423 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 1 = 0.238 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 class 2 = 0.384 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all KL = 0.232 +- 0.191 (in-sample avg dev_std = 0.389)
NEC for r=0.3 all L1 = 0.349 +- 0.166 (in-sample avg dev_std = 0.389)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.318293
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.694
NEC for r=0.6 class 0 = 0.432 +- 0.175 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 1 = 0.243 +- 0.175 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 2 = 0.398 +- 0.175 (in-sample avg dev_std = 0.412)
NEC for r=0.6 all KL = 0.241 +- 0.175 (in-sample avg dev_std = 0.412)
NEC for r=0.6 all L1 = 0.358 +- 0.151 (in-sample avg dev_std = 0.412)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3517643333333334
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.702
NEC for r=0.9 class 0 = 0.423 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 1 = 0.236 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 class 2 = 0.397 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 all KL = 0.237 +- 0.172 (in-sample avg dev_std = 0.417)
NEC for r=0.9 all L1 = 0.353 +- 0.148 (in-sample avg dev_std = 0.417)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:37:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:37:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.314
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.180878
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF_SIMPLE for r=0.3 class 0 = 0.302 +- 0.238 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 class 1 = 0.384 +- 0.238 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 class 2 = 0.452 +- 0.238 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 all KL = 0.33 +- 0.238 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 all L1 = 0.381 +- 0.169 (in-sample avg dev_std = 0.516)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24921533333333332
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.4
SUFF_SIMPLE for r=0.6 class 0 = 0.301 +- 0.255 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 1 = 0.394 +- 0.255 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 2 = 0.429 +- 0.255 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all KL = 0.329 +- 0.255 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all L1 = 0.376 +- 0.181 (in-sample avg dev_std = 0.463)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29532
len(reference) = 2709
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.577
SUFF_SIMPLE for r=0.9 class 0 = 0.517 +- 0.386 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 class 1 = 0.65 +- 0.386 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 class 2 = 0.554 +- 0.386 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 all KL = 0.594 +- 0.386 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.9 all L1 = 0.574 +- 0.322 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21251400000000004
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
SUFF_SIMPLE for r=0.3 class 0 = 0.517 +- 0.258 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.258 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 2 = 0.57 +- 0.258 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all KL = 0.563 +- 0.258 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all L1 = 0.558 +- 0.216 (in-sample avg dev_std = 0.282)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31444133333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.337
SUFF_SIMPLE for r=0.6 class 0 = 0.525 +- 0.270 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 class 1 = 0.593 +- 0.270 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 class 2 = 0.57 +- 0.270 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 all KL = 0.573 +- 0.270 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 all L1 = 0.563 +- 0.227 (in-sample avg dev_std = 0.246)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.538
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35299
len(reference) = 2647
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.383
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.789 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.602 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.737 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.683 +- 0.263 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.180878
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.526
NEC for r=0.3 class 0 = 0.571 +- 0.278 (in-sample avg dev_std = 0.550)
NEC for r=0.3 class 1 = 0.474 +- 0.278 (in-sample avg dev_std = 0.550)
NEC for r=0.3 class 2 = 0.534 +- 0.278 (in-sample avg dev_std = 0.550)
NEC for r=0.3 all KL = 0.568 +- 0.278 (in-sample avg dev_std = 0.550)
NEC for r=0.3 all L1 = 0.526 +- 0.206 (in-sample avg dev_std = 0.550)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24921533333333332
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.53
NEC for r=0.6 class 0 = 0.575 +- 0.245 (in-sample avg dev_std = 0.596)
NEC for r=0.6 class 1 = 0.481 +- 0.245 (in-sample avg dev_std = 0.596)
NEC for r=0.6 class 2 = 0.552 +- 0.245 (in-sample avg dev_std = 0.596)
NEC for r=0.6 all KL = 0.587 +- 0.245 (in-sample avg dev_std = 0.596)
NEC for r=0.6 all L1 = 0.536 +- 0.176 (in-sample avg dev_std = 0.596)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29532
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.527
NEC for r=0.9 class 0 = 0.578 +- 0.238 (in-sample avg dev_std = 0.603)
NEC for r=0.9 class 1 = 0.485 +- 0.238 (in-sample avg dev_std = 0.603)
NEC for r=0.9 class 2 = 0.558 +- 0.238 (in-sample avg dev_std = 0.603)
NEC for r=0.9 all KL = 0.592 +- 0.238 (in-sample avg dev_std = 0.603)
NEC for r=0.9 all L1 = 0.54 +- 0.170 (in-sample avg dev_std = 0.603)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21251400000000004
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.518
NEC for r=0.3 class 0 = 0.279 +- 0.211 (in-sample avg dev_std = 0.310)
NEC for r=0.3 class 1 = 0.122 +- 0.211 (in-sample avg dev_std = 0.310)
NEC for r=0.3 class 2 = 0.358 +- 0.211 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all KL = 0.187 +- 0.211 (in-sample avg dev_std = 0.310)
NEC for r=0.3 all L1 = 0.254 +- 0.208 (in-sample avg dev_std = 0.310)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31444133333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.51
NEC for r=0.6 class 0 = 0.286 +- 0.204 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 1 = 0.124 +- 0.204 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 2 = 0.361 +- 0.204 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all KL = 0.194 +- 0.204 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all L1 = 0.257 +- 0.203 (in-sample avg dev_std = 0.334)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.557
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35299
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.509
NEC for r=0.9 class 0 = 0.286 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 class 1 = 0.122 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 class 2 = 0.37 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 all KL = 0.196 +- 0.204 (in-sample avg dev_std = 0.340)
NEC for r=0.9 all L1 = 0.26 +- 0.204 (in-sample avg dev_std = 0.340)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:39:29 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:39:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.180944
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.421
SUFF_SIMPLE for r=0.3 class 0 = 0.281 +- 0.259 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 class 1 = 0.391 +- 0.259 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 class 2 = 0.493 +- 0.259 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 all KL = 0.337 +- 0.259 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 all L1 = 0.391 +- 0.195 (in-sample avg dev_std = 0.491)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2504386666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.411
SUFF_SIMPLE for r=0.6 class 0 = 0.285 +- 0.265 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.6 class 1 = 0.397 +- 0.265 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.6 class 2 = 0.466 +- 0.265 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.6 all KL = 0.336 +- 0.265 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.6 all L1 = 0.385 +- 0.198 (in-sample avg dev_std = 0.447)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29582533333333333
len(reference) = 2712
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.561
SUFF_SIMPLE for r=0.9 class 0 = 0.499 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all KL = 0.585 +- 0.382 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all L1 = 0.566 +- 0.318 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21709066666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.307
SUFF_SIMPLE for r=0.3 class 0 = 0.478 +- 0.253 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.3 class 1 = 0.424 +- 0.253 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.3 class 2 = 0.624 +- 0.253 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.3 all KL = 0.529 +- 0.253 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.3 all L1 = 0.509 +- 0.180 (in-sample avg dev_std = 0.280)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321743
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.302
SUFF_SIMPLE for r=0.6 class 0 = 0.483 +- 0.264 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 class 1 = 0.426 +- 0.264 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 class 2 = 0.622 +- 0.264 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.264 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all L1 = 0.511 +- 0.193 (in-sample avg dev_std = 0.249)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.545
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3520763333333333
len(reference) = 2611
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.368
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.726 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.589 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.76 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.645 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.180944
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.521
NEC for r=0.3 class 0 = 0.595 +- 0.261 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 1 = 0.454 +- 0.261 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 2 = 0.534 +- 0.261 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all KL = 0.564 +- 0.261 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all L1 = 0.527 +- 0.207 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2504386666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.517
NEC for r=0.6 class 0 = 0.591 +- 0.232 (in-sample avg dev_std = 0.574)
NEC for r=0.6 class 1 = 0.472 +- 0.232 (in-sample avg dev_std = 0.574)
NEC for r=0.6 class 2 = 0.547 +- 0.232 (in-sample avg dev_std = 0.574)
NEC for r=0.6 all KL = 0.58 +- 0.232 (in-sample avg dev_std = 0.574)
NEC for r=0.6 all L1 = 0.536 +- 0.184 (in-sample avg dev_std = 0.574)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29582533333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.606 +- 0.222 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 1 = 0.474 +- 0.222 (in-sample avg dev_std = 0.583)
NEC for r=0.9 class 2 = 0.559 +- 0.222 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all KL = 0.593 +- 0.222 (in-sample avg dev_std = 0.583)
NEC for r=0.9 all L1 = 0.545 +- 0.175 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21709066666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.508
NEC for r=0.3 class 0 = 0.307 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1 = 0.177 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 2 = 0.396 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.175 +- 0.169 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.294 +- 0.179 (in-sample avg dev_std = 0.263)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321743
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.509
NEC for r=0.6 class 0 = 0.31 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 1 = 0.183 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 2 = 0.394 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all KL = 0.177 +- 0.158 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all L1 = 0.296 +- 0.170 (in-sample avg dev_std = 0.283)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.559
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3520763333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.306 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 1 = 0.181 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 2 = 0.401 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all KL = 0.178 +- 0.159 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all L1 = 0.297 +- 0.171 (in-sample avg dev_std = 0.292)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:41:27 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:41:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.183
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.216
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18276066666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF_SIMPLE for r=0.3 class 0 = 0.307 +- 0.217 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.3 class 1 = 0.393 +- 0.217 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.3 class 2 = 0.423 +- 0.217 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.3 all KL = 0.327 +- 0.217 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.3 all L1 = 0.376 +- 0.157 (in-sample avg dev_std = 0.505)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2523396666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.401
SUFF_SIMPLE for r=0.6 class 0 = 0.312 +- 0.238 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 class 1 = 0.409 +- 0.238 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 class 2 = 0.404 +- 0.238 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 all KL = 0.336 +- 0.238 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.6 all L1 = 0.376 +- 0.174 (in-sample avg dev_std = 0.451)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2949533333333333
len(reference) = 2705
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.579
SUFF_SIMPLE for r=0.9 class 0 = 0.508 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 class 1 = 0.667 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 class 2 = 0.549 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 all KL = 0.596 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 all L1 = 0.575 +- 0.318 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216452
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.385
SUFF_SIMPLE for r=0.3 class 0 = 0.385 +- 0.228 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 class 1 = 0.489 +- 0.228 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 class 2 = 0.55 +- 0.228 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 all KL = 0.539 +- 0.228 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.3 all L1 = 0.474 +- 0.152 (in-sample avg dev_std = 0.288)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.317431
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.365
SUFF_SIMPLE for r=0.6 class 0 = 0.383 +- 0.239 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.6 class 1 = 0.493 +- 0.239 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.6 class 2 = 0.552 +- 0.239 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.6 all KL = 0.544 +- 0.239 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.6 all L1 = 0.476 +- 0.167 (in-sample avg dev_std = 0.239)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3511043333333333
len(reference) = 2613
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.405
SUFF_SIMPLE for r=0.9 class 0 = 0.492 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.667 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.537 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.688 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.564 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18276066666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.54
NEC for r=0.3 class 0 = 0.571 +- 0.254 (in-sample avg dev_std = 0.545)
NEC for r=0.3 class 1 = 0.462 +- 0.254 (in-sample avg dev_std = 0.545)
NEC for r=0.3 class 2 = 0.554 +- 0.254 (in-sample avg dev_std = 0.545)
NEC for r=0.3 all KL = 0.564 +- 0.254 (in-sample avg dev_std = 0.545)
NEC for r=0.3 all L1 = 0.529 +- 0.196 (in-sample avg dev_std = 0.545)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2523396666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.542
NEC for r=0.6 class 0 = 0.578 +- 0.222 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 1 = 0.472 +- 0.222 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 2 = 0.565 +- 0.222 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all KL = 0.582 +- 0.222 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all L1 = 0.538 +- 0.170 (in-sample avg dev_std = 0.589)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2949533333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.584 +- 0.213 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 1 = 0.472 +- 0.213 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 2 = 0.57 +- 0.213 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all KL = 0.588 +- 0.213 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all L1 = 0.542 +- 0.161 (in-sample avg dev_std = 0.604)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216452
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.619
NEC for r=0.3 class 0 = 0.355 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 class 1 = 0.178 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 class 2 = 0.405 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 all KL = 0.205 +- 0.186 (in-sample avg dev_std = 0.357)
NEC for r=0.3 all L1 = 0.313 +- 0.183 (in-sample avg dev_std = 0.357)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.317431
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.619
NEC for r=0.6 class 0 = 0.373 +- 0.173 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 1 = 0.181 +- 0.173 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 2 = 0.402 +- 0.173 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all KL = 0.211 +- 0.173 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all L1 = 0.32 +- 0.169 (in-sample avg dev_std = 0.384)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.681
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3511043333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.619
NEC for r=0.9 class 0 = 0.364 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 class 1 = 0.173 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 class 2 = 0.409 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 all KL = 0.209 +- 0.173 (in-sample avg dev_std = 0.389)
NEC for r=0.9 all L1 = 0.316 +- 0.169 (in-sample avg dev_std = 0.389)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:44:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:44:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:44:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.183
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.182764
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.398
SUFF_SIMPLE for r=0.3 class 0 = 0.291 +- 0.215 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 class 1 = 0.415 +- 0.215 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 class 2 = 0.418 +- 0.215 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 all KL = 0.345 +- 0.215 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 all L1 = 0.376 +- 0.157 (in-sample avg dev_std = 0.486)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25161933333333336
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.396
SUFF_SIMPLE for r=0.6 class 0 = 0.298 +- 0.240 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.6 class 1 = 0.423 +- 0.240 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.6 class 2 = 0.418 +- 0.240 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.6 all KL = 0.356 +- 0.240 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.6 all L1 = 0.381 +- 0.177 (in-sample avg dev_std = 0.437)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29475033333333334
len(reference) = 2715
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.56
SUFF_SIMPLE for r=0.9 class 0 = 0.486 +- 0.378 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 class 1 = 0.679 +- 0.378 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 class 2 = 0.528 +- 0.378 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 all KL = 0.593 +- 0.378 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 all L1 = 0.565 +- 0.316 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2169333333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.363
SUFF_SIMPLE for r=0.3 class 0 = 0.585 +- 0.250 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.3 class 1 = 0.662 +- 0.250 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.3 class 2 = 0.681 +- 0.250 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.3 all KL = 0.659 +- 0.250 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.3 all L1 = 0.643 +- 0.227 (in-sample avg dev_std = 0.273)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32082733333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.353
SUFF_SIMPLE for r=0.6 class 0 = 0.591 +- 0.259 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 class 1 = 0.666 +- 0.259 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 class 2 = 0.682 +- 0.259 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 all KL = 0.666 +- 0.259 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 all L1 = 0.646 +- 0.236 (in-sample avg dev_std = 0.231)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35269999999999996
len(reference) = 2623
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.373
SUFF_SIMPLE for r=0.9 class 0 = 0.711 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.859 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.764 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.839 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.778 +- 0.245 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.182764
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.549
NEC for r=0.3 class 0 = 0.581 +- 0.260 (in-sample avg dev_std = 0.536)
NEC for r=0.3 class 1 = 0.434 +- 0.260 (in-sample avg dev_std = 0.536)
NEC for r=0.3 class 2 = 0.543 +- 0.260 (in-sample avg dev_std = 0.536)
NEC for r=0.3 all KL = 0.539 +- 0.260 (in-sample avg dev_std = 0.536)
NEC for r=0.3 all L1 = 0.519 +- 0.201 (in-sample avg dev_std = 0.536)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25161933333333336
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.543
NEC for r=0.6 class 0 = 0.591 +- 0.226 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 1 = 0.443 +- 0.226 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 2 = 0.56 +- 0.226 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all KL = 0.559 +- 0.226 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all L1 = 0.531 +- 0.175 (in-sample avg dev_std = 0.579)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29475033333333334
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.545
NEC for r=0.9 class 0 = 0.592 +- 0.212 (in-sample avg dev_std = 0.594)
NEC for r=0.9 class 1 = 0.448 +- 0.212 (in-sample avg dev_std = 0.594)
NEC for r=0.9 class 2 = 0.564 +- 0.212 (in-sample avg dev_std = 0.594)
NEC for r=0.9 all KL = 0.566 +- 0.212 (in-sample avg dev_std = 0.594)
NEC for r=0.9 all L1 = 0.534 +- 0.164 (in-sample avg dev_std = 0.594)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2169333333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.441
NEC for r=0.3 class 0 = 0.274 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 class 1 = 0.098 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 class 2 = 0.28 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all KL = 0.14 +- 0.174 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all L1 = 0.218 +- 0.201 (in-sample avg dev_std = 0.253)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32082733333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.451
NEC for r=0.6 class 0 = 0.273 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 1 = 0.099 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 2 = 0.274 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all KL = 0.137 +- 0.160 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all L1 = 0.216 +- 0.192 (in-sample avg dev_std = 0.270)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35269999999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.447
NEC for r=0.9 class 0 = 0.278 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 1 = 0.102 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 2 = 0.278 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all KL = 0.141 +- 0.162 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all L1 = 0.22 +- 0.193 (in-sample avg dev_std = 0.280)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:46:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:46:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 151 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9293 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.219
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18615166666666663
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
SUFF_SIMPLE for r=0.3 class 0 = 0.294 +- 0.220 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.3 class 1 = 0.395 +- 0.220 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.3 class 2 = 0.437 +- 0.220 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.3 all KL = 0.332 +- 0.220 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.3 all L1 = 0.377 +- 0.162 (in-sample avg dev_std = 0.494)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25295
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.405
SUFF_SIMPLE for r=0.6 class 0 = 0.301 +- 0.236 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.6 class 1 = 0.402 +- 0.236 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.6 class 2 = 0.421 +- 0.236 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.6 all KL = 0.336 +- 0.236 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.6 all L1 = 0.376 +- 0.175 (in-sample avg dev_std = 0.450)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2951276666666667
len(reference) = 2698
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.567
SUFF_SIMPLE for r=0.9 class 0 = 0.509 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 class 2 = 0.526 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 all KL = 0.588 +- 0.380 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.9 all L1 = 0.569 +- 0.318 (in-sample avg dev_std = 0.062)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21901266666666666
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.407 +- 0.218 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 class 1 = 0.441 +- 0.218 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 class 2 = 0.538 +- 0.218 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 all KL = 0.525 +- 0.218 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.3 all L1 = 0.462 +- 0.148 (in-sample avg dev_std = 0.286)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.319711
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF_SIMPLE for r=0.6 class 0 = 0.413 +- 0.229 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 class 1 = 0.45 +- 0.229 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 class 2 = 0.534 +- 0.229 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 all KL = 0.532 +- 0.229 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.6 all L1 = 0.466 +- 0.162 (in-sample avg dev_std = 0.243)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35219999999999996
len(reference) = 2631
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.382
SUFF_SIMPLE for r=0.9 class 0 = 0.535 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.679 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.468 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.676 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.559 +- 0.225 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18615166666666663
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.543
NEC for r=0.3 class 0 = 0.58 +- 0.259 (in-sample avg dev_std = 0.534)
NEC for r=0.3 class 1 = 0.457 +- 0.259 (in-sample avg dev_std = 0.534)
NEC for r=0.3 class 2 = 0.536 +- 0.259 (in-sample avg dev_std = 0.534)
NEC for r=0.3 all KL = 0.553 +- 0.259 (in-sample avg dev_std = 0.534)
NEC for r=0.3 all L1 = 0.524 +- 0.201 (in-sample avg dev_std = 0.534)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25295
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.534
NEC for r=0.6 class 0 = 0.594 +- 0.222 (in-sample avg dev_std = 0.580)
NEC for r=0.6 class 1 = 0.468 +- 0.222 (in-sample avg dev_std = 0.580)
NEC for r=0.6 class 2 = 0.558 +- 0.222 (in-sample avg dev_std = 0.580)
NEC for r=0.6 all KL = 0.58 +- 0.222 (in-sample avg dev_std = 0.580)
NEC for r=0.6 all L1 = 0.54 +- 0.170 (in-sample avg dev_std = 0.580)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2951276666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.528
NEC for r=0.9 class 0 = 0.598 +- 0.218 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 1 = 0.469 +- 0.218 (in-sample avg dev_std = 0.589)
NEC for r=0.9 class 2 = 0.566 +- 0.218 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all KL = 0.586 +- 0.218 (in-sample avg dev_std = 0.589)
NEC for r=0.9 all L1 = 0.544 +- 0.166 (in-sample avg dev_std = 0.589)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21901266666666666
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.617
NEC for r=0.3 class 0 = 0.364 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 1 = 0.196 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 2 = 0.425 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all KL = 0.212 +- 0.187 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all L1 = 0.329 +- 0.177 (in-sample avg dev_std = 0.343)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.319711
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.613
NEC for r=0.6 class 0 = 0.372 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 1 = 0.2 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 2 = 0.428 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 all KL = 0.218 +- 0.175 (in-sample avg dev_std = 0.368)
NEC for r=0.6 all L1 = 0.334 +- 0.166 (in-sample avg dev_std = 0.368)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35219999999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0 = 0.372 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 class 1 = 0.193 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 class 2 = 0.438 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 all KL = 0.22 +- 0.177 (in-sample avg dev_std = 0.374)
NEC for r=0.9 all L1 = 0.335 +- 0.168 (in-sample avg dev_std = 0.374)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:49:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:49:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.185
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.318
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.185006
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.402
SUFF_SIMPLE for r=0.3 class 0 = 0.304 +- 0.207 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 class 1 = 0.398 +- 0.207 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 class 2 = 0.414 +- 0.207 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 all KL = 0.323 +- 0.207 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 all L1 = 0.373 +- 0.152 (in-sample avg dev_std = 0.516)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2514233333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.386
SUFF_SIMPLE for r=0.6 class 0 = 0.302 +- 0.234 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 1 = 0.408 +- 0.234 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 2 = 0.409 +- 0.234 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all KL = 0.332 +- 0.234 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all L1 = 0.374 +- 0.172 (in-sample avg dev_std = 0.463)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2962206666666667
len(reference) = 2714
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.572
SUFF_SIMPLE for r=0.9 class 0 = 0.514 +- 0.383 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.9 class 1 = 0.676 +- 0.383 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.9 class 2 = 0.549 +- 0.383 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.9 all KL = 0.603 +- 0.383 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.9 all L1 = 0.58 +- 0.319 (in-sample avg dev_std = 0.060)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21300999999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.362
SUFF_SIMPLE for r=0.3 class 0 = 0.42 +- 0.253 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.3 class 1 = 0.591 +- 0.253 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.3 class 2 = 0.61 +- 0.253 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.3 all KL = 0.577 +- 0.253 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.3 all L1 = 0.54 +- 0.205 (in-sample avg dev_std = 0.323)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.318424
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.36
SUFF_SIMPLE for r=0.6 class 0 = 0.418 +- 0.260 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 class 1 = 0.591 +- 0.260 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 class 2 = 0.605 +- 0.260 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 all KL = 0.581 +- 0.260 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.6 all L1 = 0.538 +- 0.210 (in-sample avg dev_std = 0.280)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3610393333333333
len(reference) = 2677
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.398
SUFF_SIMPLE for r=0.9 class 0 = 0.521 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.791 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.672 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.751 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.664 +- 0.272 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.185006
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.541
NEC for r=0.3 class 0 = 0.581 +- 0.263 (in-sample avg dev_std = 0.564)
NEC for r=0.3 class 1 = 0.456 +- 0.263 (in-sample avg dev_std = 0.564)
NEC for r=0.3 class 2 = 0.544 +- 0.263 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all KL = 0.564 +- 0.263 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all L1 = 0.526 +- 0.199 (in-sample avg dev_std = 0.564)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2514233333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.544
NEC for r=0.6 class 0 = 0.583 +- 0.232 (in-sample avg dev_std = 0.605)
NEC for r=0.6 class 1 = 0.459 +- 0.232 (in-sample avg dev_std = 0.605)
NEC for r=0.6 class 2 = 0.559 +- 0.232 (in-sample avg dev_std = 0.605)
NEC for r=0.6 all KL = 0.579 +- 0.232 (in-sample avg dev_std = 0.605)
NEC for r=0.6 all L1 = 0.533 +- 0.174 (in-sample avg dev_std = 0.605)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2962206666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.537
NEC for r=0.9 class 0 = 0.589 +- 0.221 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 1 = 0.463 +- 0.221 (in-sample avg dev_std = 0.621)
NEC for r=0.9 class 2 = 0.564 +- 0.221 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all KL = 0.588 +- 0.221 (in-sample avg dev_std = 0.621)
NEC for r=0.9 all L1 = 0.538 +- 0.165 (in-sample avg dev_std = 0.621)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21300999999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.529
NEC for r=0.3 class 0 = 0.335 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 1 = 0.15 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 class 2 = 0.321 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all KL = 0.191 +- 0.195 (in-sample avg dev_std = 0.355)
NEC for r=0.3 all L1 = 0.27 +- 0.200 (in-sample avg dev_std = 0.355)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.318424
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.529
NEC for r=0.6 class 0 = 0.347 +- 0.184 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 1 = 0.155 +- 0.184 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 2 = 0.321 +- 0.184 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all KL = 0.197 +- 0.184 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all L1 = 0.275 +- 0.188 (in-sample avg dev_std = 0.385)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3610393333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.348 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 1 = 0.158 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 2 = 0.331 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all KL = 0.202 +- 0.182 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all L1 = 0.28 +- 0.186 (in-sample avg dev_std = 0.393)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.27, 0.281, 0.547], 'all_L1': [0.364, 0.364, 0.55]}), defaultdict(<class 'list'>, {'all_KL': [0.348, 0.353, 0.63], 'all_L1': [0.383, 0.383, 0.594]}), defaultdict(<class 'list'>, {'all_KL': [0.323, 0.328, 0.604], 'all_L1': [0.375, 0.375, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.322, 0.329, 0.6], 'all_L1': [0.377, 0.377, 0.579]}), defaultdict(<class 'list'>, {'all_KL': [0.33, 0.329, 0.594], 'all_L1': [0.381, 0.376, 0.574]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.336, 0.585], 'all_L1': [0.391, 0.385, 0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.327, 0.336, 0.596], 'all_L1': [0.376, 0.376, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.345, 0.356, 0.593], 'all_L1': [0.376, 0.381, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.332, 0.336, 0.588], 'all_L1': [0.377, 0.376, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.323, 0.332, 0.603], 'all_L1': [0.373, 0.374, 0.58]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.624, 0.648, 0.655], 'all_L1': [0.545, 0.558, 0.562]}), defaultdict(<class 'list'>, {'all_KL': [0.536, 0.555, 0.56], 'all_L1': [0.514, 0.525, 0.529]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.578, 0.587], 'all_L1': [0.519, 0.532, 0.537]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.582, 0.596], 'all_L1': [0.521, 0.528, 0.536]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.587, 0.592], 'all_L1': [0.526, 0.536, 0.54]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.58, 0.593], 'all_L1': [0.527, 0.536, 0.545]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.582, 0.588], 'all_L1': [0.529, 0.538, 0.542]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.559, 0.566], 'all_L1': [0.519, 0.531, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.58, 0.586], 'all_L1': [0.524, 0.54, 0.544]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.579, 0.588], 'all_L1': [0.526, 0.533, 0.538]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.479, 0.485, 0.586], 'all_L1': [0.461, 0.463, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.518, 0.635], 'all_L1': [0.465, 0.465, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.578, 0.746], 'all_L1': [0.496, 0.5, 0.635]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.546, 0.598], 'all_L1': [0.425, 0.423, 0.459]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.573, 0.737], 'all_L1': [0.558, 0.563, 0.683]}), defaultdict(<class 'list'>, {'all_KL': [0.529, 0.533, 0.76], 'all_L1': [0.509, 0.511, 0.645]}), defaultdict(<class 'list'>, {'all_KL': [0.539, 0.544, 0.688], 'all_L1': [0.474, 0.476, 0.564]}), defaultdict(<class 'list'>, {'all_KL': [0.659, 0.666, 0.839], 'all_L1': [0.643, 0.646, 0.778]}), defaultdict(<class 'list'>, {'all_KL': [0.525, 0.532, 0.676], 'all_L1': [0.462, 0.466, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.581, 0.751], 'all_L1': [0.54, 0.538, 0.664]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.253, 0.284, 0.284], 'all_L1': [0.307, 0.33, 0.331]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.231, 0.228], 'all_L1': [0.323, 0.329, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.181, 0.181], 'all_L1': [0.291, 0.296, 0.296]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.241, 0.237], 'all_L1': [0.349, 0.358, 0.353]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.194, 0.196], 'all_L1': [0.254, 0.257, 0.26]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.177, 0.178], 'all_L1': [0.294, 0.296, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.211, 0.209], 'all_L1': [0.313, 0.32, 0.316]}), defaultdict(<class 'list'>, {'all_KL': [0.14, 0.137, 0.141], 'all_L1': [0.218, 0.216, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.218, 0.22], 'all_L1': [0.329, 0.334, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.197, 0.202], 'all_L1': [0.27, 0.275, 0.28]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.377 +- 0.007, 0.377 +- 0.005, 0.574 +- 0.012
suff_simple class all_KL  =  0.326 +- 0.020, 0.332 +- 0.019, 0.594 +- 0.020
[[0.38624998927116394, 0.3710833191871643, 0.5442968010902405], [0.406291663646698, 0.39379167556762695, 0.5933923721313477], [0.3996250033378601, 0.3903749883174896, 0.5897991061210632], [0.40529167652130127, 0.3892916738986969, 0.5773919224739075], [0.41095831990242004, 0.4000000059604645, 0.5772425532341003], [0.4207916557788849, 0.4112083315849304, 0.561025083065033], [0.41062501072883606, 0.4007083475589752, 0.5788816809654236], [0.39779165387153625, 0.39620834589004517, 0.559760570526123], [0.40820834040641785, 0.40450000762939453, 0.5669477581977844], [0.40183332562446594, 0.3855416774749756, 0.5720799565315247]]
[[0.27, 0.281, 0.547], [0.348, 0.353, 0.63], [0.323, 0.328, 0.604], [0.322, 0.329, 0.6], [0.33, 0.329, 0.594], [0.337, 0.336, 0.585], [0.327, 0.336, 0.596], [0.345, 0.356, 0.593], [0.332, 0.336, 0.588], [0.323, 0.332, 0.603]]
suff_simple_acc_int  =  0.405 +- 0.009, 0.394 +- 0.011, 0.572 +- 0.014
nec class all_L1  =  0.525 +- 0.008, 0.536 +- 0.009, 0.541 +- 0.008
nec class all_KL  =  0.563 +- 0.023, 0.583 +- 0.024, 0.591 +- 0.024
[[0.49829167127609253, 0.4962500035762787, 0.4960416555404663], [0.5399166941642761, 0.5370416641235352, 0.5379999876022339], [0.5491666793823242, 0.5490833520889282, 0.543874979019165], [0.53125, 0.5364166498184204, 0.5272083282470703], [0.5259166955947876, 0.5304583311080933, 0.5268333554267883], [0.5209166407585144, 0.5171250104904175, 0.5096666812896729], [0.5399166941642761, 0.5416666865348816, 0.5355416536331177], [0.5485000014305115, 0.5433750152587891, 0.5451666712760925], [0.5429583191871643, 0.5336250066757202, 0.527999997138977], [0.5413333177566528, 0.5442500114440918, 0.5372083187103271]]
[[0.624, 0.648, 0.655], [0.536, 0.555, 0.56], [0.555, 0.578, 0.587], [0.564, 0.582, 0.596], [0.568, 0.587, 0.592], [0.564, 0.58, 0.593], [0.564, 0.582, 0.588], [0.539, 0.559, 0.566], [0.553, 0.58, 0.586], [0.564, 0.579, 0.588]]
nec_acc_int  =  0.534 +- 0.015, 0.533 +- 0.015, 0.529 +- 0.015

Eval split val
suff_simple class all_L1  =  0.503 +- 0.060, 0.505 +- 0.061, 0.604 +- 0.089
suff_simple class all_KL  =  0.551 +- 0.045, 0.556 +- 0.046, 0.702 +- 0.076
[[0.2952499985694885, 0.2887499928474426, 0.41502416133880615], [0.35870832204818726, 0.3530833423137665, 0.3714505136013031], [0.3596250116825104, 0.35341668128967285, 0.37360092997550964], [0.3255000114440918, 0.30912500619888306, 0.39362913370132446], [0.3346666693687439, 0.33670833706855774, 0.3826974034309387], [0.30683332681655884, 0.3022916615009308, 0.36844122409820557], [0.38495832681655884, 0.3646250069141388, 0.4045158922672272], [0.3633750081062317, 0.3526666760444641, 0.373236745595932], [0.3400416672229767, 0.3382500112056732, 0.38198402523994446], [0.36241665482521057, 0.35975000262260437, 0.3978334069252014]]
[[0.479, 0.485, 0.586], [0.516, 0.518, 0.635], [0.573, 0.578, 0.746], [0.547, 0.546, 0.598], [0.563, 0.573, 0.737], [0.529, 0.533, 0.76], [0.539, 0.544, 0.688], [0.659, 0.666, 0.839], [0.525, 0.532, 0.676], [0.577, 0.581, 0.751]]
suff_simple_acc_int  =  0.343 +- 0.027, 0.336 +- 0.025, 0.386 +- 0.015
nec class all_L1  =  0.295 +- 0.037, 0.301 +- 0.040, 0.301 +- 0.038
nec class all_KL  =  0.199 +- 0.031, 0.207 +- 0.038, 0.208 +- 0.037
[[0.562208354473114, 0.5441250205039978, 0.5423333048820496], [0.6297500133514404, 0.6213333606719971, 0.6298750042915344], [0.5910833477973938, 0.5818333625793457, 0.5797500014305115], [0.7024999856948853, 0.6939583420753479, 0.7023333311080933], [0.5178333520889282, 0.5102083086967468, 0.5087916851043701], [0.5084583163261414, 0.5093333125114441, 0.5096666812896729], [0.6192083358764648, 0.6189166903495789, 0.6194999814033508], [0.44070833921432495, 0.4508333206176758, 0.44737499952316284], [0.6170833110809326, 0.6127916574478149, 0.609541654586792], [0.5291666388511658, 0.5292500257492065, 0.5225416421890259]]
[[0.253, 0.284, 0.284], [0.224, 0.231, 0.228], [0.175, 0.181, 0.181], [0.232, 0.241, 0.237], [0.187, 0.194, 0.196], [0.175, 0.177, 0.178], [0.205, 0.211, 0.209], [0.14, 0.137, 0.141], [0.212, 0.218, 0.22], [0.191, 0.197, 0.202]]
nec_acc_int  =  0.572 +- 0.072, 0.567 +- 0.068, 0.567 +- 0.071


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.451 +- 0.004, 0.456 +- 0.003, 0.557 +- 0.003
Faith. Armon (L1)= 		  =  0.439 +- 0.004, 0.442 +- 0.002, 0.557 +- 0.003
Faith. GMean (L1)= 	  =  0.445 +- 0.004, 0.449 +- 0.002, 0.557 +- 0.003
Faith. Aritm (KL)= 		  =  0.444 +- 0.003, 0.457 +- 0.003, 0.593 +- 0.006
Faith. Armon (KL)= 		  =  0.412 +- 0.013, 0.422 +- 0.011, 0.592 +- 0.005
Faith. GMean (KL)= 	  =  0.428 +- 0.007, 0.439 +- 0.005, 0.592 +- 0.005

Eval split val
Faith. Aritm (L1)= 		  =  0.399 +- 0.012, 0.403 +- 0.011, 0.453 +- 0.027
Faith. Armon (L1)= 		  =  0.367 +- 0.017, 0.372 +- 0.019, 0.395 +- 0.020
Faith. GMean (L1)= 	  =  0.382 +- 0.005, 0.387 +- 0.006, 0.423 +- 0.011
Faith. Aritm (KL)= 		  =  0.375 +- 0.013, 0.381 +- 0.012, 0.455 +- 0.021
Faith. Armon (KL)= 		  =  0.290 +- 0.029, 0.298 +- 0.035, 0.316 +- 0.036
Faith. GMean (KL)= 	  =  0.329 +- 0.016, 0.336 +- 0.021, 0.378 +- 0.016
Computed for split load_split = id



Completed in  0:22:16.761467  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GSAT GOODMotif/basis/covariate NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:51:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:51:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9243 0.9243 0.9243 0.9243 0.9267 0.9267[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.351
SUFF_SIMPLE for r=0.3 class 0 = 0.273 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 1 = 0.361 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 2 = 0.467 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all KL = 0.244 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all L1 = 0.37 +- 0.223 (in-sample avg dev_std = 0.696)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.308
SUFF_SIMPLE for r=0.6 class 0 = 0.278 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 1 = 0.254 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 2 = 0.52 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all KL = 0.245 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all L1 = 0.354 +- 0.257 (in-sample avg dev_std = 0.567)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.278
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.278 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.28 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.306 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.374 +- 0.342 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.21
SUFF_SIMPLE for r=0.3 class 0 = 0.492 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 1 = 0.327 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 2 = 0.331 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all KL = 0.276 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all L1 = 0.384 +- 0.250 (in-sample avg dev_std = 0.609)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.267
SUFF_SIMPLE for r=0.6 class 0 = 0.506 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 1 = 0.346 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 2 = 0.473 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all KL = 0.341 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all L1 = 0.442 +- 0.302 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.318
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.195 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.492 +- 0.388 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.774
NEC for r=0.3 class 0 = 0.463 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 class 1 = 0.039 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 class 2 = 0.105 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 all KL = 0.245 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 all L1 = 0.197 +- 0.276 (in-sample avg dev_std = 0.463)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.686
NEC for r=0.6 class 0 = 0.545 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 class 1 = 0.077 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 class 2 = 0.294 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 all KL = 0.374 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 all L1 = 0.302 +- 0.303 (in-sample avg dev_std = 0.581)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.624 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 1 = 0.298 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 2 = 0.525 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all KL = 0.6 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all L1 = 0.481 +- 0.254 (in-sample avg dev_std = 0.754)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.649
NEC for r=0.3 class 0 = 0.295 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.122 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.107 +- 0.263 (in-sample avg dev_std = 0.207)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.628
NEC for r=0.6 class 0 = 0.306 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 1 = 0.015 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 2 = 0.089 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.163 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.138 +- 0.275 (in-sample avg dev_std = 0.302)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.388 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 1 = 0.177 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 2 = 0.419 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all KL = 0.411 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all L1 = 0.329 +- 0.277 (in-sample avg dev_std = 0.639)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:53:52 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:53:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.9267 0.9267 0.9267 0.9273 0.9273[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.317 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 class 1 = 0.343 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 class 2 = 0.416 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 all KL = 0.234 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 all L1 = 0.36 +- 0.206 (in-sample avg dev_std = 0.694)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.367 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 1 = 0.236 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 2 = 0.448 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all KL = 0.24 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all L1 = 0.351 +- 0.264 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.295
SUFF_SIMPLE for r=0.9 class 0 = 0.781 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 2 = 0.231 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all KL = 0.326 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.351 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.283
SUFF_SIMPLE for r=0.3 class 0 = 0.239 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 class 2 = 0.607 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 all KL = 0.242 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 all L1 = 0.346 +- 0.249 (in-sample avg dev_std = 0.473)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.239 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 class 1 = 0.191 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 all KL = 0.297 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 all L1 = 0.387 +- 0.301 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.239 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.185 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.344 +- 0.292 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.796
NEC for r=0.3 class 0 = 0.363 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.036 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.16 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.228 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.183 +- 0.255 (in-sample avg dev_std = 0.452)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.695
NEC for r=0.6 class 0 = 0.465 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 1 = 0.095 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 2 = 0.342 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all KL = 0.371 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all L1 = 0.299 +- 0.296 (in-sample avg dev_std = 0.576)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.553
NEC for r=0.9 class 0 = 0.548 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 class 1 = 0.305 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 class 2 = 0.568 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 all KL = 0.597 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 all L1 = 0.473 +- 0.247 (in-sample avg dev_std = 0.756)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.874
NEC for r=0.3 class 0 = 0.185 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 1 = 0.012 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 2 = 0.007 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all KL = 0.063 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all L1 = 0.069 +- 0.182 (in-sample avg dev_std = 0.132)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.822
NEC for r=0.6 class 0 = 0.33 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.021 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.081 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.173 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.145 +- 0.225 (in-sample avg dev_std = 0.390)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.55 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.257 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.356 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.496 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.388 +- 0.229 (in-sample avg dev_std = 0.720)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:55:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:55:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9287 0.9287[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.28 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 1 = 0.328 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 2 = 0.448 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all KL = 0.218 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all L1 = 0.354 +- 0.222 (in-sample avg dev_std = 0.696)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.305
SUFF_SIMPLE for r=0.6 class 0 = 0.317 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 1 = 0.229 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 2 = 0.484 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all KL = 0.233 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all L1 = 0.345 +- 0.253 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF_SIMPLE for r=0.9 class 0 = 0.699 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 class 2 = 0.263 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 all L1 = 0.384 +- 0.355 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.314
SUFF_SIMPLE for r=0.3 class 0 = 0.401 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 class 1 = 0.277 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 class 2 = 0.646 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 all KL = 0.355 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 all L1 = 0.442 +- 0.303 (in-sample avg dev_std = 0.466)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.353
SUFF_SIMPLE for r=0.6 class 0 = 0.411 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 1 = 0.285 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 2 = 0.835 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all KL = 0.452 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all L1 = 0.511 +- 0.361 (in-sample avg dev_std = 0.351)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 0 = 0.832 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.339 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.553 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.474 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.518 +- 0.386 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.773
NEC for r=0.3 class 0 = 0.418 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.081 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.145 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.268 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.211 +- 0.271 (in-sample avg dev_std = 0.508)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.674
NEC for r=0.6 class 0 = 0.536 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 class 1 = 0.139 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 class 2 = 0.319 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 all KL = 0.418 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 all L1 = 0.328 +- 0.299 (in-sample avg dev_std = 0.635)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.606 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 class 1 = 0.346 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 class 2 = 0.551 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 all KL = 0.637 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 all L1 = 0.5 +- 0.248 (in-sample avg dev_std = 0.785)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.79
NEC for r=0.3 class 0 = 0.103 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1 = 0.037 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 2 = 0.008 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.042 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.05 +- 0.138 (in-sample avg dev_std = 0.159)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.743
NEC for r=0.6 class 0 = 0.239 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 1 = 0.052 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 2 = 0.086 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all KL = 0.151 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all L1 = 0.126 +- 0.195 (in-sample avg dev_std = 0.406)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.436 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.254 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.348 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.45 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.346 +- 0.231 (in-sample avg dev_std = 0.715)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:57:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:57:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9250 0.9250[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.39
SUFF_SIMPLE for r=0.3 class 0 = 0.286 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 1 = 0.487 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 2 = 0.332 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all KL = 0.238 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all L1 = 0.369 +- 0.186 (in-sample avg dev_std = 0.747)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.319
SUFF_SIMPLE for r=0.6 class 0 = 0.28 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 class 1 = 0.502 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 class 2 = 0.296 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 all KL = 0.249 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 all L1 = 0.36 +- 0.255 (in-sample avg dev_std = 0.597)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.236
SUFF_SIMPLE for r=0.9 class 0 = 0.469 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 class 2 = 0.354 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 all KL = 0.282 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 all L1 = 0.35 +- 0.324 (in-sample avg dev_std = 0.022)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.296
SUFF_SIMPLE for r=0.3 class 0 = 0.463 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 class 1 = 0.227 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 class 2 = 0.386 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 all KL = 0.251 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 all L1 = 0.359 +- 0.174 (in-sample avg dev_std = 0.685)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.378
SUFF_SIMPLE for r=0.6 class 0 = 0.42 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 class 1 = 0.326 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 class 2 = 0.528 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 all KL = 0.333 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 all L1 = 0.425 +- 0.234 (in-sample avg dev_std = 0.685)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.742 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.561 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.363 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0 = 0.497 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 class 1 = 0.044 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 class 2 = 0.491 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 all KL = 0.402 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 all L1 = 0.343 +- 0.329 (in-sample avg dev_std = 0.504)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.584
NEC for r=0.6 class 0 = 0.548 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 class 1 = 0.112 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 class 2 = 0.552 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 all KL = 0.482 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 all L1 = 0.403 +- 0.327 (in-sample avg dev_std = 0.563)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.502
NEC for r=0.9 class 0 = 0.604 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 1 = 0.335 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 2 = 0.628 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all KL = 0.643 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all L1 = 0.522 +- 0.254 (in-sample avg dev_std = 0.733)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.709
NEC for r=0.3 class 0 = 0.48 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1 = 0.039 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 2 = 0.68 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.419 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.401 +- 0.353 (in-sample avg dev_std = 0.312)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.679
NEC for r=0.6 class 0 = 0.515 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 1 = 0.04 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 2 = 0.699 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.451 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.42 +- 0.355 (in-sample avg dev_std = 0.339)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.596
NEC for r=0.9 class 0 = 0.554 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 1 = 0.259 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 2 = 0.672 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all KL = 0.591 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all L1 = 0.496 +- 0.252 (in-sample avg dev_std = 0.671)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:58:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:58:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.364
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 class 1 = 0.435 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 class 2 = 0.313 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 all KL = 0.223 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 all L1 = 0.354 +- 0.170 (in-sample avg dev_std = 0.732)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.319
SUFF_SIMPLE for r=0.6 class 0 = 0.301 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 class 1 = 0.478 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 class 2 = 0.308 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 all KL = 0.258 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.245 (in-sample avg dev_std = 0.578)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.263
SUFF_SIMPLE for r=0.9 class 0 = 0.517 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 class 1 = 0.238 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 class 2 = 0.339 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 all KL = 0.296 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 all L1 = 0.358 +- 0.316 (in-sample avg dev_std = 0.020)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.285
SUFF_SIMPLE for r=0.3 class 0 = 0.508 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 class 1 = 0.217 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 class 2 = 0.434 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 all KL = 0.273 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 all L1 = 0.387 +- 0.206 (in-sample avg dev_std = 0.658)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.36
SUFF_SIMPLE for r=0.6 class 0 = 0.481 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 class 1 = 0.301 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 class 2 = 0.595 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 all KL = 0.364 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 all L1 = 0.46 +- 0.259 (in-sample avg dev_std = 0.634)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.898 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.193 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.735 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.380 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.656
NEC for r=0.3 class 0 = 0.466 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 class 1 = 0.049 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 class 2 = 0.493 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 all KL = 0.396 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 all L1 = 0.336 +- 0.318 (in-sample avg dev_std = 0.532)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.597
NEC for r=0.6 class 0 = 0.522 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 1 = 0.123 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 2 = 0.55 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all KL = 0.476 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all L1 = 0.398 +- 0.318 (in-sample avg dev_std = 0.589)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.487
NEC for r=0.9 class 0 = 0.589 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 1 = 0.366 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 2 = 0.647 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all KL = 0.655 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all L1 = 0.534 +- 0.247 (in-sample avg dev_std = 0.734)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.731
NEC for r=0.3 class 0 = 0.38 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 1 = 0.094 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 2 = 0.666 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all KL = 0.405 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all L1 = 0.381 +- 0.334 (in-sample avg dev_std = 0.319)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.696
NEC for r=0.6 class 0 = 0.434 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 1 = 0.094 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 2 = 0.686 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all KL = 0.445 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all L1 = 0.406 +- 0.334 (in-sample avg dev_std = 0.370)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.506 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.299 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.693 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.6 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.5 +- 0.245 (in-sample avg dev_std = 0.650)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:00:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:00:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9280 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.317 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 class 1 = 0.38 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 class 2 = 0.332 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 all KL = 0.231 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 all L1 = 0.343 +- 0.169 (in-sample avg dev_std = 0.678)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.35
SUFF_SIMPLE for r=0.6 class 0 = 0.62 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 class 1 = 0.288 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 class 2 = 0.284 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 all KL = 0.307 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 all L1 = 0.393 +- 0.286 (in-sample avg dev_std = 0.511)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.286
SUFF_SIMPLE for r=0.9 class 0 = 0.787 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.328 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.350 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.279
SUFF_SIMPLE for r=0.3 class 0 = 0.535 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 1 = 0.21 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 2 = 0.6 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all KL = 0.351 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all L1 = 0.449 +- 0.253 (in-sample avg dev_std = 0.600)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.27
SUFF_SIMPLE for r=0.6 class 0 = 0.528 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 1 = 0.2 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 2 = 0.609 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all KL = 0.362 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all L1 = 0.447 +- 0.259 (in-sample avg dev_std = 0.527)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.197 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.475 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.386 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.436 +- 0.360 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.756
NEC for r=0.3 class 0 = 0.444 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 1 = 0.026 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 2 = 0.211 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all KL = 0.272 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all L1 = 0.224 +- 0.280 (in-sample avg dev_std = 0.483)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.66
NEC for r=0.6 class 0 = 0.533 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 1 = 0.097 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 2 = 0.38 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all KL = 0.409 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all L1 = 0.334 +- 0.306 (in-sample avg dev_std = 0.595)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.528
NEC for r=0.9 class 0 = 0.608 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 class 1 = 0.31 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 class 2 = 0.561 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 all KL = 0.603 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 all L1 = 0.492 +- 0.255 (in-sample avg dev_std = 0.729)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.764
NEC for r=0.3 class 0 = 0.28 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.01 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.012 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.081 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.101 +- 0.210 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.723
NEC for r=0.6 class 0 = 0.376 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 1 = 0.016 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 2 = 0.088 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all KL = 0.172 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all L1 = 0.161 +- 0.247 (in-sample avg dev_std = 0.359)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.494 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 1 = 0.248 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 2 = 0.356 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all KL = 0.455 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all L1 = 0.367 +- 0.230 (in-sample avg dev_std = 0.687)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:03:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:03:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.299 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 class 1 = 0.335 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 class 2 = 0.437 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 all KL = 0.249 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 all L1 = 0.359 +- 0.218 (in-sample avg dev_std = 0.622)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.32
SUFF_SIMPLE for r=0.6 class 0 = 0.345 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 1 = 0.246 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 2 = 0.486 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all KL = 0.272 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.251 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.289
SUFF_SIMPLE for r=0.9 class 0 = 0.795 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all KL = 0.324 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.351 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.275
SUFF_SIMPLE for r=0.3 class 0 = 0.393 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 class 1 = 0.194 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 class 2 = 0.633 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 all KL = 0.318 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 all L1 = 0.407 +- 0.258 (in-sample avg dev_std = 0.530)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.297
SUFF_SIMPLE for r=0.6 class 0 = 0.414 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 class 1 = 0.19 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 class 2 = 0.736 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 all KL = 0.375 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 all L1 = 0.448 +- 0.299 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.074
SUFF_SIMPLE for r=0.9 class 0 = 0.81 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.182 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.269 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.252 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.328 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.766
NEC for r=0.3 class 0 = 0.465 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 1 = 0.025 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 2 = 0.179 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all KL = 0.26 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all L1 = 0.219 +- 0.282 (in-sample avg dev_std = 0.461)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.659
NEC for r=0.6 class 0 = 0.539 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 class 1 = 0.107 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 class 2 = 0.375 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 all KL = 0.414 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 all L1 = 0.338 +- 0.307 (in-sample avg dev_std = 0.602)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.618 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 1 = 0.324 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 2 = 0.571 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all KL = 0.621 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all L1 = 0.503 +- 0.258 (in-sample avg dev_std = 0.731)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0 = 0.138 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 1 = 0.007 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 2 = 0.005 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all KL = 0.025 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all L1 = 0.05 +- 0.116 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.698
NEC for r=0.6 class 0 = 0.286 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.016 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.081 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.139 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.128 +- 0.195 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.543
NEC for r=0.9 class 0 = 0.468 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 1 = 0.251 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 2 = 0.402 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all KL = 0.474 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all L1 = 0.374 +- 0.210 (in-sample avg dev_std = 0.735)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:05:54 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:05:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.9253 0.9253 0.9253 0.9260 0.9260[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.342
SUFF_SIMPLE for r=0.3 class 0 = 0.399 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 class 1 = 0.402 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 class 2 = 0.238 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 all KL = 0.232 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 all L1 = 0.344 +- 0.179 (in-sample avg dev_std = 0.664)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.442
SUFF_SIMPLE for r=0.6 class 0 = 0.606 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 1 = 0.438 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 2 = 0.261 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all KL = 0.377 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all L1 = 0.431 +- 0.270 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.261
SUFF_SIMPLE for r=0.9 class 0 = 0.76 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.205 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.375 +- 0.343 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.288
SUFF_SIMPLE for r=0.3 class 0 = 0.365 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 class 1 = 0.243 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 class 2 = 0.299 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 all KL = 0.197 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 all L1 = 0.303 +- 0.119 (in-sample avg dev_std = 0.640)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.278
SUFF_SIMPLE for r=0.6 class 0 = 0.379 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 class 1 = 0.287 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 class 2 = 0.234 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 all KL = 0.19 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 all L1 = 0.3 +- 0.133 (in-sample avg dev_std = 0.646)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.047
SUFF_SIMPLE for r=0.9 class 0 = 0.269 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.101 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.196 +- 0.097 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.732
NEC for r=0.3 class 0 = 0.418 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 class 1 = 0.032 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 class 2 = 0.31 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 all KL = 0.307 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 all L1 = 0.251 +- 0.287 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.637
NEC for r=0.6 class 0 = 0.517 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 class 1 = 0.099 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 class 2 = 0.455 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 all KL = 0.432 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 all L1 = 0.356 +- 0.310 (in-sample avg dev_std = 0.607)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.504
NEC for r=0.9 class 0 = 0.608 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 1 = 0.317 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 2 = 0.613 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all KL = 0.624 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all L1 = 0.512 +- 0.252 (in-sample avg dev_std = 0.731)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.898
NEC for r=0.3 class 0 = 0.134 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1 = 0.005 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 2 = 0.025 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.055 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.055 +- 0.153 (in-sample avg dev_std = 0.194)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.827
NEC for r=0.6 class 0 = 0.254 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.014 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.19 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.196 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.153 +- 0.217 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.492 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 1 = 0.25 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 2 = 0.468 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all KL = 0.518 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all L1 = 0.404 +- 0.217 (in-sample avg dev_std = 0.755)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:08:22 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:08:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:08:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9277 0.9277[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.358
SUFF_SIMPLE for r=0.3 class 0 = 0.339 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 1 = 0.304 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 2 = 0.412 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all KL = 0.226 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all L1 = 0.352 +- 0.186 (in-sample avg dev_std = 0.692)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.348
SUFF_SIMPLE for r=0.6 class 0 = 0.371 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 1 = 0.292 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 2 = 0.422 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all KL = 0.271 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all L1 = 0.362 +- 0.220 (in-sample avg dev_std = 0.527)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.342
SUFF_SIMPLE for r=0.9 class 0 = 0.753 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 1 = 0.322 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 2 = 0.226 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all KL = 0.356 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all L1 = 0.413 +- 0.349 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.314
SUFF_SIMPLE for r=0.3 class 0 = 0.218 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 class 2 = 0.725 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 all KL = 0.277 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 all L1 = 0.378 +- 0.301 (in-sample avg dev_std = 0.408)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.388
SUFF_SIMPLE for r=0.6 class 0 = 0.227 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 class 1 = 0.221 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 class 2 = 0.901 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 all KL = 0.373 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 all L1 = 0.45 +- 0.366 (in-sample avg dev_std = 0.275)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.253
SUFF_SIMPLE for r=0.9 class 0 = 0.204 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.438 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.761
NEC for r=0.3 class 0 = 0.354 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.112 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.225 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.274 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.228 +- 0.246 (in-sample avg dev_std = 0.490)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.672
NEC for r=0.6 class 0 = 0.455 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 class 1 = 0.174 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 class 2 = 0.353 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 all KL = 0.4 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 all L1 = 0.326 +- 0.287 (in-sample avg dev_std = 0.587)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.525
NEC for r=0.9 class 0 = 0.537 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 class 1 = 0.398 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 class 2 = 0.569 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 all KL = 0.629 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 all L1 = 0.502 +- 0.232 (in-sample avg dev_std = 0.761)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.775
NEC for r=0.3 class 0 = 0.309 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1 = 0.318 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 2 = 0.02 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.235 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.216 +- 0.319 (in-sample avg dev_std = 0.236)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.739
NEC for r=0.6 class 0 = 0.393 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.331 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.093 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.316 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.272 +- 0.315 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.809
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.575
NEC for r=0.9 class 0 = 0.556 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 1 = 0.502 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 2 = 0.371 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all KL = 0.593 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all L1 = 0.477 +- 0.228 (in-sample avg dev_std = 0.722)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:10:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:10:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.352
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 1 = 0.329 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 2 = 0.421 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all KL = 0.237 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all L1 = 0.356 +- 0.179 (in-sample avg dev_std = 0.692)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.299
SUFF_SIMPLE for r=0.6 class 0 = 0.308 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 1 = 0.242 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 2 = 0.491 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all KL = 0.242 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.253 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.229
SUFF_SIMPLE for r=0.9 class 0 = 0.556 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.228 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.284 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.267 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.345 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.28
SUFF_SIMPLE for r=0.3 class 0 = 0.251 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 class 1 = 0.201 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 class 2 = 0.474 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 all KL = 0.225 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 all L1 = 0.309 +- 0.152 (in-sample avg dev_std = 0.474)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.326
SUFF_SIMPLE for r=0.6 class 0 = 0.26 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 class 1 = 0.204 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 class 2 = 0.626 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 all KL = 0.293 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.241 (in-sample avg dev_std = 0.422)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.038
SUFF_SIMPLE for r=0.9 class 0 = 0.324 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.172 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.131 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.208 +- 0.076 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.754
NEC for r=0.3 class 0 = 0.419 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 1 = 0.067 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 2 = 0.166 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all KL = 0.245 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all L1 = 0.214 +- 0.271 (in-sample avg dev_std = 0.417)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.666
NEC for r=0.6 class 0 = 0.487 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 1 = 0.129 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 2 = 0.34 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all KL = 0.374 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all L1 = 0.316 +- 0.299 (in-sample avg dev_std = 0.537)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.557 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 class 1 = 0.349 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 class 2 = 0.551 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 all KL = 0.597 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 all L1 = 0.485 +- 0.245 (in-sample avg dev_std = 0.727)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.791
NEC for r=0.3 class 0 = 0.331 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.015 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.012 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.124 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.12 +- 0.245 (in-sample avg dev_std = 0.161)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 0 = 0.393 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1 = 0.019 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 2 = 0.08 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.189 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.165 +- 0.267 (in-sample avg dev_std = 0.319)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.54 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.247 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.428 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.515 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.406 +- 0.229 (in-sample avg dev_std = 0.720)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.245, 0.306], 'all_L1': [0.37, 0.354, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.234, 0.24, 0.326], 'all_L1': [0.36, 0.351, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.218, 0.233, 0.308], 'all_L1': [0.354, 0.345, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.238, 0.249, 0.282], 'all_L1': [0.369, 0.36, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.223, 0.258, 0.296], 'all_L1': [0.354, 0.363, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.231, 0.307, 0.328], 'all_L1': [0.343, 0.393, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.249, 0.272, 0.324], 'all_L1': [0.359, 0.361, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.377, 0.308], 'all_L1': [0.344, 0.431, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.226, 0.271, 0.356], 'all_L1': [0.352, 0.362, 0.413]}), defaultdict(<class 'list'>, {'all_KL': [0.237, 0.242, 0.267], 'all_L1': [0.356, 0.349, 0.345]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.245, 0.374, 0.6], 'all_L1': [0.197, 0.302, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.228, 0.371, 0.597], 'all_L1': [0.183, 0.299, 0.473]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.418, 0.637], 'all_L1': [0.211, 0.328, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.482, 0.643], 'all_L1': [0.343, 0.403, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.476, 0.655], 'all_L1': [0.336, 0.398, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.409, 0.603], 'all_L1': [0.224, 0.334, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.414, 0.621], 'all_L1': [0.219, 0.338, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.307, 0.432, 0.624], 'all_L1': [0.251, 0.356, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.274, 0.4, 0.629], 'all_L1': [0.228, 0.326, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.245, 0.374, 0.597], 'all_L1': [0.214, 0.316, 0.485]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.276, 0.341, 0.444], 'all_L1': [0.384, 0.442, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.297, 0.283], 'all_L1': [0.346, 0.387, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.452, 0.474], 'all_L1': [0.442, 0.511, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.251, 0.333, 0.561], 'all_L1': [0.359, 0.425, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.273, 0.364, 0.542], 'all_L1': [0.387, 0.46, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.362, 0.386], 'all_L1': [0.449, 0.447, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.318, 0.375, 0.252], 'all_L1': [0.407, 0.448, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.197, 0.19, 0.101], 'all_L1': [0.303, 0.3, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.277, 0.373, 0.246], 'all_L1': [0.378, 0.45, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.225, 0.293, 0.131], 'all_L1': [0.309, 0.363, 0.208]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.122, 0.163, 0.411], 'all_L1': [0.107, 0.138, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.173, 0.496], 'all_L1': [0.069, 0.145, 0.388]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.151, 0.45], 'all_L1': [0.05, 0.126, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.451, 0.591], 'all_L1': [0.401, 0.42, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.445, 0.6], 'all_L1': [0.381, 0.406, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.172, 0.455], 'all_L1': [0.101, 0.161, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.139, 0.474], 'all_L1': [0.05, 0.128, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.196, 0.518], 'all_L1': [0.055, 0.153, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.316, 0.593], 'all_L1': [0.216, 0.272, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.189, 0.515], 'all_L1': [0.12, 0.165, 0.406]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.356 +- 0.009, 0.367 +- 0.025, 0.377 +- 0.020
suff_simple class all_KL  =  0.233 +- 0.009, 0.269 +- 0.041, 0.310 +- 0.024
[[0.35116666555404663, 0.3084999918937683, 0.2775685787200928], [0.34545832872390747, 0.29345834255218506, 0.295320063829422], [0.34029167890548706, 0.304874986410141, 0.2840236723423004], [0.39012500643730164, 0.3190833330154419, 0.23587951064109802], [0.3636666536331177, 0.31850001215934753, 0.26284292340278625], [0.3386666774749756, 0.3499166667461395, 0.28563743829727173], [0.3402083218097687, 0.31954166293144226, 0.28940290212631226], [0.3424583375453949, 0.44216665625572205, 0.26143088936805725], [0.35762500762939453, 0.3479583263397217, 0.3417159616947174], [0.35233333706855774, 0.2994166612625122, 0.22861753404140472]]
[[0.244, 0.245, 0.306], [0.234, 0.24, 0.326], [0.218, 0.233, 0.308], [0.238, 0.249, 0.282], [0.223, 0.258, 0.296], [0.231, 0.307, 0.328], [0.249, 0.272, 0.324], [0.232, 0.377, 0.308], [0.226, 0.271, 0.356], [0.237, 0.242, 0.267]]
suff_simple_acc_int  =  0.352 +- 0.015, 0.330 +- 0.041, 0.276 +- 0.030
nec class all_L1  =  0.241 +- 0.052, 0.340 +- 0.034, 0.500 +- 0.018
nec class all_KL  =  0.290 +- 0.058, 0.415 +- 0.038, 0.621 +- 0.020
[[0.7738333344459534, 0.6859999895095825, 0.5419999957084656], [0.7964583039283752, 0.6953750252723694, 0.5531250238418579], [0.7725416421890259, 0.6740416884422302, 0.5364999771118164], [0.643541693687439, 0.5843750238418579, 0.5024999976158142], [0.656166672706604, 0.5973333120346069, 0.4872083365917206], [0.7562500238418579, 0.6598749756813049, 0.528124988079071], [0.7662500143051147, 0.6591249704360962, 0.5146250128746033], [0.7322499752044678, 0.6371250152587891, 0.5041666626930237], [0.7606666684150696, 0.671999990940094, 0.5247499942779541], [0.7536249756813049, 0.6657083630561829, 0.5358333587646484]]
[[0.245, 0.374, 0.6], [0.228, 0.371, 0.597], [0.268, 0.418, 0.637], [0.402, 0.482, 0.643], [0.396, 0.476, 0.655], [0.272, 0.409, 0.603], [0.26, 0.414, 0.621], [0.307, 0.432, 0.624], [0.274, 0.4, 0.629], [0.245, 0.374, 0.597]]
nec_acc_int  =  0.741 +- 0.048, 0.653 +- 0.035, 0.523 +- 0.019

Eval split val
suff_simple class all_L1  =  0.376 +- 0.047, 0.423 +- 0.056, 0.393 +- 0.130
suff_simple class all_KL  =  0.277 +- 0.049, 0.338 +- 0.065, 0.342 +- 0.155
[[0.21037499606609344, 0.2670416533946991, 0.3183828294277191], [0.28299999237060547, 0.3109583258628845, 0.23878711462020874], [0.3135833442211151, 0.3527916669845581, 0.25457990169525146], [0.29637500643730164, 0.37833333015441895, 0.21920403838157654], [0.2850416600704193, 0.359541654586792, 0.1711939424276352], [0.27937498688697815, 0.2696250081062317, 0.19835755228996277], [0.27541667222976685, 0.2970833480358124, 0.07391029596328735], [0.28845834732055664, 0.27804166078567505, 0.04737839475274086], [0.3137083351612091, 0.38845834136009216, 0.2533164918422699], [0.2801249921321869, 0.32612499594688416, 0.03790271654725075]]
[[0.276, 0.341, 0.444], [0.242, 0.297, 0.283], [0.355, 0.452, 0.474], [0.251, 0.333, 0.561], [0.273, 0.364, 0.542], [0.351, 0.362, 0.386], [0.318, 0.375, 0.252], [0.197, 0.19, 0.101], [0.277, 0.373, 0.246], [0.225, 0.293, 0.131]]
suff_simple_acc_int  =  0.283 +- 0.027, 0.323 +- 0.043, 0.181 +- 0.092
nec class all_L1  =  0.155 +- 0.127, 0.211 +- 0.108, 0.409 +- 0.059
nec class all_KL  =  0.157 +- 0.139, 0.239 +- 0.114, 0.510 +- 0.063
[[0.6487916707992554, 0.6278333067893982, 0.5097083449363708], [0.8736249804496765, 0.8216249942779541, 0.6402083039283752], [0.7904166579246521, 0.7432916760444641, 0.5920833349227905], [0.7092499732971191, 0.6792916655540466, 0.5962083339691162], [0.7305416464805603, 0.6957916617393494, 0.5852916836738586], [0.7642916440963745, 0.7228333353996277, 0.5662916898727417], [0.7418749928474426, 0.6977083086967468, 0.5426250100135803], [0.8976666927337646, 0.8272083401679993, 0.6355000138282776], [0.7747083306312561, 0.7391666769981384, 0.575208306312561], [0.7914999723434448, 0.7635833621025085, 0.6010833382606506]]
[[0.122, 0.163, 0.411], [0.063, 0.173, 0.496], [0.042, 0.151, 0.45], [0.419, 0.451, 0.591], [0.405, 0.445, 0.6], [0.081, 0.172, 0.455], [0.025, 0.139, 0.474], [0.055, 0.196, 0.518], [0.235, 0.316, 0.593], [0.124, 0.189, 0.515]]
nec_acc_int  =  0.772 +- 0.070, 0.732 +- 0.059, 0.584 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.298 +- 0.027, 0.353 +- 0.023, 0.439 +- 0.011
Faith. Armon (L1)= 		  =  0.284 +- 0.035, 0.352 +- 0.023, 0.429 +- 0.013
Faith. GMean (L1)= 	  =  0.291 +- 0.031, 0.353 +- 0.023, 0.434 +- 0.012
Faith. Aritm (KL)= 		  =  0.261 +- 0.028, 0.342 +- 0.030, 0.465 +- 0.015
Faith. Armon (KL)= 		  =  0.256 +- 0.020, 0.325 +- 0.032, 0.413 +- 0.021
Faith. GMean (KL)= 	  =  0.259 +- 0.024, 0.333 +- 0.031, 0.438 +- 0.018

Eval split val
Faith. Aritm (L1)= 		  =  0.266 +- 0.066, 0.317 +- 0.065, 0.401 +- 0.074
Faith. Armon (L1)= 		  =  0.193 +- 0.108, 0.268 +- 0.088, 0.388 +- 0.083
Faith. GMean (L1)= 	  =  0.223 +- 0.090, 0.291 +- 0.076, 0.394 +- 0.079
Faith. Aritm (KL)= 		  =  0.217 +- 0.069, 0.289 +- 0.067, 0.426 +- 0.086
Faith. Armon (KL)= 		  =  0.166 +- 0.095, 0.265 +- 0.074, 0.387 +- 0.127
Faith. GMean (KL)= 	  =  0.187 +- 0.084, 0.276 +- 0.070, 0.404 +- 0.108
Computed for split load_split = id



Completed in  0:20:58.005938  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN simple_concept2temperature GOODMotif/basis/covariate NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:12:47 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:12:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9243 0.9243 0.9243 0.9243 0.9267 0.9267[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.351
SUFF_SIMPLE for r=0.3 class 0 = 0.273 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 1 = 0.361 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 2 = 0.467 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all KL = 0.244 +- 0.246 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all L1 = 0.37 +- 0.223 (in-sample avg dev_std = 0.696)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.308
SUFF_SIMPLE for r=0.6 class 0 = 0.278 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 1 = 0.254 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 class 2 = 0.52 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all KL = 0.245 +- 0.294 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.6 all L1 = 0.354 +- 0.257 (in-sample avg dev_std = 0.567)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.278
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.278 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.28 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.306 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.374 +- 0.342 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.21
SUFF_SIMPLE for r=0.3 class 0 = 0.492 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 1 = 0.327 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 2 = 0.331 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all KL = 0.276 +- 0.275 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all L1 = 0.384 +- 0.250 (in-sample avg dev_std = 0.609)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.267
SUFF_SIMPLE for r=0.6 class 0 = 0.506 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 1 = 0.346 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 class 2 = 0.473 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all KL = 0.341 +- 0.343 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.6 all L1 = 0.442 +- 0.302 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.318
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.195 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.492 +- 0.388 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.774
NEC for r=0.3 class 0 = 0.463 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 class 1 = 0.039 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 class 2 = 0.105 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 all KL = 0.245 +- 0.338 (in-sample avg dev_std = 0.463)
NEC for r=0.3 all L1 = 0.197 +- 0.276 (in-sample avg dev_std = 0.463)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.686
NEC for r=0.6 class 0 = 0.545 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 class 1 = 0.077 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 class 2 = 0.294 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 all KL = 0.374 +- 0.367 (in-sample avg dev_std = 0.581)
NEC for r=0.6 all L1 = 0.302 +- 0.303 (in-sample avg dev_std = 0.581)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.624 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 1 = 0.298 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 2 = 0.525 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all KL = 0.6 +- 0.295 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all L1 = 0.481 +- 0.254 (in-sample avg dev_std = 0.754)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.649
NEC for r=0.3 class 0 = 0.295 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 1 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 class 2 = 0.011 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all KL = 0.122 +- 0.305 (in-sample avg dev_std = 0.207)
NEC for r=0.3 all L1 = 0.107 +- 0.263 (in-sample avg dev_std = 0.207)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.628
NEC for r=0.6 class 0 = 0.306 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 1 = 0.015 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 class 2 = 0.089 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all KL = 0.163 +- 0.322 (in-sample avg dev_std = 0.302)
NEC for r=0.6 all L1 = 0.138 +- 0.275 (in-sample avg dev_std = 0.302)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.388 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 1 = 0.177 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 class 2 = 0.419 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all KL = 0.411 +- 0.333 (in-sample avg dev_std = 0.639)
NEC for r=0.9 all L1 = 0.329 +- 0.277 (in-sample avg dev_std = 0.639)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:14:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:14:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.9267 0.9267 0.9267 0.9273 0.9273[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.317 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 class 1 = 0.343 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 class 2 = 0.416 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 all KL = 0.234 +- 0.231 (in-sample avg dev_std = 0.694)
SUFF_SIMPLE for r=0.3 all L1 = 0.36 +- 0.206 (in-sample avg dev_std = 0.694)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.367 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 1 = 0.236 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 class 2 = 0.448 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all KL = 0.24 +- 0.296 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.6 all L1 = 0.351 +- 0.264 (in-sample avg dev_std = 0.536)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.295
SUFF_SIMPLE for r=0.9 class 0 = 0.781 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 2 = 0.231 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all KL = 0.326 +- 0.404 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.351 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.283
SUFF_SIMPLE for r=0.3 class 0 = 0.239 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 class 2 = 0.607 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 all KL = 0.242 +- 0.275 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.3 all L1 = 0.346 +- 0.249 (in-sample avg dev_std = 0.473)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.239 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 class 1 = 0.191 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 all KL = 0.297 +- 0.343 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 all L1 = 0.387 +- 0.301 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.239 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.185 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.344 +- 0.292 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.796
NEC for r=0.3 class 0 = 0.363 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 1 = 0.036 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 class 2 = 0.16 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all KL = 0.228 +- 0.317 (in-sample avg dev_std = 0.452)
NEC for r=0.3 all L1 = 0.183 +- 0.255 (in-sample avg dev_std = 0.452)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.695
NEC for r=0.6 class 0 = 0.465 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 1 = 0.095 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 2 = 0.342 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all KL = 0.371 +- 0.363 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all L1 = 0.299 +- 0.296 (in-sample avg dev_std = 0.576)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.553
NEC for r=0.9 class 0 = 0.548 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 class 1 = 0.305 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 class 2 = 0.568 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 all KL = 0.597 +- 0.291 (in-sample avg dev_std = 0.756)
NEC for r=0.9 all L1 = 0.473 +- 0.247 (in-sample avg dev_std = 0.756)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.874
NEC for r=0.3 class 0 = 0.185 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 1 = 0.012 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 2 = 0.007 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all KL = 0.063 +- 0.176 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all L1 = 0.069 +- 0.182 (in-sample avg dev_std = 0.132)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.822
NEC for r=0.6 class 0 = 0.33 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.021 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.081 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.173 +- 0.264 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.145 +- 0.225 (in-sample avg dev_std = 0.390)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.64
NEC for r=0.9 class 0 = 0.55 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.257 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.356 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.496 +- 0.273 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.388 +- 0.229 (in-sample avg dev_std = 0.720)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:16:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:16:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9287 0.9287[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.28 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 1 = 0.328 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 class 2 = 0.448 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all KL = 0.218 +- 0.243 (in-sample avg dev_std = 0.696)
SUFF_SIMPLE for r=0.3 all L1 = 0.354 +- 0.222 (in-sample avg dev_std = 0.696)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.305
SUFF_SIMPLE for r=0.6 class 0 = 0.317 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 1 = 0.229 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 2 = 0.484 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all KL = 0.233 +- 0.295 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all L1 = 0.345 +- 0.253 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF_SIMPLE for r=0.9 class 0 = 0.699 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 class 2 = 0.263 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.413 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.9 all L1 = 0.384 +- 0.355 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.314
SUFF_SIMPLE for r=0.3 class 0 = 0.401 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 class 1 = 0.277 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 class 2 = 0.646 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 all KL = 0.355 +- 0.351 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.3 all L1 = 0.442 +- 0.303 (in-sample avg dev_std = 0.466)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.353
SUFF_SIMPLE for r=0.6 class 0 = 0.411 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 1 = 0.285 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 class 2 = 0.835 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all KL = 0.452 +- 0.426 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.6 all L1 = 0.511 +- 0.361 (in-sample avg dev_std = 0.351)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 0 = 0.832 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.339 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.553 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.474 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.518 +- 0.386 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.773
NEC for r=0.3 class 0 = 0.418 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.081 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.145 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.268 +- 0.335 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.211 +- 0.271 (in-sample avg dev_std = 0.508)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.674
NEC for r=0.6 class 0 = 0.536 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 class 1 = 0.139 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 class 2 = 0.319 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 all KL = 0.418 +- 0.367 (in-sample avg dev_std = 0.635)
NEC for r=0.6 all L1 = 0.328 +- 0.299 (in-sample avg dev_std = 0.635)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.606 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 class 1 = 0.346 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 class 2 = 0.551 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 all KL = 0.637 +- 0.290 (in-sample avg dev_std = 0.785)
NEC for r=0.9 all L1 = 0.5 +- 0.248 (in-sample avg dev_std = 0.785)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.79
NEC for r=0.3 class 0 = 0.103 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1 = 0.037 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 2 = 0.008 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.042 +- 0.136 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.05 +- 0.138 (in-sample avg dev_std = 0.159)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.743
NEC for r=0.6 class 0 = 0.239 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 1 = 0.052 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 2 = 0.086 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all KL = 0.151 +- 0.244 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all L1 = 0.126 +- 0.195 (in-sample avg dev_std = 0.406)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.592
NEC for r=0.9 class 0 = 0.436 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.254 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.348 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.45 +- 0.294 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.346 +- 0.231 (in-sample avg dev_std = 0.715)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:17:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:17:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9250 0.9250[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.39
SUFF_SIMPLE for r=0.3 class 0 = 0.286 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 1 = 0.487 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 class 2 = 0.332 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all KL = 0.238 +- 0.211 (in-sample avg dev_std = 0.747)
SUFF_SIMPLE for r=0.3 all L1 = 0.369 +- 0.186 (in-sample avg dev_std = 0.747)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.319
SUFF_SIMPLE for r=0.6 class 0 = 0.28 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 class 1 = 0.502 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 class 2 = 0.296 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 all KL = 0.249 +- 0.294 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.6 all L1 = 0.36 +- 0.255 (in-sample avg dev_std = 0.597)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.236
SUFF_SIMPLE for r=0.9 class 0 = 0.469 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 class 2 = 0.354 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 all KL = 0.282 +- 0.381 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.9 all L1 = 0.35 +- 0.324 (in-sample avg dev_std = 0.022)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.296
SUFF_SIMPLE for r=0.3 class 0 = 0.463 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 class 1 = 0.227 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 class 2 = 0.386 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 all KL = 0.251 +- 0.205 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.3 all L1 = 0.359 +- 0.174 (in-sample avg dev_std = 0.685)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.378
SUFF_SIMPLE for r=0.6 class 0 = 0.42 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 class 1 = 0.326 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 class 2 = 0.528 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 all KL = 0.333 +- 0.284 (in-sample avg dev_std = 0.685)
SUFF_SIMPLE for r=0.6 all L1 = 0.425 +- 0.234 (in-sample avg dev_std = 0.685)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.742 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.561 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.363 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0 = 0.497 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 class 1 = 0.044 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 class 2 = 0.491 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 all KL = 0.402 +- 0.392 (in-sample avg dev_std = 0.504)
NEC for r=0.3 all L1 = 0.343 +- 0.329 (in-sample avg dev_std = 0.504)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.584
NEC for r=0.6 class 0 = 0.548 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 class 1 = 0.112 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 class 2 = 0.552 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 all KL = 0.482 +- 0.387 (in-sample avg dev_std = 0.563)
NEC for r=0.6 all L1 = 0.403 +- 0.327 (in-sample avg dev_std = 0.563)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.502
NEC for r=0.9 class 0 = 0.604 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 1 = 0.335 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 2 = 0.628 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all KL = 0.643 +- 0.297 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all L1 = 0.522 +- 0.254 (in-sample avg dev_std = 0.733)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.709
NEC for r=0.3 class 0 = 0.48 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1 = 0.039 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 2 = 0.68 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.419 +- 0.407 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.401 +- 0.353 (in-sample avg dev_std = 0.312)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.679
NEC for r=0.6 class 0 = 0.515 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 1 = 0.04 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 2 = 0.699 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.451 +- 0.405 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.42 +- 0.355 (in-sample avg dev_std = 0.339)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.596
NEC for r=0.9 class 0 = 0.554 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 1 = 0.259 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 2 = 0.672 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all KL = 0.591 +- 0.283 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all L1 = 0.496 +- 0.252 (in-sample avg dev_std = 0.671)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:19:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:19:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.364
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 class 1 = 0.435 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 class 2 = 0.313 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 all KL = 0.223 +- 0.192 (in-sample avg dev_std = 0.732)
SUFF_SIMPLE for r=0.3 all L1 = 0.354 +- 0.170 (in-sample avg dev_std = 0.732)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.319
SUFF_SIMPLE for r=0.6 class 0 = 0.301 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 class 1 = 0.478 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 class 2 = 0.308 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 all KL = 0.258 +- 0.284 (in-sample avg dev_std = 0.578)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.245 (in-sample avg dev_std = 0.578)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.263
SUFF_SIMPLE for r=0.9 class 0 = 0.517 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 class 1 = 0.238 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 class 2 = 0.339 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 all KL = 0.296 +- 0.377 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.9 all L1 = 0.358 +- 0.316 (in-sample avg dev_std = 0.020)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.285
SUFF_SIMPLE for r=0.3 class 0 = 0.508 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 class 1 = 0.217 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 class 2 = 0.434 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 all KL = 0.273 +- 0.230 (in-sample avg dev_std = 0.658)
SUFF_SIMPLE for r=0.3 all L1 = 0.387 +- 0.206 (in-sample avg dev_std = 0.658)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.36
SUFF_SIMPLE for r=0.6 class 0 = 0.481 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 class 1 = 0.301 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 class 2 = 0.595 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 all KL = 0.364 +- 0.309 (in-sample avg dev_std = 0.634)
SUFF_SIMPLE for r=0.6 all L1 = 0.46 +- 0.259 (in-sample avg dev_std = 0.634)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.898 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.193 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.735 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.380 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.656
NEC for r=0.3 class 0 = 0.466 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 class 1 = 0.049 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 class 2 = 0.493 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 all KL = 0.396 +- 0.381 (in-sample avg dev_std = 0.532)
NEC for r=0.3 all L1 = 0.336 +- 0.318 (in-sample avg dev_std = 0.532)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.597
NEC for r=0.6 class 0 = 0.522 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 1 = 0.123 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 class 2 = 0.55 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all KL = 0.476 +- 0.377 (in-sample avg dev_std = 0.589)
NEC for r=0.6 all L1 = 0.398 +- 0.318 (in-sample avg dev_std = 0.589)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.487
NEC for r=0.9 class 0 = 0.589 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 1 = 0.366 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 class 2 = 0.647 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all KL = 0.655 +- 0.284 (in-sample avg dev_std = 0.734)
NEC for r=0.9 all L1 = 0.534 +- 0.247 (in-sample avg dev_std = 0.734)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.731
NEC for r=0.3 class 0 = 0.38 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 1 = 0.094 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 class 2 = 0.666 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all KL = 0.405 +- 0.397 (in-sample avg dev_std = 0.319)
NEC for r=0.3 all L1 = 0.381 +- 0.334 (in-sample avg dev_std = 0.319)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.696
NEC for r=0.6 class 0 = 0.434 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 1 = 0.094 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 2 = 0.686 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all KL = 0.445 +- 0.393 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all L1 = 0.406 +- 0.334 (in-sample avg dev_std = 0.370)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.585
NEC for r=0.9 class 0 = 0.506 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 1 = 0.299 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 class 2 = 0.693 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all KL = 0.6 +- 0.280 (in-sample avg dev_std = 0.650)
NEC for r=0.9 all L1 = 0.5 +- 0.245 (in-sample avg dev_std = 0.650)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:22:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:22:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9280 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.317 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 class 1 = 0.38 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 class 2 = 0.332 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 all KL = 0.231 +- 0.191 (in-sample avg dev_std = 0.678)
SUFF_SIMPLE for r=0.3 all L1 = 0.343 +- 0.169 (in-sample avg dev_std = 0.678)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.35
SUFF_SIMPLE for r=0.6 class 0 = 0.62 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 class 1 = 0.288 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 class 2 = 0.284 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 all KL = 0.307 +- 0.330 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.6 all L1 = 0.393 +- 0.286 (in-sample avg dev_std = 0.511)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.286
SUFF_SIMPLE for r=0.9 class 0 = 0.787 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.328 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.350 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.279
SUFF_SIMPLE for r=0.3 class 0 = 0.535 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 1 = 0.21 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 2 = 0.6 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all KL = 0.351 +- 0.285 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all L1 = 0.449 +- 0.253 (in-sample avg dev_std = 0.600)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.27
SUFF_SIMPLE for r=0.6 class 0 = 0.528 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 1 = 0.2 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 2 = 0.609 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all KL = 0.362 +- 0.290 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all L1 = 0.447 +- 0.259 (in-sample avg dev_std = 0.527)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.197 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.475 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.386 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.436 +- 0.360 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.756
NEC for r=0.3 class 0 = 0.444 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 1 = 0.026 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 class 2 = 0.211 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all KL = 0.272 +- 0.338 (in-sample avg dev_std = 0.483)
NEC for r=0.3 all L1 = 0.224 +- 0.280 (in-sample avg dev_std = 0.483)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.66
NEC for r=0.6 class 0 = 0.533 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 1 = 0.097 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 class 2 = 0.38 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all KL = 0.409 +- 0.370 (in-sample avg dev_std = 0.595)
NEC for r=0.6 all L1 = 0.334 +- 0.306 (in-sample avg dev_std = 0.595)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.528
NEC for r=0.9 class 0 = 0.608 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 class 1 = 0.31 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 class 2 = 0.561 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 all KL = 0.603 +- 0.299 (in-sample avg dev_std = 0.729)
NEC for r=0.9 all L1 = 0.492 +- 0.255 (in-sample avg dev_std = 0.729)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.764
NEC for r=0.3 class 0 = 0.28 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.01 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.012 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.081 +- 0.197 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.101 +- 0.210 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.723
NEC for r=0.6 class 0 = 0.376 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 1 = 0.016 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 class 2 = 0.088 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all KL = 0.172 +- 0.272 (in-sample avg dev_std = 0.359)
NEC for r=0.6 all L1 = 0.161 +- 0.247 (in-sample avg dev_std = 0.359)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.566
NEC for r=0.9 class 0 = 0.494 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 1 = 0.248 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 2 = 0.356 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all KL = 0.455 +- 0.267 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all L1 = 0.367 +- 0.230 (in-sample avg dev_std = 0.687)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:24:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:24:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.299 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 class 1 = 0.335 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 class 2 = 0.437 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 all KL = 0.249 +- 0.260 (in-sample avg dev_std = 0.622)
SUFF_SIMPLE for r=0.3 all L1 = 0.359 +- 0.218 (in-sample avg dev_std = 0.622)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.32
SUFF_SIMPLE for r=0.6 class 0 = 0.345 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 1 = 0.246 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 2 = 0.486 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all KL = 0.272 +- 0.311 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.251 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.289
SUFF_SIMPLE for r=0.9 class 0 = 0.795 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all KL = 0.324 +- 0.412 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.351 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.275
SUFF_SIMPLE for r=0.3 class 0 = 0.393 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 class 1 = 0.194 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 class 2 = 0.633 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 all KL = 0.318 +- 0.296 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.3 all L1 = 0.407 +- 0.258 (in-sample avg dev_std = 0.530)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.297
SUFF_SIMPLE for r=0.6 class 0 = 0.414 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 class 1 = 0.19 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 class 2 = 0.736 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 all KL = 0.375 +- 0.348 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.6 all L1 = 0.448 +- 0.299 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.074
SUFF_SIMPLE for r=0.9 class 0 = 0.81 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.182 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.269 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.252 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.328 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.766
NEC for r=0.3 class 0 = 0.465 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 1 = 0.025 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 class 2 = 0.179 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all KL = 0.26 +- 0.334 (in-sample avg dev_std = 0.461)
NEC for r=0.3 all L1 = 0.219 +- 0.282 (in-sample avg dev_std = 0.461)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.659
NEC for r=0.6 class 0 = 0.539 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 class 1 = 0.107 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 class 2 = 0.375 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 all KL = 0.414 +- 0.367 (in-sample avg dev_std = 0.602)
NEC for r=0.6 all L1 = 0.338 +- 0.307 (in-sample avg dev_std = 0.602)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.515
NEC for r=0.9 class 0 = 0.618 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 1 = 0.324 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 2 = 0.571 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all KL = 0.621 +- 0.298 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all L1 = 0.503 +- 0.258 (in-sample avg dev_std = 0.731)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0 = 0.138 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 1 = 0.007 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 2 = 0.005 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all KL = 0.025 +- 0.088 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all L1 = 0.05 +- 0.116 (in-sample avg dev_std = 0.131)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.698
NEC for r=0.6 class 0 = 0.286 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.016 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.081 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.139 +- 0.233 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.128 +- 0.195 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.543
NEC for r=0.9 class 0 = 0.468 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 1 = 0.251 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 class 2 = 0.402 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all KL = 0.474 +- 0.255 (in-sample avg dev_std = 0.735)
NEC for r=0.9 all L1 = 0.374 +- 0.210 (in-sample avg dev_std = 0.735)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:27:20 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:27:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.9253 0.9253 0.9253 0.9260 0.9260[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.342
SUFF_SIMPLE for r=0.3 class 0 = 0.399 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 class 1 = 0.402 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 class 2 = 0.238 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 all KL = 0.232 +- 0.199 (in-sample avg dev_std = 0.664)
SUFF_SIMPLE for r=0.3 all L1 = 0.344 +- 0.179 (in-sample avg dev_std = 0.664)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.442
SUFF_SIMPLE for r=0.6 class 0 = 0.606 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 1 = 0.438 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 class 2 = 0.261 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all KL = 0.377 +- 0.343 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.6 all L1 = 0.431 +- 0.270 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.261
SUFF_SIMPLE for r=0.9 class 0 = 0.76 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.205 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.375 +- 0.343 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.288
SUFF_SIMPLE for r=0.3 class 0 = 0.365 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 class 1 = 0.243 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 class 2 = 0.299 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 all KL = 0.197 +- 0.134 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.3 all L1 = 0.303 +- 0.119 (in-sample avg dev_std = 0.640)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.278
SUFF_SIMPLE for r=0.6 class 0 = 0.379 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 class 1 = 0.287 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 class 2 = 0.234 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 all KL = 0.19 +- 0.142 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.6 all L1 = 0.3 +- 0.133 (in-sample avg dev_std = 0.646)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.047
SUFF_SIMPLE for r=0.9 class 0 = 0.269 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.101 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.196 +- 0.097 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.732
NEC for r=0.3 class 0 = 0.418 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 class 1 = 0.032 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 class 2 = 0.31 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 all KL = 0.307 +- 0.346 (in-sample avg dev_std = 0.528)
NEC for r=0.3 all L1 = 0.251 +- 0.287 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.637
NEC for r=0.6 class 0 = 0.517 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 class 1 = 0.099 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 class 2 = 0.455 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 all KL = 0.432 +- 0.370 (in-sample avg dev_std = 0.607)
NEC for r=0.6 all L1 = 0.356 +- 0.310 (in-sample avg dev_std = 0.607)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.504
NEC for r=0.9 class 0 = 0.608 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 1 = 0.317 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 2 = 0.613 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all KL = 0.624 +- 0.290 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all L1 = 0.512 +- 0.252 (in-sample avg dev_std = 0.731)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.898
NEC for r=0.3 class 0 = 0.134 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1 = 0.005 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 2 = 0.025 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.055 +- 0.174 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.055 +- 0.153 (in-sample avg dev_std = 0.194)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.827
NEC for r=0.6 class 0 = 0.254 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.014 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.19 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.196 +- 0.273 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.153 +- 0.217 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0 = 0.492 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 1 = 0.25 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 class 2 = 0.468 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all KL = 0.518 +- 0.264 (in-sample avg dev_std = 0.755)
NEC for r=0.9 all L1 = 0.404 +- 0.217 (in-sample avg dev_std = 0.755)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:29:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:29:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9277 0.9277[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.358
SUFF_SIMPLE for r=0.3 class 0 = 0.339 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 1 = 0.304 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 2 = 0.412 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all KL = 0.226 +- 0.206 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all L1 = 0.352 +- 0.186 (in-sample avg dev_std = 0.692)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.348
SUFF_SIMPLE for r=0.6 class 0 = 0.371 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 1 = 0.292 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 class 2 = 0.422 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all KL = 0.271 +- 0.273 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.6 all L1 = 0.362 +- 0.220 (in-sample avg dev_std = 0.527)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.342
SUFF_SIMPLE for r=0.9 class 0 = 0.753 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 1 = 0.322 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 class 2 = 0.226 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all KL = 0.356 +- 0.408 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.9 all L1 = 0.413 +- 0.349 (in-sample avg dev_std = 0.061)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.314
SUFF_SIMPLE for r=0.3 class 0 = 0.218 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 class 2 = 0.725 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 all KL = 0.277 +- 0.339 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.3 all L1 = 0.378 +- 0.301 (in-sample avg dev_std = 0.408)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.388
SUFF_SIMPLE for r=0.6 class 0 = 0.227 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 class 1 = 0.221 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 class 2 = 0.901 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 all KL = 0.373 +- 0.421 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.6 all L1 = 0.45 +- 0.366 (in-sample avg dev_std = 0.275)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.253
SUFF_SIMPLE for r=0.9 class 0 = 0.204 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.438 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.761
NEC for r=0.3 class 0 = 0.354 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.112 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.225 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.274 +- 0.294 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.228 +- 0.246 (in-sample avg dev_std = 0.490)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.672
NEC for r=0.6 class 0 = 0.455 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 class 1 = 0.174 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 class 2 = 0.353 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 all KL = 0.4 +- 0.347 (in-sample avg dev_std = 0.587)
NEC for r=0.6 all L1 = 0.326 +- 0.287 (in-sample avg dev_std = 0.587)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.525
NEC for r=0.9 class 0 = 0.537 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 class 1 = 0.398 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 class 2 = 0.569 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 all KL = 0.629 +- 0.265 (in-sample avg dev_std = 0.761)
NEC for r=0.9 all L1 = 0.502 +- 0.232 (in-sample avg dev_std = 0.761)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.775
NEC for r=0.3 class 0 = 0.309 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1 = 0.318 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 2 = 0.02 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.235 +- 0.360 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.216 +- 0.319 (in-sample avg dev_std = 0.236)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.739
NEC for r=0.6 class 0 = 0.393 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 1 = 0.331 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 class 2 = 0.093 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all KL = 0.316 +- 0.363 (in-sample avg dev_std = 0.397)
NEC for r=0.6 all L1 = 0.272 +- 0.315 (in-sample avg dev_std = 0.397)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.809
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.575
NEC for r=0.9 class 0 = 0.556 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 1 = 0.502 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 2 = 0.371 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all KL = 0.593 +- 0.262 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all L1 = 0.477 +- 0.228 (in-sample avg dev_std = 0.722)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:31:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:31:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.352
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 1 = 0.329 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 class 2 = 0.421 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all KL = 0.237 +- 0.195 (in-sample avg dev_std = 0.692)
SUFF_SIMPLE for r=0.3 all L1 = 0.356 +- 0.179 (in-sample avg dev_std = 0.692)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.299
SUFF_SIMPLE for r=0.6 class 0 = 0.308 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 1 = 0.242 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 class 2 = 0.491 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all KL = 0.242 +- 0.284 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.6 all L1 = 0.349 +- 0.253 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.229
SUFF_SIMPLE for r=0.9 class 0 = 0.556 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.228 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.284 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.267 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.345 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.28
SUFF_SIMPLE for r=0.3 class 0 = 0.251 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 class 1 = 0.201 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 class 2 = 0.474 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 all KL = 0.225 +- 0.183 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.3 all L1 = 0.309 +- 0.152 (in-sample avg dev_std = 0.474)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.326
SUFF_SIMPLE for r=0.6 class 0 = 0.26 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 class 1 = 0.204 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 class 2 = 0.626 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 all KL = 0.293 +- 0.284 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.241 (in-sample avg dev_std = 0.422)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.038
SUFF_SIMPLE for r=0.9 class 0 = 0.324 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.172 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.131 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.208 +- 0.076 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.754
NEC for r=0.3 class 0 = 0.419 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 1 = 0.067 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 class 2 = 0.166 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all KL = 0.245 +- 0.316 (in-sample avg dev_std = 0.417)
NEC for r=0.3 all L1 = 0.214 +- 0.271 (in-sample avg dev_std = 0.417)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.666
NEC for r=0.6 class 0 = 0.487 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 1 = 0.129 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 2 = 0.34 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all KL = 0.374 +- 0.354 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all L1 = 0.316 +- 0.299 (in-sample avg dev_std = 0.537)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.557 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 class 1 = 0.349 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 class 2 = 0.551 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 all KL = 0.597 +- 0.283 (in-sample avg dev_std = 0.727)
NEC for r=0.9 all L1 = 0.485 +- 0.245 (in-sample avg dev_std = 0.727)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.791
NEC for r=0.3 class 0 = 0.331 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.015 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.012 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.124 +- 0.263 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.12 +- 0.245 (in-sample avg dev_std = 0.161)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.764
NEC for r=0.6 class 0 = 0.393 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1 = 0.019 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 2 = 0.08 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.189 +- 0.303 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.165 +- 0.267 (in-sample avg dev_std = 0.319)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.601
NEC for r=0.9 class 0 = 0.54 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.247 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.428 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.515 +- 0.269 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.406 +- 0.229 (in-sample avg dev_std = 0.720)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.245, 0.306], 'all_L1': [0.37, 0.354, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.234, 0.24, 0.326], 'all_L1': [0.36, 0.351, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.218, 0.233, 0.308], 'all_L1': [0.354, 0.345, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.238, 0.249, 0.282], 'all_L1': [0.369, 0.36, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.223, 0.258, 0.296], 'all_L1': [0.354, 0.363, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.231, 0.307, 0.328], 'all_L1': [0.343, 0.393, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.249, 0.272, 0.324], 'all_L1': [0.359, 0.361, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.377, 0.308], 'all_L1': [0.344, 0.431, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.226, 0.271, 0.356], 'all_L1': [0.352, 0.362, 0.413]}), defaultdict(<class 'list'>, {'all_KL': [0.237, 0.242, 0.267], 'all_L1': [0.356, 0.349, 0.345]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.245, 0.374, 0.6], 'all_L1': [0.197, 0.302, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.228, 0.371, 0.597], 'all_L1': [0.183, 0.299, 0.473]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.418, 0.637], 'all_L1': [0.211, 0.328, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.482, 0.643], 'all_L1': [0.343, 0.403, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.476, 0.655], 'all_L1': [0.336, 0.398, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.409, 0.603], 'all_L1': [0.224, 0.334, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.414, 0.621], 'all_L1': [0.219, 0.338, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.307, 0.432, 0.624], 'all_L1': [0.251, 0.356, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.274, 0.4, 0.629], 'all_L1': [0.228, 0.326, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.245, 0.374, 0.597], 'all_L1': [0.214, 0.316, 0.485]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.276, 0.341, 0.444], 'all_L1': [0.384, 0.442, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.297, 0.283], 'all_L1': [0.346, 0.387, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.452, 0.474], 'all_L1': [0.442, 0.511, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.251, 0.333, 0.561], 'all_L1': [0.359, 0.425, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.273, 0.364, 0.542], 'all_L1': [0.387, 0.46, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.362, 0.386], 'all_L1': [0.449, 0.447, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.318, 0.375, 0.252], 'all_L1': [0.407, 0.448, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.197, 0.19, 0.101], 'all_L1': [0.303, 0.3, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.277, 0.373, 0.246], 'all_L1': [0.378, 0.45, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.225, 0.293, 0.131], 'all_L1': [0.309, 0.363, 0.208]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.122, 0.163, 0.411], 'all_L1': [0.107, 0.138, 0.329]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.173, 0.496], 'all_L1': [0.069, 0.145, 0.388]}), defaultdict(<class 'list'>, {'all_KL': [0.042, 0.151, 0.45], 'all_L1': [0.05, 0.126, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.451, 0.591], 'all_L1': [0.401, 0.42, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.405, 0.445, 0.6], 'all_L1': [0.381, 0.406, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.172, 0.455], 'all_L1': [0.101, 0.161, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.139, 0.474], 'all_L1': [0.05, 0.128, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.196, 0.518], 'all_L1': [0.055, 0.153, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.316, 0.593], 'all_L1': [0.216, 0.272, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.189, 0.515], 'all_L1': [0.12, 0.165, 0.406]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.356 +- 0.009, 0.367 +- 0.025, 0.377 +- 0.020
suff_simple class all_KL  =  0.233 +- 0.009, 0.269 +- 0.041, 0.310 +- 0.024
[[0.35116666555404663, 0.3084999918937683, 0.2775685787200928], [0.34545832872390747, 0.29345834255218506, 0.295320063829422], [0.34029167890548706, 0.304874986410141, 0.2840236723423004], [0.39012500643730164, 0.3190833330154419, 0.23587951064109802], [0.3636666536331177, 0.31850001215934753, 0.26284292340278625], [0.3386666774749756, 0.3499166667461395, 0.28563743829727173], [0.3402083218097687, 0.31954166293144226, 0.28940290212631226], [0.3424583375453949, 0.44216665625572205, 0.26143088936805725], [0.35762500762939453, 0.3479583263397217, 0.3417159616947174], [0.35233333706855774, 0.2994166612625122, 0.22861753404140472]]
[[0.244, 0.245, 0.306], [0.234, 0.24, 0.326], [0.218, 0.233, 0.308], [0.238, 0.249, 0.282], [0.223, 0.258, 0.296], [0.231, 0.307, 0.328], [0.249, 0.272, 0.324], [0.232, 0.377, 0.308], [0.226, 0.271, 0.356], [0.237, 0.242, 0.267]]
suff_simple_acc_int  =  0.352 +- 0.015, 0.330 +- 0.041, 0.276 +- 0.030
nec class all_L1  =  0.241 +- 0.052, 0.340 +- 0.034, 0.500 +- 0.018
nec class all_KL  =  0.290 +- 0.058, 0.415 +- 0.038, 0.621 +- 0.020
[[0.7738333344459534, 0.6859999895095825, 0.5419999957084656], [0.7964583039283752, 0.6953750252723694, 0.5531250238418579], [0.7725416421890259, 0.6740416884422302, 0.5364999771118164], [0.643541693687439, 0.5843750238418579, 0.5024999976158142], [0.656166672706604, 0.5973333120346069, 0.4872083365917206], [0.7562500238418579, 0.6598749756813049, 0.528124988079071], [0.7662500143051147, 0.6591249704360962, 0.5146250128746033], [0.7322499752044678, 0.6371250152587891, 0.5041666626930237], [0.7606666684150696, 0.671999990940094, 0.5247499942779541], [0.7536249756813049, 0.6657083630561829, 0.5358333587646484]]
[[0.245, 0.374, 0.6], [0.228, 0.371, 0.597], [0.268, 0.418, 0.637], [0.402, 0.482, 0.643], [0.396, 0.476, 0.655], [0.272, 0.409, 0.603], [0.26, 0.414, 0.621], [0.307, 0.432, 0.624], [0.274, 0.4, 0.629], [0.245, 0.374, 0.597]]
nec_acc_int  =  0.741 +- 0.048, 0.653 +- 0.035, 0.523 +- 0.019

Eval split val
suff_simple class all_L1  =  0.376 +- 0.047, 0.423 +- 0.056, 0.393 +- 0.130
suff_simple class all_KL  =  0.277 +- 0.049, 0.338 +- 0.065, 0.342 +- 0.155
[[0.21037499606609344, 0.2670416533946991, 0.3183828294277191], [0.28299999237060547, 0.3109583258628845, 0.23878711462020874], [0.3135833442211151, 0.3527916669845581, 0.25457990169525146], [0.29637500643730164, 0.37833333015441895, 0.21920403838157654], [0.2850416600704193, 0.359541654586792, 0.1711939424276352], [0.27937498688697815, 0.2696250081062317, 0.19835755228996277], [0.27541667222976685, 0.2970833480358124, 0.07391029596328735], [0.28845834732055664, 0.27804166078567505, 0.04737839475274086], [0.3137083351612091, 0.38845834136009216, 0.2533164918422699], [0.2801249921321869, 0.32612499594688416, 0.03790271654725075]]
[[0.276, 0.341, 0.444], [0.242, 0.297, 0.283], [0.355, 0.452, 0.474], [0.251, 0.333, 0.561], [0.273, 0.364, 0.542], [0.351, 0.362, 0.386], [0.318, 0.375, 0.252], [0.197, 0.19, 0.101], [0.277, 0.373, 0.246], [0.225, 0.293, 0.131]]
suff_simple_acc_int  =  0.283 +- 0.027, 0.323 +- 0.043, 0.181 +- 0.092
nec class all_L1  =  0.155 +- 0.127, 0.211 +- 0.108, 0.409 +- 0.059
nec class all_KL  =  0.157 +- 0.139, 0.239 +- 0.114, 0.510 +- 0.063
[[0.6487916707992554, 0.6278333067893982, 0.5097083449363708], [0.8736249804496765, 0.8216249942779541, 0.6402083039283752], [0.7904166579246521, 0.7432916760444641, 0.5920833349227905], [0.7092499732971191, 0.6792916655540466, 0.5962083339691162], [0.7305416464805603, 0.6957916617393494, 0.5852916836738586], [0.7642916440963745, 0.7228333353996277, 0.5662916898727417], [0.7418749928474426, 0.6977083086967468, 0.5426250100135803], [0.8976666927337646, 0.8272083401679993, 0.6355000138282776], [0.7747083306312561, 0.7391666769981384, 0.575208306312561], [0.7914999723434448, 0.7635833621025085, 0.6010833382606506]]
[[0.122, 0.163, 0.411], [0.063, 0.173, 0.496], [0.042, 0.151, 0.45], [0.419, 0.451, 0.591], [0.405, 0.445, 0.6], [0.081, 0.172, 0.455], [0.025, 0.139, 0.474], [0.055, 0.196, 0.518], [0.235, 0.316, 0.593], [0.124, 0.189, 0.515]]
nec_acc_int  =  0.772 +- 0.070, 0.732 +- 0.059, 0.584 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.298 +- 0.027, 0.353 +- 0.023, 0.439 +- 0.011
Faith. Armon (L1)= 		  =  0.284 +- 0.035, 0.352 +- 0.023, 0.429 +- 0.013
Faith. GMean (L1)= 	  =  0.291 +- 0.031, 0.353 +- 0.023, 0.434 +- 0.012
Faith. Aritm (KL)= 		  =  0.261 +- 0.028, 0.342 +- 0.030, 0.465 +- 0.015
Faith. Armon (KL)= 		  =  0.256 +- 0.020, 0.325 +- 0.032, 0.413 +- 0.021
Faith. GMean (KL)= 	  =  0.259 +- 0.024, 0.333 +- 0.031, 0.438 +- 0.018

Eval split val
Faith. Aritm (L1)= 		  =  0.266 +- 0.066, 0.317 +- 0.065, 0.401 +- 0.074
Faith. Armon (L1)= 		  =  0.193 +- 0.108, 0.268 +- 0.088, 0.388 +- 0.083
Faith. GMean (L1)= 	  =  0.223 +- 0.090, 0.291 +- 0.076, 0.394 +- 0.079
Faith. Aritm (KL)= 		  =  0.217 +- 0.069, 0.289 +- 0.067, 0.426 +- 0.086
Faith. Armon (KL)= 		  =  0.166 +- 0.095, 0.265 +- 0.074, 0.387 +- 0.127
Faith. GMean (KL)= 	  =  0.187 +- 0.084, 0.276 +- 0.070, 0.404 +- 0.108
Computed for split load_split = id



Completed in  0:20:31.326644  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN simple_concept2temperature GOODMotif/basis/covariate NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:33:22 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:33:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
SUFF_SIMPLE for r=0.3 class 0 = 0.327 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 class 2 = 0.431 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 all KL = 0.244 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 all L1 = 0.343 +- 0.192 (in-sample avg dev_std = 0.613)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.31 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 class 1 = 0.199 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 class 2 = 0.487 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 all KL = 0.257 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 all L1 = 0.334 +- 0.237 (in-sample avg dev_std = 0.444)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.213
SUFF_SIMPLE for r=0.9 class 0 = 0.482 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 class 1 = 0.217 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 all KL = 0.286 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 all L1 = 0.321 +- 0.253 (in-sample avg dev_std = 0.010)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.552 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 class 1 = 0.348 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 class 2 = 0.443 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 all KL = 0.371 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.187 (in-sample avg dev_std = 0.615)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.351
SUFF_SIMPLE for r=0.6 class 0 = 0.499 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 class 1 = 0.326 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 class 2 = 0.629 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 all KL = 0.429 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 all L1 = 0.485 +- 0.238 (in-sample avg dev_std = 0.573)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.401
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.884 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.806 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.416 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.72 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.287 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0 = 0.488 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 1 = 0.371 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 2 = 0.221 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all KL = 0.364 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all L1 = 0.357 +- 0.263 (in-sample avg dev_std = 0.408)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.633
NEC for r=0.6 class 0 = 0.513 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 class 1 = 0.386 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 class 2 = 0.377 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 all KL = 0.457 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 all L1 = 0.424 +- 0.256 (in-sample avg dev_std = 0.513)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.518
NEC for r=0.9 class 0 = 0.57 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 1 = 0.529 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 2 = 0.549 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all KL = 0.635 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all L1 = 0.549 +- 0.194 (in-sample avg dev_std = 0.673)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.495
NEC for r=0.3 class 0 = 0.628 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 1 = 0.65 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 2 = 0.439 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all KL = 0.597 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all L1 = 0.572 +- 0.223 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.489
NEC for r=0.6 class 0 = 0.625 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 1 = 0.645 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 2 = 0.481 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all KL = 0.624 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all L1 = 0.584 +- 0.199 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.559 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.624 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.581 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.65 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.588 +- 0.150 (in-sample avg dev_std = 0.571)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:34:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:34:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.55 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 class 1 = 0.275 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 class 2 = 0.249 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 all KL = 0.283 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 all L1 = 0.354 +- 0.230 (in-sample avg dev_std = 0.479)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.678 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 class 1 = 0.213 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 class 2 = 0.223 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 all KL = 0.316 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 all L1 = 0.365 +- 0.270 (in-sample avg dev_std = 0.300)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.27
SUFF_SIMPLE for r=0.9 class 0 = 0.74 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 1 = 0.209 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 2 = 0.219 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all KL = 0.335 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.303 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
SUFF_SIMPLE for r=0.3 class 0 = 0.816 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 class 1 = 0.548 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 class 2 = 0.754 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 all KL = 0.716 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 all L1 = 0.707 +- 0.323 (in-sample avg dev_std = 0.083)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF_SIMPLE for r=0.6 class 0 = 0.816 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 class 1 = 0.548 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 class 2 = 0.768 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 all KL = 0.721 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 all L1 = 0.711 +- 0.319 (in-sample avg dev_std = 0.074)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.493
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF_SIMPLE for r=0.9 class 0 = 0.975 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.873 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.737
NEC for r=0.3 class 0 = 0.389 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.342 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.258 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.317 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.328 +- 0.229 (in-sample avg dev_std = 0.421)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.657
NEC for r=0.6 class 0 = 0.457 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.378 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.407 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.43 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.413 +- 0.236 (in-sample avg dev_std = 0.505)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.53
NEC for r=0.9 class 0 = 0.483 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.522 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.589 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.599 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.533 +- 0.201 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.581
NEC for r=0.3 class 0 = 0.182 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 1 = 0.113 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 2 = 0.043 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all KL = 0.072 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all L1 = 0.113 +- 0.147 (in-sample avg dev_std = 0.145)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.528
NEC for r=0.6 class 0 = 0.235 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.153 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.108 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.137 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.165 +- 0.194 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.532
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.45
NEC for r=0.9 class 0 = 0.249 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 1 = 0.279 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 2 = 0.201 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all KL = 0.237 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all L1 = 0.243 +- 0.237 (in-sample avg dev_std = 0.400)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:36:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:36:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mChartInfo 0.9250 0.9250 0.9250 0.9250 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.304 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 class 1 = 0.253 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 class 2 = 0.439 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 all KL = 0.23 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 all L1 = 0.333 +- 0.180 (in-sample avg dev_std = 0.606)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.292 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 class 1 = 0.196 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 class 2 = 0.497 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 all KL = 0.247 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 all L1 = 0.33 +- 0.232 (in-sample avg dev_std = 0.455)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.209
SUFF_SIMPLE for r=0.9 class 0 = 0.446 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 class 1 = 0.215 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 class 2 = 0.281 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 all KL = 0.256 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 all L1 = 0.307 +- 0.255 (in-sample avg dev_std = 0.008)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.611 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 class 2 = 0.642 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 all KL = 0.602 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 all L1 = 0.613 +- 0.272 (in-sample avg dev_std = 0.429)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.356
SUFF_SIMPLE for r=0.6 class 0 = 0.557 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 class 1 = 0.586 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 class 2 = 0.791 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 all KL = 0.646 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 all L1 = 0.645 +- 0.294 (in-sample avg dev_std = 0.381)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.23
SUFF_SIMPLE for r=0.9 class 0 = 0.88 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.675 +- 0.293 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0 = 0.489 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.377 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.22 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.37 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.359 +- 0.260 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.641
NEC for r=0.6 class 0 = 0.52 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.385 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.357 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.449 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.418 +- 0.255 (in-sample avg dev_std = 0.508)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.525
NEC for r=0.9 class 0 = 0.57 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 1 = 0.529 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 2 = 0.543 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all KL = 0.631 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all L1 = 0.547 +- 0.193 (in-sample avg dev_std = 0.671)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
NEC for r=0.3 class 0 = 0.517 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 1 = 0.311 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 2 = 0.085 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all KL = 0.27 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all L1 = 0.305 +- 0.291 (in-sample avg dev_std = 0.245)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.523 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1 = 0.323 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 2 = 0.141 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.31 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.329 +- 0.293 (in-sample avg dev_std = 0.304)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.492 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.354 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.305 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.394 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.384 +- 0.268 (in-sample avg dev_std = 0.445)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:39:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:39:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.9247 0.9247 0.9247 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.445 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 class 2 = 0.315 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 all KL = 0.262 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 all L1 = 0.341 +- 0.171 (in-sample avg dev_std = 0.515)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.306
SUFF_SIMPLE for r=0.6 class 0 = 0.546 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 class 1 = 0.215 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 class 2 = 0.277 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 all KL = 0.292 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 all L1 = 0.342 +- 0.197 (in-sample avg dev_std = 0.323)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.276
SUFF_SIMPLE for r=0.9 class 0 = 0.683 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 class 1 = 0.227 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 class 2 = 0.24 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 all KL = 0.355 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 all L1 = 0.366 +- 0.270 (in-sample avg dev_std = 0.003)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.851 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 class 1 = 0.58 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 class 2 = 0.333 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 all KL = 0.622 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 all L1 = 0.588 +- 0.317 (in-sample avg dev_std = 0.162)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.322
SUFF_SIMPLE for r=0.6 class 0 = 0.826 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 class 1 = 0.593 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 class 2 = 0.337 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 all KL = 0.623 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 all L1 = 0.585 +- 0.312 (in-sample avg dev_std = 0.161)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.804 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.764 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.348 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.587 +- 0.277 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.786
NEC for r=0.3 class 0 = 0.408 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.314 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.199 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.287 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.304 +- 0.206 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.676
NEC for r=0.6 class 0 = 0.502 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.361 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.371 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.433 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.409 +- 0.226 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.542 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 class 1 = 0.519 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 class 2 = 0.566 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 all KL = 0.616 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 all L1 = 0.543 +- 0.186 (in-sample avg dev_std = 0.646)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.717
NEC for r=0.3 class 0 = 0.108 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.241 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.277 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.109 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.209 +- 0.138 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0 = 0.194 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.268 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.357 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.202 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.273 +- 0.169 (in-sample avg dev_std = 0.399)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.25 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 1 = 0.336 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 2 = 0.497 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all KL = 0.322 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all L1 = 0.361 +- 0.218 (in-sample avg dev_std = 0.487)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:41:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:41:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9270 0.9270[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 1 = 0.273 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 2 = 0.453 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all KL = 0.26 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all L1 = 0.348 +- 0.186 (in-sample avg dev_std = 0.600)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.294
SUFF_SIMPLE for r=0.6 class 0 = 0.304 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 2 = 0.514 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all KL = 0.272 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all L1 = 0.342 +- 0.237 (in-sample avg dev_std = 0.452)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.439 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 class 2 = 0.295 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 all KL = 0.271 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 all L1 = 0.308 +- 0.242 (in-sample avg dev_std = 0.006)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.327
SUFF_SIMPLE for r=0.3 class 0 = 0.441 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 class 1 = 0.373 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 class 2 = 0.462 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 all KL = 0.446 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 all L1 = 0.425 +- 0.125 (in-sample avg dev_std = 0.511)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
SUFF_SIMPLE for r=0.6 class 0 = 0.409 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 class 1 = 0.37 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 class 2 = 0.595 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 all KL = 0.494 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 all L1 = 0.458 +- 0.185 (in-sample avg dev_std = 0.503)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.042
SUFF_SIMPLE for r=0.9 class 0 = 0.473 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.238 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.481 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.383 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.682
NEC for r=0.3 class 0 = 0.491 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 1 = 0.391 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 2 = 0.195 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all KL = 0.348 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all L1 = 0.355 +- 0.271 (in-sample avg dev_std = 0.387)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.652
NEC for r=0.6 class 0 = 0.522 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 1 = 0.395 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 2 = 0.332 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all KL = 0.43 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all L1 = 0.414 +- 0.251 (in-sample avg dev_std = 0.503)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.532
NEC for r=0.9 class 0 = 0.564 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 1 = 0.527 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 2 = 0.518 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all KL = 0.603 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all L1 = 0.535 +- 0.193 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.726 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 1 = 0.577 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 2 = 0.143 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all KL = 0.42 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all L1 = 0.482 +- 0.281 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.73 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 1 = 0.572 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 2 = 0.201 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all KL = 0.459 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all L1 = 0.501 +- 0.265 (in-sample avg dev_std = 0.342)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.329
NEC for r=0.9 class 0 = 0.692 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.565 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.41 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.54 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.556 +- 0.167 (in-sample avg dev_std = 0.508)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:44:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:44:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 69 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9247 0.9247[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.302 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 1 = 0.29 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 2 = 0.435 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all KL = 0.25 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all L1 = 0.344 +- 0.184 (in-sample avg dev_std = 0.599)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.298
SUFF_SIMPLE for r=0.6 class 0 = 0.295 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 class 1 = 0.229 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 class 2 = 0.477 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 all KL = 0.26 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 all L1 = 0.336 +- 0.228 (in-sample avg dev_std = 0.445)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.214
SUFF_SIMPLE for r=0.9 class 0 = 0.451 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 class 1 = 0.274 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 class 2 = 0.261 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 all KL = 0.292 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 all L1 = 0.321 +- 0.227 (in-sample avg dev_std = 0.007)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.5 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 1 = 0.405 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 2 = 0.438 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all KL = 0.444 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.154 (in-sample avg dev_std = 0.599)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.352
SUFF_SIMPLE for r=0.6 class 0 = 0.434 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 class 1 = 0.409 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 class 2 = 0.565 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 all KL = 0.474 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 all L1 = 0.47 +- 0.190 (in-sample avg dev_std = 0.576)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.037
SUFF_SIMPLE for r=0.9 class 0 = 0.414 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.44 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.225 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.428 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.128 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.723
NEC for r=0.3 class 0 = 0.503 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.36 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.199 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.347 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.35 +- 0.242 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.645
NEC for r=0.6 class 0 = 0.53 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 1 = 0.393 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 2 = 0.364 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all KL = 0.456 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all L1 = 0.427 +- 0.242 (in-sample avg dev_std = 0.529)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.526
NEC for r=0.9 class 0 = 0.577 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 class 1 = 0.544 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 class 2 = 0.548 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 all KL = 0.639 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 all L1 = 0.556 +- 0.182 (in-sample avg dev_std = 0.684)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
NEC for r=0.3 class 0 = 0.729 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1 = 0.45 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 2 = 0.132 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.387 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.437 +- 0.284 (in-sample avg dev_std = 0.309)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.732 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 1 = 0.462 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 2 = 0.192 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all KL = 0.436 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all L1 = 0.463 +- 0.268 (in-sample avg dev_std = 0.389)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.332
NEC for r=0.9 class 0 = 0.698 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 1 = 0.512 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 2 = 0.413 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all KL = 0.538 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all L1 = 0.541 +- 0.183 (in-sample avg dev_std = 0.536)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:46:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:46:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.297 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 1 = 0.273 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 2 = 0.42 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all KL = 0.233 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all L1 = 0.332 +- 0.174 (in-sample avg dev_std = 0.609)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.294
SUFF_SIMPLE for r=0.6 class 0 = 0.283 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 1 = 0.199 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 2 = 0.495 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all KL = 0.246 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all L1 = 0.328 +- 0.227 (in-sample avg dev_std = 0.463)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.204
SUFF_SIMPLE for r=0.9 class 0 = 0.415 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all KL = 0.245 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all L1 = 0.299 +- 0.247 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.527 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 class 1 = 0.615 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 class 2 = 0.654 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 all KL = 0.616 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 all L1 = 0.598 +- 0.251 (in-sample avg dev_std = 0.394)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
SUFF_SIMPLE for r=0.6 class 0 = 0.484 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 class 1 = 0.623 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 class 2 = 0.765 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 all KL = 0.647 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 all L1 = 0.624 +- 0.271 (in-sample avg dev_std = 0.365)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.28
SUFF_SIMPLE for r=0.9 class 0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.516 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.611 +- 0.244 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.689
NEC for r=0.3 class 0 = 0.501 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 class 1 = 0.353 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 class 2 = 0.242 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 all KL = 0.363 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 all L1 = 0.362 +- 0.273 (in-sample avg dev_std = 0.398)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.635
NEC for r=0.6 class 0 = 0.541 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.361 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.367 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.446 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.421 +- 0.265 (in-sample avg dev_std = 0.508)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.52
NEC for r=0.9 class 0 = 0.588 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 class 1 = 0.507 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 class 2 = 0.548 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 all KL = 0.632 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 all L1 = 0.547 +- 0.201 (in-sample avg dev_std = 0.666)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.58 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 1 = 0.345 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 2 = 0.104 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all KL = 0.305 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all L1 = 0.343 +- 0.298 (in-sample avg dev_std = 0.266)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.589 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.346 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.155 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.34 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.364 +- 0.298 (in-sample avg dev_std = 0.309)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.314
NEC for r=0.9 class 0 = 0.57 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 1 = 0.371 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 2 = 0.304 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all KL = 0.413 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all L1 = 0.416 +- 0.271 (in-sample avg dev_std = 0.416)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:48:46 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:48:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
SUFF_SIMPLE for r=0.3 class 0 = 0.31 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 class 2 = 0.429 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 all KL = 0.236 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.189 (in-sample avg dev_std = 0.607)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.29
SUFF_SIMPLE for r=0.6 class 0 = 0.294 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 class 1 = 0.198 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 class 2 = 0.491 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 all L1 = 0.33 +- 0.235 (in-sample avg dev_std = 0.459)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.458 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 all KL = 0.264 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 all L1 = 0.31 +- 0.249 (in-sample avg dev_std = 0.009)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.433 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 class 1 = 0.28 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 class 2 = 0.392 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 all KL = 0.327 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 all L1 = 0.369 +- 0.135 (in-sample avg dev_std = 0.646)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.361
SUFF_SIMPLE for r=0.6 class 0 = 0.387 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 class 1 = 0.266 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 class 2 = 0.538 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 all KL = 0.367 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 all L1 = 0.398 +- 0.200 (in-sample avg dev_std = 0.623)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.222 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.464 +- 0.247 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.691
NEC for r=0.3 class 0 = 0.481 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1 = 0.345 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 2 = 0.237 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.363 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.351 +- 0.274 (in-sample avg dev_std = 0.412)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.637
NEC for r=0.6 class 0 = 0.513 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 class 1 = 0.359 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 class 2 = 0.388 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 all KL = 0.453 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 all L1 = 0.418 +- 0.261 (in-sample avg dev_std = 0.524)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.565 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 class 1 = 0.515 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 class 2 = 0.557 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 all KL = 0.632 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 all L1 = 0.546 +- 0.201 (in-sample avg dev_std = 0.674)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.757 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 1 = 0.655 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 2 = 0.274 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all KL = 0.558 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all L1 = 0.562 +- 0.256 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.752 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.663 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.326 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.595 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.581 +- 0.232 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.693 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 1 = 0.639 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 2 = 0.513 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all KL = 0.648 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all L1 = 0.615 +- 0.127 (in-sample avg dev_std = 0.608)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:50:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:50:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.301 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 class 1 = 0.265 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 class 2 = 0.432 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 all KL = 0.228 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 all L1 = 0.334 +- 0.181 (in-sample avg dev_std = 0.621)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.281 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 class 1 = 0.195 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 class 2 = 0.508 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 all KL = 0.245 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 all L1 = 0.331 +- 0.235 (in-sample avg dev_std = 0.470)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.207
SUFF_SIMPLE for r=0.9 class 0 = 0.44 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 1 = 0.201 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 2 = 0.285 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all KL = 0.248 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all L1 = 0.302 +- 0.258 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.492 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 class 1 = 0.296 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 class 2 = 0.391 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 all KL = 0.325 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 all L1 = 0.393 +- 0.150 (in-sample avg dev_std = 0.654)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
SUFF_SIMPLE for r=0.6 class 0 = 0.419 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 class 1 = 0.279 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 class 2 = 0.538 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 all KL = 0.361 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 all L1 = 0.413 +- 0.205 (in-sample avg dev_std = 0.605)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.406
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.831 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.412 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.729 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.286 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.679
NEC for r=0.3 class 0 = 0.494 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.394 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.218 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.373 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.365 +- 0.274 (in-sample avg dev_std = 0.411)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.645
NEC for r=0.6 class 0 = 0.521 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 1 = 0.394 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 2 = 0.338 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all KL = 0.445 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all L1 = 0.415 +- 0.260 (in-sample avg dev_std = 0.516)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.564 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 class 1 = 0.53 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 class 2 = 0.54 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 all KL = 0.634 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 all L1 = 0.544 +- 0.194 (in-sample avg dev_std = 0.683)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.755 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.75 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.456 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.693 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.653 +- 0.222 (in-sample avg dev_std = 0.403)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.746 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.739 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.496 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.716 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.66 +- 0.189 (in-sample avg dev_std = 0.468)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
NEC for r=0.9 class 0 = 0.647 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 1 = 0.681 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 2 = 0.587 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all KL = 0.712 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all L1 = 0.638 +- 0.113 (in-sample avg dev_std = 0.656)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:52:13 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:52:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 82 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
SUFF_SIMPLE for r=0.3 class 0 = 0.309 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 class 1 = 0.27 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 class 2 = 0.429 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 all KL = 0.234 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.183 (in-sample avg dev_std = 0.625)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.288 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 class 1 = 0.203 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 class 2 = 0.501 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 all KL = 0.251 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 all L1 = 0.333 +- 0.238 (in-sample avg dev_std = 0.465)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.205
SUFF_SIMPLE for r=0.9 class 0 = 0.409 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 all KL = 0.247 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.234 (in-sample avg dev_std = 0.005)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.481 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 class 1 = 0.468 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 class 2 = 0.476 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 all KL = 0.453 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 all L1 = 0.475 +- 0.157 (in-sample avg dev_std = 0.588)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.362
SUFF_SIMPLE for r=0.6 class 0 = 0.427 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 class 1 = 0.509 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 class 2 = 0.62 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 all KL = 0.509 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 all L1 = 0.518 +- 0.207 (in-sample avg dev_std = 0.546)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.05
SUFF_SIMPLE for r=0.9 class 0 = 0.347 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.382 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.124 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0 = 0.493 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 class 1 = 0.37 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 class 2 = 0.223 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 all KL = 0.361 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 all L1 = 0.358 +- 0.269 (in-sample avg dev_std = 0.402)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.634
NEC for r=0.6 class 0 = 0.514 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.39 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.376 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.455 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.425 +- 0.263 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.514
NEC for r=0.9 class 0 = 0.561 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 1 = 0.539 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 2 = 0.564 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all KL = 0.64 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all L1 = 0.555 +- 0.194 (in-sample avg dev_std = 0.673)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.71 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 1 = 0.403 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 2 = 0.085 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all KL = 0.354 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all L1 = 0.4 +- 0.295 (in-sample avg dev_std = 0.287)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.715 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 1 = 0.408 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 2 = 0.142 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all KL = 0.399 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all L1 = 0.422 +- 0.285 (in-sample avg dev_std = 0.356)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.319
NEC for r=0.9 class 0 = 0.697 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 1 = 0.47 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 2 = 0.369 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all KL = 0.521 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all L1 = 0.512 +- 0.210 (in-sample avg dev_std = 0.501)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.257, 0.286], 'all_L1': [0.343, 0.334, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.316, 0.335], 'all_L1': [0.354, 0.365, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.23, 0.247, 0.256], 'all_L1': [0.333, 0.33, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.262, 0.292, 0.355], 'all_L1': [0.341, 0.342, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.272, 0.271], 'all_L1': [0.348, 0.342, 0.308]}), defaultdict(<class 'list'>, {'all_KL': [0.25, 0.26, 0.292], 'all_L1': [0.344, 0.336, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.233, 0.246, 0.245], 'all_L1': [0.332, 0.328, 0.299]}), defaultdict(<class 'list'>, {'all_KL': [0.236, 0.248, 0.264], 'all_L1': [0.337, 0.33, 0.31]}), defaultdict(<class 'list'>, {'all_KL': [0.228, 0.245, 0.248], 'all_L1': [0.334, 0.331, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.234, 0.251, 0.247], 'all_L1': [0.337, 0.333, 0.297]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.364, 0.457, 0.635], 'all_L1': [0.357, 0.424, 0.549]}), defaultdict(<class 'list'>, {'all_KL': [0.317, 0.43, 0.599], 'all_L1': [0.328, 0.413, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.449, 0.631], 'all_L1': [0.359, 0.418, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.287, 0.433, 0.616], 'all_L1': [0.304, 0.409, 0.543]}), defaultdict(<class 'list'>, {'all_KL': [0.348, 0.43, 0.603], 'all_L1': [0.355, 0.414, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.347, 0.456, 0.639], 'all_L1': [0.35, 0.427, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.446, 0.632], 'all_L1': [0.362, 0.421, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.453, 0.632], 'all_L1': [0.351, 0.418, 0.546]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.445, 0.634], 'all_L1': [0.365, 0.415, 0.544]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.455, 0.64], 'all_L1': [0.358, 0.425, 0.555]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.371, 0.429, 0.72], 'all_L1': [0.448, 0.485, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.716, 0.721, 0.873], 'all_L1': [0.707, 0.711, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.646, 0.667], 'all_L1': [0.613, 0.645, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.623, 0.667], 'all_L1': [0.588, 0.585, 0.587]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.494, 0.481], 'all_L1': [0.425, 0.458, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.474, 0.428], 'all_L1': [0.448, 0.47, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.616, 0.647, 0.625], 'all_L1': [0.598, 0.624, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.327, 0.367, 0.542], 'all_L1': [0.369, 0.398, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.325, 0.361, 0.729], 'all_L1': [0.393, 0.413, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.453, 0.509, 0.345], 'all_L1': [0.475, 0.518, 0.314]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.597, 0.624, 0.65], 'all_L1': [0.572, 0.584, 0.588]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.137, 0.237], 'all_L1': [0.113, 0.165, 0.243]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.31, 0.394], 'all_L1': [0.305, 0.329, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.202, 0.322], 'all_L1': [0.209, 0.273, 0.361]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.459, 0.54], 'all_L1': [0.482, 0.501, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.436, 0.538], 'all_L1': [0.437, 0.463, 0.541]}), defaultdict(<class 'list'>, {'all_KL': [0.305, 0.34, 0.413], 'all_L1': [0.343, 0.364, 0.416]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.595, 0.648], 'all_L1': [0.562, 0.581, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.716, 0.712], 'all_L1': [0.653, 0.66, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.354, 0.399, 0.521], 'all_L1': [0.4, 0.422, 0.512]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.340 +- 0.007, 0.337 +- 0.010, 0.320 +- 0.025
suff_simple class all_KL  =  0.246 +- 0.017, 0.263 +- 0.022, 0.280 +- 0.036
[[0.343625009059906, 0.2927500009536743, 0.21301774680614471], [0.33675000071525574, 0.3112083375453949, 0.27044108510017395], [0.3400416672229767, 0.2933333218097687, 0.2092522829771042], [0.335916668176651, 0.30566665530204773, 0.27615654468536377], [0.3460833430290222, 0.2944999933242798, 0.20763851702213287], [0.3449999988079071, 0.29762500524520874, 0.21355567872524261], [0.34337499737739563, 0.29366666078567505, 0.20387305319309235], [0.3408749997615814, 0.2904583215713501, 0.20817643404006958], [0.34304165840148926, 0.2926250100135803, 0.20656266808509827], [0.343583345413208, 0.2926250100135803, 0.20494890213012695]]
[[0.244, 0.257, 0.286], [0.283, 0.316, 0.335], [0.23, 0.247, 0.256], [0.262, 0.292, 0.355], [0.26, 0.272, 0.271], [0.25, 0.26, 0.292], [0.233, 0.246, 0.245], [0.236, 0.248, 0.264], [0.228, 0.245, 0.248], [0.234, 0.251, 0.247]]
suff_simple_acc_int  =  0.342 +- 0.003, 0.296 +- 0.006, 0.221 +- 0.026
nec class all_L1  =  0.349 +- 0.018, 0.418 +- 0.006, 0.545 +- 0.007
nec class all_KL  =  0.349 +- 0.026, 0.445 +- 0.010, 0.626 +- 0.014
[[0.6934166550636292, 0.6330833435058594, 0.5175833106040955], [0.7365000247955322, 0.6572499871253967, 0.5296249985694885], [0.6917499899864197, 0.640916645526886, 0.5248333215713501], [0.7859583497047424, 0.6758333444595337, 0.5291666388511658], [0.6820833086967468, 0.6524583101272583, 0.5322499871253967], [0.7227916717529297, 0.6454583406448364, 0.5260416865348816], [0.6890833377838135, 0.6345833539962769, 0.5204166769981384], [0.690750002861023, 0.637499988079071, 0.5230416655540466], [0.6789583563804626, 0.6447499990463257, 0.5291666388511658], [0.6922083497047424, 0.6342499852180481, 0.5141666531562805]]
[[0.364, 0.457, 0.635], [0.317, 0.43, 0.599], [0.37, 0.449, 0.631], [0.287, 0.433, 0.616], [0.348, 0.43, 0.603], [0.347, 0.456, 0.639], [0.363, 0.446, 0.632], [0.363, 0.453, 0.632], [0.373, 0.445, 0.634], [0.361, 0.455, 0.64]]
nec_acc_int  =  0.706 +- 0.032, 0.646 +- 0.013, 0.525 +- 0.006

Eval split val
suff_simple class all_L1  =  0.506 +- 0.106, 0.531 +- 0.100, 0.553 +- 0.163
suff_simple class all_KL  =  0.492 +- 0.130, 0.527 +- 0.119, 0.608 +- 0.151
[[0.3297083377838135, 0.35070833563804626, 0.1711939424276352], [0.3407916724681854, 0.3384583294391632, 0.44219836592674255], [0.3382916748523712, 0.3563750088214874, 0.2299431413412094], [0.3292500078678131, 0.3219166696071625, 0.16929879784584045], [0.32733333110809326, 0.3553749918937683, 0.042324699461460114], [0.3389166593551636, 0.35233333706855774, 0.03727100417017937], [0.3402499854564667, 0.35475000739097595, 0.2804800868034363], [0.3370000123977661, 0.36116665601730347, 0.16929879784584045], [0.34291666746139526, 0.35499998927116394, 0.1711939424276352], [0.34316667914390564, 0.3623333275318146, 0.04990524426102638]]
[[0.371, 0.429, 0.72], [0.716, 0.721, 0.873], [0.602, 0.646, 0.667], [0.622, 0.623, 0.667], [0.446, 0.494, 0.481], [0.444, 0.474, 0.428], [0.616, 0.647, 0.625], [0.327, 0.367, 0.542], [0.325, 0.361, 0.729], [0.453, 0.509, 0.345]]
suff_simple_acc_int  =  0.337 +- 0.006, 0.351 +- 0.011, 0.176 +- 0.117
nec class all_L1  =  0.408 +- 0.161, 0.434 +- 0.147, 0.485 +- 0.122
nec class all_KL  =  0.377 +- 0.191, 0.422 +- 0.176, 0.497 +- 0.146
[[0.4949583411216736, 0.48887500166893005, 0.429791659116745], [0.5809166431427002, 0.528291642665863, 0.44975000619888306], [0.40820834040641785, 0.3961666524410248, 0.35329166054725647], [0.7173749804496765, 0.6555416584014893, 0.5415833592414856], [0.3761250078678131, 0.38350000977516174, 0.32850000262260437], [0.4335416555404663, 0.4047916531562805, 0.3317916691303253], [0.36545833945274353, 0.3543750047683716, 0.3139166533946991], [0.39508333802223206, 0.3866666555404663, 0.3577916622161865], [0.37679165601730347, 0.3813750147819519, 0.367041677236557], [0.40429165959358215, 0.38337498903274536, 0.3189166784286499]]
[[0.597, 0.624, 0.65], [0.072, 0.137, 0.237], [0.27, 0.31, 0.394], [0.109, 0.202, 0.322], [0.42, 0.459, 0.54], [0.387, 0.436, 0.538], [0.305, 0.34, 0.413], [0.558, 0.595, 0.648], [0.693, 0.716, 0.712], [0.354, 0.399, 0.521]]
nec_acc_int  =  0.455 +- 0.107, 0.436 +- 0.089, 0.379 +- 0.069


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.345 +- 0.008, 0.378 +- 0.005, 0.433 +- 0.011
Faith. Armon (L1)= 		  =  0.344 +- 0.008, 0.373 +- 0.005, 0.403 +- 0.018
Faith. GMean (L1)= 	  =  0.344 +- 0.008, 0.375 +- 0.005, 0.417 +- 0.015
Faith. Aritm (KL)= 		  =  0.298 +- 0.008, 0.354 +- 0.008, 0.453 +- 0.015
Faith. Armon (KL)= 		  =  0.287 +- 0.007, 0.330 +- 0.015, 0.385 +- 0.032
Faith. GMean (KL)= 	  =  0.292 +- 0.007, 0.342 +- 0.011, 0.418 +- 0.024

Eval split val
Faith. Aritm (L1)= 		  =  0.457 +- 0.037, 0.482 +- 0.033, 0.519 +- 0.070
Faith. Armon (L1)= 		  =  0.411 +- 0.088, 0.446 +- 0.071, 0.486 +- 0.085
Faith. GMean (L1)= 	  =  0.432 +- 0.064, 0.463 +- 0.053, 0.502 +- 0.075
Faith. Aritm (KL)= 		  =  0.434 +- 0.041, 0.474 +- 0.037, 0.553 +- 0.086
Faith. Armon (KL)= 		  =  0.365 +- 0.107, 0.422 +- 0.082, 0.519 +- 0.107
Faith. GMean (KL)= 	  =  0.394 +- 0.079, 0.446 +- 0.061, 0.535 +- 0.094
Computed for split load_split = id



Completed in  0:20:27.998023  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN PLAIN GOODMotif/basis/covariate NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:53:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:53:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
SUFF_SIMPLE for r=0.3 class 0 = 0.327 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 class 2 = 0.431 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 all KL = 0.244 +- 0.245 (in-sample avg dev_std = 0.613)
SUFF_SIMPLE for r=0.3 all L1 = 0.343 +- 0.192 (in-sample avg dev_std = 0.613)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.31 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 class 1 = 0.199 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 class 2 = 0.487 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 all KL = 0.257 +- 0.295 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.6 all L1 = 0.334 +- 0.237 (in-sample avg dev_std = 0.444)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.213
SUFF_SIMPLE for r=0.9 class 0 = 0.482 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 class 1 = 0.217 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 all KL = 0.286 +- 0.336 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.9 all L1 = 0.321 +- 0.253 (in-sample avg dev_std = 0.010)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.552 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 class 1 = 0.348 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 class 2 = 0.443 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 all KL = 0.371 +- 0.233 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.187 (in-sample avg dev_std = 0.615)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.351
SUFF_SIMPLE for r=0.6 class 0 = 0.499 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 class 1 = 0.326 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 class 2 = 0.629 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 all KL = 0.429 +- 0.292 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.6 all L1 = 0.485 +- 0.238 (in-sample avg dev_std = 0.573)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.401
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.884 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.806 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.416 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.72 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.287 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0 = 0.488 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 1 = 0.371 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 2 = 0.221 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all KL = 0.364 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all L1 = 0.357 +- 0.263 (in-sample avg dev_std = 0.408)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.633
NEC for r=0.6 class 0 = 0.513 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 class 1 = 0.386 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 class 2 = 0.377 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 all KL = 0.457 +- 0.345 (in-sample avg dev_std = 0.513)
NEC for r=0.6 all L1 = 0.424 +- 0.256 (in-sample avg dev_std = 0.513)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.518
NEC for r=0.9 class 0 = 0.57 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 1 = 0.529 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 2 = 0.549 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all KL = 0.635 +- 0.283 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all L1 = 0.549 +- 0.194 (in-sample avg dev_std = 0.673)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.495
NEC for r=0.3 class 0 = 0.628 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 1 = 0.65 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 2 = 0.439 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all KL = 0.597 +- 0.283 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all L1 = 0.572 +- 0.223 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.489
NEC for r=0.6 class 0 = 0.625 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 1 = 0.645 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 class 2 = 0.481 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all KL = 0.624 +- 0.254 (in-sample avg dev_std = 0.396)
NEC for r=0.6 all L1 = 0.584 +- 0.199 (in-sample avg dev_std = 0.396)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.559 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 1 = 0.624 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 class 2 = 0.581 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all KL = 0.65 +- 0.188 (in-sample avg dev_std = 0.571)
NEC for r=0.9 all L1 = 0.588 +- 0.150 (in-sample avg dev_std = 0.571)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:55:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:55:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.55 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 class 1 = 0.275 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 class 2 = 0.249 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 all KL = 0.283 +- 0.290 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.3 all L1 = 0.354 +- 0.230 (in-sample avg dev_std = 0.479)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.678 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 class 1 = 0.213 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 class 2 = 0.223 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 all KL = 0.316 +- 0.340 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.6 all L1 = 0.365 +- 0.270 (in-sample avg dev_std = 0.300)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.27
SUFF_SIMPLE for r=0.9 class 0 = 0.74 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 1 = 0.209 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 2 = 0.219 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all KL = 0.335 +- 0.378 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.303 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
SUFF_SIMPLE for r=0.3 class 0 = 0.816 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 class 1 = 0.548 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 class 2 = 0.754 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 all KL = 0.716 +- 0.375 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 all L1 = 0.707 +- 0.323 (in-sample avg dev_std = 0.083)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF_SIMPLE for r=0.6 class 0 = 0.816 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 class 1 = 0.548 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 class 2 = 0.768 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 all KL = 0.721 +- 0.373 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.6 all L1 = 0.711 +- 0.319 (in-sample avg dev_std = 0.074)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.493
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF_SIMPLE for r=0.9 class 0 = 0.975 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.873 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.737
NEC for r=0.3 class 0 = 0.389 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.342 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.258 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.317 +- 0.298 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.328 +- 0.229 (in-sample avg dev_std = 0.421)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.657
NEC for r=0.6 class 0 = 0.457 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.378 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.407 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.43 +- 0.315 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.413 +- 0.236 (in-sample avg dev_std = 0.505)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.53
NEC for r=0.9 class 0 = 0.483 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.522 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.589 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.599 +- 0.280 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.533 +- 0.201 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.581
NEC for r=0.3 class 0 = 0.182 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 1 = 0.113 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 2 = 0.043 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all KL = 0.072 +- 0.117 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all L1 = 0.113 +- 0.147 (in-sample avg dev_std = 0.145)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.528
NEC for r=0.6 class 0 = 0.235 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.153 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.108 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.137 +- 0.198 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.165 +- 0.194 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.532
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.45
NEC for r=0.9 class 0 = 0.249 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 1 = 0.279 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 class 2 = 0.201 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all KL = 0.237 +- 0.284 (in-sample avg dev_std = 0.400)
NEC for r=0.9 all L1 = 0.243 +- 0.237 (in-sample avg dev_std = 0.400)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:58:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:58:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mChartInfo 0.9250 0.9250 0.9250 0.9250 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.304 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 class 1 = 0.253 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 class 2 = 0.439 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 all KL = 0.23 +- 0.232 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.3 all L1 = 0.333 +- 0.180 (in-sample avg dev_std = 0.606)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.292 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 class 1 = 0.196 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 class 2 = 0.497 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 all KL = 0.247 +- 0.293 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.6 all L1 = 0.33 +- 0.232 (in-sample avg dev_std = 0.455)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.209
SUFF_SIMPLE for r=0.9 class 0 = 0.446 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 class 1 = 0.215 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 class 2 = 0.281 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 all KL = 0.256 +- 0.332 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.9 all L1 = 0.307 +- 0.255 (in-sample avg dev_std = 0.008)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.611 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 class 1 = 0.587 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 class 2 = 0.642 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 all KL = 0.602 +- 0.329 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 all L1 = 0.613 +- 0.272 (in-sample avg dev_std = 0.429)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.356
SUFF_SIMPLE for r=0.6 class 0 = 0.557 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 class 1 = 0.586 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 class 2 = 0.791 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 all KL = 0.646 +- 0.332 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.6 all L1 = 0.645 +- 0.294 (in-sample avg dev_std = 0.381)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.23
SUFF_SIMPLE for r=0.9 class 0 = 0.88 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.675 +- 0.293 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0 = 0.489 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.377 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.22 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.37 +- 0.347 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.359 +- 0.260 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.641
NEC for r=0.6 class 0 = 0.52 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.385 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.357 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.449 +- 0.345 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.418 +- 0.255 (in-sample avg dev_std = 0.508)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.525
NEC for r=0.9 class 0 = 0.57 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 1 = 0.529 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 class 2 = 0.543 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all KL = 0.631 +- 0.280 (in-sample avg dev_std = 0.671)
NEC for r=0.9 all L1 = 0.547 +- 0.193 (in-sample avg dev_std = 0.671)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
NEC for r=0.3 class 0 = 0.517 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 1 = 0.311 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 2 = 0.085 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all KL = 0.27 +- 0.300 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all L1 = 0.305 +- 0.291 (in-sample avg dev_std = 0.245)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.523 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1 = 0.323 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 2 = 0.141 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.31 +- 0.312 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.329 +- 0.293 (in-sample avg dev_std = 0.304)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.492 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.354 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.305 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.394 +- 0.309 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.384 +- 0.268 (in-sample avg dev_std = 0.445)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:00:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:00:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.9247 0.9247 0.9247 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.445 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 class 2 = 0.315 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 all KL = 0.262 +- 0.236 (in-sample avg dev_std = 0.515)
SUFF_SIMPLE for r=0.3 all L1 = 0.341 +- 0.171 (in-sample avg dev_std = 0.515)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.306
SUFF_SIMPLE for r=0.6 class 0 = 0.546 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 class 1 = 0.215 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 class 2 = 0.277 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 all KL = 0.292 +- 0.269 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.6 all L1 = 0.342 +- 0.197 (in-sample avg dev_std = 0.323)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.276
SUFF_SIMPLE for r=0.9 class 0 = 0.683 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 class 1 = 0.227 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 class 2 = 0.24 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 all KL = 0.355 +- 0.368 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.9 all L1 = 0.366 +- 0.270 (in-sample avg dev_std = 0.003)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.851 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 class 1 = 0.58 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 class 2 = 0.333 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 all KL = 0.622 +- 0.351 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.3 all L1 = 0.588 +- 0.317 (in-sample avg dev_std = 0.162)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.322
SUFF_SIMPLE for r=0.6 class 0 = 0.826 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 class 1 = 0.593 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 class 2 = 0.337 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 all KL = 0.623 +- 0.344 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.6 all L1 = 0.585 +- 0.312 (in-sample avg dev_std = 0.161)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.804 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.764 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.348 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.587 +- 0.277 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.786
NEC for r=0.3 class 0 = 0.408 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.314 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.199 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.287 +- 0.271 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.304 +- 0.206 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.676
NEC for r=0.6 class 0 = 0.502 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.361 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.371 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.433 +- 0.309 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.409 +- 0.226 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.542 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 class 1 = 0.519 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 class 2 = 0.566 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 all KL = 0.616 +- 0.274 (in-sample avg dev_std = 0.646)
NEC for r=0.9 all L1 = 0.543 +- 0.186 (in-sample avg dev_std = 0.646)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.717
NEC for r=0.3 class 0 = 0.108 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.241 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.277 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.109 +- 0.125 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.209 +- 0.138 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0 = 0.194 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1 = 0.268 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 2 = 0.357 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.202 +- 0.220 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.273 +- 0.169 (in-sample avg dev_std = 0.399)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.25 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 1 = 0.336 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 2 = 0.497 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all KL = 0.322 +- 0.278 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all L1 = 0.361 +- 0.218 (in-sample avg dev_std = 0.487)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:03:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:03:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9270 0.9270[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 1 = 0.273 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 class 2 = 0.453 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all KL = 0.26 +- 0.235 (in-sample avg dev_std = 0.600)
SUFF_SIMPLE for r=0.3 all L1 = 0.348 +- 0.186 (in-sample avg dev_std = 0.600)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.294
SUFF_SIMPLE for r=0.6 class 0 = 0.304 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 2 = 0.514 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all KL = 0.272 +- 0.293 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all L1 = 0.342 +- 0.237 (in-sample avg dev_std = 0.452)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.439 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 class 2 = 0.295 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 all KL = 0.271 +- 0.327 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.9 all L1 = 0.308 +- 0.242 (in-sample avg dev_std = 0.006)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.327
SUFF_SIMPLE for r=0.3 class 0 = 0.441 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 class 1 = 0.373 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 class 2 = 0.462 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 all KL = 0.446 +- 0.196 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.3 all L1 = 0.425 +- 0.125 (in-sample avg dev_std = 0.511)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
SUFF_SIMPLE for r=0.6 class 0 = 0.409 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 class 1 = 0.37 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 class 2 = 0.595 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 all KL = 0.494 +- 0.216 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.6 all L1 = 0.458 +- 0.185 (in-sample avg dev_std = 0.503)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.042
SUFF_SIMPLE for r=0.9 class 0 = 0.473 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.238 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.481 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.383 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.682
NEC for r=0.3 class 0 = 0.491 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 1 = 0.391 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 class 2 = 0.195 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all KL = 0.348 +- 0.347 (in-sample avg dev_std = 0.387)
NEC for r=0.3 all L1 = 0.355 +- 0.271 (in-sample avg dev_std = 0.387)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.652
NEC for r=0.6 class 0 = 0.522 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 1 = 0.395 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 class 2 = 0.332 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all KL = 0.43 +- 0.338 (in-sample avg dev_std = 0.503)
NEC for r=0.6 all L1 = 0.414 +- 0.251 (in-sample avg dev_std = 0.503)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.532
NEC for r=0.9 class 0 = 0.564 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 1 = 0.527 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 class 2 = 0.518 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all KL = 0.603 +- 0.279 (in-sample avg dev_std = 0.653)
NEC for r=0.9 all L1 = 0.535 +- 0.193 (in-sample avg dev_std = 0.653)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.726 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 1 = 0.577 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 2 = 0.143 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all KL = 0.42 +- 0.295 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all L1 = 0.482 +- 0.281 (in-sample avg dev_std = 0.276)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.384
NEC for r=0.6 class 0 = 0.73 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 1 = 0.572 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 2 = 0.201 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all KL = 0.459 +- 0.281 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all L1 = 0.501 +- 0.265 (in-sample avg dev_std = 0.342)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.329
NEC for r=0.9 class 0 = 0.692 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 1 = 0.565 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 class 2 = 0.41 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all KL = 0.54 +- 0.204 (in-sample avg dev_std = 0.508)
NEC for r=0.9 all L1 = 0.556 +- 0.167 (in-sample avg dev_std = 0.508)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:05:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:05:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 69 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9247 0.9247[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.302 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 1 = 0.29 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 2 = 0.435 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all KL = 0.25 +- 0.236 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all L1 = 0.344 +- 0.184 (in-sample avg dev_std = 0.599)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.298
SUFF_SIMPLE for r=0.6 class 0 = 0.295 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 class 1 = 0.229 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 class 2 = 0.477 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 all KL = 0.26 +- 0.282 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.6 all L1 = 0.336 +- 0.228 (in-sample avg dev_std = 0.445)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.214
SUFF_SIMPLE for r=0.9 class 0 = 0.451 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 class 1 = 0.274 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 class 2 = 0.261 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 all KL = 0.292 +- 0.302 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.9 all L1 = 0.321 +- 0.227 (in-sample avg dev_std = 0.007)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.5 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 1 = 0.405 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 class 2 = 0.438 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all KL = 0.444 +- 0.230 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.154 (in-sample avg dev_std = 0.599)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.352
SUFF_SIMPLE for r=0.6 class 0 = 0.434 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 class 1 = 0.409 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 class 2 = 0.565 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 all KL = 0.474 +- 0.249 (in-sample avg dev_std = 0.576)
SUFF_SIMPLE for r=0.6 all L1 = 0.47 +- 0.190 (in-sample avg dev_std = 0.576)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.037
SUFF_SIMPLE for r=0.9 class 0 = 0.414 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.44 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.225 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.428 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.128 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.723
NEC for r=0.3 class 0 = 0.503 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.36 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.199 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.347 +- 0.319 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.35 +- 0.242 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.645
NEC for r=0.6 class 0 = 0.53 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 1 = 0.393 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 class 2 = 0.364 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all KL = 0.456 +- 0.332 (in-sample avg dev_std = 0.529)
NEC for r=0.6 all L1 = 0.427 +- 0.242 (in-sample avg dev_std = 0.529)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.526
NEC for r=0.9 class 0 = 0.577 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 class 1 = 0.544 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 class 2 = 0.548 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 all KL = 0.639 +- 0.271 (in-sample avg dev_std = 0.684)
NEC for r=0.9 all L1 = 0.556 +- 0.182 (in-sample avg dev_std = 0.684)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
NEC for r=0.3 class 0 = 0.729 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1 = 0.45 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 2 = 0.132 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.387 +- 0.310 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.437 +- 0.284 (in-sample avg dev_std = 0.309)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.732 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 1 = 0.462 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 2 = 0.192 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all KL = 0.436 +- 0.311 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all L1 = 0.463 +- 0.268 (in-sample avg dev_std = 0.389)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.332
NEC for r=0.9 class 0 = 0.698 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 1 = 0.512 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 2 = 0.413 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all KL = 0.538 +- 0.251 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all L1 = 0.541 +- 0.183 (in-sample avg dev_std = 0.536)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:07:52 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:07:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.297 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 1 = 0.273 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 class 2 = 0.42 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all KL = 0.233 +- 0.232 (in-sample avg dev_std = 0.609)
SUFF_SIMPLE for r=0.3 all L1 = 0.332 +- 0.174 (in-sample avg dev_std = 0.609)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.294
SUFF_SIMPLE for r=0.6 class 0 = 0.283 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 1 = 0.199 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 class 2 = 0.495 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all KL = 0.246 +- 0.287 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.6 all L1 = 0.328 +- 0.227 (in-sample avg dev_std = 0.463)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.204
SUFF_SIMPLE for r=0.9 class 0 = 0.415 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all KL = 0.245 +- 0.332 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all L1 = 0.299 +- 0.247 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.527 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 class 1 = 0.615 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 class 2 = 0.654 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 all KL = 0.616 +- 0.299 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.3 all L1 = 0.598 +- 0.251 (in-sample avg dev_std = 0.394)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
SUFF_SIMPLE for r=0.6 class 0 = 0.484 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 class 1 = 0.623 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 class 2 = 0.765 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 all KL = 0.647 +- 0.310 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.6 all L1 = 0.624 +- 0.271 (in-sample avg dev_std = 0.365)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.28
SUFF_SIMPLE for r=0.9 class 0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.516 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.611 +- 0.244 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.689
NEC for r=0.3 class 0 = 0.501 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 class 1 = 0.353 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 class 2 = 0.242 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 all KL = 0.363 +- 0.354 (in-sample avg dev_std = 0.398)
NEC for r=0.3 all L1 = 0.362 +- 0.273 (in-sample avg dev_std = 0.398)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.635
NEC for r=0.6 class 0 = 0.541 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 1 = 0.361 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 class 2 = 0.367 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all KL = 0.446 +- 0.349 (in-sample avg dev_std = 0.508)
NEC for r=0.6 all L1 = 0.421 +- 0.265 (in-sample avg dev_std = 0.508)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.52
NEC for r=0.9 class 0 = 0.588 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 class 1 = 0.507 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 class 2 = 0.548 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 all KL = 0.632 +- 0.280 (in-sample avg dev_std = 0.666)
NEC for r=0.9 all L1 = 0.547 +- 0.201 (in-sample avg dev_std = 0.666)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.58 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 1 = 0.345 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 2 = 0.104 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all KL = 0.305 +- 0.322 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all L1 = 0.343 +- 0.298 (in-sample avg dev_std = 0.266)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.589 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.346 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.155 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.34 +- 0.328 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.364 +- 0.298 (in-sample avg dev_std = 0.309)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.314
NEC for r=0.9 class 0 = 0.57 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 1 = 0.371 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 class 2 = 0.304 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all KL = 0.413 +- 0.314 (in-sample avg dev_std = 0.416)
NEC for r=0.9 all L1 = 0.416 +- 0.271 (in-sample avg dev_std = 0.416)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:09:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:09:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
SUFF_SIMPLE for r=0.3 class 0 = 0.31 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 class 2 = 0.429 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 all KL = 0.236 +- 0.241 (in-sample avg dev_std = 0.607)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.189 (in-sample avg dev_std = 0.607)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.29
SUFF_SIMPLE for r=0.6 class 0 = 0.294 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 class 1 = 0.198 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 class 2 = 0.491 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 all KL = 0.248 +- 0.295 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.6 all L1 = 0.33 +- 0.235 (in-sample avg dev_std = 0.459)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.458 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 all KL = 0.264 +- 0.332 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.9 all L1 = 0.31 +- 0.249 (in-sample avg dev_std = 0.009)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.433 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 class 1 = 0.28 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 class 2 = 0.392 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 all KL = 0.327 +- 0.183 (in-sample avg dev_std = 0.646)
SUFF_SIMPLE for r=0.3 all L1 = 0.369 +- 0.135 (in-sample avg dev_std = 0.646)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.361
SUFF_SIMPLE for r=0.6 class 0 = 0.387 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 class 1 = 0.266 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 class 2 = 0.538 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 all KL = 0.367 +- 0.239 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 all L1 = 0.398 +- 0.200 (in-sample avg dev_std = 0.623)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.222 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.464 +- 0.247 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.691
NEC for r=0.3 class 0 = 0.481 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1 = 0.345 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 2 = 0.237 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.363 +- 0.360 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.351 +- 0.274 (in-sample avg dev_std = 0.412)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.637
NEC for r=0.6 class 0 = 0.513 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 class 1 = 0.359 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 class 2 = 0.388 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 all KL = 0.453 +- 0.352 (in-sample avg dev_std = 0.524)
NEC for r=0.6 all L1 = 0.418 +- 0.261 (in-sample avg dev_std = 0.524)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.523
NEC for r=0.9 class 0 = 0.565 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 class 1 = 0.515 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 class 2 = 0.557 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 all KL = 0.632 +- 0.285 (in-sample avg dev_std = 0.674)
NEC for r=0.9 all L1 = 0.546 +- 0.201 (in-sample avg dev_std = 0.674)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.757 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 1 = 0.655 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 2 = 0.274 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all KL = 0.558 +- 0.320 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all L1 = 0.562 +- 0.256 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.752 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 1 = 0.663 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 class 2 = 0.326 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all KL = 0.595 +- 0.297 (in-sample avg dev_std = 0.421)
NEC for r=0.6 all L1 = 0.581 +- 0.232 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.693 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 1 = 0.639 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 class 2 = 0.513 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all KL = 0.648 +- 0.199 (in-sample avg dev_std = 0.608)
NEC for r=0.9 all L1 = 0.615 +- 0.127 (in-sample avg dev_std = 0.608)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:11:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:11:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.301 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 class 1 = 0.265 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 class 2 = 0.432 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 all KL = 0.228 +- 0.230 (in-sample avg dev_std = 0.621)
SUFF_SIMPLE for r=0.3 all L1 = 0.334 +- 0.181 (in-sample avg dev_std = 0.621)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.281 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 class 1 = 0.195 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 class 2 = 0.508 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 all KL = 0.245 +- 0.291 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.6 all L1 = 0.331 +- 0.235 (in-sample avg dev_std = 0.470)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.207
SUFF_SIMPLE for r=0.9 class 0 = 0.44 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 1 = 0.201 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 class 2 = 0.285 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all KL = 0.248 +- 0.337 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.9 all L1 = 0.302 +- 0.258 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.492 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 class 1 = 0.296 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 class 2 = 0.391 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 all KL = 0.325 +- 0.194 (in-sample avg dev_std = 0.654)
SUFF_SIMPLE for r=0.3 all L1 = 0.393 +- 0.150 (in-sample avg dev_std = 0.654)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
SUFF_SIMPLE for r=0.6 class 0 = 0.419 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 class 1 = 0.279 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 class 2 = 0.538 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 all KL = 0.361 +- 0.263 (in-sample avg dev_std = 0.605)
SUFF_SIMPLE for r=0.6 all L1 = 0.413 +- 0.205 (in-sample avg dev_std = 0.605)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.406
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.831 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.412 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.729 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.286 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.679
NEC for r=0.3 class 0 = 0.494 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1 = 0.394 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 2 = 0.218 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.373 +- 0.356 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.365 +- 0.274 (in-sample avg dev_std = 0.411)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.645
NEC for r=0.6 class 0 = 0.521 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 1 = 0.394 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 2 = 0.338 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all KL = 0.445 +- 0.348 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all L1 = 0.415 +- 0.260 (in-sample avg dev_std = 0.516)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0 = 0.564 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 class 1 = 0.53 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 class 2 = 0.54 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 all KL = 0.634 +- 0.279 (in-sample avg dev_std = 0.683)
NEC for r=0.9 all L1 = 0.544 +- 0.194 (in-sample avg dev_std = 0.683)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.755 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.75 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.456 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.693 +- 0.299 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.653 +- 0.222 (in-sample avg dev_std = 0.403)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.381
NEC for r=0.6 class 0 = 0.746 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.739 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.496 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.716 +- 0.262 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.66 +- 0.189 (in-sample avg dev_std = 0.468)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
NEC for r=0.9 class 0 = 0.647 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 1 = 0.681 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 class 2 = 0.587 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all KL = 0.712 +- 0.184 (in-sample avg dev_std = 0.656)
NEC for r=0.9 all L1 = 0.638 +- 0.113 (in-sample avg dev_std = 0.656)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:12:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:12:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 82 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
SUFF_SIMPLE for r=0.3 class 0 = 0.309 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 class 1 = 0.27 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 class 2 = 0.429 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 all KL = 0.234 +- 0.229 (in-sample avg dev_std = 0.625)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.183 (in-sample avg dev_std = 0.625)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.288 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 class 1 = 0.203 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 class 2 = 0.501 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 all KL = 0.251 +- 0.294 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.6 all L1 = 0.333 +- 0.238 (in-sample avg dev_std = 0.465)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.205
SUFF_SIMPLE for r=0.9 class 0 = 0.409 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 all KL = 0.247 +- 0.316 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.234 (in-sample avg dev_std = 0.005)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.481 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 class 1 = 0.468 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 class 2 = 0.476 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 all KL = 0.453 +- 0.250 (in-sample avg dev_std = 0.588)
SUFF_SIMPLE for r=0.3 all L1 = 0.475 +- 0.157 (in-sample avg dev_std = 0.588)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.362
SUFF_SIMPLE for r=0.6 class 0 = 0.427 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 class 1 = 0.509 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 class 2 = 0.62 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 all KL = 0.509 +- 0.274 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.6 all L1 = 0.518 +- 0.207 (in-sample avg dev_std = 0.546)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.05
SUFF_SIMPLE for r=0.9 class 0 = 0.347 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.382 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.124 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0 = 0.493 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 class 1 = 0.37 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 class 2 = 0.223 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 all KL = 0.361 +- 0.348 (in-sample avg dev_std = 0.402)
NEC for r=0.3 all L1 = 0.358 +- 0.269 (in-sample avg dev_std = 0.402)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.634
NEC for r=0.6 class 0 = 0.514 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.39 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.376 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.455 +- 0.354 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.425 +- 0.263 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.514
NEC for r=0.9 class 0 = 0.561 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 1 = 0.539 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 class 2 = 0.564 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all KL = 0.64 +- 0.279 (in-sample avg dev_std = 0.673)
NEC for r=0.9 all L1 = 0.555 +- 0.194 (in-sample avg dev_std = 0.673)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.404
NEC for r=0.3 class 0 = 0.71 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 1 = 0.403 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 class 2 = 0.085 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all KL = 0.354 +- 0.313 (in-sample avg dev_std = 0.287)
NEC for r=0.3 all L1 = 0.4 +- 0.295 (in-sample avg dev_std = 0.287)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.715 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 1 = 0.408 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 2 = 0.142 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all KL = 0.399 +- 0.318 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all L1 = 0.422 +- 0.285 (in-sample avg dev_std = 0.356)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.319
NEC for r=0.9 class 0 = 0.697 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 1 = 0.47 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 class 2 = 0.369 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all KL = 0.521 +- 0.265 (in-sample avg dev_std = 0.501)
NEC for r=0.9 all L1 = 0.512 +- 0.210 (in-sample avg dev_std = 0.501)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.257, 0.286], 'all_L1': [0.343, 0.334, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.316, 0.335], 'all_L1': [0.354, 0.365, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.23, 0.247, 0.256], 'all_L1': [0.333, 0.33, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.262, 0.292, 0.355], 'all_L1': [0.341, 0.342, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.272, 0.271], 'all_L1': [0.348, 0.342, 0.308]}), defaultdict(<class 'list'>, {'all_KL': [0.25, 0.26, 0.292], 'all_L1': [0.344, 0.336, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.233, 0.246, 0.245], 'all_L1': [0.332, 0.328, 0.299]}), defaultdict(<class 'list'>, {'all_KL': [0.236, 0.248, 0.264], 'all_L1': [0.337, 0.33, 0.31]}), defaultdict(<class 'list'>, {'all_KL': [0.228, 0.245, 0.248], 'all_L1': [0.334, 0.331, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.234, 0.251, 0.247], 'all_L1': [0.337, 0.333, 0.297]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.364, 0.457, 0.635], 'all_L1': [0.357, 0.424, 0.549]}), defaultdict(<class 'list'>, {'all_KL': [0.317, 0.43, 0.599], 'all_L1': [0.328, 0.413, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.449, 0.631], 'all_L1': [0.359, 0.418, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.287, 0.433, 0.616], 'all_L1': [0.304, 0.409, 0.543]}), defaultdict(<class 'list'>, {'all_KL': [0.348, 0.43, 0.603], 'all_L1': [0.355, 0.414, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.347, 0.456, 0.639], 'all_L1': [0.35, 0.427, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.446, 0.632], 'all_L1': [0.362, 0.421, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.453, 0.632], 'all_L1': [0.351, 0.418, 0.546]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.445, 0.634], 'all_L1': [0.365, 0.415, 0.544]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.455, 0.64], 'all_L1': [0.358, 0.425, 0.555]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.371, 0.429, 0.72], 'all_L1': [0.448, 0.485, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.716, 0.721, 0.873], 'all_L1': [0.707, 0.711, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.646, 0.667], 'all_L1': [0.613, 0.645, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.623, 0.667], 'all_L1': [0.588, 0.585, 0.587]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.494, 0.481], 'all_L1': [0.425, 0.458, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.474, 0.428], 'all_L1': [0.448, 0.47, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.616, 0.647, 0.625], 'all_L1': [0.598, 0.624, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.327, 0.367, 0.542], 'all_L1': [0.369, 0.398, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.325, 0.361, 0.729], 'all_L1': [0.393, 0.413, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.453, 0.509, 0.345], 'all_L1': [0.475, 0.518, 0.314]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.597, 0.624, 0.65], 'all_L1': [0.572, 0.584, 0.588]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.137, 0.237], 'all_L1': [0.113, 0.165, 0.243]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.31, 0.394], 'all_L1': [0.305, 0.329, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.202, 0.322], 'all_L1': [0.209, 0.273, 0.361]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.459, 0.54], 'all_L1': [0.482, 0.501, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.436, 0.538], 'all_L1': [0.437, 0.463, 0.541]}), defaultdict(<class 'list'>, {'all_KL': [0.305, 0.34, 0.413], 'all_L1': [0.343, 0.364, 0.416]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.595, 0.648], 'all_L1': [0.562, 0.581, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.693, 0.716, 0.712], 'all_L1': [0.653, 0.66, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.354, 0.399, 0.521], 'all_L1': [0.4, 0.422, 0.512]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.340 +- 0.007, 0.337 +- 0.010, 0.320 +- 0.025
suff_simple class all_KL  =  0.246 +- 0.017, 0.263 +- 0.022, 0.280 +- 0.036
[[0.343625009059906, 0.2927500009536743, 0.21301774680614471], [0.33675000071525574, 0.3112083375453949, 0.27044108510017395], [0.3400416672229767, 0.2933333218097687, 0.2092522829771042], [0.335916668176651, 0.30566665530204773, 0.27615654468536377], [0.3460833430290222, 0.2944999933242798, 0.20763851702213287], [0.3449999988079071, 0.29762500524520874, 0.21355567872524261], [0.34337499737739563, 0.29366666078567505, 0.20387305319309235], [0.3408749997615814, 0.2904583215713501, 0.20817643404006958], [0.34304165840148926, 0.2926250100135803, 0.20656266808509827], [0.343583345413208, 0.2926250100135803, 0.20494890213012695]]
[[0.244, 0.257, 0.286], [0.283, 0.316, 0.335], [0.23, 0.247, 0.256], [0.262, 0.292, 0.355], [0.26, 0.272, 0.271], [0.25, 0.26, 0.292], [0.233, 0.246, 0.245], [0.236, 0.248, 0.264], [0.228, 0.245, 0.248], [0.234, 0.251, 0.247]]
suff_simple_acc_int  =  0.342 +- 0.003, 0.296 +- 0.006, 0.221 +- 0.026
nec class all_L1  =  0.349 +- 0.018, 0.418 +- 0.006, 0.545 +- 0.007
nec class all_KL  =  0.349 +- 0.026, 0.445 +- 0.010, 0.626 +- 0.014
[[0.6934166550636292, 0.6330833435058594, 0.5175833106040955], [0.7365000247955322, 0.6572499871253967, 0.5296249985694885], [0.6917499899864197, 0.640916645526886, 0.5248333215713501], [0.7859583497047424, 0.6758333444595337, 0.5291666388511658], [0.6820833086967468, 0.6524583101272583, 0.5322499871253967], [0.7227916717529297, 0.6454583406448364, 0.5260416865348816], [0.6890833377838135, 0.6345833539962769, 0.5204166769981384], [0.690750002861023, 0.637499988079071, 0.5230416655540466], [0.6789583563804626, 0.6447499990463257, 0.5291666388511658], [0.6922083497047424, 0.6342499852180481, 0.5141666531562805]]
[[0.364, 0.457, 0.635], [0.317, 0.43, 0.599], [0.37, 0.449, 0.631], [0.287, 0.433, 0.616], [0.348, 0.43, 0.603], [0.347, 0.456, 0.639], [0.363, 0.446, 0.632], [0.363, 0.453, 0.632], [0.373, 0.445, 0.634], [0.361, 0.455, 0.64]]
nec_acc_int  =  0.706 +- 0.032, 0.646 +- 0.013, 0.525 +- 0.006

Eval split val
suff_simple class all_L1  =  0.506 +- 0.106, 0.531 +- 0.100, 0.553 +- 0.163
suff_simple class all_KL  =  0.492 +- 0.130, 0.527 +- 0.119, 0.608 +- 0.151
[[0.3297083377838135, 0.35070833563804626, 0.1711939424276352], [0.3407916724681854, 0.3384583294391632, 0.44219836592674255], [0.3382916748523712, 0.3563750088214874, 0.2299431413412094], [0.3292500078678131, 0.3219166696071625, 0.16929879784584045], [0.32733333110809326, 0.3553749918937683, 0.042324699461460114], [0.3389166593551636, 0.35233333706855774, 0.03727100417017937], [0.3402499854564667, 0.35475000739097595, 0.2804800868034363], [0.3370000123977661, 0.36116665601730347, 0.16929879784584045], [0.34291666746139526, 0.35499998927116394, 0.1711939424276352], [0.34316667914390564, 0.3623333275318146, 0.04990524426102638]]
[[0.371, 0.429, 0.72], [0.716, 0.721, 0.873], [0.602, 0.646, 0.667], [0.622, 0.623, 0.667], [0.446, 0.494, 0.481], [0.444, 0.474, 0.428], [0.616, 0.647, 0.625], [0.327, 0.367, 0.542], [0.325, 0.361, 0.729], [0.453, 0.509, 0.345]]
suff_simple_acc_int  =  0.337 +- 0.006, 0.351 +- 0.011, 0.176 +- 0.117
nec class all_L1  =  0.408 +- 0.161, 0.434 +- 0.147, 0.485 +- 0.122
nec class all_KL  =  0.377 +- 0.191, 0.422 +- 0.176, 0.497 +- 0.146
[[0.4949583411216736, 0.48887500166893005, 0.429791659116745], [0.5809166431427002, 0.528291642665863, 0.44975000619888306], [0.40820834040641785, 0.3961666524410248, 0.35329166054725647], [0.7173749804496765, 0.6555416584014893, 0.5415833592414856], [0.3761250078678131, 0.38350000977516174, 0.32850000262260437], [0.4335416555404663, 0.4047916531562805, 0.3317916691303253], [0.36545833945274353, 0.3543750047683716, 0.3139166533946991], [0.39508333802223206, 0.3866666555404663, 0.3577916622161865], [0.37679165601730347, 0.3813750147819519, 0.367041677236557], [0.40429165959358215, 0.38337498903274536, 0.3189166784286499]]
[[0.597, 0.624, 0.65], [0.072, 0.137, 0.237], [0.27, 0.31, 0.394], [0.109, 0.202, 0.322], [0.42, 0.459, 0.54], [0.387, 0.436, 0.538], [0.305, 0.34, 0.413], [0.558, 0.595, 0.648], [0.693, 0.716, 0.712], [0.354, 0.399, 0.521]]
nec_acc_int  =  0.455 +- 0.107, 0.436 +- 0.089, 0.379 +- 0.069


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.345 +- 0.008, 0.378 +- 0.005, 0.433 +- 0.011
Faith. Armon (L1)= 		  =  0.344 +- 0.008, 0.373 +- 0.005, 0.403 +- 0.018
Faith. GMean (L1)= 	  =  0.344 +- 0.008, 0.375 +- 0.005, 0.417 +- 0.015
Faith. Aritm (KL)= 		  =  0.298 +- 0.008, 0.354 +- 0.008, 0.453 +- 0.015
Faith. Armon (KL)= 		  =  0.287 +- 0.007, 0.330 +- 0.015, 0.385 +- 0.032
Faith. GMean (KL)= 	  =  0.292 +- 0.007, 0.342 +- 0.011, 0.418 +- 0.024

Eval split val
Faith. Aritm (L1)= 		  =  0.457 +- 0.037, 0.482 +- 0.033, 0.519 +- 0.070
Faith. Armon (L1)= 		  =  0.411 +- 0.088, 0.446 +- 0.071, 0.486 +- 0.085
Faith. GMean (L1)= 	  =  0.432 +- 0.064, 0.463 +- 0.053, 0.502 +- 0.075
Faith. Aritm (KL)= 		  =  0.434 +- 0.041, 0.474 +- 0.037, 0.553 +- 0.086
Faith. Armon (KL)= 		  =  0.365 +- 0.107, 0.422 +- 0.082, 0.519 +- 0.107
Faith. GMean (KL)= 	  =  0.394 +- 0.079, 0.446 +- 0.061, 0.535 +- 0.094
Computed for split load_split = id



Completed in  0:20:46.877083  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN PLAIN GOODMotif/basis/covariate NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:14:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:14:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.9297 0.9297 0.9297 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.507
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.428
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.787
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5065726666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.588
SUFF_SIMPLE for r=0.3 class 0 = 0.391 +- 0.390 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 class 1 = 0.642 +- 0.390 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 class 2 = 0.803 +- 0.390 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 all KL = 0.54 +- 0.390 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.3 all L1 = 0.617 +- 0.334 (in-sample avg dev_std = 0.516)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4277166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.66
SUFF_SIMPLE for r=0.6 class 0 = 0.466 +- 0.393 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 class 1 = 0.671 +- 0.393 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 class 2 = 0.911 +- 0.393 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 all KL = 0.638 +- 0.393 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 all L1 = 0.688 +- 0.339 (in-sample avg dev_std = 0.406)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3305263333333333
len(reference) = 2655
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.826
SUFF_SIMPLE for r=0.9 class 0 = 0.719 +- 0.298 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.9 class 1 = 0.954 +- 0.298 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.9 class 2 = 0.984 +- 0.298 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.9 all KL = 0.881 +- 0.298 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.9 all L1 = 0.887 +- 0.265 (in-sample avg dev_std = 0.069)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7874073333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.397
SUFF_SIMPLE for r=0.3 class 0 = 0.424 +- 0.392 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.3 class 1 = 0.321 +- 0.392 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.3 class 2 = 0.878 +- 0.392 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.3 all KL = 0.515 +- 0.392 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.3 all L1 = 0.542 +- 0.326 (in-sample avg dev_std = 0.389)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989473333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.429
SUFF_SIMPLE for r=0.6 class 0 = 0.426 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.445 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.965 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.613 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.612 +- 0.368 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4847123333333333
len(reference) = 681
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.93
SUFF_SIMPLE for r=0.9 class 0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5065726666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.22
NEC for r=0.3 class 0 = 0.748 +- 0.137 (in-sample avg dev_std = 0.594)
NEC for r=0.3 class 1 = 0.663 +- 0.137 (in-sample avg dev_std = 0.594)
NEC for r=0.3 class 2 = 0.776 +- 0.137 (in-sample avg dev_std = 0.594)
NEC for r=0.3 all KL = 0.858 +- 0.137 (in-sample avg dev_std = 0.594)
NEC for r=0.3 all L1 = 0.73 +- 0.143 (in-sample avg dev_std = 0.594)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4277166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.412
NEC for r=0.6 class 0 = 0.665 +- 0.212 (in-sample avg dev_std = 0.758)
NEC for r=0.6 class 1 = 0.493 +- 0.212 (in-sample avg dev_std = 0.758)
NEC for r=0.6 class 2 = 0.645 +- 0.212 (in-sample avg dev_std = 0.758)
NEC for r=0.6 all KL = 0.738 +- 0.212 (in-sample avg dev_std = 0.758)
NEC for r=0.6 all L1 = 0.601 +- 0.199 (in-sample avg dev_std = 0.758)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3305263333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.517
NEC for r=0.9 class 0 = 0.597 +- 0.237 (in-sample avg dev_std = 0.794)
NEC for r=0.9 class 1 = 0.408 +- 0.237 (in-sample avg dev_std = 0.794)
NEC for r=0.9 class 2 = 0.548 +- 0.237 (in-sample avg dev_std = 0.794)
NEC for r=0.9 all KL = 0.652 +- 0.237 (in-sample avg dev_std = 0.794)
NEC for r=0.9 all L1 = 0.517 +- 0.211 (in-sample avg dev_std = 0.794)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7874073333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.615 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 class 1 = 0.591 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 class 2 = 0.542 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 all KL = 0.623 +- 0.268 (in-sample avg dev_std = 0.541)
NEC for r=0.3 all L1 = 0.582 +- 0.205 (in-sample avg dev_std = 0.541)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989473333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.51
NEC for r=0.6 class 0 = 0.489 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 class 1 = 0.364 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 class 2 = 0.352 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 all KL = 0.436 +- 0.285 (in-sample avg dev_std = 0.605)
NEC for r=0.6 all L1 = 0.402 +- 0.229 (in-sample avg dev_std = 0.605)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4847123333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.564
NEC for r=0.9 class 0 = 0.425 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 1 = 0.304 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 class 2 = 0.294 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all KL = 0.368 +- 0.266 (in-sample avg dev_std = 0.584)
NEC for r=0.9 all L1 = 0.341 +- 0.215 (in-sample avg dev_std = 0.584)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:17:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:17:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9273 0.9273 0.9273 0.9273 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.426
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.322
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.786
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.629
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.447


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.559169
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.605
SUFF_SIMPLE for r=0.3 class 0 = 0.38 +- 0.388 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.3 class 1 = 0.879 +- 0.388 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.3 class 2 = 0.612 +- 0.388 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.3 all KL = 0.553 +- 0.388 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.3 all L1 = 0.627 +- 0.331 (in-sample avg dev_std = 0.544)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4257253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.67
SUFF_SIMPLE for r=0.6 class 0 = 0.371 +- 0.383 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.6 class 1 = 0.887 +- 0.383 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.6 class 2 = 0.849 +- 0.383 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.6 all KL = 0.657 +- 0.383 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.6 all L1 = 0.709 +- 0.331 (in-sample avg dev_std = 0.439)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32248733333333335
len(reference) = 2343
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.872
SUFF_SIMPLE for r=0.9 class 0 = 0.82 +- 0.224 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 class 1 = 0.974 +- 0.224 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 class 2 = 0.981 +- 0.224 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 all KL = 0.932 +- 0.224 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.9 all L1 = 0.92 +- 0.202 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7860260000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.591
SUFF_SIMPLE for r=0.3 class 0 = 0.658 +- 0.343 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 class 1 = 0.84 +- 0.343 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 class 2 = 0.803 +- 0.343 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 all KL = 0.758 +- 0.343 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.3 all L1 = 0.767 +- 0.313 (in-sample avg dev_std = 0.356)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6294076666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.63
SUFF_SIMPLE for r=0.6 class 0 = 0.686 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.863 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.985 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.863 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.844 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4472193333333333
len(reference) = 2400
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.621
SUFF_SIMPLE for r=0.9 class 0 = 0.774 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.982 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.991 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.941 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.9 +- 0.197 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.559169
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.207
NEC for r=0.3 class 0 = 0.774 +- 0.130 (in-sample avg dev_std = 0.572)
NEC for r=0.3 class 1 = 0.647 +- 0.130 (in-sample avg dev_std = 0.572)
NEC for r=0.3 class 2 = 0.795 +- 0.130 (in-sample avg dev_std = 0.572)
NEC for r=0.3 all KL = 0.86 +- 0.130 (in-sample avg dev_std = 0.572)
NEC for r=0.3 all L1 = 0.739 +- 0.135 (in-sample avg dev_std = 0.572)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4257253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.377
NEC for r=0.6 class 0 = 0.704 +- 0.230 (in-sample avg dev_std = 0.691)
NEC for r=0.6 class 1 = 0.442 +- 0.230 (in-sample avg dev_std = 0.691)
NEC for r=0.6 class 2 = 0.702 +- 0.230 (in-sample avg dev_std = 0.691)
NEC for r=0.6 all KL = 0.738 +- 0.230 (in-sample avg dev_std = 0.691)
NEC for r=0.6 all L1 = 0.616 +- 0.215 (in-sample avg dev_std = 0.691)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32248733333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.494
NEC for r=0.9 class 0 = 0.628 +- 0.258 (in-sample avg dev_std = 0.750)
NEC for r=0.9 class 1 = 0.356 +- 0.258 (in-sample avg dev_std = 0.750)
NEC for r=0.9 class 2 = 0.604 +- 0.258 (in-sample avg dev_std = 0.750)
NEC for r=0.9 all KL = 0.651 +- 0.258 (in-sample avg dev_std = 0.750)
NEC for r=0.9 all L1 = 0.529 +- 0.230 (in-sample avg dev_std = 0.750)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7860260000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.236
NEC for r=0.3 class 0 = 0.662 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 class 1 = 0.596 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 class 2 = 0.636 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 all KL = 0.742 +- 0.258 (in-sample avg dev_std = 0.633)
NEC for r=0.3 all L1 = 0.632 +- 0.240 (in-sample avg dev_std = 0.633)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6294076666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.433
NEC for r=0.6 class 0 = 0.464 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 1 = 0.406 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 2 = 0.429 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all KL = 0.521 +- 0.284 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all L1 = 0.433 +- 0.250 (in-sample avg dev_std = 0.699)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4472193333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.478
NEC for r=0.9 class 0 = 0.44 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 class 1 = 0.366 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 class 2 = 0.372 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 all KL = 0.474 +- 0.279 (in-sample avg dev_std = 0.681)
NEC for r=0.9 all L1 = 0.393 +- 0.247 (in-sample avg dev_std = 0.681)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:20:22 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:20:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 108 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.527
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.445
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.334
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.526898
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.631
SUFF_SIMPLE for r=0.3 class 0 = 0.448 +- 0.377 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.3 class 1 = 0.815 +- 0.377 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.3 class 2 = 0.653 +- 0.377 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.3 all KL = 0.565 +- 0.377 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.3 all L1 = 0.642 +- 0.315 (in-sample avg dev_std = 0.566)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44542099999999996
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.759
SUFF_SIMPLE for r=0.6 class 0 = 0.552 +- 0.342 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 1 = 0.835 +- 0.342 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 2 = 0.893 +- 0.342 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all KL = 0.728 +- 0.342 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all L1 = 0.764 +- 0.281 (in-sample avg dev_std = 0.452)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33440733333333333
len(reference) = 2627
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.86
SUFF_SIMPLE for r=0.9 class 0 = 0.826 +- 0.246 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 class 1 = 0.966 +- 0.246 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 class 2 = 0.969 +- 0.246 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 all KL = 0.92 +- 0.246 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 all L1 = 0.921 +- 0.221 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839849999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.671
SUFF_SIMPLE for r=0.3 class 0 = 0.708 +- 0.319 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.3 class 1 = 0.885 +- 0.319 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.3 class 2 = 0.803 +- 0.319 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.3 all KL = 0.753 +- 0.319 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.3 all L1 = 0.798 +- 0.253 (in-sample avg dev_std = 0.507)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6988479999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.741
SUFF_SIMPLE for r=0.6 class 0 = 0.832 +- 0.275 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.6 class 1 = 0.795 +- 0.275 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.6 class 2 = 0.988 +- 0.275 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.6 all KL = 0.882 +- 0.275 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.6 all L1 = 0.872 +- 0.255 (in-sample avg dev_std = 0.102)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48528600000000005
len(reference) = 1945
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF_SIMPLE for r=0.9 class 0 = 0.872 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.514 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.988 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.839 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.839 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.526898
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.22
NEC for r=0.3 class 0 = 0.745 +- 0.135 (in-sample avg dev_std = 0.597)
NEC for r=0.3 class 1 = 0.671 +- 0.135 (in-sample avg dev_std = 0.597)
NEC for r=0.3 class 2 = 0.787 +- 0.135 (in-sample avg dev_std = 0.597)
NEC for r=0.3 all KL = 0.865 +- 0.135 (in-sample avg dev_std = 0.597)
NEC for r=0.3 all L1 = 0.735 +- 0.141 (in-sample avg dev_std = 0.597)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44542099999999996
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.623 +- 0.208 (in-sample avg dev_std = 0.776)
NEC for r=0.6 class 1 = 0.499 +- 0.208 (in-sample avg dev_std = 0.776)
NEC for r=0.6 class 2 = 0.681 +- 0.208 (in-sample avg dev_std = 0.776)
NEC for r=0.6 all KL = 0.743 +- 0.208 (in-sample avg dev_std = 0.776)
NEC for r=0.6 all L1 = 0.602 +- 0.196 (in-sample avg dev_std = 0.776)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33440733333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.524
NEC for r=0.9 class 0 = 0.539 +- 0.246 (in-sample avg dev_std = 0.797)
NEC for r=0.9 class 1 = 0.411 +- 0.246 (in-sample avg dev_std = 0.797)
NEC for r=0.9 class 2 = 0.589 +- 0.246 (in-sample avg dev_std = 0.797)
NEC for r=0.9 all KL = 0.651 +- 0.246 (in-sample avg dev_std = 0.797)
NEC for r=0.9 all L1 = 0.513 +- 0.217 (in-sample avg dev_std = 0.797)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839849999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.304
NEC for r=0.3 class 0 = 0.689 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 1 = 0.635 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 2 = 0.537 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all KL = 0.741 +- 0.221 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all L1 = 0.621 +- 0.206 (in-sample avg dev_std = 0.688)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6988479999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.535
NEC for r=0.6 class 0 = 0.461 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 class 1 = 0.345 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 class 2 = 0.351 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 all KL = 0.492 +- 0.295 (in-sample avg dev_std = 0.732)
NEC for r=0.6 all L1 = 0.386 +- 0.242 (in-sample avg dev_std = 0.732)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.797
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48528600000000005
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
NEC for r=0.9 class 0 = 0.388 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.296 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.293 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.428 +- 0.271 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.326 +- 0.213 (in-sample avg dev_std = 0.720)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:22:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:22:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.787
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.689
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5505496666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.597
SUFF_SIMPLE for r=0.3 class 0 = 0.382 +- 0.404 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.3 class 1 = 0.865 +- 0.404 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.3 class 2 = 0.636 +- 0.404 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.3 all KL = 0.555 +- 0.404 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.3 all L1 = 0.631 +- 0.347 (in-sample avg dev_std = 0.517)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.43598000000000003
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.7
SUFF_SIMPLE for r=0.6 class 0 = 0.428 +- 0.391 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.6 class 1 = 0.891 +- 0.391 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.6 class 2 = 0.897 +- 0.391 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.6 all KL = 0.693 +- 0.391 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.6 all L1 = 0.745 +- 0.334 (in-sample avg dev_std = 0.414)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32922766666666664
len(reference) = 2320
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.825
SUFF_SIMPLE for r=0.9 class 0 = 0.775 +- 0.306 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.9 class 1 = 0.977 +- 0.306 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.9 class 2 = 0.943 +- 0.306 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.9 all KL = 0.88 +- 0.306 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.9 all L1 = 0.893 +- 0.271 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7866436666666665
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.565
SUFF_SIMPLE for r=0.3 class 0 = 0.683 +- 0.386 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 class 1 = 0.738 +- 0.386 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 class 2 = 0.858 +- 0.386 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 all KL = 0.711 +- 0.386 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 all L1 = 0.76 +- 0.330 (in-sample avg dev_std = 0.385)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6890256666666668
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.625
SUFF_SIMPLE for r=0.6 class 0 = 0.695 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.848 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.984 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.822 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.842 +- 0.325 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.47692266666666666
len(reference) = 295
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.932
SUFF_SIMPLE for r=0.9 class 0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5505496666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.234
NEC for r=0.3 class 0 = 0.697 +- 0.142 (in-sample avg dev_std = 0.626)
NEC for r=0.3 class 1 = 0.69 +- 0.142 (in-sample avg dev_std = 0.626)
NEC for r=0.3 class 2 = 0.777 +- 0.142 (in-sample avg dev_std = 0.626)
NEC for r=0.3 all KL = 0.854 +- 0.142 (in-sample avg dev_std = 0.626)
NEC for r=0.3 all L1 = 0.722 +- 0.148 (in-sample avg dev_std = 0.626)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.43598000000000003
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.396
NEC for r=0.6 class 0 = 0.627 +- 0.213 (in-sample avg dev_std = 0.747)
NEC for r=0.6 class 1 = 0.529 +- 0.213 (in-sample avg dev_std = 0.747)
NEC for r=0.6 class 2 = 0.671 +- 0.213 (in-sample avg dev_std = 0.747)
NEC for r=0.6 all KL = 0.748 +- 0.213 (in-sample avg dev_std = 0.747)
NEC for r=0.6 all L1 = 0.609 +- 0.204 (in-sample avg dev_std = 0.747)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32922766666666664
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.512
NEC for r=0.9 class 0 = 0.585 +- 0.242 (in-sample avg dev_std = 0.802)
NEC for r=0.9 class 1 = 0.428 +- 0.242 (in-sample avg dev_std = 0.802)
NEC for r=0.9 class 2 = 0.551 +- 0.242 (in-sample avg dev_std = 0.802)
NEC for r=0.9 all KL = 0.66 +- 0.242 (in-sample avg dev_std = 0.802)
NEC for r=0.9 all L1 = 0.521 +- 0.217 (in-sample avg dev_std = 0.802)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7866436666666665
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.575 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 1 = 0.593 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 class 2 = 0.42 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all KL = 0.647 +- 0.318 (in-sample avg dev_std = 0.688)
NEC for r=0.3 all L1 = 0.529 +- 0.276 (in-sample avg dev_std = 0.688)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6890256666666668
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.474
NEC for r=0.6 class 0 = 0.422 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 class 1 = 0.428 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 class 2 = 0.26 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 all KL = 0.476 +- 0.319 (in-sample avg dev_std = 0.698)
NEC for r=0.6 all L1 = 0.37 +- 0.265 (in-sample avg dev_std = 0.698)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.47692266666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.517
NEC for r=0.9 class 0 = 0.377 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 1 = 0.374 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 2 = 0.203 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all KL = 0.411 +- 0.311 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all L1 = 0.318 +- 0.256 (in-sample avg dev_std = 0.652)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:25:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:25:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.678
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.469


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.535273
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.597
SUFF_SIMPLE for r=0.3 class 0 = 0.349 +- 0.366 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.3 class 1 = 0.758 +- 0.366 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.3 class 2 = 0.709 +- 0.366 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.3 all KL = 0.522 +- 0.366 (in-sample avg dev_std = 0.573)
SUFF_SIMPLE for r=0.3 all L1 = 0.611 +- 0.317 (in-sample avg dev_std = 0.573)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4337976666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.592
SUFF_SIMPLE for r=0.6 class 0 = 0.369 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.6 class 1 = 0.673 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.6 class 2 = 0.87 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.6 all KL = 0.577 +- 0.416 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.6 all L1 = 0.644 +- 0.360 (in-sample avg dev_std = 0.438)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266133333333333
len(reference) = 2252
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.775
SUFF_SIMPLE for r=0.9 class 0 = 0.66 +- 0.353 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.9 class 1 = 0.93 +- 0.353 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.9 class 2 = 0.977 +- 0.353 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.9 all KL = 0.835 +- 0.353 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.9 all L1 = 0.851 +- 0.313 (in-sample avg dev_std = 0.055)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839269999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.563
SUFF_SIMPLE for r=0.3 class 0 = 0.762 +- 0.340 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 1 = 0.789 +- 0.340 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 2 = 0.931 +- 0.340 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all KL = 0.807 +- 0.340 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all L1 = 0.827 +- 0.299 (in-sample avg dev_std = 0.282)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6781923333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.49
SUFF_SIMPLE for r=0.6 class 0 = 0.764 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.799 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.988 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.84 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.851 +- 0.312 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.823
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46883966666666665
len(reference) = 1830
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.692
SUFF_SIMPLE for r=0.9 class 0 = 0.95 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.995 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.884 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.888 +- 0.274 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.535273
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.217
NEC for r=0.3 class 0 = 0.731 +- 0.122 (in-sample avg dev_std = 0.608)
NEC for r=0.3 class 1 = 0.695 +- 0.122 (in-sample avg dev_std = 0.608)
NEC for r=0.3 class 2 = 0.772 +- 0.122 (in-sample avg dev_std = 0.608)
NEC for r=0.3 all KL = 0.858 +- 0.122 (in-sample avg dev_std = 0.608)
NEC for r=0.3 all L1 = 0.733 +- 0.130 (in-sample avg dev_std = 0.608)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4337976666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.408
NEC for r=0.6 class 0 = 0.661 +- 0.210 (in-sample avg dev_std = 0.765)
NEC for r=0.6 class 1 = 0.487 +- 0.210 (in-sample avg dev_std = 0.765)
NEC for r=0.6 class 2 = 0.658 +- 0.210 (in-sample avg dev_std = 0.765)
NEC for r=0.6 all KL = 0.735 +- 0.210 (in-sample avg dev_std = 0.765)
NEC for r=0.6 all L1 = 0.602 +- 0.199 (in-sample avg dev_std = 0.765)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266133333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.503
NEC for r=0.9 class 0 = 0.613 +- 0.253 (in-sample avg dev_std = 0.777)
NEC for r=0.9 class 1 = 0.389 +- 0.253 (in-sample avg dev_std = 0.777)
NEC for r=0.9 class 2 = 0.563 +- 0.253 (in-sample avg dev_std = 0.777)
NEC for r=0.9 all KL = 0.65 +- 0.253 (in-sample avg dev_std = 0.777)
NEC for r=0.9 all L1 = 0.521 +- 0.226 (in-sample avg dev_std = 0.777)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839269999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
NEC for r=0.3 class 0 = 0.481 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 class 1 = 0.567 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 class 2 = 0.331 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 all KL = 0.555 +- 0.361 (in-sample avg dev_std = 0.629)
NEC for r=0.3 all L1 = 0.459 +- 0.310 (in-sample avg dev_std = 0.629)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6781923333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.46
NEC for r=0.6 class 0 = 0.351 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 class 1 = 0.348 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 class 2 = 0.209 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 all KL = 0.38 +- 0.324 (in-sample avg dev_std = 0.604)
NEC for r=0.6 all L1 = 0.303 +- 0.271 (in-sample avg dev_std = 0.604)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46883966666666665
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.477
NEC for r=0.9 class 0 = 0.33 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.323 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.166 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.344 +- 0.315 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.273 +- 0.264 (in-sample avg dev_std = 0.570)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:27:01 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:27:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.423
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.323
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.736
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.620
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.450


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5451613333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.651
SUFF_SIMPLE for r=0.3 class 0 = 0.488 +- 0.374 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 class 1 = 0.888 +- 0.374 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 class 2 = 0.578 +- 0.374 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 all KL = 0.576 +- 0.374 (in-sample avg dev_std = 0.596)
SUFF_SIMPLE for r=0.3 all L1 = 0.653 +- 0.313 (in-sample avg dev_std = 0.596)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4227086666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.749
SUFF_SIMPLE for r=0.6 class 0 = 0.579 +- 0.346 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.6 class 1 = 0.889 +- 0.346 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.6 class 2 = 0.851 +- 0.346 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.6 all KL = 0.733 +- 0.346 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.6 all L1 = 0.777 +- 0.292 (in-sample avg dev_std = 0.464)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.322791
len(reference) = 2475
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.226 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.226 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.9 class 2 = 0.955 +- 0.226 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.9 all KL = 0.937 +- 0.226 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.9 all L1 = 0.936 +- 0.203 (in-sample avg dev_std = 0.057)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.735587
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.772
SUFF_SIMPLE for r=0.3 class 0 = 0.507 +- 0.346 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 class 1 = 0.977 +- 0.346 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 class 2 = 0.789 +- 0.346 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 all KL = 0.721 +- 0.346 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.3 all L1 = 0.756 +- 0.298 (in-sample avg dev_std = 0.454)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6201556666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.798
SUFF_SIMPLE for r=0.6 class 0 = 0.719 +- 0.248 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 class 1 = 0.992 +- 0.248 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 class 2 = 0.971 +- 0.248 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 all KL = 0.908 +- 0.248 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.6 all L1 = 0.893 +- 0.245 (in-sample avg dev_std = 0.011)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.595
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.44953000000000004
len(reference) = 927
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.588
SUFF_SIMPLE for r=0.9 class 0 = 0.992 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.85 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.984 +- 0.083 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5451613333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.241
NEC for r=0.3 class 0 = 0.717 +- 0.170 (in-sample avg dev_std = 0.611)
NEC for r=0.3 class 1 = 0.636 +- 0.170 (in-sample avg dev_std = 0.611)
NEC for r=0.3 class 2 = 0.79 +- 0.170 (in-sample avg dev_std = 0.611)
NEC for r=0.3 all KL = 0.842 +- 0.170 (in-sample avg dev_std = 0.611)
NEC for r=0.3 all L1 = 0.715 +- 0.168 (in-sample avg dev_std = 0.611)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4227086666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.666 +- 0.221 (in-sample avg dev_std = 0.744)
NEC for r=0.6 class 1 = 0.458 +- 0.221 (in-sample avg dev_std = 0.744)
NEC for r=0.6 class 2 = 0.689 +- 0.221 (in-sample avg dev_std = 0.744)
NEC for r=0.6 all KL = 0.738 +- 0.221 (in-sample avg dev_std = 0.744)
NEC for r=0.6 all L1 = 0.604 +- 0.209 (in-sample avg dev_std = 0.744)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.322791
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.508
NEC for r=0.9 class 0 = 0.594 +- 0.253 (in-sample avg dev_std = 0.781)
NEC for r=0.9 class 1 = 0.363 +- 0.253 (in-sample avg dev_std = 0.781)
NEC for r=0.9 class 2 = 0.605 +- 0.253 (in-sample avg dev_std = 0.781)
NEC for r=0.9 all KL = 0.651 +- 0.253 (in-sample avg dev_std = 0.781)
NEC for r=0.9 all L1 = 0.521 +- 0.224 (in-sample avg dev_std = 0.781)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.735587
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.25
NEC for r=0.3 class 0 = 0.504 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.333 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.801 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.617 +- 0.398 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.547 +- 0.345 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6201556666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0 = 0.4 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 class 1 = 0.202 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 class 2 = 0.553 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 all KL = 0.463 +- 0.339 (in-sample avg dev_std = 0.676)
NEC for r=0.6 all L1 = 0.386 +- 0.276 (in-sample avg dev_std = 0.676)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.44953000000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.583
NEC for r=0.9 class 0 = 0.383 +- 0.307 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 1 = 0.17 +- 0.307 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 2 = 0.45 +- 0.307 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all KL = 0.407 +- 0.307 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all L1 = 0.335 +- 0.248 (in-sample avg dev_std = 0.667)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:28:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:28:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.339
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.669
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.598
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.444


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.556131
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.642
SUFF_SIMPLE for r=0.3 class 0 = 0.468 +- 0.381 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.3 class 1 = 0.899 +- 0.381 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.3 class 2 = 0.562 +- 0.381 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.3 all KL = 0.567 +- 0.381 (in-sample avg dev_std = 0.582)
SUFF_SIMPLE for r=0.3 all L1 = 0.645 +- 0.318 (in-sample avg dev_std = 0.582)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4336723333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.746
SUFF_SIMPLE for r=0.6 class 0 = 0.529 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 1 = 0.898 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 class 2 = 0.86 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all KL = 0.725 +- 0.354 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.6 all L1 = 0.767 +- 0.298 (in-sample avg dev_std = 0.452)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.338619
len(reference) = 2590
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.856
SUFF_SIMPLE for r=0.9 class 0 = 0.806 +- 0.257 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.257 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.9 class 2 = 0.963 +- 0.257 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.9 all KL = 0.915 +- 0.257 (in-sample avg dev_std = 0.073)
SUFF_SIMPLE for r=0.9 all L1 = 0.914 +- 0.229 (in-sample avg dev_std = 0.073)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.6694983333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.643
SUFF_SIMPLE for r=0.3 class 0 = 0.636 +- 0.384 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 class 1 = 0.778 +- 0.384 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 class 2 = 0.792 +- 0.384 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 all KL = 0.677 +- 0.384 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.3 all L1 = 0.735 +- 0.320 (in-sample avg dev_std = 0.486)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.5981513333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.718
SUFF_SIMPLE for r=0.6 class 0 = 0.843 +- 0.312 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.6 class 1 = 0.791 +- 0.312 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.6 class 2 = 0.988 +- 0.312 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.6 all KL = 0.872 +- 0.312 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.6 all L1 = 0.874 +- 0.281 (in-sample avg dev_std = 0.021)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.276
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4435263333333333
len(reference) = 1119
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.283
SUFF_SIMPLE for r=0.9 class 0 = 0.969 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.999 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.982 +- 0.093 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.556131
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.22
NEC for r=0.3 class 0 = 0.773 +- 0.141 (in-sample avg dev_std = 0.590)
NEC for r=0.3 class 1 = 0.625 +- 0.141 (in-sample avg dev_std = 0.590)
NEC for r=0.3 class 2 = 0.801 +- 0.141 (in-sample avg dev_std = 0.590)
NEC for r=0.3 all KL = 0.861 +- 0.141 (in-sample avg dev_std = 0.590)
NEC for r=0.3 all L1 = 0.733 +- 0.148 (in-sample avg dev_std = 0.590)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4336723333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.397
NEC for r=0.6 class 0 = 0.688 +- 0.232 (in-sample avg dev_std = 0.731)
NEC for r=0.6 class 1 = 0.432 +- 0.232 (in-sample avg dev_std = 0.731)
NEC for r=0.6 class 2 = 0.708 +- 0.232 (in-sample avg dev_std = 0.731)
NEC for r=0.6 all KL = 0.741 +- 0.232 (in-sample avg dev_std = 0.731)
NEC for r=0.6 all L1 = 0.609 +- 0.217 (in-sample avg dev_std = 0.731)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.338619
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.509
NEC for r=0.9 class 0 = 0.596 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 1 = 0.35 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 2 = 0.62 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all KL = 0.653 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all L1 = 0.522 +- 0.231 (in-sample avg dev_std = 0.774)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.6694983333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.294
NEC for r=0.3 class 0 = 0.424 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 1 = 0.487 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 2 = 0.394 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all KL = 0.52 +- 0.406 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all L1 = 0.435 +- 0.350 (in-sample avg dev_std = 0.538)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.5981513333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.446
NEC for r=0.6 class 0 = 0.362 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 class 1 = 0.324 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 class 2 = 0.295 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 all KL = 0.408 +- 0.373 (in-sample avg dev_std = 0.606)
NEC for r=0.6 all L1 = 0.327 +- 0.311 (in-sample avg dev_std = 0.606)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4435263333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.514
NEC for r=0.9 class 0 = 0.311 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 1 = 0.276 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 class 2 = 0.231 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all KL = 0.349 +- 0.337 (in-sample avg dev_std = 0.604)
NEC for r=0.9 all L1 = 0.273 +- 0.274 (in-sample avg dev_std = 0.604)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:30:22 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:30:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9310 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.573
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731906666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.645
SUFF_SIMPLE for r=0.3 class 0 = 0.422 +- 0.375 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 class 1 = 0.742 +- 0.375 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 class 2 = 0.804 +- 0.375 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 all KL = 0.589 +- 0.375 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 all L1 = 0.661 +- 0.313 (in-sample avg dev_std = 0.555)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441644
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.735
SUFF_SIMPLE for r=0.6 class 0 = 0.495 +- 0.365 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.6 class 1 = 0.873 +- 0.365 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.6 class 2 = 0.916 +- 0.365 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.6 all KL = 0.722 +- 0.365 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.6 all L1 = 0.767 +- 0.306 (in-sample avg dev_std = 0.431)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3306806666666666
len(reference) = 2546
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.875
SUFF_SIMPLE for r=0.9 class 0 = 0.831 +- 0.217 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 class 1 = 0.977 +- 0.217 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 class 2 = 0.981 +- 0.217 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 all KL = 0.933 +- 0.217 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.9 all L1 = 0.929 +- 0.198 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7852763333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.393
SUFF_SIMPLE for r=0.3 class 0 = 0.266 +- 0.367 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 class 1 = 0.281 +- 0.367 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 class 2 = 0.808 +- 0.367 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 all KL = 0.36 +- 0.367 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 all L1 = 0.452 +- 0.319 (in-sample avg dev_std = 0.535)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.699089
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.359
SUFF_SIMPLE for r=0.6 class 0 = 0.216 +- 0.439 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.217 +- 0.439 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.945 +- 0.439 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.399 +- 0.439 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.46 +- 0.387 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4848166666666667
len(reference) = 515
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.92
SUFF_SIMPLE for r=0.9 class 0 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731906666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.232
NEC for r=0.3 class 0 = 0.733 +- 0.140 (in-sample avg dev_std = 0.616)
NEC for r=0.3 class 1 = 0.655 +- 0.140 (in-sample avg dev_std = 0.616)
NEC for r=0.3 class 2 = 0.787 +- 0.140 (in-sample avg dev_std = 0.616)
NEC for r=0.3 all KL = 0.856 +- 0.140 (in-sample avg dev_std = 0.616)
NEC for r=0.3 all L1 = 0.726 +- 0.146 (in-sample avg dev_std = 0.616)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441644
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.393
NEC for r=0.6 class 0 = 0.649 +- 0.213 (in-sample avg dev_std = 0.738)
NEC for r=0.6 class 1 = 0.514 +- 0.213 (in-sample avg dev_std = 0.738)
NEC for r=0.6 class 2 = 0.682 +- 0.213 (in-sample avg dev_std = 0.738)
NEC for r=0.6 all KL = 0.751 +- 0.213 (in-sample avg dev_std = 0.738)
NEC for r=0.6 all L1 = 0.615 +- 0.202 (in-sample avg dev_std = 0.738)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3306806666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.522
NEC for r=0.9 class 0 = 0.574 +- 0.242 (in-sample avg dev_std = 0.792)
NEC for r=0.9 class 1 = 0.411 +- 0.242 (in-sample avg dev_std = 0.792)
NEC for r=0.9 class 2 = 0.564 +- 0.242 (in-sample avg dev_std = 0.792)
NEC for r=0.9 all KL = 0.65 +- 0.242 (in-sample avg dev_std = 0.792)
NEC for r=0.9 all L1 = 0.516 +- 0.214 (in-sample avg dev_std = 0.792)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7852763333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.186
NEC for r=0.3 class 0 = 0.795 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 1 = 0.588 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 class 2 = 0.81 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all KL = 0.829 +- 0.166 (in-sample avg dev_std = 0.482)
NEC for r=0.3 all L1 = 0.731 +- 0.145 (in-sample avg dev_std = 0.482)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.699089
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.517
NEC for r=0.6 class 0 = 0.629 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 1 = 0.336 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 2 = 0.54 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all KL = 0.615 +- 0.247 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all L1 = 0.502 +- 0.213 (in-sample avg dev_std = 0.766)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4848166666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.548 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 class 1 = 0.281 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 class 2 = 0.461 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 all KL = 0.537 +- 0.242 (in-sample avg dev_std = 0.752)
NEC for r=0.9 all L1 = 0.431 +- 0.207 (in-sample avg dev_std = 0.752)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:32:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:32:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.527
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.406
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.786
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.479


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5265093333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.602
SUFF_SIMPLE for r=0.3 class 0 = 0.372 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 class 1 = 0.702 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 class 2 = 0.753 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 all KL = 0.54 +- 0.374 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 all L1 = 0.614 +- 0.314 (in-sample avg dev_std = 0.557)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.40593533333333337
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.625
SUFF_SIMPLE for r=0.6 class 0 = 0.392 +- 0.401 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.6 class 1 = 0.719 +- 0.401 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.6 class 2 = 0.893 +- 0.401 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.6 all KL = 0.622 +- 0.401 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.6 all L1 = 0.675 +- 0.347 (in-sample avg dev_std = 0.413)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329615
len(reference) = 2643
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.864
SUFF_SIMPLE for r=0.9 class 0 = 0.807 +- 0.236 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 class 1 = 0.964 +- 0.236 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 class 2 = 0.974 +- 0.236 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 all KL = 0.918 +- 0.236 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 all L1 = 0.916 +- 0.218 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7857369999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.615
SUFF_SIMPLE for r=0.3 class 0 = 0.534 +- 0.367 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.3 class 1 = 0.853 +- 0.367 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.3 class 2 = 0.824 +- 0.367 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.3 all KL = 0.703 +- 0.367 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.3 all L1 = 0.736 +- 0.312 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6914119999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF_SIMPLE for r=0.6 class 0 = 0.786 +- 0.255 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 class 1 = 0.854 +- 0.255 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 class 2 = 0.983 +- 0.255 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all KL = 0.873 +- 0.255 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all L1 = 0.874 +- 0.222 (in-sample avg dev_std = 0.249)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4790656666666667
len(reference) = 1750
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.927
SUFF_SIMPLE for r=0.9 class 0 = 0.94 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.974 +- 0.098 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5265093333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.229
NEC for r=0.3 class 0 = 0.716 +- 0.136 (in-sample avg dev_std = 0.605)
NEC for r=0.3 class 1 = 0.685 +- 0.136 (in-sample avg dev_std = 0.605)
NEC for r=0.3 class 2 = 0.784 +- 0.136 (in-sample avg dev_std = 0.605)
NEC for r=0.3 all KL = 0.859 +- 0.136 (in-sample avg dev_std = 0.605)
NEC for r=0.3 all L1 = 0.729 +- 0.143 (in-sample avg dev_std = 0.605)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.40593533333333337
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.386
NEC for r=0.6 class 0 = 0.664 +- 0.205 (in-sample avg dev_std = 0.739)
NEC for r=0.6 class 1 = 0.518 +- 0.205 (in-sample avg dev_std = 0.739)
NEC for r=0.6 class 2 = 0.681 +- 0.205 (in-sample avg dev_std = 0.739)
NEC for r=0.6 all KL = 0.758 +- 0.205 (in-sample avg dev_std = 0.739)
NEC for r=0.6 all L1 = 0.621 +- 0.198 (in-sample avg dev_std = 0.739)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329615
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.51
NEC for r=0.9 class 0 = 0.594 +- 0.238 (in-sample avg dev_std = 0.789)
NEC for r=0.9 class 1 = 0.4 +- 0.238 (in-sample avg dev_std = 0.789)
NEC for r=0.9 class 2 = 0.594 +- 0.238 (in-sample avg dev_std = 0.789)
NEC for r=0.9 all KL = 0.664 +- 0.238 (in-sample avg dev_std = 0.789)
NEC for r=0.9 all L1 = 0.529 +- 0.213 (in-sample avg dev_std = 0.789)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7857369999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.268
NEC for r=0.3 class 0 = 0.633 +- 0.365 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 1 = 0.394 +- 0.365 (in-sample avg dev_std = 0.376)
NEC for r=0.3 class 2 = 0.794 +- 0.365 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all KL = 0.659 +- 0.365 (in-sample avg dev_std = 0.376)
NEC for r=0.3 all L1 = 0.608 +- 0.278 (in-sample avg dev_std = 0.376)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6914119999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.543
NEC for r=0.6 class 0 = 0.433 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 class 1 = 0.222 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 class 2 = 0.524 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 all KL = 0.474 +- 0.328 (in-sample avg dev_std = 0.700)
NEC for r=0.6 all L1 = 0.394 +- 0.252 (in-sample avg dev_std = 0.700)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4790656666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.386 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 class 1 = 0.187 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 class 2 = 0.45 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 all KL = 0.42 +- 0.307 (in-sample avg dev_std = 0.692)
NEC for r=0.9 all L1 = 0.341 +- 0.232 (in-sample avg dev_std = 0.692)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:34:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:34:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.552
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.427
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.326
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.661
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.462


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5520200000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.614
SUFF_SIMPLE for r=0.3 class 0 = 0.41 +- 0.375 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.3 class 1 = 0.733 +- 0.375 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.3 class 2 = 0.685 +- 0.375 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.3 all KL = 0.546 +- 0.375 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.3 all L1 = 0.613 +- 0.313 (in-sample avg dev_std = 0.563)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4274783333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.676
SUFF_SIMPLE for r=0.6 class 0 = 0.44 +- 0.376 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 class 1 = 0.656 +- 0.376 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 class 2 = 0.919 +- 0.376 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 all KL = 0.632 +- 0.376 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.6 all L1 = 0.678 +- 0.327 (in-sample avg dev_std = 0.421)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.325743
len(reference) = 2633
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF_SIMPLE for r=0.9 class 0 = 0.854 +- 0.232 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 class 1 = 0.941 +- 0.232 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 class 2 = 0.985 +- 0.232 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 all KL = 0.926 +- 0.232 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.9 all L1 = 0.928 +- 0.214 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7801553333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.442
SUFF_SIMPLE for r=0.3 class 0 = 0.825 +- 0.297 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 class 1 = 0.815 +- 0.297 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 class 2 = 0.889 +- 0.297 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 all KL = 0.831 +- 0.297 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 all L1 = 0.843 +- 0.262 (in-sample avg dev_std = 0.339)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6607156666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.515
SUFF_SIMPLE for r=0.6 class 0 = 0.894 +- 0.231 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 class 1 = 0.837 +- 0.231 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 class 2 = 0.99 +- 0.231 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 all KL = 0.915 +- 0.231 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 all L1 = 0.907 +- 0.221 (in-sample avg dev_std = 0.064)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.217
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46197466666666664
len(reference) = 814
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.131
SUFF_SIMPLE for r=0.9 class 0 = 0.928 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.946 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.94 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.932 +- 0.214 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5520200000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.248
NEC for r=0.3 class 0 = 0.737 +- 0.150 (in-sample avg dev_std = 0.628)
NEC for r=0.3 class 1 = 0.634 +- 0.150 (in-sample avg dev_std = 0.628)
NEC for r=0.3 class 2 = 0.783 +- 0.150 (in-sample avg dev_std = 0.628)
NEC for r=0.3 all KL = 0.851 +- 0.150 (in-sample avg dev_std = 0.628)
NEC for r=0.3 all L1 = 0.719 +- 0.152 (in-sample avg dev_std = 0.628)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4274783333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.426
NEC for r=0.6 class 0 = 0.66 +- 0.220 (in-sample avg dev_std = 0.738)
NEC for r=0.6 class 1 = 0.448 +- 0.220 (in-sample avg dev_std = 0.738)
NEC for r=0.6 class 2 = 0.668 +- 0.220 (in-sample avg dev_std = 0.738)
NEC for r=0.6 all KL = 0.726 +- 0.220 (in-sample avg dev_std = 0.738)
NEC for r=0.6 all L1 = 0.592 +- 0.207 (in-sample avg dev_std = 0.738)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.325743
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.532
NEC for r=0.9 class 0 = 0.581 +- 0.241 (in-sample avg dev_std = 0.786)
NEC for r=0.9 class 1 = 0.384 +- 0.241 (in-sample avg dev_std = 0.786)
NEC for r=0.9 class 2 = 0.577 +- 0.241 (in-sample avg dev_std = 0.786)
NEC for r=0.9 all KL = 0.646 +- 0.241 (in-sample avg dev_std = 0.786)
NEC for r=0.9 all L1 = 0.514 +- 0.212 (in-sample avg dev_std = 0.786)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7801553333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.349
NEC for r=0.3 class 0 = 0.139 +- 0.257 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 1 = 0.114 +- 0.257 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 2 = 0.045 +- 0.257 (in-sample avg dev_std = 0.140)
NEC for r=0.3 all KL = 0.101 +- 0.257 (in-sample avg dev_std = 0.140)
NEC for r=0.3 all L1 = 0.099 +- 0.248 (in-sample avg dev_std = 0.140)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6607156666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.373
NEC for r=0.6 class 0 = 0.123 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 1 = 0.109 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 2 = 0.047 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all KL = 0.096 +- 0.233 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all L1 = 0.093 +- 0.217 (in-sample avg dev_std = 0.256)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.437
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46197466666666664
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.395
NEC for r=0.9 class 0 = 0.106 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 class 1 = 0.109 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 class 2 = 0.036 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all KL = 0.084 +- 0.201 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all L1 = 0.084 +- 0.191 (in-sample avg dev_std = 0.261)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.54, 0.638, 0.881], 'all_L1': [0.617, 0.688, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.657, 0.932], 'all_L1': [0.627, 0.709, 0.92]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.728, 0.92], 'all_L1': [0.642, 0.764, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.693, 0.88], 'all_L1': [0.631, 0.745, 0.893]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.577, 0.835], 'all_L1': [0.611, 0.644, 0.851]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.733, 0.937], 'all_L1': [0.653, 0.777, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.725, 0.915], 'all_L1': [0.645, 0.767, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.722, 0.933], 'all_L1': [0.661, 0.767, 0.929]}), defaultdict(<class 'list'>, {'all_KL': [0.54, 0.622, 0.918], 'all_L1': [0.614, 0.675, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.632, 0.926], 'all_L1': [0.613, 0.678, 0.928]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.858, 0.738, 0.652], 'all_L1': [0.73, 0.601, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.738, 0.651], 'all_L1': [0.739, 0.616, 0.529]}), defaultdict(<class 'list'>, {'all_KL': [0.865, 0.743, 0.651], 'all_L1': [0.735, 0.602, 0.513]}), defaultdict(<class 'list'>, {'all_KL': [0.854, 0.748, 0.66], 'all_L1': [0.722, 0.609, 0.521]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.735, 0.65], 'all_L1': [0.733, 0.602, 0.521]}), defaultdict(<class 'list'>, {'all_KL': [0.842, 0.738, 0.651], 'all_L1': [0.715, 0.604, 0.521]}), defaultdict(<class 'list'>, {'all_KL': [0.861, 0.741, 0.653], 'all_L1': [0.733, 0.609, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.856, 0.751, 0.65], 'all_L1': [0.726, 0.615, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.859, 0.758, 0.664], 'all_L1': [0.729, 0.621, 0.529]}), defaultdict(<class 'list'>, {'all_KL': [0.851, 0.726, 0.646], 'all_L1': [0.719, 0.592, 0.514]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.515, 0.613, 1.0], 'all_L1': [0.542, 0.612, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.863, 0.941], 'all_L1': [0.767, 0.844, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.753, 0.882, 0.839], 'all_L1': [0.798, 0.872, 0.839]}), defaultdict(<class 'list'>, {'all_KL': [0.711, 0.822, 1.0], 'all_L1': [0.76, 0.842, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.807, 0.84, 0.884], 'all_L1': [0.827, 0.851, 0.888]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.908, 0.99], 'all_L1': [0.756, 0.893, 0.984]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.872, 0.99], 'all_L1': [0.735, 0.874, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.399, 1.0], 'all_L1': [0.452, 0.46, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.873, 0.99], 'all_L1': [0.736, 0.874, 0.974]}), defaultdict(<class 'list'>, {'all_KL': [0.831, 0.915, 0.94], 'all_L1': [0.843, 0.907, 0.932]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.623, 0.436, 0.368], 'all_L1': [0.582, 0.402, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.521, 0.474], 'all_L1': [0.632, 0.433, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.492, 0.428], 'all_L1': [0.621, 0.386, 0.326]}), defaultdict(<class 'list'>, {'all_KL': [0.647, 0.476, 0.411], 'all_L1': [0.529, 0.37, 0.318]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.38, 0.344], 'all_L1': [0.459, 0.303, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.617, 0.463, 0.407], 'all_L1': [0.547, 0.386, 0.335]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.408, 0.349], 'all_L1': [0.435, 0.327, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.829, 0.615, 0.537], 'all_L1': [0.731, 0.502, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.659, 0.474, 0.42], 'all_L1': [0.608, 0.394, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.101, 0.096, 0.084], 'all_L1': [0.099, 0.093, 0.084]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.631 +- 0.017, 0.721 +- 0.046, 0.910 +- 0.024
suff_simple class all_KL  =  0.555 +- 0.019, 0.673 +- 0.052, 0.908 +- 0.031
[[0.5877916812896729, 0.659500002861023, 0.8262711763381958], [0.6050000190734863, 0.6703749895095825, 0.8724925518035889], [0.6309166550636292, 0.7588333487510681, 0.860439658164978], [0.596750020980835, 0.699791669845581, 0.8246228694915771], [0.596833348274231, 0.5917916893959045, 0.7748667597770691], [0.6509166955947876, 0.7486666440963745, 0.8743434548377991], [0.6423749923706055, 0.7460833191871643, 0.8555984497070312], [0.6449166536331177, 0.7349166870117188, 0.87529456615448], [0.6015416383743286, 0.624708354473114, 0.8635073900222778], [0.6137499809265137, 0.6760833263397217, 0.8694455027580261]]
[[0.54, 0.638, 0.881], [0.553, 0.657, 0.932], [0.565, 0.728, 0.92], [0.555, 0.693, 0.88], [0.522, 0.577, 0.835], [0.576, 0.733, 0.937], [0.567, 0.725, 0.915], [0.589, 0.722, 0.933], [0.54, 0.622, 0.918], [0.546, 0.632, 0.926]]
suff_simple_acc_int  =  0.617 +- 0.022, 0.691 +- 0.054, 0.850 +- 0.030
nec class all_L1  =  0.728 +- 0.007, 0.607 +- 0.008, 0.520 +- 0.005
nec class all_KL  =  0.856 +- 0.006, 0.742 +- 0.009, 0.653 +- 0.005
[[0.21975000202655792, 0.4117499887943268, 0.5166249871253967], [0.2068749964237213, 0.3766666650772095, 0.49412500858306885], [0.21975000202655792, 0.41879168152809143, 0.5243750214576721], [0.23420833051204681, 0.3955000042915344, 0.5116666555404663], [0.21695832908153534, 0.40837499499320984, 0.503250002861023], [0.24129167199134827, 0.40537500381469727, 0.5080833435058594], [0.2202499955892563, 0.39662501215934753, 0.5087916851043701], [0.23241665959358215, 0.39250001311302185, 0.5221666693687439], [0.2290000021457672, 0.3857499957084656, 0.5098333358764648], [0.24779166281223297, 0.42645832896232605, 0.5317083597183228]]
[[0.858, 0.738, 0.652], [0.86, 0.738, 0.651], [0.865, 0.743, 0.651], [0.854, 0.748, 0.66], [0.858, 0.735, 0.65], [0.842, 0.738, 0.651], [0.861, 0.741, 0.653], [0.856, 0.751, 0.65], [0.859, 0.758, 0.664], [0.851, 0.726, 0.646]]
nec_acc_int  =  0.227 +- 0.012, 0.402 +- 0.014, 0.513 +- 0.010

Eval split val
suff_simple class all_L1  =  0.722 +- 0.119, 0.803 +- 0.139, 0.950 +- 0.054
suff_simple class all_KL  =  0.684 +- 0.135, 0.799 +- 0.156, 0.957 +- 0.053
[[0.3969583213329315, 0.4286666810512543, 0.9295154213905334], [0.5911250114440918, 0.6299999952316284, 0.6212499737739563], [0.6707916855812073, 0.7406250238418579, 0.6910025477409363], [0.5648333430290222, 0.624666690826416, 0.9322034120559692], [0.5633333325386047, 0.4896666705608368, 0.6918032765388489], [0.7720833420753479, 0.7980416417121887, 0.5879180431365967], [0.6434583067893982, 0.718458354473114, 0.2832886576652527], [0.3931249976158142, 0.359333336353302, 0.9203883409500122], [0.6146666407585144, 0.7785000205039978, 0.9274285435676575], [0.4424583315849304, 0.515333354473114, 0.1314496248960495]]
[[0.515, 0.613, 1.0], [0.758, 0.863, 0.941], [0.753, 0.882, 0.839], [0.711, 0.822, 1.0], [0.807, 0.84, 0.884], [0.721, 0.908, 0.99], [0.677, 0.872, 0.99], [0.36, 0.399, 1.0], [0.703, 0.873, 0.99], [0.831, 0.915, 0.94]]
suff_simple_acc_int  =  0.565 +- 0.117, 0.608 +- 0.146, 0.672 +- 0.267
nec class all_L1  =  0.524 +- 0.164, 0.360 +- 0.103, 0.312 +- 0.088
nec class all_KL  =  0.603 +- 0.189, 0.436 +- 0.129, 0.382 +- 0.114
[[0.3413749933242798, 0.5096250176429749, 0.5635416507720947], [0.2356666624546051, 0.4326666593551636, 0.4780416786670685], [0.3044166564941406, 0.5351250171661377, 0.5975416898727417], [0.3087500035762787, 0.47350001335144043, 0.5168750286102295], [0.32637500762939453, 0.46012499928474426, 0.476666659116745], [0.25037500262260437, 0.5130416750907898, 0.5832499861717224], [0.2943750023841858, 0.44595834612846375, 0.5140416622161865], [0.18591666221618652, 0.5170416831970215, 0.5999166369438171], [0.2683333456516266, 0.5431666374206543, 0.5999166369438171], [0.3491666615009308, 0.37291666865348816, 0.3949166536331177]]
[[0.623, 0.436, 0.368], [0.742, 0.521, 0.474], [0.741, 0.492, 0.428], [0.647, 0.476, 0.411], [0.555, 0.38, 0.344], [0.617, 0.463, 0.407], [0.52, 0.408, 0.349], [0.829, 0.615, 0.537], [0.659, 0.474, 0.42], [0.101, 0.096, 0.084]]
nec_acc_int  =  0.286 +- 0.049, 0.480 +- 0.051, 0.532 +- 0.065


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.680 +- 0.009, 0.664 +- 0.024, 0.715 +- 0.012
Faith. Armon (L1)= 		  =  0.676 +- 0.010, 0.659 +- 0.021, 0.662 +- 0.008
Faith. GMean (L1)= 	  =  0.678 +- 0.009, 0.661 +- 0.022, 0.688 +- 0.010
Faith. Aritm (KL)= 		  =  0.706 +- 0.009, 0.707 +- 0.027, 0.780 +- 0.015
Faith. Armon (KL)= 		  =  0.674 +- 0.013, 0.704 +- 0.030, 0.759 +- 0.011
Faith. GMean (KL)= 	  =  0.689 +- 0.011, 0.706 +- 0.029, 0.770 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.623 +- 0.068, 0.581 +- 0.059, 0.631 +- 0.056
Faith. Armon (L1)= 		  =  0.575 +- 0.143, 0.476 +- 0.109, 0.461 +- 0.114
Faith. GMean (L1)= 	  =  0.595 +- 0.113, 0.523 +- 0.087, 0.536 +- 0.096
Faith. Aritm (KL)= 		  =  0.643 +- 0.083, 0.617 +- 0.073, 0.670 +- 0.066
Faith. Armon (KL)= 		  =  0.601 +- 0.159, 0.536 +- 0.132, 0.535 +- 0.138
Faith. GMean (KL)= 	  =  0.619 +- 0.128, 0.572 +- 0.108, 0.595 +- 0.115
Computed for split load_split = id



Completed in  0:22:30.881982  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GL-GSAT temp GOODMotif/basis/covariate NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:37:25 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:37:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.9297 0.9297 0.9297 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.180
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.200
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18008833333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.418
SUFF_SIMPLE for r=0.3 class 0 = 0.304 +- 0.261 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.3 class 1 = 0.44 +- 0.261 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.3 class 2 = 0.51 +- 0.261 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.3 all KL = 0.295 +- 0.261 (in-sample avg dev_std = 0.698)
SUFF_SIMPLE for r=0.3 all L1 = 0.421 +- 0.238 (in-sample avg dev_std = 0.698)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25217433333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.419
SUFF_SIMPLE for r=0.6 class 0 = 0.318 +- 0.311 (in-sample avg dev_std = 0.639)
SUFF_SIMPLE for r=0.6 class 1 = 0.463 +- 0.311 (in-sample avg dev_std = 0.639)
SUFF_SIMPLE for r=0.6 class 2 = 0.514 +- 0.311 (in-sample avg dev_std = 0.639)
SUFF_SIMPLE for r=0.6 all KL = 0.32 +- 0.311 (in-sample avg dev_std = 0.639)
SUFF_SIMPLE for r=0.6 all L1 = 0.434 +- 0.274 (in-sample avg dev_std = 0.639)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2950236666666667
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.583
SUFF_SIMPLE for r=0.9 class 0 = 0.597 +- 0.454 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.9 class 1 = 0.75 +- 0.454 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.9 class 2 = 0.628 +- 0.454 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.9 all KL = 0.621 +- 0.454 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.9 all L1 = 0.659 +- 0.398 (in-sample avg dev_std = 0.086)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20002166666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.352
SUFF_SIMPLE for r=0.3 class 0 = 0.4 +- 0.353 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.3 class 1 = 0.265 +- 0.353 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.3 class 2 = 0.736 +- 0.353 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.3 all KL = 0.425 +- 0.353 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.3 all L1 = 0.468 +- 0.286 (in-sample avg dev_std = 0.487)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32065466666666664
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.346
SUFF_SIMPLE for r=0.6 class 0 = 0.401 +- 0.376 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.6 class 1 = 0.264 +- 0.376 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.6 class 2 = 0.769 +- 0.376 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.6 all KL = 0.442 +- 0.376 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.6 all L1 = 0.479 +- 0.308 (in-sample avg dev_std = 0.428)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3559523333333333
len(reference) = 2659
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.428
SUFF_SIMPLE for r=0.9 class 0 = 0.553 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.518 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.598 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.565 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.557 +- 0.344 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18008833333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.548
NEC for r=0.3 class 0 = 0.542 +- 0.310 (in-sample avg dev_std = 0.709)
NEC for r=0.3 class 1 = 0.351 +- 0.310 (in-sample avg dev_std = 0.709)
NEC for r=0.3 class 2 = 0.507 +- 0.310 (in-sample avg dev_std = 0.709)
NEC for r=0.3 all KL = 0.58 +- 0.310 (in-sample avg dev_std = 0.709)
NEC for r=0.3 all L1 = 0.466 +- 0.266 (in-sample avg dev_std = 0.709)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25217433333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.545
NEC for r=0.6 class 0 = 0.553 +- 0.268 (in-sample avg dev_std = 0.765)
NEC for r=0.6 class 1 = 0.387 +- 0.268 (in-sample avg dev_std = 0.765)
NEC for r=0.6 class 2 = 0.519 +- 0.268 (in-sample avg dev_std = 0.765)
NEC for r=0.6 all KL = 0.614 +- 0.268 (in-sample avg dev_std = 0.765)
NEC for r=0.6 all L1 = 0.486 +- 0.233 (in-sample avg dev_std = 0.765)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2950236666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.544
NEC for r=0.9 class 0 = 0.558 +- 0.251 (in-sample avg dev_std = 0.786)
NEC for r=0.9 class 1 = 0.383 +- 0.251 (in-sample avg dev_std = 0.786)
NEC for r=0.9 class 2 = 0.536 +- 0.251 (in-sample avg dev_std = 0.786)
NEC for r=0.9 all KL = 0.624 +- 0.251 (in-sample avg dev_std = 0.786)
NEC for r=0.9 all L1 = 0.492 +- 0.219 (in-sample avg dev_std = 0.786)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20002166666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.588
NEC for r=0.3 class 0 = 0.411 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 1 = 0.253 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 2 = 0.213 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all KL = 0.306 +- 0.289 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all L1 = 0.293 +- 0.244 (in-sample avg dev_std = 0.513)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32065466666666664
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.573
NEC for r=0.6 class 0 = 0.427 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 class 1 = 0.281 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 class 2 = 0.27 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 all KL = 0.349 +- 0.272 (in-sample avg dev_std = 0.562)
NEC for r=0.6 all L1 = 0.326 +- 0.224 (in-sample avg dev_std = 0.562)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3559523333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.425 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.278 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.271 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.348 +- 0.264 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.325 +- 0.215 (in-sample avg dev_std = 0.568)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:40:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:40:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9273 0.9273 0.9273 0.9273 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.374


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18403766666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.383
SUFF_SIMPLE for r=0.3 class 0 = 0.307 +- 0.230 (in-sample avg dev_std = 0.703)
SUFF_SIMPLE for r=0.3 class 1 = 0.495 +- 0.230 (in-sample avg dev_std = 0.703)
SUFF_SIMPLE for r=0.3 class 2 = 0.345 +- 0.230 (in-sample avg dev_std = 0.703)
SUFF_SIMPLE for r=0.3 all KL = 0.261 +- 0.230 (in-sample avg dev_std = 0.703)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.209 (in-sample avg dev_std = 0.703)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25301033333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.382
SUFF_SIMPLE for r=0.6 class 0 = 0.312 +- 0.290 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.6 class 1 = 0.53 +- 0.290 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.6 class 2 = 0.346 +- 0.290 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.6 all KL = 0.291 +- 0.290 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.6 all L1 = 0.397 +- 0.254 (in-sample avg dev_std = 0.608)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29577666666666663
len(reference) = 2706
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.555
SUFF_SIMPLE for r=0.9 class 0 = 0.533 +- 0.453 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.9 class 1 = 0.789 +- 0.453 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.9 class 2 = 0.583 +- 0.453 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.9 all KL = 0.598 +- 0.453 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.9 all L1 = 0.636 +- 0.397 (in-sample avg dev_std = 0.102)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20107433333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.321
SUFF_SIMPLE for r=0.3 class 0 = 0.397 +- 0.202 (in-sample avg dev_std = 0.741)
SUFF_SIMPLE for r=0.3 class 1 = 0.37 +- 0.202 (in-sample avg dev_std = 0.741)
SUFF_SIMPLE for r=0.3 class 2 = 0.412 +- 0.202 (in-sample avg dev_std = 0.741)
SUFF_SIMPLE for r=0.3 all KL = 0.277 +- 0.202 (in-sample avg dev_std = 0.741)
SUFF_SIMPLE for r=0.3 all L1 = 0.393 +- 0.189 (in-sample avg dev_std = 0.741)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32370699999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.316
SUFF_SIMPLE for r=0.6 class 0 = 0.417 +- 0.273 (in-sample avg dev_std = 0.671)
SUFF_SIMPLE for r=0.6 class 1 = 0.398 +- 0.273 (in-sample avg dev_std = 0.671)
SUFF_SIMPLE for r=0.6 class 2 = 0.433 +- 0.273 (in-sample avg dev_std = 0.671)
SUFF_SIMPLE for r=0.6 all KL = 0.315 +- 0.273 (in-sample avg dev_std = 0.671)
SUFF_SIMPLE for r=0.6 all L1 = 0.416 +- 0.242 (in-sample avg dev_std = 0.671)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.37379733333333337
len(reference) = 2829
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.342
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.577 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.64 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.587 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.606 +- 0.392 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18403766666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.526
NEC for r=0.3 class 0 = 0.594 +- 0.317 (in-sample avg dev_std = 0.679)
NEC for r=0.3 class 1 = 0.315 +- 0.317 (in-sample avg dev_std = 0.679)
NEC for r=0.3 class 2 = 0.56 +- 0.317 (in-sample avg dev_std = 0.679)
NEC for r=0.3 all KL = 0.593 +- 0.317 (in-sample avg dev_std = 0.679)
NEC for r=0.3 all L1 = 0.489 +- 0.273 (in-sample avg dev_std = 0.679)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25301033333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.524
NEC for r=0.6 class 0 = 0.597 +- 0.282 (in-sample avg dev_std = 0.733)
NEC for r=0.6 class 1 = 0.33 +- 0.282 (in-sample avg dev_std = 0.733)
NEC for r=0.6 class 2 = 0.575 +- 0.282 (in-sample avg dev_std = 0.733)
NEC for r=0.6 all KL = 0.615 +- 0.282 (in-sample avg dev_std = 0.733)
NEC for r=0.6 all L1 = 0.5 +- 0.246 (in-sample avg dev_std = 0.733)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29577666666666663
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.517
NEC for r=0.9 class 0 = 0.603 +- 0.262 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 1 = 0.343 +- 0.262 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 2 = 0.592 +- 0.262 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all KL = 0.632 +- 0.262 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all L1 = 0.512 +- 0.229 (in-sample avg dev_std = 0.754)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20107433333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.515
NEC for r=0.3 class 0 = 0.42 +- 0.319 (in-sample avg dev_std = 0.600)
NEC for r=0.3 class 1 = 0.311 +- 0.319 (in-sample avg dev_std = 0.600)
NEC for r=0.3 class 2 = 0.273 +- 0.319 (in-sample avg dev_std = 0.600)
NEC for r=0.3 all KL = 0.394 +- 0.319 (in-sample avg dev_std = 0.600)
NEC for r=0.3 all L1 = 0.335 +- 0.277 (in-sample avg dev_std = 0.600)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32370699999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.49
NEC for r=0.6 class 0 = 0.432 +- 0.292 (in-sample avg dev_std = 0.659)
NEC for r=0.6 class 1 = 0.341 +- 0.292 (in-sample avg dev_std = 0.659)
NEC for r=0.6 class 2 = 0.349 +- 0.292 (in-sample avg dev_std = 0.659)
NEC for r=0.6 all KL = 0.449 +- 0.292 (in-sample avg dev_std = 0.659)
NEC for r=0.6 all L1 = 0.374 +- 0.255 (in-sample avg dev_std = 0.659)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.37379733333333337
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.491
NEC for r=0.9 class 0 = 0.444 +- 0.283 (in-sample avg dev_std = 0.672)
NEC for r=0.9 class 1 = 0.346 +- 0.283 (in-sample avg dev_std = 0.672)
NEC for r=0.9 class 2 = 0.357 +- 0.283 (in-sample avg dev_std = 0.672)
NEC for r=0.9 all KL = 0.461 +- 0.283 (in-sample avg dev_std = 0.672)
NEC for r=0.9 all L1 = 0.382 +- 0.249 (in-sample avg dev_std = 0.672)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:42:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:42:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 108 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.254
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.205
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.372


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18171833333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
SUFF_SIMPLE for r=0.3 class 0 = 0.352 +- 0.206 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.3 class 1 = 0.46 +- 0.206 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.3 class 2 = 0.357 +- 0.206 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.3 all KL = 0.251 +- 0.206 (in-sample avg dev_std = 0.767)
SUFF_SIMPLE for r=0.3 all L1 = 0.39 +- 0.190 (in-sample avg dev_std = 0.767)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25426666666666664
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.405
SUFF_SIMPLE for r=0.6 class 0 = 0.377 +- 0.292 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.6 class 1 = 0.503 +- 0.292 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.6 class 2 = 0.356 +- 0.292 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.6 all KL = 0.294 +- 0.292 (in-sample avg dev_std = 0.657)
SUFF_SIMPLE for r=0.6 all L1 = 0.412 +- 0.255 (in-sample avg dev_std = 0.657)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947263333333333
len(reference) = 2705
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.584
SUFF_SIMPLE for r=0.9 class 0 = 0.609 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 1 = 0.763 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 2 = 0.611 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all KL = 0.623 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all L1 = 0.661 +- 0.399 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2054476666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.387
SUFF_SIMPLE for r=0.3 class 0 = 0.44 +- 0.267 (in-sample avg dev_std = 0.733)
SUFF_SIMPLE for r=0.3 class 1 = 0.382 +- 0.267 (in-sample avg dev_std = 0.733)
SUFF_SIMPLE for r=0.3 class 2 = 0.566 +- 0.267 (in-sample avg dev_std = 0.733)
SUFF_SIMPLE for r=0.3 all KL = 0.346 +- 0.267 (in-sample avg dev_std = 0.733)
SUFF_SIMPLE for r=0.3 all L1 = 0.463 +- 0.236 (in-sample avg dev_std = 0.733)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31712000000000007
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.363
SUFF_SIMPLE for r=0.6 class 0 = 0.444 +- 0.319 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.6 class 1 = 0.364 +- 0.319 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.6 class 2 = 0.584 +- 0.319 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.6 all KL = 0.362 +- 0.319 (in-sample avg dev_std = 0.637)
SUFF_SIMPLE for r=0.6 all L1 = 0.464 +- 0.280 (in-sample avg dev_std = 0.637)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3715286666666667
len(reference) = 2722
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.458
SUFF_SIMPLE for r=0.9 class 0 = 0.613 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.584 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.758 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.622 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.399 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18171833333333332
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.544
NEC for r=0.3 class 0 = 0.5 +- 0.313 (in-sample avg dev_std = 0.721)
NEC for r=0.3 class 1 = 0.374 +- 0.313 (in-sample avg dev_std = 0.721)
NEC for r=0.3 class 2 = 0.544 +- 0.313 (in-sample avg dev_std = 0.721)
NEC for r=0.3 all KL = 0.592 +- 0.313 (in-sample avg dev_std = 0.721)
NEC for r=0.3 all L1 = 0.473 +- 0.268 (in-sample avg dev_std = 0.721)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25426666666666664
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.549
NEC for r=0.6 class 0 = 0.51 +- 0.273 (in-sample avg dev_std = 0.774)
NEC for r=0.6 class 1 = 0.391 +- 0.273 (in-sample avg dev_std = 0.774)
NEC for r=0.6 class 2 = 0.554 +- 0.273 (in-sample avg dev_std = 0.774)
NEC for r=0.6 all KL = 0.616 +- 0.273 (in-sample avg dev_std = 0.774)
NEC for r=0.6 all L1 = 0.485 +- 0.236 (in-sample avg dev_std = 0.774)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947263333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.547
NEC for r=0.9 class 0 = 0.527 +- 0.253 (in-sample avg dev_std = 0.795)
NEC for r=0.9 class 1 = 0.388 +- 0.253 (in-sample avg dev_std = 0.795)
NEC for r=0.9 class 2 = 0.566 +- 0.253 (in-sample avg dev_std = 0.795)
NEC for r=0.9 all KL = 0.63 +- 0.253 (in-sample avg dev_std = 0.795)
NEC for r=0.9 all L1 = 0.494 +- 0.221 (in-sample avg dev_std = 0.795)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2054476666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0 = 0.349 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 class 1 = 0.255 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 class 2 = 0.228 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 all KL = 0.356 +- 0.315 (in-sample avg dev_std = 0.641)
NEC for r=0.3 all L1 = 0.278 +- 0.249 (in-sample avg dev_std = 0.641)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31712000000000007
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.617
NEC for r=0.6 class 0 = 0.355 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 class 1 = 0.271 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 class 2 = 0.259 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 all KL = 0.385 +- 0.289 (in-sample avg dev_std = 0.680)
NEC for r=0.6 all L1 = 0.296 +- 0.227 (in-sample avg dev_std = 0.680)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.797
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3715286666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.611
NEC for r=0.9 class 0 = 0.367 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 1 = 0.285 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 2 = 0.278 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all KL = 0.406 +- 0.271 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all L1 = 0.31 +- 0.213 (in-sample avg dev_std = 0.704)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:44:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:44:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.180
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18042766666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.398
SUFF_SIMPLE for r=0.3 class 0 = 0.3 +- 0.214 (in-sample avg dev_std = 0.759)
SUFF_SIMPLE for r=0.3 class 1 = 0.45 +- 0.214 (in-sample avg dev_std = 0.759)
SUFF_SIMPLE for r=0.3 class 2 = 0.418 +- 0.214 (in-sample avg dev_std = 0.759)
SUFF_SIMPLE for r=0.3 all KL = 0.252 +- 0.214 (in-sample avg dev_std = 0.759)
SUFF_SIMPLE for r=0.3 all L1 = 0.391 +- 0.203 (in-sample avg dev_std = 0.759)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24994966666666665
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.389
SUFF_SIMPLE for r=0.6 class 0 = 0.314 +- 0.293 (in-sample avg dev_std = 0.661)
SUFF_SIMPLE for r=0.6 class 1 = 0.469 +- 0.293 (in-sample avg dev_std = 0.661)
SUFF_SIMPLE for r=0.6 class 2 = 0.439 +- 0.293 (in-sample avg dev_std = 0.661)
SUFF_SIMPLE for r=0.6 all KL = 0.287 +- 0.293 (in-sample avg dev_std = 0.661)
SUFF_SIMPLE for r=0.6 all L1 = 0.41 +- 0.263 (in-sample avg dev_std = 0.661)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29405866666666663
len(reference) = 2711
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.573
SUFF_SIMPLE for r=0.9 class 0 = 0.567 +- 0.457 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 class 1 = 0.784 +- 0.457 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 class 2 = 0.608 +- 0.457 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 all KL = 0.611 +- 0.457 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 all L1 = 0.654 +- 0.403 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20732233333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.501 +- 0.304 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.3 class 1 = 0.385 +- 0.304 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.3 class 2 = 0.63 +- 0.304 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.3 all KL = 0.382 +- 0.304 (in-sample avg dev_std = 0.712)
SUFF_SIMPLE for r=0.3 all L1 = 0.506 +- 0.269 (in-sample avg dev_std = 0.712)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32030699999999995
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.331
SUFF_SIMPLE for r=0.6 class 0 = 0.52 +- 0.359 (in-sample avg dev_std = 0.624)
SUFF_SIMPLE for r=0.6 class 1 = 0.427 +- 0.359 (in-sample avg dev_std = 0.624)
SUFF_SIMPLE for r=0.6 class 2 = 0.642 +- 0.359 (in-sample avg dev_std = 0.624)
SUFF_SIMPLE for r=0.6 all KL = 0.425 +- 0.359 (in-sample avg dev_std = 0.624)
SUFF_SIMPLE for r=0.6 all L1 = 0.53 +- 0.312 (in-sample avg dev_std = 0.624)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35268933333333335
len(reference) = 2654
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
SUFF_SIMPLE for r=0.9 class 0 = 0.669 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.517 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.822 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.634 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.671 +- 0.399 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18042766666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.537
NEC for r=0.3 class 0 = 0.543 +- 0.315 (in-sample avg dev_std = 0.724)
NEC for r=0.3 class 1 = 0.361 +- 0.315 (in-sample avg dev_std = 0.724)
NEC for r=0.3 class 2 = 0.519 +- 0.315 (in-sample avg dev_std = 0.724)
NEC for r=0.3 all KL = 0.594 +- 0.315 (in-sample avg dev_std = 0.724)
NEC for r=0.3 all L1 = 0.474 +- 0.271 (in-sample avg dev_std = 0.724)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24994966666666665
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.537
NEC for r=0.6 class 0 = 0.56 +- 0.270 (in-sample avg dev_std = 0.778)
NEC for r=0.6 class 1 = 0.39 +- 0.270 (in-sample avg dev_std = 0.778)
NEC for r=0.6 class 2 = 0.525 +- 0.270 (in-sample avg dev_std = 0.778)
NEC for r=0.6 all KL = 0.624 +- 0.270 (in-sample avg dev_std = 0.778)
NEC for r=0.6 all L1 = 0.491 +- 0.237 (in-sample avg dev_std = 0.778)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29405866666666663
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.566 +- 0.253 (in-sample avg dev_std = 0.797)
NEC for r=0.9 class 1 = 0.401 +- 0.253 (in-sample avg dev_std = 0.797)
NEC for r=0.9 class 2 = 0.534 +- 0.253 (in-sample avg dev_std = 0.797)
NEC for r=0.9 all KL = 0.637 +- 0.253 (in-sample avg dev_std = 0.797)
NEC for r=0.9 all L1 = 0.5 +- 0.224 (in-sample avg dev_std = 0.797)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20732233333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.537
NEC for r=0.3 class 0 = 0.359 +- 0.342 (in-sample avg dev_std = 0.579)
NEC for r=0.3 class 1 = 0.315 +- 0.342 (in-sample avg dev_std = 0.579)
NEC for r=0.3 class 2 = 0.162 +- 0.342 (in-sample avg dev_std = 0.579)
NEC for r=0.3 all KL = 0.352 +- 0.342 (in-sample avg dev_std = 0.579)
NEC for r=0.3 all L1 = 0.279 +- 0.281 (in-sample avg dev_std = 0.579)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32030699999999995
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.525
NEC for r=0.6 class 0 = 0.369 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 class 1 = 0.346 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 class 2 = 0.186 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 all KL = 0.386 +- 0.322 (in-sample avg dev_std = 0.624)
NEC for r=0.6 all L1 = 0.3 +- 0.265 (in-sample avg dev_std = 0.624)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35268933333333335
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.528
NEC for r=0.9 class 0 = 0.368 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 class 1 = 0.341 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 class 2 = 0.206 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 all KL = 0.396 +- 0.307 (in-sample avg dev_std = 0.640)
NEC for r=0.9 all L1 = 0.305 +- 0.253 (in-sample avg dev_std = 0.640)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:46:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:46:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.177
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.293
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.203
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.311
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.366


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17740333333333336
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.391
SUFF_SIMPLE for r=0.3 class 0 = 0.269 +- 0.227 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.3 class 1 = 0.467 +- 0.227 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.3 class 2 = 0.435 +- 0.227 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.3 all KL = 0.261 +- 0.227 (in-sample avg dev_std = 0.729)
SUFF_SIMPLE for r=0.3 all L1 = 0.393 +- 0.214 (in-sample avg dev_std = 0.729)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.249335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.392
SUFF_SIMPLE for r=0.6 class 0 = 0.28 +- 0.306 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 class 1 = 0.514 +- 0.306 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 class 2 = 0.45 +- 0.306 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 all KL = 0.303 +- 0.306 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 all L1 = 0.417 +- 0.274 (in-sample avg dev_std = 0.633)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2931806666666667
len(reference) = 2697
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.555
SUFF_SIMPLE for r=0.9 class 0 = 0.502 +- 0.454 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.9 class 1 = 0.808 +- 0.454 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.9 class 2 = 0.601 +- 0.454 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.9 all KL = 0.597 +- 0.454 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.9 all L1 = 0.638 +- 0.401 (in-sample avg dev_std = 0.088)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20274833333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.356
SUFF_SIMPLE for r=0.3 class 0 = 0.576 +- 0.339 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.3 class 1 = 0.443 +- 0.339 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.3 class 2 = 0.719 +- 0.339 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.3 all KL = 0.481 +- 0.339 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.3 all L1 = 0.58 +- 0.291 (in-sample avg dev_std = 0.649)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3110043333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.346
SUFF_SIMPLE for r=0.6 class 0 = 0.598 +- 0.378 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.6 class 1 = 0.471 +- 0.378 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.6 class 2 = 0.741 +- 0.378 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.6 all KL = 0.523 +- 0.378 (in-sample avg dev_std = 0.558)
SUFF_SIMPLE for r=0.6 all L1 = 0.604 +- 0.326 (in-sample avg dev_std = 0.558)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36591
len(reference) = 2769
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.445
SUFF_SIMPLE for r=0.9 class 0 = 0.706 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.693 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.882 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.743 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.762 +- 0.364 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17740333333333336
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.528
NEC for r=0.3 class 0 = 0.582 +- 0.316 (in-sample avg dev_std = 0.705)
NEC for r=0.3 class 1 = 0.344 +- 0.316 (in-sample avg dev_std = 0.705)
NEC for r=0.3 class 2 = 0.509 +- 0.316 (in-sample avg dev_std = 0.705)
NEC for r=0.3 all KL = 0.589 +- 0.316 (in-sample avg dev_std = 0.705)
NEC for r=0.3 all L1 = 0.477 +- 0.275 (in-sample avg dev_std = 0.705)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.249335
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.52
NEC for r=0.6 class 0 = 0.597 +- 0.272 (in-sample avg dev_std = 0.760)
NEC for r=0.6 class 1 = 0.377 +- 0.272 (in-sample avg dev_std = 0.760)
NEC for r=0.6 class 2 = 0.53 +- 0.272 (in-sample avg dev_std = 0.760)
NEC for r=0.6 all KL = 0.625 +- 0.272 (in-sample avg dev_std = 0.760)
NEC for r=0.6 all L1 = 0.5 +- 0.240 (in-sample avg dev_std = 0.760)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2931806666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.52
NEC for r=0.9 class 0 = 0.603 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 1 = 0.374 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 2 = 0.539 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all KL = 0.632 +- 0.260 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all L1 = 0.504 +- 0.231 (in-sample avg dev_std = 0.774)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20274833333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.486
NEC for r=0.3 class 0 = 0.312 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 1 = 0.282 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 class 2 = 0.144 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all KL = 0.302 +- 0.340 (in-sample avg dev_std = 0.513)
NEC for r=0.3 all L1 = 0.246 +- 0.284 (in-sample avg dev_std = 0.513)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3110043333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.484
NEC for r=0.6 class 0 = 0.328 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 1 = 0.301 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 class 2 = 0.149 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all KL = 0.323 +- 0.326 (in-sample avg dev_std = 0.548)
NEC for r=0.6 all L1 = 0.259 +- 0.272 (in-sample avg dev_std = 0.548)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36591
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.484
NEC for r=0.9 class 0 = 0.33 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.307 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.152 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.331 +- 0.314 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.263 +- 0.263 (in-sample avg dev_std = 0.561)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:48:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:48:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.325
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.363


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18112699999999998
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.405
SUFF_SIMPLE for r=0.3 class 0 = 0.363 +- 0.230 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 class 1 = 0.527 +- 0.230 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 class 2 = 0.298 +- 0.230 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 all KL = 0.267 +- 0.230 (in-sample avg dev_std = 0.737)
SUFF_SIMPLE for r=0.3 all L1 = 0.395 +- 0.212 (in-sample avg dev_std = 0.737)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2505113333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.405
SUFF_SIMPLE for r=0.6 class 0 = 0.386 +- 0.318 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 class 1 = 0.593 +- 0.318 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 class 2 = 0.304 +- 0.318 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 all KL = 0.317 +- 0.318 (in-sample avg dev_std = 0.623)
SUFF_SIMPLE for r=0.6 all L1 = 0.427 +- 0.281 (in-sample avg dev_std = 0.623)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2953726666666667
len(reference) = 2708
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.573
SUFF_SIMPLE for r=0.9 class 0 = 0.575 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.9 class 1 = 0.789 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.9 class 2 = 0.582 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.9 all KL = 0.61 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.9 all L1 = 0.649 +- 0.400 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20404633333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.407
SUFF_SIMPLE for r=0.3 class 0 = 0.496 +- 0.321 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 class 1 = 0.657 +- 0.321 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 class 2 = 0.271 +- 0.321 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 all KL = 0.387 +- 0.321 (in-sample avg dev_std = 0.662)
SUFF_SIMPLE for r=0.3 all L1 = 0.474 +- 0.272 (in-sample avg dev_std = 0.662)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32450066666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.403
SUFF_SIMPLE for r=0.6 class 0 = 0.54 +- 0.362 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.6 class 1 = 0.683 +- 0.362 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.6 class 2 = 0.297 +- 0.362 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.6 all KL = 0.432 +- 0.362 (in-sample avg dev_std = 0.581)
SUFF_SIMPLE for r=0.6 all L1 = 0.506 +- 0.308 (in-sample avg dev_std = 0.581)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634516666666667
len(reference) = 2682
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
SUFF_SIMPLE for r=0.9 class 0 = 0.633 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.792 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.296 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.54 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.576 +- 0.398 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18112699999999998
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.544
NEC for r=0.3 class 0 = 0.541 +- 0.323 (in-sample avg dev_std = 0.702)
NEC for r=0.3 class 1 = 0.297 +- 0.323 (in-sample avg dev_std = 0.702)
NEC for r=0.3 class 2 = 0.565 +- 0.323 (in-sample avg dev_std = 0.702)
NEC for r=0.3 all KL = 0.578 +- 0.323 (in-sample avg dev_std = 0.702)
NEC for r=0.3 all L1 = 0.468 +- 0.277 (in-sample avg dev_std = 0.702)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2505113333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.538
NEC for r=0.6 class 0 = 0.556 +- 0.272 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 1 = 0.337 +- 0.272 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 2 = 0.581 +- 0.272 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all KL = 0.617 +- 0.272 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all L1 = 0.491 +- 0.237 (in-sample avg dev_std = 0.766)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2953726666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.535
NEC for r=0.9 class 0 = 0.566 +- 0.257 (in-sample avg dev_std = 0.783)
NEC for r=0.9 class 1 = 0.346 +- 0.257 (in-sample avg dev_std = 0.783)
NEC for r=0.9 class 2 = 0.582 +- 0.257 (in-sample avg dev_std = 0.783)
NEC for r=0.9 all KL = 0.627 +- 0.257 (in-sample avg dev_std = 0.783)
NEC for r=0.9 all L1 = 0.498 +- 0.226 (in-sample avg dev_std = 0.783)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20404633333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.614
NEC for r=0.3 class 0 = 0.362 +- 0.320 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 1 = 0.138 +- 0.320 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 2 = 0.363 +- 0.320 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all KL = 0.34 +- 0.320 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all L1 = 0.288 +- 0.263 (in-sample avg dev_std = 0.591)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32450066666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.593
NEC for r=0.6 class 0 = 0.364 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 class 1 = 0.158 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 class 2 = 0.434 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 all KL = 0.385 +- 0.310 (in-sample avg dev_std = 0.643)
NEC for r=0.6 all L1 = 0.319 +- 0.251 (in-sample avg dev_std = 0.643)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634516666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.604
NEC for r=0.9 class 0 = 0.373 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 1 = 0.153 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 class 2 = 0.418 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all KL = 0.382 +- 0.299 (in-sample avg dev_std = 0.652)
NEC for r=0.9 all L1 = 0.315 +- 0.240 (in-sample avg dev_std = 0.652)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:50:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:50:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.369


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18232233333333336
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.396
SUFF_SIMPLE for r=0.3 class 0 = 0.354 +- 0.238 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 class 1 = 0.535 +- 0.238 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 class 2 = 0.28 +- 0.238 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 all KL = 0.26 +- 0.238 (in-sample avg dev_std = 0.720)
SUFF_SIMPLE for r=0.3 all L1 = 0.389 +- 0.218 (in-sample avg dev_std = 0.720)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251288
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.395
SUFF_SIMPLE for r=0.6 class 0 = 0.367 +- 0.317 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.6 class 1 = 0.593 +- 0.317 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.6 class 2 = 0.295 +- 0.317 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.6 all KL = 0.308 +- 0.317 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.6 all L1 = 0.417 +- 0.278 (in-sample avg dev_std = 0.614)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29552666666666666
len(reference) = 2704
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.559
SUFF_SIMPLE for r=0.9 class 0 = 0.541 +- 0.458 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 class 1 = 0.812 +- 0.458 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 class 2 = 0.568 +- 0.458 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 all KL = 0.601 +- 0.458 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.9 all L1 = 0.641 +- 0.401 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19703299999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.381
SUFF_SIMPLE for r=0.3 class 0 = 0.528 +- 0.343 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.3 class 1 = 0.525 +- 0.343 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.3 class 2 = 0.54 +- 0.343 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.3 all KL = 0.421 +- 0.343 (in-sample avg dev_std = 0.700)
SUFF_SIMPLE for r=0.3 all L1 = 0.531 +- 0.290 (in-sample avg dev_std = 0.700)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31629599999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.378
SUFF_SIMPLE for r=0.6 class 0 = 0.558 +- 0.380 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.6 class 1 = 0.58 +- 0.380 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.6 class 2 = 0.553 +- 0.380 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.6 all KL = 0.471 +- 0.380 (in-sample avg dev_std = 0.611)
SUFF_SIMPLE for r=0.6 all L1 = 0.564 +- 0.324 (in-sample avg dev_std = 0.611)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.578
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36851400000000006
len(reference) = 2696
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.372
SUFF_SIMPLE for r=0.9 class 0 = 0.724 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.718 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.762 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.708 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.735 +- 0.381 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18232233333333336
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.539
NEC for r=0.3 class 0 = 0.561 +- 0.326 (in-sample avg dev_std = 0.704)
NEC for r=0.3 class 1 = 0.303 +- 0.326 (in-sample avg dev_std = 0.704)
NEC for r=0.3 class 2 = 0.565 +- 0.326 (in-sample avg dev_std = 0.704)
NEC for r=0.3 all KL = 0.588 +- 0.326 (in-sample avg dev_std = 0.704)
NEC for r=0.3 all L1 = 0.476 +- 0.279 (in-sample avg dev_std = 0.704)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251288
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.536
NEC for r=0.6 class 0 = 0.566 +- 0.281 (in-sample avg dev_std = 0.761)
NEC for r=0.6 class 1 = 0.331 +- 0.281 (in-sample avg dev_std = 0.761)
NEC for r=0.6 class 2 = 0.585 +- 0.281 (in-sample avg dev_std = 0.761)
NEC for r=0.6 all KL = 0.619 +- 0.281 (in-sample avg dev_std = 0.761)
NEC for r=0.6 all L1 = 0.494 +- 0.244 (in-sample avg dev_std = 0.761)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29552666666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.534
NEC for r=0.9 class 0 = 0.579 +- 0.266 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 1 = 0.327 +- 0.266 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 2 = 0.592 +- 0.266 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all KL = 0.627 +- 0.266 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all L1 = 0.499 +- 0.233 (in-sample avg dev_std = 0.774)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19703299999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.528
NEC for r=0.3 class 0 = 0.287 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 1 = 0.248 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 class 2 = 0.19 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all KL = 0.301 +- 0.347 (in-sample avg dev_std = 0.537)
NEC for r=0.3 all L1 = 0.242 +- 0.285 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31629599999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.514
NEC for r=0.6 class 0 = 0.299 +- 0.341 (in-sample avg dev_std = 0.582)
NEC for r=0.6 class 1 = 0.269 +- 0.341 (in-sample avg dev_std = 0.582)
NEC for r=0.6 class 2 = 0.221 +- 0.341 (in-sample avg dev_std = 0.582)
NEC for r=0.6 all KL = 0.334 +- 0.341 (in-sample avg dev_std = 0.582)
NEC for r=0.6 all L1 = 0.263 +- 0.278 (in-sample avg dev_std = 0.582)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36851400000000006
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.519
NEC for r=0.9 class 0 = 0.306 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 class 1 = 0.255 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 class 2 = 0.23 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 all KL = 0.336 +- 0.336 (in-sample avg dev_std = 0.590)
NEC for r=0.9 all L1 = 0.264 +- 0.274 (in-sample avg dev_std = 0.590)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:52:25 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:52:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9310 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.214
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.326
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18160266666666663
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.409
SUFF_SIMPLE for r=0.3 class 0 = 0.319 +- 0.240 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 class 1 = 0.434 +- 0.240 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 class 2 = 0.459 +- 0.240 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 all KL = 0.279 +- 0.240 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.3 all L1 = 0.406 +- 0.217 (in-sample avg dev_std = 0.713)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25265000000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.398
SUFF_SIMPLE for r=0.6 class 0 = 0.337 +- 0.294 (in-sample avg dev_std = 0.638)
SUFF_SIMPLE for r=0.6 class 1 = 0.45 +- 0.294 (in-sample avg dev_std = 0.638)
SUFF_SIMPLE for r=0.6 class 2 = 0.449 +- 0.294 (in-sample avg dev_std = 0.638)
SUFF_SIMPLE for r=0.6 all KL = 0.301 +- 0.294 (in-sample avg dev_std = 0.638)
SUFF_SIMPLE for r=0.6 all L1 = 0.414 +- 0.258 (in-sample avg dev_std = 0.638)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29444966666666667
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.574
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 1 = 0.777 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 class 2 = 0.601 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all KL = 0.623 +- 0.455 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.9 all L1 = 0.66 +- 0.398 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21388133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.293
SUFF_SIMPLE for r=0.3 class 0 = 0.237 +- 0.229 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.3 class 1 = 0.244 +- 0.229 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.3 class 2 = 0.53 +- 0.229 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.3 all KL = 0.232 +- 0.229 (in-sample avg dev_std = 0.591)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.201 (in-sample avg dev_std = 0.591)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32599900000000004
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.3
SUFF_SIMPLE for r=0.6 class 0 = 0.24 +- 0.281 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.6 class 1 = 0.252 +- 0.281 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.6 class 2 = 0.577 +- 0.281 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.6 all KL = 0.263 +- 0.281 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.6 all L1 = 0.357 +- 0.244 (in-sample avg dev_std = 0.523)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3549536666666666
len(reference) = 2665
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.287
SUFF_SIMPLE for r=0.9 class 0 = 0.368 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.441 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.384 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.348 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.398 +- 0.340 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18160266666666663
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.547
NEC for r=0.3 class 0 = 0.526 +- 0.314 (in-sample avg dev_std = 0.708)
NEC for r=0.3 class 1 = 0.36 +- 0.314 (in-sample avg dev_std = 0.708)
NEC for r=0.3 class 2 = 0.517 +- 0.314 (in-sample avg dev_std = 0.708)
NEC for r=0.3 all KL = 0.579 +- 0.314 (in-sample avg dev_std = 0.708)
NEC for r=0.3 all L1 = 0.467 +- 0.267 (in-sample avg dev_std = 0.708)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25265000000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.548
NEC for r=0.6 class 0 = 0.542 +- 0.268 (in-sample avg dev_std = 0.771)
NEC for r=0.6 class 1 = 0.382 +- 0.268 (in-sample avg dev_std = 0.771)
NEC for r=0.6 class 2 = 0.535 +- 0.268 (in-sample avg dev_std = 0.771)
NEC for r=0.6 all KL = 0.612 +- 0.268 (in-sample avg dev_std = 0.771)
NEC for r=0.6 all L1 = 0.486 +- 0.230 (in-sample avg dev_std = 0.771)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29444966666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.542
NEC for r=0.9 class 0 = 0.545 +- 0.249 (in-sample avg dev_std = 0.793)
NEC for r=0.9 class 1 = 0.395 +- 0.249 (in-sample avg dev_std = 0.793)
NEC for r=0.9 class 2 = 0.548 +- 0.249 (in-sample avg dev_std = 0.793)
NEC for r=0.9 all KL = 0.627 +- 0.249 (in-sample avg dev_std = 0.793)
NEC for r=0.9 all L1 = 0.496 +- 0.216 (in-sample avg dev_std = 0.793)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21388133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0 = 0.51 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 class 1 = 0.229 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 class 2 = 0.351 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 all KL = 0.446 +- 0.307 (in-sample avg dev_std = 0.658)
NEC for r=0.3 all L1 = 0.364 +- 0.260 (in-sample avg dev_std = 0.658)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32599900000000004
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.622
NEC for r=0.6 class 0 = 0.527 +- 0.267 (in-sample avg dev_std = 0.718)
NEC for r=0.6 class 1 = 0.251 +- 0.267 (in-sample avg dev_std = 0.718)
NEC for r=0.6 class 2 = 0.423 +- 0.267 (in-sample avg dev_std = 0.718)
NEC for r=0.6 all KL = 0.499 +- 0.267 (in-sample avg dev_std = 0.718)
NEC for r=0.6 all L1 = 0.401 +- 0.227 (in-sample avg dev_std = 0.718)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3549536666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.627
NEC for r=0.9 class 0 = 0.522 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 class 1 = 0.24 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 class 2 = 0.426 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 all KL = 0.497 +- 0.257 (in-sample avg dev_std = 0.724)
NEC for r=0.9 all L1 = 0.397 +- 0.218 (in-sample avg dev_std = 0.724)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:55:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:55:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.209
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.363


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18589433333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.41
SUFF_SIMPLE for r=0.3 class 0 = 0.306 +- 0.228 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 class 1 = 0.458 +- 0.228 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 class 2 = 0.421 +- 0.228 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 all KL = 0.27 +- 0.228 (in-sample avg dev_std = 0.719)
SUFF_SIMPLE for r=0.3 all L1 = 0.397 +- 0.206 (in-sample avg dev_std = 0.719)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2525253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.39
SUFF_SIMPLE for r=0.6 class 0 = 0.328 +- 0.281 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 class 1 = 0.463 +- 0.281 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 class 2 = 0.403 +- 0.281 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 all KL = 0.287 +- 0.281 (in-sample avg dev_std = 0.633)
SUFF_SIMPLE for r=0.6 all L1 = 0.399 +- 0.246 (in-sample avg dev_std = 0.633)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947846666666667
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.574
SUFF_SIMPLE for r=0.9 class 0 = 0.582 +- 0.455 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.9 class 1 = 0.771 +- 0.455 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.9 class 2 = 0.595 +- 0.455 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.9 all KL = 0.61 +- 0.455 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.9 all L1 = 0.65 +- 0.399 (in-sample avg dev_std = 0.087)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20861033333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.38 +- 0.298 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 class 1 = 0.534 +- 0.298 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 class 2 = 0.313 +- 0.298 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 all KL = 0.335 +- 0.298 (in-sample avg dev_std = 0.595)
SUFF_SIMPLE for r=0.3 all L1 = 0.409 +- 0.230 (in-sample avg dev_std = 0.595)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321838
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.341
SUFF_SIMPLE for r=0.6 class 0 = 0.39 +- 0.326 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.6 class 1 = 0.544 +- 0.326 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.6 class 2 = 0.331 +- 0.326 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.6 all KL = 0.359 +- 0.326 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.6 all L1 = 0.421 +- 0.258 (in-sample avg dev_std = 0.522)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.828
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634806666666667
len(reference) = 2745
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.482
SUFF_SIMPLE for r=0.9 class 0 = 0.649 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.674 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.508 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.602 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.608 +- 0.365 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18589433333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.536
NEC for r=0.3 class 0 = 0.558 +- 0.309 (in-sample avg dev_std = 0.711)
NEC for r=0.3 class 1 = 0.366 +- 0.309 (in-sample avg dev_std = 0.711)
NEC for r=0.3 class 2 = 0.531 +- 0.309 (in-sample avg dev_std = 0.711)
NEC for r=0.3 all KL = 0.6 +- 0.309 (in-sample avg dev_std = 0.711)
NEC for r=0.3 all L1 = 0.484 +- 0.266 (in-sample avg dev_std = 0.711)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2525253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.538
NEC for r=0.6 class 0 = 0.56 +- 0.265 (in-sample avg dev_std = 0.765)
NEC for r=0.6 class 1 = 0.382 +- 0.265 (in-sample avg dev_std = 0.765)
NEC for r=0.6 class 2 = 0.551 +- 0.265 (in-sample avg dev_std = 0.765)
NEC for r=0.6 all KL = 0.625 +- 0.265 (in-sample avg dev_std = 0.765)
NEC for r=0.6 all L1 = 0.497 +- 0.232 (in-sample avg dev_std = 0.765)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947846666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.531
NEC for r=0.9 class 0 = 0.572 +- 0.249 (in-sample avg dev_std = 0.784)
NEC for r=0.9 class 1 = 0.388 +- 0.249 (in-sample avg dev_std = 0.784)
NEC for r=0.9 class 2 = 0.564 +- 0.249 (in-sample avg dev_std = 0.784)
NEC for r=0.9 all KL = 0.64 +- 0.249 (in-sample avg dev_std = 0.784)
NEC for r=0.9 all L1 = 0.508 +- 0.219 (in-sample avg dev_std = 0.784)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20861033333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.645
NEC for r=0.3 class 0 = 0.336 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 class 1 = 0.152 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 class 2 = 0.343 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 all KL = 0.337 +- 0.321 (in-sample avg dev_std = 0.606)
NEC for r=0.3 all L1 = 0.277 +- 0.250 (in-sample avg dev_std = 0.606)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321838
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.629
NEC for r=0.6 class 0 = 0.353 +- 0.308 (in-sample avg dev_std = 0.656)
NEC for r=0.6 class 1 = 0.159 +- 0.308 (in-sample avg dev_std = 0.656)
NEC for r=0.6 class 2 = 0.401 +- 0.308 (in-sample avg dev_std = 0.656)
NEC for r=0.6 all KL = 0.375 +- 0.308 (in-sample avg dev_std = 0.656)
NEC for r=0.6 all L1 = 0.305 +- 0.235 (in-sample avg dev_std = 0.656)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634806666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.621
NEC for r=0.9 class 0 = 0.359 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 class 1 = 0.165 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 class 2 = 0.424 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 all KL = 0.393 +- 0.303 (in-sample avg dev_std = 0.675)
NEC for r=0.9 all L1 = 0.317 +- 0.230 (in-sample avg dev_std = 0.675)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:57:46 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:57:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.255
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.297
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1838596666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.412
SUFF_SIMPLE for r=0.3 class 0 = 0.319 +- 0.201 (in-sample avg dev_std = 0.752)
SUFF_SIMPLE for r=0.3 class 1 = 0.456 +- 0.201 (in-sample avg dev_std = 0.752)
SUFF_SIMPLE for r=0.3 class 2 = 0.387 +- 0.201 (in-sample avg dev_std = 0.752)
SUFF_SIMPLE for r=0.3 all KL = 0.255 +- 0.201 (in-sample avg dev_std = 0.752)
SUFF_SIMPLE for r=0.3 all L1 = 0.388 +- 0.184 (in-sample avg dev_std = 0.752)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25467133333333336
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.416
SUFF_SIMPLE for r=0.6 class 0 = 0.335 +- 0.294 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.6 class 1 = 0.526 +- 0.294 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.6 class 2 = 0.389 +- 0.294 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.6 all KL = 0.306 +- 0.294 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.6 all L1 = 0.418 +- 0.256 (in-sample avg dev_std = 0.642)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.297058
len(reference) = 2702
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.59
SUFF_SIMPLE for r=0.9 class 0 = 0.619 +- 0.447 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 class 1 = 0.737 +- 0.447 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 class 2 = 0.636 +- 0.447 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 all KL = 0.628 +- 0.447 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.9 all L1 = 0.664 +- 0.395 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20652433333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.351
SUFF_SIMPLE for r=0.3 class 0 = 0.833 +- 0.285 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.3 class 1 = 0.839 +- 0.285 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.3 class 2 = 0.91 +- 0.285 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.3 all KL = 0.844 +- 0.285 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.3 all L1 = 0.861 +- 0.254 (in-sample avg dev_std = 0.333)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32124199999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.349
SUFF_SIMPLE for r=0.6 class 0 = 0.843 +- 0.287 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.6 class 1 = 0.85 +- 0.287 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.6 class 2 = 0.911 +- 0.287 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.6 all KL = 0.856 +- 0.287 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.6 all L1 = 0.868 +- 0.260 (in-sample avg dev_std = 0.278)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.424
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35940666666666665
len(reference) = 2678
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.366
SUFF_SIMPLE for r=0.9 class 0 = 0.914 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.924 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.963 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.937 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.933 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1838596666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.56
NEC for r=0.3 class 0 = 0.529 +- 0.312 (in-sample avg dev_std = 0.711)
NEC for r=0.3 class 1 = 0.336 +- 0.312 (in-sample avg dev_std = 0.711)
NEC for r=0.3 class 2 = 0.525 +- 0.312 (in-sample avg dev_std = 0.711)
NEC for r=0.3 all KL = 0.575 +- 0.312 (in-sample avg dev_std = 0.711)
NEC for r=0.3 all L1 = 0.463 +- 0.264 (in-sample avg dev_std = 0.711)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25467133333333336
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.566
NEC for r=0.6 class 0 = 0.532 +- 0.268 (in-sample avg dev_std = 0.767)
NEC for r=0.6 class 1 = 0.347 +- 0.268 (in-sample avg dev_std = 0.767)
NEC for r=0.6 class 2 = 0.547 +- 0.268 (in-sample avg dev_std = 0.767)
NEC for r=0.6 all KL = 0.601 +- 0.268 (in-sample avg dev_std = 0.767)
NEC for r=0.6 all L1 = 0.475 +- 0.229 (in-sample avg dev_std = 0.767)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.297058
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.559
NEC for r=0.9 class 0 = 0.543 +- 0.257 (in-sample avg dev_std = 0.780)
NEC for r=0.9 class 1 = 0.353 +- 0.257 (in-sample avg dev_std = 0.780)
NEC for r=0.9 class 2 = 0.56 +- 0.257 (in-sample avg dev_std = 0.780)
NEC for r=0.9 all KL = 0.613 +- 0.257 (in-sample avg dev_std = 0.780)
NEC for r=0.9 all L1 = 0.485 +- 0.220 (in-sample avg dev_std = 0.780)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20652433333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.395
NEC for r=0.3 class 0 = 0.101 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 1 = 0.104 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 2 = 0.033 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.078 +- 0.197 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.079 +- 0.193 (in-sample avg dev_std = 0.231)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32124199999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.393
NEC for r=0.6 class 0 = 0.106 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 1 = 0.111 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 2 = 0.033 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all KL = 0.084 +- 0.202 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all L1 = 0.083 +- 0.193 (in-sample avg dev_std = 0.255)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.437
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35940666666666665
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.395
NEC for r=0.9 class 0 = 0.104 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 1 = 0.114 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 class 2 = 0.035 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all KL = 0.085 +- 0.201 (in-sample avg dev_std = 0.259)
NEC for r=0.9 all L1 = 0.084 +- 0.193 (in-sample avg dev_std = 0.259)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.295, 0.32, 0.621], 'all_L1': [0.421, 0.434, 0.659]}), defaultdict(<class 'list'>, {'all_KL': [0.261, 0.291, 0.598], 'all_L1': [0.383, 0.397, 0.636]}), defaultdict(<class 'list'>, {'all_KL': [0.251, 0.294, 0.623], 'all_L1': [0.39, 0.412, 0.661]}), defaultdict(<class 'list'>, {'all_KL': [0.252, 0.287, 0.611], 'all_L1': [0.391, 0.41, 0.654]}), defaultdict(<class 'list'>, {'all_KL': [0.261, 0.303, 0.597], 'all_L1': [0.393, 0.417, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.267, 0.317, 0.61], 'all_L1': [0.395, 0.427, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.26, 0.308, 0.601], 'all_L1': [0.389, 0.417, 0.641]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.301, 0.623], 'all_L1': [0.406, 0.414, 0.66]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.287, 0.61], 'all_L1': [0.397, 0.399, 0.65]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.306, 0.628], 'all_L1': [0.388, 0.418, 0.664]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.58, 0.614, 0.624], 'all_L1': [0.466, 0.486, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.593, 0.615, 0.632], 'all_L1': [0.489, 0.5, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.592, 0.616, 0.63], 'all_L1': [0.473, 0.485, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.624, 0.637], 'all_L1': [0.474, 0.491, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.625, 0.632], 'all_L1': [0.477, 0.5, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.617, 0.627], 'all_L1': [0.468, 0.491, 0.498]}), defaultdict(<class 'list'>, {'all_KL': [0.588, 0.619, 0.627], 'all_L1': [0.476, 0.494, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.612, 0.627], 'all_L1': [0.467, 0.486, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.6, 0.625, 0.64], 'all_L1': [0.484, 0.497, 0.508]}), defaultdict(<class 'list'>, {'all_KL': [0.575, 0.601, 0.613], 'all_L1': [0.463, 0.475, 0.485]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.425, 0.442, 0.565], 'all_L1': [0.468, 0.479, 0.557]}), defaultdict(<class 'list'>, {'all_KL': [0.277, 0.315, 0.587], 'all_L1': [0.393, 0.416, 0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.346, 0.362, 0.622], 'all_L1': [0.463, 0.464, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.425, 0.634], 'all_L1': [0.506, 0.53, 0.671]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.523, 0.743], 'all_L1': [0.58, 0.604, 0.762]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.432, 0.54], 'all_L1': [0.474, 0.506, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.471, 0.708], 'all_L1': [0.531, 0.564, 0.735]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.263, 0.348], 'all_L1': [0.337, 0.357, 0.398]}), defaultdict(<class 'list'>, {'all_KL': [0.335, 0.359, 0.602], 'all_L1': [0.409, 0.421, 0.608]}), defaultdict(<class 'list'>, {'all_KL': [0.844, 0.856, 0.937], 'all_L1': [0.861, 0.868, 0.933]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.306, 0.349, 0.348], 'all_L1': [0.293, 0.326, 0.325]}), defaultdict(<class 'list'>, {'all_KL': [0.394, 0.449, 0.461], 'all_L1': [0.335, 0.374, 0.382]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.385, 0.406], 'all_L1': [0.278, 0.296, 0.31]}), defaultdict(<class 'list'>, {'all_KL': [0.352, 0.386, 0.396], 'all_L1': [0.279, 0.3, 0.305]}), defaultdict(<class 'list'>, {'all_KL': [0.302, 0.323, 0.331], 'all_L1': [0.246, 0.259, 0.263]}), defaultdict(<class 'list'>, {'all_KL': [0.34, 0.385, 0.382], 'all_L1': [0.288, 0.319, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.301, 0.334, 0.336], 'all_L1': [0.242, 0.263, 0.264]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.499, 0.497], 'all_L1': [0.364, 0.401, 0.397]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.375, 0.393], 'all_L1': [0.277, 0.305, 0.317]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.084, 0.085], 'all_L1': [0.079, 0.083, 0.084]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.395 +- 0.010, 0.414 +- 0.011, 0.651 +- 0.010
suff_simple class all_KL  =  0.265 +- 0.013, 0.301 +- 0.011, 0.612 +- 0.011
[[0.4182083308696747, 0.4194166660308838, 0.5834869146347046], [0.3825833201408386, 0.38245832920074463, 0.5552476048469543], [0.4111666679382324, 0.4047499895095825, 0.58378005027771], [0.398458331823349, 0.3891666531562805, 0.5728052258491516], [0.39149999618530273, 0.39233332872390747, 0.554551362991333], [0.4047499895095825, 0.4046666622161865, 0.5727474093437195], [0.3956666588783264, 0.3946250081062317, 0.5594489574432373], [0.4086250066757202, 0.39750000834465027, 0.5740877389907837], [0.4097916781902313, 0.3895416557788849, 0.5738112926483154], [0.41216665506362915, 0.41624999046325684, 0.5898871421813965]]
[[0.295, 0.32, 0.621], [0.261, 0.291, 0.598], [0.251, 0.294, 0.623], [0.252, 0.287, 0.611], [0.261, 0.303, 0.597], [0.267, 0.317, 0.61], [0.26, 0.308, 0.601], [0.279, 0.301, 0.623], [0.27, 0.287, 0.61], [0.255, 0.306, 0.628]]
suff_simple_acc_int  =  0.403 +- 0.010, 0.399 +- 0.011, 0.572 +- 0.012
nec class all_L1  =  0.474 +- 0.008, 0.490 +- 0.007, 0.499 +- 0.007
nec class all_KL  =  0.587 +- 0.008, 0.617 +- 0.007, 0.629 +- 0.007
[[0.5482916831970215, 0.5450416803359985, 0.5442500114440918], [0.5259583592414856, 0.5237500071525574, 0.5172916650772095], [0.543791651725769, 0.5487499833106995, 0.5472916960716248], [0.5368333458900452, 0.5372083187103271, 0.5330833196640015], [0.5275416374206543, 0.5204583406448364, 0.5199583172798157], [0.543541669845581, 0.5378333330154419, 0.5350833535194397], [0.5387083292007446, 0.5363333225250244, 0.534250020980835], [0.547208309173584, 0.5479583144187927, 0.5421666502952576], [0.5355416536331177, 0.5379583239555359, 0.530958354473114], [0.5598333477973938, 0.5659166574478149, 0.559208333492279]]
[[0.58, 0.614, 0.624], [0.593, 0.615, 0.632], [0.592, 0.616, 0.63], [0.594, 0.624, 0.637], [0.589, 0.625, 0.632], [0.578, 0.617, 0.627], [0.588, 0.619, 0.627], [0.579, 0.612, 0.627], [0.6, 0.625, 0.64], [0.575, 0.601, 0.613]]
nec_acc_int  =  0.541 +- 0.010, 0.540 +- 0.012, 0.536 +- 0.012

Eval split val
suff_simple class all_L1  =  0.502 +- 0.137, 0.521 +- 0.135, 0.650 +- 0.135
suff_simple class all_KL  =  0.413 +- 0.159, 0.445 +- 0.155, 0.629 +- 0.144
[[0.351708322763443, 0.3463749885559082, 0.4276043772697449], [0.3214583396911621, 0.3164583444595337, 0.342170387506485], [0.3865000009536743, 0.36258333921432495, 0.458486407995224], [0.34341666102409363, 0.33120831847190857, 0.36737000942230225], [0.35600000619888306, 0.3461666703224182, 0.4449259638786316], [0.40674999356269836, 0.4033333361148834, 0.3579418361186981], [0.38100001215934753, 0.3778750002384186, 0.3724035620689392], [0.2930000126361847, 0.2996250092983246, 0.2866791784763336], [0.3395416736602783, 0.3412500023841858, 0.4823315143585205], [0.35116666555404663, 0.3492916524410248, 0.36631813645362854]]
[[0.425, 0.442, 0.565], [0.277, 0.315, 0.587], [0.346, 0.362, 0.622], [0.382, 0.425, 0.634], [0.481, 0.523, 0.743], [0.387, 0.432, 0.54], [0.421, 0.471, 0.708], [0.232, 0.263, 0.348], [0.335, 0.359, 0.602], [0.844, 0.856, 0.937]]
suff_simple_acc_int  =  0.353 +- 0.031, 0.347 +- 0.028, 0.391 +- 0.057
nec class all_L1  =  0.268 +- 0.072, 0.293 +- 0.081, 0.296 +- 0.082
nec class all_KL  =  0.321 +- 0.092, 0.357 +- 0.104, 0.363 +- 0.105
[[0.5880833268165588, 0.5733333230018616, 0.5768333077430725], [0.515291690826416, 0.49037501215934753, 0.49129167199134827], [0.62479168176651, 0.6173750162124634, 0.6114166378974915], [0.5373749732971191, 0.5248333215713501, 0.5283750295639038], [0.4856249988079071, 0.48362499475479126, 0.48362499475479126], [0.6140833497047424, 0.5929166674613953, 0.6036666631698608], [0.5278333425521851, 0.5139999985694885, 0.518666684627533], [0.6440416574478149, 0.6215833425521851, 0.6270833611488342], [0.6445833444595337, 0.6287916898727417, 0.6205416917800903], [0.39529165625572205, 0.3934583365917206, 0.3948749899864197]]
[[0.306, 0.349, 0.348], [0.394, 0.449, 0.461], [0.356, 0.385, 0.406], [0.352, 0.386, 0.396], [0.302, 0.323, 0.331], [0.34, 0.385, 0.382], [0.301, 0.334, 0.336], [0.446, 0.499, 0.497], [0.337, 0.375, 0.393], [0.078, 0.084, 0.085]]
nec_acc_int  =  0.558 +- 0.076, 0.544 +- 0.072, 0.546 +- 0.072


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.435 +- 0.005, 0.453 +- 0.005, 0.575 +- 0.003
Faith. Armon (L1)= 		  =  0.431 +- 0.005, 0.449 +- 0.006, 0.565 +- 0.003
Faith. GMean (L1)= 	  =  0.433 +- 0.005, 0.451 +- 0.005, 0.570 +- 0.003
Faith. Aritm (KL)= 		  =  0.426 +- 0.006, 0.459 +- 0.005, 0.621 +- 0.005
Faith. Armon (KL)= 		  =  0.365 +- 0.011, 0.405 +- 0.010, 0.620 +- 0.005
Faith. GMean (KL)= 	  =  0.394 +- 0.009, 0.431 +- 0.007, 0.620 +- 0.005

Eval split val
Faith. Aritm (L1)= 		  =  0.385 +- 0.034, 0.407 +- 0.030, 0.473 +- 0.034
Faith. Armon (L1)= 		  =  0.329 +- 0.062, 0.352 +- 0.068, 0.387 +- 0.081
Faith. GMean (L1)= 	  =  0.352 +- 0.033, 0.375 +- 0.038, 0.424 +- 0.052
Faith. Aritm (KL)= 		  =  0.367 +- 0.035, 0.401 +- 0.028, 0.496 +- 0.035
Faith. Armon (KL)= 		  =  0.327 +- 0.064, 0.360 +- 0.071, 0.433 +- 0.097
Faith. GMean (KL)= 	  =  0.342 +- 0.033, 0.376 +- 0.040, 0.459 +- 0.066
Computed for split load_split = id



Completed in  0:22:50.112013  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GL-GSAT temp GOODMotif/basis/covariate NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:00:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:00:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5775693333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.515
SUFF_SIMPLE for r=0.3 class 0 = 0.252 +- 0.392 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.3 class 1 = 0.569 +- 0.392 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.3 class 2 = 0.705 +- 0.392 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.3 all KL = 0.478 +- 0.392 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.3 all L1 = 0.514 +- 0.320 (in-sample avg dev_std = 0.315)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4840433333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.603
SUFF_SIMPLE for r=0.6 class 0 = 0.265 +- 0.393 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.6 class 1 = 0.762 +- 0.393 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.6 class 2 = 0.734 +- 0.393 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.6 all KL = 0.578 +- 0.393 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.6 all L1 = 0.593 +- 0.328 (in-sample avg dev_std = 0.233)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3427513333333333
len(reference) = 2629
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF_SIMPLE for r=0.9 class 0 = 0.795 +- 0.195 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.919 +- 0.195 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.908 +- 0.195 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.921 +- 0.195 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.876 +- 0.187 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.782935
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.535
SUFF_SIMPLE for r=0.3 class 0 = 0.294 +- 0.249 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.3 class 1 = 0.592 +- 0.249 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.3 class 2 = 0.475 +- 0.249 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.3 all KL = 0.456 +- 0.249 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.3 all L1 = 0.453 +- 0.196 (in-sample avg dev_std = 0.293)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934813333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.632
SUFF_SIMPLE for r=0.6 class 0 = 0.467 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.868 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.694 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.751 +- 0.290 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.675 +- 0.244 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.567
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.477399
len(reference) = 1306
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.598
SUFF_SIMPLE for r=0.9 class 0 = 0.908 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.934 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.919 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.983 +- 0.092 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.916 +- 0.091 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5775693333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
NEC for r=0.3 class 0 = 0.651 +- 0.259 (in-sample avg dev_std = 0.347)
NEC for r=0.3 class 1 = 0.752 +- 0.259 (in-sample avg dev_std = 0.347)
NEC for r=0.3 class 2 = 0.568 +- 0.259 (in-sample avg dev_std = 0.347)
NEC for r=0.3 all KL = 0.715 +- 0.259 (in-sample avg dev_std = 0.347)
NEC for r=0.3 all L1 = 0.656 +- 0.182 (in-sample avg dev_std = 0.347)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4840433333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.313
NEC for r=0.6 class 0 = 0.746 +- 0.186 (in-sample avg dev_std = 0.493)
NEC for r=0.6 class 1 = 0.672 +- 0.186 (in-sample avg dev_std = 0.493)
NEC for r=0.6 class 2 = 0.641 +- 0.186 (in-sample avg dev_std = 0.493)
NEC for r=0.6 all KL = 0.781 +- 0.186 (in-sample avg dev_std = 0.493)
NEC for r=0.6 all L1 = 0.685 +- 0.149 (in-sample avg dev_std = 0.493)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3427513333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.364
NEC for r=0.9 class 0 = 0.742 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 class 1 = 0.597 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 class 2 = 0.628 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 all KL = 0.753 +- 0.202 (in-sample avg dev_std = 0.547)
NEC for r=0.9 all L1 = 0.654 +- 0.162 (in-sample avg dev_std = 0.547)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.782935
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
NEC for r=0.3 class 0 = 0.409 +- 0.264 (in-sample avg dev_std = 0.118)
NEC for r=0.3 class 1 = 0.571 +- 0.264 (in-sample avg dev_std = 0.118)
NEC for r=0.3 class 2 = 0.478 +- 0.264 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all KL = 0.44 +- 0.264 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all L1 = 0.485 +- 0.148 (in-sample avg dev_std = 0.118)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934813333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.292
NEC for r=0.6 class 0 = 0.504 +- 0.252 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1 = 0.572 +- 0.252 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 2 = 0.55 +- 0.252 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.518 +- 0.252 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.542 +- 0.147 (in-sample avg dev_std = 0.319)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.477399
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.308
NEC for r=0.9 class 0 = 0.538 +- 0.248 (in-sample avg dev_std = 0.380)
NEC for r=0.9 class 1 = 0.531 +- 0.248 (in-sample avg dev_std = 0.380)
NEC for r=0.9 class 2 = 0.544 +- 0.248 (in-sample avg dev_std = 0.380)
NEC for r=0.9 all KL = 0.521 +- 0.248 (in-sample avg dev_std = 0.380)
NEC for r=0.9 all L1 = 0.538 +- 0.148 (in-sample avg dev_std = 0.380)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:02:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:02:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5926256666666666
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.535
SUFF_SIMPLE for r=0.3 class 0 = 0.272 +- 0.386 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.3 class 1 = 0.478 +- 0.386 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.3 class 2 = 0.781 +- 0.386 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.3 all KL = 0.519 +- 0.386 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.3 all L1 = 0.517 +- 0.304 (in-sample avg dev_std = 0.261)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.488279
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.585
SUFF_SIMPLE for r=0.6 class 0 = 0.297 +- 0.359 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 class 1 = 0.592 +- 0.359 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 class 2 = 0.765 +- 0.359 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 all KL = 0.575 +- 0.359 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 all L1 = 0.558 +- 0.288 (in-sample avg dev_std = 0.204)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.351097
len(reference) = 2628
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF_SIMPLE for r=0.9 class 0 = 0.792 +- 0.186 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.865 +- 0.186 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.887 +- 0.186 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.912 +- 0.186 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.183 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7830843333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.37
SUFF_SIMPLE for r=0.3 class 0 = 0.192 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.3 class 1 = 0.268 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.3 class 2 = 0.461 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.3 all KL = 0.226 +- 0.298 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.3 all L1 = 0.307 +- 0.213 (in-sample avg dev_std = 0.098)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6946836666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.507
SUFF_SIMPLE for r=0.6 class 0 = 0.335 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.578 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.479 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.442 +- 0.307 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.463 +- 0.245 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  1.0
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48258500000000004
len(reference) = 18
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  1.0
SUFF_SIMPLE for r=0.9 class 1 = 0.971 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.971 +- 0.007 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5926256666666666
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.284
NEC for r=0.3 class 0 = 0.681 +- 0.181 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1 = 0.744 +- 0.181 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 2 = 0.642 +- 0.181 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.736 +- 0.181 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.689 +- 0.129 (in-sample avg dev_std = 0.320)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.488279
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.333
NEC for r=0.6 class 0 = 0.721 +- 0.178 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 1 = 0.668 +- 0.178 (in-sample avg dev_std = 0.451)
NEC for r=0.6 class 2 = 0.624 +- 0.178 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all KL = 0.717 +- 0.178 (in-sample avg dev_std = 0.451)
NEC for r=0.6 all L1 = 0.67 +- 0.121 (in-sample avg dev_std = 0.451)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.351097
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.386
NEC for r=0.9 class 0 = 0.712 +- 0.207 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.604 +- 0.207 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.585 +- 0.207 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.672 +- 0.207 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.632 +- 0.144 (in-sample avg dev_std = 0.496)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7830843333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.308
NEC for r=0.3 class 0 = 0.594 +- 0.213 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1 = 0.531 +- 0.213 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 2 = 0.497 +- 0.213 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.437 +- 0.213 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.541 +- 0.156 (in-sample avg dev_std = 0.153)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6946836666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.312
NEC for r=0.6 class 0 = 0.648 +- 0.222 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 1 = 0.477 +- 0.222 (in-sample avg dev_std = 0.254)
NEC for r=0.6 class 2 = 0.509 +- 0.222 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all KL = 0.482 +- 0.222 (in-sample avg dev_std = 0.254)
NEC for r=0.6 all L1 = 0.545 +- 0.176 (in-sample avg dev_std = 0.254)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48258500000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.374
NEC for r=0.9 class 0 = 0.655 +- 0.227 (in-sample avg dev_std = 0.306)
NEC for r=0.9 class 1 = 0.456 +- 0.227 (in-sample avg dev_std = 0.306)
NEC for r=0.9 class 2 = 0.491 +- 0.227 (in-sample avg dev_std = 0.306)
NEC for r=0.9 all KL = 0.486 +- 0.227 (in-sample avg dev_std = 0.306)
NEC for r=0.9 all L1 = 0.535 +- 0.170 (in-sample avg dev_std = 0.306)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:04:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:04:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5833396666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.515
SUFF_SIMPLE for r=0.3 class 0 = 0.259 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 1 = 0.463 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 2 = 0.753 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all KL = 0.481 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all L1 = 0.498 +- 0.300 (in-sample avg dev_std = 0.282)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48690800000000006
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.583
SUFF_SIMPLE for r=0.6 class 0 = 0.295 +- 0.363 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.6 class 1 = 0.558 +- 0.363 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.6 class 2 = 0.759 +- 0.363 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.6 all KL = 0.54 +- 0.363 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.6 all L1 = 0.544 +- 0.296 (in-sample avg dev_std = 0.214)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3473106666666666
len(reference) = 2455
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.895
SUFF_SIMPLE for r=0.9 class 0 = 0.821 +- 0.164 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.863 +- 0.164 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.874 +- 0.164 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.918 +- 0.164 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.854 +- 0.166 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7835050000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.192 +- 0.295 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 1 = 0.203 +- 0.295 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 2 = 0.503 +- 0.295 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all KL = 0.283 +- 0.295 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all L1 = 0.299 +- 0.206 (in-sample avg dev_std = 0.058)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.697728
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.504
SUFF_SIMPLE for r=0.6 class 0 = 0.272 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.442 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.514 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.45 +- 0.272 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.409 +- 0.201 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5833396666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.671 +- 0.172 (in-sample avg dev_std = 0.341)
NEC for r=0.3 class 1 = 0.74 +- 0.172 (in-sample avg dev_std = 0.341)
NEC for r=0.3 class 2 = 0.651 +- 0.172 (in-sample avg dev_std = 0.341)
NEC for r=0.3 all KL = 0.741 +- 0.172 (in-sample avg dev_std = 0.341)
NEC for r=0.3 all L1 = 0.687 +- 0.127 (in-sample avg dev_std = 0.341)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.48690800000000006
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.328
NEC for r=0.6 class 0 = 0.731 +- 0.183 (in-sample avg dev_std = 0.457)
NEC for r=0.6 class 1 = 0.656 +- 0.183 (in-sample avg dev_std = 0.457)
NEC for r=0.6 class 2 = 0.644 +- 0.183 (in-sample avg dev_std = 0.457)
NEC for r=0.6 all KL = 0.738 +- 0.183 (in-sample avg dev_std = 0.457)
NEC for r=0.6 all L1 = 0.676 +- 0.130 (in-sample avg dev_std = 0.457)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3473106666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.383
NEC for r=0.9 class 0 = 0.722 +- 0.211 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 1 = 0.602 +- 0.211 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 2 = 0.593 +- 0.211 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all KL = 0.694 +- 0.211 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all L1 = 0.637 +- 0.151 (in-sample avg dev_std = 0.507)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7835050000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.255
NEC for r=0.3 class 0 = 0.32 +- 0.257 (in-sample avg dev_std = 0.138)
NEC for r=0.3 class 1 = 0.506 +- 0.257 (in-sample avg dev_std = 0.138)
NEC for r=0.3 class 2 = 0.511 +- 0.257 (in-sample avg dev_std = 0.138)
NEC for r=0.3 all KL = 0.35 +- 0.257 (in-sample avg dev_std = 0.138)
NEC for r=0.3 all L1 = 0.445 +- 0.208 (in-sample avg dev_std = 0.138)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.697728
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.311
NEC for r=0.6 class 0 = 0.484 +- 0.213 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.522 +- 0.213 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.505 +- 0.213 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.42 +- 0.213 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.503 +- 0.148 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4849546666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.373
NEC for r=0.9 class 0 = 0.527 +- 0.212 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 1 = 0.526 +- 0.212 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 2 = 0.465 +- 0.212 (in-sample avg dev_std = 0.332)
NEC for r=0.9 all KL = 0.431 +- 0.212 (in-sample avg dev_std = 0.332)
NEC for r=0.9 all L1 = 0.506 +- 0.136 (in-sample avg dev_std = 0.332)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:05:54 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:05:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5827426666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.53
SUFF_SIMPLE for r=0.3 class 0 = 0.257 +- 0.383 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 class 1 = 0.514 +- 0.383 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 class 2 = 0.704 +- 0.383 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 all KL = 0.49 +- 0.383 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.3 all L1 = 0.497 +- 0.294 (in-sample avg dev_std = 0.275)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.47364300000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.564
SUFF_SIMPLE for r=0.6 class 0 = 0.243 +- 0.378 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.6 class 1 = 0.656 +- 0.378 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.6 class 2 = 0.674 +- 0.378 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.378 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.6 all L1 = 0.53 +- 0.298 (in-sample avg dev_std = 0.194)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3409766666666667
len(reference) = 2658
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.888
SUFF_SIMPLE for r=0.9 class 0 = 0.773 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.915 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.868 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.913 +- 0.177 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.854 +- 0.182 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821599999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.219 +- 0.300 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.3 class 1 = 0.246 +- 0.300 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.3 class 2 = 0.587 +- 0.300 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.3 all KL = 0.386 +- 0.300 (in-sample avg dev_std = 0.067)
SUFF_SIMPLE for r=0.3 all L1 = 0.351 +- 0.204 (in-sample avg dev_std = 0.067)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6963326666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.508
SUFF_SIMPLE for r=0.6 class 0 = 0.284 +- 0.292 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.499 +- 0.292 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.597 +- 0.292 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.552 +- 0.292 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.46 +- 0.192 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4825026666666667
len(reference) = 72
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.917
SUFF_SIMPLE for r=0.9 class 0 = 0.96 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.954 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.96 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.998 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.96 +- 0.002 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5827426666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.28
NEC for r=0.3 class 0 = 0.676 +- 0.193 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 1 = 0.777 +- 0.193 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 2 = 0.646 +- 0.193 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all KL = 0.747 +- 0.193 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all L1 = 0.7 +- 0.126 (in-sample avg dev_std = 0.354)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.47364300000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.327
NEC for r=0.6 class 0 = 0.724 +- 0.194 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.701 +- 0.194 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.62 +- 0.194 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.745 +- 0.194 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.68 +- 0.129 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3409766666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.388
NEC for r=0.9 class 0 = 0.714 +- 0.211 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 1 = 0.615 +- 0.211 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 2 = 0.585 +- 0.211 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all KL = 0.696 +- 0.211 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all L1 = 0.636 +- 0.149 (in-sample avg dev_std = 0.528)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821599999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.203
NEC for r=0.3 class 0 = 0.545 +- 0.198 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 1 = 0.66 +- 0.198 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 2 = 0.528 +- 0.198 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all KL = 0.437 +- 0.198 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all L1 = 0.577 +- 0.097 (in-sample avg dev_std = 0.147)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6963326666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.277
NEC for r=0.6 class 0 = 0.624 +- 0.189 (in-sample avg dev_std = 0.231)
NEC for r=0.6 class 1 = 0.607 +- 0.189 (in-sample avg dev_std = 0.231)
NEC for r=0.6 class 2 = 0.529 +- 0.189 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all KL = 0.461 +- 0.189 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all L1 = 0.587 +- 0.100 (in-sample avg dev_std = 0.231)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4825026666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.342
NEC for r=0.9 class 0 = 0.644 +- 0.204 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 1 = 0.584 +- 0.204 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 2 = 0.489 +- 0.204 (in-sample avg dev_std = 0.262)
NEC for r=0.9 all KL = 0.451 +- 0.204 (in-sample avg dev_std = 0.262)
NEC for r=0.9 all L1 = 0.573 +- 0.110 (in-sample avg dev_std = 0.262)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:07:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:07:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.534
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.449
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.534472
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.247 +- 0.392 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.3 class 1 = 0.484 +- 0.392 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.3 class 2 = 0.763 +- 0.392 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.3 all KL = 0.492 +- 0.392 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.3 all L1 = 0.505 +- 0.310 (in-sample avg dev_std = 0.277)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44942833333333326
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.537
SUFF_SIMPLE for r=0.6 class 0 = 0.264 +- 0.375 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 class 1 = 0.601 +- 0.375 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 class 2 = 0.698 +- 0.375 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 all KL = 0.526 +- 0.375 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.6 all L1 = 0.527 +- 0.300 (in-sample avg dev_std = 0.215)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329835
len(reference) = 2616
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF_SIMPLE for r=0.9 class 0 = 0.624 +- 0.191 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.828 +- 0.191 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.892 +- 0.191 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.86 +- 0.191 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.786 +- 0.197 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7837400000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.389
SUFF_SIMPLE for r=0.3 class 0 = 0.197 +- 0.285 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.3 class 1 = 0.253 +- 0.285 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.3 class 2 = 0.412 +- 0.285 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.3 all KL = 0.195 +- 0.285 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.3 all L1 = 0.287 +- 0.202 (in-sample avg dev_std = 0.096)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7064046666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.556
SUFF_SIMPLE for r=0.6 class 0 = 0.347 +- 0.318 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.64 +- 0.318 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.446 +- 0.318 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.441 +- 0.318 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.477 +- 0.266 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.893
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.49540433333333334
len(reference) = 84
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.893
SUFF_SIMPLE for r=0.9 class 0 = 0.989 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.984 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.979 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.002 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.983 +- 0.009 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.534472
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.27
NEC for r=0.3 class 0 = 0.743 +- 0.218 (in-sample avg dev_std = 0.340)
NEC for r=0.3 class 1 = 0.731 +- 0.218 (in-sample avg dev_std = 0.340)
NEC for r=0.3 class 2 = 0.6 +- 0.218 (in-sample avg dev_std = 0.340)
NEC for r=0.3 all KL = 0.743 +- 0.218 (in-sample avg dev_std = 0.340)
NEC for r=0.3 all L1 = 0.69 +- 0.156 (in-sample avg dev_std = 0.340)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44942833333333326
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.338
NEC for r=0.6 class 0 = 0.733 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 1 = 0.666 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 2 = 0.6 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all KL = 0.722 +- 0.225 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all L1 = 0.664 +- 0.159 (in-sample avg dev_std = 0.462)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.329835
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.392
NEC for r=0.9 class 0 = 0.712 +- 0.229 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 1 = 0.622 +- 0.229 (in-sample avg dev_std = 0.520)
NEC for r=0.9 class 2 = 0.568 +- 0.229 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all KL = 0.688 +- 0.229 (in-sample avg dev_std = 0.520)
NEC for r=0.9 all L1 = 0.632 +- 0.163 (in-sample avg dev_std = 0.520)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7837400000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.293
NEC for r=0.3 class 0 = 0.414 +- 0.270 (in-sample avg dev_std = 0.081)
NEC for r=0.3 class 1 = 0.335 +- 0.270 (in-sample avg dev_std = 0.081)
NEC for r=0.3 class 2 = 0.378 +- 0.270 (in-sample avg dev_std = 0.081)
NEC for r=0.3 all KL = 0.313 +- 0.270 (in-sample avg dev_std = 0.081)
NEC for r=0.3 all L1 = 0.376 +- 0.246 (in-sample avg dev_std = 0.081)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7064046666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.296
NEC for r=0.6 class 0 = 0.458 +- 0.249 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 1 = 0.417 +- 0.249 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 2 = 0.441 +- 0.249 (in-sample avg dev_std = 0.235)
NEC for r=0.6 all KL = 0.423 +- 0.249 (in-sample avg dev_std = 0.235)
NEC for r=0.6 all L1 = 0.439 +- 0.218 (in-sample avg dev_std = 0.235)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.557
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.49540433333333334
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.34
NEC for r=0.9 class 0 = 0.485 +- 0.251 (in-sample avg dev_std = 0.300)
NEC for r=0.9 class 1 = 0.417 +- 0.251 (in-sample avg dev_std = 0.300)
NEC for r=0.9 class 2 = 0.439 +- 0.251 (in-sample avg dev_std = 0.300)
NEC for r=0.9 all KL = 0.445 +- 0.251 (in-sample avg dev_std = 0.300)
NEC for r=0.9 all L1 = 0.447 +- 0.209 (in-sample avg dev_std = 0.300)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:09:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:09:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.569
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.345
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.479


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5692656666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF_SIMPLE for r=0.3 class 0 = 0.253 +- 0.376 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.3 class 1 = 0.427 +- 0.376 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.3 class 2 = 0.753 +- 0.376 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.3 all KL = 0.466 +- 0.376 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.3 all L1 = 0.484 +- 0.297 (in-sample avg dev_std = 0.279)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474551
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.541
SUFF_SIMPLE for r=0.6 class 0 = 0.29 +- 0.383 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 class 1 = 0.513 +- 0.383 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 class 2 = 0.785 +- 0.383 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.383 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 all L1 = 0.536 +- 0.308 (in-sample avg dev_std = 0.201)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34455300000000005
len(reference) = 2586
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.862
SUFF_SIMPLE for r=0.9 class 0 = 0.774 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.856 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.894 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.894 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.843 +- 0.204 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821423333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.171 +- 0.261 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.3 class 1 = 0.172 +- 0.261 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.3 class 2 = 0.375 +- 0.261 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.3 all KL = 0.182 +- 0.261 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.3 all L1 = 0.24 +- 0.170 (in-sample avg dev_std = 0.032)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.693346
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.494
SUFF_SIMPLE for r=0.6 class 0 = 0.281 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.41 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.403 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.341 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.365 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5692656666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.294
NEC for r=0.3 class 0 = 0.721 +- 0.235 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 1 = 0.76 +- 0.235 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 2 = 0.572 +- 0.235 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all KL = 0.745 +- 0.235 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all L1 = 0.682 +- 0.174 (in-sample avg dev_std = 0.332)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474551
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.336
NEC for r=0.6 class 0 = 0.74 +- 0.228 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 1 = 0.686 +- 0.228 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 2 = 0.579 +- 0.228 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all KL = 0.731 +- 0.228 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all L1 = 0.666 +- 0.170 (in-sample avg dev_std = 0.446)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.34455300000000005
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.401
NEC for r=0.9 class 0 = 0.724 +- 0.256 (in-sample avg dev_std = 0.491)
NEC for r=0.9 class 1 = 0.619 +- 0.256 (in-sample avg dev_std = 0.491)
NEC for r=0.9 class 2 = 0.524 +- 0.256 (in-sample avg dev_std = 0.491)
NEC for r=0.9 all KL = 0.677 +- 0.256 (in-sample avg dev_std = 0.491)
NEC for r=0.9 all L1 = 0.62 +- 0.191 (in-sample avg dev_std = 0.491)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7821423333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.287
NEC for r=0.3 class 0 = 0.407 +- 0.253 (in-sample avg dev_std = 0.116)
NEC for r=0.3 class 1 = 0.493 +- 0.253 (in-sample avg dev_std = 0.116)
NEC for r=0.3 class 2 = 0.298 +- 0.253 (in-sample avg dev_std = 0.116)
NEC for r=0.3 all KL = 0.333 +- 0.253 (in-sample avg dev_std = 0.116)
NEC for r=0.3 all L1 = 0.399 +- 0.209 (in-sample avg dev_std = 0.116)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.693346
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.272
NEC for r=0.6 class 0 = 0.488 +- 0.233 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 1 = 0.575 +- 0.233 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 2 = 0.39 +- 0.233 (in-sample avg dev_std = 0.260)
NEC for r=0.6 all KL = 0.452 +- 0.233 (in-sample avg dev_std = 0.260)
NEC for r=0.6 all L1 = 0.484 +- 0.173 (in-sample avg dev_std = 0.260)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.559
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4792123333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.314
NEC for r=0.9 class 0 = 0.524 +- 0.244 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 1 = 0.576 +- 0.244 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 2 = 0.389 +- 0.244 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all KL = 0.477 +- 0.244 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all L1 = 0.496 +- 0.172 (in-sample avg dev_std = 0.297)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:11:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:11:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.460
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.342
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.694
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.484


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5559223333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.531
SUFF_SIMPLE for r=0.3 class 0 = 0.273 +- 0.373 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.3 class 1 = 0.462 +- 0.373 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.3 class 2 = 0.752 +- 0.373 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.3 all KL = 0.491 +- 0.373 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.3 all L1 = 0.502 +- 0.294 (in-sample avg dev_std = 0.287)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45964499999999997
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.576
SUFF_SIMPLE for r=0.6 class 0 = 0.324 +- 0.369 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 class 1 = 0.518 +- 0.369 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 class 2 = 0.783 +- 0.369 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 all KL = 0.555 +- 0.369 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.6 all L1 = 0.548 +- 0.294 (in-sample avg dev_std = 0.204)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3418486666666667
len(reference) = 2459
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF_SIMPLE for r=0.9 class 0 = 0.749 +- 0.202 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.852 +- 0.202 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.911 +- 0.202 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.893 +- 0.202 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.84 +- 0.192 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7827820000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.184 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.3 class 1 = 0.188 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.3 class 2 = 0.395 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.3 all KL = 0.209 +- 0.268 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.3 all L1 = 0.256 +- 0.163 (in-sample avg dev_std = 0.079)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.694314
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.522
SUFF_SIMPLE for r=0.6 class 0 = 0.308 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.457 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.412 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.384 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.392 +- 0.207 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5559223333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.284
NEC for r=0.3 class 0 = 0.69 +- 0.179 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1 = 0.75 +- 0.179 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 2 = 0.666 +- 0.179 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.754 +- 0.179 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.702 +- 0.122 (in-sample avg dev_std = 0.320)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.45964499999999997
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.348
NEC for r=0.6 class 0 = 0.708 +- 0.182 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 1 = 0.675 +- 0.182 (in-sample avg dev_std = 0.462)
NEC for r=0.6 class 2 = 0.635 +- 0.182 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all KL = 0.728 +- 0.182 (in-sample avg dev_std = 0.462)
NEC for r=0.6 all L1 = 0.672 +- 0.128 (in-sample avg dev_std = 0.462)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3418486666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.392
NEC for r=0.9 class 0 = 0.702 +- 0.202 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.625 +- 0.202 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.594 +- 0.202 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.692 +- 0.202 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.639 +- 0.144 (in-sample avg dev_std = 0.510)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7827820000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.313
NEC for r=0.3 class 0 = 0.595 +- 0.207 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 1 = 0.47 +- 0.207 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 2 = 0.49 +- 0.207 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.394 +- 0.207 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.519 +- 0.162 (in-sample avg dev_std = 0.146)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.694314
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.341
NEC for r=0.6 class 0 = 0.608 +- 0.202 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 1 = 0.505 +- 0.202 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 2 = 0.481 +- 0.202 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all KL = 0.448 +- 0.202 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all L1 = 0.531 +- 0.150 (in-sample avg dev_std = 0.251)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.681
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48428000000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.385
NEC for r=0.9 class 0 = 0.615 +- 0.225 (in-sample avg dev_std = 0.301)
NEC for r=0.9 class 1 = 0.511 +- 0.225 (in-sample avg dev_std = 0.301)
NEC for r=0.9 class 2 = 0.452 +- 0.225 (in-sample avg dev_std = 0.301)
NEC for r=0.9 all KL = 0.465 +- 0.225 (in-sample avg dev_std = 0.301)
NEC for r=0.9 all L1 = 0.526 +- 0.148 (in-sample avg dev_std = 0.301)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:13:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:13:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.553
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.441
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.480


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.552888
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.538
SUFF_SIMPLE for r=0.3 class 0 = 0.272 +- 0.375 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.3 class 1 = 0.505 +- 0.375 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.3 class 2 = 0.729 +- 0.375 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.3 all KL = 0.512 +- 0.375 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.3 all L1 = 0.508 +- 0.292 (in-sample avg dev_std = 0.268)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441369
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.582
SUFF_SIMPLE for r=0.6 class 0 = 0.33 +- 0.353 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.6 class 1 = 0.591 +- 0.353 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.6 class 2 = 0.719 +- 0.353 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.6 all KL = 0.576 +- 0.353 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.6 all L1 = 0.552 +- 0.283 (in-sample avg dev_std = 0.208)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3365823333333333
len(reference) = 2731
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.884
SUFF_SIMPLE for r=0.9 class 0 = 0.723 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.87 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.887 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.896 +- 0.187 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.829 +- 0.187 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7829750000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.396
SUFF_SIMPLE for r=0.3 class 0 = 0.21 +- 0.222 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.3 class 1 = 0.254 +- 0.222 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.3 class 2 = 0.294 +- 0.222 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.3 all KL = 0.133 +- 0.222 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.3 all L1 = 0.253 +- 0.142 (in-sample avg dev_std = 0.116)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.69091
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.452
SUFF_SIMPLE for r=0.6 class 0 = 0.36 +- 0.321 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.598 +- 0.321 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.378 +- 0.321 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.382 +- 0.321 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.445 +- 0.267 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.882
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4804170000000001
len(reference) = 76
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF_SIMPLE for r=0.9 class 0 = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.992 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.995 +- 0.005 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.552888
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.275
NEC for r=0.3 class 0 = 0.687 +- 0.168 (in-sample avg dev_std = 0.317)
NEC for r=0.3 class 1 = 0.756 +- 0.168 (in-sample avg dev_std = 0.317)
NEC for r=0.3 class 2 = 0.671 +- 0.168 (in-sample avg dev_std = 0.317)
NEC for r=0.3 all KL = 0.746 +- 0.168 (in-sample avg dev_std = 0.317)
NEC for r=0.3 all L1 = 0.705 +- 0.112 (in-sample avg dev_std = 0.317)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441369
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.326
NEC for r=0.6 class 0 = 0.726 +- 0.181 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.664 +- 0.181 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.632 +- 0.181 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.717 +- 0.181 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.672 +- 0.126 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3365823333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.381
NEC for r=0.9 class 0 = 0.715 +- 0.203 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.604 +- 0.203 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.591 +- 0.203 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.671 +- 0.203 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.635 +- 0.146 (in-sample avg dev_std = 0.496)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7829750000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.302
NEC for r=0.3 class 0 = 0.366 +- 0.254 (in-sample avg dev_std = 0.087)
NEC for r=0.3 class 1 = 0.262 +- 0.254 (in-sample avg dev_std = 0.087)
NEC for r=0.3 class 2 = 0.256 +- 0.254 (in-sample avg dev_std = 0.087)
NEC for r=0.3 all KL = 0.232 +- 0.254 (in-sample avg dev_std = 0.087)
NEC for r=0.3 all L1 = 0.295 +- 0.264 (in-sample avg dev_std = 0.087)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.69091
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.328
NEC for r=0.6 class 0 = 0.391 +- 0.229 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1 = 0.323 +- 0.229 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 2 = 0.323 +- 0.229 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.311 +- 0.229 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.346 +- 0.230 (in-sample avg dev_std = 0.217)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4804170000000001
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.37
NEC for r=0.9 class 0 = 0.418 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 1 = 0.34 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 2 = 0.341 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all KL = 0.353 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all L1 = 0.367 +- 0.220 (in-sample avg dev_std = 0.292)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:16:27 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:16:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 151 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9293 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.563
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.702
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.563044
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.505
SUFF_SIMPLE for r=0.3 class 0 = 0.252 +- 0.373 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 1 = 0.457 +- 0.373 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 2 = 0.745 +- 0.373 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all KL = 0.477 +- 0.373 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all L1 = 0.491 +- 0.297 (in-sample avg dev_std = 0.282)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474451
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.628
SUFF_SIMPLE for r=0.6 class 0 = 0.308 +- 0.358 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 class 1 = 0.585 +- 0.358 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 class 2 = 0.793 +- 0.358 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 all KL = 0.581 +- 0.358 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.6 all L1 = 0.568 +- 0.292 (in-sample avg dev_std = 0.201)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.345834
len(reference) = 2446
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF_SIMPLE for r=0.9 class 0 = 0.756 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.864 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.89 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.891 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.839 +- 0.197 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.783864
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.187 +- 0.306 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 1 = 0.197 +- 0.306 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 2 = 0.496 +- 0.306 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all KL = 0.259 +- 0.306 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all L1 = 0.293 +- 0.211 (in-sample avg dev_std = 0.058)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7022463333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.496
SUFF_SIMPLE for r=0.6 class 0 = 0.277 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.429 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.506 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.418 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.404 +- 0.206 (in-sample avg dev_std = 0.000)


ratio=0.9



Too few intervened samples, skipping weight=0.9


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.563044
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.286
NEC for r=0.3 class 0 = 0.713 +- 0.183 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 1 = 0.753 +- 0.183 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 2 = 0.644 +- 0.183 (in-sample avg dev_std = 0.322)
NEC for r=0.3 all KL = 0.752 +- 0.183 (in-sample avg dev_std = 0.322)
NEC for r=0.3 all L1 = 0.703 +- 0.124 (in-sample avg dev_std = 0.322)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.474451
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.333
NEC for r=0.6 class 0 = 0.727 +- 0.180 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.674 +- 0.180 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.636 +- 0.180 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.731 +- 0.180 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.678 +- 0.127 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.345834
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.387
NEC for r=0.9 class 0 = 0.718 +- 0.206 (in-sample avg dev_std = 0.497)
NEC for r=0.9 class 1 = 0.621 +- 0.206 (in-sample avg dev_std = 0.497)
NEC for r=0.9 class 2 = 0.581 +- 0.206 (in-sample avg dev_std = 0.497)
NEC for r=0.9 all KL = 0.688 +- 0.206 (in-sample avg dev_std = 0.497)
NEC for r=0.9 all L1 = 0.638 +- 0.149 (in-sample avg dev_std = 0.497)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.783864
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.266
NEC for r=0.3 class 0 = 0.497 +- 0.229 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 1 = 0.527 +- 0.229 (in-sample avg dev_std = 0.132)
NEC for r=0.3 class 2 = 0.524 +- 0.229 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all KL = 0.399 +- 0.229 (in-sample avg dev_std = 0.132)
NEC for r=0.3 all L1 = 0.516 +- 0.174 (in-sample avg dev_std = 0.132)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.7022463333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.299
NEC for r=0.6 class 0 = 0.569 +- 0.202 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 1 = 0.556 +- 0.202 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 2 = 0.504 +- 0.202 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.469 +- 0.202 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.543 +- 0.148 (in-sample avg dev_std = 0.259)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4908126666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.353
NEC for r=0.9 class 0 = 0.594 +- 0.216 (in-sample avg dev_std = 0.294)
NEC for r=0.9 class 1 = 0.557 +- 0.216 (in-sample avg dev_std = 0.294)
NEC for r=0.9 class 2 = 0.46 +- 0.216 (in-sample avg dev_std = 0.294)
NEC for r=0.9 all KL = 0.476 +- 0.216 (in-sample avg dev_std = 0.294)
NEC for r=0.9 all L1 = 0.537 +- 0.146 (in-sample avg dev_std = 0.294)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:18:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:18:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.544
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.452
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.335
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.487


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5444593333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.532
SUFF_SIMPLE for r=0.3 class 0 = 0.27 +- 0.383 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.3 class 1 = 0.488 +- 0.383 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.3 class 2 = 0.76 +- 0.383 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.3 all KL = 0.505 +- 0.383 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.3 all L1 = 0.512 +- 0.302 (in-sample avg dev_std = 0.284)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.452205
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.568
SUFF_SIMPLE for r=0.6 class 0 = 0.331 +- 0.358 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 1 = 0.568 +- 0.358 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 class 2 = 0.742 +- 0.358 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all KL = 0.563 +- 0.358 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.6 all L1 = 0.552 +- 0.289 (in-sample avg dev_std = 0.216)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33501699999999995
len(reference) = 2658
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.884
SUFF_SIMPLE for r=0.9 class 0 = 0.738 +- 0.201 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.859 +- 0.201 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.898 +- 0.201 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.889 +- 0.201 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.833 +- 0.192 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7838663333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.396
SUFF_SIMPLE for r=0.3 class 0 = 0.217 +- 0.249 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 class 1 = 0.277 +- 0.249 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 class 2 = 0.346 +- 0.249 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 all KL = 0.165 +- 0.249 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 all L1 = 0.28 +- 0.177 (in-sample avg dev_std = 0.118)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6968573333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.566
SUFF_SIMPLE for r=0.6 class 0 = 0.403 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.753 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.399 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.479 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.517 +- 0.291 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.941
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48747699999999994
len(reference) = 850
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.941
SUFF_SIMPLE for r=0.9 class 0 = 0.98 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.977 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.996 +- 0.005 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.973 +- 0.024 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5444593333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.276
NEC for r=0.3 class 0 = 0.669 +- 0.167 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 1 = 0.757 +- 0.167 (in-sample avg dev_std = 0.314)
NEC for r=0.3 class 2 = 0.671 +- 0.167 (in-sample avg dev_std = 0.314)
NEC for r=0.3 all KL = 0.752 +- 0.167 (in-sample avg dev_std = 0.314)
NEC for r=0.3 all L1 = 0.699 +- 0.124 (in-sample avg dev_std = 0.314)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.452205
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.331
NEC for r=0.6 class 0 = 0.72 +- 0.183 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 1 = 0.68 +- 0.183 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 2 = 0.625 +- 0.183 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all KL = 0.731 +- 0.183 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all L1 = 0.674 +- 0.131 (in-sample avg dev_std = 0.466)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.33501699999999995
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.387
NEC for r=0.9 class 0 = 0.712 +- 0.190 (in-sample avg dev_std = 0.526)
NEC for r=0.9 class 1 = 0.619 +- 0.190 (in-sample avg dev_std = 0.526)
NEC for r=0.9 class 2 = 0.599 +- 0.190 (in-sample avg dev_std = 0.526)
NEC for r=0.9 all KL = 0.697 +- 0.190 (in-sample avg dev_std = 0.526)
NEC for r=0.9 all L1 = 0.642 +- 0.137 (in-sample avg dev_std = 0.526)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7838663333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
NEC for r=0.3 class 0 = 0.538 +- 0.234 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 1 = 0.467 +- 0.234 (in-sample avg dev_std = 0.195)
NEC for r=0.3 class 2 = 0.387 +- 0.234 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all KL = 0.368 +- 0.234 (in-sample avg dev_std = 0.195)
NEC for r=0.3 all L1 = 0.464 +- 0.193 (in-sample avg dev_std = 0.195)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6968573333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.324
NEC for r=0.6 class 0 = 0.574 +- 0.240 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 1 = 0.427 +- 0.240 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 2 = 0.407 +- 0.240 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all KL = 0.419 +- 0.240 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all L1 = 0.47 +- 0.205 (in-sample avg dev_std = 0.287)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48747699999999994
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.369
NEC for r=0.9 class 0 = 0.579 +- 0.247 (in-sample avg dev_std = 0.342)
NEC for r=0.9 class 1 = 0.418 +- 0.247 (in-sample avg dev_std = 0.342)
NEC for r=0.9 class 2 = 0.406 +- 0.247 (in-sample avg dev_std = 0.342)
NEC for r=0.9 all KL = 0.435 +- 0.247 (in-sample avg dev_std = 0.342)
NEC for r=0.9 all L1 = 0.468 +- 0.198 (in-sample avg dev_std = 0.342)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.478, 0.578, 0.921], 'all_L1': [0.514, 0.593, 0.876]}), defaultdict(<class 'list'>, {'all_KL': [0.519, 0.575, 0.912], 'all_L1': [0.517, 0.558, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.54, 0.918], 'all_L1': [0.498, 0.544, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.49, 0.533, 0.913], 'all_L1': [0.497, 0.53, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.492, 0.526, 0.86], 'all_L1': [0.505, 0.527, 0.786]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.533, 0.894], 'all_L1': [0.484, 0.536, 0.843]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.555, 0.893], 'all_L1': [0.502, 0.548, 0.84]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.576, 0.896], 'all_L1': [0.508, 0.552, 0.829]}), defaultdict(<class 'list'>, {'all_KL': [0.477, 0.581, 0.891], 'all_L1': [0.491, 0.568, 0.839]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.563, 0.889], 'all_L1': [0.512, 0.552, 0.833]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.715, 0.781, 0.753], 'all_L1': [0.656, 0.685, 0.654]}), defaultdict(<class 'list'>, {'all_KL': [0.736, 0.717, 0.672], 'all_L1': [0.689, 0.67, 0.632]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.738, 0.694], 'all_L1': [0.687, 0.676, 0.637]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.745, 0.696], 'all_L1': [0.7, 0.68, 0.636]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.722, 0.688], 'all_L1': [0.69, 0.664, 0.632]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.731, 0.677], 'all_L1': [0.682, 0.666, 0.62]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.728, 0.692], 'all_L1': [0.702, 0.672, 0.639]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.717, 0.671], 'all_L1': [0.705, 0.672, 0.635]}), defaultdict(<class 'list'>, {'all_KL': [0.752, 0.731, 0.688], 'all_L1': [0.703, 0.678, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.752, 0.731, 0.697], 'all_L1': [0.699, 0.674, 0.642]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.456, 0.751, 0.983], 'all_L1': [0.453, 0.675, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.226, 0.442, 0.996], 'all_L1': [0.307, 0.463, 0.971]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.45, 1.0], 'all_L1': [0.299, 0.409, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.552, 0.998], 'all_L1': [0.351, 0.46, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.441, 0.996], 'all_L1': [0.287, 0.477, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.182, 0.341, 1.0], 'all_L1': [0.24, 0.365, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.209, 0.384, 1.0], 'all_L1': [0.256, 0.392, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.133, 0.382, 0.999], 'all_L1': [0.253, 0.445, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.259, 0.418, 1.0], 'all_L1': [0.293, 0.404, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.479, 0.996], 'all_L1': [0.28, 0.517, 0.973]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.44, 0.518, 0.521], 'all_L1': [0.485, 0.542, 0.538]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.482, 0.486], 'all_L1': [0.541, 0.545, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.35, 0.42, 0.431], 'all_L1': [0.445, 0.503, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.461, 0.451], 'all_L1': [0.577, 0.587, 0.573]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.423, 0.445], 'all_L1': [0.376, 0.439, 0.447]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.452, 0.477], 'all_L1': [0.399, 0.484, 0.496]}), defaultdict(<class 'list'>, {'all_KL': [0.394, 0.448, 0.465], 'all_L1': [0.519, 0.531, 0.526]}), defaultdict(<class 'list'>, {'all_KL': [0.232, 0.311, 0.353], 'all_L1': [0.295, 0.346, 0.367]}), defaultdict(<class 'list'>, {'all_KL': [0.399, 0.469, 0.476], 'all_L1': [0.516, 0.543, 0.537]}), defaultdict(<class 'list'>, {'all_KL': [0.368, 0.419, 0.435], 'all_L1': [0.464, 0.47, 0.468]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.503 +- 0.010, 0.551 +- 0.018, 0.840 +- 0.022
suff_simple class all_KL  =  0.491 +- 0.016, 0.556 +- 0.020, 0.899 +- 0.017
[[0.5152083039283752, 0.6029583215713501, 0.8725751042366028], [0.534500002861023, 0.5854583382606506, 0.8740487098693848], [0.5147500038146973, 0.5829583406448364, 0.8945010304450989], [0.5296249985694885, 0.5639583468437195, 0.8875094056129456], [0.5108333230018616, 0.5372499823570251, 0.8681192398071289], [0.49929165840148926, 0.5410416722297668, 0.8619489669799805], [0.530958354473114, 0.5756666660308838, 0.8820658922195435], [0.5375833511352539, 0.5820833444595337, 0.8842914700508118], [0.5053333044052124, 0.6278749704360962, 0.8704006671905518], [0.5322083234786987, 0.5677499771118164, 0.8841233849525452]]
[[0.478, 0.578, 0.921], [0.519, 0.575, 0.912], [0.481, 0.54, 0.918], [0.49, 0.533, 0.913], [0.492, 0.526, 0.86], [0.466, 0.533, 0.894], [0.491, 0.555, 0.893], [0.512, 0.576, 0.896], [0.477, 0.581, 0.891], [0.505, 0.563, 0.889]]
suff_simple_acc_int  =  0.521 +- 0.013, 0.577 +- 0.026, 0.878 +- 0.010
nec class all_L1  =  0.691 +- 0.014, 0.674 +- 0.006, 0.637 +- 0.008
nec class all_KL  =  0.743 +- 0.011, 0.734 +- 0.018, 0.693 +- 0.022
[[0.3370833396911621, 0.31304165720939636, 0.3635416626930237], [0.2840000092983246, 0.3332083225250244, 0.3857916593551636], [0.3087500035762787, 0.32762500643730164, 0.38345834612846375], [0.2798333466053009, 0.3266249895095825, 0.3882083296775818], [0.27008333802223206, 0.33783334493637085, 0.3919166624546051], [0.29362499713897705, 0.335999995470047, 0.4012083411216736], [0.28445833921432495, 0.34825000166893005, 0.3919999897480011], [0.2746666669845581, 0.32641667127609253, 0.3814166784286499], [0.28570833802223206, 0.33270832896232605, 0.3865000009536743], [0.27562499046325684, 0.3308333456516266, 0.3865416646003723]]
[[0.715, 0.781, 0.753], [0.736, 0.717, 0.672], [0.741, 0.738, 0.694], [0.747, 0.745, 0.696], [0.743, 0.722, 0.688], [0.745, 0.731, 0.677], [0.754, 0.728, 0.692], [0.746, 0.717, 0.671], [0.752, 0.731, 0.688], [0.752, 0.731, 0.697]]
nec_acc_int  =  0.289 +- 0.019, 0.331 +- 0.009, 0.386 +- 0.009

Eval split val
suff_simple class all_L1  =  0.302 +- 0.059, 0.461 +- 0.083, 0.980 +- 0.025
suff_simple class all_KL  =  0.249 +- 0.096, 0.464 +- 0.110, 0.997 +- 0.005
[[0.5348333120346069, 0.6320000290870667, 0.5980091691017151], [0.3698333203792572, 0.5073333382606506, 1.0], [0.33399999141693115, 0.5036666393280029, -1.0], [0.33399999141693115, 0.5076666474342346, 0.9166666865348816], [0.3893333375453949, 0.5559999942779541, 0.8928571343421936], [0.33399999141693115, 0.49433332681655884, -1.0], [0.33399999141693115, 0.5223333239555359, -1.0], [0.39620834589004517, 0.4516666531562805, 0.8815789222717285], [0.33399999141693115, 0.4959999918937683, -1.0], [0.3955416679382324, 0.5663333535194397, 0.9411764740943909]]
[[0.456, 0.751, 0.983], [0.226, 0.442, 0.996], [0.283, 0.45, 1.0], [0.386, 0.552, 0.998], [0.195, 0.441, 0.996], [0.182, 0.341, 1.0], [0.209, 0.384, 1.0], [0.133, 0.382, 0.999], [0.259, 0.418, 1.0], [0.165, 0.479, 0.996]]
suff_simple_acc_int  =  0.376 +- 0.059, 0.524 +- 0.047, 0.123 +- 0.922
nec class all_L1  =  0.462 +- 0.081, 0.499 +- 0.065, 0.499 +- 0.056
nec class all_KL  =  0.370 +- 0.063, 0.440 +- 0.052, 0.454 +- 0.042
[[0.3401666581630707, 0.29220834374427795, 0.3083750009536743], [0.3075000047683716, 0.31170833110809326, 0.3737083375453949], [0.2552083432674408, 0.31066668033599854, 0.37329167127609253], [0.20329166948795319, 0.2773333191871643, 0.3421249985694885], [0.29345834255218506, 0.29620832204818726, 0.3396666646003723], [0.2865416705608368, 0.27166667580604553, 0.3140000104904175], [0.31312501430511475, 0.3412916660308838, 0.3853749930858612], [0.3022083342075348, 0.32774999737739563, 0.3695000112056732], [0.26637500524520874, 0.2985416650772095, 0.35333332419395447], [0.3293749988079071, 0.32379165291786194, 0.36912500858306885]]
[[0.44, 0.518, 0.521], [0.437, 0.482, 0.486], [0.35, 0.42, 0.431], [0.437, 0.461, 0.451], [0.313, 0.423, 0.445], [0.333, 0.452, 0.477], [0.394, 0.448, 0.465], [0.232, 0.311, 0.353], [0.399, 0.469, 0.476], [0.368, 0.419, 0.435]]
nec_acc_int  =  0.290 +- 0.038, 0.305 +- 0.021, 0.353 +- 0.025


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.597 +- 0.008, 0.612 +- 0.011, 0.738 +- 0.013
Faith. Armon (L1)= 		  =  0.582 +- 0.007, 0.606 +- 0.013, 0.724 +- 0.012
Faith. GMean (L1)= 	  =  0.589 +- 0.007, 0.609 +- 0.012, 0.731 +- 0.012
Faith. Aritm (KL)= 		  =  0.617 +- 0.010, 0.645 +- 0.014, 0.796 +- 0.016
Faith. Armon (KL)= 		  =  0.591 +- 0.012, 0.632 +- 0.015, 0.782 +- 0.017
Faith. GMean (KL)= 	  =  0.604 +- 0.011, 0.639 +- 0.015, 0.789 +- 0.017

Eval split val
Faith. Aritm (L1)= 		  =  0.382 +- 0.059, 0.480 +- 0.056, 0.740 +- 0.027
Faith. Armon (L1)= 		  =  0.362 +- 0.056, 0.474 +- 0.056, 0.659 +- 0.050
Faith. GMean (L1)= 	  =  0.372 +- 0.057, 0.477 +- 0.056, 0.698 +- 0.039
Faith. Aritm (KL)= 		  =  0.310 +- 0.074, 0.452 +- 0.073, 0.725 +- 0.020
Faith. Armon (KL)= 		  =  0.293 +- 0.080, 0.448 +- 0.068, 0.623 +- 0.041
Faith. GMean (KL)= 	  =  0.301 +- 0.077, 0.450 +- 0.070, 0.672 +- 0.031
Computed for split load_split = id



Completed in  0:20:40.815633  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GSAT GOODMotif/basis/covariate NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:21:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:21:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.199
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17759633333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.217 +- 0.310 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 class 1 = 0.335 +- 0.310 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 class 2 = 0.522 +- 0.310 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 all KL = 0.28 +- 0.310 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 all L1 = 0.362 +- 0.257 (in-sample avg dev_std = 0.391)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24807
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.308
SUFF_SIMPLE for r=0.6 class 0 = 0.236 +- 0.284 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 class 1 = 0.375 +- 0.284 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 class 2 = 0.399 +- 0.284 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 all KL = 0.271 +- 0.284 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.6 all L1 = 0.339 +- 0.220 (in-sample avg dev_std = 0.274)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294591
len(reference) = 2709
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.543
SUFF_SIMPLE for r=0.9 class 0 = 0.456 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.69 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.499 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.546 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.55 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19912633333333335
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.301
SUFF_SIMPLE for r=0.3 class 0 = 0.318 +- 0.382 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 1 = 0.244 +- 0.382 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 class 2 = 0.735 +- 0.382 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all KL = 0.416 +- 0.382 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.3 all L1 = 0.433 +- 0.259 (in-sample avg dev_std = 0.282)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3169956666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.279
SUFF_SIMPLE for r=0.6 class 0 = 0.336 +- 0.376 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.6 class 1 = 0.262 +- 0.376 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.6 class 2 = 0.695 +- 0.376 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.6 all KL = 0.423 +- 0.376 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.6 all L1 = 0.432 +- 0.257 (in-sample avg dev_std = 0.125)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36216099999999996
len(reference) = 2689
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.415
SUFF_SIMPLE for r=0.9 class 0 = 0.562 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.544 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.501 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.586 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.535 +- 0.231 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17759633333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.379
NEC for r=0.3 class 0 = 0.72 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.3 class 1 = 0.556 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.3 class 2 = 0.609 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.3 all KL = 0.702 +- 0.273 (in-sample avg dev_std = 0.450)
NEC for r=0.3 all L1 = 0.627 +- 0.212 (in-sample avg dev_std = 0.450)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24807
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.735 +- 0.222 (in-sample avg dev_std = 0.547)
NEC for r=0.6 class 1 = 0.578 +- 0.222 (in-sample avg dev_std = 0.547)
NEC for r=0.6 class 2 = 0.611 +- 0.222 (in-sample avg dev_std = 0.547)
NEC for r=0.6 all KL = 0.734 +- 0.222 (in-sample avg dev_std = 0.547)
NEC for r=0.6 all L1 = 0.64 +- 0.176 (in-sample avg dev_std = 0.547)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294591
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.386
NEC for r=0.9 class 0 = 0.735 +- 0.209 (in-sample avg dev_std = 0.558)
NEC for r=0.9 class 1 = 0.582 +- 0.209 (in-sample avg dev_std = 0.558)
NEC for r=0.9 class 2 = 0.609 +- 0.209 (in-sample avg dev_std = 0.558)
NEC for r=0.9 all KL = 0.737 +- 0.209 (in-sample avg dev_std = 0.558)
NEC for r=0.9 all L1 = 0.64 +- 0.167 (in-sample avg dev_std = 0.558)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19912633333333335
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.523 +- 0.280 (in-sample avg dev_std = 0.321)
NEC for r=0.3 class 1 = 0.482 +- 0.280 (in-sample avg dev_std = 0.321)
NEC for r=0.3 class 2 = 0.502 +- 0.280 (in-sample avg dev_std = 0.321)
NEC for r=0.3 all KL = 0.473 +- 0.280 (in-sample avg dev_std = 0.321)
NEC for r=0.3 all L1 = 0.503 +- 0.191 (in-sample avg dev_std = 0.321)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.675
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3169956666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.325
NEC for r=0.6 class 0 = 0.532 +- 0.257 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 1 = 0.517 +- 0.257 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 2 = 0.531 +- 0.257 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all KL = 0.506 +- 0.257 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all L1 = 0.527 +- 0.158 (in-sample avg dev_std = 0.370)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.675
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36216099999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.326
NEC for r=0.9 class 0 = 0.532 +- 0.250 (in-sample avg dev_std = 0.389)
NEC for r=0.9 class 1 = 0.508 +- 0.250 (in-sample avg dev_std = 0.389)
NEC for r=0.9 class 2 = 0.537 +- 0.250 (in-sample avg dev_std = 0.389)
NEC for r=0.9 all KL = 0.507 +- 0.250 (in-sample avg dev_std = 0.389)
NEC for r=0.9 all L1 = 0.525 +- 0.156 (in-sample avg dev_std = 0.389)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:23:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:23:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18386299999999997
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.22 +- 0.312 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.3 class 1 = 0.327 +- 0.312 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.3 class 2 = 0.554 +- 0.312 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.3 all KL = 0.343 +- 0.312 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.3 all L1 = 0.371 +- 0.245 (in-sample avg dev_std = 0.335)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.253024
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.324
SUFF_SIMPLE for r=0.6 class 0 = 0.239 +- 0.274 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 class 1 = 0.375 +- 0.274 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 class 2 = 0.439 +- 0.274 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 all KL = 0.336 +- 0.274 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.6 all L1 = 0.354 +- 0.196 (in-sample avg dev_std = 0.246)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2953766666666666
len(reference) = 2709
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.59
SUFF_SIMPLE for r=0.9 class 0 = 0.525 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.688 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.562 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.629 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.592 +- 0.312 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21260500000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.297
SUFF_SIMPLE for r=0.3 class 0 = 0.264 +- 0.377 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.3 class 1 = 0.248 +- 0.377 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.3 class 2 = 0.675 +- 0.377 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.3 all KL = 0.349 +- 0.377 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.3 all L1 = 0.396 +- 0.248 (in-sample avg dev_std = 0.176)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3208033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.295
SUFF_SIMPLE for r=0.6 class 0 = 0.276 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 class 1 = 0.279 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 class 2 = 0.612 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 all KL = 0.355 +- 0.350 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.6 all L1 = 0.389 +- 0.219 (in-sample avg dev_std = 0.103)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.352682
len(reference) = 2606
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.371
SUFF_SIMPLE for r=0.9 class 0 = 0.404 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.628 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.52 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.635 +- 0.251 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.516 +- 0.224 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18386299999999997
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.399
NEC for r=0.3 class 0 = 0.694 +- 0.258 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 1 = 0.574 +- 0.258 (in-sample avg dev_std = 0.415)
NEC for r=0.3 class 2 = 0.574 +- 0.258 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all KL = 0.638 +- 0.258 (in-sample avg dev_std = 0.415)
NEC for r=0.3 all L1 = 0.612 +- 0.188 (in-sample avg dev_std = 0.415)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.253024
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.701 +- 0.222 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.588 +- 0.222 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.566 +- 0.222 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.651 +- 0.222 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.616 +- 0.158 (in-sample avg dev_std = 0.489)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2953766666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.406
NEC for r=0.9 class 0 = 0.702 +- 0.213 (in-sample avg dev_std = 0.503)
NEC for r=0.9 class 1 = 0.595 +- 0.213 (in-sample avg dev_std = 0.503)
NEC for r=0.9 class 2 = 0.569 +- 0.213 (in-sample avg dev_std = 0.503)
NEC for r=0.9 all KL = 0.657 +- 0.213 (in-sample avg dev_std = 0.503)
NEC for r=0.9 all L1 = 0.62 +- 0.148 (in-sample avg dev_std = 0.503)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21260500000000002
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.406
NEC for r=0.3 class 0 = 0.651 +- 0.235 (in-sample avg dev_std = 0.257)
NEC for r=0.3 class 1 = 0.439 +- 0.235 (in-sample avg dev_std = 0.257)
NEC for r=0.3 class 2 = 0.507 +- 0.235 (in-sample avg dev_std = 0.257)
NEC for r=0.3 all KL = 0.483 +- 0.235 (in-sample avg dev_std = 0.257)
NEC for r=0.3 all L1 = 0.533 +- 0.184 (in-sample avg dev_std = 0.257)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.795
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3208033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.654 +- 0.229 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 1 = 0.443 +- 0.229 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 2 = 0.49 +- 0.229 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all KL = 0.481 +- 0.229 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all L1 = 0.529 +- 0.175 (in-sample avg dev_std = 0.299)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.352682
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.396
NEC for r=0.9 class 0 = 0.652 +- 0.223 (in-sample avg dev_std = 0.312)
NEC for r=0.9 class 1 = 0.439 +- 0.223 (in-sample avg dev_std = 0.312)
NEC for r=0.9 class 2 = 0.503 +- 0.223 (in-sample avg dev_std = 0.312)
NEC for r=0.9 all KL = 0.484 +- 0.223 (in-sample avg dev_std = 0.312)
NEC for r=0.9 all L1 = 0.532 +- 0.170 (in-sample avg dev_std = 0.312)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:24:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:24:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.319
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.181476
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
SUFF_SIMPLE for r=0.3 class 0 = 0.214 +- 0.307 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 class 1 = 0.318 +- 0.307 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 class 2 = 0.542 +- 0.307 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 all KL = 0.313 +- 0.307 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.3 all L1 = 0.362 +- 0.244 (in-sample avg dev_std = 0.339)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2506366666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.318
SUFF_SIMPLE for r=0.6 class 0 = 0.237 +- 0.272 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 class 1 = 0.364 +- 0.272 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 class 2 = 0.433 +- 0.272 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all KL = 0.309 +- 0.272 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all L1 = 0.347 +- 0.200 (in-sample avg dev_std = 0.247)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29479633333333327
len(reference) = 2714
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.589
SUFF_SIMPLE for r=0.9 class 0 = 0.5 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.702 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.547 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.604 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.584 +- 0.319 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2128416666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.324
SUFF_SIMPLE for r=0.3 class 0 = 0.256 +- 0.358 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.3 class 1 = 0.203 +- 0.358 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.3 class 2 = 0.658 +- 0.358 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.3 all KL = 0.386 +- 0.358 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.3 all L1 = 0.373 +- 0.243 (in-sample avg dev_std = 0.167)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3194033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.318
SUFF_SIMPLE for r=0.6 class 0 = 0.282 +- 0.333 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.6 class 1 = 0.223 +- 0.333 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.6 class 2 = 0.615 +- 0.333 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.6 all KL = 0.393 +- 0.333 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.6 all L1 = 0.374 +- 0.222 (in-sample avg dev_std = 0.098)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.582
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35187466666666667
len(reference) = 2591
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF_SIMPLE for r=0.9 class 0 = 0.691 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.746 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.473 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.746 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.635 +- 0.233 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.181476
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.701 +- 0.264 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 1 = 0.567 +- 0.264 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 2 = 0.579 +- 0.264 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all KL = 0.656 +- 0.264 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all L1 = 0.614 +- 0.197 (in-sample avg dev_std = 0.430)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2506366666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.406
NEC for r=0.6 class 0 = 0.714 +- 0.228 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 1 = 0.588 +- 0.228 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 2 = 0.57 +- 0.228 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all KL = 0.674 +- 0.228 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all L1 = 0.622 +- 0.165 (in-sample avg dev_std = 0.499)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29479633333333327
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.405
NEC for r=0.9 class 0 = 0.719 +- 0.216 (in-sample avg dev_std = 0.515)
NEC for r=0.9 class 1 = 0.589 +- 0.216 (in-sample avg dev_std = 0.515)
NEC for r=0.9 class 2 = 0.579 +- 0.216 (in-sample avg dev_std = 0.515)
NEC for r=0.9 all KL = 0.683 +- 0.216 (in-sample avg dev_std = 0.515)
NEC for r=0.9 all L1 = 0.627 +- 0.156 (in-sample avg dev_std = 0.515)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2128416666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.402
NEC for r=0.3 class 0 = 0.527 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 1 = 0.515 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 class 2 = 0.462 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all KL = 0.422 +- 0.228 (in-sample avg dev_std = 0.266)
NEC for r=0.3 all L1 = 0.501 +- 0.161 (in-sample avg dev_std = 0.266)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.604
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3194033333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.386
NEC for r=0.6 class 0 = 0.531 +- 0.214 (in-sample avg dev_std = 0.320)
NEC for r=0.6 class 1 = 0.521 +- 0.214 (in-sample avg dev_std = 0.320)
NEC for r=0.6 class 2 = 0.459 +- 0.214 (in-sample avg dev_std = 0.320)
NEC for r=0.6 all KL = 0.427 +- 0.214 (in-sample avg dev_std = 0.320)
NEC for r=0.6 all L1 = 0.504 +- 0.140 (in-sample avg dev_std = 0.320)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.604
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35187466666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.396
NEC for r=0.9 class 0 = 0.54 +- 0.206 (in-sample avg dev_std = 0.334)
NEC for r=0.9 class 1 = 0.515 +- 0.206 (in-sample avg dev_std = 0.334)
NEC for r=0.9 class 2 = 0.469 +- 0.206 (in-sample avg dev_std = 0.334)
NEC for r=0.9 all KL = 0.431 +- 0.206 (in-sample avg dev_std = 0.334)
NEC for r=0.9 all L1 = 0.508 +- 0.131 (in-sample avg dev_std = 0.334)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:26:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:26:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.318
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18088933333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.217 +- 0.296 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.3 class 1 = 0.31 +- 0.296 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.3 class 2 = 0.521 +- 0.296 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.3 all KL = 0.309 +- 0.296 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.3 all L1 = 0.353 +- 0.222 (in-sample avg dev_std = 0.344)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24965033333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.325
SUFF_SIMPLE for r=0.6 class 0 = 0.25 +- 0.274 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.6 class 1 = 0.36 +- 0.274 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.6 class 2 = 0.436 +- 0.274 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.6 all KL = 0.32 +- 0.274 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.6 all L1 = 0.351 +- 0.198 (in-sample avg dev_std = 0.262)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29429833333333333
len(reference) = 2707
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.575
SUFF_SIMPLE for r=0.9 class 0 = 0.507 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.679 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.544 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.599 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.578 +- 0.321 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.332
SUFF_SIMPLE for r=0.3 class 0 = 0.272 +- 0.367 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 class 1 = 0.223 +- 0.367 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 class 2 = 0.757 +- 0.367 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 all KL = 0.447 +- 0.367 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.3 all L1 = 0.418 +- 0.274 (in-sample avg dev_std = 0.118)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31824933333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.326
SUFF_SIMPLE for r=0.6 class 0 = 0.29 +- 0.346 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 class 1 = 0.239 +- 0.346 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 class 2 = 0.732 +- 0.346 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 all KL = 0.457 +- 0.346 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.6 all L1 = 0.421 +- 0.263 (in-sample avg dev_std = 0.064)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3517643333333334
len(reference) = 2637
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.394
SUFF_SIMPLE for r=0.9 class 0 = 0.449 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.52 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.409 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.598 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.459 +- 0.187 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18088933333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.4
NEC for r=0.3 class 0 = 0.698 +- 0.269 (in-sample avg dev_std = 0.440)
NEC for r=0.3 class 1 = 0.563 +- 0.269 (in-sample avg dev_std = 0.440)
NEC for r=0.3 class 2 = 0.58 +- 0.269 (in-sample avg dev_std = 0.440)
NEC for r=0.3 all KL = 0.651 +- 0.269 (in-sample avg dev_std = 0.440)
NEC for r=0.3 all L1 = 0.612 +- 0.197 (in-sample avg dev_std = 0.440)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24965033333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.409
NEC for r=0.6 class 0 = 0.704 +- 0.232 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 1 = 0.585 +- 0.232 (in-sample avg dev_std = 0.519)
NEC for r=0.6 class 2 = 0.569 +- 0.232 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all KL = 0.67 +- 0.232 (in-sample avg dev_std = 0.519)
NEC for r=0.6 all L1 = 0.618 +- 0.168 (in-sample avg dev_std = 0.519)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29429833333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.406
NEC for r=0.9 class 0 = 0.704 +- 0.216 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 1 = 0.602 +- 0.216 (in-sample avg dev_std = 0.536)
NEC for r=0.9 class 2 = 0.573 +- 0.216 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all KL = 0.682 +- 0.216 (in-sample avg dev_std = 0.536)
NEC for r=0.9 all L1 = 0.625 +- 0.153 (in-sample avg dev_std = 0.536)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.643 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 1 = 0.565 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 class 2 = 0.477 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 all KL = 0.437 +- 0.221 (in-sample avg dev_std = 0.206)
NEC for r=0.3 all L1 = 0.562 +- 0.133 (in-sample avg dev_std = 0.206)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31824933333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.362
NEC for r=0.6 class 0 = 0.642 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 1 = 0.571 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 2 = 0.482 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all KL = 0.443 +- 0.209 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all L1 = 0.565 +- 0.117 (in-sample avg dev_std = 0.256)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3517643333333334
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.366
NEC for r=0.9 class 0 = 0.644 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 1 = 0.57 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=0.9 class 2 = 0.484 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=0.9 all KL = 0.444 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=0.9 all L1 = 0.566 +- 0.114 (in-sample avg dev_std = 0.262)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:28:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:28:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.212
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1808736666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.22 +- 0.312 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 1 = 0.311 +- 0.312 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 2 = 0.556 +- 0.312 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all KL = 0.32 +- 0.312 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all L1 = 0.367 +- 0.246 (in-sample avg dev_std = 0.352)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24933033333333332
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.329
SUFF_SIMPLE for r=0.6 class 0 = 0.235 +- 0.290 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.6 class 1 = 0.352 +- 0.290 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.6 class 2 = 0.465 +- 0.290 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.6 all KL = 0.317 +- 0.290 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.6 all L1 = 0.354 +- 0.213 (in-sample avg dev_std = 0.259)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.295339
len(reference) = 2708
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.576
SUFF_SIMPLE for r=0.9 class 0 = 0.517 +- 0.387 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.649 +- 0.387 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.554 +- 0.387 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.594 +- 0.387 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.574 +- 0.323 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21246133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.296
SUFF_SIMPLE for r=0.3 class 0 = 0.309 +- 0.353 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.3 class 1 = 0.257 +- 0.353 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.3 class 2 = 0.619 +- 0.353 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.3 all KL = 0.337 +- 0.353 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.3 all L1 = 0.395 +- 0.226 (in-sample avg dev_std = 0.240)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31450266666666665
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.31
SUFF_SIMPLE for r=0.6 class 0 = 0.338 +- 0.348 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.6 class 1 = 0.308 +- 0.348 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.6 class 2 = 0.61 +- 0.348 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.6 all KL = 0.367 +- 0.348 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.6 all L1 = 0.419 +- 0.234 (in-sample avg dev_std = 0.134)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.538
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35299
len(reference) = 2647
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.383
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.789 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.602 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.737 +- 0.276 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.683 +- 0.263 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1808736666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.403
NEC for r=0.3 class 0 = 0.684 +- 0.279 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 1 = 0.599 +- 0.279 (in-sample avg dev_std = 0.435)
NEC for r=0.3 class 2 = 0.552 +- 0.279 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all KL = 0.65 +- 0.279 (in-sample avg dev_std = 0.435)
NEC for r=0.3 all L1 = 0.61 +- 0.202 (in-sample avg dev_std = 0.435)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24933033333333332
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.412
NEC for r=0.6 class 0 = 0.696 +- 0.240 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 1 = 0.611 +- 0.240 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 2 = 0.55 +- 0.240 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all KL = 0.668 +- 0.240 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all L1 = 0.617 +- 0.171 (in-sample avg dev_std = 0.512)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.295339
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.409
NEC for r=0.9 class 0 = 0.696 +- 0.232 (in-sample avg dev_std = 0.527)
NEC for r=0.9 class 1 = 0.62 +- 0.232 (in-sample avg dev_std = 0.527)
NEC for r=0.9 class 2 = 0.555 +- 0.232 (in-sample avg dev_std = 0.527)
NEC for r=0.9 all KL = 0.676 +- 0.232 (in-sample avg dev_std = 0.527)
NEC for r=0.9 all L1 = 0.622 +- 0.163 (in-sample avg dev_std = 0.527)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.557
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21246133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.364
NEC for r=0.3 class 0 = 0.487 +- 0.263 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.398 +- 0.263 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.458 +- 0.263 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.439 +- 0.263 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.448 +- 0.221 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.557
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31450266666666665
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.347
NEC for r=0.6 class 0 = 0.489 +- 0.252 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 1 = 0.408 +- 0.252 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 2 = 0.449 +- 0.252 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all KL = 0.447 +- 0.252 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all L1 = 0.449 +- 0.210 (in-sample avg dev_std = 0.298)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.557
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35299
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.352
NEC for r=0.9 class 0 = 0.488 +- 0.246 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 1 = 0.41 +- 0.246 (in-sample avg dev_std = 0.309)
NEC for r=0.9 class 2 = 0.461 +- 0.246 (in-sample avg dev_std = 0.309)
NEC for r=0.9 all KL = 0.451 +- 0.246 (in-sample avg dev_std = 0.309)
NEC for r=0.9 all L1 = 0.453 +- 0.206 (in-sample avg dev_std = 0.309)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:31:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:31:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9311
Train Loss: 0.3042
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3146
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3146
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18087633333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.214 +- 0.303 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.3 class 1 = 0.292 +- 0.303 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.3 class 2 = 0.564 +- 0.303 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.3 all KL = 0.313 +- 0.303 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.3 all L1 = 0.361 +- 0.241 (in-sample avg dev_std = 0.319)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2504673333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.331
SUFF_SIMPLE for r=0.6 class 0 = 0.231 +- 0.288 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 class 1 = 0.32 +- 0.288 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 class 2 = 0.509 +- 0.288 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 all KL = 0.315 +- 0.288 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.6 all L1 = 0.357 +- 0.224 (in-sample avg dev_std = 0.241)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.295813
len(reference) = 2712
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.558
SUFF_SIMPLE for r=0.9 class 0 = 0.497 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.661 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.535 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.584 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.565 +- 0.319 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21709066666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
SUFF_SIMPLE for r=0.3 class 0 = 0.209 +- 0.289 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.3 class 1 = 0.182 +- 0.289 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.3 class 2 = 0.45 +- 0.289 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.3 all KL = 0.246 +- 0.289 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.3 all L1 = 0.28 +- 0.176 (in-sample avg dev_std = 0.135)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3217426666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.33
SUFF_SIMPLE for r=0.6 class 0 = 0.228 +- 0.297 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.6 class 1 = 0.2 +- 0.297 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.6 class 2 = 0.468 +- 0.297 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.6 all KL = 0.266 +- 0.297 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.6 all L1 = 0.299 +- 0.190 (in-sample avg dev_std = 0.082)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.545
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3520763333333333
len(reference) = 2611
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.368
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.726 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.589 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.76 +- 0.216 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.645 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18087633333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.416
NEC for r=0.3 class 0 = 0.711 +- 0.284 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 1 = 0.59 +- 0.284 (in-sample avg dev_std = 0.433)
NEC for r=0.3 class 2 = 0.516 +- 0.284 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all KL = 0.648 +- 0.284 (in-sample avg dev_std = 0.433)
NEC for r=0.3 all L1 = 0.604 +- 0.215 (in-sample avg dev_std = 0.433)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2504673333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.424
NEC for r=0.6 class 0 = 0.712 +- 0.267 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 1 = 0.6 +- 0.267 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 2 = 0.508 +- 0.267 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all KL = 0.656 +- 0.267 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all L1 = 0.604 +- 0.201 (in-sample avg dev_std = 0.487)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.295813
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.416
NEC for r=0.9 class 0 = 0.721 +- 0.257 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 1 = 0.607 +- 0.257 (in-sample avg dev_std = 0.496)
NEC for r=0.9 class 2 = 0.515 +- 0.257 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all KL = 0.666 +- 0.257 (in-sample avg dev_std = 0.496)
NEC for r=0.9 all L1 = 0.611 +- 0.191 (in-sample avg dev_std = 0.496)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.559
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21709066666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
NEC for r=0.3 class 0 = 0.527 +- 0.254 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.568 +- 0.254 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.403 +- 0.254 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.479 +- 0.254 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.499 +- 0.187 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.559
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3217426666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.323
NEC for r=0.6 class 0 = 0.528 +- 0.245 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.575 +- 0.245 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.393 +- 0.245 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.48 +- 0.245 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.499 +- 0.173 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.559
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3520763333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.328
NEC for r=0.9 class 0 = 0.53 +- 0.236 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 1 = 0.57 +- 0.236 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 2 = 0.412 +- 0.236 (in-sample avg dev_std = 0.305)
NEC for r=0.9 all KL = 0.485 +- 0.236 (in-sample avg dev_std = 0.305)
NEC for r=0.9 all L1 = 0.504 +- 0.166 (in-sample avg dev_std = 0.305)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:34:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:34:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 0.9320
Train Loss: 0.3005
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3152
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3075
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3152
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3075

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.183
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.216
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.182856
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
SUFF_SIMPLE for r=0.3 class 0 = 0.223 +- 0.295 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.3 class 1 = 0.305 +- 0.295 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.3 class 2 = 0.535 +- 0.295 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.3 all KL = 0.314 +- 0.295 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.3 all L1 = 0.358 +- 0.233 (in-sample avg dev_std = 0.340)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25238166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.335
SUFF_SIMPLE for r=0.6 class 0 = 0.25 +- 0.264 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.6 class 1 = 0.356 +- 0.264 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.6 class 2 = 0.436 +- 0.264 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.6 all KL = 0.317 +- 0.264 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.6 all L1 = 0.35 +- 0.197 (in-sample avg dev_std = 0.253)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294937
len(reference) = 2705
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.576
SUFF_SIMPLE for r=0.9 class 0 = 0.506 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.666 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.548 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.595 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.574 +- 0.319 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216452
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.303
SUFF_SIMPLE for r=0.3 class 0 = 0.259 +- 0.338 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.3 class 1 = 0.215 +- 0.338 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.3 class 2 = 0.564 +- 0.338 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.3 all KL = 0.326 +- 0.338 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.3 all L1 = 0.346 +- 0.200 (in-sample avg dev_std = 0.210)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.317452
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.289
SUFF_SIMPLE for r=0.6 class 0 = 0.283 +- 0.333 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.6 class 1 = 0.241 +- 0.333 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.6 class 2 = 0.565 +- 0.333 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.6 all KL = 0.352 +- 0.333 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.6 all L1 = 0.363 +- 0.203 (in-sample avg dev_std = 0.111)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3511043333333333
len(reference) = 2613
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.405
SUFF_SIMPLE for r=0.9 class 0 = 0.492 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.667 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.537 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.688 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.564 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.182856
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.401
NEC for r=0.3 class 0 = 0.692 +- 0.256 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 1 = 0.592 +- 0.256 (in-sample avg dev_std = 0.425)
NEC for r=0.3 class 2 = 0.58 +- 0.256 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all KL = 0.658 +- 0.256 (in-sample avg dev_std = 0.425)
NEC for r=0.3 all L1 = 0.62 +- 0.190 (in-sample avg dev_std = 0.425)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25238166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.41
NEC for r=0.6 class 0 = 0.696 +- 0.220 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.608 +- 0.220 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.571 +- 0.220 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.671 +- 0.220 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.623 +- 0.160 (in-sample avg dev_std = 0.505)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294937
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.411
NEC for r=0.9 class 0 = 0.697 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 class 1 = 0.614 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 class 2 = 0.575 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 all KL = 0.678 +- 0.205 (in-sample avg dev_std = 0.519)
NEC for r=0.9 all L1 = 0.627 +- 0.147 (in-sample avg dev_std = 0.519)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.681
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.216452
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.415
NEC for r=0.3 class 0 = 0.613 +- 0.235 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 1 = 0.497 +- 0.235 (in-sample avg dev_std = 0.252)
NEC for r=0.3 class 2 = 0.445 +- 0.235 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all KL = 0.454 +- 0.235 (in-sample avg dev_std = 0.252)
NEC for r=0.3 all L1 = 0.519 +- 0.166 (in-sample avg dev_std = 0.252)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.681
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.317452
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.613 +- 0.225 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 1 = 0.508 +- 0.225 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 2 = 0.452 +- 0.225 (in-sample avg dev_std = 0.296)
NEC for r=0.6 all KL = 0.463 +- 0.225 (in-sample avg dev_std = 0.296)
NEC for r=0.6 all L1 = 0.525 +- 0.150 (in-sample avg dev_std = 0.296)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.681
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3511043333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.41
NEC for r=0.9 class 0 = 0.613 +- 0.221 (in-sample avg dev_std = 0.308)
NEC for r=0.9 class 1 = 0.503 +- 0.221 (in-sample avg dev_std = 0.308)
NEC for r=0.9 class 2 = 0.466 +- 0.221 (in-sample avg dev_std = 0.308)
NEC for r=0.9 all KL = 0.467 +- 0.221 (in-sample avg dev_std = 0.308)
NEC for r=0.9 all L1 = 0.528 +- 0.146 (in-sample avg dev_std = 0.308)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:36:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:36:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3038
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3193
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3097
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3193
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3097

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.183
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.217
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1827543333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
SUFF_SIMPLE for r=0.3 class 0 = 0.22 +- 0.294 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.3 class 1 = 0.322 +- 0.294 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.3 class 2 = 0.53 +- 0.294 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.3 all KL = 0.332 +- 0.294 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.3 all L1 = 0.361 +- 0.228 (in-sample avg dev_std = 0.328)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251673
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.323
SUFF_SIMPLE for r=0.6 class 0 = 0.246 +- 0.267 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 class 1 = 0.368 +- 0.267 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 class 2 = 0.438 +- 0.267 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all KL = 0.337 +- 0.267 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.6 all L1 = 0.353 +- 0.196 (in-sample avg dev_std = 0.247)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947183333333333
len(reference) = 2715
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.558
SUFF_SIMPLE for r=0.9 class 0 = 0.486 +- 0.379 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.678 +- 0.379 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.527 +- 0.379 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.593 +- 0.379 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.565 +- 0.317 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21689799999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.304
SUFF_SIMPLE for r=0.3 class 0 = 0.387 +- 0.292 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.3 class 1 = 0.318 +- 0.292 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.3 class 2 = 0.545 +- 0.292 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.3 all KL = 0.324 +- 0.292 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.3 all L1 = 0.417 +- 0.207 (in-sample avg dev_std = 0.263)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32082733333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.287
SUFF_SIMPLE for r=0.6 class 0 = 0.43 +- 0.310 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.6 class 1 = 0.371 +- 0.310 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.6 class 2 = 0.558 +- 0.310 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.6 all KL = 0.382 +- 0.310 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.6 all L1 = 0.453 +- 0.225 (in-sample avg dev_std = 0.129)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.508
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35269999999999996
len(reference) = 2623
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.373
SUFF_SIMPLE for r=0.9 class 0 = 0.711 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.859 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.764 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.839 +- 0.225 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.778 +- 0.245 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.1827543333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.389
NEC for r=0.3 class 0 = 0.698 +- 0.254 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1 = 0.574 +- 0.254 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 2 = 0.576 +- 0.254 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.637 +- 0.254 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.614 +- 0.189 (in-sample avg dev_std = 0.412)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.251673
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.402
NEC for r=0.6 class 0 = 0.705 +- 0.217 (in-sample avg dev_std = 0.485)
NEC for r=0.6 class 1 = 0.578 +- 0.217 (in-sample avg dev_std = 0.485)
NEC for r=0.6 class 2 = 0.582 +- 0.217 (in-sample avg dev_std = 0.485)
NEC for r=0.6 all KL = 0.651 +- 0.217 (in-sample avg dev_std = 0.485)
NEC for r=0.6 all L1 = 0.62 +- 0.159 (in-sample avg dev_std = 0.485)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2947183333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.396
NEC for r=0.9 class 0 = 0.709 +- 0.207 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 1 = 0.591 +- 0.207 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 2 = 0.577 +- 0.207 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all KL = 0.657 +- 0.207 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all L1 = 0.624 +- 0.150 (in-sample avg dev_std = 0.498)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.521
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21689799999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.388
NEC for r=0.3 class 0 = 0.421 +- 0.252 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 1 = 0.328 +- 0.252 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 2 = 0.371 +- 0.252 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all KL = 0.357 +- 0.252 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all L1 = 0.373 +- 0.229 (in-sample avg dev_std = 0.248)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32082733333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.382
NEC for r=0.6 class 0 = 0.42 +- 0.243 (in-sample avg dev_std = 0.286)
NEC for r=0.6 class 1 = 0.335 +- 0.243 (in-sample avg dev_std = 0.286)
NEC for r=0.6 class 2 = 0.345 +- 0.243 (in-sample avg dev_std = 0.286)
NEC for r=0.6 all KL = 0.353 +- 0.243 (in-sample avg dev_std = 0.286)
NEC for r=0.6 all L1 = 0.367 +- 0.220 (in-sample avg dev_std = 0.286)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.521
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35269999999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.382
NEC for r=0.9 class 0 = 0.426 +- 0.236 (in-sample avg dev_std = 0.300)
NEC for r=0.9 class 1 = 0.334 +- 0.236 (in-sample avg dev_std = 0.300)
NEC for r=0.9 class 2 = 0.363 +- 0.236 (in-sample avg dev_std = 0.300)
NEC for r=0.9 all KL = 0.361 +- 0.236 (in-sample avg dev_std = 0.300)
NEC for r=0.9 all L1 = 0.374 +- 0.215 (in-sample avg dev_std = 0.300)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:39:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:39:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 151 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3002
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3156
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3069
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3156
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3069

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9293 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.219
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18610966666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.219 +- 0.296 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.3 class 1 = 0.307 +- 0.296 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.3 class 2 = 0.541 +- 0.296 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.3 all KL = 0.315 +- 0.296 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.3 all L1 = 0.36 +- 0.235 (in-sample avg dev_std = 0.334)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2529973333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.331
SUFF_SIMPLE for r=0.6 class 0 = 0.244 +- 0.270 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 class 1 = 0.352 +- 0.270 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 class 2 = 0.449 +- 0.270 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all KL = 0.321 +- 0.270 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.6 all L1 = 0.351 +- 0.202 (in-sample avg dev_std = 0.249)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2951146666666667
len(reference) = 2698
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.564
SUFF_SIMPLE for r=0.9 class 0 = 0.508 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.669 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.527 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.588 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.569 +- 0.320 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21901266666666666
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.323
SUFF_SIMPLE for r=0.3 class 0 = 0.244 +- 0.362 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.3 class 1 = 0.2 +- 0.362 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.3 class 2 = 0.637 +- 0.362 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.3 all KL = 0.351 +- 0.362 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.3 all L1 = 0.361 +- 0.244 (in-sample avg dev_std = 0.174)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3196676666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.322
SUFF_SIMPLE for r=0.6 class 0 = 0.264 +- 0.342 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.6 class 1 = 0.217 +- 0.342 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.6 class 2 = 0.609 +- 0.342 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.6 all KL = 0.362 +- 0.342 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.6 all L1 = 0.364 +- 0.226 (in-sample avg dev_std = 0.101)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35219999999999996
len(reference) = 2631
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.382
SUFF_SIMPLE for r=0.9 class 0 = 0.535 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.679 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.468 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.676 +- 0.243 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.559 +- 0.225 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18610966666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.41
NEC for r=0.3 class 0 = 0.696 +- 0.256 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 1 = 0.589 +- 0.256 (in-sample avg dev_std = 0.429)
NEC for r=0.3 class 2 = 0.562 +- 0.256 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all KL = 0.649 +- 0.256 (in-sample avg dev_std = 0.429)
NEC for r=0.3 all L1 = 0.614 +- 0.192 (in-sample avg dev_std = 0.429)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2529973333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.413
NEC for r=0.6 class 0 = 0.706 +- 0.222 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 1 = 0.604 +- 0.222 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 2 = 0.559 +- 0.222 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all KL = 0.665 +- 0.222 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all L1 = 0.621 +- 0.163 (in-sample avg dev_std = 0.490)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2951146666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.409
NEC for r=0.9 class 0 = 0.707 +- 0.212 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 1 = 0.607 +- 0.212 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 2 = 0.568 +- 0.212 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all KL = 0.673 +- 0.212 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all L1 = 0.625 +- 0.154 (in-sample avg dev_std = 0.505)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21901266666666666
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.595 +- 0.229 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 1 = 0.548 +- 0.229 (in-sample avg dev_std = 0.242)
NEC for r=0.3 class 2 = 0.456 +- 0.229 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all KL = 0.469 +- 0.229 (in-sample avg dev_std = 0.242)
NEC for r=0.3 all L1 = 0.533 +- 0.162 (in-sample avg dev_std = 0.242)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3196676666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.368
NEC for r=0.6 class 0 = 0.595 +- 0.218 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 1 = 0.551 +- 0.218 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 2 = 0.458 +- 0.218 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all KL = 0.473 +- 0.218 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all L1 = 0.535 +- 0.149 (in-sample avg dev_std = 0.284)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35219999999999996
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.372
NEC for r=0.9 class 0 = 0.596 +- 0.209 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 1 = 0.55 +- 0.209 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 2 = 0.472 +- 0.209 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all KL = 0.477 +- 0.209 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all L1 = 0.539 +- 0.141 (in-sample avg dev_std = 0.297)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:41:13 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:41:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ACCURACY: 0.9319
Train Loss: 0.3030
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3186
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3186
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.185
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.213
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.318
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.185141
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.226 +- 0.299 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.3 class 1 = 0.305 +- 0.299 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.3 class 2 = 0.544 +- 0.299 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.3 all KL = 0.321 +- 0.299 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.3 all L1 = 0.362 +- 0.238 (in-sample avg dev_std = 0.350)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2514583333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.314
SUFF_SIMPLE for r=0.6 class 0 = 0.254 +- 0.257 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 class 1 = 0.344 +- 0.257 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 class 2 = 0.426 +- 0.257 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 all KL = 0.314 +- 0.257 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.6 all L1 = 0.344 +- 0.188 (in-sample avg dev_std = 0.258)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2962156666666667
len(reference) = 2715
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.572
SUFF_SIMPLE for r=0.9 class 0 = 0.513 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.677 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.549 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.603 +- 0.383 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.58 +- 0.320 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21300999999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.298
SUFF_SIMPLE for r=0.3 class 0 = 0.319 +- 0.327 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.3 class 1 = 0.292 +- 0.327 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.3 class 2 = 0.584 +- 0.327 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.3 all KL = 0.332 +- 0.327 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.3 all L1 = 0.399 +- 0.205 (in-sample avg dev_std = 0.221)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.318424
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.322
SUFF_SIMPLE for r=0.6 class 0 = 0.338 +- 0.325 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.6 class 1 = 0.357 +- 0.325 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.6 class 2 = 0.579 +- 0.325 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.6 all KL = 0.379 +- 0.325 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.6 all L1 = 0.425 +- 0.214 (in-sample avg dev_std = 0.119)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3610393333333333
len(reference) = 2677
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.398
SUFF_SIMPLE for r=0.9 class 0 = 0.521 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.791 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.672 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.751 +- 0.264 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.664 +- 0.272 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.185141
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.39
NEC for r=0.3 class 0 = 0.696 +- 0.253 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 1 = 0.586 +- 0.253 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 2 = 0.587 +- 0.253 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all KL = 0.66 +- 0.253 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all L1 = 0.622 +- 0.188 (in-sample avg dev_std = 0.430)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2514583333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.402
NEC for r=0.6 class 0 = 0.701 +- 0.210 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.597 +- 0.210 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.588 +- 0.210 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.676 +- 0.210 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.627 +- 0.154 (in-sample avg dev_std = 0.510)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2962156666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.406
NEC for r=0.9 class 0 = 0.704 +- 0.196 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 1 = 0.606 +- 0.196 (in-sample avg dev_std = 0.528)
NEC for r=0.9 class 2 = 0.587 +- 0.196 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all KL = 0.683 +- 0.196 (in-sample avg dev_std = 0.528)
NEC for r=0.9 all L1 = 0.631 +- 0.142 (in-sample avg dev_std = 0.528)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21300999999999998
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.399
NEC for r=0.3 class 0 = 0.565 +- 0.259 (in-sample avg dev_std = 0.283)
NEC for r=0.3 class 1 = 0.386 +- 0.259 (in-sample avg dev_std = 0.283)
NEC for r=0.3 class 2 = 0.415 +- 0.259 (in-sample avg dev_std = 0.283)
NEC for r=0.3 all KL = 0.419 +- 0.259 (in-sample avg dev_std = 0.283)
NEC for r=0.3 all L1 = 0.456 +- 0.216 (in-sample avg dev_std = 0.283)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.318424
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.386
NEC for r=0.6 class 0 = 0.574 +- 0.250 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 1 = 0.396 +- 0.250 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 2 = 0.411 +- 0.250 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all KL = 0.427 +- 0.250 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all L1 = 0.461 +- 0.204 (in-sample avg dev_std = 0.334)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3610393333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.386
NEC for r=0.9 class 0 = 0.575 +- 0.241 (in-sample avg dev_std = 0.348)
NEC for r=0.9 class 1 = 0.4 +- 0.241 (in-sample avg dev_std = 0.348)
NEC for r=0.9 class 2 = 0.422 +- 0.241 (in-sample avg dev_std = 0.348)
NEC for r=0.9 all KL = 0.433 +- 0.241 (in-sample avg dev_std = 0.348)
NEC for r=0.9 all L1 = 0.466 +- 0.194 (in-sample avg dev_std = 0.348)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.28, 0.271, 0.546], 'all_L1': [0.362, 0.339, 0.55]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.336, 0.629], 'all_L1': [0.371, 0.354, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.309, 0.604], 'all_L1': [0.362, 0.347, 0.584]}), defaultdict(<class 'list'>, {'all_KL': [0.309, 0.32, 0.599], 'all_L1': [0.353, 0.351, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.317, 0.594], 'all_L1': [0.367, 0.354, 0.574]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.315, 0.584], 'all_L1': [0.361, 0.357, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.314, 0.317, 0.595], 'all_L1': [0.358, 0.35, 0.574]}), defaultdict(<class 'list'>, {'all_KL': [0.332, 0.337, 0.593], 'all_L1': [0.361, 0.353, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.321, 0.588], 'all_L1': [0.36, 0.351, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.321, 0.314, 0.603], 'all_L1': [0.362, 0.344, 0.58]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.702, 0.734, 0.737], 'all_L1': [0.627, 0.64, 0.64]}), defaultdict(<class 'list'>, {'all_KL': [0.638, 0.651, 0.657], 'all_L1': [0.612, 0.616, 0.62]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.674, 0.683], 'all_L1': [0.614, 0.622, 0.627]}), defaultdict(<class 'list'>, {'all_KL': [0.651, 0.67, 0.682], 'all_L1': [0.612, 0.618, 0.625]}), defaultdict(<class 'list'>, {'all_KL': [0.65, 0.668, 0.676], 'all_L1': [0.61, 0.617, 0.622]}), defaultdict(<class 'list'>, {'all_KL': [0.648, 0.656, 0.666], 'all_L1': [0.604, 0.604, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.671, 0.678], 'all_L1': [0.62, 0.623, 0.627]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.651, 0.657], 'all_L1': [0.614, 0.62, 0.624]}), defaultdict(<class 'list'>, {'all_KL': [0.649, 0.665, 0.673], 'all_L1': [0.614, 0.621, 0.625]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.676, 0.683], 'all_L1': [0.622, 0.627, 0.631]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.416, 0.423, 0.586], 'all_L1': [0.433, 0.432, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.349, 0.355, 0.635], 'all_L1': [0.396, 0.389, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.393, 0.746], 'all_L1': [0.373, 0.374, 0.635]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.457, 0.598], 'all_L1': [0.418, 0.421, 0.459]}), defaultdict(<class 'list'>, {'all_KL': [0.337, 0.367, 0.737], 'all_L1': [0.395, 0.419, 0.683]}), defaultdict(<class 'list'>, {'all_KL': [0.246, 0.266, 0.76], 'all_L1': [0.28, 0.299, 0.645]}), defaultdict(<class 'list'>, {'all_KL': [0.326, 0.352, 0.688], 'all_L1': [0.346, 0.363, 0.564]}), defaultdict(<class 'list'>, {'all_KL': [0.324, 0.382, 0.839], 'all_L1': [0.417, 0.453, 0.778]}), defaultdict(<class 'list'>, {'all_KL': [0.351, 0.362, 0.676], 'all_L1': [0.361, 0.364, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.332, 0.379, 0.751], 'all_L1': [0.399, 0.425, 0.664]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.473, 0.506, 0.507], 'all_L1': [0.503, 0.527, 0.525]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.481, 0.484], 'all_L1': [0.533, 0.529, 0.532]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.427, 0.431], 'all_L1': [0.501, 0.504, 0.508]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.443, 0.444], 'all_L1': [0.562, 0.565, 0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.447, 0.451], 'all_L1': [0.448, 0.449, 0.453]}), defaultdict(<class 'list'>, {'all_KL': [0.479, 0.48, 0.485], 'all_L1': [0.499, 0.499, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.463, 0.467], 'all_L1': [0.519, 0.525, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.353, 0.361], 'all_L1': [0.373, 0.367, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.469, 0.473, 0.477], 'all_L1': [0.533, 0.535, 0.539]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.427, 0.433], 'all_L1': [0.456, 0.461, 0.466]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.362 +- 0.005, 0.350 +- 0.005, 0.573 +- 0.011
suff_simple class all_KL  =  0.316 +- 0.015, 0.316 +- 0.017, 0.593 +- 0.020
[[0.3356666564941406, 0.3084999918937683, 0.5426356792449951], [0.3344166576862335, 0.3242500126361847, 0.5902547240257263], [0.33545833826065063, 0.3176249861717224, 0.5887988209724426], [0.3372916579246521, 0.32499998807907104, 0.5751754641532898], [0.3388749957084656, 0.3293333351612091, 0.576440155506134], [0.3400000035762787, 0.3308333456516266, 0.5578908324241638], [0.34299999475479126, 0.33529165387153625, 0.5763401389122009], [0.3409583270549774, 0.3230000138282776, 0.5576426982879639], [0.33912500739097595, 0.3311249911785126, 0.5641215443611145], [0.3357083201408386, 0.3136666715145111, 0.5720073580741882]]
[[0.28, 0.271, 0.546], [0.343, 0.336, 0.629], [0.313, 0.309, 0.604], [0.309, 0.32, 0.599], [0.32, 0.317, 0.594], [0.313, 0.315, 0.584], [0.314, 0.317, 0.595], [0.332, 0.337, 0.593], [0.315, 0.321, 0.588], [0.321, 0.314, 0.603]]
suff_simple_acc_int  =  0.338 +- 0.003, 0.324 +- 0.008, 0.570 +- 0.014
nec class all_L1  =  0.615 +- 0.006, 0.621 +- 0.009, 0.625 +- 0.007
nec class all_KL  =  0.655 +- 0.017, 0.672 +- 0.023, 0.679 +- 0.021
[[0.3791249990463257, 0.38199999928474426, 0.38629165291786194], [0.39941665530204773, 0.40691667795181274, 0.40579167008399963], [0.39804166555404663, 0.40575000643730164, 0.4046666622161865], [0.3998333215713501, 0.4086666703224182, 0.40554165840148926], [0.40283334255218506, 0.41225001215934753, 0.4086250066757202], [0.4157083332538605, 0.4244583249092102, 0.4156666696071625], [0.4009583294391632, 0.4101666808128357, 0.41070833802223206], [0.38874998688697815, 0.40154168009757996, 0.3961249887943268], [0.4104583263397217, 0.41333332657814026, 0.4086250066757202], [0.3895833194255829, 0.40183332562446594, 0.40625]]
[[0.702, 0.734, 0.737], [0.638, 0.651, 0.657], [0.656, 0.674, 0.683], [0.651, 0.67, 0.682], [0.65, 0.668, 0.676], [0.648, 0.656, 0.666], [0.658, 0.671, 0.678], [0.637, 0.651, 0.657], [0.649, 0.665, 0.673], [0.66, 0.676, 0.683]]
nec_acc_int  =  0.398 +- 0.010, 0.407 +- 0.010, 0.405 +- 0.008

Eval split val
suff_simple class all_L1  =  0.382 +- 0.042, 0.394 +- 0.043, 0.604 +- 0.089
suff_simple class all_KL  =  0.351 +- 0.053, 0.374 +- 0.047, 0.702 +- 0.076
[[0.30149999260902405, 0.27900001406669617, 0.41502416133880615], [0.29737499356269836, 0.29470834136009216, 0.3714505136013031], [0.32374998927116394, 0.31845831871032715, 0.37360092997550964], [0.3317916691303253, 0.3255000114440918, 0.39362913370132446], [0.29620832204818726, 0.3097083270549774, 0.3826974034309387], [0.32608333230018616, 0.33016666769981384, 0.36844122409820557], [0.3034583330154419, 0.289249986410141, 0.4045158922672272], [0.30408334732055664, 0.2874166667461395, 0.373236745595932], [0.3233333230018616, 0.32237499952316284, 0.38198402523994446], [0.2982083261013031, 0.3217916786670685, 0.3978334069252014]]
[[0.416, 0.423, 0.586], [0.349, 0.355, 0.635], [0.386, 0.393, 0.746], [0.447, 0.457, 0.598], [0.337, 0.367, 0.737], [0.246, 0.266, 0.76], [0.326, 0.352, 0.688], [0.324, 0.382, 0.839], [0.351, 0.362, 0.676], [0.332, 0.379, 0.751]]
suff_simple_acc_int  =  0.311 +- 0.013, 0.308 +- 0.018, 0.386 +- 0.015
nec class all_L1  =  0.493 +- 0.052, 0.496 +- 0.054, 0.499 +- 0.053
nec class all_KL  =  0.443 +- 0.036, 0.450 +- 0.040, 0.454 +- 0.039
[[0.3545416593551636, 0.32491666078567505, 0.32587501406669617], [0.4059583246707916, 0.3815000057220459, 0.3956249952316284], [0.4024583399295807, 0.3864166736602783, 0.3956666588783264], [0.36541667580604553, 0.3616666793823242, 0.36649999022483826], [0.3644583225250244, 0.3465416729450226, 0.35225000977516174], [0.3306249976158142, 0.3226250112056732, 0.3283750116825104], [0.4150833189487457, 0.40450000762939453, 0.4099583327770233], [0.3876666724681854, 0.3816666603088379, 0.38237500190734863], [0.36779165267944336, 0.36795833706855774, 0.37187498807907104], [0.398583322763443, 0.3857083320617676, 0.3855000138282776]]
[[0.473, 0.506, 0.507], [0.483, 0.481, 0.484], [0.422, 0.427, 0.431], [0.437, 0.443, 0.444], [0.439, 0.447, 0.451], [0.479, 0.48, 0.485], [0.454, 0.463, 0.467], [0.357, 0.353, 0.361], [0.469, 0.473, 0.477], [0.419, 0.427, 0.433]]
nec_acc_int  =  0.379 +- 0.025, 0.366 +- 0.026, 0.371 +- 0.027


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.488 +- 0.004, 0.485 +- 0.002, 0.599 +- 0.006
Faith. Armon (L1)= 		  =  0.455 +- 0.004, 0.448 +- 0.002, 0.598 +- 0.006
Faith. GMean (L1)= 	  =  0.472 +- 0.004, 0.466 +- 0.001, 0.599 +- 0.006
Faith. Aritm (KL)= 		  =  0.485 +- 0.004, 0.494 +- 0.004, 0.636 +- 0.007
Faith. Armon (KL)= 		  =  0.426 +- 0.011, 0.429 +- 0.013, 0.633 +- 0.007
Faith. GMean (KL)= 	  =  0.455 +- 0.007, 0.460 +- 0.006, 0.635 +- 0.007

Eval split val
Faith. Aritm (L1)= 		  =  0.437 +- 0.030, 0.445 +- 0.027, 0.552 +- 0.022
Faith. Armon (L1)= 		  =  0.427 +- 0.033, 0.435 +- 0.030, 0.538 +- 0.020
Faith. GMean (L1)= 	  =  0.432 +- 0.031, 0.440 +- 0.028, 0.545 +- 0.018
Faith. Aritm (KL)= 		  =  0.397 +- 0.031, 0.412 +- 0.028, 0.578 +- 0.028
Faith. Armon (KL)= 		  =  0.389 +- 0.036, 0.405 +- 0.033, 0.547 +- 0.024
Faith. GMean (KL)= 	  =  0.393 +- 0.034, 0.408 +- 0.030, 0.562 +- 0.022
Computed for split load_split = id



Completed in  0:21:54.453414  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GSAT GOODMotif/basis/covariate NEC_ALPHA 0.1 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:43:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:43:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9243 0.9243 0.9243 0.9243 0.9267 0.9267[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.216 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 class 2 = 0.688 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 all KL = 0.297 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 all L1 = 0.397 +- 0.310 (in-sample avg dev_std = 0.503)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.33
SUFF_SIMPLE for r=0.6 class 0 = 0.22 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 class 1 = 0.202 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 class 2 = 0.817 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 all KL = 0.343 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 all L1 = 0.42 +- 0.356 (in-sample avg dev_std = 0.270)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.278
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.278 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.28 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.306 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.374 +- 0.342 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
SUFF_SIMPLE for r=0.3 class 0 = 0.204 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 1 = 0.196 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 2 = 0.942 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all KL = 0.374 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.391 (in-sample avg dev_std = 0.058)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.204 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 class 1 = 0.195 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 class 2 = 0.943 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all KL = 0.374 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all L1 = 0.448 +- 0.391 (in-sample avg dev_std = 0.020)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.318
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.195 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.492 +- 0.388 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.633
NEC for r=0.3 class 0 = 0.64 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 1 = 0.203 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 2 = 0.187 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all KL = 0.411 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all L1 = 0.337 +- 0.330 (in-sample avg dev_std = 0.538)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.546
NEC for r=0.6 class 0 = 0.687 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 class 1 = 0.28 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 class 2 = 0.359 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 all KL = 0.532 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 all L1 = 0.438 +- 0.311 (in-sample avg dev_std = 0.629)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.419
NEC for r=0.9 class 0 = 0.743 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 1 = 0.457 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 2 = 0.515 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all KL = 0.686 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all L1 = 0.568 +- 0.257 (in-sample avg dev_std = 0.685)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.609
NEC for r=0.3 class 0 = 0.772 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 class 1 = 0.134 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 class 2 = 0.038 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 all KL = 0.349 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 all L1 = 0.316 +- 0.390 (in-sample avg dev_std = 0.110)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.767 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.18 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.181 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.432 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.377 +- 0.373 (in-sample avg dev_std = 0.390)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.357
NEC for r=0.9 class 0 = 0.691 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 class 1 = 0.578 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 class 2 = 0.483 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 all KL = 0.714 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 all L1 = 0.585 +- 0.192 (in-sample avg dev_std = 0.775)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:44:39 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:44:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.9267 0.9267 0.9267 0.9273 0.9273[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
SUFF_SIMPLE for r=0.3 class 0 = 0.266 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 class 1 = 0.255 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 class 2 = 0.614 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 all KL = 0.279 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.294 (in-sample avg dev_std = 0.527)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.317
SUFF_SIMPLE for r=0.6 class 0 = 0.282 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 all KL = 0.326 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 all L1 = 0.409 +- 0.349 (in-sample avg dev_std = 0.309)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.295
SUFF_SIMPLE for r=0.9 class 0 = 0.781 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.231 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.325 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.212 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 1 = 0.196 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 2 = 0.944 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all KL = 0.382 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all L1 = 0.451 +- 0.392 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.212 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.196 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.944 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.382 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.451 +- 0.392 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.239 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.185 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.344 +- 0.292 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.672
NEC for r=0.3 class 0 = 0.565 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.139 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.221 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.366 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.303 +- 0.308 (in-sample avg dev_std = 0.508)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.573
NEC for r=0.6 class 0 = 0.63 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 class 1 = 0.232 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 class 2 = 0.403 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 all KL = 0.505 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 all L1 = 0.418 +- 0.304 (in-sample avg dev_std = 0.597)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.428
NEC for r=0.9 class 0 = 0.7 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 class 1 = 0.46 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 class 2 = 0.567 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 all KL = 0.697 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 all L1 = 0.573 +- 0.242 (in-sample avg dev_std = 0.712)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.57
NEC for r=0.3 class 0 = 0.755 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 1 = 0.242 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 2 = 0.038 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all KL = 0.379 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all L1 = 0.346 +- 0.380 (in-sample avg dev_std = 0.144)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.524
NEC for r=0.6 class 0 = 0.772 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 class 1 = 0.269 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 class 2 = 0.19 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 all KL = 0.467 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 all L1 = 0.411 +- 0.364 (in-sample avg dev_std = 0.367)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.372
NEC for r=0.9 class 0 = 0.779 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 class 1 = 0.613 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 class 2 = 0.444 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 all KL = 0.729 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 all L1 = 0.612 +- 0.215 (in-sample avg dev_std = 0.658)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:46:27 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:46:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9287 0.9287[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.332
SUFF_SIMPLE for r=0.3 class 0 = 0.232 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 class 1 = 0.234 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 class 2 = 0.699 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 all KL = 0.287 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 all L1 = 0.394 +- 0.319 (in-sample avg dev_std = 0.488)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.331
SUFF_SIMPLE for r=0.6 class 0 = 0.237 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 class 1 = 0.192 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 class 2 = 0.785 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 all KL = 0.33 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 all L1 = 0.412 +- 0.354 (in-sample avg dev_std = 0.291)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF_SIMPLE for r=0.9 class 0 = 0.699 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.263 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.384 +- 0.355 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.368 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 1 = 0.286 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 2 = 0.951 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all KL = 0.483 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all L1 = 0.536 +- 0.408 (in-sample avg dev_std = 0.002)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.368 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.286 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.949 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.483 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.535 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 0 = 0.832 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.339 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.553 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.474 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.518 +- 0.386 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.628
NEC for r=0.3 class 0 = 0.614 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 class 1 = 0.218 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 class 2 = 0.214 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 all KL = 0.42 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 all L1 = 0.343 +- 0.341 (in-sample avg dev_std = 0.520)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.547
NEC for r=0.6 class 0 = 0.682 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 class 1 = 0.288 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 class 2 = 0.373 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 all KL = 0.55 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 all L1 = 0.443 +- 0.319 (in-sample avg dev_std = 0.641)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.421
NEC for r=0.9 class 0 = 0.732 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 class 1 = 0.473 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 class 2 = 0.527 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 all KL = 0.708 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 all L1 = 0.575 +- 0.262 (in-sample avg dev_std = 0.699)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.628 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 1 = 0.692 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 2 = 0.047 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.51 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.455 +- 0.403 (in-sample avg dev_std = 0.146)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
NEC for r=0.6 class 0 = 0.634 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 1 = 0.645 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 2 = 0.2 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all KL = 0.576 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all L1 = 0.493 +- 0.359 (in-sample avg dev_std = 0.488)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.301
NEC for r=0.9 class 0 = 0.646 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 1 = 0.693 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 2 = 0.386 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all KL = 0.684 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all L1 = 0.575 +- 0.295 (in-sample avg dev_std = 0.577)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:48:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:48:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9250 0.9250[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.222 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 1 = 0.711 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 2 = 0.241 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all KL = 0.286 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all L1 = 0.392 +- 0.301 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.211 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 class 1 = 0.724 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 class 2 = 0.255 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 all KL = 0.311 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 all L1 = 0.398 +- 0.335 (in-sample avg dev_std = 0.356)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.47 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.245 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.354 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.285 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.352 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.431
SUFF_SIMPLE for r=0.3 class 0 = 0.191 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 class 1 = 0.877 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 class 2 = 0.21 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 all KL = 0.355 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 all L1 = 0.424 +- 0.365 (in-sample avg dev_std = 0.165)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.351
SUFF_SIMPLE for r=0.6 class 0 = 0.192 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 1 = 0.921 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 2 = 0.203 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.371 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.437 +- 0.378 (in-sample avg dev_std = 0.004)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.742 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.561 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.363 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.518
NEC for r=0.3 class 0 = 0.644 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 1 = 0.056 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 2 = 0.65 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all KL = 0.529 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all L1 = 0.449 +- 0.349 (in-sample avg dev_std = 0.506)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.486
NEC for r=0.6 class 0 = 0.686 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 1 = 0.124 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 2 = 0.667 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all KL = 0.59 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all L1 = 0.491 +- 0.326 (in-sample avg dev_std = 0.586)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.401
NEC for r=0.9 class 0 = 0.722 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 class 1 = 0.38 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 class 2 = 0.7 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 all KL = 0.726 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 all L1 = 0.6 +- 0.240 (in-sample avg dev_std = 0.711)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.354
NEC for r=0.3 class 0 = 0.806 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 class 1 = 0.056 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 class 2 = 0.797 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 all KL = 0.627 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 all L1 = 0.555 +- 0.389 (in-sample avg dev_std = 0.053)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.341
NEC for r=0.6 class 0 = 0.81 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 1 = 0.099 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 2 = 0.8 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.65 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.572 +- 0.375 (in-sample avg dev_std = 0.169)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.292
NEC for r=0.9 class 0 = 0.784 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 class 1 = 0.544 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 class 2 = 0.769 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 all KL = 0.829 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 all L1 = 0.7 +- 0.156 (in-sample avg dev_std = 0.651)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:51:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:51:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF_SIMPLE for r=0.3 class 0 = 0.231 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 class 1 = 0.667 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 class 2 = 0.253 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 all KL = 0.278 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 all L1 = 0.385 +- 0.290 (in-sample avg dev_std = 0.557)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.309
SUFF_SIMPLE for r=0.6 class 0 = 0.217 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 class 1 = 0.697 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 class 2 = 0.272 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 all KL = 0.316 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 all L1 = 0.397 +- 0.326 (in-sample avg dev_std = 0.359)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.263
SUFF_SIMPLE for r=0.9 class 0 = 0.518 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.339 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.297 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.358 +- 0.315 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.431
SUFF_SIMPLE for r=0.3 class 0 = 0.188 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 class 1 = 0.879 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 class 2 = 0.208 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 all KL = 0.357 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 all L1 = 0.423 +- 0.366 (in-sample avg dev_std = 0.152)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.352
SUFF_SIMPLE for r=0.6 class 0 = 0.187 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 1 = 0.902 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 2 = 0.199 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.368 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.427 +- 0.371 (in-sample avg dev_std = 0.004)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.898 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.193 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.735 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.380 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.522
NEC for r=0.3 class 0 = 0.625 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 1 = 0.065 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 2 = 0.656 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all KL = 0.526 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all L1 = 0.448 +- 0.345 (in-sample avg dev_std = 0.516)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.498
NEC for r=0.6 class 0 = 0.663 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 1 = 0.135 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 2 = 0.668 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all KL = 0.582 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all L1 = 0.488 +- 0.320 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.4
NEC for r=0.9 class 0 = 0.709 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 1 = 0.418 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 2 = 0.709 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all KL = 0.742 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all L1 = 0.612 +- 0.220 (in-sample avg dev_std = 0.733)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.812 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 class 1 = 0.084 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 class 2 = 0.805 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 all KL = 0.636 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 all L1 = 0.569 +- 0.380 (in-sample avg dev_std = 0.038)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.34
NEC for r=0.6 class 0 = 0.815 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 1 = 0.129 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 2 = 0.807 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.659 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.166)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.292
NEC for r=0.9 class 0 = 0.782 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 1 = 0.57 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 2 = 0.765 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all KL = 0.835 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all L1 = 0.706 +- 0.143 (in-sample avg dev_std = 0.667)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:53:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:53:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9280 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.329 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 class 1 = 0.562 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 class 2 = 0.216 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 all KL = 0.278 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 all L1 = 0.368 +- 0.249 (in-sample avg dev_std = 0.539)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.337
SUFF_SIMPLE for r=0.6 class 0 = 0.591 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 1 = 0.373 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 2 = 0.272 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all KL = 0.344 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all L1 = 0.408 +- 0.323 (in-sample avg dev_std = 0.327)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.286
SUFF_SIMPLE for r=0.9 class 0 = 0.787 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.328 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.350 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
SUFF_SIMPLE for r=0.3 class 0 = 0.823 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 class 1 = 0.294 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 class 2 = 0.633 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 all KL = 0.582 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 all L1 = 0.585 +- 0.356 (in-sample avg dev_std = 0.142)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.341
SUFF_SIMPLE for r=0.6 class 0 = 0.746 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 1 = 0.207 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 2 = 0.539 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.485 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.499 +- 0.359 (in-sample avg dev_std = 0.004)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.197 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.475 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.386 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.436 +- 0.360 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.674
NEC for r=0.3 class 0 = 0.599 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 class 1 = 0.037 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 class 2 = 0.311 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 all KL = 0.375 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 all L1 = 0.312 +- 0.322 (in-sample avg dev_std = 0.526)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.541
NEC for r=0.6 class 0 = 0.652 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 1 = 0.16 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 2 = 0.537 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all KL = 0.539 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all L1 = 0.447 +- 0.314 (in-sample avg dev_std = 0.631)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.416
NEC for r=0.9 class 0 = 0.688 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 class 1 = 0.414 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 class 2 = 0.664 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 all KL = 0.705 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 all L1 = 0.588 +- 0.237 (in-sample avg dev_std = 0.713)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.824
NEC for r=0.3 class 0 = 0.67 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 1 = 0.026 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 2 = 0.029 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all KL = 0.266 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all L1 = 0.243 +- 0.349 (in-sample avg dev_std = 0.261)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.715
NEC for r=0.6 class 0 = 0.727 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.077 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.178 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.377 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.329 +- 0.366 (in-sample avg dev_std = 0.383)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.38
NEC for r=0.9 class 0 = 0.669 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 class 1 = 0.561 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 class 2 = 0.61 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 all KL = 0.742 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 all L1 = 0.614 +- 0.146 (in-sample avg dev_std = 0.802)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:56:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:56:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.247 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 1 = 0.268 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 2 = 0.613 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all KL = 0.276 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all L1 = 0.38 +- 0.293 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF_SIMPLE for r=0.6 class 0 = 0.269 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 class 2 = 0.741 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 all KL = 0.338 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 all L1 = 0.409 +- 0.326 (in-sample avg dev_std = 0.326)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.289
SUFF_SIMPLE for r=0.9 class 0 = 0.795 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.241 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.325 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.517 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 1 = 0.202 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 2 = 0.957 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all KL = 0.533 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all L1 = 0.56 +- 0.392 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.518 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.202 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.952 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.559 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.074
SUFF_SIMPLE for r=0.9 class 0 = 0.81 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.182 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.269 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.252 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.328 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.654
NEC for r=0.3 class 0 = 0.639 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.043 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.28 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.379 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.316 +- 0.332 (in-sample avg dev_std = 0.508)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.535
NEC for r=0.6 class 0 = 0.677 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 class 1 = 0.211 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 class 2 = 0.477 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 all KL = 0.547 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 all L1 = 0.452 +- 0.317 (in-sample avg dev_std = 0.622)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.402
NEC for r=0.9 class 0 = 0.725 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 class 1 = 0.446 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 class 2 = 0.609 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 all KL = 0.713 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 all L1 = 0.592 +- 0.249 (in-sample avg dev_std = 0.689)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0 = 0.405 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 class 1 = 0.025 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 class 2 = 0.014 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all KL = 0.13 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all L1 = 0.149 +- 0.270 (in-sample avg dev_std = 0.074)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0 = 0.535 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 class 1 = 0.099 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 class 2 = 0.175 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 all KL = 0.305 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 all L1 = 0.271 +- 0.319 (in-sample avg dev_std = 0.432)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.33
NEC for r=0.9 class 0 = 0.669 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 1 = 0.579 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 2 = 0.585 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all KL = 0.742 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all L1 = 0.611 +- 0.165 (in-sample avg dev_std = 0.774)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:58:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:58:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.9253 0.9253 0.9253 0.9260 0.9260[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.27 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 class 1 = 0.704 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 class 2 = 0.199 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 all KL = 0.293 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 all L1 = 0.391 +- 0.296 (in-sample avg dev_std = 0.499)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.434
SUFF_SIMPLE for r=0.6 class 0 = 0.503 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 1 = 0.61 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 2 = 0.256 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all KL = 0.415 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all L1 = 0.454 +- 0.314 (in-sample avg dev_std = 0.327)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.261
SUFF_SIMPLE for r=0.9 class 0 = 0.76 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.205 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.375 +- 0.343 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.489
SUFF_SIMPLE for r=0.3 class 0 = 0.586 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 class 1 = 0.823 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 class 2 = 0.21 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 all KL = 0.506 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 all L1 = 0.539 +- 0.336 (in-sample avg dev_std = 0.316)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.376
SUFF_SIMPLE for r=0.6 class 0 = 0.467 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 class 1 = 0.659 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 class 2 = 0.201 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 all KL = 0.413 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 all L1 = 0.441 +- 0.330 (in-sample avg dev_std = 0.046)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.047
SUFF_SIMPLE for r=0.9 class 0 = 0.269 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.101 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.196 +- 0.097 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0 = 0.632 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 class 1 = 0.046 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 class 2 = 0.439 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 all KL = 0.439 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 all L1 = 0.369 +- 0.343 (in-sample avg dev_std = 0.522)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0 = 0.656 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 1 = 0.174 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 2 = 0.598 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all KL = 0.568 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all L1 = 0.475 +- 0.315 (in-sample avg dev_std = 0.617)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.399
NEC for r=0.9 class 0 = 0.668 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 1 = 0.415 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 2 = 0.722 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all KL = 0.718 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all L1 = 0.602 +- 0.238 (in-sample avg dev_std = 0.704)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.677
NEC for r=0.3 class 0 = 0.64 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 1 = 0.027 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 2 = 0.082 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all KL = 0.283 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all L1 = 0.251 +- 0.335 (in-sample avg dev_std = 0.354)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.697 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 1 = 0.083 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 2 = 0.413 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all KL = 0.476 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all L1 = 0.399 +- 0.329 (in-sample avg dev_std = 0.551)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.684 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 class 1 = 0.534 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 class 2 = 0.723 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 all KL = 0.776 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 all L1 = 0.648 +- 0.155 (in-sample avg dev_std = 0.770)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:59:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:59:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9277 0.9277[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.348
SUFF_SIMPLE for r=0.3 class 0 = 0.253 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 class 1 = 0.356 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 class 2 = 0.395 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 all KL = 0.247 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.156 (in-sample avg dev_std = 0.514)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.339
SUFF_SIMPLE for r=0.6 class 0 = 0.257 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 class 1 = 0.359 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 class 2 = 0.445 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 all KL = 0.296 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 all L1 = 0.356 +- 0.197 (in-sample avg dev_std = 0.320)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.347
SUFF_SIMPLE for r=0.9 class 0 = 0.754 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.327 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.226 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.359 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.415 +- 0.349 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.418
SUFF_SIMPLE for r=0.3 class 0 = 0.197 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 class 1 = 0.332 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 class 2 = 0.762 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 all KL = 0.373 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 all L1 = 0.431 +- 0.326 (in-sample avg dev_std = 0.050)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF_SIMPLE for r=0.6 class 0 = 0.199 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.264 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.777 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.346 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.414 +- 0.343 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.253
SUFF_SIMPLE for r=0.9 class 0 = 0.204 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.438 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.643
NEC for r=0.3 class 0 = 0.54 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 class 1 = 0.204 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 class 2 = 0.337 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 all KL = 0.418 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 all L1 = 0.357 +- 0.284 (in-sample avg dev_std = 0.515)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.552
NEC for r=0.6 class 0 = 0.602 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 class 1 = 0.292 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 class 2 = 0.437 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 all KL = 0.531 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 all L1 = 0.441 +- 0.285 (in-sample avg dev_std = 0.601)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.407
NEC for r=0.9 class 0 = 0.682 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.54 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.575 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.727 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.597 +- 0.205 (in-sample avg dev_std = 0.715)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.525
NEC for r=0.3 class 0 = 0.796 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 1 = 0.618 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 2 = 0.267 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all KL = 0.61 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all L1 = 0.561 +- 0.305 (in-sample avg dev_std = 0.217)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.477
NEC for r=0.6 class 0 = 0.803 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.597 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.345 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.647 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.582 +- 0.312 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.809
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.338
NEC for r=0.9 class 0 = 0.806 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 class 1 = 0.76 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 class 2 = 0.467 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 all KL = 0.787 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 all L1 = 0.678 +- 0.224 (in-sample avg dev_std = 0.480)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:01:39 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:01:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.235 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 class 1 = 0.407 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 class 2 = 0.394 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 all KL = 0.279 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 all L1 = 0.348 +- 0.184 (in-sample avg dev_std = 0.506)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.235 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 class 1 = 0.263 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 class 2 = 0.649 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 all KL = 0.317 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 all L1 = 0.387 +- 0.313 (in-sample avg dev_std = 0.303)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.229
SUFF_SIMPLE for r=0.9 class 0 = 0.556 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.228 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.284 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.267 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.345 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
SUFF_SIMPLE for r=0.3 class 0 = 0.205 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 class 1 = 0.371 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 class 2 = 0.854 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 all KL = 0.435 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 all L1 = 0.477 +- 0.356 (in-sample avg dev_std = 0.119)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.365
SUFF_SIMPLE for r=0.6 class 0 = 0.203 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.237 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.947 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.397 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.463 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.038
SUFF_SIMPLE for r=0.9 class 0 = 0.324 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.172 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.131 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.208 +- 0.076 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.695
NEC for r=0.3 class 0 = 0.554 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 1 = 0.149 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 2 = 0.23 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all KL = 0.343 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all L1 = 0.307 +- 0.294 (in-sample avg dev_std = 0.470)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.583
NEC for r=0.6 class 0 = 0.62 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 class 1 = 0.237 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 class 2 = 0.414 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 all KL = 0.486 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 all L1 = 0.421 +- 0.286 (in-sample avg dev_std = 0.572)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.429
NEC for r=0.9 class 0 = 0.689 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 class 1 = 0.476 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 class 2 = 0.57 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 all KL = 0.686 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 all L1 = 0.577 +- 0.220 (in-sample avg dev_std = 0.694)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.632
NEC for r=0.3 class 0 = 0.78 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 class 1 = 0.398 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 class 2 = 0.043 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all KL = 0.404 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all L1 = 0.408 +- 0.340 (in-sample avg dev_std = 0.045)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.58
NEC for r=0.6 class 0 = 0.788 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 1 = 0.368 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 2 = 0.182 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all KL = 0.468 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all L1 = 0.447 +- 0.326 (in-sample avg dev_std = 0.313)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.375
NEC for r=0.9 class 0 = 0.799 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 class 1 = 0.645 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 class 2 = 0.47 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 all KL = 0.74 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 all L1 = 0.638 +- 0.193 (in-sample avg dev_std = 0.593)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.297, 0.343, 0.306], 'all_L1': [0.397, 0.42, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.326, 0.325], 'all_L1': [0.383, 0.409, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.287, 0.33, 0.308], 'all_L1': [0.394, 0.412, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.286, 0.311, 0.285], 'all_L1': [0.392, 0.398, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.316, 0.297], 'all_L1': [0.385, 0.397, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.344, 0.328], 'all_L1': [0.368, 0.408, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.338, 0.325], 'all_L1': [0.38, 0.409, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.415, 0.308], 'all_L1': [0.391, 0.454, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.296, 0.359], 'all_L1': [0.337, 0.356, 0.415]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.317, 0.267], 'all_L1': [0.348, 0.387, 0.345]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.411, 0.532, 0.686], 'all_L1': [0.337, 0.438, 0.568]}), defaultdict(<class 'list'>, {'all_KL': [0.366, 0.505, 0.697], 'all_L1': [0.303, 0.418, 0.573]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.55, 0.708], 'all_L1': [0.343, 0.443, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.529, 0.59, 0.726], 'all_L1': [0.449, 0.491, 0.6]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.582, 0.742], 'all_L1': [0.448, 0.488, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.539, 0.705], 'all_L1': [0.312, 0.447, 0.588]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.547, 0.713], 'all_L1': [0.316, 0.452, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.568, 0.718], 'all_L1': [0.369, 0.475, 0.602]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.531, 0.727], 'all_L1': [0.357, 0.441, 0.597]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.486, 0.686], 'all_L1': [0.307, 0.421, 0.577]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.374, 0.374, 0.444], 'all_L1': [0.448, 0.448, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.382, 0.283], 'all_L1': [0.451, 0.451, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.483, 0.474], 'all_L1': [0.536, 0.535, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.371, 0.561], 'all_L1': [0.424, 0.437, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.368, 0.542], 'all_L1': [0.423, 0.427, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.485, 0.386], 'all_L1': [0.585, 0.499, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.533, 0.252], 'all_L1': [0.56, 0.559, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.506, 0.413, 0.101], 'all_L1': [0.539, 0.441, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.346, 0.246], 'all_L1': [0.431, 0.414, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.397, 0.131], 'all_L1': [0.477, 0.463, 0.208]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.349, 0.432, 0.714], 'all_L1': [0.316, 0.377, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.467, 0.729], 'all_L1': [0.346, 0.411, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.576, 0.684], 'all_L1': [0.455, 0.493, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.627, 0.65, 0.829], 'all_L1': [0.555, 0.572, 0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.659, 0.835], 'all_L1': [0.569, 0.586, 0.706]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.377, 0.742], 'all_L1': [0.243, 0.329, 0.614]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.305, 0.742], 'all_L1': [0.149, 0.271, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.476, 0.776], 'all_L1': [0.251, 0.399, 0.648]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.647, 0.787], 'all_L1': [0.561, 0.582, 0.678]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.468, 0.74], 'all_L1': [0.408, 0.447, 0.638]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.378 +- 0.019, 0.405 +- 0.024, 0.377 +- 0.020
suff_simple class all_KL  =  0.280 +- 0.013, 0.334 +- 0.031, 0.311 +- 0.024
[[0.33404165506362915, 0.3304166793823242, 0.2775685787200928], [0.3256250023841858, 0.31712499260902405, 0.295320063829422], [0.3322083353996277, 0.3307083249092102, 0.2840236723423004], [0.3452083468437195, 0.31158334016799927, 0.2393760085105896], [0.3461666703224182, 0.3086250126361847, 0.26304465532302856], [0.33691665530204773, 0.3374166786670685, 0.28563743829727173], [0.3295416533946991, 0.34033334255218506, 0.28886497020721436], [0.3372499942779541, 0.4339166581630707, 0.26143088936805725], [0.3475416600704193, 0.33924999833106995, 0.34749865531921387], [0.3401666581630707, 0.3113749921321869, 0.22861753404140472]]
[[0.297, 0.343, 0.306], [0.279, 0.326, 0.325], [0.287, 0.33, 0.308], [0.286, 0.311, 0.285], [0.278, 0.316, 0.297], [0.278, 0.344, 0.328], [0.276, 0.338, 0.325], [0.293, 0.415, 0.308], [0.247, 0.296, 0.359], [0.279, 0.317, 0.267]]
suff_simple_acc_int  =  0.337 +- 0.007, 0.336 +- 0.035, 0.277 +- 0.031
nec class all_L1  =  0.354 +- 0.052, 0.451 +- 0.024, 0.588 +- 0.014
nec class all_KL  =  0.421 +- 0.060, 0.543 +- 0.031, 0.711 +- 0.017
[[0.6331666707992554, 0.5460833311080933, 0.4192083477973938], [0.6724583506584167, 0.5725833177566528, 0.42762500047683716], [0.628250002861023, 0.546708345413208, 0.4205000102519989], [0.5180000066757202, 0.48616665601730347, 0.4010416567325592], [0.5218333601951599, 0.4984583258628845, 0.3996250033378601], [0.6736666560173035, 0.5411666631698608, 0.41624999046325684], [0.6538333296775818, 0.5350000262260437, 0.4020416736602783], [0.5994166731834412, 0.5134583115577698, 0.39933332800865173], [0.6428333520889282, 0.5521249771118164, 0.40712499618530273], [0.6946666836738586, 0.5833749771118164, 0.4294166564941406]]
[[0.411, 0.532, 0.686], [0.366, 0.505, 0.697], [0.42, 0.55, 0.708], [0.529, 0.59, 0.726], [0.526, 0.582, 0.742], [0.375, 0.539, 0.705], [0.379, 0.547, 0.713], [0.439, 0.568, 0.718], [0.418, 0.531, 0.727], [0.343, 0.486, 0.686]]
nec_acc_int  =  0.624 +- 0.058, 0.538 +- 0.029, 0.412 +- 0.011

Eval split val
suff_simple class all_L1  =  0.487 +- 0.058, 0.467 +- 0.046, 0.393 +- 0.130
suff_simple class all_KL  =  0.438 +- 0.078, 0.415 +- 0.060, 0.342 +- 0.155
[[0.3334166705608368, 0.33404165506362915, 0.3183828294277191], [0.33399999141693115, 0.33399999141693115, 0.23878711462020874], [0.33399999141693115, 0.33399999141693115, 0.25457990169525146], [0.43058332800865173, 0.351416677236557, 0.21920403838157654], [0.4312083423137665, 0.3517916798591614, 0.1711939424276352], [0.3800833225250244, 0.3409999907016754, 0.19835755228996277], [0.33399999141693115, 0.33399999141693115, 0.07391029596328735], [0.48904165625572205, 0.37562501430511475, 0.04737839475274086], [0.4177500009536743, 0.34033334255218506, 0.2533164918422699], [0.4336250126361847, 0.36500000953674316, 0.03790271654725075]]
[[0.374, 0.374, 0.444], [0.382, 0.382, 0.283], [0.483, 0.483, 0.474], [0.355, 0.371, 0.561], [0.357, 0.368, 0.542], [0.582, 0.485, 0.386], [0.533, 0.533, 0.252], [0.506, 0.413, 0.101], [0.373, 0.346, 0.246], [0.435, 0.397, 0.131]]
suff_simple_acc_int  =  0.392 +- 0.053, 0.346 +- 0.014, 0.181 +- 0.092
nec class all_L1  =  0.385 +- 0.141, 0.447 +- 0.104, 0.637 +- 0.043
nec class all_KL  =  0.419 +- 0.163, 0.506 +- 0.116, 0.758 +- 0.046
[[0.609208345413208, 0.559416651725769, 0.3566666543483734], [0.5699583292007446, 0.5244583487510681, 0.3722083270549774], [0.3435416519641876, 0.35466668009757996, 0.30133333802223206], [0.3544583320617676, 0.3413333296775818, 0.29241666197776794], [0.3556666672229767, 0.34033334255218506, 0.29249998927116394], [0.8239583373069763, 0.7148333191871643, 0.3804166615009308], [0.6442916393280029, 0.5766666531562805, 0.33024999499320984], [0.6767083406448364, 0.5586666464805603, 0.35754168033599854], [0.5245416760444641, 0.47725000977516174, 0.33783334493637085], [0.6324999928474426, 0.5803750157356262, 0.3752083480358124]]
[[0.349, 0.432, 0.714], [0.379, 0.467, 0.729], [0.51, 0.576, 0.684], [0.627, 0.65, 0.829], [0.636, 0.659, 0.835], [0.266, 0.377, 0.742], [0.13, 0.305, 0.742], [0.283, 0.476, 0.776], [0.61, 0.647, 0.787], [0.404, 0.468, 0.74]]
nec_acc_int  =  0.553 +- 0.152, 0.503 +- 0.118, 0.340 +- 0.033


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.366 +- 0.030, 0.428 +- 0.019, 0.483 +- 0.012
Faith. Armon (L1)= 		  =  0.364 +- 0.030, 0.426 +- 0.019, 0.459 +- 0.015
Faith. GMean (L1)= 	  =  0.365 +- 0.030, 0.427 +- 0.019, 0.471 +- 0.013
Faith. Aritm (KL)= 		  =  0.350 +- 0.032, 0.438 +- 0.024, 0.511 +- 0.016
Faith. Armon (KL)= 		  =  0.335 +- 0.022, 0.412 +- 0.026, 0.432 +- 0.024
Faith. GMean (KL)= 	  =  0.342 +- 0.026, 0.425 +- 0.024, 0.470 +- 0.020

Eval split val
Faith. Aritm (L1)= 		  =  0.436 +- 0.052, 0.457 +- 0.042, 0.515 +- 0.070
Faith. Armon (L1)= 		  =  0.407 +- 0.081, 0.446 +- 0.047, 0.472 +- 0.107
Faith. GMean (L1)= 	  =  0.421 +- 0.067, 0.451 +- 0.044, 0.492 +- 0.090
Faith. Aritm (KL)= 		  =  0.429 +- 0.059, 0.460 +- 0.044, 0.550 +- 0.086
Faith. Armon (KL)= 		  =  0.397 +- 0.078, 0.443 +- 0.038, 0.450 +- 0.159
Faith. GMean (KL)= 	  =  0.412 +- 0.068, 0.451 +- 0.040, 0.494 +- 0.129
Computed for split load_split = id



Completed in  0:20:10.989803  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN simple_concept2temperature GOODMotif/basis/covariate NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:03:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:03:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9286
Train Loss: 0.3039
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9267
OOD Validation Loss: 0.3080
OOD Test ACCURACY: 0.9243
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9243 0.9243 0.9243 0.9243 0.9267 0.9267[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.216 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 class 1 = 0.269 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 class 2 = 0.688 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 all KL = 0.297 +- 0.353 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.3 all L1 = 0.397 +- 0.310 (in-sample avg dev_std = 0.503)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.33
SUFF_SIMPLE for r=0.6 class 0 = 0.22 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 class 1 = 0.202 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 class 2 = 0.817 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 all KL = 0.343 +- 0.410 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 all L1 = 0.42 +- 0.356 (in-sample avg dev_std = 0.270)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.278
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.278 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.28 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.306 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.374 +- 0.342 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
SUFF_SIMPLE for r=0.3 class 0 = 0.204 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 1 = 0.196 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 class 2 = 0.942 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all KL = 0.374 +- 0.443 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.391 (in-sample avg dev_std = 0.058)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.204 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 class 1 = 0.195 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 class 2 = 0.943 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all KL = 0.374 +- 0.444 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.6 all L1 = 0.448 +- 0.391 (in-sample avg dev_std = 0.020)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.318
SUFF_SIMPLE for r=0.9 class 0 = 0.661 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.195 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.444 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.492 +- 0.388 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.633
NEC for r=0.3 class 0 = 0.64 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 1 = 0.203 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 2 = 0.187 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all KL = 0.411 +- 0.391 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all L1 = 0.337 +- 0.330 (in-sample avg dev_std = 0.538)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.546
NEC for r=0.6 class 0 = 0.687 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 class 1 = 0.28 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 class 2 = 0.359 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 all KL = 0.532 +- 0.364 (in-sample avg dev_std = 0.629)
NEC for r=0.6 all L1 = 0.438 +- 0.311 (in-sample avg dev_std = 0.629)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.419
NEC for r=0.9 class 0 = 0.743 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 1 = 0.457 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 class 2 = 0.515 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all KL = 0.686 +- 0.288 (in-sample avg dev_std = 0.685)
NEC for r=0.9 all L1 = 0.568 +- 0.257 (in-sample avg dev_std = 0.685)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.745
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.609
NEC for r=0.3 class 0 = 0.772 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 class 1 = 0.134 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 class 2 = 0.038 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 all KL = 0.349 +- 0.450 (in-sample avg dev_std = 0.110)
NEC for r=0.3 all L1 = 0.316 +- 0.390 (in-sample avg dev_std = 0.110)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.745
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.767 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.18 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.181 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.432 +- 0.436 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.377 +- 0.373 (in-sample avg dev_std = 0.390)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.357
NEC for r=0.9 class 0 = 0.691 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 class 1 = 0.578 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 class 2 = 0.483 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 all KL = 0.714 +- 0.206 (in-sample avg dev_std = 0.775)
NEC for r=0.9 all L1 = 0.585 +- 0.192 (in-sample avg dev_std = 0.775)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:05:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:05:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3031
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3129
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3074
OOD Test ACCURACY: 0.9267
OOD Test Loss: 0.3129

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.9267 0.9267 0.9267 0.9273 0.9273[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.326
SUFF_SIMPLE for r=0.3 class 0 = 0.266 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 class 1 = 0.255 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 class 2 = 0.614 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 all KL = 0.279 +- 0.336 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.294 (in-sample avg dev_std = 0.527)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.317
SUFF_SIMPLE for r=0.6 class 0 = 0.282 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 all KL = 0.326 +- 0.399 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.6 all L1 = 0.409 +- 0.349 (in-sample avg dev_std = 0.309)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.295
SUFF_SIMPLE for r=0.9 class 0 = 0.781 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.231 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.325 +- 0.404 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.391 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.212 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 1 = 0.196 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 2 = 0.944 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all KL = 0.382 +- 0.444 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all L1 = 0.451 +- 0.392 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.212 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.196 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.944 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.382 +- 0.444 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.451 +- 0.392 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.239 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.185 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.523 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.283 +- 0.352 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.344 +- 0.292 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.672
NEC for r=0.3 class 0 = 0.565 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.139 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.221 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.366 +- 0.368 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.303 +- 0.308 (in-sample avg dev_std = 0.508)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.573
NEC for r=0.6 class 0 = 0.63 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 class 1 = 0.232 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 class 2 = 0.403 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 all KL = 0.505 +- 0.363 (in-sample avg dev_std = 0.597)
NEC for r=0.6 all L1 = 0.418 +- 0.304 (in-sample avg dev_std = 0.597)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.428
NEC for r=0.9 class 0 = 0.7 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 class 1 = 0.46 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 class 2 = 0.567 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 all KL = 0.697 +- 0.278 (in-sample avg dev_std = 0.712)
NEC for r=0.9 all L1 = 0.573 +- 0.242 (in-sample avg dev_std = 0.712)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.57
NEC for r=0.3 class 0 = 0.755 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 1 = 0.242 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 2 = 0.038 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all KL = 0.379 +- 0.428 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all L1 = 0.346 +- 0.380 (in-sample avg dev_std = 0.144)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.524
NEC for r=0.6 class 0 = 0.772 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 class 1 = 0.269 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 class 2 = 0.19 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 all KL = 0.467 +- 0.415 (in-sample avg dev_std = 0.367)
NEC for r=0.6 all L1 = 0.411 +- 0.364 (in-sample avg dev_std = 0.367)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.372
NEC for r=0.9 class 0 = 0.779 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 class 1 = 0.613 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 class 2 = 0.444 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 all KL = 0.729 +- 0.239 (in-sample avg dev_std = 0.658)
NEC for r=0.9 all L1 = 0.612 +- 0.215 (in-sample avg dev_std = 0.658)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:07:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:07:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9301
Train Loss: 0.2984
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3054
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3099
OOD Validation ACCURACY: 0.9287
OOD Validation Loss: 0.3054
OOD Test ACCURACY: 0.9277
OOD Test Loss: 0.3099

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.9277 0.9277 0.9277 0.9287 0.9287[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.332
SUFF_SIMPLE for r=0.3 class 0 = 0.232 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 class 1 = 0.234 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 class 2 = 0.699 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 all KL = 0.287 +- 0.363 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.3 all L1 = 0.394 +- 0.319 (in-sample avg dev_std = 0.488)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.331
SUFF_SIMPLE for r=0.6 class 0 = 0.237 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 class 1 = 0.192 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 class 2 = 0.785 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 all KL = 0.33 +- 0.411 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.6 all L1 = 0.412 +- 0.354 (in-sample avg dev_std = 0.291)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF_SIMPLE for r=0.9 class 0 = 0.699 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.263 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.413 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.384 +- 0.355 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.368 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 1 = 0.286 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 2 = 0.951 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all KL = 0.483 +- 0.471 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all L1 = 0.536 +- 0.408 (in-sample avg dev_std = 0.002)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.368 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.286 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.949 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.483 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.535 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.255
SUFF_SIMPLE for r=0.9 class 0 = 0.832 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.339 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.553 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.474 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.518 +- 0.386 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.628
NEC for r=0.3 class 0 = 0.614 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 class 1 = 0.218 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 class 2 = 0.214 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 all KL = 0.42 +- 0.402 (in-sample avg dev_std = 0.520)
NEC for r=0.3 all L1 = 0.343 +- 0.341 (in-sample avg dev_std = 0.520)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.547
NEC for r=0.6 class 0 = 0.682 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 class 1 = 0.288 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 class 2 = 0.373 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 all KL = 0.55 +- 0.377 (in-sample avg dev_std = 0.641)
NEC for r=0.6 all L1 = 0.443 +- 0.319 (in-sample avg dev_std = 0.641)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.421
NEC for r=0.9 class 0 = 0.732 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 class 1 = 0.473 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 class 2 = 0.527 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 all KL = 0.708 +- 0.292 (in-sample avg dev_std = 0.699)
NEC for r=0.9 all L1 = 0.575 +- 0.262 (in-sample avg dev_std = 0.699)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.628 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 1 = 0.692 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 2 = 0.047 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.51 +- 0.465 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.455 +- 0.403 (in-sample avg dev_std = 0.146)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
NEC for r=0.6 class 0 = 0.634 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 1 = 0.645 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 class 2 = 0.2 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all KL = 0.576 +- 0.424 (in-sample avg dev_std = 0.488)
NEC for r=0.6 all L1 = 0.493 +- 0.359 (in-sample avg dev_std = 0.488)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.301
NEC for r=0.9 class 0 = 0.646 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 1 = 0.693 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 class 2 = 0.386 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all KL = 0.684 +- 0.342 (in-sample avg dev_std = 0.577)
NEC for r=0.9 all L1 = 0.575 +- 0.295 (in-sample avg dev_std = 0.577)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:10:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:10:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3038
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3112
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.3112
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9250 0.9250[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.222 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 1 = 0.711 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 2 = 0.241 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all KL = 0.286 +- 0.342 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all L1 = 0.392 +- 0.301 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.211 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 class 1 = 0.724 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 class 2 = 0.255 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 all KL = 0.311 +- 0.384 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.6 all L1 = 0.398 +- 0.335 (in-sample avg dev_std = 0.356)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.239
SUFF_SIMPLE for r=0.9 class 0 = 0.47 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.245 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.354 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.285 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.352 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.431
SUFF_SIMPLE for r=0.3 class 0 = 0.191 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 class 1 = 0.877 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 class 2 = 0.21 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 all KL = 0.355 +- 0.415 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.3 all L1 = 0.424 +- 0.365 (in-sample avg dev_std = 0.165)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.351
SUFF_SIMPLE for r=0.6 class 0 = 0.192 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 1 = 0.921 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 2 = 0.203 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.371 +- 0.439 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.437 +- 0.378 (in-sample avg dev_std = 0.004)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.631
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.219
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.742 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.561 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.556 +- 0.363 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.518
NEC for r=0.3 class 0 = 0.644 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 1 = 0.056 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 2 = 0.65 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all KL = 0.529 +- 0.406 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all L1 = 0.449 +- 0.349 (in-sample avg dev_std = 0.506)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.486
NEC for r=0.6 class 0 = 0.686 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 1 = 0.124 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 class 2 = 0.667 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all KL = 0.59 +- 0.379 (in-sample avg dev_std = 0.586)
NEC for r=0.6 all L1 = 0.491 +- 0.326 (in-sample avg dev_std = 0.586)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.401
NEC for r=0.9 class 0 = 0.722 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 class 1 = 0.38 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 class 2 = 0.7 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 all KL = 0.726 +- 0.272 (in-sample avg dev_std = 0.711)
NEC for r=0.9 all L1 = 0.6 +- 0.240 (in-sample avg dev_std = 0.711)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.771
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.354
NEC for r=0.3 class 0 = 0.806 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 class 1 = 0.056 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 class 2 = 0.797 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 all KL = 0.627 +- 0.440 (in-sample avg dev_std = 0.053)
NEC for r=0.3 all L1 = 0.555 +- 0.389 (in-sample avg dev_std = 0.053)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.341
NEC for r=0.6 class 0 = 0.81 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 1 = 0.099 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 2 = 0.8 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.65 +- 0.422 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.572 +- 0.375 (in-sample avg dev_std = 0.169)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.771
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.292
NEC for r=0.9 class 0 = 0.784 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 class 1 = 0.544 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 class 2 = 0.769 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 all KL = 0.829 +- 0.151 (in-sample avg dev_std = 0.651)
NEC for r=0.9 all L1 = 0.7 +- 0.156 (in-sample avg dev_std = 0.651)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:12:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:12:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9282
Train Loss: 0.3033
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3146
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3118
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3146

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF_SIMPLE for r=0.3 class 0 = 0.231 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 class 1 = 0.667 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 class 2 = 0.253 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 all KL = 0.278 +- 0.329 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.3 all L1 = 0.385 +- 0.290 (in-sample avg dev_std = 0.557)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.309
SUFF_SIMPLE for r=0.6 class 0 = 0.217 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 class 1 = 0.697 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 class 2 = 0.272 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 all KL = 0.316 +- 0.375 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.6 all L1 = 0.397 +- 0.326 (in-sample avg dev_std = 0.359)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.263
SUFF_SIMPLE for r=0.9 class 0 = 0.518 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.24 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.339 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.297 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.358 +- 0.315 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.431
SUFF_SIMPLE for r=0.3 class 0 = 0.188 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 class 1 = 0.879 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 class 2 = 0.208 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 all KL = 0.357 +- 0.424 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.3 all L1 = 0.423 +- 0.366 (in-sample avg dev_std = 0.152)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.352
SUFF_SIMPLE for r=0.6 class 0 = 0.187 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 1 = 0.902 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 2 = 0.199 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.368 +- 0.436 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.427 +- 0.371 (in-sample avg dev_std = 0.004)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.898 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.193 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.735 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.448 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.553 +- 0.380 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.522
NEC for r=0.3 class 0 = 0.625 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 1 = 0.065 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 class 2 = 0.656 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all KL = 0.526 +- 0.401 (in-sample avg dev_std = 0.516)
NEC for r=0.3 all L1 = 0.448 +- 0.345 (in-sample avg dev_std = 0.516)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.498
NEC for r=0.6 class 0 = 0.663 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 1 = 0.135 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 class 2 = 0.668 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all KL = 0.582 +- 0.370 (in-sample avg dev_std = 0.591)
NEC for r=0.6 all L1 = 0.488 +- 0.320 (in-sample avg dev_std = 0.591)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.4
NEC for r=0.9 class 0 = 0.709 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 1 = 0.418 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 2 = 0.709 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all KL = 0.742 +- 0.245 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all L1 = 0.612 +- 0.220 (in-sample avg dev_std = 0.733)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.758
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.356
NEC for r=0.3 class 0 = 0.812 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 class 1 = 0.084 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 class 2 = 0.805 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 all KL = 0.636 +- 0.439 (in-sample avg dev_std = 0.038)
NEC for r=0.3 all L1 = 0.569 +- 0.380 (in-sample avg dev_std = 0.038)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.34
NEC for r=0.6 class 0 = 0.815 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 1 = 0.129 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 2 = 0.807 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.659 +- 0.420 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.586 +- 0.364 (in-sample avg dev_std = 0.166)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.758
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.292
NEC for r=0.9 class 0 = 0.782 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 1 = 0.57 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 class 2 = 0.765 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all KL = 0.835 +- 0.153 (in-sample avg dev_std = 0.667)
NEC for r=0.9 all L1 = 0.706 +- 0.143 (in-sample avg dev_std = 0.667)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:15:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:15:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3012
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3085
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3123
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3085
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3123

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9280 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.329 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 class 1 = 0.562 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 class 2 = 0.216 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 all KL = 0.278 +- 0.298 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.3 all L1 = 0.368 +- 0.249 (in-sample avg dev_std = 0.539)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.337
SUFF_SIMPLE for r=0.6 class 0 = 0.591 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 1 = 0.373 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 2 = 0.272 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all KL = 0.344 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all L1 = 0.408 +- 0.323 (in-sample avg dev_std = 0.327)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.286
SUFF_SIMPLE for r=0.9 class 0 = 0.787 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.248 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.328 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.350 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
SUFF_SIMPLE for r=0.3 class 0 = 0.823 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 class 1 = 0.294 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 class 2 = 0.633 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 all KL = 0.582 +- 0.421 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.3 all L1 = 0.585 +- 0.356 (in-sample avg dev_std = 0.142)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.341
SUFF_SIMPLE for r=0.6 class 0 = 0.746 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 1 = 0.207 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 class 2 = 0.539 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all KL = 0.485 +- 0.425 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.6 all L1 = 0.499 +- 0.359 (in-sample avg dev_std = 0.004)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.198
SUFF_SIMPLE for r=0.9 class 0 = 0.878 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.197 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.475 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.386 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.436 +- 0.360 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.674
NEC for r=0.3 class 0 = 0.599 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 class 1 = 0.037 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 class 2 = 0.311 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 all KL = 0.375 +- 0.383 (in-sample avg dev_std = 0.526)
NEC for r=0.3 all L1 = 0.312 +- 0.322 (in-sample avg dev_std = 0.526)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.541
NEC for r=0.6 class 0 = 0.652 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 1 = 0.16 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 class 2 = 0.537 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all KL = 0.539 +- 0.371 (in-sample avg dev_std = 0.631)
NEC for r=0.6 all L1 = 0.447 +- 0.314 (in-sample avg dev_std = 0.631)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.416
NEC for r=0.9 class 0 = 0.688 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 class 1 = 0.414 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 class 2 = 0.664 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 all KL = 0.705 +- 0.270 (in-sample avg dev_std = 0.713)
NEC for r=0.9 all L1 = 0.588 +- 0.237 (in-sample avg dev_std = 0.713)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.72
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.824
NEC for r=0.3 class 0 = 0.67 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 1 = 0.026 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 class 2 = 0.029 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all KL = 0.266 +- 0.384 (in-sample avg dev_std = 0.261)
NEC for r=0.3 all L1 = 0.243 +- 0.349 (in-sample avg dev_std = 0.261)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.715
NEC for r=0.6 class 0 = 0.727 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.077 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.178 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.377 +- 0.414 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.329 +- 0.366 (in-sample avg dev_std = 0.383)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.38
NEC for r=0.9 class 0 = 0.669 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 class 1 = 0.561 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 class 2 = 0.61 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 all KL = 0.742 +- 0.151 (in-sample avg dev_std = 0.802)
NEC for r=0.9 all L1 = 0.614 +- 0.146 (in-sample avg dev_std = 0.802)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:17:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:17:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3018
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3093
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3100
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3093
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3100

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.247 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 1 = 0.268 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 class 2 = 0.613 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all KL = 0.276 +- 0.338 (in-sample avg dev_std = 0.528)
SUFF_SIMPLE for r=0.3 all L1 = 0.38 +- 0.293 (in-sample avg dev_std = 0.528)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF_SIMPLE for r=0.6 class 0 = 0.269 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 class 2 = 0.741 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 all KL = 0.338 +- 0.398 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.6 all L1 = 0.409 +- 0.326 (in-sample avg dev_std = 0.326)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.289
SUFF_SIMPLE for r=0.9 class 0 = 0.795 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.241 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.202 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.325 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.389 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.517 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 1 = 0.202 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 2 = 0.957 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all KL = 0.533 +- 0.457 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all L1 = 0.56 +- 0.392 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.518 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.202 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.952 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.533 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.559 +- 0.390 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.074
SUFF_SIMPLE for r=0.9 class 0 = 0.81 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.182 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.269 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.252 +- 0.370 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.328 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.654
NEC for r=0.3 class 0 = 0.639 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.043 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.28 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.379 +- 0.391 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.316 +- 0.332 (in-sample avg dev_std = 0.508)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.535
NEC for r=0.6 class 0 = 0.677 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 class 1 = 0.211 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 class 2 = 0.477 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 all KL = 0.547 +- 0.369 (in-sample avg dev_std = 0.622)
NEC for r=0.6 all L1 = 0.452 +- 0.317 (in-sample avg dev_std = 0.622)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.402
NEC for r=0.9 class 0 = 0.725 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 class 1 = 0.446 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 class 2 = 0.609 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 all KL = 0.713 +- 0.280 (in-sample avg dev_std = 0.689)
NEC for r=0.9 all L1 = 0.592 +- 0.249 (in-sample avg dev_std = 0.689)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0 = 0.405 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 class 1 = 0.025 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 class 2 = 0.014 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all KL = 0.13 +- 0.279 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all L1 = 0.149 +- 0.270 (in-sample avg dev_std = 0.074)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0 = 0.535 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 class 1 = 0.099 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 class 2 = 0.175 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 all KL = 0.305 +- 0.367 (in-sample avg dev_std = 0.432)
NEC for r=0.6 all L1 = 0.271 +- 0.319 (in-sample avg dev_std = 0.432)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.33
NEC for r=0.9 class 0 = 0.669 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 1 = 0.579 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 class 2 = 0.585 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all KL = 0.742 +- 0.175 (in-sample avg dev_std = 0.774)
NEC for r=0.9 all L1 = 0.611 +- 0.165 (in-sample avg dev_std = 0.774)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:18:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:18:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9277
Train Loss: 0.3051
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9253
ID Test Loss: 0.3113
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3107
OOD Test ACCURACY: 0.9253
OOD Test Loss: 0.3113

[0m[1;37mINFO[0m: [1mChartInfo 0.9253 0.9253 0.9253 0.9253 0.9260 0.9260[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF_SIMPLE for r=0.3 class 0 = 0.27 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 class 1 = 0.704 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 class 2 = 0.199 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 all KL = 0.293 +- 0.333 (in-sample avg dev_std = 0.499)
SUFF_SIMPLE for r=0.3 all L1 = 0.391 +- 0.296 (in-sample avg dev_std = 0.499)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.434
SUFF_SIMPLE for r=0.6 class 0 = 0.503 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 1 = 0.61 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 class 2 = 0.256 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all KL = 0.415 +- 0.388 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.6 all L1 = 0.454 +- 0.314 (in-sample avg dev_std = 0.327)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.261
SUFF_SIMPLE for r=0.9 class 0 = 0.76 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.226 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.205 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.308 +- 0.396 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.375 +- 0.343 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.489
SUFF_SIMPLE for r=0.3 class 0 = 0.586 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 class 1 = 0.823 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 class 2 = 0.21 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 all KL = 0.506 +- 0.391 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.3 all L1 = 0.539 +- 0.336 (in-sample avg dev_std = 0.316)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.376
SUFF_SIMPLE for r=0.6 class 0 = 0.467 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 class 1 = 0.659 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 class 2 = 0.201 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 all KL = 0.413 +- 0.400 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.6 all L1 = 0.441 +- 0.330 (in-sample avg dev_std = 0.046)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.047
SUFF_SIMPLE for r=0.9 class 0 = 0.269 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.181 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.101 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.196 +- 0.097 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0 = 0.632 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 class 1 = 0.046 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 class 2 = 0.439 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 all KL = 0.439 +- 0.400 (in-sample avg dev_std = 0.522)
NEC for r=0.3 all L1 = 0.369 +- 0.343 (in-sample avg dev_std = 0.522)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0 = 0.656 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 1 = 0.174 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 class 2 = 0.598 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all KL = 0.568 +- 0.365 (in-sample avg dev_std = 0.617)
NEC for r=0.6 all L1 = 0.475 +- 0.315 (in-sample avg dev_std = 0.617)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.399
NEC for r=0.9 class 0 = 0.668 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 1 = 0.415 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 class 2 = 0.722 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all KL = 0.718 +- 0.269 (in-sample avg dev_std = 0.704)
NEC for r=0.9 all L1 = 0.602 +- 0.238 (in-sample avg dev_std = 0.704)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.929
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.677
NEC for r=0.3 class 0 = 0.64 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 1 = 0.027 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 class 2 = 0.082 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all KL = 0.283 +- 0.382 (in-sample avg dev_std = 0.354)
NEC for r=0.3 all L1 = 0.251 +- 0.335 (in-sample avg dev_std = 0.354)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.929
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.697 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 1 = 0.083 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 2 = 0.413 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all KL = 0.476 +- 0.380 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all L1 = 0.399 +- 0.329 (in-sample avg dev_std = 0.551)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.684 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 class 1 = 0.534 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 class 2 = 0.723 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 all KL = 0.776 +- 0.167 (in-sample avg dev_std = 0.770)
NEC for r=0.9 all L1 = 0.648 +- 0.155 (in-sample avg dev_std = 0.770)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:20:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:20:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9299
Train Loss: 0.2998
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3066
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3119
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.3066
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3119

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9277 0.9277[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.348
SUFF_SIMPLE for r=0.3 class 0 = 0.253 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 class 1 = 0.356 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 class 2 = 0.395 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 all KL = 0.247 +- 0.183 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.156 (in-sample avg dev_std = 0.514)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.339
SUFF_SIMPLE for r=0.6 class 0 = 0.257 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 class 1 = 0.359 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 class 2 = 0.445 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 all KL = 0.296 +- 0.250 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.6 all L1 = 0.356 +- 0.197 (in-sample avg dev_std = 0.320)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.347
SUFF_SIMPLE for r=0.9 class 0 = 0.754 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.327 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.226 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.359 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.415 +- 0.349 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.418
SUFF_SIMPLE for r=0.3 class 0 = 0.197 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 class 1 = 0.332 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 class 2 = 0.762 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 all KL = 0.373 +- 0.371 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.3 all L1 = 0.431 +- 0.326 (in-sample avg dev_std = 0.050)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF_SIMPLE for r=0.6 class 0 = 0.199 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.264 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.777 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.346 +- 0.389 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.414 +- 0.343 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.253
SUFF_SIMPLE for r=0.9 class 0 = 0.204 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.177 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.438 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.310 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.215 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.928
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.643
NEC for r=0.3 class 0 = 0.54 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 class 1 = 0.204 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 class 2 = 0.337 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 all KL = 0.418 +- 0.324 (in-sample avg dev_std = 0.515)
NEC for r=0.3 all L1 = 0.357 +- 0.284 (in-sample avg dev_std = 0.515)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.928
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.552
NEC for r=0.6 class 0 = 0.602 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 class 1 = 0.292 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 class 2 = 0.437 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 all KL = 0.531 +- 0.333 (in-sample avg dev_std = 0.601)
NEC for r=0.6 all L1 = 0.441 +- 0.285 (in-sample avg dev_std = 0.601)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.407
NEC for r=0.9 class 0 = 0.682 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.54 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.575 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.727 +- 0.223 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.597 +- 0.205 (in-sample avg dev_std = 0.715)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.525
NEC for r=0.3 class 0 = 0.796 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 1 = 0.618 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 2 = 0.267 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all KL = 0.61 +- 0.343 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all L1 = 0.561 +- 0.305 (in-sample avg dev_std = 0.217)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.477
NEC for r=0.6 class 0 = 0.803 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 1 = 0.597 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 class 2 = 0.345 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all KL = 0.647 +- 0.356 (in-sample avg dev_std = 0.292)
NEC for r=0.6 all L1 = 0.582 +- 0.312 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.809
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.338
NEC for r=0.9 class 0 = 0.806 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 class 1 = 0.76 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 class 2 = 0.467 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 all KL = 0.787 +- 0.248 (in-sample avg dev_std = 0.480)
NEC for r=0.9 all L1 = 0.678 +- 0.224 (in-sample avg dev_std = 0.480)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:22:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:22:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9262
Train Loss: 0.3044
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3106
ID Test ACCURACY: 0.9220
ID Test Loss: 0.3138
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3106
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.3138

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.235 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 class 1 = 0.407 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 class 2 = 0.394 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 all KL = 0.279 +- 0.238 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.3 all L1 = 0.348 +- 0.184 (in-sample avg dev_std = 0.506)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.235 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 class 1 = 0.263 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 class 2 = 0.649 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 all KL = 0.317 +- 0.363 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.6 all L1 = 0.387 +- 0.313 (in-sample avg dev_std = 0.303)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.229
SUFF_SIMPLE for r=0.9 class 0 = 0.556 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.228 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.284 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.267 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.345 +- 0.324 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.434
SUFF_SIMPLE for r=0.3 class 0 = 0.205 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 class 1 = 0.371 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 class 2 = 0.854 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 all KL = 0.435 +- 0.415 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.3 all L1 = 0.477 +- 0.356 (in-sample avg dev_std = 0.119)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.365
SUFF_SIMPLE for r=0.6 class 0 = 0.203 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.237 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.947 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.397 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.463 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.934
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.038
SUFF_SIMPLE for r=0.9 class 0 = 0.324 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.198 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.172 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.131 +- 0.116 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.208 +- 0.076 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.695
NEC for r=0.3 class 0 = 0.554 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 1 = 0.149 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 2 = 0.23 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all KL = 0.343 +- 0.338 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all L1 = 0.307 +- 0.294 (in-sample avg dev_std = 0.470)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.583
NEC for r=0.6 class 0 = 0.62 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 class 1 = 0.237 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 class 2 = 0.414 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 all KL = 0.486 +- 0.335 (in-sample avg dev_std = 0.572)
NEC for r=0.6 all L1 = 0.421 +- 0.286 (in-sample avg dev_std = 0.572)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.429
NEC for r=0.9 class 0 = 0.689 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 class 1 = 0.476 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 class 2 = 0.57 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 all KL = 0.686 +- 0.248 (in-sample avg dev_std = 0.694)
NEC for r=0.9 all L1 = 0.577 +- 0.220 (in-sample avg dev_std = 0.694)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.632
NEC for r=0.3 class 0 = 0.78 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 class 1 = 0.398 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 class 2 = 0.043 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all KL = 0.404 +- 0.394 (in-sample avg dev_std = 0.045)
NEC for r=0.3 all L1 = 0.408 +- 0.340 (in-sample avg dev_std = 0.045)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.58
NEC for r=0.6 class 0 = 0.788 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 1 = 0.368 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 2 = 0.182 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all KL = 0.468 +- 0.388 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all L1 = 0.447 +- 0.326 (in-sample avg dev_std = 0.313)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.375
NEC for r=0.9 class 0 = 0.799 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 class 1 = 0.645 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 class 2 = 0.47 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 all KL = 0.74 +- 0.213 (in-sample avg dev_std = 0.593)
NEC for r=0.9 all L1 = 0.638 +- 0.193 (in-sample avg dev_std = 0.593)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.297, 0.343, 0.306], 'all_L1': [0.397, 0.42, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.326, 0.325], 'all_L1': [0.383, 0.409, 0.391]}), defaultdict(<class 'list'>, {'all_KL': [0.287, 0.33, 0.308], 'all_L1': [0.394, 0.412, 0.384]}), defaultdict(<class 'list'>, {'all_KL': [0.286, 0.311, 0.285], 'all_L1': [0.392, 0.398, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.316, 0.297], 'all_L1': [0.385, 0.397, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.344, 0.328], 'all_L1': [0.368, 0.408, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.338, 0.325], 'all_L1': [0.38, 0.409, 0.389]}), defaultdict(<class 'list'>, {'all_KL': [0.293, 0.415, 0.308], 'all_L1': [0.391, 0.454, 0.375]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.296, 0.359], 'all_L1': [0.337, 0.356, 0.415]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.317, 0.267], 'all_L1': [0.348, 0.387, 0.345]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.411, 0.532, 0.686], 'all_L1': [0.337, 0.438, 0.568]}), defaultdict(<class 'list'>, {'all_KL': [0.366, 0.505, 0.697], 'all_L1': [0.303, 0.418, 0.573]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.55, 0.708], 'all_L1': [0.343, 0.443, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.529, 0.59, 0.726], 'all_L1': [0.449, 0.491, 0.6]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.582, 0.742], 'all_L1': [0.448, 0.488, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.375, 0.539, 0.705], 'all_L1': [0.312, 0.447, 0.588]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.547, 0.713], 'all_L1': [0.316, 0.452, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.568, 0.718], 'all_L1': [0.369, 0.475, 0.602]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.531, 0.727], 'all_L1': [0.357, 0.441, 0.597]}), defaultdict(<class 'list'>, {'all_KL': [0.343, 0.486, 0.686], 'all_L1': [0.307, 0.421, 0.577]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.374, 0.374, 0.444], 'all_L1': [0.448, 0.448, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.382, 0.382, 0.283], 'all_L1': [0.451, 0.451, 0.344]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.483, 0.474], 'all_L1': [0.536, 0.535, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.355, 0.371, 0.561], 'all_L1': [0.424, 0.437, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.357, 0.368, 0.542], 'all_L1': [0.423, 0.427, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.485, 0.386], 'all_L1': [0.585, 0.499, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.533, 0.252], 'all_L1': [0.56, 0.559, 0.328]}), defaultdict(<class 'list'>, {'all_KL': [0.506, 0.413, 0.101], 'all_L1': [0.539, 0.441, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.346, 0.246], 'all_L1': [0.431, 0.414, 0.297]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.397, 0.131], 'all_L1': [0.477, 0.463, 0.208]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.349, 0.432, 0.714], 'all_L1': [0.316, 0.377, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.467, 0.729], 'all_L1': [0.346, 0.411, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.576, 0.684], 'all_L1': [0.455, 0.493, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.627, 0.65, 0.829], 'all_L1': [0.555, 0.572, 0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.636, 0.659, 0.835], 'all_L1': [0.569, 0.586, 0.706]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.377, 0.742], 'all_L1': [0.243, 0.329, 0.614]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.305, 0.742], 'all_L1': [0.149, 0.271, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.476, 0.776], 'all_L1': [0.251, 0.399, 0.648]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.647, 0.787], 'all_L1': [0.561, 0.582, 0.678]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.468, 0.74], 'all_L1': [0.408, 0.447, 0.638]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.378 +- 0.019, 0.405 +- 0.024, 0.377 +- 0.020
suff_simple class all_KL  =  0.280 +- 0.013, 0.334 +- 0.031, 0.311 +- 0.024
[[0.33404165506362915, 0.3304166793823242, 0.2775685787200928], [0.3256250023841858, 0.31712499260902405, 0.295320063829422], [0.3322083353996277, 0.3307083249092102, 0.2840236723423004], [0.3452083468437195, 0.31158334016799927, 0.2393760085105896], [0.3461666703224182, 0.3086250126361847, 0.26304465532302856], [0.33691665530204773, 0.3374166786670685, 0.28563743829727173], [0.3295416533946991, 0.34033334255218506, 0.28886497020721436], [0.3372499942779541, 0.4339166581630707, 0.26143088936805725], [0.3475416600704193, 0.33924999833106995, 0.34749865531921387], [0.3401666581630707, 0.3113749921321869, 0.22861753404140472]]
[[0.297, 0.343, 0.306], [0.279, 0.326, 0.325], [0.287, 0.33, 0.308], [0.286, 0.311, 0.285], [0.278, 0.316, 0.297], [0.278, 0.344, 0.328], [0.276, 0.338, 0.325], [0.293, 0.415, 0.308], [0.247, 0.296, 0.359], [0.279, 0.317, 0.267]]
suff_simple_acc_int  =  0.337 +- 0.007, 0.336 +- 0.035, 0.277 +- 0.031
nec class all_L1  =  0.354 +- 0.052, 0.451 +- 0.024, 0.588 +- 0.014
nec class all_KL  =  0.421 +- 0.060, 0.543 +- 0.031, 0.711 +- 0.017
[[0.6331666707992554, 0.5460833311080933, 0.4192083477973938], [0.6724583506584167, 0.5725833177566528, 0.42762500047683716], [0.628250002861023, 0.546708345413208, 0.4205000102519989], [0.5180000066757202, 0.48616665601730347, 0.4010416567325592], [0.5218333601951599, 0.4984583258628845, 0.3996250033378601], [0.6736666560173035, 0.5411666631698608, 0.41624999046325684], [0.6538333296775818, 0.5350000262260437, 0.4020416736602783], [0.5994166731834412, 0.5134583115577698, 0.39933332800865173], [0.6428333520889282, 0.5521249771118164, 0.40712499618530273], [0.6946666836738586, 0.5833749771118164, 0.4294166564941406]]
[[0.411, 0.532, 0.686], [0.366, 0.505, 0.697], [0.42, 0.55, 0.708], [0.529, 0.59, 0.726], [0.526, 0.582, 0.742], [0.375, 0.539, 0.705], [0.379, 0.547, 0.713], [0.439, 0.568, 0.718], [0.418, 0.531, 0.727], [0.343, 0.486, 0.686]]
nec_acc_int  =  0.624 +- 0.058, 0.538 +- 0.029, 0.412 +- 0.011

Eval split val
suff_simple class all_L1  =  0.487 +- 0.058, 0.467 +- 0.046, 0.393 +- 0.130
suff_simple class all_KL  =  0.438 +- 0.078, 0.415 +- 0.060, 0.342 +- 0.155
[[0.3334166705608368, 0.33404165506362915, 0.3183828294277191], [0.33399999141693115, 0.33399999141693115, 0.23878711462020874], [0.33399999141693115, 0.33399999141693115, 0.25457990169525146], [0.43058332800865173, 0.351416677236557, 0.21920403838157654], [0.4312083423137665, 0.3517916798591614, 0.1711939424276352], [0.3800833225250244, 0.3409999907016754, 0.19835755228996277], [0.33399999141693115, 0.33399999141693115, 0.07391029596328735], [0.48904165625572205, 0.37562501430511475, 0.04737839475274086], [0.4177500009536743, 0.34033334255218506, 0.2533164918422699], [0.4336250126361847, 0.36500000953674316, 0.03790271654725075]]
[[0.374, 0.374, 0.444], [0.382, 0.382, 0.283], [0.483, 0.483, 0.474], [0.355, 0.371, 0.561], [0.357, 0.368, 0.542], [0.582, 0.485, 0.386], [0.533, 0.533, 0.252], [0.506, 0.413, 0.101], [0.373, 0.346, 0.246], [0.435, 0.397, 0.131]]
suff_simple_acc_int  =  0.392 +- 0.053, 0.346 +- 0.014, 0.181 +- 0.092
nec class all_L1  =  0.385 +- 0.141, 0.447 +- 0.104, 0.637 +- 0.043
nec class all_KL  =  0.419 +- 0.163, 0.506 +- 0.116, 0.758 +- 0.046
[[0.609208345413208, 0.559416651725769, 0.3566666543483734], [0.5699583292007446, 0.5244583487510681, 0.3722083270549774], [0.3435416519641876, 0.35466668009757996, 0.30133333802223206], [0.3544583320617676, 0.3413333296775818, 0.29241666197776794], [0.3556666672229767, 0.34033334255218506, 0.29249998927116394], [0.8239583373069763, 0.7148333191871643, 0.3804166615009308], [0.6442916393280029, 0.5766666531562805, 0.33024999499320984], [0.6767083406448364, 0.5586666464805603, 0.35754168033599854], [0.5245416760444641, 0.47725000977516174, 0.33783334493637085], [0.6324999928474426, 0.5803750157356262, 0.3752083480358124]]
[[0.349, 0.432, 0.714], [0.379, 0.467, 0.729], [0.51, 0.576, 0.684], [0.627, 0.65, 0.829], [0.636, 0.659, 0.835], [0.266, 0.377, 0.742], [0.13, 0.305, 0.742], [0.283, 0.476, 0.776], [0.61, 0.647, 0.787], [0.404, 0.468, 0.74]]
nec_acc_int  =  0.553 +- 0.152, 0.503 +- 0.118, 0.340 +- 0.033


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.366 +- 0.030, 0.428 +- 0.019, 0.483 +- 0.012
Faith. Armon (L1)= 		  =  0.364 +- 0.030, 0.426 +- 0.019, 0.459 +- 0.015
Faith. GMean (L1)= 	  =  0.365 +- 0.030, 0.427 +- 0.019, 0.471 +- 0.013
Faith. Aritm (KL)= 		  =  0.350 +- 0.032, 0.438 +- 0.024, 0.511 +- 0.016
Faith. Armon (KL)= 		  =  0.335 +- 0.022, 0.412 +- 0.026, 0.432 +- 0.024
Faith. GMean (KL)= 	  =  0.342 +- 0.026, 0.425 +- 0.024, 0.470 +- 0.020

Eval split val
Faith. Aritm (L1)= 		  =  0.436 +- 0.052, 0.457 +- 0.042, 0.515 +- 0.070
Faith. Armon (L1)= 		  =  0.407 +- 0.081, 0.446 +- 0.047, 0.472 +- 0.107
Faith. GMean (L1)= 	  =  0.421 +- 0.067, 0.451 +- 0.044, 0.492 +- 0.090
Faith. Aritm (KL)= 		  =  0.429 +- 0.059, 0.460 +- 0.044, 0.550 +- 0.086
Faith. Armon (KL)= 		  =  0.397 +- 0.078, 0.443 +- 0.038, 0.450 +- 0.159
Faith. GMean (KL)= 	  =  0.412 +- 0.068, 0.451 +- 0.040, 0.494 +- 0.129
Computed for split load_split = id



Completed in  0:20:40.644037  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN simple_concept2temperature GOODMotif/basis/covariate NEC_ALPHA 0.1 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:24:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:24:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.235 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 class 1 = 0.21 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 class 2 = 0.662 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 all KL = 0.312 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 all L1 = 0.374 +- 0.285 (in-sample avg dev_std = 0.391)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.208 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 1 = 0.173 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.33 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.377 +- 0.324 (in-sample avg dev_std = 0.169)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.213
SUFF_SIMPLE for r=0.9 class 0 = 0.482 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.286 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.32 +- 0.254 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.162 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 class 1 = 0.174 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 class 2 = 0.561 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 all KL = 0.256 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 all L1 = 0.299 +- 0.266 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.16 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 class 1 = 0.174 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 class 2 = 0.559 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 all KL = 0.254 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 all L1 = 0.298 +- 0.266 (in-sample avg dev_std = 0.005)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.401
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.884 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.806 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.416 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.72 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.287 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.635
NEC for r=0.3 class 0 = 0.594 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.397 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.285 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.442 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.421 +- 0.268 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0 = 0.635 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 1 = 0.432 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 2 = 0.373 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all KL = 0.528 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all L1 = 0.477 +- 0.250 (in-sample avg dev_std = 0.534)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.431
NEC for r=0.9 class 0 = 0.685 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 1 = 0.604 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 2 = 0.525 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all KL = 0.692 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all L1 = 0.603 +- 0.206 (in-sample avg dev_std = 0.627)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.838 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 class 1 = 0.812 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 class 2 = 0.441 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 all KL = 0.74 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 all L1 = 0.697 +- 0.265 (in-sample avg dev_std = 0.119)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.372
NEC for r=0.6 class 0 = 0.838 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1 = 0.797 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 2 = 0.49 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.758 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.708 +- 0.227 (in-sample avg dev_std = 0.258)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.348
NEC for r=0.9 class 0 = 0.799 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 class 1 = 0.795 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 class 2 = 0.481 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 all KL = 0.761 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 all L1 = 0.692 +- 0.206 (in-sample avg dev_std = 0.465)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:26:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:26:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.325
SUFF_SIMPLE for r=0.3 class 0 = 0.436 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 1 = 0.23 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 2 = 0.347 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all KL = 0.274 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.175 (in-sample avg dev_std = 0.331)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.318
SUFF_SIMPLE for r=0.6 class 0 = 0.661 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 class 1 = 0.194 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 class 2 = 0.26 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 all KL = 0.324 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 all L1 = 0.366 +- 0.263 (in-sample avg dev_std = 0.142)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.271
SUFF_SIMPLE for r=0.9 class 0 = 0.74 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.209 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.219 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.335 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.303 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.76 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 class 1 = 0.545 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 class 2 = 0.85 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 all KL = 0.722 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 all L1 = 0.719 +- 0.319 (in-sample avg dev_std = 0.041)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF_SIMPLE for r=0.6 class 0 = 0.795 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.546 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.825 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.731 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.723 +- 0.319 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.493
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF_SIMPLE for r=0.9 class 0 = 0.975 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.873 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.653
NEC for r=0.3 class 0 = 0.498 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1 = 0.443 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 2 = 0.296 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.416 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.41 +- 0.250 (in-sample avg dev_std = 0.412)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.575
NEC for r=0.6 class 0 = 0.539 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 1 = 0.463 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 2 = 0.475 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all KL = 0.532 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all L1 = 0.492 +- 0.228 (in-sample avg dev_std = 0.521)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.426
NEC for r=0.9 class 0 = 0.522 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.611 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.678 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.679 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.606 +- 0.206 (in-sample avg dev_std = 0.576)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.544
NEC for r=0.3 class 0 = 0.373 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 1 = 0.365 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 2 = 0.095 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all KL = 0.342 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all L1 = 0.278 +- 0.269 (in-sample avg dev_std = 0.217)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.439
NEC for r=0.6 class 0 = 0.399 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 1 = 0.374 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 2 = 0.201 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all KL = 0.382 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all L1 = 0.325 +- 0.282 (in-sample avg dev_std = 0.311)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.532
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.343
NEC for r=0.9 class 0 = 0.298 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 1 = 0.441 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 2 = 0.339 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 all KL = 0.425 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 all L1 = 0.359 +- 0.302 (in-sample avg dev_std = 0.317)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:29:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:29:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mChartInfo 0.9250 0.9250 0.9250 0.9250 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.221 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 class 2 = 0.707 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 all KL = 0.316 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 all L1 = 0.378 +- 0.299 (in-sample avg dev_std = 0.343)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.201 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 1 = 0.171 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 2 = 0.73 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.322 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.374 +- 0.324 (in-sample avg dev_std = 0.169)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.209
SUFF_SIMPLE for r=0.9 class 0 = 0.446 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.214 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.281 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.255 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.307 +- 0.255 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.456 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 1 = 0.577 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 2 = 0.944 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.68 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.659 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.456 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.577 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.944 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.68 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.659 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.23
SUFF_SIMPLE for r=0.9 class 0 = 0.88 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.675 +- 0.293 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.611
NEC for r=0.3 class 0 = 0.595 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 1 = 0.431 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 2 = 0.277 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all KL = 0.456 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all L1 = 0.43 +- 0.268 (in-sample avg dev_std = 0.422)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.588
NEC for r=0.6 class 0 = 0.647 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 class 1 = 0.437 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 class 2 = 0.344 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 all KL = 0.517 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 all L1 = 0.472 +- 0.253 (in-sample avg dev_std = 0.515)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.436
NEC for r=0.9 class 0 = 0.693 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 class 1 = 0.617 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 class 2 = 0.516 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 all KL = 0.696 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 all L1 = 0.606 +- 0.200 (in-sample avg dev_std = 0.623)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.542 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 1 = 0.412 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 2 = 0.056 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all KL = 0.315 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all L1 = 0.337 +- 0.346 (in-sample avg dev_std = 0.106)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.544 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 1 = 0.406 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 2 = 0.113 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all KL = 0.345 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all L1 = 0.354 +- 0.333 (in-sample avg dev_std = 0.225)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.343
NEC for r=0.9 class 0 = 0.529 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 1 = 0.419 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 2 = 0.138 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all KL = 0.363 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all L1 = 0.362 +- 0.324 (in-sample avg dev_std = 0.297)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:31:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:31:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.9247 0.9247 0.9247 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 class 1 = 0.229 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 class 2 = 0.568 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 all KL = 0.304 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 all L1 = 0.373 +- 0.261 (in-sample avg dev_std = 0.385)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.324
SUFF_SIMPLE for r=0.6 class 0 = 0.457 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 class 1 = 0.187 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 class 2 = 0.442 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 all KL = 0.318 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.235 (in-sample avg dev_std = 0.158)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.275
SUFF_SIMPLE for r=0.9 class 0 = 0.683 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.227 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.24 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.355 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.366 +- 0.270 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.328
SUFF_SIMPLE for r=0.3 class 0 = 0.641 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 class 1 = 0.541 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 class 2 = 0.466 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 all KL = 0.578 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 all L1 = 0.55 +- 0.265 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.336
SUFF_SIMPLE for r=0.6 class 0 = 0.545 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 class 1 = 0.513 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 class 2 = 0.507 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 all KL = 0.558 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 all L1 = 0.522 +- 0.206 (in-sample avg dev_std = 0.025)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.804 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.764 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.348 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.587 +- 0.277 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.679
NEC for r=0.3 class 0 = 0.554 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.351 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.252 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.391 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.382 +- 0.254 (in-sample avg dev_std = 0.421)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.617 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.435 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.457 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.552 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.501 +- 0.226 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.418
NEC for r=0.9 class 0 = 0.612 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 class 1 = 0.607 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 class 2 = 0.634 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 all KL = 0.702 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 all L1 = 0.618 +- 0.166 (in-sample avg dev_std = 0.595)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.683
NEC for r=0.3 class 0 = 0.368 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 1 = 0.54 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 2 = 0.336 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all KL = 0.363 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all L1 = 0.414 +- 0.201 (in-sample avg dev_std = 0.289)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.587
NEC for r=0.6 class 0 = 0.456 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.548 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.434 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.469 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.479 +- 0.196 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.38
NEC for r=0.9 class 0 = 0.403 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 1 = 0.518 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 2 = 0.611 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all KL = 0.513 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all L1 = 0.51 +- 0.198 (in-sample avg dev_std = 0.448)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:34:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:34:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9270 0.9270[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.232 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 class 1 = 0.196 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 class 2 = 0.704 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 all KL = 0.333 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.295 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.314
SUFF_SIMPLE for r=0.6 class 0 = 0.209 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 class 1 = 0.173 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 class 2 = 0.734 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 all KL = 0.337 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 all L1 = 0.378 +- 0.322 (in-sample avg dev_std = 0.157)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.439 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.205 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.295 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.27 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.307 +- 0.242 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.229 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 1 = 0.355 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 2 = 0.875 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all KL = 0.524 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all L1 = 0.486 +- 0.320 (in-sample avg dev_std = 0.002)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.229 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.355 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.875 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.524 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.486 +- 0.320 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.042
SUFF_SIMPLE for r=0.9 class 0 = 0.473 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.238 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.481 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.383 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.61
NEC for r=0.3 class 0 = 0.594 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 1 = 0.444 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 2 = 0.255 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all KL = 0.437 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all L1 = 0.427 +- 0.268 (in-sample avg dev_std = 0.416)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.582
NEC for r=0.6 class 0 = 0.642 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 class 1 = 0.449 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 class 2 = 0.329 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 all KL = 0.505 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 all L1 = 0.469 +- 0.250 (in-sample avg dev_std = 0.509)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.436
NEC for r=0.9 class 0 = 0.689 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 class 1 = 0.609 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 class 2 = 0.493 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 all KL = 0.668 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 all L1 = 0.594 +- 0.211 (in-sample avg dev_std = 0.599)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.77 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 class 1 = 0.641 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 class 2 = 0.126 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 all KL = 0.476 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 all L1 = 0.513 +- 0.318 (in-sample avg dev_std = 0.100)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.363
NEC for r=0.6 class 0 = 0.769 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 class 1 = 0.62 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 class 2 = 0.147 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 all KL = 0.482 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 all L1 = 0.512 +- 0.305 (in-sample avg dev_std = 0.233)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.34
NEC for r=0.9 class 0 = 0.755 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 1 = 0.639 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 2 = 0.19 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all KL = 0.507 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all L1 = 0.528 +- 0.285 (in-sample avg dev_std = 0.292)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:36:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:36:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 69 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9247 0.9247[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
SUFF_SIMPLE for r=0.3 class 0 = 0.226 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 class 1 = 0.237 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 class 2 = 0.621 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 all KL = 0.303 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 all L1 = 0.366 +- 0.270 (in-sample avg dev_std = 0.382)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.307
SUFF_SIMPLE for r=0.6 class 0 = 0.208 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 1 = 0.191 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 2 = 0.718 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all KL = 0.327 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all L1 = 0.379 +- 0.317 (in-sample avg dev_std = 0.174)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.214
SUFF_SIMPLE for r=0.9 class 0 = 0.45 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.272 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.261 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.291 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.32 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.229 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 1 = 0.406 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 2 = 0.897 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all KL = 0.543 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all L1 = 0.51 +- 0.329 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.23 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.407 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.898 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.543 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.512 +- 0.329 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.037
SUFF_SIMPLE for r=0.9 class 0 = 0.414 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.44 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.225 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.428 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.128 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.626
NEC for r=0.3 class 0 = 0.614 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 class 1 = 0.415 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 class 2 = 0.257 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 all KL = 0.44 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 all L1 = 0.424 +- 0.263 (in-sample avg dev_std = 0.427)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.55
NEC for r=0.6 class 0 = 0.662 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 1 = 0.464 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 2 = 0.402 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all KL = 0.558 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all L1 = 0.506 +- 0.237 (in-sample avg dev_std = 0.525)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.426
NEC for r=0.9 class 0 = 0.703 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 1 = 0.62 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 2 = 0.524 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all KL = 0.7 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all L1 = 0.613 +- 0.189 (in-sample avg dev_std = 0.625)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.384
NEC for r=0.3 class 0 = 0.768 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 class 1 = 0.528 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 class 2 = 0.101 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 all KL = 0.43 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 all L1 = 0.466 +- 0.316 (in-sample avg dev_std = 0.123)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.344
NEC for r=0.6 class 0 = 0.774 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 1 = 0.54 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 2 = 0.23 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all KL = 0.511 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all L1 = 0.515 +- 0.291 (in-sample avg dev_std = 0.295)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.328
NEC for r=0.9 class 0 = 0.754 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 1 = 0.581 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 2 = 0.266 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all KL = 0.551 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all L1 = 0.534 +- 0.267 (in-sample avg dev_std = 0.379)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:37:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:37:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.226 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 class 1 = 0.188 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 class 2 = 0.687 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 all KL = 0.31 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 all L1 = 0.372 +- 0.287 (in-sample avg dev_std = 0.369)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.198 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 class 1 = 0.168 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 class 2 = 0.728 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 all KL = 0.323 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.321 (in-sample avg dev_std = 0.155)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.204
SUFF_SIMPLE for r=0.9 class 0 = 0.415 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.244 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.299 +- 0.247 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.388 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 1 = 0.626 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 2 = 0.924 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.676 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.646 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.388 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.626 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.924 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.676 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.646 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.28
SUFF_SIMPLE for r=0.9 class 0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.516 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.611 +- 0.244 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.592
NEC for r=0.3 class 0 = 0.617 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 1 = 0.433 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 2 = 0.309 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all KL = 0.472 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all L1 = 0.449 +- 0.278 (in-sample avg dev_std = 0.410)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.563
NEC for r=0.6 class 0 = 0.659 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.425 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.353 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.511 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.475 +- 0.269 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.431
NEC for r=0.9 class 0 = 0.704 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 class 1 = 0.579 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 class 2 = 0.528 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 all KL = 0.685 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 all L1 = 0.601 +- 0.216 (in-sample avg dev_std = 0.597)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.612 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 class 1 = 0.369 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 class 2 = 0.076 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 all KL = 0.322 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 all L1 = 0.353 +- 0.333 (in-sample avg dev_std = 0.046)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.611 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 1 = 0.36 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 2 = 0.093 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all KL = 0.328 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all L1 = 0.355 +- 0.327 (in-sample avg dev_std = 0.138)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.333
NEC for r=0.9 class 0 = 0.598 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1 = 0.372 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 2 = 0.128 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.348 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.366 +- 0.317 (in-sample avg dev_std = 0.255)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:39:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:39:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.229 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 class 1 = 0.189 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 class 2 = 0.686 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 all KL = 0.311 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 all L1 = 0.374 +- 0.293 (in-sample avg dev_std = 0.362)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.2 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 1 = 0.167 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 2 = 0.716 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all KL = 0.313 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all L1 = 0.367 +- 0.319 (in-sample avg dev_std = 0.174)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.458 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.205 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.263 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.31 +- 0.249 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.175 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 class 1 = 0.225 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 class 2 = 0.765 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 all KL = 0.377 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 all L1 = 0.388 +- 0.310 (in-sample avg dev_std = 0.011)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.175 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.225 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.765 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.377 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.388 +- 0.310 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.222 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.464 +- 0.247 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0 = 0.603 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.408 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.302 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.463 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.434 +- 0.278 (in-sample avg dev_std = 0.421)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.578
NEC for r=0.6 class 0 = 0.649 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 1 = 0.411 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 2 = 0.367 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all KL = 0.52 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all L1 = 0.472 +- 0.265 (in-sample avg dev_std = 0.498)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.433
NEC for r=0.9 class 0 = 0.696 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 1 = 0.591 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 2 = 0.527 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all KL = 0.692 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all L1 = 0.602 +- 0.216 (in-sample avg dev_std = 0.609)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.824 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 1 = 0.764 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 2 = 0.235 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.62 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.608 +- 0.309 (in-sample avg dev_std = 0.114)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.36
NEC for r=0.6 class 0 = 0.825 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 class 1 = 0.751 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 class 2 = 0.276 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 all KL = 0.638 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 all L1 = 0.617 +- 0.285 (in-sample avg dev_std = 0.241)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.341
NEC for r=0.9 class 0 = 0.805 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 class 1 = 0.766 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 class 2 = 0.3 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 all KL = 0.653 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 all L1 = 0.623 +- 0.269 (in-sample avg dev_std = 0.354)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:41:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:41:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.218 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 1 = 0.188 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 2 = 0.715 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all KL = 0.318 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all L1 = 0.38 +- 0.301 (in-sample avg dev_std = 0.352)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.314
SUFF_SIMPLE for r=0.6 class 0 = 0.199 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 class 1 = 0.17 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 class 2 = 0.733 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 all KL = 0.322 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 all L1 = 0.374 +- 0.326 (in-sample avg dev_std = 0.171)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.207
SUFF_SIMPLE for r=0.9 class 0 = 0.44 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.2 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.285 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.248 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.302 +- 0.258 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.161 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 class 1 = 0.201 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 class 2 = 0.563 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 all KL = 0.28 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 all L1 = 0.309 +- 0.264 (in-sample avg dev_std = 0.021)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.161 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.563 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.28 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.309 +- 0.264 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.406
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.831 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.412 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.729 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.286 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0 = 0.61 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 1 = 0.471 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 2 = 0.279 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all KL = 0.478 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all L1 = 0.449 +- 0.277 (in-sample avg dev_std = 0.419)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.558
NEC for r=0.6 class 0 = 0.665 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 1 = 0.461 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 2 = 0.334 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all KL = 0.529 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all L1 = 0.482 +- 0.264 (in-sample avg dev_std = 0.471)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.7 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.608 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.513 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.694 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.605 +- 0.214 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.838 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 class 1 = 0.794 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 class 2 = 0.437 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all KL = 0.718 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all L1 = 0.69 +- 0.264 (in-sample avg dev_std = 0.056)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.839 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 class 1 = 0.789 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 class 2 = 0.456 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 all KL = 0.728 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 all L1 = 0.694 +- 0.249 (in-sample avg dev_std = 0.144)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.336
NEC for r=0.9 class 0 = 0.815 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 class 1 = 0.787 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 class 2 = 0.475 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 all KL = 0.736 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 all L1 = 0.692 +- 0.223 (in-sample avg dev_std = 0.361)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:43:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:43:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 82 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.22 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 1 = 0.202 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 2 = 0.674 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all KL = 0.306 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all L1 = 0.371 +- 0.292 (in-sample avg dev_std = 0.371)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.196 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 class 1 = 0.17 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 class 2 = 0.73 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 all KL = 0.319 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 all L1 = 0.372 +- 0.326 (in-sample avg dev_std = 0.162)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.205
SUFF_SIMPLE for r=0.9 class 0 = 0.409 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.205 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.234 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.251 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 1 = 0.526 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 2 = 0.932 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.603 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.569 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.251 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.526 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.932 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.603 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.569 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.05
SUFF_SIMPLE for r=0.9 class 0 = 0.347 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.382 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.124 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.595
NEC for r=0.3 class 0 = 0.611 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.464 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.271 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.468 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.445 +- 0.281 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.576
NEC for r=0.6 class 0 = 0.65 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.452 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.311 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.502 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.467 +- 0.271 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.428
NEC for r=0.9 class 0 = 0.697 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 class 1 = 0.619 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 class 2 = 0.508 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 all KL = 0.693 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 all L1 = 0.605 +- 0.211 (in-sample avg dev_std = 0.616)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.749 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 1 = 0.47 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 2 = 0.068 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all KL = 0.395 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all L1 = 0.429 +- 0.336 (in-sample avg dev_std = 0.036)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.332
NEC for r=0.6 class 0 = 0.75 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 class 1 = 0.469 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 class 2 = 0.118 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all KL = 0.421 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all L1 = 0.446 +- 0.319 (in-sample avg dev_std = 0.116)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.335
NEC for r=0.9 class 0 = 0.733 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 1 = 0.478 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 2 = 0.153 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all KL = 0.445 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all L1 = 0.455 +- 0.302 (in-sample avg dev_std = 0.299)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.312, 0.33, 0.286], 'all_L1': [0.374, 0.377, 0.32]}), defaultdict(<class 'list'>, {'all_KL': [0.274, 0.324, 0.335], 'all_L1': [0.337, 0.366, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.316, 0.322, 0.255], 'all_L1': [0.378, 0.374, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.304, 0.318, 0.355], 'all_L1': [0.373, 0.361, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.337, 0.27], 'all_L1': [0.383, 0.378, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.327, 0.291], 'all_L1': [0.366, 0.379, 0.32]}), defaultdict(<class 'list'>, {'all_KL': [0.31, 0.323, 0.244], 'all_L1': [0.372, 0.371, 0.299]}), defaultdict(<class 'list'>, {'all_KL': [0.311, 0.313, 0.263], 'all_L1': [0.374, 0.367, 0.31]}), defaultdict(<class 'list'>, {'all_KL': [0.318, 0.322, 0.248], 'all_L1': [0.38, 0.374, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.306, 0.319, 0.246], 'all_L1': [0.371, 0.372, 0.297]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.442, 0.528, 0.692], 'all_L1': [0.421, 0.477, 0.603]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.532, 0.679], 'all_L1': [0.41, 0.492, 0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.517, 0.696], 'all_L1': [0.43, 0.472, 0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.391, 0.552, 0.702], 'all_L1': [0.382, 0.501, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.505, 0.668], 'all_L1': [0.427, 0.469, 0.594]}), defaultdict(<class 'list'>, {'all_KL': [0.44, 0.558, 0.7], 'all_L1': [0.424, 0.506, 0.613]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.511, 0.685], 'all_L1': [0.449, 0.475, 0.601]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.52, 0.692], 'all_L1': [0.434, 0.472, 0.602]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.529, 0.694], 'all_L1': [0.449, 0.482, 0.605]}), defaultdict(<class 'list'>, {'all_KL': [0.468, 0.502, 0.693], 'all_L1': [0.445, 0.467, 0.605]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.256, 0.254, 0.72], 'all_L1': [0.299, 0.298, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.722, 0.731, 0.873], 'all_L1': [0.719, 0.723, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.68, 0.667], 'all_L1': [0.659, 0.659, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.558, 0.667], 'all_L1': [0.55, 0.522, 0.587]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.524, 0.481], 'all_L1': [0.486, 0.486, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.543, 0.428], 'all_L1': [0.51, 0.512, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.676, 0.625], 'all_L1': [0.646, 0.646, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.377, 0.542], 'all_L1': [0.388, 0.388, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.28, 0.729], 'all_L1': [0.309, 0.309, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.603, 0.603, 0.345], 'all_L1': [0.569, 0.569, 0.314]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.74, 0.758, 0.761], 'all_L1': [0.697, 0.708, 0.692]}), defaultdict(<class 'list'>, {'all_KL': [0.342, 0.382, 0.425], 'all_L1': [0.278, 0.325, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.345, 0.363], 'all_L1': [0.337, 0.354, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.469, 0.513], 'all_L1': [0.414, 0.479, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.476, 0.482, 0.507], 'all_L1': [0.513, 0.512, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.511, 0.551], 'all_L1': [0.466, 0.515, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.322, 0.328, 0.348], 'all_L1': [0.353, 0.355, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.62, 0.638, 0.653], 'all_L1': [0.608, 0.617, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.718, 0.728, 0.736], 'all_L1': [0.69, 0.694, 0.692]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.421, 0.445], 'all_L1': [0.429, 0.446, 0.455]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.371 +- 0.012, 0.372 +- 0.005, 0.320 +- 0.025
suff_simple class all_KL  =  0.309 +- 0.014, 0.324 +- 0.006, 0.279 +- 0.036
[[0.33774998784065247, 0.3125, 0.21301774680614471], [0.32508334517478943, 0.31845831871032715, 0.2705755829811096], [0.336083322763443, 0.3109166622161865, 0.2092522829771042], [0.33033332228660583, 0.32370832562446594, 0.27541688084602356], [0.3362500071525574, 0.31429165601730347, 0.20763851702213287], [0.3310000002384186, 0.30658334493637085, 0.21355567872524261], [0.33633333444595337, 0.312375009059906, 0.20387305319309235], [0.335750013589859, 0.3109166622161865, 0.20817643404006958], [0.336083322763443, 0.3137499988079071, 0.20656266808509827], [0.3293333351612091, 0.31216666102409363, 0.20494890213012695]]
[[0.312, 0.33, 0.286], [0.274, 0.324, 0.335], [0.316, 0.322, 0.255], [0.304, 0.318, 0.355], [0.333, 0.337, 0.27], [0.303, 0.327, 0.291], [0.31, 0.323, 0.244], [0.311, 0.313, 0.263], [0.318, 0.322, 0.248], [0.306, 0.319, 0.246]]
suff_simple_acc_int  =  0.333 +- 0.004, 0.314 +- 0.004, 0.221 +- 0.026
nec class all_L1  =  0.427 +- 0.019, 0.481 +- 0.013, 0.605 +- 0.006
nec class all_KL  =  0.446 +- 0.026, 0.525 +- 0.018, 0.690 +- 0.010
[[0.6347500085830688, 0.5766249895095825, 0.43149998784065247], [0.6525416374206543, 0.574999988079071, 0.4261249899864197], [0.6110833287239075, 0.5879166722297668, 0.4359166622161865], [0.6792083382606506, 0.559333324432373, 0.4175833463668823], [0.6100416779518127, 0.5824999809265137, 0.4362916648387909], [0.6264166831970215, 0.5503333210945129, 0.4257499873638153], [0.5921666622161865, 0.562583327293396, 0.4311249852180481], [0.6030833125114441, 0.5777083039283752, 0.43287500739097595], [0.590458333492279, 0.5581250190734863, 0.43045833706855774], [0.5947083234786987, 0.5759166479110718, 0.42770832777023315]]
[[0.442, 0.528, 0.692], [0.416, 0.532, 0.679], [0.456, 0.517, 0.696], [0.391, 0.552, 0.702], [0.437, 0.505, 0.668], [0.44, 0.558, 0.7], [0.472, 0.511, 0.685], [0.463, 0.52, 0.692], [0.478, 0.529, 0.694], [0.468, 0.502, 0.693]]
nec_acc_int  =  0.619 +- 0.028, 0.571 +- 0.012, 0.430 +- 0.005

Eval split val
suff_simple class all_L1  =  0.513 +- 0.138, 0.511 +- 0.138, 0.553 +- 0.163
suff_simple class all_KL  =  0.524 +- 0.158, 0.523 +- 0.159, 0.608 +- 0.151
[[0.33420833945274353, 0.33399999141693115, 0.1711939424276352], [0.3384583294391632, 0.3396666646003723, 0.44219836592674255], [0.33399999141693115, 0.33399999141693115, 0.2299431413412094], [0.328291654586792, 0.3356666564941406, 0.16929879784584045], [0.33399999141693115, 0.33399999141693115, 0.042324699461460114], [0.33399999141693115, 0.33399999141693115, 0.03727100417017937], [0.33399999141693115, 0.33399999141693115, 0.2804800868034363], [0.33399999141693115, 0.33399999141693115, 0.16929879784584045], [0.33375000953674316, 0.33399999141693115, 0.1711939424276352], [0.33399999141693115, 0.33399999141693115, 0.04990524426102638]]
[[0.256, 0.254, 0.72], [0.722, 0.731, 0.873], [0.68, 0.68, 0.667], [0.578, 0.558, 0.667], [0.524, 0.524, 0.481], [0.543, 0.543, 0.428], [0.676, 0.676, 0.625], [0.377, 0.377, 0.542], [0.28, 0.28, 0.729], [0.603, 0.603, 0.345]]
suff_simple_acc_int  =  0.334 +- 0.002, 0.335 +- 0.002, 0.176 +- 0.117
nec class all_L1  =  0.479 +- 0.139, 0.500 +- 0.131, 0.512 +- 0.122
nec class all_KL  =  0.472 +- 0.154, 0.506 +- 0.146, 0.530 +- 0.138
[[0.34441667795181274, 0.3722499907016754, 0.3477500081062317], [0.5441250205039978, 0.4390000104904175, 0.34329167008399963], [0.3435416519641876, 0.35870832204818726, 0.34291666746139526], [0.6825416684150696, 0.5870000123977661, 0.3801666796207428], [0.343708336353302, 0.36254167556762695, 0.34033334255218506], [0.3840416669845581, 0.343916654586792, 0.328166663646698], [0.33399999141693115, 0.3293333351612091, 0.3330833315849304], [0.343874990940094, 0.36024999618530273, 0.3408749997615814], [0.33399999141693115, 0.32895833253860474, 0.3356249928474426], [0.33399999141693115, 0.3318749964237213, 0.33520832657814026]]
[[0.74, 0.758, 0.761], [0.342, 0.382, 0.425], [0.315, 0.345, 0.363], [0.363, 0.469, 0.513], [0.476, 0.482, 0.507], [0.43, 0.511, 0.551], [0.322, 0.328, 0.348], [0.62, 0.638, 0.653], [0.718, 0.728, 0.736], [0.395, 0.421, 0.445]]
nec_acc_int  =  0.399 +- 0.112, 0.381 +- 0.075, 0.343 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.399 +- 0.013, 0.427 +- 0.006, 0.463 +- 0.015
Faith. Armon (L1)= 		  =  0.397 +- 0.013, 0.419 +- 0.005, 0.418 +- 0.022
Faith. GMean (L1)= 	  =  0.398 +- 0.013, 0.423 +- 0.006, 0.440 +- 0.018
Faith. Aritm (KL)= 		  =  0.377 +- 0.017, 0.424 +- 0.009, 0.485 +- 0.019
Faith. Armon (KL)= 		  =  0.365 +- 0.016, 0.400 +- 0.007, 0.396 +- 0.036
Faith. GMean (KL)= 	  =  0.371 +- 0.016, 0.412 +- 0.008, 0.438 +- 0.028

Eval split val
Faith. Aritm (L1)= 		  =  0.496 +- 0.006, 0.506 +- 0.007, 0.532 +- 0.091
Faith. Armon (L1)= 		  =  0.457 +- 0.031, 0.470 +- 0.031, 0.508 +- 0.095
Faith. GMean (L1)= 	  =  0.476 +- 0.016, 0.487 +- 0.016, 0.520 +- 0.092
Faith. Aritm (KL)= 		  =  0.498 +- 0.014, 0.514 +- 0.016, 0.569 +- 0.108
Faith. Armon (KL)= 		  =  0.449 +- 0.035, 0.469 +- 0.046, 0.550 +- 0.111
Faith. GMean (KL)= 	  =  0.472 +- 0.020, 0.491 +- 0.029, 0.559 +- 0.109
Computed for split load_split = id



Completed in  0:21:53.594396  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN PLAIN GOODMotif/basis/covariate NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:46:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:46:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 74 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3398
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3313
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3398
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3313

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.235 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 class 1 = 0.21 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 class 2 = 0.662 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 all KL = 0.312 +- 0.348 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.3 all L1 = 0.374 +- 0.285 (in-sample avg dev_std = 0.391)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.208 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 1 = 0.173 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 2 = 0.729 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.33 +- 0.402 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.377 +- 0.324 (in-sample avg dev_std = 0.169)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.213
SUFF_SIMPLE for r=0.9 class 0 = 0.482 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.286 +- 0.336 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.32 +- 0.254 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.162 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 class 1 = 0.174 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 class 2 = 0.561 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 all KL = 0.256 +- 0.338 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.3 all L1 = 0.299 +- 0.266 (in-sample avg dev_std = 0.055)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.16 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 class 1 = 0.174 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 class 2 = 0.559 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 all KL = 0.254 +- 0.338 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.6 all L1 = 0.298 +- 0.266 (in-sample avg dev_std = 0.005)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.401
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.884 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.806 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.416 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.72 +- 0.296 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.647 +- 0.287 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.635
NEC for r=0.3 class 0 = 0.594 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.397 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.285 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.442 +- 0.344 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.421 +- 0.268 (in-sample avg dev_std = 0.428)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.577
NEC for r=0.6 class 0 = 0.635 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 1 = 0.432 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 class 2 = 0.373 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all KL = 0.528 +- 0.328 (in-sample avg dev_std = 0.534)
NEC for r=0.6 all L1 = 0.477 +- 0.250 (in-sample avg dev_std = 0.534)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.431
NEC for r=0.9 class 0 = 0.685 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 1 = 0.604 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 class 2 = 0.525 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all KL = 0.692 +- 0.273 (in-sample avg dev_std = 0.627)
NEC for r=0.9 all L1 = 0.603 +- 0.206 (in-sample avg dev_std = 0.627)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.838 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 class 1 = 0.812 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 class 2 = 0.441 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 all KL = 0.74 +- 0.337 (in-sample avg dev_std = 0.119)
NEC for r=0.3 all L1 = 0.697 +- 0.265 (in-sample avg dev_std = 0.119)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.372
NEC for r=0.6 class 0 = 0.838 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1 = 0.797 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 2 = 0.49 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.758 +- 0.296 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.708 +- 0.227 (in-sample avg dev_std = 0.258)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.348
NEC for r=0.9 class 0 = 0.799 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 class 1 = 0.795 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 class 2 = 0.481 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 all KL = 0.761 +- 0.266 (in-sample avg dev_std = 0.465)
NEC for r=0.9 all L1 = 0.692 +- 0.206 (in-sample avg dev_std = 0.465)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:48:39 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:48:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3183
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3359
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3294
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3294

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.325
SUFF_SIMPLE for r=0.3 class 0 = 0.436 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 1 = 0.23 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 class 2 = 0.347 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all KL = 0.274 +- 0.233 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.3 all L1 = 0.337 +- 0.175 (in-sample avg dev_std = 0.331)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.318
SUFF_SIMPLE for r=0.6 class 0 = 0.661 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 class 1 = 0.194 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 class 2 = 0.26 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 all KL = 0.324 +- 0.340 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.6 all L1 = 0.366 +- 0.263 (in-sample avg dev_std = 0.142)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.271
SUFF_SIMPLE for r=0.9 class 0 = 0.74 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.209 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.219 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.335 +- 0.378 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.369 +- 0.303 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF_SIMPLE for r=0.3 class 0 = 0.76 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 class 1 = 0.545 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 class 2 = 0.85 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 all KL = 0.722 +- 0.351 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.3 all L1 = 0.719 +- 0.319 (in-sample avg dev_std = 0.041)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF_SIMPLE for r=0.6 class 0 = 0.795 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.546 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.825 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.731 +- 0.358 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.723 +- 0.319 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.493
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
SUFF_SIMPLE for r=0.9 class 0 = 0.975 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.883 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.873 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.653
NEC for r=0.3 class 0 = 0.498 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1 = 0.443 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 2 = 0.296 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.416 +- 0.323 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.41 +- 0.250 (in-sample avg dev_std = 0.412)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.575
NEC for r=0.6 class 0 = 0.539 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 1 = 0.463 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 class 2 = 0.475 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all KL = 0.532 +- 0.302 (in-sample avg dev_std = 0.521)
NEC for r=0.6 all L1 = 0.492 +- 0.228 (in-sample avg dev_std = 0.521)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.426
NEC for r=0.9 class 0 = 0.522 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 1 = 0.611 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 class 2 = 0.678 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all KL = 0.679 +- 0.274 (in-sample avg dev_std = 0.576)
NEC for r=0.9 all L1 = 0.606 +- 0.206 (in-sample avg dev_std = 0.576)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.532
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.544
NEC for r=0.3 class 0 = 0.373 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 1 = 0.365 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 class 2 = 0.095 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all KL = 0.342 +- 0.334 (in-sample avg dev_std = 0.217)
NEC for r=0.3 all L1 = 0.278 +- 0.269 (in-sample avg dev_std = 0.217)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.532
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.439
NEC for r=0.6 class 0 = 0.399 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 1 = 0.374 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 class 2 = 0.201 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all KL = 0.382 +- 0.345 (in-sample avg dev_std = 0.311)
NEC for r=0.6 all L1 = 0.325 +- 0.282 (in-sample avg dev_std = 0.311)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.532
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.343
NEC for r=0.9 class 0 = 0.298 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 1 = 0.441 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 2 = 0.339 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 all KL = 0.425 +- 0.379 (in-sample avg dev_std = 0.317)
NEC for r=0.9 all L1 = 0.359 +- 0.302 (in-sample avg dev_std = 0.317)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:51:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:51:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3177
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3348
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3317
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3348
OOD Test ACCURACY: 0.9250
OOD Test Loss: 0.3317

[0m[1;37mINFO[0m: [1mChartInfo 0.9250 0.9250 0.9250 0.9250 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.221 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 class 2 = 0.707 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 all KL = 0.316 +- 0.366 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.3 all L1 = 0.378 +- 0.299 (in-sample avg dev_std = 0.343)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.201 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 1 = 0.171 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 class 2 = 0.73 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all KL = 0.322 +- 0.403 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.6 all L1 = 0.374 +- 0.324 (in-sample avg dev_std = 0.169)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.209
SUFF_SIMPLE for r=0.9 class 0 = 0.446 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.214 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.281 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.255 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.307 +- 0.255 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.456 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 1 = 0.577 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 2 = 0.944 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.68 +- 0.373 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.659 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.456 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.577 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.944 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.68 +- 0.374 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.659 +- 0.350 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.23
SUFF_SIMPLE for r=0.9 class 0 = 0.88 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.744 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.536 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.372 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.675 +- 0.293 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.611
NEC for r=0.3 class 0 = 0.595 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 1 = 0.431 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 2 = 0.277 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all KL = 0.456 +- 0.349 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all L1 = 0.43 +- 0.268 (in-sample avg dev_std = 0.422)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.588
NEC for r=0.6 class 0 = 0.647 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 class 1 = 0.437 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 class 2 = 0.344 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 all KL = 0.517 +- 0.334 (in-sample avg dev_std = 0.515)
NEC for r=0.6 all L1 = 0.472 +- 0.253 (in-sample avg dev_std = 0.515)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.436
NEC for r=0.9 class 0 = 0.693 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 class 1 = 0.617 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 class 2 = 0.516 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 all KL = 0.696 +- 0.269 (in-sample avg dev_std = 0.623)
NEC for r=0.9 all L1 = 0.606 +- 0.200 (in-sample avg dev_std = 0.623)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.542 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 1 = 0.412 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 2 = 0.056 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all KL = 0.315 +- 0.368 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all L1 = 0.337 +- 0.346 (in-sample avg dev_std = 0.106)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.544 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 1 = 0.406 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 2 = 0.113 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all KL = 0.345 +- 0.357 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all L1 = 0.354 +- 0.333 (in-sample avg dev_std = 0.225)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.591
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.343
NEC for r=0.9 class 0 = 0.529 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 1 = 0.419 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 2 = 0.138 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all KL = 0.363 +- 0.350 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all L1 = 0.362 +- 0.324 (in-sample avg dev_std = 0.297)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:53:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:53:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3295
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3492
ID Test ACCURACY: 0.9247
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3492
OOD Test ACCURACY: 0.9247
OOD Test Loss: 0.3354

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.9247 0.9247 0.9247 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.312 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 class 1 = 0.229 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 class 2 = 0.568 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 all KL = 0.304 +- 0.319 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.3 all L1 = 0.373 +- 0.261 (in-sample avg dev_std = 0.385)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.324
SUFF_SIMPLE for r=0.6 class 0 = 0.457 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 class 1 = 0.187 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 class 2 = 0.442 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 all KL = 0.318 +- 0.300 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.6 all L1 = 0.361 +- 0.235 (in-sample avg dev_std = 0.158)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.275
SUFF_SIMPLE for r=0.9 class 0 = 0.683 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.227 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.24 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.355 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.366 +- 0.270 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.328
SUFF_SIMPLE for r=0.3 class 0 = 0.641 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 class 1 = 0.541 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 class 2 = 0.466 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 all KL = 0.578 +- 0.307 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.3 all L1 = 0.55 +- 0.265 (in-sample avg dev_std = 0.155)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.336
SUFF_SIMPLE for r=0.6 class 0 = 0.545 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 class 1 = 0.513 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 class 2 = 0.507 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 all KL = 0.558 +- 0.292 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.6 all L1 = 0.522 +- 0.206 (in-sample avg dev_std = 0.025)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.434
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.804 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.764 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.348 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.667 +- 0.283 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.587 +- 0.277 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.679
NEC for r=0.3 class 0 = 0.554 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.351 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.252 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.391 +- 0.319 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.382 +- 0.254 (in-sample avg dev_std = 0.421)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.617 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 1 = 0.435 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 class 2 = 0.457 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all KL = 0.552 +- 0.302 (in-sample avg dev_std = 0.556)
NEC for r=0.6 all L1 = 0.501 +- 0.226 (in-sample avg dev_std = 0.556)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.418
NEC for r=0.9 class 0 = 0.612 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 class 1 = 0.607 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 class 2 = 0.634 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 all KL = 0.702 +- 0.238 (in-sample avg dev_std = 0.595)
NEC for r=0.9 all L1 = 0.618 +- 0.166 (in-sample avg dev_std = 0.595)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.66
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.683
NEC for r=0.3 class 0 = 0.368 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 1 = 0.54 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 2 = 0.336 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all KL = 0.363 +- 0.230 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all L1 = 0.414 +- 0.201 (in-sample avg dev_std = 0.289)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.66
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.587
NEC for r=0.6 class 0 = 0.456 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.548 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.434 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.469 +- 0.266 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.479 +- 0.196 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.66
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.38
NEC for r=0.9 class 0 = 0.403 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 1 = 0.518 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 class 2 = 0.611 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all KL = 0.513 +- 0.250 (in-sample avg dev_std = 0.448)
NEC for r=0.9 all L1 = 0.51 +- 0.198 (in-sample avg dev_std = 0.448)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:55:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:55:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3193
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3366
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3298
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.3366
OOD Test ACCURACY: 0.9263
OOD Test Loss: 0.3298

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.9263 0.9263 0.9263 0.9270 0.9270[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.232 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 class 1 = 0.196 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 class 2 = 0.704 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 all KL = 0.333 +- 0.354 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.295 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.314
SUFF_SIMPLE for r=0.6 class 0 = 0.209 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 class 1 = 0.173 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 class 2 = 0.734 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 all KL = 0.337 +- 0.397 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.6 all L1 = 0.378 +- 0.322 (in-sample avg dev_std = 0.157)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.439 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.205 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.295 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.27 +- 0.327 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.307 +- 0.242 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.229 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 1 = 0.355 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 class 2 = 0.875 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all KL = 0.524 +- 0.344 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.3 all L1 = 0.486 +- 0.320 (in-sample avg dev_std = 0.002)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.229 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.355 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.875 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.524 +- 0.344 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.486 +- 0.320 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.042
SUFF_SIMPLE for r=0.9 class 0 = 0.473 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.509 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.238 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.481 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.383 +- 0.154 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.927
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.61
NEC for r=0.3 class 0 = 0.594 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 1 = 0.444 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 2 = 0.255 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all KL = 0.437 +- 0.341 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all L1 = 0.427 +- 0.268 (in-sample avg dev_std = 0.416)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.927
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.582
NEC for r=0.6 class 0 = 0.642 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 class 1 = 0.449 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 class 2 = 0.329 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 all KL = 0.505 +- 0.321 (in-sample avg dev_std = 0.509)
NEC for r=0.6 all L1 = 0.469 +- 0.250 (in-sample avg dev_std = 0.509)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.436
NEC for r=0.9 class 0 = 0.689 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 class 1 = 0.609 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 class 2 = 0.493 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 all KL = 0.668 +- 0.276 (in-sample avg dev_std = 0.599)
NEC for r=0.9 all L1 = 0.594 +- 0.211 (in-sample avg dev_std = 0.599)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.77 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 class 1 = 0.641 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 class 2 = 0.126 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 all KL = 0.476 +- 0.342 (in-sample avg dev_std = 0.100)
NEC for r=0.3 all L1 = 0.513 +- 0.318 (in-sample avg dev_std = 0.100)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.363
NEC for r=0.6 class 0 = 0.769 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 class 1 = 0.62 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 class 2 = 0.147 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 all KL = 0.482 +- 0.327 (in-sample avg dev_std = 0.233)
NEC for r=0.6 all L1 = 0.512 +- 0.305 (in-sample avg dev_std = 0.233)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.34
NEC for r=0.9 class 0 = 0.755 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 1 = 0.639 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 2 = 0.19 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all KL = 0.507 +- 0.303 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all L1 = 0.528 +- 0.285 (in-sample avg dev_std = 0.292)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:57:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:57:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 69 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 69...
[0m[1;37mINFO[0m: [1mCheckpoint 69: 
-----------------------------------
Train ACCURACY: 0.9273
Train Loss: 0.3195
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3287
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.3395
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3287

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9247 0.9247[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
SUFF_SIMPLE for r=0.3 class 0 = 0.226 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 class 1 = 0.237 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 class 2 = 0.621 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 all KL = 0.303 +- 0.331 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 all L1 = 0.366 +- 0.270 (in-sample avg dev_std = 0.382)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.307
SUFF_SIMPLE for r=0.6 class 0 = 0.208 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 1 = 0.191 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 2 = 0.718 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all KL = 0.327 +- 0.382 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all L1 = 0.379 +- 0.317 (in-sample avg dev_std = 0.174)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.214
SUFF_SIMPLE for r=0.9 class 0 = 0.45 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.272 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.261 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.291 +- 0.302 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.32 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.229 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 1 = 0.406 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 class 2 = 0.897 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all KL = 0.543 +- 0.362 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.3 all L1 = 0.51 +- 0.329 (in-sample avg dev_std = 0.001)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.23 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.407 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.898 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.543 +- 0.361 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.512 +- 0.329 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.577
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.037
SUFF_SIMPLE for r=0.9 class 0 = 0.414 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.44 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.225 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.428 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.34 +- 0.128 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.925
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.626
NEC for r=0.3 class 0 = 0.614 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 class 1 = 0.415 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 class 2 = 0.257 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 all KL = 0.44 +- 0.338 (in-sample avg dev_std = 0.427)
NEC for r=0.3 all L1 = 0.424 +- 0.263 (in-sample avg dev_std = 0.427)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.925
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.55
NEC for r=0.6 class 0 = 0.662 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 1 = 0.464 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 2 = 0.402 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all KL = 0.558 +- 0.311 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all L1 = 0.506 +- 0.237 (in-sample avg dev_std = 0.525)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.426
NEC for r=0.9 class 0 = 0.703 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 1 = 0.62 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 2 = 0.524 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all KL = 0.7 +- 0.254 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all L1 = 0.613 +- 0.189 (in-sample avg dev_std = 0.625)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.714
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.384
NEC for r=0.3 class 0 = 0.768 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 class 1 = 0.528 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 class 2 = 0.101 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 all KL = 0.43 +- 0.348 (in-sample avg dev_std = 0.123)
NEC for r=0.3 all L1 = 0.466 +- 0.316 (in-sample avg dev_std = 0.123)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.344
NEC for r=0.6 class 0 = 0.774 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 1 = 0.54 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 2 = 0.23 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all KL = 0.511 +- 0.344 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all L1 = 0.515 +- 0.291 (in-sample avg dev_std = 0.295)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.714
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.328
NEC for r=0.9 class 0 = 0.754 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 1 = 0.581 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 2 = 0.266 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all KL = 0.551 +- 0.302 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all L1 = 0.534 +- 0.267 (in-sample avg dev_std = 0.379)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:58:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:58:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9281
Train Loss: 0.3182
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3378
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3325
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3378
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3325

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.226 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 class 1 = 0.188 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 class 2 = 0.687 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 all KL = 0.31 +- 0.354 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.3 all L1 = 0.372 +- 0.287 (in-sample avg dev_std = 0.369)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.198 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 class 1 = 0.168 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 class 2 = 0.728 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 all KL = 0.323 +- 0.399 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.6 all L1 = 0.371 +- 0.321 (in-sample avg dev_std = 0.155)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.204
SUFF_SIMPLE for r=0.9 class 0 = 0.415 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.206 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.244 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.299 +- 0.247 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.388 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 1 = 0.626 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 2 = 0.924 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.676 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.646 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.388 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.626 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.924 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.676 +- 0.364 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.646 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.28
SUFF_SIMPLE for r=0.9 class 0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.662 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.516 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.625 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.611 +- 0.244 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.592
NEC for r=0.3 class 0 = 0.617 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 1 = 0.433 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 2 = 0.309 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all KL = 0.472 +- 0.353 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all L1 = 0.449 +- 0.278 (in-sample avg dev_std = 0.410)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.563
NEC for r=0.6 class 0 = 0.659 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 1 = 0.425 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 class 2 = 0.353 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all KL = 0.511 +- 0.341 (in-sample avg dev_std = 0.458)
NEC for r=0.6 all L1 = 0.475 +- 0.269 (in-sample avg dev_std = 0.458)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.431
NEC for r=0.9 class 0 = 0.704 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 class 1 = 0.579 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 class 2 = 0.528 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 all KL = 0.685 +- 0.285 (in-sample avg dev_std = 0.597)
NEC for r=0.9 all L1 = 0.601 +- 0.216 (in-sample avg dev_std = 0.597)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.612 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 class 1 = 0.369 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 class 2 = 0.076 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 all KL = 0.322 +- 0.362 (in-sample avg dev_std = 0.046)
NEC for r=0.3 all L1 = 0.353 +- 0.333 (in-sample avg dev_std = 0.046)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.615
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.611 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 1 = 0.36 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 class 2 = 0.093 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all KL = 0.328 +- 0.354 (in-sample avg dev_std = 0.138)
NEC for r=0.6 all L1 = 0.355 +- 0.327 (in-sample avg dev_std = 0.138)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.615
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.333
NEC for r=0.9 class 0 = 0.598 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1 = 0.372 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 2 = 0.128 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.348 +- 0.347 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.366 +- 0.317 (in-sample avg dev_std = 0.255)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:00:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:00:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9278
Train Loss: 0.3195
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3383
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3281
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.3383
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3281

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9257 0.9257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.229 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 class 1 = 0.189 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 class 2 = 0.686 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 all KL = 0.311 +- 0.362 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.3 all L1 = 0.374 +- 0.293 (in-sample avg dev_std = 0.362)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.311
SUFF_SIMPLE for r=0.6 class 0 = 0.2 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 1 = 0.167 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 class 2 = 0.716 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all KL = 0.313 +- 0.401 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.6 all L1 = 0.367 +- 0.319 (in-sample avg dev_std = 0.174)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.208
SUFF_SIMPLE for r=0.9 class 0 = 0.458 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.205 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.287 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.263 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.31 +- 0.249 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.175 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 class 1 = 0.225 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 class 2 = 0.765 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 all KL = 0.377 +- 0.376 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.3 all L1 = 0.388 +- 0.310 (in-sample avg dev_std = 0.011)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.175 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.225 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.765 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.377 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.388 +- 0.310 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.169
SUFF_SIMPLE for r=0.9 class 0 = 0.622 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.67 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.222 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.542 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.464 +- 0.247 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.603
NEC for r=0.3 class 0 = 0.603 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1 = 0.408 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 2 = 0.302 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.463 +- 0.355 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.434 +- 0.278 (in-sample avg dev_std = 0.421)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.578
NEC for r=0.6 class 0 = 0.649 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 1 = 0.411 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 2 = 0.367 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all KL = 0.52 +- 0.337 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all L1 = 0.472 +- 0.265 (in-sample avg dev_std = 0.498)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.433
NEC for r=0.9 class 0 = 0.696 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 1 = 0.591 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 class 2 = 0.527 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all KL = 0.692 +- 0.282 (in-sample avg dev_std = 0.609)
NEC for r=0.9 all L1 = 0.602 +- 0.216 (in-sample avg dev_std = 0.609)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.344
NEC for r=0.3 class 0 = 0.824 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 1 = 0.764 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 2 = 0.235 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.62 +- 0.374 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.608 +- 0.309 (in-sample avg dev_std = 0.114)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.36
NEC for r=0.6 class 0 = 0.825 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 class 1 = 0.751 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 class 2 = 0.276 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 all KL = 0.638 +- 0.347 (in-sample avg dev_std = 0.241)
NEC for r=0.6 all L1 = 0.617 +- 0.285 (in-sample avg dev_std = 0.241)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.715
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.341
NEC for r=0.9 class 0 = 0.805 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 class 1 = 0.766 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 class 2 = 0.3 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 all KL = 0.653 +- 0.326 (in-sample avg dev_std = 0.354)
NEC for r=0.9 all L1 = 0.623 +- 0.269 (in-sample avg dev_std = 0.354)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:02:26 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:02:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3178
ID Validation ACCURACY: 0.9263
ID Validation Loss: 0.3346
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3299
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.9257
OOD Test Loss: 0.3299

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.9257 0.9257 0.9257 0.9263 0.9263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.218 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 1 = 0.188 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 class 2 = 0.715 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all KL = 0.318 +- 0.365 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.3 all L1 = 0.38 +- 0.301 (in-sample avg dev_std = 0.352)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.314
SUFF_SIMPLE for r=0.6 class 0 = 0.199 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 class 1 = 0.17 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 class 2 = 0.733 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 all KL = 0.322 +- 0.402 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.6 all L1 = 0.374 +- 0.326 (in-sample avg dev_std = 0.171)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.207
SUFF_SIMPLE for r=0.9 class 0 = 0.44 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.2 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.285 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.248 +- 0.337 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.302 +- 0.258 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.161 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 class 1 = 0.201 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 class 2 = 0.563 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 all KL = 0.28 +- 0.333 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.3 all L1 = 0.309 +- 0.264 (in-sample avg dev_std = 0.021)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.161 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.201 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.563 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.28 +- 0.333 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.309 +- 0.264 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.406
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.171
SUFF_SIMPLE for r=0.9 class 0 = 0.886 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.831 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.412 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.729 +- 0.298 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.286 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.926
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0 = 0.61 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 1 = 0.471 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 class 2 = 0.279 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all KL = 0.478 +- 0.352 (in-sample avg dev_std = 0.419)
NEC for r=0.3 all L1 = 0.449 +- 0.277 (in-sample avg dev_std = 0.419)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.558
NEC for r=0.6 class 0 = 0.665 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 1 = 0.461 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 class 2 = 0.334 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all KL = 0.529 +- 0.335 (in-sample avg dev_std = 0.471)
NEC for r=0.6 all L1 = 0.482 +- 0.264 (in-sample avg dev_std = 0.471)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.7 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 1 = 0.608 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 class 2 = 0.513 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all KL = 0.694 +- 0.282 (in-sample avg dev_std = 0.615)
NEC for r=0.9 all L1 = 0.605 +- 0.214 (in-sample avg dev_std = 0.615)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.838 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 class 1 = 0.794 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 class 2 = 0.437 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all KL = 0.718 +- 0.333 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all L1 = 0.69 +- 0.264 (in-sample avg dev_std = 0.056)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.594
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.839 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 class 1 = 0.789 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 class 2 = 0.456 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 all KL = 0.728 +- 0.314 (in-sample avg dev_std = 0.144)
NEC for r=0.6 all L1 = 0.694 +- 0.249 (in-sample avg dev_std = 0.144)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.594
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.336
NEC for r=0.9 class 0 = 0.815 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 class 1 = 0.787 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 class 2 = 0.475 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 all KL = 0.736 +- 0.288 (in-sample avg dev_std = 0.361)
NEC for r=0.9 all L1 = 0.692 +- 0.223 (in-sample avg dev_std = 0.361)
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:05:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:05:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 82 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 82...
[0m[1;37mINFO[0m: [1mCheckpoint 82: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3194
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3403
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3291
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3403
OOD Test ACCURACY: 0.9260
OOD Test Loss: 0.3291

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.9260 0.9260 0.9260 0.9240 0.9240[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.000
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.040
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.221
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.003
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.059
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.22 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 1 = 0.202 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 class 2 = 0.674 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all KL = 0.306 +- 0.354 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.3 all L1 = 0.371 +- 0.292 (in-sample avg dev_std = 0.371)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.312
SUFF_SIMPLE for r=0.6 class 0 = 0.196 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 class 1 = 0.17 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 class 2 = 0.73 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 all KL = 0.319 +- 0.403 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.6 all L1 = 0.372 +- 0.326 (in-sample avg dev_std = 0.162)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 1859
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.205
SUFF_SIMPLE for r=0.9 class 0 = 0.409 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.205 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.29 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.246 +- 0.316 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.297 +- 0.234 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
SUFF_SIMPLE for r=0.3 class 0 = 0.251 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 1 = 0.526 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 class 2 = 0.932 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all KL = 0.603 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.3 all L1 = 0.569 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.251 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.526 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.932 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.603 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.569 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.575
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 1583
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.05
SUFF_SIMPLE for r=0.9 class 0 = 0.347 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.382 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.345 +- 0.258 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.314 +- 0.124 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.924
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.0
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.595
NEC for r=0.3 class 0 = 0.611 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.464 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.271 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.468 +- 0.353 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.445 +- 0.281 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.924
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.03991666666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.576
NEC for r=0.6 class 0 = 0.65 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.452 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.311 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.502 +- 0.339 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.467 +- 0.271 (in-sample avg dev_std = 0.449)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.22058866666666668
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.428
NEC for r=0.9 class 0 = 0.697 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 class 1 = 0.619 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 class 2 = 0.508 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 all KL = 0.693 +- 0.274 (in-sample avg dev_std = 0.616)
NEC for r=0.9 all L1 = 0.605 +- 0.211 (in-sample avg dev_std = 0.616)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.002503
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.749 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 1 = 0.47 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 2 = 0.068 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all KL = 0.395 +- 0.361 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all L1 = 0.429 +- 0.336 (in-sample avg dev_std = 0.036)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.713
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.05915733333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.332
NEC for r=0.6 class 0 = 0.75 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 class 1 = 0.469 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 class 2 = 0.118 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all KL = 0.421 +- 0.343 (in-sample avg dev_std = 0.116)
NEC for r=0.6 all L1 = 0.446 +- 0.319 (in-sample avg dev_std = 0.116)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.713
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3251886666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.335
NEC for r=0.9 class 0 = 0.733 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 1 = 0.478 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 2 = 0.153 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all KL = 0.445 +- 0.326 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all L1 = 0.455 +- 0.302 (in-sample avg dev_std = 0.299)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.312, 0.33, 0.286], 'all_L1': [0.374, 0.377, 0.32]}), defaultdict(<class 'list'>, {'all_KL': [0.274, 0.324, 0.335], 'all_L1': [0.337, 0.366, 0.369]}), defaultdict(<class 'list'>, {'all_KL': [0.316, 0.322, 0.255], 'all_L1': [0.378, 0.374, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.304, 0.318, 0.355], 'all_L1': [0.373, 0.361, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.337, 0.27], 'all_L1': [0.383, 0.378, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.327, 0.291], 'all_L1': [0.366, 0.379, 0.32]}), defaultdict(<class 'list'>, {'all_KL': [0.31, 0.323, 0.244], 'all_L1': [0.372, 0.371, 0.299]}), defaultdict(<class 'list'>, {'all_KL': [0.311, 0.313, 0.263], 'all_L1': [0.374, 0.367, 0.31]}), defaultdict(<class 'list'>, {'all_KL': [0.318, 0.322, 0.248], 'all_L1': [0.38, 0.374, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.306, 0.319, 0.246], 'all_L1': [0.371, 0.372, 0.297]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.442, 0.528, 0.692], 'all_L1': [0.421, 0.477, 0.603]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.532, 0.679], 'all_L1': [0.41, 0.492, 0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.517, 0.696], 'all_L1': [0.43, 0.472, 0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.391, 0.552, 0.702], 'all_L1': [0.382, 0.501, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.505, 0.668], 'all_L1': [0.427, 0.469, 0.594]}), defaultdict(<class 'list'>, {'all_KL': [0.44, 0.558, 0.7], 'all_L1': [0.424, 0.506, 0.613]}), defaultdict(<class 'list'>, {'all_KL': [0.472, 0.511, 0.685], 'all_L1': [0.449, 0.475, 0.601]}), defaultdict(<class 'list'>, {'all_KL': [0.463, 0.52, 0.692], 'all_L1': [0.434, 0.472, 0.602]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.529, 0.694], 'all_L1': [0.449, 0.482, 0.605]}), defaultdict(<class 'list'>, {'all_KL': [0.468, 0.502, 0.693], 'all_L1': [0.445, 0.467, 0.605]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.256, 0.254, 0.72], 'all_L1': [0.299, 0.298, 0.647]}), defaultdict(<class 'list'>, {'all_KL': [0.722, 0.731, 0.873], 'all_L1': [0.719, 0.723, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.68, 0.667], 'all_L1': [0.659, 0.659, 0.675]}), defaultdict(<class 'list'>, {'all_KL': [0.578, 0.558, 0.667], 'all_L1': [0.55, 0.522, 0.587]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.524, 0.481], 'all_L1': [0.486, 0.486, 0.383]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.543, 0.428], 'all_L1': [0.51, 0.512, 0.34]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.676, 0.625], 'all_L1': [0.646, 0.646, 0.611]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.377, 0.542], 'all_L1': [0.388, 0.388, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.28, 0.729], 'all_L1': [0.309, 0.309, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.603, 0.603, 0.345], 'all_L1': [0.569, 0.569, 0.314]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.74, 0.758, 0.761], 'all_L1': [0.697, 0.708, 0.692]}), defaultdict(<class 'list'>, {'all_KL': [0.342, 0.382, 0.425], 'all_L1': [0.278, 0.325, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.345, 0.363], 'all_L1': [0.337, 0.354, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.363, 0.469, 0.513], 'all_L1': [0.414, 0.479, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.476, 0.482, 0.507], 'all_L1': [0.513, 0.512, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.511, 0.551], 'all_L1': [0.466, 0.515, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.322, 0.328, 0.348], 'all_L1': [0.353, 0.355, 0.366]}), defaultdict(<class 'list'>, {'all_KL': [0.62, 0.638, 0.653], 'all_L1': [0.608, 0.617, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.718, 0.728, 0.736], 'all_L1': [0.69, 0.694, 0.692]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.421, 0.445], 'all_L1': [0.429, 0.446, 0.455]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.371 +- 0.012, 0.372 +- 0.005, 0.320 +- 0.025
suff_simple class all_KL  =  0.309 +- 0.014, 0.324 +- 0.006, 0.279 +- 0.036
[[0.33774998784065247, 0.3125, 0.21301774680614471], [0.32508334517478943, 0.31845831871032715, 0.2705755829811096], [0.336083322763443, 0.3109166622161865, 0.2092522829771042], [0.33033332228660583, 0.32370832562446594, 0.27541688084602356], [0.3362500071525574, 0.31429165601730347, 0.20763851702213287], [0.3310000002384186, 0.30658334493637085, 0.21355567872524261], [0.33633333444595337, 0.312375009059906, 0.20387305319309235], [0.335750013589859, 0.3109166622161865, 0.20817643404006958], [0.336083322763443, 0.3137499988079071, 0.20656266808509827], [0.3293333351612091, 0.31216666102409363, 0.20494890213012695]]
[[0.312, 0.33, 0.286], [0.274, 0.324, 0.335], [0.316, 0.322, 0.255], [0.304, 0.318, 0.355], [0.333, 0.337, 0.27], [0.303, 0.327, 0.291], [0.31, 0.323, 0.244], [0.311, 0.313, 0.263], [0.318, 0.322, 0.248], [0.306, 0.319, 0.246]]
suff_simple_acc_int  =  0.333 +- 0.004, 0.314 +- 0.004, 0.221 +- 0.026
nec class all_L1  =  0.427 +- 0.019, 0.481 +- 0.013, 0.605 +- 0.006
nec class all_KL  =  0.446 +- 0.026, 0.525 +- 0.018, 0.690 +- 0.010
[[0.6347500085830688, 0.5766249895095825, 0.43149998784065247], [0.6525416374206543, 0.574999988079071, 0.4261249899864197], [0.6110833287239075, 0.5879166722297668, 0.4359166622161865], [0.6792083382606506, 0.559333324432373, 0.4175833463668823], [0.6100416779518127, 0.5824999809265137, 0.4362916648387909], [0.6264166831970215, 0.5503333210945129, 0.4257499873638153], [0.5921666622161865, 0.562583327293396, 0.4311249852180481], [0.6030833125114441, 0.5777083039283752, 0.43287500739097595], [0.590458333492279, 0.5581250190734863, 0.43045833706855774], [0.5947083234786987, 0.5759166479110718, 0.42770832777023315]]
[[0.442, 0.528, 0.692], [0.416, 0.532, 0.679], [0.456, 0.517, 0.696], [0.391, 0.552, 0.702], [0.437, 0.505, 0.668], [0.44, 0.558, 0.7], [0.472, 0.511, 0.685], [0.463, 0.52, 0.692], [0.478, 0.529, 0.694], [0.468, 0.502, 0.693]]
nec_acc_int  =  0.619 +- 0.028, 0.571 +- 0.012, 0.430 +- 0.005

Eval split val
suff_simple class all_L1  =  0.513 +- 0.138, 0.511 +- 0.138, 0.553 +- 0.163
suff_simple class all_KL  =  0.524 +- 0.158, 0.523 +- 0.159, 0.608 +- 0.151
[[0.33420833945274353, 0.33399999141693115, 0.1711939424276352], [0.3384583294391632, 0.3396666646003723, 0.44219836592674255], [0.33399999141693115, 0.33399999141693115, 0.2299431413412094], [0.328291654586792, 0.3356666564941406, 0.16929879784584045], [0.33399999141693115, 0.33399999141693115, 0.042324699461460114], [0.33399999141693115, 0.33399999141693115, 0.03727100417017937], [0.33399999141693115, 0.33399999141693115, 0.2804800868034363], [0.33399999141693115, 0.33399999141693115, 0.16929879784584045], [0.33375000953674316, 0.33399999141693115, 0.1711939424276352], [0.33399999141693115, 0.33399999141693115, 0.04990524426102638]]
[[0.256, 0.254, 0.72], [0.722, 0.731, 0.873], [0.68, 0.68, 0.667], [0.578, 0.558, 0.667], [0.524, 0.524, 0.481], [0.543, 0.543, 0.428], [0.676, 0.676, 0.625], [0.377, 0.377, 0.542], [0.28, 0.28, 0.729], [0.603, 0.603, 0.345]]
suff_simple_acc_int  =  0.334 +- 0.002, 0.335 +- 0.002, 0.176 +- 0.117
nec class all_L1  =  0.479 +- 0.139, 0.500 +- 0.131, 0.512 +- 0.122
nec class all_KL  =  0.472 +- 0.154, 0.506 +- 0.146, 0.530 +- 0.138
[[0.34441667795181274, 0.3722499907016754, 0.3477500081062317], [0.5441250205039978, 0.4390000104904175, 0.34329167008399963], [0.3435416519641876, 0.35870832204818726, 0.34291666746139526], [0.6825416684150696, 0.5870000123977661, 0.3801666796207428], [0.343708336353302, 0.36254167556762695, 0.34033334255218506], [0.3840416669845581, 0.343916654586792, 0.328166663646698], [0.33399999141693115, 0.3293333351612091, 0.3330833315849304], [0.343874990940094, 0.36024999618530273, 0.3408749997615814], [0.33399999141693115, 0.32895833253860474, 0.3356249928474426], [0.33399999141693115, 0.3318749964237213, 0.33520832657814026]]
[[0.74, 0.758, 0.761], [0.342, 0.382, 0.425], [0.315, 0.345, 0.363], [0.363, 0.469, 0.513], [0.476, 0.482, 0.507], [0.43, 0.511, 0.551], [0.322, 0.328, 0.348], [0.62, 0.638, 0.653], [0.718, 0.728, 0.736], [0.395, 0.421, 0.445]]
nec_acc_int  =  0.399 +- 0.112, 0.381 +- 0.075, 0.343 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.399 +- 0.013, 0.427 +- 0.006, 0.463 +- 0.015
Faith. Armon (L1)= 		  =  0.397 +- 0.013, 0.419 +- 0.005, 0.418 +- 0.022
Faith. GMean (L1)= 	  =  0.398 +- 0.013, 0.423 +- 0.006, 0.440 +- 0.018
Faith. Aritm (KL)= 		  =  0.377 +- 0.017, 0.424 +- 0.009, 0.485 +- 0.019
Faith. Armon (KL)= 		  =  0.365 +- 0.016, 0.400 +- 0.007, 0.396 +- 0.036
Faith. GMean (KL)= 	  =  0.371 +- 0.016, 0.412 +- 0.008, 0.438 +- 0.028

Eval split val
Faith. Aritm (L1)= 		  =  0.496 +- 0.006, 0.506 +- 0.007, 0.532 +- 0.091
Faith. Armon (L1)= 		  =  0.457 +- 0.031, 0.470 +- 0.031, 0.508 +- 0.095
Faith. GMean (L1)= 	  =  0.476 +- 0.016, 0.487 +- 0.016, 0.520 +- 0.092
Faith. Aritm (KL)= 		  =  0.498 +- 0.014, 0.514 +- 0.016, 0.569 +- 0.108
Faith. Armon (KL)= 		  =  0.449 +- 0.035, 0.469 +- 0.046, 0.550 +- 0.111
Faith. GMean (KL)= 	  =  0.472 +- 0.020, 0.491 +- 0.029, 0.559 +- 0.109
Computed for split load_split = id



Completed in  0:21:36.900247  for repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.005lr_0.0wd/SMGNN_0.001_True_10_0.01 GOODMotif/basis



DONE SMGNN PLAIN GOODMotif/basis/covariate NEC_ALPHA 0.1 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:07:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:07:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.9297 0.9297 0.9297 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.507
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.428
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.787
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5065726666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.499
SUFF_SIMPLE for r=0.3 class 0 = 0.255 +- 0.421 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 class 1 = 0.504 +- 0.421 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 class 2 = 0.886 +- 0.421 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 all KL = 0.479 +- 0.421 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.3 all L1 = 0.557 +- 0.367 (in-sample avg dev_std = 0.423)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4277166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.563
SUFF_SIMPLE for r=0.6 class 0 = 0.315 +- 0.431 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 class 1 = 0.598 +- 0.431 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 class 2 = 0.911 +- 0.431 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 all KL = 0.565 +- 0.431 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.6 all L1 = 0.616 +- 0.376 (in-sample avg dev_std = 0.288)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.330506
len(reference) = 2654
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.821
SUFF_SIMPLE for r=0.9 class 0 = 0.713 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.95 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.985 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.878 +- 0.305 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.884 +- 0.271 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7874073333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.36
SUFF_SIMPLE for r=0.3 class 0 = 0.418 +- 0.412 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.3 class 1 = 0.295 +- 0.412 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.3 class 2 = 0.871 +- 0.412 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.3 all KL = 0.5 +- 0.412 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.3 all L1 = 0.529 +- 0.346 (in-sample avg dev_std = 0.330)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989473333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.429
SUFF_SIMPLE for r=0.6 class 0 = 0.426 +- 0.424 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.442 +- 0.424 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.964 +- 0.424 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.612 +- 0.424 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.611 +- 0.370 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4847123333333333
len(reference) = 681
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.93
SUFF_SIMPLE for r=0.9 class 0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5065726666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.284
NEC for r=0.3 class 0 = 0.751 +- 0.318 (in-sample avg dev_std = 0.492)
NEC for r=0.3 class 1 = 0.739 +- 0.318 (in-sample avg dev_std = 0.492)
NEC for r=0.3 class 2 = 0.479 +- 0.318 (in-sample avg dev_std = 0.492)
NEC for r=0.3 all KL = 0.757 +- 0.318 (in-sample avg dev_std = 0.492)
NEC for r=0.3 all L1 = 0.653 +- 0.277 (in-sample avg dev_std = 0.492)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4277166666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.325
NEC for r=0.6 class 0 = 0.757 +- 0.223 (in-sample avg dev_std = 0.663)
NEC for r=0.6 class 1 = 0.651 +- 0.223 (in-sample avg dev_std = 0.663)
NEC for r=0.6 class 2 = 0.559 +- 0.223 (in-sample avg dev_std = 0.663)
NEC for r=0.6 all KL = 0.78 +- 0.223 (in-sample avg dev_std = 0.663)
NEC for r=0.6 all L1 = 0.653 +- 0.208 (in-sample avg dev_std = 0.663)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.330506
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.395
NEC for r=0.9 class 0 = 0.721 +- 0.242 (in-sample avg dev_std = 0.705)
NEC for r=0.9 class 1 = 0.583 +- 0.242 (in-sample avg dev_std = 0.705)
NEC for r=0.9 class 2 = 0.511 +- 0.242 (in-sample avg dev_std = 0.705)
NEC for r=0.9 all KL = 0.731 +- 0.242 (in-sample avg dev_std = 0.705)
NEC for r=0.9 all L1 = 0.602 +- 0.223 (in-sample avg dev_std = 0.705)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7874073333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.542 +- 0.394 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 1 = 0.794 +- 0.394 (in-sample avg dev_std = 0.251)
NEC for r=0.3 class 2 = 0.185 +- 0.394 (in-sample avg dev_std = 0.251)
NEC for r=0.3 all KL = 0.519 +- 0.394 (in-sample avg dev_std = 0.251)
NEC for r=0.3 all L1 = 0.506 +- 0.323 (in-sample avg dev_std = 0.251)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989473333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.347
NEC for r=0.6 class 0 = 0.585 +- 0.339 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 1 = 0.753 +- 0.339 (in-sample avg dev_std = 0.504)
NEC for r=0.6 class 2 = 0.3 +- 0.339 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all KL = 0.588 +- 0.339 (in-sample avg dev_std = 0.504)
NEC for r=0.6 all L1 = 0.545 +- 0.271 (in-sample avg dev_std = 0.504)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4847123333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.356
NEC for r=0.9 class 0 = 0.598 +- 0.360 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 1 = 0.738 +- 0.360 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 2 = 0.23 +- 0.360 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all KL = 0.563 +- 0.360 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all L1 = 0.521 +- 0.293 (in-sample avg dev_std = 0.487)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:10:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:10:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9273 0.9273 0.9273 0.9273 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.426
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.322
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.786
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.629
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.447


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.559169
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.461
SUFF_SIMPLE for r=0.3 class 0 = 0.261 +- 0.417 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 class 1 = 0.656 +- 0.417 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 class 2 = 0.643 +- 0.417 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 all KL = 0.447 +- 0.417 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.3 all L1 = 0.525 +- 0.366 (in-sample avg dev_std = 0.417)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4257253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.56
SUFF_SIMPLE for r=0.6 class 0 = 0.254 +- 0.441 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.6 class 1 = 0.881 +- 0.441 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.6 class 2 = 0.742 +- 0.441 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.6 all KL = 0.576 +- 0.441 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.6 all L1 = 0.633 +- 0.386 (in-sample avg dev_std = 0.325)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32249866666666666
len(reference) = 2341
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.87
SUFF_SIMPLE for r=0.9 class 0 = 0.816 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.974 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.981 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.931 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.918 +- 0.206 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7860260000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.519
SUFF_SIMPLE for r=0.3 class 0 = 0.631 +- 0.400 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.3 class 1 = 0.782 +- 0.400 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.3 class 2 = 0.729 +- 0.400 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.3 all KL = 0.699 +- 0.400 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.3 all L1 = 0.713 +- 0.364 (in-sample avg dev_std = 0.260)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6294076666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.63
SUFF_SIMPLE for r=0.6 class 0 = 0.686 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.863 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.985 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.863 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.844 +- 0.287 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.708
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4472193333333333
len(reference) = 2400
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.621
SUFF_SIMPLE for r=0.9 class 0 = 0.774 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.982 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.991 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.941 +- 0.178 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.9 +- 0.197 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.559169
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.234
NEC for r=0.3 class 0 = 0.735 +- 0.247 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 1 = 0.761 +- 0.247 (in-sample avg dev_std = 0.416)
NEC for r=0.3 class 2 = 0.623 +- 0.247 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all KL = 0.788 +- 0.247 (in-sample avg dev_std = 0.416)
NEC for r=0.3 all L1 = 0.705 +- 0.195 (in-sample avg dev_std = 0.416)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4257253333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.288
NEC for r=0.6 class 0 = 0.746 +- 0.177 (in-sample avg dev_std = 0.632)
NEC for r=0.6 class 1 = 0.613 +- 0.177 (in-sample avg dev_std = 0.632)
NEC for r=0.6 class 2 = 0.711 +- 0.177 (in-sample avg dev_std = 0.632)
NEC for r=0.6 all KL = 0.806 +- 0.177 (in-sample avg dev_std = 0.632)
NEC for r=0.6 all L1 = 0.689 +- 0.166 (in-sample avg dev_std = 0.632)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32249866666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.361
NEC for r=0.9 class 0 = 0.722 +- 0.205 (in-sample avg dev_std = 0.710)
NEC for r=0.9 class 1 = 0.524 +- 0.205 (in-sample avg dev_std = 0.710)
NEC for r=0.9 class 2 = 0.673 +- 0.205 (in-sample avg dev_std = 0.710)
NEC for r=0.9 all KL = 0.765 +- 0.205 (in-sample avg dev_std = 0.710)
NEC for r=0.9 all L1 = 0.639 +- 0.191 (in-sample avg dev_std = 0.710)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7860260000000001
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.343
NEC for r=0.3 class 0 = 0.402 +- 0.359 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 1 = 0.727 +- 0.359 (in-sample avg dev_std = 0.438)
NEC for r=0.3 class 2 = 0.295 +- 0.359 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all KL = 0.517 +- 0.359 (in-sample avg dev_std = 0.438)
NEC for r=0.3 all L1 = 0.474 +- 0.311 (in-sample avg dev_std = 0.438)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6294076666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.291
NEC for r=0.6 class 0 = 0.635 +- 0.173 (in-sample avg dev_std = 0.744)
NEC for r=0.6 class 1 = 0.66 +- 0.173 (in-sample avg dev_std = 0.744)
NEC for r=0.6 class 2 = 0.604 +- 0.173 (in-sample avg dev_std = 0.744)
NEC for r=0.6 all KL = 0.756 +- 0.173 (in-sample avg dev_std = 0.744)
NEC for r=0.6 all L1 = 0.633 +- 0.172 (in-sample avg dev_std = 0.744)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4472193333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.324
NEC for r=0.9 class 0 = 0.612 +- 0.180 (in-sample avg dev_std = 0.771)
NEC for r=0.9 class 1 = 0.623 +- 0.180 (in-sample avg dev_std = 0.771)
NEC for r=0.9 class 2 = 0.587 +- 0.180 (in-sample avg dev_std = 0.771)
NEC for r=0.9 all KL = 0.732 +- 0.180 (in-sample avg dev_std = 0.771)
NEC for r=0.9 all L1 = 0.607 +- 0.175 (in-sample avg dev_std = 0.771)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:12:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:12:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 108 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.527
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.445
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.334
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.526898
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF_SIMPLE for r=0.3 class 0 = 0.297 +- 0.411 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.3 class 1 = 0.626 +- 0.411 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.3 class 2 = 0.734 +- 0.411 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.3 all KL = 0.482 +- 0.411 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.3 all L1 = 0.558 +- 0.355 (in-sample avg dev_std = 0.464)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44542099999999996
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.655
SUFF_SIMPLE for r=0.6 class 0 = 0.376 +- 0.407 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.6 class 1 = 0.827 +- 0.407 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.6 class 2 = 0.838 +- 0.407 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.6 all KL = 0.655 +- 0.407 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.6 all L1 = 0.687 +- 0.347 (in-sample avg dev_std = 0.328)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3343983333333333
len(reference) = 2630
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.86
SUFF_SIMPLE for r=0.9 class 0 = 0.825 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.966 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.971 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.922 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.921 +- 0.222 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839849999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.497
SUFF_SIMPLE for r=0.3 class 0 = 0.518 +- 0.434 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 class 1 = 0.731 +- 0.434 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 class 2 = 0.728 +- 0.434 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 all KL = 0.627 +- 0.434 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 all L1 = 0.658 +- 0.358 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6988479999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.645
SUFF_SIMPLE for r=0.6 class 0 = 0.58 +- 0.366 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.734 +- 0.366 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.974 +- 0.366 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.764 +- 0.366 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.762 +- 0.328 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.741
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48528600000000005
len(reference) = 1945
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF_SIMPLE for r=0.9 class 0 = 0.872 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.514 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.988 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.839 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.839 +- 0.307 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.526898
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.291
NEC for r=0.3 class 0 = 0.636 +- 0.318 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 1 = 0.763 +- 0.318 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 2 = 0.607 +- 0.318 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all KL = 0.763 +- 0.318 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all L1 = 0.668 +- 0.263 (in-sample avg dev_std = 0.474)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.44542099999999996
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.303
NEC for r=0.6 class 0 = 0.69 +- 0.140 (in-sample avg dev_std = 0.717)
NEC for r=0.6 class 1 = 0.678 +- 0.140 (in-sample avg dev_std = 0.717)
NEC for r=0.6 class 2 = 0.702 +- 0.140 (in-sample avg dev_std = 0.717)
NEC for r=0.6 all KL = 0.829 +- 0.140 (in-sample avg dev_std = 0.717)
NEC for r=0.6 all L1 = 0.69 +- 0.142 (in-sample avg dev_std = 0.717)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3343983333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.388
NEC for r=0.9 class 0 = 0.673 +- 0.172 (in-sample avg dev_std = 0.785)
NEC for r=0.9 class 1 = 0.574 +- 0.172 (in-sample avg dev_std = 0.785)
NEC for r=0.9 class 2 = 0.657 +- 0.172 (in-sample avg dev_std = 0.785)
NEC for r=0.9 all KL = 0.778 +- 0.172 (in-sample avg dev_std = 0.785)
NEC for r=0.9 all L1 = 0.634 +- 0.164 (in-sample avg dev_std = 0.785)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839849999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
NEC for r=0.3 class 0 = 0.459 +- 0.402 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 1 = 0.787 +- 0.402 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 2 = 0.196 +- 0.402 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all KL = 0.54 +- 0.402 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all L1 = 0.479 +- 0.353 (in-sample avg dev_std = 0.332)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6988479999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.353
NEC for r=0.6 class 0 = 0.564 +- 0.244 (in-sample avg dev_std = 0.712)
NEC for r=0.6 class 1 = 0.663 +- 0.244 (in-sample avg dev_std = 0.712)
NEC for r=0.6 class 2 = 0.468 +- 0.244 (in-sample avg dev_std = 0.712)
NEC for r=0.6 all KL = 0.685 +- 0.244 (in-sample avg dev_std = 0.712)
NEC for r=0.6 all L1 = 0.565 +- 0.225 (in-sample avg dev_std = 0.712)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.797
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.48528600000000005
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.398
NEC for r=0.9 class 0 = 0.57 +- 0.238 (in-sample avg dev_std = 0.765)
NEC for r=0.9 class 1 = 0.609 +- 0.238 (in-sample avg dev_std = 0.765)
NEC for r=0.9 class 2 = 0.434 +- 0.238 (in-sample avg dev_std = 0.765)
NEC for r=0.9 all KL = 0.662 +- 0.238 (in-sample avg dev_std = 0.765)
NEC for r=0.9 all L1 = 0.538 +- 0.216 (in-sample avg dev_std = 0.765)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:14:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:14:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.787
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.689
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5505496666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.495
SUFF_SIMPLE for r=0.3 class 0 = 0.248 +- 0.419 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 class 1 = 0.623 +- 0.419 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 class 2 = 0.777 +- 0.419 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 all KL = 0.477 +- 0.419 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.3 all L1 = 0.556 +- 0.368 (in-sample avg dev_std = 0.426)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.43598000000000003
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.583
SUFF_SIMPLE for r=0.6 class 0 = 0.29 +- 0.442 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.6 class 1 = 0.83 +- 0.442 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.6 class 2 = 0.83 +- 0.442 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.6 all KL = 0.602 +- 0.442 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.6 all L1 = 0.657 +- 0.386 (in-sample avg dev_std = 0.304)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32922633333333334
len(reference) = 2323
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.822
SUFF_SIMPLE for r=0.9 class 0 = 0.773 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.976 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.944 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.88 +- 0.309 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.892 +- 0.274 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7866436666666665
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.54
SUFF_SIMPLE for r=0.3 class 0 = 0.666 +- 0.425 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 class 1 = 0.758 +- 0.425 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 class 2 = 0.76 +- 0.425 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 all KL = 0.684 +- 0.425 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.3 all L1 = 0.728 +- 0.367 (in-sample avg dev_std = 0.325)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6890256666666668
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.625
SUFF_SIMPLE for r=0.6 class 0 = 0.695 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.848 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.984 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.822 +- 0.368 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.842 +- 0.325 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.47692266666666666
len(reference) = 295
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.932
SUFF_SIMPLE for r=0.9 class 0 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5505496666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.306
NEC for r=0.3 class 0 = 0.693 +- 0.329 (in-sample avg dev_std = 0.545)
NEC for r=0.3 class 1 = 0.772 +- 0.329 (in-sample avg dev_std = 0.545)
NEC for r=0.3 class 2 = 0.455 +- 0.329 (in-sample avg dev_std = 0.545)
NEC for r=0.3 all KL = 0.748 +- 0.329 (in-sample avg dev_std = 0.545)
NEC for r=0.3 all L1 = 0.637 +- 0.288 (in-sample avg dev_std = 0.545)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.43598000000000003
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.309
NEC for r=0.6 class 0 = 0.731 +- 0.165 (in-sample avg dev_std = 0.709)
NEC for r=0.6 class 1 = 0.679 +- 0.165 (in-sample avg dev_std = 0.709)
NEC for r=0.6 class 2 = 0.619 +- 0.165 (in-sample avg dev_std = 0.709)
NEC for r=0.6 all KL = 0.812 +- 0.165 (in-sample avg dev_std = 0.709)
NEC for r=0.6 all L1 = 0.675 +- 0.167 (in-sample avg dev_std = 0.709)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.32922633333333334
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.377
NEC for r=0.9 class 0 = 0.719 +- 0.186 (in-sample avg dev_std = 0.766)
NEC for r=0.9 class 1 = 0.579 +- 0.186 (in-sample avg dev_std = 0.766)
NEC for r=0.9 class 2 = 0.596 +- 0.186 (in-sample avg dev_std = 0.766)
NEC for r=0.9 all KL = 0.772 +- 0.186 (in-sample avg dev_std = 0.766)
NEC for r=0.9 all L1 = 0.63 +- 0.183 (in-sample avg dev_std = 0.766)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7866436666666665
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.321
NEC for r=0.3 class 0 = 0.376 +- 0.432 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 1 = 0.64 +- 0.432 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 2 = 0.13 +- 0.432 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all KL = 0.447 +- 0.432 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all L1 = 0.381 +- 0.379 (in-sample avg dev_std = 0.353)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6890256666666668
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.493 +- 0.305 (in-sample avg dev_std = 0.688)
NEC for r=0.6 class 1 = 0.658 +- 0.305 (in-sample avg dev_std = 0.688)
NEC for r=0.6 class 2 = 0.342 +- 0.305 (in-sample avg dev_std = 0.688)
NEC for r=0.6 all KL = 0.618 +- 0.305 (in-sample avg dev_std = 0.688)
NEC for r=0.6 all L1 = 0.497 +- 0.273 (in-sample avg dev_std = 0.688)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.47692266666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.344
NEC for r=0.9 class 0 = 0.509 +- 0.290 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 1 = 0.613 +- 0.290 (in-sample avg dev_std = 0.733)
NEC for r=0.9 class 2 = 0.385 +- 0.290 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all KL = 0.629 +- 0.290 (in-sample avg dev_std = 0.733)
NEC for r=0.9 all L1 = 0.502 +- 0.257 (in-sample avg dev_std = 0.733)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:15:58 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:15:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.678
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.469


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.535273
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.404
SUFF_SIMPLE for r=0.3 class 0 = 0.228 +- 0.389 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.3 class 1 = 0.548 +- 0.389 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.3 class 2 = 0.619 +- 0.389 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.3 all KL = 0.377 +- 0.389 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.3 all L1 = 0.47 +- 0.346 (in-sample avg dev_std = 0.446)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4337976666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.498
SUFF_SIMPLE for r=0.6 class 0 = 0.287 +- 0.443 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 class 1 = 0.635 +- 0.443 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 class 2 = 0.785 +- 0.443 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 all KL = 0.512 +- 0.443 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.6 all L1 = 0.576 +- 0.389 (in-sample avg dev_std = 0.298)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266133333333333
len(reference) = 2254
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.773
SUFF_SIMPLE for r=0.9 class 0 = 0.658 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.929 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.976 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.834 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.85 +- 0.315 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839269999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.532
SUFF_SIMPLE for r=0.3 class 0 = 0.744 +- 0.400 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.3 class 1 = 0.668 +- 0.400 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.3 class 2 = 0.824 +- 0.400 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.3 all KL = 0.705 +- 0.400 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.3 all L1 = 0.746 +- 0.343 (in-sample avg dev_std = 0.392)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6781923333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.49
SUFF_SIMPLE for r=0.6 class 0 = 0.764 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.799 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.988 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.84 +- 0.345 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.851 +- 0.312 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.823
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46883966666666665
len(reference) = 1830
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.692
SUFF_SIMPLE for r=0.9 class 0 = 0.95 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.758 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.995 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.884 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.888 +- 0.274 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.535273
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.304
NEC for r=0.3 class 0 = 0.68 +- 0.289 (in-sample avg dev_std = 0.572)
NEC for r=0.3 class 1 = 0.758 +- 0.289 (in-sample avg dev_std = 0.572)
NEC for r=0.3 class 2 = 0.506 +- 0.289 (in-sample avg dev_std = 0.572)
NEC for r=0.3 all KL = 0.761 +- 0.289 (in-sample avg dev_std = 0.572)
NEC for r=0.3 all L1 = 0.646 +- 0.260 (in-sample avg dev_std = 0.572)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4337976666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.325
NEC for r=0.6 class 0 = 0.737 +- 0.166 (in-sample avg dev_std = 0.730)
NEC for r=0.6 class 1 = 0.645 +- 0.166 (in-sample avg dev_std = 0.730)
NEC for r=0.6 class 2 = 0.617 +- 0.166 (in-sample avg dev_std = 0.730)
NEC for r=0.6 all KL = 0.801 +- 0.166 (in-sample avg dev_std = 0.730)
NEC for r=0.6 all L1 = 0.665 +- 0.167 (in-sample avg dev_std = 0.730)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3266133333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.379
NEC for r=0.9 class 0 = 0.737 +- 0.201 (in-sample avg dev_std = 0.743)
NEC for r=0.9 class 1 = 0.552 +- 0.201 (in-sample avg dev_std = 0.743)
NEC for r=0.9 class 2 = 0.587 +- 0.201 (in-sample avg dev_std = 0.743)
NEC for r=0.9 all KL = 0.758 +- 0.201 (in-sample avg dev_std = 0.743)
NEC for r=0.9 all L1 = 0.623 +- 0.194 (in-sample avg dev_std = 0.743)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7839269999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.321
NEC for r=0.3 class 0 = 0.321 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.3 class 1 = 0.582 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.3 class 2 = 0.109 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.3 all KL = 0.391 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.3 all L1 = 0.336 +- 0.365 (in-sample avg dev_std = 0.346)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6781923333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.35
NEC for r=0.6 class 0 = 0.407 +- 0.328 (in-sample avg dev_std = 0.663)
NEC for r=0.6 class 1 = 0.59 +- 0.328 (in-sample avg dev_std = 0.663)
NEC for r=0.6 class 2 = 0.304 +- 0.328 (in-sample avg dev_std = 0.663)
NEC for r=0.6 all KL = 0.536 +- 0.328 (in-sample avg dev_std = 0.663)
NEC for r=0.6 all L1 = 0.433 +- 0.284 (in-sample avg dev_std = 0.663)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46883966666666665
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.36
NEC for r=0.9 class 0 = 0.43 +- 0.324 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 1 = 0.564 +- 0.324 (in-sample avg dev_std = 0.687)
NEC for r=0.9 class 2 = 0.314 +- 0.324 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all KL = 0.542 +- 0.324 (in-sample avg dev_std = 0.687)
NEC for r=0.9 all L1 = 0.435 +- 0.277 (in-sample avg dev_std = 0.687)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:17:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:17:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.423
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.323
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.736
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.620
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.450


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5451613333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.516
SUFF_SIMPLE for r=0.3 class 0 = 0.407 +- 0.360 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 class 1 = 0.654 +- 0.360 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 class 2 = 0.532 +- 0.360 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 all KL = 0.474 +- 0.360 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.3 all L1 = 0.533 +- 0.321 (in-sample avg dev_std = 0.460)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4227086666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.65
SUFF_SIMPLE for r=0.6 class 0 = 0.462 +- 0.415 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.6 class 1 = 0.885 +- 0.415 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.6 class 2 = 0.756 +- 0.415 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.6 all KL = 0.661 +- 0.415 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.6 all L1 = 0.705 +- 0.360 (in-sample avg dev_std = 0.358)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.322799
len(reference) = 2477
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF_SIMPLE for r=0.9 class 0 = 0.883 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.955 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.937 +- 0.226 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.936 +- 0.204 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.735587
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.76
SUFF_SIMPLE for r=0.3 class 0 = 0.507 +- 0.377 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 class 1 = 0.959 +- 0.377 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 class 2 = 0.713 +- 0.377 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 all KL = 0.698 +- 0.377 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.3 all L1 = 0.725 +- 0.332 (in-sample avg dev_std = 0.382)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6201556666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.798
SUFF_SIMPLE for r=0.6 class 0 = 0.719 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.992 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.971 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.908 +- 0.248 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.893 +- 0.245 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.595
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.44953000000000004
len(reference) = 927
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.588
SUFF_SIMPLE for r=0.9 class 0 = 0.992 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.85 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.091 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.984 +- 0.083 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5451613333333333
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.204
NEC for r=0.3 class 0 = 0.56 +- 0.278 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 1 = 0.753 +- 0.278 (in-sample avg dev_std = 0.420)
NEC for r=0.3 class 2 = 0.815 +- 0.278 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all KL = 0.818 +- 0.278 (in-sample avg dev_std = 0.420)
NEC for r=0.3 all L1 = 0.713 +- 0.244 (in-sample avg dev_std = 0.420)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4227086666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.281
NEC for r=0.6 class 0 = 0.702 +- 0.187 (in-sample avg dev_std = 0.660)
NEC for r=0.6 class 1 = 0.596 +- 0.187 (in-sample avg dev_std = 0.660)
NEC for r=0.6 class 2 = 0.774 +- 0.187 (in-sample avg dev_std = 0.660)
NEC for r=0.6 all KL = 0.818 +- 0.187 (in-sample avg dev_std = 0.660)
NEC for r=0.6 all L1 = 0.691 +- 0.178 (in-sample avg dev_std = 0.660)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.322799
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.37
NEC for r=0.9 class 0 = 0.681 +- 0.201 (in-sample avg dev_std = 0.741)
NEC for r=0.9 class 1 = 0.5 +- 0.201 (in-sample avg dev_std = 0.741)
NEC for r=0.9 class 2 = 0.718 +- 0.201 (in-sample avg dev_std = 0.741)
NEC for r=0.9 all KL = 0.766 +- 0.201 (in-sample avg dev_std = 0.741)
NEC for r=0.9 all L1 = 0.633 +- 0.191 (in-sample avg dev_std = 0.741)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.735587
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.292
NEC for r=0.3 class 0 = 0.357 +- 0.422 (in-sample avg dev_std = 0.368)
NEC for r=0.3 class 1 = 0.322 +- 0.422 (in-sample avg dev_std = 0.368)
NEC for r=0.3 class 2 = 0.795 +- 0.422 (in-sample avg dev_std = 0.368)
NEC for r=0.3 all KL = 0.533 +- 0.422 (in-sample avg dev_std = 0.368)
NEC for r=0.3 all L1 = 0.492 +- 0.354 (in-sample avg dev_std = 0.368)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6201556666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.361
NEC for r=0.6 class 0 = 0.502 +- 0.337 (in-sample avg dev_std = 0.612)
NEC for r=0.6 class 1 = 0.377 +- 0.337 (in-sample avg dev_std = 0.612)
NEC for r=0.6 class 2 = 0.759 +- 0.337 (in-sample avg dev_std = 0.612)
NEC for r=0.6 all KL = 0.623 +- 0.337 (in-sample avg dev_std = 0.612)
NEC for r=0.6 all L1 = 0.546 +- 0.280 (in-sample avg dev_std = 0.612)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.44953000000000004
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.407
NEC for r=0.9 class 0 = 0.513 +- 0.315 (in-sample avg dev_std = 0.692)
NEC for r=0.9 class 1 = 0.358 +- 0.315 (in-sample avg dev_std = 0.692)
NEC for r=0.9 class 2 = 0.712 +- 0.315 (in-sample avg dev_std = 0.692)
NEC for r=0.9 all KL = 0.618 +- 0.315 (in-sample avg dev_std = 0.692)
NEC for r=0.9 all L1 = 0.528 +- 0.263 (in-sample avg dev_std = 0.692)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:19:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:19:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.339
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.669
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.598
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.444


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.556155
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.547
SUFF_SIMPLE for r=0.3 class 0 = 0.363 +- 0.360 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 class 1 = 0.663 +- 0.360 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 class 2 = 0.542 +- 0.360 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 all KL = 0.468 +- 0.360 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.3 all L1 = 0.526 +- 0.316 (in-sample avg dev_std = 0.450)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4336723333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.63
SUFF_SIMPLE for r=0.6 class 0 = 0.411 +- 0.424 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.6 class 1 = 0.896 +- 0.424 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.6 class 2 = 0.734 +- 0.424 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.6 all KL = 0.642 +- 0.424 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.6 all L1 = 0.685 +- 0.367 (in-sample avg dev_std = 0.333)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.338619
len(reference) = 2588
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.854
SUFF_SIMPLE for r=0.9 class 0 = 0.805 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.973 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.963 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.915 +- 0.259 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.913 +- 0.232 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.6694983333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.659
SUFF_SIMPLE for r=0.3 class 0 = 0.589 +- 0.402 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.3 class 1 = 0.645 +- 0.402 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.3 class 2 = 0.709 +- 0.402 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.3 all KL = 0.587 +- 0.402 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.3 all L1 = 0.648 +- 0.340 (in-sample avg dev_std = 0.477)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.5981513333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.718
SUFF_SIMPLE for r=0.6 class 0 = 0.842 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.791 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.988 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.872 +- 0.311 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.874 +- 0.280 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.276
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4435263333333333
len(reference) = 1119
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.283
SUFF_SIMPLE for r=0.9 class 0 = 0.969 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.999 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.058 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.982 +- 0.093 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.556155
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.206
NEC for r=0.3 class 0 = 0.562 +- 0.279 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1 = 0.744 +- 0.279 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 2 = 0.815 +- 0.279 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.814 +- 0.279 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.71 +- 0.244 (in-sample avg dev_std = 0.414)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4336723333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.288
NEC for r=0.6 class 0 = 0.703 +- 0.198 (in-sample avg dev_std = 0.647)
NEC for r=0.6 class 1 = 0.571 +- 0.198 (in-sample avg dev_std = 0.647)
NEC for r=0.6 class 2 = 0.781 +- 0.198 (in-sample avg dev_std = 0.647)
NEC for r=0.6 all KL = 0.813 +- 0.198 (in-sample avg dev_std = 0.647)
NEC for r=0.6 all L1 = 0.686 +- 0.191 (in-sample avg dev_std = 0.647)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.338619
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.372
NEC for r=0.9 class 0 = 0.673 +- 0.221 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 1 = 0.48 +- 0.221 (in-sample avg dev_std = 0.722)
NEC for r=0.9 class 2 = 0.734 +- 0.221 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all KL = 0.76 +- 0.221 (in-sample avg dev_std = 0.722)
NEC for r=0.9 all L1 = 0.629 +- 0.206 (in-sample avg dev_std = 0.722)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.6694983333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.288
NEC for r=0.3 class 0 = 0.49 +- 0.419 (in-sample avg dev_std = 0.460)
NEC for r=0.3 class 1 = 0.467 +- 0.419 (in-sample avg dev_std = 0.460)
NEC for r=0.3 class 2 = 0.31 +- 0.419 (in-sample avg dev_std = 0.460)
NEC for r=0.3 all KL = 0.495 +- 0.419 (in-sample avg dev_std = 0.460)
NEC for r=0.3 all L1 = 0.422 +- 0.364 (in-sample avg dev_std = 0.460)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.5981513333333334
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 0 = 0.508 +- 0.349 (in-sample avg dev_std = 0.661)
NEC for r=0.6 class 1 = 0.509 +- 0.349 (in-sample avg dev_std = 0.661)
NEC for r=0.6 class 2 = 0.466 +- 0.349 (in-sample avg dev_std = 0.661)
NEC for r=0.6 all KL = 0.6 +- 0.349 (in-sample avg dev_std = 0.661)
NEC for r=0.6 all L1 = 0.495 +- 0.299 (in-sample avg dev_std = 0.661)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4435263333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.396
NEC for r=0.9 class 0 = 0.492 +- 0.332 (in-sample avg dev_std = 0.724)
NEC for r=0.9 class 1 = 0.485 +- 0.332 (in-sample avg dev_std = 0.724)
NEC for r=0.9 class 2 = 0.456 +- 0.332 (in-sample avg dev_std = 0.724)
NEC for r=0.9 all KL = 0.592 +- 0.332 (in-sample avg dev_std = 0.724)
NEC for r=0.9 all L1 = 0.477 +- 0.281 (in-sample avg dev_std = 0.724)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:22:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:22:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9310 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.573
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731906666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.509
SUFF_SIMPLE for r=0.3 class 0 = 0.266 +- 0.419 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 class 1 = 0.528 +- 0.419 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 class 2 = 0.878 +- 0.419 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 all KL = 0.491 +- 0.419 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.3 all L1 = 0.565 +- 0.364 (in-sample avg dev_std = 0.429)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441644
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.606
SUFF_SIMPLE for r=0.6 class 0 = 0.28 +- 0.435 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.6 class 1 = 0.817 +- 0.435 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.6 class 2 = 0.894 +- 0.435 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.6 all KL = 0.624 +- 0.435 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.6 all L1 = 0.672 +- 0.377 (in-sample avg dev_std = 0.292)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.330694
len(reference) = 2546
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF_SIMPLE for r=0.9 class 0 = 0.827 +- 0.223 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.977 +- 0.223 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.98 +- 0.223 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.931 +- 0.223 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.927 +- 0.204 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7852763333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
SUFF_SIMPLE for r=0.3 class 0 = 0.213 +- 0.439 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 class 1 = 0.191 +- 0.439 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 class 2 = 0.931 +- 0.439 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 all KL = 0.377 +- 0.439 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.3 all L1 = 0.445 +- 0.387 (in-sample avg dev_std = 0.083)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.699089
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.359
SUFF_SIMPLE for r=0.6 class 0 = 0.214 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.217 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.945 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.398 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.459 +- 0.388 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4848166666666667
len(reference) = 515
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.92
SUFF_SIMPLE for r=0.9 class 0 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.999 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 1.0 +- 0.000 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.999 +- 0.001 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5731906666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.262
NEC for r=0.3 class 0 = 0.711 +- 0.270 (in-sample avg dev_std = 0.475)
NEC for r=0.3 class 1 = 0.77 +- 0.270 (in-sample avg dev_std = 0.475)
NEC for r=0.3 class 2 = 0.589 +- 0.270 (in-sample avg dev_std = 0.475)
NEC for r=0.3 all KL = 0.789 +- 0.270 (in-sample avg dev_std = 0.475)
NEC for r=0.3 all L1 = 0.688 +- 0.230 (in-sample avg dev_std = 0.475)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.441644
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.305
NEC for r=0.6 class 0 = 0.739 +- 0.198 (in-sample avg dev_std = 0.664)
NEC for r=0.6 class 1 = 0.668 +- 0.198 (in-sample avg dev_std = 0.664)
NEC for r=0.6 class 2 = 0.622 +- 0.198 (in-sample avg dev_std = 0.664)
NEC for r=0.6 all KL = 0.802 +- 0.198 (in-sample avg dev_std = 0.664)
NEC for r=0.6 all L1 = 0.675 +- 0.183 (in-sample avg dev_std = 0.664)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.330694
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.388
NEC for r=0.9 class 0 = 0.712 +- 0.216 (in-sample avg dev_std = 0.717)
NEC for r=0.9 class 1 = 0.584 +- 0.216 (in-sample avg dev_std = 0.717)
NEC for r=0.9 class 2 = 0.556 +- 0.216 (in-sample avg dev_std = 0.717)
NEC for r=0.9 all KL = 0.746 +- 0.216 (in-sample avg dev_std = 0.717)
NEC for r=0.9 all L1 = 0.615 +- 0.202 (in-sample avg dev_std = 0.717)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7852763333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.25
NEC for r=0.3 class 0 = 0.764 +- 0.270 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 1 = 0.817 +- 0.270 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 2 = 0.438 +- 0.270 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all KL = 0.761 +- 0.270 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all L1 = 0.673 +- 0.225 (in-sample avg dev_std = 0.458)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.699089
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.285
NEC for r=0.6 class 0 = 0.757 +- 0.199 (in-sample avg dev_std = 0.620)
NEC for r=0.6 class 1 = 0.768 +- 0.199 (in-sample avg dev_std = 0.620)
NEC for r=0.6 class 2 = 0.511 +- 0.199 (in-sample avg dev_std = 0.620)
NEC for r=0.6 all KL = 0.788 +- 0.199 (in-sample avg dev_std = 0.620)
NEC for r=0.6 all L1 = 0.679 +- 0.175 (in-sample avg dev_std = 0.620)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4848166666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.309
NEC for r=0.9 class 0 = 0.766 +- 0.230 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 1 = 0.758 +- 0.230 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 2 = 0.437 +- 0.230 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all KL = 0.758 +- 0.230 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all L1 = 0.653 +- 0.203 (in-sample avg dev_std = 0.601)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:24:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:24:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.527
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.406
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.786
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.479


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5265093333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.511
SUFF_SIMPLE for r=0.3 class 0 = 0.262 +- 0.412 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.3 class 1 = 0.553 +- 0.412 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.3 class 2 = 0.825 +- 0.412 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.3 all KL = 0.488 +- 0.412 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.3 all L1 = 0.554 +- 0.352 (in-sample avg dev_std = 0.418)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.40593533333333337
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.543
SUFF_SIMPLE for r=0.6 class 0 = 0.255 +- 0.441 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 class 1 = 0.694 +- 0.441 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 class 2 = 0.863 +- 0.441 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 all KL = 0.56 +- 0.441 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.6 all L1 = 0.612 +- 0.386 (in-sample avg dev_std = 0.272)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3296226666666666
len(reference) = 2644
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.861
SUFF_SIMPLE for r=0.9 class 0 = 0.806 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.965 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.974 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.918 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.916 +- 0.221 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7857369999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.404
SUFF_SIMPLE for r=0.3 class 0 = 0.208 +- 0.400 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.3 class 1 = 0.407 +- 0.400 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.3 class 2 = 0.829 +- 0.400 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.3 all KL = 0.406 +- 0.400 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.3 all L1 = 0.481 +- 0.353 (in-sample avg dev_std = 0.358)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6914119999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.654
SUFF_SIMPLE for r=0.6 class 0 = 0.619 +- 0.375 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.756 +- 0.375 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.976 +- 0.375 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.779 +- 0.375 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.783 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4790656666666667
len(reference) = 1750
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.927
SUFF_SIMPLE for r=0.9 class 0 = 0.94 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.996 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.99 +- 0.045 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.974 +- 0.098 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5265093333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
NEC for r=0.3 class 0 = 0.611 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 1 = 0.741 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 2 = 0.59 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=0.3 all KL = 0.74 +- 0.302 (in-sample avg dev_std = 0.505)
NEC for r=0.3 all L1 = 0.647 +- 0.250 (in-sample avg dev_std = 0.505)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.40593533333333337
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.31
NEC for r=0.6 class 0 = 0.729 +- 0.173 (in-sample avg dev_std = 0.676)
NEC for r=0.6 class 1 = 0.657 +- 0.173 (in-sample avg dev_std = 0.676)
NEC for r=0.6 class 2 = 0.649 +- 0.173 (in-sample avg dev_std = 0.676)
NEC for r=0.6 all KL = 0.805 +- 0.173 (in-sample avg dev_std = 0.676)
NEC for r=0.6 all L1 = 0.677 +- 0.164 (in-sample avg dev_std = 0.676)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3296226666666666
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.392
NEC for r=0.9 class 0 = 0.714 +- 0.210 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 1 = 0.569 +- 0.210 (in-sample avg dev_std = 0.720)
NEC for r=0.9 class 2 = 0.587 +- 0.210 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all KL = 0.75 +- 0.210 (in-sample avg dev_std = 0.720)
NEC for r=0.9 all L1 = 0.622 +- 0.192 (in-sample avg dev_std = 0.720)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7857369999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
NEC for r=0.3 class 0 = 0.546 +- 0.337 (in-sample avg dev_std = 0.279)
NEC for r=0.3 class 1 = 0.55 +- 0.337 (in-sample avg dev_std = 0.279)
NEC for r=0.3 class 2 = 0.717 +- 0.337 (in-sample avg dev_std = 0.279)
NEC for r=0.3 all KL = 0.622 +- 0.337 (in-sample avg dev_std = 0.279)
NEC for r=0.3 all L1 = 0.604 +- 0.242 (in-sample avg dev_std = 0.279)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6914119999999999
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.312
NEC for r=0.6 class 0 = 0.624 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.6 class 1 = 0.493 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.6 class 2 = 0.72 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.6 all KL = 0.682 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=0.6 all L1 = 0.613 +- 0.223 (in-sample avg dev_std = 0.561)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.4790656666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.34
NEC for r=0.9 class 0 = 0.637 +- 0.291 (in-sample avg dev_std = 0.605)
NEC for r=0.9 class 1 = 0.466 +- 0.291 (in-sample avg dev_std = 0.605)
NEC for r=0.9 class 2 = 0.671 +- 0.291 (in-sample avg dev_std = 0.605)
NEC for r=0.9 all KL = 0.668 +- 0.291 (in-sample avg dev_std = 0.605)
NEC for r=0.9 all L1 = 0.592 +- 0.226 (in-sample avg dev_std = 0.605)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:27:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:27:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.552
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.427
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.326
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.661
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.462


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5520200000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.53
SUFF_SIMPLE for r=0.3 class 0 = 0.282 +- 0.418 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.3 class 1 = 0.55 +- 0.418 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.3 class 2 = 0.888 +- 0.418 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.3 all KL = 0.518 +- 0.418 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.3 all L1 = 0.581 +- 0.363 (in-sample avg dev_std = 0.405)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4274783333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.575
SUFF_SIMPLE for r=0.6 class 0 = 0.286 +- 0.423 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.6 class 1 = 0.596 +- 0.423 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.6 class 2 = 0.92 +- 0.423 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.6 all KL = 0.561 +- 0.423 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.6 all L1 = 0.609 +- 0.372 (in-sample avg dev_std = 0.290)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3257386666666667
len(reference) = 2630
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF_SIMPLE for r=0.9 class 0 = 0.849 +- 0.236 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.939 +- 0.236 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.985 +- 0.236 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.925 +- 0.236 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.925 +- 0.219 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7801553333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.379
SUFF_SIMPLE for r=0.3 class 0 = 0.865 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.3 class 1 = 0.721 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.3 class 2 = 0.884 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.3 all KL = 0.804 +- 0.343 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.3 all L1 = 0.824 +- 0.302 (in-sample avg dev_std = 0.324)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6607156666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.489
SUFF_SIMPLE for r=0.6 class 0 = 0.833 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.818 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.988 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.884 +- 0.278 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.88 +- 0.257 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.217
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46197466666666664
len(reference) = 814
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.131
SUFF_SIMPLE for r=0.9 class 0 = 0.928 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.946 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 1.0 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.94 +- 0.190 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.932 +- 0.214 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.5520200000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.245
NEC for r=0.3 class 0 = 0.696 +- 0.301 (in-sample avg dev_std = 0.437)
NEC for r=0.3 class 1 = 0.741 +- 0.301 (in-sample avg dev_std = 0.437)
NEC for r=0.3 class 2 = 0.635 +- 0.301 (in-sample avg dev_std = 0.437)
NEC for r=0.3 all KL = 0.786 +- 0.301 (in-sample avg dev_std = 0.437)
NEC for r=0.3 all L1 = 0.69 +- 0.246 (in-sample avg dev_std = 0.437)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.4274783333333333
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.287
NEC for r=0.6 class 0 = 0.751 +- 0.154 (in-sample avg dev_std = 0.671)
NEC for r=0.6 class 1 = 0.651 +- 0.154 (in-sample avg dev_std = 0.671)
NEC for r=0.6 class 2 = 0.693 +- 0.154 (in-sample avg dev_std = 0.671)
NEC for r=0.6 all KL = 0.828 +- 0.154 (in-sample avg dev_std = 0.671)
NEC for r=0.6 all L1 = 0.698 +- 0.147 (in-sample avg dev_std = 0.671)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3257386666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.384
NEC for r=0.9 class 0 = 0.715 +- 0.173 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 1 = 0.567 +- 0.173 (in-sample avg dev_std = 0.754)
NEC for r=0.9 class 2 = 0.632 +- 0.173 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all KL = 0.773 +- 0.173 (in-sample avg dev_std = 0.754)
NEC for r=0.9 all L1 = 0.637 +- 0.163 (in-sample avg dev_std = 0.754)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.7801553333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.124 +- 0.252 (in-sample avg dev_std = 0.026)
NEC for r=0.3 class 1 = 0.13 +- 0.252 (in-sample avg dev_std = 0.026)
NEC for r=0.3 class 2 = 0.005 +- 0.252 (in-sample avg dev_std = 0.026)
NEC for r=0.3 all KL = 0.087 +- 0.252 (in-sample avg dev_std = 0.026)
NEC for r=0.3 all L1 = 0.086 +- 0.244 (in-sample avg dev_std = 0.026)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.6607156666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.325
NEC for r=0.6 class 0 = 0.17 +- 0.286 (in-sample avg dev_std = 0.246)
NEC for r=0.6 class 1 = 0.148 +- 0.286 (in-sample avg dev_std = 0.246)
NEC for r=0.6 class 2 = 0.071 +- 0.286 (in-sample avg dev_std = 0.246)
NEC for r=0.6 all KL = 0.141 +- 0.286 (in-sample avg dev_std = 0.246)
NEC for r=0.6 all L1 = 0.13 +- 0.262 (in-sample avg dev_std = 0.246)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.437
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.46197466666666664
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.349
NEC for r=0.9 class 0 = 0.177 +- 0.293 (in-sample avg dev_std = 0.342)
NEC for r=0.9 class 1 = 0.171 +- 0.293 (in-sample avg dev_std = 0.342)
NEC for r=0.9 class 2 = 0.094 +- 0.293 (in-sample avg dev_std = 0.342)
NEC for r=0.9 all KL = 0.166 +- 0.293 (in-sample avg dev_std = 0.342)
NEC for r=0.9 all L1 = 0.148 +- 0.259 (in-sample avg dev_std = 0.342)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.479, 0.565, 0.878], 'all_L1': [0.557, 0.616, 0.884]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.576, 0.931], 'all_L1': [0.525, 0.633, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.655, 0.922], 'all_L1': [0.558, 0.687, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.477, 0.602, 0.88], 'all_L1': [0.556, 0.657, 0.892]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.512, 0.834], 'all_L1': [0.47, 0.576, 0.85]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.661, 0.937], 'all_L1': [0.533, 0.705, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.468, 0.642, 0.915], 'all_L1': [0.526, 0.685, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.624, 0.931], 'all_L1': [0.565, 0.672, 0.927]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.56, 0.918], 'all_L1': [0.554, 0.612, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.561, 0.925], 'all_L1': [0.581, 0.609, 0.925]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.757, 0.78, 0.731], 'all_L1': [0.653, 0.653, 0.602]}), defaultdict(<class 'list'>, {'all_KL': [0.788, 0.806, 0.765], 'all_L1': [0.705, 0.689, 0.639]}), defaultdict(<class 'list'>, {'all_KL': [0.763, 0.829, 0.778], 'all_L1': [0.668, 0.69, 0.634]}), defaultdict(<class 'list'>, {'all_KL': [0.748, 0.812, 0.772], 'all_L1': [0.637, 0.675, 0.63]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.801, 0.758], 'all_L1': [0.646, 0.665, 0.623]}), defaultdict(<class 'list'>, {'all_KL': [0.818, 0.818, 0.766], 'all_L1': [0.713, 0.691, 0.633]}), defaultdict(<class 'list'>, {'all_KL': [0.814, 0.813, 0.76], 'all_L1': [0.71, 0.686, 0.629]}), defaultdict(<class 'list'>, {'all_KL': [0.789, 0.802, 0.746], 'all_L1': [0.688, 0.675, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.805, 0.75], 'all_L1': [0.647, 0.677, 0.622]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.828, 0.773], 'all_L1': [0.69, 0.698, 0.637]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.5, 0.612, 1.0], 'all_L1': [0.529, 0.611, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.699, 0.863, 0.941], 'all_L1': [0.713, 0.844, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.627, 0.764, 0.839], 'all_L1': [0.658, 0.762, 0.839]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.822, 1.0], 'all_L1': [0.728, 0.842, 1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.705, 0.84, 0.884], 'all_L1': [0.746, 0.851, 0.888]}), defaultdict(<class 'list'>, {'all_KL': [0.698, 0.908, 0.99], 'all_L1': [0.725, 0.893, 0.984]}), defaultdict(<class 'list'>, {'all_KL': [0.587, 0.872, 0.99], 'all_L1': [0.648, 0.874, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.398, 1.0], 'all_L1': [0.445, 0.459, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.779, 0.99], 'all_L1': [0.481, 0.783, 0.974]}), defaultdict(<class 'list'>, {'all_KL': [0.804, 0.884, 0.94], 'all_L1': [0.824, 0.88, 0.932]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.519, 0.588, 0.563], 'all_L1': [0.506, 0.545, 0.521]}), defaultdict(<class 'list'>, {'all_KL': [0.517, 0.756, 0.732], 'all_L1': [0.474, 0.633, 0.607]}), defaultdict(<class 'list'>, {'all_KL': [0.54, 0.685, 0.662], 'all_L1': [0.479, 0.565, 0.538]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.618, 0.629], 'all_L1': [0.381, 0.497, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.391, 0.536, 0.542], 'all_L1': [0.336, 0.433, 0.435]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.623, 0.618], 'all_L1': [0.492, 0.546, 0.528]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.6, 0.592], 'all_L1': [0.422, 0.495, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.788, 0.758], 'all_L1': [0.673, 0.679, 0.653]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.682, 0.668], 'all_L1': [0.604, 0.613, 0.592]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.141, 0.166], 'all_L1': [0.086, 0.13, 0.148]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.543 +- 0.029, 0.645 +- 0.040, 0.908 +- 0.024
suff_simple class all_KL  =  0.470 +- 0.035, 0.596 +- 0.046, 0.907 +- 0.031
[[0.4986666738986969, 0.5629583597183228, 0.8206480741500854], [0.460875004529953, 0.5604166388511658, 0.8701409697532654], [0.5116249918937683, 0.6546666622161865, 0.8596957921981812], [0.4949583411216736, 0.5827500224113464, 0.8217821717262268], [0.4038749933242798, 0.49825000762939453, 0.7728482484817505], [0.515999972820282, 0.6498749852180481, 0.8732337355613708], [0.546999990940094, 0.6298750042915344, 0.8535548448562622], [0.5093333125114441, 0.606083333492279, 0.8731343150138855], [0.5110416412353516, 0.5431666374206543, 0.8608169555664062], [0.5302500128746033, 0.5745000243186951, 0.8665398955345154]]
[[0.479, 0.565, 0.878], [0.447, 0.576, 0.931], [0.482, 0.655, 0.922], [0.477, 0.602, 0.88], [0.377, 0.512, 0.834], [0.474, 0.661, 0.937], [0.468, 0.642, 0.915], [0.491, 0.624, 0.931], [0.488, 0.56, 0.918], [0.518, 0.561, 0.925]]
suff_simple_acc_int  =  0.498 +- 0.038, 0.586 +- 0.047, 0.847 +- 0.031
nec class all_L1  =  0.676 +- 0.027, 0.680 +- 0.013, 0.626 +- 0.011
nec class all_KL  =  0.776 +- 0.025, 0.809 +- 0.014, 0.760 +- 0.014
[[0.2841666638851166, 0.3254166543483734, 0.3947083353996277], [0.23408333957195282, 0.2877083420753479, 0.3608750104904175], [0.29108333587646484, 0.30279165506362915, 0.3879166543483734], [0.3062500059604645, 0.30933332443237305, 0.37712499499320984], [0.3036666810512543, 0.3252499997615814, 0.3785416781902313], [0.20399999618530273, 0.2810416519641876, 0.3695416748523712], [0.2055416703224182, 0.2875416576862335, 0.37179166078567505], [0.26237499713897705, 0.30537500977516174, 0.3876666724681854], [0.3310000002384186, 0.3100416660308838, 0.3921666741371155], [0.24508333206176758, 0.28687500953674316, 0.3844166696071625]]
[[0.757, 0.78, 0.731], [0.788, 0.806, 0.765], [0.763, 0.829, 0.778], [0.748, 0.812, 0.772], [0.761, 0.801, 0.758], [0.818, 0.818, 0.766], [0.814, 0.813, 0.76], [0.789, 0.802, 0.746], [0.74, 0.805, 0.75], [0.786, 0.828, 0.773]]
nec_acc_int  =  0.267 +- 0.041, 0.302 +- 0.015, 0.380 +- 0.010

Eval split val
suff_simple class all_L1  =  0.650 +- 0.119, 0.780 +- 0.133, 0.950 +- 0.054
suff_simple class all_KL  =  0.609 +- 0.133, 0.774 +- 0.149, 0.957 +- 0.053
[[0.35975000262260437, 0.4286666810512543, 0.9295154213905334], [0.518875002861023, 0.6299999952316284, 0.6212499737739563], [0.4974166750907898, 0.6446666717529297, 0.6910025477409363], [0.5401666760444641, 0.624666690826416, 0.9322034120559692], [0.531624972820282, 0.4896666705608368, 0.6918032765388489], [0.7600833177566528, 0.7979999780654907, 0.5879180431365967], [0.659375011920929, 0.7183333039283752, 0.2832886576652527], [0.3309166729450226, 0.359333336353302, 0.9203883409500122], [0.40433332324028015, 0.6539999842643738, 0.9274285435676575], [0.3790833353996277, 0.4886666536331177, 0.1314496248960495]]
[[0.5, 0.612, 1.0], [0.699, 0.863, 0.941], [0.627, 0.764, 0.839], [0.684, 0.822, 1.0], [0.705, 0.84, 0.884], [0.698, 0.908, 0.99], [0.587, 0.872, 0.99], [0.377, 0.398, 1.0], [0.406, 0.779, 0.99], [0.804, 0.884, 0.94]]
suff_simple_acc_int  =  0.498 +- 0.130, 0.584 +- 0.130, 0.672 +- 0.267
nec class all_L1  =  0.445 +- 0.152, 0.514 +- 0.145, 0.500 +- 0.132
nec class all_KL  =  0.491 +- 0.165, 0.602 +- 0.170, 0.593 +- 0.156
[[0.3335416615009308, 0.34691667556762695, 0.3564166724681854], [0.34299999475479126, 0.2906250059604645, 0.3244166672229767], [0.33125001192092896, 0.3525833189487457, 0.39754167199134827], [0.32074999809265137, 0.3292083442211151, 0.3440000116825104], [0.32100000977516174, 0.3499999940395355, 0.36016666889190674], [0.2917916774749756, 0.3608333468437195, 0.4074999988079071], [0.28824999928474426, 0.3647083342075348, 0.3960833251476288], [0.250041663646698, 0.28454166650772095, 0.3089999854564667], [0.3295416533946991, 0.31187498569488525, 0.34033334255218506], [0.3342916667461395, 0.32483333349227905, 0.3490000069141388]]
[[0.519, 0.588, 0.563], [0.517, 0.756, 0.732], [0.54, 0.685, 0.662], [0.447, 0.618, 0.629], [0.391, 0.536, 0.542], [0.533, 0.623, 0.618], [0.495, 0.6, 0.592], [0.761, 0.788, 0.758], [0.622, 0.682, 0.668], [0.087, 0.141, 0.166]]
nec_acc_int  =  0.314 +- 0.027, 0.332 +- 0.027, 0.358 +- 0.031


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.609 +- 0.020, 0.663 +- 0.024, 0.767 +- 0.015
Faith. Armon (L1)= 		  =  0.601 +- 0.022, 0.662 +- 0.024, 0.741 +- 0.013
Faith. GMean (L1)= 	  =  0.605 +- 0.021, 0.662 +- 0.024, 0.754 +- 0.014
Faith. Aritm (KL)= 		  =  0.623 +- 0.023, 0.703 +- 0.027, 0.834 +- 0.018
Faith. Armon (KL)= 		  =  0.585 +- 0.030, 0.685 +- 0.034, 0.827 +- 0.017
Faith. GMean (KL)= 	  =  0.604 +- 0.026, 0.694 +- 0.030, 0.830 +- 0.018

Eval split val
Faith. Aritm (L1)= 		  =  0.548 +- 0.040, 0.647 +- 0.070, 0.725 +- 0.075
Faith. Armon (L1)= 		  =  0.493 +- 0.117, 0.592 +- 0.133, 0.643 +- 0.140
Faith. GMean (L1)= 	  =  0.516 +- 0.088, 0.616 +- 0.106, 0.681 +- 0.114
Faith. Aritm (KL)= 		  =  0.550 +- 0.048, 0.688 +- 0.086, 0.775 +- 0.086
Faith. Armon (KL)= 		  =  0.502 +- 0.121, 0.644 +- 0.152, 0.717 +- 0.154
Faith. GMean (KL)= 	  =  0.522 +- 0.093, 0.663 +- 0.124, 0.744 +- 0.125
Computed for split load_split = id



Completed in  0:21:50.385136  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GL-GSAT temp GOODMotif/basis/covariate NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:29:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:29:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9324
Train Loss: 0.2931
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2972
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3031
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2972
OOD Test ACCURACY: 0.9297
OOD Test Loss: 0.3031

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.9297 0.9297 0.9297 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.180
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.200
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18005533333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
SUFF_SIMPLE for r=0.3 class 0 = 0.222 +- 0.319 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.3 class 1 = 0.335 +- 0.319 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.3 class 2 = 0.591 +- 0.319 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.3 all KL = 0.277 +- 0.319 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.3 all L1 = 0.388 +- 0.282 (in-sample avg dev_std = 0.561)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25203733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.347
SUFF_SIMPLE for r=0.6 class 0 = 0.265 +- 0.368 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.6 class 1 = 0.4 +- 0.368 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.6 class 2 = 0.545 +- 0.368 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.6 all KL = 0.319 +- 0.368 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.6 all L1 = 0.407 +- 0.319 (in-sample avg dev_std = 0.423)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29501133333333335
len(reference) = 2713
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.581
SUFF_SIMPLE for r=0.9 class 0 = 0.598 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.748 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.628 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.621 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.659 +- 0.400 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20002166666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
SUFF_SIMPLE for r=0.3 class 0 = 0.403 +- 0.418 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.3 class 1 = 0.211 +- 0.418 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.3 class 2 = 0.901 +- 0.418 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.3 all KL = 0.476 +- 0.418 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.3 all L1 = 0.506 +- 0.356 (in-sample avg dev_std = 0.259)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32067666666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.32
SUFF_SIMPLE for r=0.6 class 0 = 0.403 +- 0.437 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.6 class 1 = 0.216 +- 0.437 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.6 class 2 = 0.897 +- 0.437 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.6 all KL = 0.484 +- 0.437 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.6 all L1 = 0.506 +- 0.371 (in-sample avg dev_std = 0.123)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3559523333333333
len(reference) = 2659
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.428
SUFF_SIMPLE for r=0.9 class 0 = 0.553 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.518 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.598 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.565 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.557 +- 0.344 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18005533333333335
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
NEC for r=0.3 class 0 = 0.686 +- 0.340 (in-sample avg dev_std = 0.588)
NEC for r=0.3 class 1 = 0.526 +- 0.340 (in-sample avg dev_std = 0.588)
NEC for r=0.3 class 2 = 0.479 +- 0.340 (in-sample avg dev_std = 0.588)
NEC for r=0.3 all KL = 0.666 +- 0.340 (in-sample avg dev_std = 0.588)
NEC for r=0.3 all L1 = 0.561 +- 0.296 (in-sample avg dev_std = 0.588)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25203733333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.699 +- 0.262 (in-sample avg dev_std = 0.703)
NEC for r=0.6 class 1 = 0.555 +- 0.262 (in-sample avg dev_std = 0.703)
NEC for r=0.6 class 2 = 0.493 +- 0.262 (in-sample avg dev_std = 0.703)
NEC for r=0.6 all KL = 0.706 +- 0.262 (in-sample avg dev_std = 0.703)
NEC for r=0.6 all L1 = 0.579 +- 0.237 (in-sample avg dev_std = 0.703)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29501133333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.419
NEC for r=0.9 class 0 = 0.697 +- 0.248 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 1 = 0.556 +- 0.248 (in-sample avg dev_std = 0.715)
NEC for r=0.9 class 2 = 0.503 +- 0.248 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all KL = 0.712 +- 0.248 (in-sample avg dev_std = 0.715)
NEC for r=0.9 all L1 = 0.583 +- 0.227 (in-sample avg dev_std = 0.715)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.774
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20002166666666668
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
NEC for r=0.3 class 0 = 0.589 +- 0.392 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.698 +- 0.392 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.158 +- 0.392 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.51 +- 0.392 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.481 +- 0.326 (in-sample avg dev_std = 0.400)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.774
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32067666666666667
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.364
NEC for r=0.6 class 0 = 0.596 +- 0.365 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 1 = 0.721 +- 0.365 (in-sample avg dev_std = 0.477)
NEC for r=0.6 class 2 = 0.22 +- 0.365 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all KL = 0.552 +- 0.365 (in-sample avg dev_std = 0.477)
NEC for r=0.6 all L1 = 0.512 +- 0.298 (in-sample avg dev_std = 0.477)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.774
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3559523333333333
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.364
NEC for r=0.9 class 0 = 0.596 +- 0.362 (in-sample avg dev_std = 0.488)
NEC for r=0.9 class 1 = 0.727 +- 0.362 (in-sample avg dev_std = 0.488)
NEC for r=0.9 class 2 = 0.222 +- 0.362 (in-sample avg dev_std = 0.488)
NEC for r=0.9 all KL = 0.556 +- 0.362 (in-sample avg dev_std = 0.488)
NEC for r=0.9 all L1 = 0.514 +- 0.295 (in-sample avg dev_std = 0.488)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:31:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:31:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2980
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3018
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3018
OOD Test ACCURACY: 0.9273
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9273 0.9273 0.9273 0.9273 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.296
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.374


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18404466666666666
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
SUFF_SIMPLE for r=0.3 class 0 = 0.242 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 class 1 = 0.407 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 class 2 = 0.493 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 all KL = 0.281 +- 0.327 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.3 all L1 = 0.384 +- 0.288 (in-sample avg dev_std = 0.535)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2530036666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.318
SUFF_SIMPLE for r=0.6 class 0 = 0.291 +- 0.359 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 class 1 = 0.523 +- 0.359 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 class 2 = 0.332 +- 0.359 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 all KL = 0.302 +- 0.359 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.6 all L1 = 0.383 +- 0.306 (in-sample avg dev_std = 0.385)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29577833333333337
len(reference) = 2707
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.557
SUFF_SIMPLE for r=0.9 class 0 = 0.535 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.789 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.587 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.602 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.638 +- 0.399 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.201067
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.3
SUFF_SIMPLE for r=0.3 class 0 = 0.407 +- 0.257 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.3 class 1 = 0.266 +- 0.257 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.3 class 2 = 0.581 +- 0.257 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.3 all KL = 0.323 +- 0.257 (in-sample avg dev_std = 0.642)
SUFF_SIMPLE for r=0.3 all L1 = 0.419 +- 0.233 (in-sample avg dev_std = 0.642)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32370699999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.492 +- 0.409 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 class 1 = 0.343 +- 0.409 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 class 2 = 0.623 +- 0.409 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 all KL = 0.444 +- 0.409 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.6 all L1 = 0.487 +- 0.352 (in-sample avg dev_std = 0.295)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.695
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.37379733333333337
len(reference) = 2829
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.342
SUFF_SIMPLE for r=0.9 class 0 = 0.6 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.577 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.64 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.587 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.606 +- 0.392 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18404466666666666
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.391
NEC for r=0.3 class 0 = 0.682 +- 0.315 (in-sample avg dev_std = 0.568)
NEC for r=0.3 class 1 = 0.457 +- 0.315 (in-sample avg dev_std = 0.568)
NEC for r=0.3 class 2 = 0.639 +- 0.315 (in-sample avg dev_std = 0.568)
NEC for r=0.3 all KL = 0.689 +- 0.315 (in-sample avg dev_std = 0.568)
NEC for r=0.3 all L1 = 0.592 +- 0.272 (in-sample avg dev_std = 0.568)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2530036666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.387
NEC for r=0.6 class 0 = 0.698 +- 0.231 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 1 = 0.505 +- 0.231 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 2 = 0.649 +- 0.231 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all KL = 0.737 +- 0.231 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all L1 = 0.616 +- 0.210 (in-sample avg dev_std = 0.699)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29577833333333337
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.387
NEC for r=0.9 class 0 = 0.7 +- 0.214 (in-sample avg dev_std = 0.721)
NEC for r=0.9 class 1 = 0.513 +- 0.214 (in-sample avg dev_std = 0.721)
NEC for r=0.9 class 2 = 0.654 +- 0.214 (in-sample avg dev_std = 0.721)
NEC for r=0.9 all KL = 0.746 +- 0.214 (in-sample avg dev_std = 0.721)
NEC for r=0.9 all L1 = 0.622 +- 0.196 (in-sample avg dev_std = 0.721)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.201067
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.572 +- 0.329 (in-sample avg dev_std = 0.640)
NEC for r=0.3 class 1 = 0.519 +- 0.329 (in-sample avg dev_std = 0.640)
NEC for r=0.3 class 2 = 0.49 +- 0.329 (in-sample avg dev_std = 0.640)
NEC for r=0.3 all KL = 0.617 +- 0.329 (in-sample avg dev_std = 0.640)
NEC for r=0.3 all L1 = 0.527 +- 0.285 (in-sample avg dev_std = 0.640)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.704
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32370699999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.339
NEC for r=0.6 class 0 = 0.59 +- 0.225 (in-sample avg dev_std = 0.740)
NEC for r=0.6 class 1 = 0.596 +- 0.225 (in-sample avg dev_std = 0.740)
NEC for r=0.6 class 2 = 0.561 +- 0.225 (in-sample avg dev_std = 0.740)
NEC for r=0.6 all KL = 0.696 +- 0.225 (in-sample avg dev_std = 0.740)
NEC for r=0.6 all L1 = 0.582 +- 0.206 (in-sample avg dev_std = 0.740)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.704
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.37379733333333337
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.347
NEC for r=0.9 class 0 = 0.603 +- 0.192 (in-sample avg dev_std = 0.762)
NEC for r=0.9 class 1 = 0.611 +- 0.192 (in-sample avg dev_std = 0.762)
NEC for r=0.9 class 2 = 0.568 +- 0.192 (in-sample avg dev_std = 0.762)
NEC for r=0.9 all KL = 0.714 +- 0.192 (in-sample avg dev_std = 0.762)
NEC for r=0.9 all L1 = 0.594 +- 0.183 (in-sample avg dev_std = 0.762)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:33:35 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:33:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 108 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2947
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.2998
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3065
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.2998
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3065

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9303 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.254
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.205
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.317
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.372


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18159166666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.34
SUFF_SIMPLE for r=0.3 class 0 = 0.261 +- 0.311 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.3 class 1 = 0.342 +- 0.311 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.3 class 2 = 0.512 +- 0.311 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.3 all KL = 0.258 +- 0.311 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.3 all L1 = 0.375 +- 0.272 (in-sample avg dev_std = 0.602)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25428700000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF_SIMPLE for r=0.6 class 0 = 0.341 +- 0.358 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 class 1 = 0.46 +- 0.358 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 class 2 = 0.363 +- 0.358 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 all KL = 0.296 +- 0.358 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.6 all L1 = 0.388 +- 0.307 (in-sample avg dev_std = 0.443)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.929
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2946726666666667
len(reference) = 2703
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.582
SUFF_SIMPLE for r=0.9 class 0 = 0.608 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.762 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.611 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.623 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.661 +- 0.401 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2054476666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
SUFF_SIMPLE for r=0.3 class 0 = 0.413 +- 0.343 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.3 class 1 = 0.244 +- 0.343 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.3 class 2 = 0.733 +- 0.343 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.3 all KL = 0.373 +- 0.343 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.3 all L1 = 0.464 +- 0.309 (in-sample avg dev_std = 0.502)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31712000000000007
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.302
SUFF_SIMPLE for r=0.6 class 0 = 0.466 +- 0.432 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.6 class 1 = 0.277 +- 0.432 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.6 class 2 = 0.736 +- 0.432 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.6 all KL = 0.437 +- 0.432 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.6 all L1 = 0.494 +- 0.374 (in-sample avg dev_std = 0.223)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3715286666666667
len(reference) = 2722
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.458
SUFF_SIMPLE for r=0.9 class 0 = 0.613 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.584 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.758 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.622 +- 0.455 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.399 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18159166666666665
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.41
NEC for r=0.3 class 0 = 0.574 +- 0.334 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 1 = 0.509 +- 0.334 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 2 = 0.622 +- 0.334 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all KL = 0.674 +- 0.334 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all L1 = 0.569 +- 0.288 (in-sample avg dev_std = 0.591)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25428700000000004
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.413
NEC for r=0.6 class 0 = 0.635 +- 0.209 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 1 = 0.545 +- 0.209 (in-sample avg dev_std = 0.766)
NEC for r=0.6 class 2 = 0.643 +- 0.209 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all KL = 0.746 +- 0.209 (in-sample avg dev_std = 0.766)
NEC for r=0.6 all L1 = 0.607 +- 0.193 (in-sample avg dev_std = 0.766)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2946726666666667
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.414
NEC for r=0.9 class 0 = 0.642 +- 0.184 (in-sample avg dev_std = 0.790)
NEC for r=0.9 class 1 = 0.553 +- 0.184 (in-sample avg dev_std = 0.790)
NEC for r=0.9 class 2 = 0.645 +- 0.184 (in-sample avg dev_std = 0.790)
NEC for r=0.9 all KL = 0.756 +- 0.184 (in-sample avg dev_std = 0.790)
NEC for r=0.9 all L1 = 0.613 +- 0.174 (in-sample avg dev_std = 0.790)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.797
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2054476666666667
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.428
NEC for r=0.3 class 0 = 0.519 +- 0.366 (in-sample avg dev_std = 0.613)
NEC for r=0.3 class 1 = 0.526 +- 0.366 (in-sample avg dev_std = 0.613)
NEC for r=0.3 class 2 = 0.359 +- 0.366 (in-sample avg dev_std = 0.613)
NEC for r=0.3 all KL = 0.556 +- 0.366 (in-sample avg dev_std = 0.613)
NEC for r=0.3 all L1 = 0.468 +- 0.311 (in-sample avg dev_std = 0.613)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.797
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31712000000000007
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.546 +- 0.286 (in-sample avg dev_std = 0.724)
NEC for r=0.6 class 1 = 0.562 +- 0.286 (in-sample avg dev_std = 0.724)
NEC for r=0.6 class 2 = 0.41 +- 0.286 (in-sample avg dev_std = 0.724)
NEC for r=0.6 all KL = 0.618 +- 0.286 (in-sample avg dev_std = 0.724)
NEC for r=0.6 all L1 = 0.506 +- 0.250 (in-sample avg dev_std = 0.724)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.797
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3715286666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.414
NEC for r=0.9 class 0 = 0.553 +- 0.251 (in-sample avg dev_std = 0.762)
NEC for r=0.9 class 1 = 0.593 +- 0.251 (in-sample avg dev_std = 0.762)
NEC for r=0.9 class 2 = 0.42 +- 0.251 (in-sample avg dev_std = 0.762)
NEC for r=0.9 all KL = 0.643 +- 0.251 (in-sample avg dev_std = 0.762)
NEC for r=0.9 all L1 = 0.522 +- 0.223 (in-sample avg dev_std = 0.762)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:35:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:35:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3004
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3073
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3004
OOD Test ACCURACY: 0.9283
OOD Test Loss: 0.3073

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.9283 0.9283 0.9283 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.180
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.353


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18047466666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.218 +- 0.318 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 class 1 = 0.366 +- 0.318 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 class 2 = 0.552 +- 0.318 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 all KL = 0.268 +- 0.318 (in-sample avg dev_std = 0.587)
SUFF_SIMPLE for r=0.3 all L1 = 0.383 +- 0.281 (in-sample avg dev_std = 0.587)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24993666666666664
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.31
SUFF_SIMPLE for r=0.6 class 0 = 0.248 +- 0.362 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.6 class 1 = 0.437 +- 0.362 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.6 class 2 = 0.467 +- 0.362 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.6 all KL = 0.289 +- 0.362 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.6 all L1 = 0.387 +- 0.318 (in-sample avg dev_std = 0.441)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29415933333333333
len(reference) = 2710
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.573
SUFF_SIMPLE for r=0.9 class 0 = 0.567 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.786 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.61 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.614 +- 0.459 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.655 +- 0.404 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20728599999999997
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.301
SUFF_SIMPLE for r=0.3 class 0 = 0.524 +- 0.362 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.3 class 1 = 0.341 +- 0.362 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.3 class 2 = 0.73 +- 0.362 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.3 all KL = 0.433 +- 0.362 (in-sample avg dev_std = 0.547)
SUFF_SIMPLE for r=0.3 all L1 = 0.533 +- 0.322 (in-sample avg dev_std = 0.547)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.320293
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.293
SUFF_SIMPLE for r=0.6 class 0 = 0.568 +- 0.449 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 class 1 = 0.396 +- 0.449 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 class 2 = 0.761 +- 0.449 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 all KL = 0.511 +- 0.449 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.6 all L1 = 0.575 +- 0.394 (in-sample avg dev_std = 0.270)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35268933333333335
len(reference) = 2654
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.367
SUFF_SIMPLE for r=0.9 class 0 = 0.669 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.517 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.822 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.634 +- 0.454 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.671 +- 0.399 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18047466666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.394
NEC for r=0.3 class 0 = 0.674 +- 0.335 (in-sample avg dev_std = 0.598)
NEC for r=0.3 class 1 = 0.494 +- 0.335 (in-sample avg dev_std = 0.598)
NEC for r=0.3 class 2 = 0.551 +- 0.335 (in-sample avg dev_std = 0.598)
NEC for r=0.3 all KL = 0.682 +- 0.335 (in-sample avg dev_std = 0.598)
NEC for r=0.3 all L1 = 0.571 +- 0.296 (in-sample avg dev_std = 0.598)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.24993666666666664
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.402
NEC for r=0.6 class 0 = 0.696 +- 0.220 (in-sample avg dev_std = 0.755)
NEC for r=0.6 class 1 = 0.54 +- 0.220 (in-sample avg dev_std = 0.755)
NEC for r=0.6 class 2 = 0.579 +- 0.220 (in-sample avg dev_std = 0.755)
NEC for r=0.6 all KL = 0.742 +- 0.220 (in-sample avg dev_std = 0.755)
NEC for r=0.6 all L1 = 0.603 +- 0.208 (in-sample avg dev_std = 0.755)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29415933333333333
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.397
NEC for r=0.9 class 0 = 0.706 +- 0.203 (in-sample avg dev_std = 0.768)
NEC for r=0.9 class 1 = 0.554 +- 0.203 (in-sample avg dev_std = 0.768)
NEC for r=0.9 class 2 = 0.582 +- 0.203 (in-sample avg dev_std = 0.768)
NEC for r=0.9 all KL = 0.753 +- 0.203 (in-sample avg dev_std = 0.768)
NEC for r=0.9 all L1 = 0.612 +- 0.195 (in-sample avg dev_std = 0.768)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.689
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20728599999999997
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.376
NEC for r=0.3 class 0 = 0.502 +- 0.378 (in-sample avg dev_std = 0.610)
NEC for r=0.3 class 1 = 0.531 +- 0.378 (in-sample avg dev_std = 0.610)
NEC for r=0.3 class 2 = 0.31 +- 0.378 (in-sample avg dev_std = 0.610)
NEC for r=0.3 all KL = 0.547 +- 0.378 (in-sample avg dev_std = 0.610)
NEC for r=0.3 all L1 = 0.447 +- 0.325 (in-sample avg dev_std = 0.610)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.320293
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.362
NEC for r=0.6 class 0 = 0.507 +- 0.308 (in-sample avg dev_std = 0.716)
NEC for r=0.6 class 1 = 0.592 +- 0.308 (in-sample avg dev_std = 0.716)
NEC for r=0.6 class 2 = 0.36 +- 0.308 (in-sample avg dev_std = 0.716)
NEC for r=0.6 all KL = 0.609 +- 0.308 (in-sample avg dev_std = 0.716)
NEC for r=0.6 all L1 = 0.486 +- 0.270 (in-sample avg dev_std = 0.716)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35268933333333335
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.369
NEC for r=0.9 class 0 = 0.51 +- 0.285 (in-sample avg dev_std = 0.744)
NEC for r=0.9 class 1 = 0.598 +- 0.285 (in-sample avg dev_std = 0.744)
NEC for r=0.9 class 2 = 0.37 +- 0.285 (in-sample avg dev_std = 0.744)
NEC for r=0.9 all KL = 0.621 +- 0.285 (in-sample avg dev_std = 0.744)
NEC for r=0.9 all L1 = 0.492 +- 0.252 (in-sample avg dev_std = 0.744)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:37:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:37:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9316
Train Loss: 0.2962
ID Validation ACCURACY: 0.9307
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3076
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3005
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3076

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9307 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.177
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.293
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.203
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.311
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.366


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17747766666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
SUFF_SIMPLE for r=0.3 class 0 = 0.207 +- 0.322 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 class 1 = 0.359 +- 0.322 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 class 2 = 0.583 +- 0.322 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 all KL = 0.275 +- 0.322 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 all L1 = 0.388 +- 0.288 (in-sample avg dev_std = 0.555)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.249343
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.319
SUFF_SIMPLE for r=0.6 class 0 = 0.223 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 class 1 = 0.475 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 class 2 = 0.486 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 all KL = 0.304 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 all L1 = 0.398 +- 0.330 (in-sample avg dev_std = 0.402)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29323733333333335
len(reference) = 2698
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.554
SUFF_SIMPLE for r=0.9 class 0 = 0.504 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.808 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.601 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.599 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.639 +- 0.403 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2027763333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.315
SUFF_SIMPLE for r=0.3 class 0 = 0.617 +- 0.375 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 class 1 = 0.391 +- 0.375 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 class 2 = 0.804 +- 0.375 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 all KL = 0.525 +- 0.375 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.3 all L1 = 0.605 +- 0.333 (in-sample avg dev_std = 0.491)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31096066666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.31
SUFF_SIMPLE for r=0.6 class 0 = 0.662 +- 0.442 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.6 class 1 = 0.445 +- 0.442 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.6 class 2 = 0.842 +- 0.442 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.6 all KL = 0.606 +- 0.442 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.6 all L1 = 0.65 +- 0.390 (in-sample avg dev_std = 0.224)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.637
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36591
len(reference) = 2769
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.445
SUFF_SIMPLE for r=0.9 class 0 = 0.706 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.693 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.882 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.743 +- 0.407 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.762 +- 0.364 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.17747766666666667
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.398
NEC for r=0.3 class 0 = 0.706 +- 0.344 (in-sample avg dev_std = 0.573)
NEC for r=0.3 class 1 = 0.475 +- 0.344 (in-sample avg dev_std = 0.573)
NEC for r=0.3 class 2 = 0.523 +- 0.344 (in-sample avg dev_std = 0.573)
NEC for r=0.3 all KL = 0.67 +- 0.344 (in-sample avg dev_std = 0.573)
NEC for r=0.3 all L1 = 0.565 +- 0.304 (in-sample avg dev_std = 0.573)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.249343
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.395
NEC for r=0.6 class 0 = 0.725 +- 0.228 (in-sample avg dev_std = 0.733)
NEC for r=0.6 class 1 = 0.531 +- 0.228 (in-sample avg dev_std = 0.733)
NEC for r=0.6 class 2 = 0.567 +- 0.228 (in-sample avg dev_std = 0.733)
NEC for r=0.6 all KL = 0.738 +- 0.228 (in-sample avg dev_std = 0.733)
NEC for r=0.6 all L1 = 0.605 +- 0.213 (in-sample avg dev_std = 0.733)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29323733333333335
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.401
NEC for r=0.9 class 0 = 0.725 +- 0.219 (in-sample avg dev_std = 0.747)
NEC for r=0.9 class 1 = 0.534 +- 0.219 (in-sample avg dev_std = 0.747)
NEC for r=0.9 class 2 = 0.559 +- 0.219 (in-sample avg dev_std = 0.747)
NEC for r=0.9 all KL = 0.738 +- 0.219 (in-sample avg dev_std = 0.747)
NEC for r=0.9 all L1 = 0.603 +- 0.206 (in-sample avg dev_std = 0.747)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.2027763333333333
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.406 +- 0.389 (in-sample avg dev_std = 0.557)
NEC for r=0.3 class 1 = 0.493 +- 0.389 (in-sample avg dev_std = 0.557)
NEC for r=0.3 class 2 = 0.264 +- 0.389 (in-sample avg dev_std = 0.557)
NEC for r=0.3 all KL = 0.465 +- 0.389 (in-sample avg dev_std = 0.557)
NEC for r=0.3 all L1 = 0.387 +- 0.332 (in-sample avg dev_std = 0.557)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31096066666666666
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.373
NEC for r=0.6 class 0 = 0.423 +- 0.340 (in-sample avg dev_std = 0.654)
NEC for r=0.6 class 1 = 0.544 +- 0.340 (in-sample avg dev_std = 0.654)
NEC for r=0.6 class 2 = 0.288 +- 0.340 (in-sample avg dev_std = 0.654)
NEC for r=0.6 all KL = 0.517 +- 0.340 (in-sample avg dev_std = 0.654)
NEC for r=0.6 all L1 = 0.418 +- 0.292 (in-sample avg dev_std = 0.654)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36591
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.368
NEC for r=0.9 class 0 = 0.436 +- 0.324 (in-sample avg dev_std = 0.683)
NEC for r=0.9 class 1 = 0.554 +- 0.324 (in-sample avg dev_std = 0.683)
NEC for r=0.9 class 2 = 0.297 +- 0.324 (in-sample avg dev_std = 0.683)
NEC for r=0.9 all KL = 0.534 +- 0.324 (in-sample avg dev_std = 0.683)
NEC for r=0.9 all L1 = 0.428 +- 0.278 (in-sample avg dev_std = 0.683)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:39:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:39:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.2992
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3033
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3078
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3033
OOD Test ACCURACY: 0.9280
OOD Test Loss: 0.3078

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.9280 0.9280 0.9280 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.181
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.250
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.363


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18117266666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
SUFF_SIMPLE for r=0.3 class 0 = 0.459 +- 0.300 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 class 1 = 0.425 +- 0.300 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 class 2 = 0.229 +- 0.300 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 all KL = 0.272 +- 0.300 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 all L1 = 0.368 +- 0.248 (in-sample avg dev_std = 0.552)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25049199999999994
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF_SIMPLE for r=0.6 class 0 = 0.405 +- 0.383 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 class 1 = 0.582 +- 0.383 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 class 2 = 0.249 +- 0.383 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 all KL = 0.324 +- 0.383 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.6 all L1 = 0.41 +- 0.333 (in-sample avg dev_std = 0.402)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.295374
len(reference) = 2708
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.572
SUFF_SIMPLE for r=0.9 class 0 = 0.577 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.787 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.582 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.611 +- 0.457 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.649 +- 0.401 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20392366666666664
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
SUFF_SIMPLE for r=0.3 class 0 = 0.539 +- 0.299 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.3 class 1 = 0.414 +- 0.299 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.3 class 2 = 0.2 +- 0.299 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.3 all KL = 0.303 +- 0.299 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.3 all L1 = 0.384 +- 0.254 (in-sample avg dev_std = 0.537)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32447899999999996
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.327
SUFF_SIMPLE for r=0.6 class 0 = 0.573 +- 0.414 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 class 1 = 0.548 +- 0.414 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 class 2 = 0.226 +- 0.414 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 all KL = 0.401 +- 0.414 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.6 all L1 = 0.449 +- 0.351 (in-sample avg dev_std = 0.231)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634516666666667
len(reference) = 2682
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.358
SUFF_SIMPLE for r=0.9 class 0 = 0.633 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.792 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.296 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.54 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.576 +- 0.398 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18117266666666668
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.412
NEC for r=0.3 class 0 = 0.585 +- 0.351 (in-sample avg dev_std = 0.578)
NEC for r=0.3 class 1 = 0.388 +- 0.351 (in-sample avg dev_std = 0.578)
NEC for r=0.3 class 2 = 0.683 +- 0.351 (in-sample avg dev_std = 0.578)
NEC for r=0.3 all KL = 0.653 +- 0.351 (in-sample avg dev_std = 0.578)
NEC for r=0.3 all L1 = 0.553 +- 0.306 (in-sample avg dev_std = 0.578)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25049199999999994
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.409
NEC for r=0.6 class 0 = 0.628 +- 0.235 (in-sample avg dev_std = 0.737)
NEC for r=0.6 class 1 = 0.464 +- 0.235 (in-sample avg dev_std = 0.737)
NEC for r=0.6 class 2 = 0.702 +- 0.235 (in-sample avg dev_std = 0.737)
NEC for r=0.6 all KL = 0.727 +- 0.235 (in-sample avg dev_std = 0.737)
NEC for r=0.6 all L1 = 0.599 +- 0.216 (in-sample avg dev_std = 0.737)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.295374
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.407
NEC for r=0.9 class 0 = 0.636 +- 0.216 (in-sample avg dev_std = 0.756)
NEC for r=0.9 class 1 = 0.481 +- 0.216 (in-sample avg dev_std = 0.756)
NEC for r=0.9 class 2 = 0.696 +- 0.216 (in-sample avg dev_std = 0.756)
NEC for r=0.9 all KL = 0.737 +- 0.216 (in-sample avg dev_std = 0.756)
NEC for r=0.9 all L1 = 0.605 +- 0.201 (in-sample avg dev_std = 0.756)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20392366666666664
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.457
NEC for r=0.3 class 0 = 0.491 +- 0.369 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 1 = 0.285 +- 0.369 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 2 = 0.602 +- 0.369 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all KL = 0.529 +- 0.369 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all L1 = 0.46 +- 0.312 (in-sample avg dev_std = 0.581)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32447899999999996
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.431
NEC for r=0.6 class 0 = 0.515 +- 0.318 (in-sample avg dev_std = 0.683)
NEC for r=0.6 class 1 = 0.334 +- 0.318 (in-sample avg dev_std = 0.683)
NEC for r=0.6 class 2 = 0.697 +- 0.318 (in-sample avg dev_std = 0.683)
NEC for r=0.6 all KL = 0.606 +- 0.318 (in-sample avg dev_std = 0.683)
NEC for r=0.6 all L1 = 0.516 +- 0.267 (in-sample avg dev_std = 0.683)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634516666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.442
NEC for r=0.9 class 0 = 0.51 +- 0.308 (in-sample avg dev_std = 0.711)
NEC for r=0.9 class 1 = 0.321 +- 0.308 (in-sample avg dev_std = 0.711)
NEC for r=0.9 class 2 = 0.687 +- 0.308 (in-sample avg dev_std = 0.711)
NEC for r=0.9 all KL = 0.599 +- 0.308 (in-sample avg dev_std = 0.711)
NEC for r=0.9 all L1 = 0.507 +- 0.258 (in-sample avg dev_std = 0.711)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:42:01 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:42:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.2993
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3037
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3091
OOD Validation ACCURACY: 0.9297
OOD Validation Loss: 0.3037
OOD Test ACCURACY: 0.9270
OOD Test Loss: 0.3091

[0m[1;37mINFO[0m: [1mChartInfo 0.9270 0.9270 0.9270 0.9270 0.9297 0.9297[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.251
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.369


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18226900000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
SUFF_SIMPLE for r=0.3 class 0 = 0.425 +- 0.301 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.3 class 1 = 0.435 +- 0.301 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.3 class 2 = 0.238 +- 0.301 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.3 all KL = 0.267 +- 0.301 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.3 all L1 = 0.364 +- 0.253 (in-sample avg dev_std = 0.531)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2512826666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.328
SUFF_SIMPLE for r=0.6 class 0 = 0.377 +- 0.383 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 class 1 = 0.598 +- 0.383 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 class 2 = 0.237 +- 0.383 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all KL = 0.319 +- 0.383 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.6 all L1 = 0.403 +- 0.331 (in-sample avg dev_std = 0.373)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29548566666666665
len(reference) = 2705
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.557
SUFF_SIMPLE for r=0.9 class 0 = 0.541 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.812 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.566 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.602 +- 0.460 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.64 +- 0.403 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19703299999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF_SIMPLE for r=0.3 class 0 = 0.503 +- 0.307 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.3 class 1 = 0.417 +- 0.307 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.3 class 2 = 0.424 +- 0.307 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.3 all KL = 0.341 +- 0.307 (in-sample avg dev_std = 0.635)
SUFF_SIMPLE for r=0.3 all L1 = 0.448 +- 0.269 (in-sample avg dev_std = 0.635)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31629599999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.32
SUFF_SIMPLE for r=0.6 class 0 = 0.548 +- 0.427 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.6 class 1 = 0.575 +- 0.427 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.6 class 2 = 0.45 +- 0.427 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.6 all KL = 0.465 +- 0.427 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.6 all L1 = 0.524 +- 0.369 (in-sample avg dev_std = 0.313)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.578
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36851400000000006
len(reference) = 2696
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.372
SUFF_SIMPLE for r=0.9 class 0 = 0.724 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.718 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.762 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.708 +- 0.430 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.735 +- 0.381 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.93
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18226900000000001
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.417
NEC for r=0.3 class 0 = 0.602 +- 0.355 (in-sample avg dev_std = 0.564)
NEC for r=0.3 class 1 = 0.384 +- 0.355 (in-sample avg dev_std = 0.564)
NEC for r=0.3 class 2 = 0.683 +- 0.355 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all KL = 0.655 +- 0.355 (in-sample avg dev_std = 0.564)
NEC for r=0.3 all L1 = 0.557 +- 0.306 (in-sample avg dev_std = 0.564)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.93
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2512826666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.407
NEC for r=0.6 class 0 = 0.642 +- 0.244 (in-sample avg dev_std = 0.720)
NEC for r=0.6 class 1 = 0.451 +- 0.244 (in-sample avg dev_std = 0.720)
NEC for r=0.6 class 2 = 0.707 +- 0.244 (in-sample avg dev_std = 0.720)
NEC for r=0.6 all KL = 0.729 +- 0.244 (in-sample avg dev_std = 0.720)
NEC for r=0.6 all L1 = 0.6 +- 0.223 (in-sample avg dev_std = 0.720)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29548566666666665
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.406
NEC for r=0.9 class 0 = 0.643 +- 0.228 (in-sample avg dev_std = 0.741)
NEC for r=0.9 class 1 = 0.46 +- 0.228 (in-sample avg dev_std = 0.741)
NEC for r=0.9 class 2 = 0.716 +- 0.228 (in-sample avg dev_std = 0.741)
NEC for r=0.9 all KL = 0.738 +- 0.228 (in-sample avg dev_std = 0.741)
NEC for r=0.9 all L1 = 0.607 +- 0.209 (in-sample avg dev_std = 0.741)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.606
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.19703299999999999
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.417
NEC for r=0.3 class 0 = 0.447 +- 0.393 (in-sample avg dev_std = 0.589)
NEC for r=0.3 class 1 = 0.424 +- 0.393 (in-sample avg dev_std = 0.589)
NEC for r=0.3 class 2 = 0.407 +- 0.393 (in-sample avg dev_std = 0.589)
NEC for r=0.3 all KL = 0.513 +- 0.393 (in-sample avg dev_std = 0.589)
NEC for r=0.3 all L1 = 0.426 +- 0.333 (in-sample avg dev_std = 0.589)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.31629599999999997
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.4
NEC for r=0.6 class 0 = 0.474 +- 0.347 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 1 = 0.472 +- 0.347 (in-sample avg dev_std = 0.699)
NEC for r=0.6 class 2 = 0.448 +- 0.347 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all KL = 0.573 +- 0.347 (in-sample avg dev_std = 0.699)
NEC for r=0.6 all L1 = 0.465 +- 0.293 (in-sample avg dev_std = 0.699)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.606
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.36851400000000006
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.407
NEC for r=0.9 class 0 = 0.468 +- 0.335 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 1 = 0.473 +- 0.335 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 2 = 0.461 +- 0.335 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all KL = 0.581 +- 0.335 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all L1 = 0.467 +- 0.281 (in-sample avg dev_std = 0.728)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:44:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:44:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2931
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.2986
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.2986
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9310 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.182
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.294
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.214
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.326
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.181646
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF_SIMPLE for r=0.3 class 0 = 0.237 +- 0.321 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.3 class 1 = 0.342 +- 0.321 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.3 class 2 = 0.565 +- 0.321 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.3 all KL = 0.275 +- 0.321 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.3 all L1 = 0.385 +- 0.281 (in-sample avg dev_std = 0.569)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25270533333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF_SIMPLE for r=0.6 class 0 = 0.282 +- 0.363 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.6 class 1 = 0.419 +- 0.363 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.6 class 2 = 0.48 +- 0.363 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.6 all KL = 0.309 +- 0.363 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.6 all L1 = 0.396 +- 0.313 (in-sample avg dev_std = 0.419)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294429
len(reference) = 2714
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.571
SUFF_SIMPLE for r=0.9 class 0 = 0.599 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.776 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.6 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.622 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.659 +- 0.400 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21388133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.332
SUFF_SIMPLE for r=0.3 class 0 = 0.213 +- 0.440 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.3 class 1 = 0.19 +- 0.440 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.3 class 2 = 0.933 +- 0.440 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.3 all KL = 0.379 +- 0.440 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.3 all L1 = 0.446 +- 0.386 (in-sample avg dev_std = 0.075)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32592933333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.332
SUFF_SIMPLE for r=0.6 class 0 = 0.218 +- 0.439 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.6 class 1 = 0.203 +- 0.439 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.6 class 2 = 0.91 +- 0.439 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.6 all KL = 0.378 +- 0.439 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.6 all L1 = 0.444 +- 0.384 (in-sample avg dev_std = 0.052)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.904
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3549536666666666
len(reference) = 2665
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.287
SUFF_SIMPLE for r=0.9 class 0 = 0.368 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.441 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.384 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.348 +- 0.395 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.398 +- 0.340 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.931
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.181646
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.403
NEC for r=0.3 class 0 = 0.657 +- 0.329 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 1 = 0.537 +- 0.329 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 2 = 0.523 +- 0.329 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all KL = 0.675 +- 0.329 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all L1 = 0.57 +- 0.286 (in-sample avg dev_std = 0.591)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25270533333333334
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.408
NEC for r=0.6 class 0 = 0.681 +- 0.241 (in-sample avg dev_std = 0.711)
NEC for r=0.6 class 1 = 0.568 +- 0.241 (in-sample avg dev_std = 0.711)
NEC for r=0.6 class 2 = 0.542 +- 0.241 (in-sample avg dev_std = 0.711)
NEC for r=0.6 all KL = 0.721 +- 0.241 (in-sample avg dev_std = 0.711)
NEC for r=0.6 all L1 = 0.595 +- 0.218 (in-sample avg dev_std = 0.711)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.294429
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.411
NEC for r=0.9 class 0 = 0.682 +- 0.227 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 1 = 0.566 +- 0.227 (in-sample avg dev_std = 0.728)
NEC for r=0.9 class 2 = 0.544 +- 0.227 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all KL = 0.725 +- 0.227 (in-sample avg dev_std = 0.728)
NEC for r=0.9 all L1 = 0.596 +- 0.208 (in-sample avg dev_std = 0.728)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.908
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.21388133333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.752 +- 0.330 (in-sample avg dev_std = 0.495)
NEC for r=0.3 class 1 = 0.733 +- 0.330 (in-sample avg dev_std = 0.495)
NEC for r=0.3 class 2 = 0.33 +- 0.330 (in-sample avg dev_std = 0.495)
NEC for r=0.3 all KL = 0.69 +- 0.330 (in-sample avg dev_std = 0.495)
NEC for r=0.3 all L1 = 0.605 +- 0.284 (in-sample avg dev_std = 0.495)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.32592933333333335
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.313
NEC for r=0.6 class 0 = 0.762 +- 0.257 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 1 = 0.752 +- 0.257 (in-sample avg dev_std = 0.576)
NEC for r=0.6 class 2 = 0.413 +- 0.257 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all KL = 0.742 +- 0.257 (in-sample avg dev_std = 0.576)
NEC for r=0.6 all L1 = 0.642 +- 0.225 (in-sample avg dev_std = 0.576)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3549536666666666
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.311
NEC for r=0.9 class 0 = 0.766 +- 0.234 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 1 = 0.748 +- 0.234 (in-sample avg dev_std = 0.600)
NEC for r=0.9 class 2 = 0.434 +- 0.234 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all KL = 0.753 +- 0.234 (in-sample avg dev_std = 0.600)
NEC for r=0.9 all L1 = 0.649 +- 0.207 (in-sample avg dev_std = 0.600)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:47:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:47:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9323
Train Loss: 0.2941
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2987
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3038
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2987
OOD Test ACCURACY: 0.9287
OOD Test Loss: 0.3038

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.9287 0.9287 0.9287 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.253
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.295
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.209
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.363


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18590833333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.339
SUFF_SIMPLE for r=0.3 class 0 = 0.237 +- 0.323 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 class 1 = 0.362 +- 0.323 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 class 2 = 0.54 +- 0.323 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 all KL = 0.276 +- 0.323 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.3 all L1 = 0.384 +- 0.284 (in-sample avg dev_std = 0.552)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2525516666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.324
SUFF_SIMPLE for r=0.6 class 0 = 0.281 +- 0.347 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 class 1 = 0.427 +- 0.347 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 class 2 = 0.422 +- 0.347 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 all KL = 0.293 +- 0.347 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.6 all L1 = 0.378 +- 0.297 (in-sample avg dev_std = 0.406)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29476966666666665
len(reference) = 2714
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.571
SUFF_SIMPLE for r=0.9 class 0 = 0.58 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.769 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.595 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.61 +- 0.456 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.649 +- 0.401 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20861033333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
SUFF_SIMPLE for r=0.3 class 0 = 0.231 +- 0.369 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.3 class 1 = 0.199 +- 0.369 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.3 class 2 = 0.776 +- 0.369 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.3 all KL = 0.328 +- 0.369 (in-sample avg dev_std = 0.351)
SUFF_SIMPLE for r=0.3 all L1 = 0.403 +- 0.321 (in-sample avg dev_std = 0.351)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321777
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.302
SUFF_SIMPLE for r=0.6 class 0 = 0.258 +- 0.399 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 class 1 = 0.217 +- 0.399 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 class 2 = 0.752 +- 0.399 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 all KL = 0.349 +- 0.399 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.6 all L1 = 0.409 +- 0.341 (in-sample avg dev_std = 0.209)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.828
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634806666666667
len(reference) = 2745
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.482
SUFF_SIMPLE for r=0.9 class 0 = 0.649 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.674 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.508 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.602 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.608 +- 0.365 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18590833333333334
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.4
NEC for r=0.3 class 0 = 0.656 +- 0.317 (in-sample avg dev_std = 0.584)
NEC for r=0.3 class 1 = 0.532 +- 0.317 (in-sample avg dev_std = 0.584)
NEC for r=0.3 class 2 = 0.56 +- 0.317 (in-sample avg dev_std = 0.584)
NEC for r=0.3 all KL = 0.684 +- 0.317 (in-sample avg dev_std = 0.584)
NEC for r=0.3 all L1 = 0.581 +- 0.275 (in-sample avg dev_std = 0.584)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.2525516666666667
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.405
NEC for r=0.6 class 0 = 0.69 +- 0.229 (in-sample avg dev_std = 0.714)
NEC for r=0.6 class 1 = 0.549 +- 0.229 (in-sample avg dev_std = 0.714)
NEC for r=0.6 class 2 = 0.579 +- 0.229 (in-sample avg dev_std = 0.714)
NEC for r=0.6 all KL = 0.731 +- 0.229 (in-sample avg dev_std = 0.714)
NEC for r=0.6 all L1 = 0.604 +- 0.208 (in-sample avg dev_std = 0.714)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.29476966666666665
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.412
NEC for r=0.9 class 0 = 0.693 +- 0.217 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 1 = 0.551 +- 0.217 (in-sample avg dev_std = 0.731)
NEC for r=0.9 class 2 = 0.573 +- 0.217 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all KL = 0.734 +- 0.217 (in-sample avg dev_std = 0.731)
NEC for r=0.9 all L1 = 0.604 +- 0.199 (in-sample avg dev_std = 0.731)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.834
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20861033333333334
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.4
NEC for r=0.3 class 0 = 0.605 +- 0.349 (in-sample avg dev_std = 0.536)
NEC for r=0.3 class 1 = 0.418 +- 0.349 (in-sample avg dev_std = 0.536)
NEC for r=0.3 class 2 = 0.543 +- 0.349 (in-sample avg dev_std = 0.536)
NEC for r=0.3 all KL = 0.581 +- 0.349 (in-sample avg dev_std = 0.536)
NEC for r=0.3 all L1 = 0.522 +- 0.283 (in-sample avg dev_std = 0.536)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.834
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.321777
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.374
NEC for r=0.6 class 0 = 0.615 +- 0.299 (in-sample avg dev_std = 0.625)
NEC for r=0.6 class 1 = 0.446 +- 0.299 (in-sample avg dev_std = 0.625)
NEC for r=0.6 class 2 = 0.629 +- 0.299 (in-sample avg dev_std = 0.625)
NEC for r=0.6 all KL = 0.64 +- 0.299 (in-sample avg dev_std = 0.625)
NEC for r=0.6 all L1 = 0.564 +- 0.235 (in-sample avg dev_std = 0.625)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.3634806666666667
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.374
NEC for r=0.9 class 0 = 0.614 +- 0.297 (in-sample avg dev_std = 0.638)
NEC for r=0.9 class 1 = 0.436 +- 0.297 (in-sample avg dev_std = 0.638)
NEC for r=0.9 class 2 = 0.646 +- 0.297 (in-sample avg dev_std = 0.638)
NEC for r=0.9 all KL = 0.644 +- 0.297 (in-sample avg dev_std = 0.638)
NEC for r=0.9 all L1 = 0.566 +- 0.232 (in-sample avg dev_std = 0.638)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:49:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:49:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/GOODMotif_basis_covariate/repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9325
Train Loss: 0.2935
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.2976
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3043
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.2976
OOD Test ACCURACY: 0.9290
OOD Test Loss: 0.3043

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.9290 0.9290 0.9290 0.9317 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.255
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.297
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.321
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18385966666666664
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
SUFF_SIMPLE for r=0.3 class 0 = 0.238 +- 0.320 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 class 1 = 0.367 +- 0.320 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 class 2 = 0.535 +- 0.320 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 all KL = 0.275 +- 0.320 (in-sample avg dev_std = 0.555)
SUFF_SIMPLE for r=0.3 all L1 = 0.384 +- 0.281 (in-sample avg dev_std = 0.555)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25472600000000006
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.333
SUFF_SIMPLE for r=0.6 class 0 = 0.281 +- 0.362 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.6 class 1 = 0.526 +- 0.362 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.6 class 2 = 0.375 +- 0.362 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.6 all KL = 0.307 +- 0.362 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.6 all L1 = 0.395 +- 0.313 (in-sample avg dev_std = 0.410)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.931
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2970373333333334
len(reference) = 2702
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.587
SUFF_SIMPLE for r=0.9 class 0 = 0.615 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.738 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.636 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.628 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.663 +- 0.397 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20652433333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.33
SUFF_SIMPLE for r=0.3 class 0 = 0.845 +- 0.267 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.3 class 1 = 0.854 +- 0.267 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.3 class 2 = 0.957 +- 0.267 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.3 all KL = 0.877 +- 0.267 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.3 all L1 = 0.885 +- 0.251 (in-sample avg dev_std = 0.206)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3213313333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.329
SUFF_SIMPLE for r=0.6 class 0 = 0.848 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 1 = 0.865 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 class 2 = 0.932 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all KL = 0.879 +- 0.294 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.6 all L1 = 0.882 +- 0.277 (in-sample avg dev_std = 0.000)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.424
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35940666666666665
len(reference) = 2678
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.366
SUFF_SIMPLE for r=0.9 class 0 = 0.914 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 1 = 0.924 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 class 2 = 0.963 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all KL = 0.937 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.9 all L1 = 0.933 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.932
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.18385966666666664
len(reference) = 3000
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.411
NEC for r=0.3 class 0 = 0.654 +- 0.331 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 1 = 0.467 +- 0.331 (in-sample avg dev_std = 0.581)
NEC for r=0.3 class 2 = 0.587 +- 0.331 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all KL = 0.669 +- 0.331 (in-sample avg dev_std = 0.581)
NEC for r=0.3 all L1 = 0.568 +- 0.286 (in-sample avg dev_std = 0.581)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.932
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.25472600000000006
len(reference) = 3000
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.422
NEC for r=0.6 class 0 = 0.678 +- 0.205 (in-sample avg dev_std = 0.751)
NEC for r=0.6 class 1 = 0.531 +- 0.205 (in-sample avg dev_std = 0.751)
NEC for r=0.6 class 2 = 0.611 +- 0.205 (in-sample avg dev_std = 0.751)
NEC for r=0.6 all KL = 0.738 +- 0.205 (in-sample avg dev_std = 0.751)
NEC for r=0.6 all L1 = 0.606 +- 0.187 (in-sample avg dev_std = 0.751)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.932
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.2970373333333334
len(reference) = 3000
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.415
NEC for r=0.9 class 0 = 0.675 +- 0.187 (in-sample avg dev_std = 0.768)
NEC for r=0.9 class 1 = 0.541 +- 0.187 (in-sample avg dev_std = 0.768)
NEC for r=0.9 class 2 = 0.626 +- 0.187 (in-sample avg dev_std = 0.768)
NEC for r=0.9 all KL = 0.749 +- 0.187 (in-sample avg dev_std = 0.768)
NEC for r=0.9 all L1 = 0.613 +- 0.173 (in-sample avg dev_std = 0.768)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.3



Model Accuracy of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  0.0
Model XAI WIoU of binarized graphs for r=0.3 =  0.20652433333333337
len(reference) = 3000
Effective ratio: 0.314 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.361
NEC for r=0.3 class 0 = 0.164 +- 0.292 (in-sample avg dev_std = 0.267)
NEC for r=0.3 class 1 = 0.167 +- 0.292 (in-sample avg dev_std = 0.267)
NEC for r=0.3 class 2 = 0.078 +- 0.292 (in-sample avg dev_std = 0.267)
NEC for r=0.3 all KL = 0.147 +- 0.292 (in-sample avg dev_std = 0.267)
NEC for r=0.3 all L1 = 0.136 +- 0.266 (in-sample avg dev_std = 0.267)


ratio=0.6



Model Accuracy of binarized graphs for r=0.6 =  0.437
Model XAI F1 of binarized graphs for r=0.6 =  0.0
Model XAI WIoU of binarized graphs for r=0.6 =  0.3213313333333333
len(reference) = 3000
Effective ratio: 0.614 +- 0.009
Model Accuracy over intervened graphs for r=0.6 =  0.355
NEC for r=0.6 class 0 = 0.173 +- 0.290 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 1 = 0.168 +- 0.290 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 2 = 0.087 +- 0.290 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.16 +- 0.290 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.143 +- 0.258 (in-sample avg dev_std = 0.330)


ratio=0.9



Model Accuracy of binarized graphs for r=0.9 =  0.437
Model XAI F1 of binarized graphs for r=0.9 =  0.0
Model XAI WIoU of binarized graphs for r=0.9 =  0.35940666666666665
len(reference) = 3000
Effective ratio: 0.913 +- 0.009
Model Accuracy over intervened graphs for r=0.9 =  0.354
NEC for r=0.9 class 0 = 0.17 +- 0.289 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 1 = 0.173 +- 0.289 (in-sample avg dev_std = 0.345)
NEC for r=0.9 class 2 = 0.093 +- 0.289 (in-sample avg dev_std = 0.345)
NEC for r=0.9 all KL = 0.164 +- 0.289 (in-sample avg dev_std = 0.345)
NEC for r=0.9 all L1 = 0.146 +- 0.256 (in-sample avg dev_std = 0.345)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.277, 0.319, 0.621], 'all_L1': [0.388, 0.407, 0.659]}), defaultdict(<class 'list'>, {'all_KL': [0.281, 0.302, 0.602], 'all_L1': [0.384, 0.383, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.258, 0.296, 0.623], 'all_L1': [0.375, 0.388, 0.661]}), defaultdict(<class 'list'>, {'all_KL': [0.268, 0.289, 0.614], 'all_L1': [0.383, 0.387, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.304, 0.599], 'all_L1': [0.388, 0.398, 0.639]}), defaultdict(<class 'list'>, {'all_KL': [0.272, 0.324, 0.611], 'all_L1': [0.368, 0.41, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.267, 0.319, 0.602], 'all_L1': [0.364, 0.403, 0.64]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.309, 0.622], 'all_L1': [0.385, 0.396, 0.659]}), defaultdict(<class 'list'>, {'all_KL': [0.276, 0.293, 0.61], 'all_L1': [0.384, 0.378, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.307, 0.628], 'all_L1': [0.384, 0.395, 0.663]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.666, 0.706, 0.712], 'all_L1': [0.561, 0.579, 0.583]}), defaultdict(<class 'list'>, {'all_KL': [0.689, 0.737, 0.746], 'all_L1': [0.592, 0.616, 0.622]}), defaultdict(<class 'list'>, {'all_KL': [0.674, 0.746, 0.756], 'all_L1': [0.569, 0.607, 0.613]}), defaultdict(<class 'list'>, {'all_KL': [0.682, 0.742, 0.753], 'all_L1': [0.571, 0.603, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.738, 0.738], 'all_L1': [0.565, 0.605, 0.603]}), defaultdict(<class 'list'>, {'all_KL': [0.653, 0.727, 0.737], 'all_L1': [0.553, 0.599, 0.605]}), defaultdict(<class 'list'>, {'all_KL': [0.655, 0.729, 0.738], 'all_L1': [0.557, 0.6, 0.607]}), defaultdict(<class 'list'>, {'all_KL': [0.675, 0.721, 0.725], 'all_L1': [0.57, 0.595, 0.596]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.731, 0.734], 'all_L1': [0.581, 0.604, 0.604]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.738, 0.749], 'all_L1': [0.568, 0.606, 0.613]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.476, 0.484, 0.565], 'all_L1': [0.506, 0.506, 0.557]}), defaultdict(<class 'list'>, {'all_KL': [0.323, 0.444, 0.587], 'all_L1': [0.419, 0.487, 0.606]}), defaultdict(<class 'list'>, {'all_KL': [0.373, 0.437, 0.622], 'all_L1': [0.464, 0.494, 0.655]}), defaultdict(<class 'list'>, {'all_KL': [0.433, 0.511, 0.634], 'all_L1': [0.533, 0.575, 0.671]}), defaultdict(<class 'list'>, {'all_KL': [0.525, 0.606, 0.743], 'all_L1': [0.605, 0.65, 0.762]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.401, 0.54], 'all_L1': [0.384, 0.449, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.465, 0.708], 'all_L1': [0.448, 0.524, 0.735]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.378, 0.348], 'all_L1': [0.446, 0.444, 0.398]}), defaultdict(<class 'list'>, {'all_KL': [0.328, 0.349, 0.602], 'all_L1': [0.403, 0.409, 0.608]}), defaultdict(<class 'list'>, {'all_KL': [0.877, 0.879, 0.937], 'all_L1': [0.885, 0.882, 0.933]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.51, 0.552, 0.556], 'all_L1': [0.481, 0.512, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.617, 0.696, 0.714], 'all_L1': [0.527, 0.582, 0.594]}), defaultdict(<class 'list'>, {'all_KL': [0.556, 0.618, 0.643], 'all_L1': [0.468, 0.506, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.547, 0.609, 0.621], 'all_L1': [0.447, 0.486, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.465, 0.517, 0.534], 'all_L1': [0.387, 0.418, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.529, 0.606, 0.599], 'all_L1': [0.46, 0.516, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.573, 0.581], 'all_L1': [0.426, 0.465, 0.467]}), defaultdict(<class 'list'>, {'all_KL': [0.69, 0.742, 0.753], 'all_L1': [0.605, 0.642, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.64, 0.644], 'all_L1': [0.522, 0.564, 0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.147, 0.16, 0.164], 'all_L1': [0.136, 0.143, 0.146]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.380 +- 0.008, 0.395 +- 0.010, 0.651 +- 0.009
suff_simple class all_KL  =  0.272 +- 0.006, 0.306 +- 0.011, 0.613 +- 0.010
[[0.3464583456516266, 0.34683331847190857, 0.5809067487716675], [0.33145833015441895, 0.31829166412353516, 0.557074248790741], [0.3401249945163727, 0.33383333683013916, 0.5823159217834473], [0.3387916684150696, 0.3102083206176758, 0.5726937055587769], [0.3345833420753479, 0.31933334469795227, 0.5537435412406921], [0.3357083201408386, 0.33808332681655884, 0.5723781585693359], [0.3347499966621399, 0.328083336353302, 0.5574861168861389], [0.3450833261013031, 0.33791667222976685, 0.5711127519607544], [0.3388749957084656, 0.32358333468437195, 0.5711127519607544], [0.34058332443237305, 0.3332083225250244, 0.5869725942611694]]
[[0.277, 0.319, 0.621], [0.281, 0.302, 0.602], [0.258, 0.296, 0.623], [0.268, 0.289, 0.614], [0.275, 0.304, 0.599], [0.272, 0.324, 0.611], [0.267, 0.319, 0.602], [0.275, 0.309, 0.622], [0.276, 0.293, 0.61], [0.275, 0.307, 0.628]]
suff_simple_acc_int  =  0.339 +- 0.004, 0.329 +- 0.011, 0.571 +- 0.011
nec class all_L1  =  0.569 +- 0.011, 0.601 +- 0.009, 0.606 +- 0.010
nec class all_KL  =  0.672 +- 0.011, 0.731 +- 0.011, 0.739 +- 0.013
[[0.41075000166893005, 0.41879168152809143, 0.4194999933242798], [0.390625, 0.3865416646003723, 0.38745832443237305], [0.4103333353996277, 0.4127500057220459, 0.41366666555404663], [0.39395833015441895, 0.4022083282470703, 0.39658331871032715], [0.39770832657814026, 0.39495834708213806, 0.40066665410995483], [0.4124999940395355, 0.4085833430290222, 0.4074999988079071], [0.41749998927116394, 0.4065416753292084, 0.40570834279060364], [0.40279167890548706, 0.40837499499320984, 0.4111250042915344], [0.40024998784065247, 0.4047499895095825, 0.4124166667461395], [0.41100001335144043, 0.42229166626930237, 0.41495832800865173]]
[[0.666, 0.706, 0.712], [0.689, 0.737, 0.746], [0.674, 0.746, 0.756], [0.682, 0.742, 0.753], [0.67, 0.738, 0.738], [0.653, 0.727, 0.737], [0.655, 0.729, 0.738], [0.675, 0.721, 0.725], [0.684, 0.731, 0.734], [0.669, 0.738, 0.749]]
nec_acc_int  =  0.405 +- 0.008, 0.407 +- 0.010, 0.407 +- 0.009

Eval split val
suff_simple class all_L1  =  0.509 +- 0.140, 0.542 +- 0.131, 0.650 +- 0.135
suff_simple class all_KL  =  0.436 +- 0.162, 0.495 +- 0.145, 0.629 +- 0.144
[[0.3306249976158142, 0.3200833201408386, 0.4276043772697449], [0.30024999380111694, 0.2929583191871643, 0.342170387506485], [0.31691667437553406, 0.3022499978542328, 0.458486407995224], [0.30133333802223206, 0.29341667890548706, 0.36737000942230225], [0.31466665863990784, 0.3097916543483734, 0.4449259638786316], [0.30916666984558105, 0.3267500102519989, 0.3579418361186981], [0.3292083442211151, 0.320416659116745, 0.3724035620689392], [0.3324166536331177, 0.3317916691303253, 0.2866791784763336], [0.3085833191871643, 0.3023749887943268, 0.4823315143585205], [0.3297500014305115, 0.32866665720939636, 0.36631813645362854]]
[[0.476, 0.484, 0.565], [0.323, 0.444, 0.587], [0.373, 0.437, 0.622], [0.433, 0.511, 0.634], [0.525, 0.606, 0.743], [0.303, 0.401, 0.54], [0.341, 0.465, 0.708], [0.379, 0.378, 0.348], [0.328, 0.349, 0.602], [0.877, 0.879, 0.937]]
suff_simple_acc_int  =  0.317 +- 0.012, 0.313 +- 0.014, 0.391 +- 0.057
nec class all_L1  =  0.446 +- 0.118, 0.483 +- 0.128, 0.488 +- 0.129
nec class all_KL  =  0.515 +- 0.136, 0.571 +- 0.151, 0.581 +- 0.153
[[0.3802916705608368, 0.3642083406448364, 0.36395832896232605], [0.36758333444595337, 0.33916667103767395, 0.34704166650772095], [0.4284166693687439, 0.41854166984558105, 0.41354167461395264], [0.37558332085609436, 0.3618749976158142, 0.3687083423137665], [0.36937499046325684, 0.37275001406669617, 0.36758333444595337], [0.4567083418369293, 0.4311249852180481, 0.44183334708213806], [0.41733333468437195, 0.3995000123977661, 0.40674999356269836], [0.3335416615009308, 0.31333333253860474, 0.3111666738986969], [0.4000000059604645, 0.3739166557788849, 0.3739166557788849], [0.36137500405311584, 0.35499998927116394, 0.3544583320617676]]
[[0.51, 0.552, 0.556], [0.617, 0.696, 0.714], [0.556, 0.618, 0.643], [0.547, 0.609, 0.621], [0.465, 0.517, 0.534], [0.529, 0.606, 0.599], [0.513, 0.573, 0.581], [0.69, 0.742, 0.753], [0.581, 0.64, 0.644], [0.147, 0.16, 0.164]]
nec_acc_int  =  0.389 +- 0.035, 0.373 +- 0.034, 0.375 +- 0.035


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.475 +- 0.008, 0.498 +- 0.004, 0.628 +- 0.006
Faith. Armon (L1)= 		  =  0.456 +- 0.008, 0.476 +- 0.006, 0.628 +- 0.006
Faith. GMean (L1)= 	  =  0.465 +- 0.008, 0.487 +- 0.005, 0.628 +- 0.006
Faith. Aritm (KL)= 		  =  0.472 +- 0.007, 0.519 +- 0.005, 0.676 +- 0.008
Faith. Armon (KL)= 		  =  0.388 +- 0.007, 0.431 +- 0.010, 0.670 +- 0.008
Faith. GMean (KL)= 	  =  0.428 +- 0.007, 0.473 +- 0.007, 0.673 +- 0.008

Eval split val
Faith. Aritm (L1)= 		  =  0.478 +- 0.030, 0.513 +- 0.021, 0.569 +- 0.029
Faith. Armon (L1)= 		  =  0.444 +- 0.074, 0.479 +- 0.080, 0.527 +- 0.096
Faith. GMean (L1)= 	  =  0.458 +- 0.046, 0.494 +- 0.050, 0.546 +- 0.065
Faith. Aritm (KL)= 		  =  0.476 +- 0.035, 0.533 +- 0.026, 0.605 +- 0.039
Faith. Armon (KL)= 		  =  0.429 +- 0.070, 0.490 +- 0.079, 0.567 +- 0.108
Faith. GMean (KL)= 	  =  0.450 +- 0.046, 0.510 +- 0.052, 0.583 +- 0.076
Computed for split load_split = id



Completed in  0:21:37.826161  for repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperatureavgedgeattnmean/0.001lr_0.0wd/GSAT_1_True_20_0.7 GOODMotif/basis



DONE GL-GSAT temp GOODMotif/basis/covariate NEC_ALPHA 0.1 RANDOM
DONE all :)
