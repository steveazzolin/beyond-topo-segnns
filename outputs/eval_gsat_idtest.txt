Time to evaluate models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:46:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3178
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3259
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3250
OOD Validation ACCURACY: 0.8527
OOD Validation Loss: 0.5111
OOD Test ACCURACY: 0.6287
OOD Test Loss: 1.1683

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9295
Train Loss: 0.3278
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3391
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3296
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3661
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.3356

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.6287 0.9287 0.5353 0.9277 0.9320[0mTrain ACCURACY: 0.9314Train Loss: 0.3178
Id_val ACCURACY: 0.9303Id_val Loss: 0.3259
Id_test ACCURACY: 0.9280Id_test Loss: 0.3250
Val ACCURACY: 0.8527Val Loss: 0.5110
Test ACCURACY: 0.6287Test Loss: 1.1682


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:46:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mTrain ACCURACY: 0.9309Train Loss: 0.3119
Id_val ACCURACY: 0.9300Id_val Loss: 0.3271
Id_test ACCURACY: 0.9277Id_test Loss: 0.3181
Val ACCURACY: 0.7947Val Loss: 0.6209
Test ACCURACY: 0.5837Test Loss: 1.2347


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:46:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mTrain ACCURACY: 0.9315Train Loss: 0.3074
Id_val ACCURACY: 0.9300Id_val Loss: 0.3203
Id_test ACCURACY: 0.9287Id_test Loss: 0.3132
Val ACCURACY: 0.6043Val Loss: 1.1704
Test ACCURACY: 0.5797Test Loss: 1.3878


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:46:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mTrain ACCURACY: 0.9312Train Loss: 0.3182
Id_val ACCURACY: 0.9303Id_val Loss: 0.3316
Id_test ACCURACY: 0.9280Id_test Loss: 0.3271
Val ACCURACY: 0.9293Val Loss: 0.4589
Test ACCURACY: 0.5283Test Loss: 1.4435


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:46:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:46:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mTrain ACCURACY: 0.9313Train Loss: 0.3152
Id_val ACCURACY: 0.9303Id_val Loss: 0.3261
Id_test ACCURACY: 0.9280Id_test Loss: 0.3206
Val ACCURACY: 0.5570Val Loss: 1.0962
Test ACCURACY: 0.5530Test Loss: 1.3591


Final accuracies: 
TRAIN      = 0.931 +- 0.000
ID_VAL     = 0.930 +- 0.000
ID_TEST    = 0.928 +- 0.000
VAL        = 0.748 +- 0.144
TEST       = 0.575 +- 0.034

Final losses: 
TRAIN      = 0.3141 +- 0.0040
ID_VAL     = 0.3262 +- 0.0036
ID_TEST    = 0.3208 +- 0.0050
VAL        = 0.7715 +- 0.3009
TEST       = 1.3186 +- 0.1017
Diff id_val-test  = 0.9924 
DONE EVAL GSAT GOODMotif/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:47:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3252
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3127
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3421
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4181
OOD Test ACCURACY: 0.7947
OOD Test Loss: 0.8208

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 47...
[0m[1;37mINFO[0m: [1mCheckpoint 47: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.3388
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3254
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3540
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3738
OOD Test ACCURACY: 0.6353
OOD Test Loss: 1.7363

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7947 0.9243 0.6353 0.9317 0.9300[0mTrain ACCURACY: 0.9297Train Loss: 0.3252
Id_val ACCURACY: 0.9357Id_val Loss: 0.3127
Id_test ACCURACY: 0.9257Id_test Loss: 0.3420
Val ACCURACY: 0.9270Val Loss: 0.4181
Test ACCURACY: 0.7947Test Loss: 0.8208


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:47:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:47:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3173
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3076
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3411
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 0.4798
OOD Test ACCURACY: 0.6430
OOD Test Loss: 0.9596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.9249
Train Loss: 0.3435
ID Validation ACCURACY: 0.9297
ID Validation Loss: 0.3292
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3609
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.3859
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.8691

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6430 0.9200 0.5833 0.9297 0.9273[0mTrain ACCURACY: 0.9303Train Loss: 0.3173
Id_val ACCURACY: 0.9357Id_val Loss: 0.3076
Id_test ACCURACY: 0.9260Id_test Loss: 0.3411
Val ACCURACY: 0.8477Val Loss: 0.4798
Test ACCURACY: 0.6430Test Loss: 0.9595


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:48:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3303
ID Validation ACCURACY: 0.9350
ID Validation Loss: 0.3133
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3501
OOD Validation ACCURACY: 0.8013
OOD Validation Loss: 0.5544
OOD Test ACCURACY: 0.7917
OOD Test Loss: 0.8351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9260
Train Loss: 0.3556
ID Validation ACCURACY: 0.9317
ID Validation Loss: 0.3333
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3700
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4586
OOD Test ACCURACY: 0.6470
OOD Test Loss: 1.3751

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7917 0.9233 0.6470 0.9317 0.9260[0mTrain ACCURACY: 0.9289Train Loss: 0.3303
Id_val ACCURACY: 0.9350Id_val Loss: 0.3134
Id_test ACCURACY: 0.9257Id_test Loss: 0.3501
Val ACCURACY: 0.8013Val Loss: 0.5546
Test ACCURACY: 0.7917Test Loss: 0.8352


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:48:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9303
Train Loss: 0.3118
ID Validation ACCURACY: 0.9357
ID Validation Loss: 0.3016
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3358
OOD Validation ACCURACY: 0.8073
OOD Validation Loss: 0.5158
OOD Test ACCURACY: 0.7527
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9293
Train Loss: 0.3258
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3155
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3465
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.4445
OOD Test ACCURACY: 0.5280
OOD Test Loss: 1.3857

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7527 0.9257 0.5280 0.9347 0.9260[0mTrain ACCURACY: 0.9303Train Loss: 0.3118
Id_val ACCURACY: 0.9357Id_val Loss: 0.3016
Id_test ACCURACY: 0.9260Id_test Loss: 0.3358
Val ACCURACY: 0.8073Val Loss: 0.5158
Test ACCURACY: 0.7527Test Loss: 1.0888


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:48:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:48:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9297
Train Loss: 0.3216
ID Validation ACCURACY: 0.9353
ID Validation Loss: 0.3083
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3413
OOD Validation ACCURACY: 0.9157
OOD Validation Loss: 0.4277
OOD Test ACCURACY: 0.7673
OOD Test Loss: 0.8079

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3200
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3075
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3354
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3766
OOD Test ACCURACY: 0.7923
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.7673 0.9250 0.7923 0.9337 0.9280[0mTrain ACCURACY: 0.9297Train Loss: 0.3216
Id_val ACCURACY: 0.9353Id_val Loss: 0.3083
Id_test ACCURACY: 0.9257Id_test Loss: 0.3413
Val ACCURACY: 0.9157Val Loss: 0.4277
Test ACCURACY: 0.7673Test Loss: 0.8079


Final accuracies: 
TRAIN      = 0.930 +- 0.001
ID_VAL     = 0.935 +- 0.000
ID_TEST    = 0.926 +- 0.000
VAL        = 0.860 +- 0.053
TEST       = 0.750 +- 0.056

Final losses: 
TRAIN      = 0.3212 +- 0.0064
ID_VAL     = 0.3087 +- 0.0042
ID_TEST    = 0.3421 +- 0.0046
VAL        = 0.4792 +- 0.0518
TEST       = 0.9024 +- 0.1078
Diff id_val-test  = 0.5937 
DONE EVAL GSAT GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:49:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mTrain ACCURACY: 0.9274Train Loss: 0.3249
Id_val ACCURACY: 0.9343Id_val Loss: 0.3005
Id_test ACCURACY: 0.9283Id_test Loss: 0.3247
Val ACCURACY: 0.9017Val Loss: 0.4865
Test ACCURACY: 0.4907Test Loss: 2.1635


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:49:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mTrain ACCURACY: 0.9269Train Loss: 0.3371
Id_val ACCURACY: 0.9333Id_val Loss: 0.3138
Id_test ACCURACY: 0.9290Id_test Loss: 0.3425
Val ACCURACY: 0.8693Val Loss: 0.5698
Test ACCURACY: 0.5503Test Loss: 1.5811


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:49:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mTrain ACCURACY: 0.9266Train Loss: 0.3328
Id_val ACCURACY: 0.9347Id_val Loss: 0.3080
Id_test ACCURACY: 0.9293Id_test Loss: 0.3378
Val ACCURACY: 0.8910Val Loss: 0.5238
Test ACCURACY: 0.4787Test Loss: 2.2871


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:49:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mTrain ACCURACY: 0.9276Train Loss: 0.3309
Id_val ACCURACY: 0.9337Id_val Loss: 0.3021
Id_test ACCURACY: 0.9290Id_test Loss: 0.3333
Val ACCURACY: 0.9093Val Loss: 0.4749
Test ACCURACY: 0.5280Test Loss: 1.2735


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:49:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:49:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mTrain ACCURACY: 0.9269Train Loss: 0.3330
Id_val ACCURACY: 0.9337Id_val Loss: 0.3044
Id_test ACCURACY: 0.9297Id_test Loss: 0.3362
Val ACCURACY: 0.9000Val Loss: 0.4896
Test ACCURACY: 0.5230Test Loss: 2.0987


Final accuracies: 
TRAIN      = 0.927 +- 0.000
ID_VAL     = 0.934 +- 0.000
ID_TEST    = 0.929 +- 0.000
VAL        = 0.894 +- 0.014
TEST       = 0.514 +- 0.026

Final losses: 
TRAIN      = 0.3317 +- 0.0040
ID_VAL     = 0.3058 +- 0.0047
ID_TEST    = 0.3349 +- 0.0059
VAL        = 0.5089 +- 0.0345
TEST       = 1.8808 +- 0.3876
Diff id_val-test  = 1.5750 
DONE EVAL GSAT GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:50:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:50:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0025
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.5101
ID Test ACCURACY: 0.8987
ID Test Loss: 0.6337
OOD Validation ACCURACY: 0.8501
OOD Validation Loss: 1.2162
OOD Test ACCURACY: 0.7241
OOD Test Loss: 5.9794

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0210
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3950
ID Test ACCURACY: 0.8921
ID Test Loss: 0.4835
OOD Validation ACCURACY: 0.8680
OOD Validation Loss: 0.6745
OOD Test ACCURACY: 0.7971
OOD Test Loss: 1.9556

[0m[1;37mINFO[0m: [1mChartInfo 0.8987 0.7241 0.8921 0.7971 0.9013 0.8680[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9994Train Loss: 0.0025
Id_val ACCURACY: 0.9106Id_val Loss: 0.5101
Id_test ACCURACY: 0.8987Id_test Loss: 0.6337
Val ACCURACY: 0.8501Val Loss: 1.2162
Test ACCURACY: 0.7241Test Loss: 5.9794


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:51:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:11 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.7707
ID Test ACCURACY: 0.9036
ID Test Loss: 0.8911
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.9645
OOD Test ACCURACY: 0.8288
OOD Test Loss: 1.5437

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9087
ID Validation Loss: 0.6769
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7782
OOD Validation ACCURACY: 0.8751
OOD Validation Loss: 0.7905
OOD Test ACCURACY: 0.8313
OOD Test Loss: 1.1097

[0m[1;37mINFO[0m: [1mChartInfo 0.9036 0.8288 0.9010 0.8313 0.9087 0.8751[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0001
Id_val ACCURACY: 0.9113Id_val Loss: 0.7707
Id_test ACCURACY: 0.9036Id_test Loss: 0.8911
Val ACCURACY: 0.8742Val Loss: 0.9645
Test ACCURACY: 0.8288Test Loss: 1.5437


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:51:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:51:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9070
ID Validation Loss: 0.6761
ID Test ACCURACY: 0.9085
ID Test Loss: 0.7858
OOD Validation ACCURACY: 0.8698
OOD Validation Loss: 0.7126
OOD Test ACCURACY: 0.8129
OOD Test Loss: 0.9194

[0m[1;37mINFO[0m: [1mChartInfo 0.9085 0.8129 0.9085 0.8129 0.9070 0.8698[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9070Id_val Loss: 0.6761
Id_test ACCURACY: 0.9085Id_test Loss: 0.7858
Val ACCURACY: 0.8698Val Loss: 0.7126
Test ACCURACY: 0.8129Test Loss: 0.9194


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:52:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0001
ID Validation ACCURACY: 0.9147
ID Validation Loss: 0.6881
ID Test ACCURACY: 0.9072
ID Test Loss: 0.8292
OOD Validation ACCURACY: 0.8620
OOD Validation Loss: 1.4572
OOD Test ACCURACY: 0.8092
OOD Test Loss: 3.9476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9128
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9068
ID Test Loss: 0.8946
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 1.4169
OOD Test ACCURACY: 0.8193
OOD Test Loss: 3.6034

[0m[1;37mINFO[0m: [1mChartInfo 0.9072 0.8092 0.9068 0.8193 0.9128 0.8693[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9999Train Loss: 0.0001
Id_val ACCURACY: 0.9147Id_val Loss: 0.6881
Id_test ACCURACY: 0.9072Id_test Loss: 0.8292
Val ACCURACY: 0.8620Val Loss: 1.4572
Test ACCURACY: 0.8092Test Loss: 3.9476


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:52:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:52:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.7434
ID Test ACCURACY: 0.9083
ID Test Loss: 0.7942
OOD Validation ACCURACY: 0.8622
OOD Validation Loss: 1.0214
OOD Test ACCURACY: 0.7831
OOD Test Loss: 1.9072

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9062
ID Validation Loss: 0.7432
ID Test ACCURACY: 0.9059
ID Test Loss: 0.8164
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 0.9364
OOD Test ACCURACY: 0.8087
OOD Test Loss: 1.4925

[0m[1;37mINFO[0m: [1mChartInfo 0.9083 0.7831 0.9059 0.8087 0.9062 0.8689[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0001
Id_val ACCURACY: 0.9085Id_val Loss: 0.7434
Id_test ACCURACY: 0.9083Id_test Loss: 0.7942
Val ACCURACY: 0.8622Val Loss: 1.0214
Test ACCURACY: 0.7831Test Loss: 1.9072


Final accuracies: 
TRAIN      = 1.000 +- 0.000
ID_VAL     = 0.910 +- 0.003
ID_TEST    = 0.905 +- 0.004
VAL        = 0.864 +- 0.008
TEST       = 0.792 +- 0.037

Final losses: 
TRAIN      = 0.0006 +- 0.0009
ID_VAL     = 0.6777 +- 0.0907
ID_TEST    = 0.7868 +- 0.0851
VAL        = 1.0744 +- 0.2499
TEST       = 2.8594 +- 1.8612
Diff id_val-test  = 2.1818 
DONE EVAL GSAT GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:53:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9965
Train Loss: 0.0177
ID Validation ACCURACY: 0.6931
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.6318
ID Test Loss: 1.8774
OOD Validation ACCURACY: 0.6011
OOD Validation Loss: 2.2998
OOD Test ACCURACY: 0.5319
OOD Test Loss: 3.2275

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.6715
ID Validation Loss: 2.2483
ID Test ACCURACY: 0.6498
ID Test Loss: 2.4645
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 2.6045
OOD Test ACCURACY: 0.5765
OOD Test Loss: 3.1984

[0m[1;37mINFO[0m: [1mChartInfo 0.6318 0.5319 0.6498 0.5765 0.6715 0.6353[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9965Train Loss: 0.0177
Id_val ACCURACY: 0.6931Id_val Loss: 1.6170
Id_test ACCURACY: 0.6318Id_test Loss: 1.8775
Val ACCURACY: 0.6011Val Loss: 2.2998
Test ACCURACY: 0.5326Test Loss: 3.2276


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:53:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0007
ID Validation ACCURACY: 0.7004
ID Validation Loss: 2.0560
ID Test ACCURACY: 0.6715
ID Test Loss: 2.3868
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 2.6110
OOD Test ACCURACY: 0.5518
OOD Test Loss: 3.4085

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5518 0.6715 0.5518 0.7004 0.6331[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0007
Id_val ACCURACY: 0.7004Id_val Loss: 2.0561
Id_test ACCURACY: 0.6715Id_test Loss: 2.3869
Val ACCURACY: 0.6331Val Loss: 2.6111
Test ACCURACY: 0.5518Test Loss: 3.4087


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:53:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0031
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.5079
ID Test ACCURACY: 0.6426
ID Test Loss: 1.8561
OOD Validation ACCURACY: 0.6101
OOD Validation Loss: 2.2219
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.4476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ACCURACY: 0.9981
Train Loss: 0.0050
ID Validation ACCURACY: 0.6733
ID Validation Loss: 1.7091
ID Test ACCURACY: 0.6552
ID Test Loss: 1.9976
OOD Validation ACCURACY: 0.6403
OOD Validation Loss: 2.0926
OOD Test ACCURACY: 0.5690
OOD Test Loss: 2.7705

[0m[1;37mINFO[0m: [1mChartInfo 0.6426 0.5333 0.6552 0.5690 0.6733 0.6403[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0031
Id_val ACCURACY: 0.7058Id_val Loss: 1.5080
Id_test ACCURACY: 0.6426Id_test Loss: 1.8561
Val ACCURACY: 0.6101Val Loss: 2.2219
Test ACCURACY: 0.5333Test Loss: 3.4475


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:53:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0013
ID Validation ACCURACY: 0.7004
ID Validation Loss: 1.8103
ID Test ACCURACY: 0.6444
ID Test Loss: 2.1469
OOD Validation ACCURACY: 0.6280
OOD Validation Loss: 2.2065
OOD Test ACCURACY: 0.5436
OOD Test Loss: 2.9759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.1026
ID Test ACCURACY: 0.6101
ID Test Loss: 2.4334
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6554
OOD Test ACCURACY: 0.5642
OOD Test Loss: 3.4042

[0m[1;37mINFO[0m: [1mChartInfo 0.6444 0.5436 0.6101 0.5642 0.6877 0.6336[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0013
Id_val ACCURACY: 0.7004Id_val Loss: 1.8103
Id_test ACCURACY: 0.6462Id_test Loss: 2.1468
Val ACCURACY: 0.6280Val Loss: 2.2064
Test ACCURACY: 0.5436Test Loss: 2.9759


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:53:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:53:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 5...
[0m[1;37mINFO[0m: [1mCheckpoint 5: 
-----------------------------------
Train ACCURACY: 0.9208
Train Loss: 0.2372
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.8254
ID Test ACCURACY: 0.6480
ID Test Loss: 0.9897
OOD Validation ACCURACY: 0.6174
OOD Validation Loss: 1.2560
OOD Test ACCURACY: 0.5669
OOD Test Loss: 1.6424

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6823
ID Validation Loss: 2.1377
ID Test ACCURACY: 0.6588
ID Test Loss: 2.5118
OOD Validation ACCURACY: 0.6336
OOD Validation Loss: 2.6032
OOD Test ACCURACY: 0.5745
OOD Test Loss: 3.2801

[0m[1;37mINFO[0m: [1mChartInfo 0.6480 0.5669 0.6588 0.5745 0.6823 0.6336[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9212Train Loss: 0.2372
Id_val ACCURACY: 0.6949Id_val Loss: 0.8254
Id_test ACCURACY: 0.6480Id_test Loss: 0.9897
Val ACCURACY: 0.6174Val Loss: 1.2561
Test ACCURACY: 0.5669Test Loss: 1.6425


Final accuracies: 
TRAIN      = 0.984 +- 0.031
ID_VAL     = 0.699 +- 0.004
ID_TEST    = 0.648 +- 0.013
VAL        = 0.618 +- 0.012
TEST       = 0.546 +- 0.013

Final losses: 
TRAIN      = 0.0520 +- 0.0928
ID_VAL     = 1.5634 +- 0.4133
ID_TEST    = 1.8514 +- 0.4727
VAL        = 2.1191 +- 0.4556
TEST       = 2.9404 +- 0.6701
Diff id_val-test  = 1.3771 
DONE EVAL GSAT GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:54:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.0950
ID Validation ROC-AUC: 0.8455
ID Validation Loss: 0.1252
ID Test ROC-AUC: 0.8217
ID Test Loss: 0.1090
OOD Validation ROC-AUC: 0.7404
OOD Validation Loss: 0.1137
OOD Test ROC-AUC: 0.6988
OOD Test Loss: 0.0867

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.8446
Train Loss: 0.1135
ID Validation ROC-AUC: 0.8042
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8042
ID Test Loss: 0.1156
OOD Validation ROC-AUC: 0.7833
OOD Validation Loss: 0.1126
OOD Test ROC-AUC: 0.6912
OOD Test Loss: 0.0970

[0m[1;37mINFO[0m: [1mChartInfo 0.8217 0.6988 0.8042 0.6912 0.8042 0.7833[0mTrain ROC-AUC: 0.9090Train Loss: 0.0950
Id_val ROC-AUC: 0.8455Id_val Loss: 0.1252
Id_test ROC-AUC: 0.8217Id_test Loss: 0.1090
Val ROC-AUC: 0.7404Val Loss: 0.1137
Test ROC-AUC: 0.6988Test Loss: 0.0867


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:54:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:25 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ROC-AUC: 0.9193
Train Loss: 0.0894
ID Validation ROC-AUC: 0.8354
ID Validation Loss: 0.1257
ID Test ROC-AUC: 0.8084
ID Test Loss: 0.1109
OOD Validation ROC-AUC: 0.7601
OOD Validation Loss: 0.1176
OOD Test ROC-AUC: 0.7290
OOD Test Loss: 0.0872

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.8677
Train Loss: 0.1098
ID Validation ROC-AUC: 0.8315
ID Validation Loss: 0.1337
ID Test ROC-AUC: 0.8039
ID Test Loss: 0.1138
OOD Validation ROC-AUC: 0.7858
OOD Validation Loss: 0.1065
OOD Test ROC-AUC: 0.7517
OOD Test Loss: 0.0875

[0m[1;37mINFO[0m: [1mChartInfo 0.8084 0.7290 0.8039 0.7517 0.8315 0.7858[0mTrain ROC-AUC: 0.9193Train Loss: 0.0894
Id_val ROC-AUC: 0.8354Id_val Loss: 0.1257
Id_test ROC-AUC: 0.8084Id_test Loss: 0.1109
Val ROC-AUC: 0.7601Val Loss: 0.1176
Test ROC-AUC: 0.7290Test Loss: 0.0872


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:54:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:54:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ROC-AUC: 0.9408
Train Loss: 0.0845
ID Validation ROC-AUC: 0.8353
ID Validation Loss: 0.1363
ID Test ROC-AUC: 0.8180
ID Test Loss: 0.1216
OOD Validation ROC-AUC: 0.7710
OOD Validation Loss: 0.1283
OOD Test ROC-AUC: 0.7279
OOD Test Loss: 0.0901

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9312
Train Loss: 0.0842
ID Validation ROC-AUC: 0.8199
ID Validation Loss: 0.1342
ID Test ROC-AUC: 0.7980
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7737
OOD Validation Loss: 0.1243
OOD Test ROC-AUC: 0.7203
OOD Test Loss: 0.0949

[0m[1;37mINFO[0m: [1mChartInfo 0.8180 0.7279 0.7980 0.7203 0.8199 0.7737[0mTrain ROC-AUC: 0.9408Train Loss: 0.0846
Id_val ROC-AUC: 0.8353Id_val Loss: 0.1363
Id_test ROC-AUC: 0.8180Id_test Loss: 0.1216
Val ROC-AUC: 0.7710Val Loss: 0.1283
Test ROC-AUC: 0.7280Test Loss: 0.0901


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:55:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9672
Train Loss: 0.0711
ID Validation ROC-AUC: 0.8273
ID Validation Loss: 0.1308
ID Test ROC-AUC: 0.8111
ID Test Loss: 0.1127
OOD Validation ROC-AUC: 0.7208
OOD Validation Loss: 0.1246
OOD Test ROC-AUC: 0.6528
OOD Test Loss: 0.0969

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.8696
Train Loss: 0.1264
ID Validation ROC-AUC: 0.8184
ID Validation Loss: 0.1532
ID Test ROC-AUC: 0.8196
ID Test Loss: 0.1278
OOD Validation ROC-AUC: 0.7775
OOD Validation Loss: 0.1197
OOD Test ROC-AUC: 0.7122
OOD Test Loss: 0.1159

[0m[1;37mINFO[0m: [1mChartInfo 0.8111 0.6528 0.8196 0.7122 0.8184 0.7775[0mTrain ROC-AUC: 0.9672Train Loss: 0.0711
Id_val ROC-AUC: 0.8273Id_val Loss: 0.1308
Id_test ROC-AUC: 0.8111Id_test Loss: 0.1127
Val ROC-AUC: 0.7208Val Loss: 0.1246
Test ROC-AUC: 0.6529Test Loss: 0.0969


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:55:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:55:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 61...
[0m[1;37mINFO[0m: [1mCheckpoint 61: 
-----------------------------------
Train ROC-AUC: 0.9084
Train Loss: 0.0957
ID Validation ROC-AUC: 0.8316
ID Validation Loss: 0.1288
ID Test ROC-AUC: 0.8079
ID Test Loss: 0.1132
OOD Validation ROC-AUC: 0.7393
OOD Validation Loss: 0.1117
OOD Test ROC-AUC: 0.7327
OOD Test Loss: 0.0860

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 130...
[0m[1;37mINFO[0m: [1mCheckpoint 130: 
-----------------------------------
Train ROC-AUC: 0.9676
Train Loss: 0.0823
ID Validation ROC-AUC: 0.8098
ID Validation Loss: 0.1356
ID Test ROC-AUC: 0.8105
ID Test Loss: 0.1148
OOD Validation ROC-AUC: 0.7817
OOD Validation Loss: 0.1135
OOD Test ROC-AUC: 0.7377
OOD Test Loss: 0.0885

[0m[1;37mINFO[0m: [1mChartInfo 0.8079 0.7327 0.8105 0.7377 0.8098 0.7817[0mTrain ROC-AUC: 0.9084Train Loss: 0.0957
Id_val ROC-AUC: 0.8316Id_val Loss: 0.1288
Id_test ROC-AUC: 0.8079Id_test Loss: 0.1132
Val ROC-AUC: 0.7392Val Loss: 0.1117
Test ROC-AUC: 0.7327Test Loss: 0.0860


Final accuracies: 
TRAIN      = 0.929 +- 0.022
ID_VAL     = 0.835 +- 0.006
ID_TEST    = 0.813 +- 0.006
VAL        = 0.746 +- 0.018
TEST       = 0.708 +- 0.030

Final losses: 
TRAIN      = 0.0872 +- 0.0090
ID_VAL     = 0.1294 +- 0.0040
ID_TEST    = 0.1135 +- 0.0043
VAL        = 0.1192 +- 0.0063
TEST       = 0.0894 +- 0.0040
Diff id_val-test  = 0.0400 
DONE EVAL GSAT GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:56:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:56:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mTrain ROC-AUC: 0.9769Train Loss: 0.1241
Id_val ROC-AUC: 0.9251Id_val Loss: 0.2646
Id_test ROC-AUC: 0.9244Id_test Loss: 0.2693
Val ROC-AUC: 0.6274Val Loss: 0.5719
Test ROC-AUC: 0.7014Test Loss: 0.7028


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:57:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mTrain ROC-AUC: 0.9559Train Loss: 0.1818
Id_val ROC-AUC: 0.9207Id_val Loss: 0.2309
Id_test ROC-AUC: 0.9188Id_test Loss: 0.2372
Val ROC-AUC: 0.6575Val Loss: 0.3564
Test ROC-AUC: 0.7045Test Loss: 0.5081


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:57:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:57:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mTrain ROC-AUC: 0.9718Train Loss: 0.1502
Id_val ROC-AUC: 0.9222Id_val Loss: 0.2869
Id_test ROC-AUC: 0.9201Id_test Loss: 0.2932
Val ROC-AUC: 0.6430Val Loss: 0.5048
Test ROC-AUC: 0.7021Test Loss: 0.7113


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:58:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:58:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mTrain ROC-AUC: 0.9605Train Loss: 0.1572
Id_val ROC-AUC: 0.9210Id_val Loss: 0.2207
Id_test ROC-AUC: 0.9206Id_test Loss: 0.2229
Val ROC-AUC: 0.6437Val Loss: 0.4343
Test ROC-AUC: 0.7008Test Loss: 0.5543


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 10:59:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 10:59:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mTrain ROC-AUC: 0.9755Train Loss: 0.1331
Id_val ROC-AUC: 0.9228Id_val Loss: 0.2627
Id_test ROC-AUC: 0.9230Id_test Loss: 0.2675
Val ROC-AUC: 0.6330Val Loss: 0.4920
Test ROC-AUC: 0.6956Test Loss: 0.6669


Final accuracies: 
TRAIN      = 0.968 +- 0.008
ID_VAL     = 0.922 +- 0.002
ID_TEST    = 0.921 +- 0.002
VAL        = 0.641 +- 0.010
TEST       = 0.701 +- 0.003

Final losses: 
TRAIN      = 0.1493 +- 0.0201
ID_VAL     = 0.2532 +- 0.0241
ID_TEST    = 0.2580 +- 0.0250
VAL        = 0.4719 +- 0.0725
TEST       = 0.6287 +- 0.0823
Diff id_val-test  = 0.3755 
DONE EVAL GSAT LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Apr 23 11:00:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/23/2024 11:00:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9577
Train Loss: 0.1191
ID Validation ACCURACY: 0.8961
ID Validation Loss: 0.3648
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3804
OOD Validation ACCURACY: 0.7797
OOD Validation Loss: 0.8828
OOD Test ACCURACY: 0.2677
OOD Test Loss: 6.4566

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9471
Train Loss: 0.1505
ID Validation ACCURACY: 0.8906
ID Validation Loss: 0.3662
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3755
OOD Validation ACCURACY: 0.8057
OOD Validation Loss: 0.7317
OOD Test ACCURACY: 0.3631
OOD Test Loss: 4.0084

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.2677 0.8890 0.3631 0.8906 0.8057[0mTrain ACCURACY: 0.9281Train Loss: 0.2257
[1;31mERROR[0m: 04/23/2024 11:01:40 AM - utils.py - line 52 : [1mCUDA out of memory. Tried to allocate 3.20 GiB. GPU 1 has a total capacty of 11.77 GiB of which 1.82 GiB is free. Process 3054839 has 2.35 GiB memory in use. Including non-PyTorch memory, this process has 7.60 GiB memory in use. Of the allocated memory 6.48 GiB is allocated by PyTorch, and 224.78 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 612, in goodtg
    print(f'#E#{e}')
Time to evaluate models!
Time to evaluate models!
DONE EVAL GSAT GOODMotif/basis
DONE EVAL GSAT GOODMotif2/basis
