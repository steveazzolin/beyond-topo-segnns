nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 1493432

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Aug  3 23:49:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.989



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.173106
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:2')  +-  tensor(0.2531, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6345, device='cuda:2')  +-  tensor(0.2822, device='cuda:2') (0.09443812817335129)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.765523
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:2')  +-  tensor(0.2531, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6234, device='cuda:2')  +-  tensor(0.3000, device='cuda:2') (0.06023788824677467)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.913754
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:2')  +-  tensor(0.2531, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6410, device='cuda:2')  +-  tensor(0.2913, device='cuda:2') (0.016885975375771523)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.634968
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:2')  +-  tensor(0.0502, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3343, device='cuda:2')  +-  tensor(0.0649, device='cuda:2') (0.09056396037340164)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.098281
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:2')  +-  tensor(0.0502, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3893, device='cuda:2')  +-  tensor(0.0778, device='cuda:2') (0.10896681249141693)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.370672
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:2')  +-  tensor(0.0502, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.5290, device='cuda:2')  +-  tensor(0.1813, device='cuda:2') (0.039560217410326004)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Aug  3 23:57:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:57:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.767
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.995



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.404708
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:2')  +-  tensor(0.2417, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6565, device='cuda:2')  +-  tensor(0.3058, device='cuda:2') (0.07523650676012039)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.206802
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:2')  +-  tensor(0.2417, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6383, device='cuda:2')  +-  tensor(0.3015, device='cuda:2') (0.07232815772294998)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.418650
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:2')  +-  tensor(0.2417, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6696, device='cuda:2')  +-  tensor(0.2951, device='cuda:2') (0.01221738662570715)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.702915
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:2')  +-  tensor(0.0432, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3486, device='cuda:2')  +-  tensor(0.0770, device='cuda:2') (0.10945035517215729)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.167507
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:2')  +-  tensor(0.0432, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3838, device='cuda:2')  +-  tensor(0.0936, device='cuda:2') (0.11448954045772552)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.291206
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:2')  +-  tensor(0.0432, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.5864, device='cuda:2')  +-  tensor(0.2332, device='cuda:2') (0.051639657467603683)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:12:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.697
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.994



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.291287
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:2')  +-  tensor(0.2256, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6041, device='cuda:2')  +-  tensor(0.2819, device='cuda:2') (0.08431913703680038)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.249787
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:2')  +-  tensor(0.2256, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5863, device='cuda:2')  +-  tensor(0.2868, device='cuda:2') (0.07931330054998398)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.227256
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:2')  +-  tensor(0.2256, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.5520, device='cuda:2')  +-  tensor(0.2620, device='cuda:2') (0.005642160307615995)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.072915
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:2')  +-  tensor(0.0460, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3127, device='cuda:2')  +-  tensor(0.0630, device='cuda:2') (0.08552827686071396)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.856257
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:2')  +-  tensor(0.0460, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3210, device='cuda:2')  +-  tensor(0.0699, device='cuda:2') (0.08262278884649277)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.916217
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:2')  +-  tensor(0.0460, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3965, device='cuda:2')  +-  tensor(0.1462, device='cuda:2') (0.010987500660121441)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:16:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.905
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.996



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.303630
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:2')  +-  tensor(0.1937, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6616, device='cuda:2')  +-  tensor(0.2611, device='cuda:2') (0.14142440259456635)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.209970
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:2')  +-  tensor(0.1937, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6916, device='cuda:2')  +-  tensor(0.2863, device='cuda:2') (0.09828171879053116)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.304767
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:2')  +-  tensor(0.1937, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.7685, device='cuda:2')  +-  tensor(0.3195, device='cuda:2') (0.0155668705701828)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.808129
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:2')  +-  tensor(0.0489, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4030, device='cuda:2')  +-  tensor(0.1466, device='cuda:2') (0.14883141219615936)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.941754
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:2')  +-  tensor(0.0489, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3771, device='cuda:2')  +-  tensor(0.1513, device='cuda:2') (0.12323518842458725)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.838949
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:2')  +-  tensor(0.0489, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3773, device='cuda:2')  +-  tensor(0.1871, device='cuda:2') (0.01914229989051819)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:21:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.715
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.927



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.277216
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:2')  +-  tensor(0.2482, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6440, device='cuda:2')  +-  tensor(0.2671, device='cuda:2') (0.11139729619026184)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.243602
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:2')  +-  tensor(0.2482, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6359, device='cuda:2')  +-  tensor(0.2794, device='cuda:2') (0.09367123991250992)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.428915
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:2')  +-  tensor(0.2482, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6682, device='cuda:2')  +-  tensor(0.3264, device='cuda:2') (0.008067306131124496)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.699305
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:2')  +-  tensor(0.1148, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3465, device='cuda:2')  +-  tensor(0.1030, device='cuda:2') (0.09589681029319763)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.930098
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:2')  +-  tensor(0.1148, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3197, device='cuda:2')  +-  tensor(0.1065, device='cuda:2') (0.08010675758123398)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.898321
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:2')  +-  tensor(0.1148, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3371, device='cuda:2')  +-  tensor(0.1409, device='cuda:2') (0.011434079147875309)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val Accuracy SUFF_SIMPLE: 	[] +- []
(id) id_val Accuracy WIOU_ORIGINAL: 	[0.76367326 0.76367326 0.7636732 ] +- [0.07432533 0.07432533 0.07432535]
(id) id_val Accuracy WIOU_PERTURBED: 	[0.64012294 0.63511404 0.6598363 ] +- [0.02037895 0.03380954 0.06921946]
(id) val Accuracy SUFF_SIMPLE: 	[] +- []
(id) val Accuracy WIOU_ORIGINAL: 	[0.98065083 0.98065076 0.98065076] +- [0.02661738 0.02661752 0.02661752]
(id) val Accuracy WIOU_PERTURBED: 	[0.34902959 0.35818239 0.44526446] +- [0.02982941 0.03113371 0.09552055]
DONE LECI GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:25:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.603
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.356



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.644164
Original XAI WIoU for r=0.8 =  tensor(0.6003, device='cuda:2')  +-  tensor(0.2865, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.4751, device='cuda:2')  +-  tensor(0.2560, device='cuda:2') (0.027864089235663414)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.937539
Original XAI WIoU for r=0.8 =  tensor(0.3555, device='cuda:2')  +-  tensor(0.1920, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.2275, device='cuda:2')  +-  tensor(0.1023, device='cuda:2') (0.030100170522928238)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:27:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.512
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.337



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.715575
Original XAI WIoU for r=0.8 =  tensor(0.5115, device='cuda:2')  +-  tensor(0.2630, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5234, device='cuda:2')  +-  tensor(0.2949, device='cuda:2') (0.021877471357584)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:04.034250
Original XAI WIoU for r=0.8 =  tensor(0.3371, device='cuda:2')  +-  tensor(0.0888, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3343, device='cuda:2')  +-  tensor(0.0959, device='cuda:2') (0.061307020485401154)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:28:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.727
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.906



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.886322
Original XAI WIoU for r=0.8 =  tensor(0.7270, device='cuda:2')  +-  tensor(0.2704, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.6327, device='cuda:2')  +-  tensor(0.3007, device='cuda:2') (0.045917246490716934)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:04.227384
Original XAI WIoU for r=0.8 =  tensor(0.9059, device='cuda:2')  +-  tensor(0.1089, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5184, device='cuda:2')  +-  tensor(0.2241, device='cuda:2') (0.13959196209907532)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:29:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.510
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.642214
Original XAI WIoU for r=0.8 =  tensor(0.5095, device='cuda:2')  +-  tensor(0.2852, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5035, device='cuda:2')  +-  tensor(0.2901, device='cuda:2') (0.019616564735770226)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:04.195702
Original XAI WIoU for r=0.8 =  tensor(0.2859, device='cuda:2')  +-  tensor(0.0785, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3181, device='cuda:2')  +-  tensor(0.0976, device='cuda:2') (0.05892367660999298)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:31:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.471
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.324



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.803976
Original XAI WIoU for r=0.8 =  tensor(0.4711, device='cuda:2')  +-  tensor(0.2612, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3787, device='cuda:2')  +-  tensor(0.2512, device='cuda:2') (0.0226031132042408)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.963471
Original XAI WIoU for r=0.8 =  tensor(0.3235, device='cuda:2')  +-  tensor(0.0936, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.2368, device='cuda:2')  +-  tensor(0.0971, device='cuda:2') (0.050910208374261856)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.5638744] +- [0.09189802]
(id) id_val WIOU_PERTURBED: 	[0.50268109] +- [0.08179254]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.44159026] +- [0.23328466]
(id) val WIOU_PERTURBED: 	[0.32702148] +- [0.10469802]
DONE CIGA GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:32:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.328
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.168



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.840037
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:2')  +-  tensor(0.1673, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:2')  +-  tensor(0.2188, device='cuda:2') (0.005732917692512274)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.949708
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:2')  +-  tensor(0.1673, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3759, device='cuda:2')  +-  tensor(0.2172, device='cuda:2') (0.004325540270656347)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.920145
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:2')  +-  tensor(0.1673, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3382, device='cuda:2')  +-  tensor(0.1670, device='cuda:2') (0.00034873539698310196)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.015643
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:2')  +-  tensor(0.0481, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1851, device='cuda:2')  +-  tensor(0.0564, device='cuda:2') (0.005529336165636778)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.587201
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:2')  +-  tensor(0.0481, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1859, device='cuda:2')  +-  tensor(0.0569, device='cuda:2') (0.005428839474916458)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.678893
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:2')  +-  tensor(0.0481, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1795, device='cuda:2')  +-  tensor(0.0525, device='cuda:2') (0.000688146916218102)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:36:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:36:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.174



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.638107
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:2')  +-  tensor(0.1641, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3727, device='cuda:2')  +-  tensor(0.2158, device='cuda:2') (0.0051664975471794605)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.615528
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:2')  +-  tensor(0.1641, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3715, device='cuda:2')  +-  tensor(0.2142, device='cuda:2') (0.003729707095772028)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.869446
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:2')  +-  tensor(0.1641, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3340, device='cuda:2')  +-  tensor(0.1648, device='cuda:2') (0.00038662724546156824)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.470644
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:2')  +-  tensor(0.0475, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1849, device='cuda:2')  +-  tensor(0.0554, device='cuda:2') (0.004344377666711807)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.630867
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:2')  +-  tensor(0.0475, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1850, device='cuda:2')  +-  tensor(0.0558, device='cuda:2') (0.004260516259819269)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.702005
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:2')  +-  tensor(0.0475, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1815, device='cuda:2')  +-  tensor(0.0509, device='cuda:2') (0.000530098273884505)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:41:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:41:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.167



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.782670
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:2')  +-  tensor(0.1637, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:2')  +-  tensor(0.2160, device='cuda:2') (0.004817910026758909)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.649567
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:2')  +-  tensor(0.1637, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3696, device='cuda:2')  +-  tensor(0.2149, device='cuda:2') (0.003820596029981971)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.564273
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:2')  +-  tensor(0.1637, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3330, device='cuda:2')  +-  tensor(0.1649, device='cuda:2') (0.00040399329736828804)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.389846
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:2')  +-  tensor(0.0476, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1839, device='cuda:2')  +-  tensor(0.0551, device='cuda:2') (0.0046522547490894794)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.393648
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:2')  +-  tensor(0.0476, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1849, device='cuda:2')  +-  tensor(0.0553, device='cuda:2') (0.00462768180295825)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.198641
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:2')  +-  tensor(0.0476, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1788, device='cuda:2')  +-  tensor(0.0504, device='cuda:2') (0.0007108264835551381)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:45:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:45:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.174



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.654537
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:2')  +-  tensor(0.1629, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3702, device='cuda:2')  +-  tensor(0.2142, device='cuda:2') (0.005451917182654142)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.736625
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:2')  +-  tensor(0.1629, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3702, device='cuda:2')  +-  tensor(0.2140, device='cuda:2') (0.004778601694852114)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.756073
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:2')  +-  tensor(0.1629, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3341, device='cuda:2')  +-  tensor(0.1649, device='cuda:2') (0.0003133343125227839)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.347015
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:2')  +-  tensor(0.0477, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1838, device='cuda:2')  +-  tensor(0.0552, device='cuda:2') (0.004686929285526276)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.086263
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:2')  +-  tensor(0.0477, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1843, device='cuda:2')  +-  tensor(0.0554, device='cuda:2') (0.004519123584032059)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.137777
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:2')  +-  tensor(0.0477, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1806, device='cuda:2')  +-  tensor(0.0500, device='cuda:2') (0.0006879599532112479)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:50:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:50:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.324
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.171



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.920644
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:2')  +-  tensor(0.1645, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:2')  +-  tensor(0.2167, device='cuda:2') (0.005352279637008905)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.544872
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:2')  +-  tensor(0.1645, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3724, device='cuda:2')  +-  tensor(0.2151, device='cuda:2') (0.004754445981234312)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.584923
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:2')  +-  tensor(0.1645, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3368, device='cuda:2')  +-  tensor(0.1668, device='cuda:2') (0.00039099311106838286)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.456010
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:2')  +-  tensor(0.0483, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1855, device='cuda:2')  +-  tensor(0.0555, device='cuda:2') (0.004544142168015242)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.684151
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:2')  +-  tensor(0.0483, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1862, device='cuda:2')  +-  tensor(0.0559, device='cuda:2') (0.004443598911166191)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.374654
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:2')  +-  tensor(0.0483, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1805, device='cuda:2')  +-  tensor(0.0503, device='cuda:2') (0.0005690270336344838)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.32386587 0.3238658  0.3238662 ] +- [0.00206954 0.00206961 0.00206919]
(id) id_val WIOU_PERTURBED: 	[0.37269703 0.37192928 0.33519734] +- [0.00234345 0.00222834 0.00195129]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.1707504 0.1707504 0.1707504] +- [0.00277189 0.00277189 0.00277189]
(id) val WIOU_PERTURBED: 	[0.18462939 0.1852374  0.18018157] +- [0.00067405 0.00069674 0.00093673]
DONE GSAT GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:53:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:59 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:13 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:15 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:17 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:19 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.765
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.229363
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:2')  +-  tensor(0.2609, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.5965, device='cuda:2')  +-  tensor(0.2694, device='cuda:2') (0.08726758509874344)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.167812
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:2')  +-  tensor(0.2609, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5743, device='cuda:2')  +-  tensor(0.2679, device='cuda:2') (0.06051631644368172)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.224066
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:2')  +-  tensor(0.2609, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.7055, device='cuda:2')  +-  tensor(0.3081, device='cuda:2') (0.0003286325663793832)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.993032
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.187157
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.159924
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:58:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:30 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:45 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:47 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:49 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.750
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.306940
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:2')  +-  tensor(0.2537, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.5998, device='cuda:2')  +-  tensor(0.2823, device='cuda:2') (0.09993388503789902)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.268157
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:2')  +-  tensor(0.2537, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5691, device='cuda:2')  +-  tensor(0.2705, device='cuda:2') (0.08698726445436478)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.582631
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:2')  +-  tensor(0.2537, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6236, device='cuda:2')  +-  tensor(0.2778, device='cuda:2') (0.016563057899475098)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.510629
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.299024
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.916804
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:02:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:24 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:39 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:41 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.789
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.959847
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:2')  +-  tensor(0.2203, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6232, device='cuda:2')  +-  tensor(0.2842, device='cuda:2') (0.08463947474956512)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.540855
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:2')  +-  tensor(0.2203, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6127, device='cuda:2')  +-  tensor(0.2821, device='cuda:2') (0.08342909812927246)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.177062
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:2')  +-  tensor(0.2203, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6777, device='cuda:2')  +-  tensor(0.2998, device='cuda:2') (0.02806236408650875)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.151511
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:2')  +-  tensor(0.0004, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.9943, device='cuda:2')  +-  tensor(0.0441, device='cuda:2') (0.0019268564647063613)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.893590
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:2')  +-  tensor(0.0004, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.9954, device='cuda:2')  +-  tensor(0.0362, device='cuda:2') (0.0029068482108414173)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.142374
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:2')  +-  tensor(0.0004, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:06:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:19 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:31 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:33 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:35 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.824
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.980



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.288818
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:2')  +-  tensor(0.2282, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6211, device='cuda:2')  +-  tensor(0.2582, device='cuda:2') (0.11769608408212662)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.655399
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:2')  +-  tensor(0.2282, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6137, device='cuda:2')  +-  tensor(0.2481, device='cuda:2') (0.10874250531196594)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.425270
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:2')  +-  tensor(0.2282, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.7272, device='cuda:2')  +-  tensor(0.2920, device='cuda:2') (0.019832612946629524)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.922108
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:2')  +-  tensor(0.0528, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.9817, device='cuda:2')  +-  tensor(0.0489, device='cuda:2') (0.0040619345381855965)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.134672
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:2')  +-  tensor(0.0528, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.9793, device='cuda:2')  +-  tensor(0.0539, device='cuda:2') (6.464081270252109e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.933576
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:2')  +-  tensor(0.0528, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:2')  +-  tensor(0.0528, device='cuda:2') (5.975387296075496e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:10:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:30 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:48 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:10:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.800
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.950930
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:2')  +-  tensor(0.2459, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6188, device='cuda:2')  +-  tensor(0.2650, device='cuda:2') (0.10031282156705856)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.186971
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:2')  +-  tensor(0.2459, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6027, device='cuda:2')  +-  tensor(0.2718, device='cuda:2') (0.09095511585474014)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.185897
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:2')  +-  tensor(0.2459, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6854, device='cuda:2')  +-  tensor(0.3167, device='cuda:2') (0.023654116317629814)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.537174
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:2')  +-  tensor(0.0002, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:2')  +-  tensor(0.0023, device='cuda:2') (7.153541082516313e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.206279
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:2')  +-  tensor(0.0002, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:2')  +-  tensor(0.0028, device='cuda:2') (1.9547736762604018e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.956098
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:2')  +-  tensor(0.0002, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:2')  +-  tensor(0.0014, device='cuda:2') (1.9547736762604018e-09)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127]
(id) id_val WIOU_PERTURBED: 	[0.61187949 0.59446939 0.68389642] +- [0.01134408 0.01907638 0.03467974]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648]
(id) val WIOU_PERTURBED: 	[0.99515246 0.99490519 0.9960122 ] +- [0.00708076 0.00798242 0.00793635]
DONE LECI GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:14:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:18 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:32 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:34 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:38 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.734614
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:2')  +-  tensor(0.2729, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5703, device='cuda:2')  +-  tensor(0.2819, device='cuda:2') (0.08531369268894196)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.937271
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:2')  +-  tensor(0.0057, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.9992, device='cuda:2')  +-  tensor(0.0088, device='cuda:2') (3.10986708607075e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:15:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:42 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:03 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.561506
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:2')  +-  tensor(0.2686, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5796, device='cuda:2')  +-  tensor(0.2800, device='cuda:2') (0.08951105922460556)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:04.108804
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:17:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:03 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:16 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:18 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:21 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:23 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.620231
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:2')  +-  tensor(0.2147, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5156, device='cuda:2')  +-  tensor(0.2789, device='cuda:2') (0.05277357995510101)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.554598
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:2')  +-  tensor(0.0017, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.9967, device='cuda:2')  +-  tensor(0.0103, device='cuda:2') (0.0016438404563814402)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:18:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:04.998180
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:2')  +-  tensor(0.2566, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4989, device='cuda:2')  +-  tensor(0.2819, device='cuda:2') (0.04530760645866394)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:04.587468
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:2')  +-  tensor(7.2843e-05, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.9997, device='cuda:2')  +-  tensor(0.0039, device='cuda:2') (1.7770669658023763e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:20:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:25 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:28 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:33 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:20:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.568171
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:2')  +-  tensor(0.2769, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.5784, device='cuda:2')  +-  tensor(0.2723, device='cuda:2') (0.08422412723302841)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.583715
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:2')  +-  tensor(0., device='cuda:2') (0.0)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.65580273] +- [0.08244711]
(id) id_val WIOU_PERTURBED: 	[0.54856985] +- [0.03426901]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99980891] +- [0.0002322]
(id) val WIOU_PERTURBED: 	[0.99910598] +- [0.00125858]
DONE CIGA GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:21:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:21:57 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:09 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:11 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:13 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:22:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.318
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.438



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.824766
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:2')  +-  tensor(0.1621, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3650, device='cuda:2')  +-  tensor(0.2148, device='cuda:2') (0.0037987120449543)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.507915
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:2')  +-  tensor(0.1621, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3649, device='cuda:2')  +-  tensor(0.2148, device='cuda:2') (0.003128131153061986)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.522966
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:2')  +-  tensor(0.1621, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3342, device='cuda:2')  +-  tensor(0.1676, device='cuda:2') (0.00043154609738849103)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.124871
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:2')  +-  tensor(0.0807, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4662, device='cuda:2')  +-  tensor(0.0910, device='cuda:2') (0.0012857274850830436)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.112232
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:2')  +-  tensor(0.0807, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4660, device='cuda:2')  +-  tensor(0.0911, device='cuda:2') (0.00048091422650031745)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.396418
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:2')  +-  tensor(0.0807, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4536, device='cuda:2')  +-  tensor(0.0899, device='cuda:2') (8.00054840510711e-06)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:26:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:29 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:41 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:43 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:45 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:26:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.327
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.443



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.937727
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:2')  +-  tensor(0.1674, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3725, device='cuda:2')  +-  tensor(0.2185, device='cuda:2') (0.005835582502186298)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.810363
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:2')  +-  tensor(0.1674, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3718, device='cuda:2')  +-  tensor(0.2175, device='cuda:2') (0.005123896058648825)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.726584
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:2')  +-  tensor(0.1674, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3434, device='cuda:2')  +-  tensor(0.1747, device='cuda:2') (0.00046401930740103126)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.281516
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:2')  +-  tensor(0.0872, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4730, device='cuda:2')  +-  tensor(0.0979, device='cuda:2') (0.0008379609207622707)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.459441
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:2')  +-  tensor(0.0872, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4728, device='cuda:2')  +-  tensor(0.0979, device='cuda:2') (2.195133492932655e-05)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.249565
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:2')  +-  tensor(0.0872, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4488, device='cuda:2')  +-  tensor(0.0899, device='cuda:2') (6.5862550968631695e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:30:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:30:40 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:30:53 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:30:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:30:56 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:30:58 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:31:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.446



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.867172
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:2')  +-  tensor(0.1654, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3696, device='cuda:2')  +-  tensor(0.2164, device='cuda:2') (0.005617118906229734)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.914103
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:2')  +-  tensor(0.1654, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3685, device='cuda:2')  +-  tensor(0.2154, device='cuda:2') (0.004534103907644749)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.885299
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:2')  +-  tensor(0.1654, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3378, device='cuda:2')  +-  tensor(0.1695, device='cuda:2') (0.0004763813631143421)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.074670
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:2')  +-  tensor(0.0849, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4739, device='cuda:2')  +-  tensor(0.0943, device='cuda:2') (0.0005529066547751427)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.388303
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:2')  +-  tensor(0.0849, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4739, device='cuda:2')  +-  tensor(0.0943, device='cuda:2') (3.987294050489254e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.205150
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:2')  +-  tensor(0.0849, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4506, device='cuda:2')  +-  tensor(0.0871, device='cuda:2') (4.187214130979555e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:34:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:48 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:34:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.443



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.751014
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:2')  +-  tensor(0.1642, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3687, device='cuda:2')  +-  tensor(0.2152, device='cuda:2') (0.004976408556103706)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.071065
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:2')  +-  tensor(0.1642, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3681, device='cuda:2')  +-  tensor(0.2147, device='cuda:2') (0.00439727958291769)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.053574
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:2')  +-  tensor(0.1642, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3374, device='cuda:2')  +-  tensor(0.1704, device='cuda:2') (0.0006786465528421104)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.475459
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:2')  +-  tensor(0.0848, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4720, device='cuda:2')  +-  tensor(0.0948, device='cuda:2') (0.0010446762898936868)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.378538
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:2')  +-  tensor(0.0848, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4716, device='cuda:2')  +-  tensor(0.0947, device='cuda:2') (9.351808330393396e-06)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.172320
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:2')  +-  tensor(0.0848, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4493, device='cuda:2')  +-  tensor(0.0890, device='cuda:2') (2.4212536420264996e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:37:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:37:56 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:08 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:10 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:12 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:14 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:38:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.321
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.456



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.587377
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:2')  +-  tensor(0.1636, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3680, device='cuda:2')  +-  tensor(0.2166, device='cuda:2') (0.005551611538976431)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.509974
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:2')  +-  tensor(0.1636, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3670, device='cuda:2')  +-  tensor(0.2158, device='cuda:2') (0.004735948517918587)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.704181
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:2')  +-  tensor(0.1636, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3329, device='cuda:2')  +-  tensor(0.1676, device='cuda:2') (0.000520465662702918)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.130088
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:2')  +-  tensor(0.0850, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4841, device='cuda:2')  +-  tensor(0.0932, device='cuda:2') (0.0015579948667436838)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.649827
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:2')  +-  tensor(0.0850, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4832, device='cuda:2')  +-  tensor(0.0930, device='cuda:2') (0.000254705868428573)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.692282
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:2')  +-  tensor(0.0850, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4609, device='cuda:2')  +-  tensor(0.0868, device='cuda:2') (3.998400721627604e-09)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828]
(id) id_val WIOU_PERTURBED: 	[0.36874686 0.36806766 0.33711797] +- [0.00244114 0.00225624 0.00363963]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847]
(id) val WIOU_PERTURBED: 	[0.47381042 0.47349358 0.45265548] +- [0.00578657 0.00557141 0.00442769]
DONE GSAT GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:41:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:41:33 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:41:50 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:41:52 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:41:55 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:00 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:08 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:42:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.414
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.185



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.518165
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:2')  +-  tensor(0.2121, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4924, device='cuda:2')  +-  tensor(0.2606, device='cuda:2') (0.026543233543634415)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.226042
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:2')  +-  tensor(0.2121, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4712, device='cuda:2')  +-  tensor(0.2433, device='cuda:2') (0.011971819214522839)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.456975
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:2')  +-  tensor(0.2121, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4329, device='cuda:2')  +-  tensor(0.2173, device='cuda:2') (5.9593876358121634e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.943820
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:2')  +-  tensor(0.1094, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.2317, device='cuda:2')  +-  tensor(0.1430, device='cuda:2') (0.010568749159574509)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.671586
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:2')  +-  tensor(0.1094, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.2304, device='cuda:2')  +-  tensor(0.1551, device='cuda:2') (0.0028378639835864305)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.727773
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:2')  +-  tensor(0.1094, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1947, device='cuda:2')  +-  tensor(0.1151, device='cuda:2') (8.170640649041161e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:46:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:00 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:15 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:18 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:20 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:46:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.423
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.320



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.515005
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:2')  +-  tensor(0.2026, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4869, device='cuda:2')  +-  tensor(0.2472, device='cuda:2') (0.019456587731838226)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.231679
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:2')  +-  tensor(0.2026, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4568, device='cuda:2')  +-  tensor(0.2197, device='cuda:2') (0.006600848399102688)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.250495
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:2')  +-  tensor(0.2026, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4357, device='cuda:2')  +-  tensor(0.2036, device='cuda:2') (0.00013057832256890833)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.483901
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:2')  +-  tensor(0.3062, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:2')  +-  tensor(0.2606, device='cuda:2') (0.0135555574670434)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.991817
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:2')  +-  tensor(0.3062, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3151, device='cuda:2')  +-  tensor(0.2695, device='cuda:2') (0.0022778904531151056)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.893823
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:2')  +-  tensor(0.3062, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3227, device='cuda:2')  +-  tensor(0.3038, device='cuda:2') (0.00017672184912953526)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:50:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:41 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:58 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:01 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:03 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:08 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:51:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.592
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.254884
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:2')  +-  tensor(0.3091, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.6440, device='cuda:2')  +-  tensor(0.3217, device='cuda:2') (0.0378565788269043)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.242573
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:2')  +-  tensor(0.3091, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.6232, device='cuda:2')  +-  tensor(0.3137, device='cuda:2') (0.02366207167506218)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.248029
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:2')  +-  tensor(0.3091, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.6016, device='cuda:2')  +-  tensor(0.3050, device='cuda:2') (5.1828283176291734e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.687698
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:2')  +-  tensor(0.3487, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4476, device='cuda:2')  +-  tensor(0.3316, device='cuda:2') (0.033634040504693985)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.700538
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:2')  +-  tensor(0.3487, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4283, device='cuda:2')  +-  tensor(0.3268, device='cuda:2') (0.021389521658420563)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.817524
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:2')  +-  tensor(0.3487, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4320, device='cuda:2')  +-  tensor(0.3466, device='cuda:2') (8.496452210238203e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:56:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:45 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:02 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:05 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:07 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:57:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.411
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.453792
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:2')  +-  tensor(0.2328, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3732, device='cuda:2')  +-  tensor(0.2547, device='cuda:2') (0.029297441244125366)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.210063
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:2')  +-  tensor(0.2328, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3782, device='cuda:2')  +-  tensor(0.2459, device='cuda:2') (0.009655299596488476)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.224529
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:2')  +-  tensor(0.2328, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3969, device='cuda:2')  +-  tensor(0.2368, device='cuda:2') (0.0009551164112053812)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.496033
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:2')  +-  tensor(0.3396, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.3120, device='cuda:2')  +-  tensor(0.3278, device='cuda:2') (0.017723914235830307)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.483941
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:2')  +-  tensor(0.3396, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.3082, device='cuda:2')  +-  tensor(0.3339, device='cuda:2') (0.009101993404328823)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.916892
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:2')  +-  tensor(0.3396, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3166, device='cuda:2')  +-  tensor(0.3402, device='cuda:2') (0.001880235387943685)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:01:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:51 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:08 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:11 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:14 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:19 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:02:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.397
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.241



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.254521
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:2')  +-  tensor(0.2053, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4663, device='cuda:2')  +-  tensor(0.2759, device='cuda:2') (0.030308924615383148)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.200055
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:2')  +-  tensor(0.2053, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4483, device='cuda:2')  +-  tensor(0.2627, device='cuda:2') (0.01872488483786583)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.230088
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:2')  +-  tensor(0.2053, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.4041, device='cuda:2')  +-  tensor(0.2075, device='cuda:2') (0.0005870130262337625)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.565298
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:2')  +-  tensor(0.1914, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.2439, device='cuda:2')  +-  tensor(0.1595, device='cuda:2') (0.024143880233168602)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.728384
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:2')  +-  tensor(0.1914, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.2354, device='cuda:2')  +-  tensor(0.1591, device='cuda:2') (0.011468345299363136)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.768185
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:2')  +-  tensor(0.1914, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.2453, device='cuda:2')  +-  tensor(0.1875, device='cuda:2') (0.00048252096166834235)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325]
(id) id_val WIOU_PERTURBED: 	[0.49255184 0.47554228 0.45423735] +- [0.08706119 0.08049246 0.07525881]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.30000614 0.30000606 0.30000614] +- [0.08320276 0.08320286 0.08320276]
(id) val WIOU_PERTURBED: 	[0.31237173 0.30348902 0.30225932] +- [0.07707893 0.07170772 0.08032758]
DONE LECI GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:07:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:12 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:26 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:28 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.534
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.360



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.493191
Original XAI WIoU for r=0.8 =  tensor(0.5329, device='cuda:2')  +-  tensor(0.3104, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5505, device='cuda:2')  +-  tensor(0.3146, device='cuda:2') (0.011447523720562458)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.831777
Original XAI WIoU for r=0.8 =  tensor(0.3607, device='cuda:2')  +-  tensor(0.3526, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3551, device='cuda:2')  +-  tensor(0.3490, device='cuda:2') (0.005194403696805239)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:08:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:07 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.512
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.356



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.428626
Original XAI WIoU for r=0.8 =  tensor(0.5114, device='cuda:2')  +-  tensor(0.3038, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5124, device='cuda:2')  +-  tensor(0.3047, device='cuda:2') (0.010849454440176487)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.779399
Original XAI WIoU for r=0.8 =  tensor(0.3574, device='cuda:2')  +-  tensor(0.3518, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3426, device='cuda:2')  +-  tensor(0.3468, device='cuda:2') (0.005961122922599316)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:10:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:36 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:47 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:51 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:56 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:11:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.520
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.357



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.453756
Original XAI WIoU for r=0.8 =  tensor(0.5173, device='cuda:2')  +-  tensor(0.3040, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5272, device='cuda:2')  +-  tensor(0.3088, device='cuda:2') (0.011392336338758469)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.980418
Original XAI WIoU for r=0.8 =  tensor(0.3588, device='cuda:2')  +-  tensor(0.3514, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3551, device='cuda:2')  +-  tensor(0.3466, device='cuda:2') (0.004515527747571468)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:12:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.579
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.411



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.429774
Original XAI WIoU for r=0.8 =  tensor(0.5745, device='cuda:2')  +-  tensor(0.2710, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.5513, device='cuda:2')  +-  tensor(0.2884, device='cuda:2') (0.008962808176875114)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.772498
Original XAI WIoU for r=0.8 =  tensor(0.4078, device='cuda:2')  +-  tensor(0.3081, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.3732, device='cuda:2')  +-  tensor(0.3262, device='cuda:2') (0.005788249894976616)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:14:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:18 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:20 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.716
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.578



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.405506
Original XAI WIoU for r=0.8 =  tensor(0.7175, device='cuda:2')  +-  tensor(0.2690, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.6770, device='cuda:2')  +-  tensor(0.2997, device='cuda:2') (0.019690198823809624)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.872745
Original XAI WIoU for r=0.8 =  tensor(0.5778, device='cuda:2')  +-  tensor(0.2951, device='cuda:2')
Intervened XAI WIoU for r=0.8 =  tensor(0.4984, device='cuda:2')  +-  tensor(0.3021, device='cuda:2') (0.019406098872423172)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.57071018] +- [0.0766256]
(id) id_val WIOU_PERTURBED: 	[0.56369091] +- [0.05854458]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.4125272] +- [0.08479555]
(id) val WIOU_PERTURBED: 	[0.38488666] +- [0.05758227]
DONE CIGA GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:16:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:15 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:27 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:34 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.387
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.157



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.661493
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:2')  +-  tensor(0.1876, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4436, device='cuda:2')  +-  tensor(0.2366, device='cuda:2') (0.006320255342870951)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.675685
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:2')  +-  tensor(0.1876, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4423, device='cuda:2')  +-  tensor(0.2355, device='cuda:2') (0.004303575959056616)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.439477
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:2')  +-  tensor(0.1876, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3986, device='cuda:2')  +-  tensor(0.1905, device='cuda:2') (0.0003506630309857428)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.392669
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:2')  +-  tensor(0.0734, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1821, device='cuda:2')  +-  tensor(0.0986, device='cuda:2') (0.0021259586792439222)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.463200
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:2')  +-  tensor(0.0734, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1804, device='cuda:2')  +-  tensor(0.0969, device='cuda:2') (0.0015645080711692572)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.489401
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:2')  +-  tensor(0.0734, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1645, device='cuda:2')  +-  tensor(0.0785, device='cuda:2') (0.000302744098007679)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:22:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:01 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:12 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:14 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:19 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.380
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.154



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.653488
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:2')  +-  tensor(0.1846, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4375, device='cuda:2')  +-  tensor(0.2345, device='cuda:2') (0.0049729119054973125)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.629154
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:2')  +-  tensor(0.1846, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4354, device='cuda:2')  +-  tensor(0.2324, device='cuda:2') (0.0038854912854731083)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.422428
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:2')  +-  tensor(0.1846, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3907, device='cuda:2')  +-  tensor(0.1857, device='cuda:2') (0.0003706789866555482)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.372201
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:2')  +-  tensor(0.0726, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1777, device='cuda:2')  +-  tensor(0.0953, device='cuda:2') (0.0017059437232092023)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.446927
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:2')  +-  tensor(0.0726, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1762, device='cuda:2')  +-  tensor(0.0938, device='cuda:2') (0.001358813256956637)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.691157
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:2')  +-  tensor(0.0726, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1603, device='cuda:2')  +-  tensor(0.0756, device='cuda:2') (0.0003282157995272428)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:27:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:37 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:49 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:51 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:53 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:57 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:28:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.385
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.155



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.430477
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:2')  +-  tensor(0.1861, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4411, device='cuda:2')  +-  tensor(0.2349, device='cuda:2') (0.005037357099354267)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.609648
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:2')  +-  tensor(0.1861, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4391, device='cuda:2')  +-  tensor(0.2324, device='cuda:2') (0.003917567897588015)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.610656
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:2')  +-  tensor(0.1861, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3969, device='cuda:2')  +-  tensor(0.1888, device='cuda:2') (0.0004007454263046384)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.387882
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:2')  +-  tensor(0.0726, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1795, device='cuda:2')  +-  tensor(0.0960, device='cuda:2') (0.0017127608880400658)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.634681
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:2')  +-  tensor(0.0726, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1777, device='cuda:2')  +-  tensor(0.0949, device='cuda:2') (0.0013534820172935724)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:07.079012
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:2')  +-  tensor(0.0726, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1618, device='cuda:2')  +-  tensor(0.0768, device='cuda:2') (0.00032028547138907015)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:33:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:03 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:17 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:19 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:21 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:30 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:30 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:33:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:33:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.383
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.156



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.444032
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:2')  +-  tensor(0.1837, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4387, device='cuda:2')  +-  tensor(0.2332, device='cuda:2') (0.005782082676887512)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.431085
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:2')  +-  tensor(0.1837, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4338, device='cuda:2')  +-  tensor(0.2263, device='cuda:2') (0.004290658049285412)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.194399
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:2')  +-  tensor(0.1837, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3949, device='cuda:2')  +-  tensor(0.1869, device='cuda:2') (0.00039930056664161384)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.383976
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:2')  +-  tensor(0.0717, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1797, device='cuda:2')  +-  tensor(0.0968, device='cuda:2') (0.002113951137289405)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.403262
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:2')  +-  tensor(0.0717, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1781, device='cuda:2')  +-  tensor(0.0953, device='cuda:2') (0.0015270018484443426)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.956538
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:2')  +-  tensor(0.0717, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1629, device='cuda:2')  +-  tensor(0.0770, device='cuda:2') (0.0003417937841732055)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:38:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:16 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:29 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:31 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:33 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:36 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.382
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.154



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.623532
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:2')  +-  tensor(0.1861, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.4400, device='cuda:2')  +-  tensor(0.2359, device='cuda:2') (0.004804552067071199)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.602936
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:2')  +-  tensor(0.1861, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.4373, device='cuda:2')  +-  tensor(0.2325, device='cuda:2') (0.003597120987251401)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.628781
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:2')  +-  tensor(0.1861, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.3951, device='cuda:2')  +-  tensor(0.1888, device='cuda:2') (0.00034826897899620235)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.330683
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:2')  +-  tensor(0.0727, device='cuda:2')
Intervened XAI WIoU for r=0.3 =  tensor(0.1784, device='cuda:2')  +-  tensor(0.0969, device='cuda:2') (0.0018171145347878337)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.587698
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:2')  +-  tensor(0.0727, device='cuda:2')
Intervened XAI WIoU for r=0.6 =  tensor(0.1767, device='cuda:2')  +-  tensor(0.0955, device='cuda:2') (0.0013820989988744259)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.638962
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:2')  +-  tensor(0.0727, device='cuda:2')
Intervened XAI WIoU for r=0.9 =  tensor(0.1606, device='cuda:2')  +-  tensor(0.0770, device='cuda:2') (0.00039394147461280227)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.38347052 0.38347052 0.38347052] +- [0.00255777 0.00255777 0.00255777]
(id) id_val WIOU_PERTURBED: 	[0.44019028 0.43759914 0.3952543 ] +- [0.00207424 0.00296738 0.00264015]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181]
(id) val WIOU_PERTURBED: 	[0.17949046 0.17781372 0.16201435] +- [0.00150505 0.00146647 0.00156095]
DONE GSAT GOODMotif/size 0.05
DONE all :)
