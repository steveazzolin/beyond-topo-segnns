nohup: ignoring input
I'm BIG :)
The PID of this script is: 18392

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:03:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:03:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9133
Train Loss: 0.4290
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.4031
ID Test ACCURACY: 0.9080
ID Test Loss: 0.4515
OOD Validation ACCURACY: 0.9227
OOD Validation Loss: 0.3936
OOD Test ACCURACY: 0.8737
OOD Test Loss: 0.4903

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.4715
ID Validation ACCURACY: 0.8663
ID Validation Loss: 0.4430
ID Test ACCURACY: 0.8633
ID Test Loss: 0.4820
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3746
OOD Test ACCURACY: 0.7837
OOD Test Loss: 0.6415

[0m[1;37mINFO[0m: [1mChartInfo 0.9080 0.8737 0.8633 0.7837 0.8663 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.677
WIoU for r=0.3 = 0.613
F1 for r=0.6 = 0.615
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.699
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.699
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.688
WIoU for r=0.3 = 0.632
F1 for r=0.6 = 0.607
WIoU for r=0.6 = 0.705
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.706
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.705
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.634
WIoU for r=0.3 = 0.628
F1 for r=0.6 = 0.503
WIoU for r=0.6 = 0.625
F1 for r=0.9 = 0.421
WIoU for r=0.9 = 0.629
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.629


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.695
Model XAI F1 of binarized graphs for r=0.3 =  0.6773650000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61260875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.482
SUFF++ for r=0.3 class 0 = 0.503 +- 0.285 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 1 = 0.577 +- 0.285 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 2 = 0.447 +- 0.285 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all KL = 0.456 +- 0.285 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all L1 = 0.51 +- 0.157 (in-sample avg dev_std = 0.553)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  0.61451625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989574999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.731
SUFF++ for r=0.6 class 0 = 0.61 +- 0.287 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 1 = 0.649 +- 0.287 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 2 = 0.604 +- 0.287 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all KL = 0.543 +- 0.287 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all L1 = 0.621 +- 0.180 (in-sample avg dev_std = 0.534)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.935
Model XAI F1 of binarized graphs for r=0.9 =  0.48001374999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.6990912499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.877
SUFF++ for r=0.9 class 0 = 0.791 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 1 = 0.832 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 2 = 0.817 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all KL = 0.827 +- 0.200 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all L1 = 0.813 +- 0.151 (in-sample avg dev_std = 0.320)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.71
Model XAI F1 of binarized graphs for r=0.3 =  0.6882737499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6322949999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.488
SUFF++ for r=0.3 class 0 = 0.496 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 class 1 = 0.569 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 class 2 = 0.452 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 all KL = 0.438 +- 0.283 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.155 (in-sample avg dev_std = 0.564)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  0.606685
Model XAI WIoU of binarized graphs for r=0.6 =  0.7050562499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.705
SUFF++ for r=0.6 class 0 = 0.612 +- 0.286 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 1 = 0.654 +- 0.286 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 2 = 0.583 +- 0.286 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all KL = 0.544 +- 0.286 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all L1 = 0.615 +- 0.177 (in-sample avg dev_std = 0.539)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.47260624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.70564875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.866
SUFF++ for r=0.9 class 0 = 0.801 +- 0.188 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 1 = 0.815 +- 0.188 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 2 = 0.8 +- 0.188 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all KL = 0.824 +- 0.188 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all L1 = 0.805 +- 0.150 (in-sample avg dev_std = 0.315)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.524
Model XAI F1 of binarized graphs for r=0.3 =  0.6342637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.62753625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.523
SUFF++ for r=0.3 class 0 = 0.513 +- 0.292 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 class 1 = 0.551 +- 0.292 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 class 2 = 0.534 +- 0.292 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 all KL = 0.464 +- 0.292 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.3 all L1 = 0.533 +- 0.175 (in-sample avg dev_std = 0.574)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  0.50262625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6251525
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.663
SUFF++ for r=0.6 class 0 = 0.638 +- 0.304 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 class 1 = 0.584 +- 0.304 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 class 2 = 0.535 +- 0.304 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 all KL = 0.57 +- 0.304 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.6 all L1 = 0.585 +- 0.197 (in-sample avg dev_std = 0.535)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.42123999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.629245
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0 = 0.907 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 1 = 0.757 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all KL = 0.837 +- 0.257 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all L1 = 0.823 +- 0.192 (in-sample avg dev_std = 0.282)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.695
Model XAI F1 of binarized graphs for r=0.3 =  0.6773650000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61260875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.414
NEC for r=0.3 class 0 = 0.57 +- 0.317 (in-sample avg dev_std = 0.441)
NEC for r=0.3 class 1 = 0.489 +- 0.317 (in-sample avg dev_std = 0.441)
NEC for r=0.3 class 2 = 0.586 +- 0.317 (in-sample avg dev_std = 0.441)
NEC for r=0.3 all KL = 0.575 +- 0.317 (in-sample avg dev_std = 0.441)
NEC for r=0.3 all L1 = 0.548 +- 0.176 (in-sample avg dev_std = 0.441)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  0.61451625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6989574999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.6 +- 0.301 (in-sample avg dev_std = 0.502)
NEC for r=0.6 class 1 = 0.543 +- 0.301 (in-sample avg dev_std = 0.502)
NEC for r=0.6 class 2 = 0.557 +- 0.301 (in-sample avg dev_std = 0.502)
NEC for r=0.6 all KL = 0.636 +- 0.301 (in-sample avg dev_std = 0.502)
NEC for r=0.6 all L1 = 0.567 +- 0.155 (in-sample avg dev_std = 0.502)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.935
Model XAI F1 of binarized graphs for r=0.9 =  0.48001374999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.6990912499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.551
NEC for r=0.9 class 0 = 0.555 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 1 = 0.485 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 2 = 0.521 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all KL = 0.563 +- 0.291 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all L1 = 0.52 +- 0.158 (in-sample avg dev_std = 0.538)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.6988987499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.55 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 1 = 0.487 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 2 = 0.519 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all KL = 0.562 +- 0.286 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all L1 = 0.519 +- 0.151 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.711
Model XAI F1 of binarized graphs for r=0.3 =  0.6882737499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6322949999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.42
NEC for r=0.3 class 0 = 0.589 +- 0.315 (in-sample avg dev_std = 0.453)
NEC for r=0.3 class 1 = 0.502 +- 0.315 (in-sample avg dev_std = 0.453)
NEC for r=0.3 class 2 = 0.575 +- 0.315 (in-sample avg dev_std = 0.453)
NEC for r=0.3 all KL = 0.596 +- 0.315 (in-sample avg dev_std = 0.453)
NEC for r=0.3 all L1 = 0.556 +- 0.172 (in-sample avg dev_std = 0.453)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  0.606685
Model XAI WIoU of binarized graphs for r=0.6 =  0.7050562499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.496
NEC for r=0.6 class 0 = 0.605 +- 0.297 (in-sample avg dev_std = 0.500)
NEC for r=0.6 class 1 = 0.539 +- 0.297 (in-sample avg dev_std = 0.500)
NEC for r=0.6 class 2 = 0.539 +- 0.297 (in-sample avg dev_std = 0.500)
NEC for r=0.6 all KL = 0.619 +- 0.297 (in-sample avg dev_std = 0.500)
NEC for r=0.6 all L1 = 0.561 +- 0.157 (in-sample avg dev_std = 0.500)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.47260624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.70564875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.568
NEC for r=0.9 class 0 = 0.54 +- 0.284 (in-sample avg dev_std = 0.552)
NEC for r=0.9 class 1 = 0.473 +- 0.284 (in-sample avg dev_std = 0.552)
NEC for r=0.9 class 2 = 0.519 +- 0.284 (in-sample avg dev_std = 0.552)
NEC for r=0.9 all KL = 0.549 +- 0.284 (in-sample avg dev_std = 0.552)
NEC for r=0.9 all L1 = 0.511 +- 0.149 (in-sample avg dev_std = 0.552)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.70543875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.562
NEC for r=1.0 class 0 = 0.547 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 1 = 0.477 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 2 = 0.508 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all KL = 0.548 +- 0.285 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all L1 = 0.511 +- 0.153 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.524
Model XAI F1 of binarized graphs for r=0.3 =  0.6342637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.62753625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.439
NEC for r=0.3 class 0 = 0.635 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 1 = 0.603 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 class 2 = 0.561 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all KL = 0.668 +- 0.263 (in-sample avg dev_std = 0.474)
NEC for r=0.3 all L1 = 0.599 +- 0.136 (in-sample avg dev_std = 0.474)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  0.50262625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6251525
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.578
NEC for r=0.6 class 0 = 0.5 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 1 = 0.397 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 class 2 = 0.517 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all KL = 0.482 +- 0.315 (in-sample avg dev_std = 0.558)
NEC for r=0.6 all L1 = 0.47 +- 0.197 (in-sample avg dev_std = 0.558)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  0.42123999999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.629245
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.611
NEC for r=0.9 class 0 = 0.444 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 1 = 0.432 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 class 2 = 0.448 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all KL = 0.475 +- 0.338 (in-sample avg dev_std = 0.598)
NEC for r=0.9 all L1 = 0.441 +- 0.191 (in-sample avg dev_std = 0.598)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.886
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.6285324999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.627
NEC for r=1.0 class 0 = 0.422 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 class 1 = 0.418 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 class 2 = 0.443 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 all KL = 0.452 +- 0.317 (in-sample avg dev_std = 0.571)
NEC for r=1.0 all L1 = 0.428 +- 0.179 (in-sample avg dev_std = 0.571)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:06:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:06:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9118
Train Loss: 0.4030
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3794
ID Test ACCURACY: 0.9047
ID Test Loss: 0.4384
OOD Validation ACCURACY: 0.9233
OOD Validation Loss: 0.3768
OOD Test ACCURACY: 0.8853
OOD Test Loss: 0.4748

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.8885
Train Loss: 0.4487
ID Validation ACCURACY: 0.8923
ID Validation Loss: 0.4387
ID Test ACCURACY: 0.8827
ID Test Loss: 0.4705
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.4388
OOD Test ACCURACY: 0.7740
OOD Test Loss: 0.7590

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8853 0.8827 0.7740 0.8923 0.9290[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.677
WIoU for r=0.3 = 0.618
F1 for r=0.6 = 0.601
WIoU for r=0.6 = 0.724
F1 for r=0.9 = 0.480
WIoU for r=0.9 = 0.732
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.732
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.681
WIoU for r=0.3 = 0.625
F1 for r=0.6 = 0.597
WIoU for r=0.6 = 0.725
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.732
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.732
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.640
WIoU for r=0.3 = 0.727
F1 for r=0.6 = 0.542
WIoU for r=0.6 = 0.772
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.770
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.770


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  0.6771587499999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.61805625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.475
SUFF++ for r=0.3 class 0 = 0.488 +- 0.252 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 1 = 0.557 +- 0.252 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 2 = 0.436 +- 0.252 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all KL = 0.401 +- 0.252 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all L1 = 0.494 +- 0.140 (in-sample avg dev_std = 0.547)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.906
Model XAI F1 of binarized graphs for r=0.6 =  0.60146
Model XAI WIoU of binarized graphs for r=0.6 =  0.724375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.758
SUFF++ for r=0.6 class 0 = 0.648 +- 0.292 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 1 = 0.695 +- 0.292 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 2 = 0.689 +- 0.292 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all KL = 0.641 +- 0.292 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all L1 = 0.677 +- 0.203 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.47954125
Model XAI WIoU of binarized graphs for r=0.9 =  0.7315299999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.889
SUFF++ for r=0.9 class 0 = 0.814 +- 0.160 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 1 = 0.839 +- 0.160 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.160 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all KL = 0.898 +- 0.160 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.161 (in-sample avg dev_std = 0.211)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.669
Model XAI F1 of binarized graphs for r=0.3 =  0.68072625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6249075000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.482
SUFF++ for r=0.3 class 0 = 0.479 +- 0.250 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 class 1 = 0.564 +- 0.250 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 class 2 = 0.458 +- 0.250 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 all KL = 0.401 +- 0.250 (in-sample avg dev_std = 0.560)
SUFF++ for r=0.3 all L1 = 0.499 +- 0.140 (in-sample avg dev_std = 0.560)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.901
Model XAI F1 of binarized graphs for r=0.6 =  0.59679
Model XAI WIoU of binarized graphs for r=0.6 =  0.72547
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.754
SUFF++ for r=0.6 class 0 = 0.656 +- 0.286 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 1 = 0.695 +- 0.286 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 2 = 0.689 +- 0.286 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all KL = 0.646 +- 0.286 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all L1 = 0.68 +- 0.200 (in-sample avg dev_std = 0.478)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47191000000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7315112500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.882
SUFF++ for r=0.9 class 0 = 0.813 +- 0.162 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1 = 0.837 +- 0.162 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.162 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.895 +- 0.162 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.848 +- 0.160 (in-sample avg dev_std = 0.219)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.696
Model XAI F1 of binarized graphs for r=0.3 =  0.6404124999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.72653
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0 = 0.541 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all KL = 0.558 +- 0.293 (in-sample avg dev_std = 0.517)
SUFF++ for r=0.3 all L1 = 0.589 +- 0.210 (in-sample avg dev_std = 0.517)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5424575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7723887500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.72
SUFF++ for r=0.6 class 0 = 0.653 +- 0.326 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 1 = 0.637 +- 0.326 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 class 2 = 0.658 +- 0.326 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 all KL = 0.615 +- 0.326 (in-sample avg dev_std = 0.574)
SUFF++ for r=0.6 all L1 = 0.649 +- 0.188 (in-sample avg dev_std = 0.574)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.422365
Model XAI WIoU of binarized graphs for r=0.9 =  0.76983375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.848
SUFF++ for r=0.9 class 0 = 0.809 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 2 = 0.957 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all KL = 0.838 +- 0.263 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.170 (in-sample avg dev_std = 0.287)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  0.6771587499999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.61805625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.579 +- 0.259 (in-sample avg dev_std = 0.511)
NEC for r=0.3 class 1 = 0.54 +- 0.259 (in-sample avg dev_std = 0.511)
NEC for r=0.3 class 2 = 0.643 +- 0.259 (in-sample avg dev_std = 0.511)
NEC for r=0.3 all KL = 0.664 +- 0.259 (in-sample avg dev_std = 0.511)
NEC for r=0.3 all L1 = 0.587 +- 0.137 (in-sample avg dev_std = 0.511)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.906
Model XAI F1 of binarized graphs for r=0.6 =  0.60146
Model XAI WIoU of binarized graphs for r=0.6 =  0.724375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.505
NEC for r=0.6 class 0 = 0.548 +- 0.296 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 1 = 0.514 +- 0.296 (in-sample avg dev_std = 0.551)
NEC for r=0.6 class 2 = 0.601 +- 0.296 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all KL = 0.627 +- 0.296 (in-sample avg dev_std = 0.551)
NEC for r=0.6 all L1 = 0.554 +- 0.166 (in-sample avg dev_std = 0.551)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.47954125
Model XAI WIoU of binarized graphs for r=0.9 =  0.7315299999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.586
NEC for r=0.9 class 0 = 0.498 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 1 = 0.469 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 2 = 0.532 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all KL = 0.554 +- 0.285 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all L1 = 0.499 +- 0.151 (in-sample avg dev_std = 0.585)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7315112500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.603
NEC for r=1.0 class 0 = 0.492 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 1 = 0.481 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 class 2 = 0.52 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all KL = 0.554 +- 0.284 (in-sample avg dev_std = 0.583)
NEC for r=1.0 all L1 = 0.497 +- 0.154 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.669
Model XAI F1 of binarized graphs for r=0.3 =  0.68072625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6249075000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.353
NEC for r=0.3 class 0 = 0.584 +- 0.261 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 1 = 0.539 +- 0.261 (in-sample avg dev_std = 0.508)
NEC for r=0.3 class 2 = 0.642 +- 0.261 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all KL = 0.67 +- 0.261 (in-sample avg dev_std = 0.508)
NEC for r=0.3 all L1 = 0.589 +- 0.138 (in-sample avg dev_std = 0.508)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.902
Model XAI F1 of binarized graphs for r=0.6 =  0.59679
Model XAI WIoU of binarized graphs for r=0.6 =  0.72547
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.495
NEC for r=0.6 class 0 = 0.552 +- 0.296 (in-sample avg dev_std = 0.554)
NEC for r=0.6 class 1 = 0.504 +- 0.296 (in-sample avg dev_std = 0.554)
NEC for r=0.6 class 2 = 0.6 +- 0.296 (in-sample avg dev_std = 0.554)
NEC for r=0.6 all KL = 0.627 +- 0.296 (in-sample avg dev_std = 0.554)
NEC for r=0.6 all L1 = 0.553 +- 0.169 (in-sample avg dev_std = 0.554)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.47191000000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7315112500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.584
NEC for r=0.9 class 0 = 0.496 +- 0.284 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 1 = 0.479 +- 0.284 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 2 = 0.525 +- 0.284 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all KL = 0.557 +- 0.284 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all L1 = 0.5 +- 0.154 (in-sample avg dev_std = 0.588)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.73150125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.602
NEC for r=1.0 class 0 = 0.477 +- 0.287 (in-sample avg dev_std = 0.582)
NEC for r=1.0 class 1 = 0.469 +- 0.287 (in-sample avg dev_std = 0.582)
NEC for r=1.0 class 2 = 0.518 +- 0.287 (in-sample avg dev_std = 0.582)
NEC for r=1.0 all KL = 0.543 +- 0.287 (in-sample avg dev_std = 0.582)
NEC for r=1.0 all L1 = 0.489 +- 0.156 (in-sample avg dev_std = 0.582)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.696
Model XAI F1 of binarized graphs for r=0.3 =  0.6404124999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.72653
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.472
NEC for r=0.3 class 0 = 0.541 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 class 1 = 0.469 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 class 2 = 0.56 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 all KL = 0.567 +- 0.250 (in-sample avg dev_std = 0.527)
NEC for r=0.3 all L1 = 0.523 +- 0.127 (in-sample avg dev_std = 0.527)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.5424575
Model XAI WIoU of binarized graphs for r=0.6 =  0.7723887500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.597
NEC for r=0.6 class 0 = 0.459 +- 0.327 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 1 = 0.379 +- 0.327 (in-sample avg dev_std = 0.525)
NEC for r=0.6 class 2 = 0.533 +- 0.327 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all KL = 0.473 +- 0.327 (in-sample avg dev_std = 0.525)
NEC for r=0.6 all L1 = 0.456 +- 0.215 (in-sample avg dev_std = 0.525)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  0.422365
Model XAI WIoU of binarized graphs for r=0.9 =  0.76983375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.647
NEC for r=0.9 class 0 = 0.393 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 1 = 0.382 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 class 2 = 0.475 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all KL = 0.481 +- 0.350 (in-sample avg dev_std = 0.601)
NEC for r=0.9 all L1 = 0.417 +- 0.201 (in-sample avg dev_std = 0.601)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.897
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.76983375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.652
NEC for r=1.0 class 0 = 0.41 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 class 1 = 0.383 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 class 2 = 0.457 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 all KL = 0.485 +- 0.347 (in-sample avg dev_std = 0.599)
NEC for r=1.0 all L1 = 0.417 +- 0.198 (in-sample avg dev_std = 0.599)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:09:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:09:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.8932
Train Loss: 0.4562
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.4325
ID Test ACCURACY: 0.8937
ID Test Loss: 0.4701
OOD Validation ACCURACY: 0.9143
OOD Validation Loss: 0.4605
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.5237

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.8433
Train Loss: 0.5132
ID Validation ACCURACY: 0.8480
ID Validation Loss: 0.5068
ID Test ACCURACY: 0.8413
ID Test Loss: 0.5417
OOD Validation ACCURACY: 0.9147
OOD Validation Loss: 0.5475
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.5372

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.8143 0.8413 0.8277 0.8480 0.9147[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.637
WIoU for r=0.3 = 0.612
F1 for r=0.6 = 0.600
WIoU for r=0.6 = 0.756
F1 for r=0.9 = 0.477
WIoU for r=0.9 = 0.771
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.771
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.642
WIoU for r=0.3 = 0.629
F1 for r=0.6 = 0.594
WIoU for r=0.6 = 0.767
F1 for r=0.9 = 0.470
WIoU for r=0.9 = 0.781
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.782
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.446
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.503
WIoU for r=0.6 = 0.525
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.514
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.510


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.6372800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61194625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.442
SUFF++ for r=0.3 class 0 = 0.478 +- 0.265 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 1 = 0.579 +- 0.265 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 2 = 0.444 +- 0.265 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all KL = 0.524 +- 0.265 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.139 (in-sample avg dev_std = 0.519)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.6003000000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.755675
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.746
SUFF++ for r=0.6 class 0 = 0.674 +- 0.261 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1 = 0.666 +- 0.261 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 2 = 0.713 +- 0.261 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.707 +- 0.261 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.684 +- 0.212 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.47724249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.7708825
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0 = 0.803 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1 = 0.802 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 2 = 0.874 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.881 +- 0.188 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.826 +- 0.183 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  0.64182625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6285262500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.448
SUFF++ for r=0.3 class 0 = 0.479 +- 0.271 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 class 1 = 0.592 +- 0.271 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 class 2 = 0.473 +- 0.271 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 all KL = 0.531 +- 0.271 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.3 all L1 = 0.514 +- 0.145 (in-sample avg dev_std = 0.516)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.5939475000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7667649999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.72
SUFF++ for r=0.6 class 0 = 0.652 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 1 = 0.663 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 class 2 = 0.711 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all KL = 0.699 +- 0.259 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.6 all L1 = 0.676 +- 0.216 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.4703275
Model XAI WIoU of binarized graphs for r=0.9 =  0.781475
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0 = 0.818 +- 0.180 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 1 = 0.804 +- 0.180 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 2 = 0.872 +- 0.180 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all KL = 0.886 +- 0.180 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.181 (in-sample avg dev_std = 0.247)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  0.4464175
Model XAI WIoU of binarized graphs for r=0.3 =  0.3652025
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.494
SUFF++ for r=0.3 class 0 = 0.49 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 class 1 = 0.559 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 class 2 = 0.471 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 all KL = 0.481 +- 0.274 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 all L1 = 0.507 +- 0.144 (in-sample avg dev_std = 0.592)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.695
Model XAI F1 of binarized graphs for r=0.6 =  0.50256
Model XAI WIoU of binarized graphs for r=0.6 =  0.5247987500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.709
SUFF++ for r=0.6 class 0 = 0.673 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 1 = 0.613 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 class 2 = 0.664 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all KL = 0.669 +- 0.265 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.6 all L1 = 0.65 +- 0.189 (in-sample avg dev_std = 0.463)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.804
Model XAI F1 of binarized graphs for r=0.9 =  0.42183624999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.5138825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.818
SUFF++ for r=0.9 class 0 = 0.767 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 1 = 0.787 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 2 = 0.921 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all KL = 0.866 +- 0.198 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.172 (in-sample avg dev_std = 0.338)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  0.6372800000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.61194625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.538 +- 0.280 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 1 = 0.474 +- 0.280 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 2 = 0.561 +- 0.280 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all KL = 0.491 +- 0.280 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all L1 = 0.524 +- 0.158 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.6003000000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.755675
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.491
NEC for r=0.6 class 0 = 0.536 +- 0.304 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 1 = 0.524 +- 0.304 (in-sample avg dev_std = 0.490)
NEC for r=0.6 class 2 = 0.572 +- 0.304 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all KL = 0.573 +- 0.304 (in-sample avg dev_std = 0.490)
NEC for r=0.6 all L1 = 0.544 +- 0.156 (in-sample avg dev_std = 0.490)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  0.47724249999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.7708825
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.595
NEC for r=0.9 class 0 = 0.484 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 1 = 0.478 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 class 2 = 0.473 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all KL = 0.485 +- 0.285 (in-sample avg dev_std = 0.512)
NEC for r=0.9 all L1 = 0.478 +- 0.152 (in-sample avg dev_std = 0.512)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7709799999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.605
NEC for r=1.0 class 0 = 0.483 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 1 = 0.476 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 class 2 = 0.458 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all KL = 0.476 +- 0.277 (in-sample avg dev_std = 0.501)
NEC for r=1.0 all L1 = 0.472 +- 0.153 (in-sample avg dev_std = 0.501)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  0.64182625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6285262500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.388
NEC for r=0.3 class 0 = 0.54 +- 0.288 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 1 = 0.47 +- 0.288 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 2 = 0.55 +- 0.288 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all KL = 0.491 +- 0.288 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all L1 = 0.521 +- 0.161 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  0.5939475000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7667649999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.51
NEC for r=0.6 class 0 = 0.531 +- 0.313 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 1 = 0.517 +- 0.313 (in-sample avg dev_std = 0.482)
NEC for r=0.6 class 2 = 0.561 +- 0.313 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all KL = 0.561 +- 0.313 (in-sample avg dev_std = 0.482)
NEC for r=0.6 all L1 = 0.537 +- 0.164 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.4703275
Model XAI WIoU of binarized graphs for r=0.9 =  0.781475
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.6
NEC for r=0.9 class 0 = 0.491 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 1 = 0.471 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 2 = 0.467 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all KL = 0.481 +- 0.277 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all L1 = 0.476 +- 0.149 (in-sample avg dev_std = 0.517)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.78158375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.597
NEC for r=1.0 class 0 = 0.489 +- 0.278 (in-sample avg dev_std = 0.513)
NEC for r=1.0 class 1 = 0.475 +- 0.278 (in-sample avg dev_std = 0.513)
NEC for r=1.0 class 2 = 0.452 +- 0.278 (in-sample avg dev_std = 0.513)
NEC for r=1.0 all KL = 0.476 +- 0.278 (in-sample avg dev_std = 0.513)
NEC for r=1.0 all L1 = 0.472 +- 0.151 (in-sample avg dev_std = 0.513)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  0.4464175
Model XAI WIoU of binarized graphs for r=0.3 =  0.3652025
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.495
NEC for r=0.3 class 0 = 0.541 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 1 = 0.528 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 2 = 0.532 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all KL = 0.543 +- 0.263 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all L1 = 0.533 +- 0.125 (in-sample avg dev_std = 0.506)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.50256
Model XAI WIoU of binarized graphs for r=0.6 =  0.5247987500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.56
NEC for r=0.6 class 0 = 0.468 +- 0.328 (in-sample avg dev_std = 0.520)
NEC for r=0.6 class 1 = 0.446 +- 0.328 (in-sample avg dev_std = 0.520)
NEC for r=0.6 class 2 = 0.499 +- 0.328 (in-sample avg dev_std = 0.520)
NEC for r=0.6 all KL = 0.459 +- 0.328 (in-sample avg dev_std = 0.520)
NEC for r=0.6 all L1 = 0.471 +- 0.204 (in-sample avg dev_std = 0.520)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.804
Model XAI F1 of binarized graphs for r=0.9 =  0.42183624999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.5138825
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0 = 0.428 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 1 = 0.425 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 class 2 = 0.352 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all KL = 0.417 +- 0.317 (in-sample avg dev_std = 0.505)
NEC for r=0.9 all L1 = 0.402 +- 0.191 (in-sample avg dev_std = 0.505)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.50977875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.675
NEC for r=1.0 class 0 = 0.419 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 class 1 = 0.419 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 class 2 = 0.357 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 all KL = 0.426 +- 0.318 (in-sample avg dev_std = 0.530)
NEC for r=1.0 all L1 = 0.399 +- 0.182 (in-sample avg dev_std = 0.530)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:13:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:13:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9057
Train Loss: 0.4303
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4156
ID Test ACCURACY: 0.8993
ID Test Loss: 0.4653
OOD Validation ACCURACY: 0.9207
OOD Validation Loss: 0.4392
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.4806

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8659
Train Loss: 0.5021
ID Validation ACCURACY: 0.8630
ID Validation Loss: 0.5023
ID Test ACCURACY: 0.8600
ID Test Loss: 0.5351
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4432
OOD Test ACCURACY: 0.7227
OOD Test Loss: 0.7492

[0m[1;37mINFO[0m: [1mChartInfo 0.8993 0.8143 0.8600 0.7227 0.8630 0.9283[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.700
WIoU for r=0.3 = 0.695
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.474
WIoU for r=0.9 = 0.796
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.796
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.709
WIoU for r=0.3 = 0.713
F1 for r=0.6 = 0.597
WIoU for r=0.6 = 0.797
F1 for r=0.9 = 0.468
WIoU for r=0.9 = 0.804
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.804
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.474
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.516
WIoU for r=0.6 = 0.756
F1 for r=0.9 = 0.399
WIoU for r=0.9 = 0.748
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.748


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.618
Model XAI F1 of binarized graphs for r=0.3 =  0.7002862499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6953324999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.489
SUFF++ for r=0.3 class 0 = 0.525 +- 0.263 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 1 = 0.621 +- 0.263 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 class 2 = 0.483 +- 0.263 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all KL = 0.465 +- 0.263 (in-sample avg dev_std = 0.553)
SUFF++ for r=0.3 all L1 = 0.543 +- 0.167 (in-sample avg dev_std = 0.553)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60346625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7893375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.771
SUFF++ for r=0.6 class 0 = 0.64 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.73 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.714 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.693 +- 0.259 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.695 +- 0.208 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47362375
Model XAI WIoU of binarized graphs for r=0.9 =  0.7962062499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.885
SUFF++ for r=0.9 class 0 = 0.789 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.857 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.901 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.896 +- 0.139 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.849 +- 0.146 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.619
Model XAI F1 of binarized graphs for r=0.3 =  0.7087437500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.71309875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.488
SUFF++ for r=0.3 class 0 = 0.524 +- 0.273 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 1 = 0.638 +- 0.273 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 class 2 = 0.507 +- 0.273 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all KL = 0.48 +- 0.273 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.3 all L1 = 0.555 +- 0.176 (in-sample avg dev_std = 0.547)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.59718
Model XAI WIoU of binarized graphs for r=0.6 =  0.7969487500000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0 = 0.617 +- 0.256 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1 = 0.735 +- 0.256 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 2 = 0.715 +- 0.256 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.685 +- 0.256 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.689 +- 0.206 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.46776249999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.8038425000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.886
SUFF++ for r=0.9 class 0 = 0.792 +- 0.127 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.871 +- 0.127 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.902 +- 0.127 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.904 +- 0.127 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.138 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.683
Model XAI F1 of binarized graphs for r=0.3 =  0.47423250000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.58244125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0 = 0.552 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.718 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.636 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.681 +- 0.200 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.637 +- 0.163 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  0.5155825
Model XAI WIoU of binarized graphs for r=0.6 =  0.75621375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.689
SUFF++ for r=0.6 class 0 = 0.558 +- 0.319 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.6 class 1 = 0.651 +- 0.319 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.6 class 2 = 0.691 +- 0.319 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.6 all KL = 0.594 +- 0.319 (in-sample avg dev_std = 0.594)
SUFF++ for r=0.6 all L1 = 0.634 +- 0.194 (in-sample avg dev_std = 0.594)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.805
Model XAI F1 of binarized graphs for r=0.9 =  0.39854875000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.7475125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.725
SUFF++ for r=0.9 class 0 = 0.666 +- 0.225 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 1 = 0.838 +- 0.225 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 class 2 = 0.847 +- 0.225 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all KL = 0.793 +- 0.225 (in-sample avg dev_std = 0.348)
SUFF++ for r=0.9 all L1 = 0.785 +- 0.190 (in-sample avg dev_std = 0.348)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.618
Model XAI F1 of binarized graphs for r=0.3 =  0.7002862499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.6953324999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.379
NEC for r=0.3 class 0 = 0.579 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.3 class 1 = 0.584 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.3 class 2 = 0.613 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.3 all KL = 0.666 +- 0.273 (in-sample avg dev_std = 0.473)
NEC for r=0.3 all L1 = 0.592 +- 0.140 (in-sample avg dev_std = 0.473)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.91
Model XAI F1 of binarized graphs for r=0.6 =  0.60346625
Model XAI WIoU of binarized graphs for r=0.6 =  0.7893375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.482
NEC for r=0.6 class 0 = 0.542 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 1 = 0.52 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 class 2 = 0.609 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all KL = 0.593 +- 0.311 (in-sample avg dev_std = 0.486)
NEC for r=0.6 all L1 = 0.557 +- 0.173 (in-sample avg dev_std = 0.486)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47362375
Model XAI WIoU of binarized graphs for r=0.9 =  0.7962062499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.562
NEC for r=0.9 class 0 = 0.481 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.47 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.519 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.514 +- 0.295 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.49 +- 0.168 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7962062499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0 = 0.481 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 1 = 0.469 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 2 = 0.504 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all KL = 0.507 +- 0.294 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all L1 = 0.485 +- 0.166 (in-sample avg dev_std = 0.544)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.619
Model XAI F1 of binarized graphs for r=0.3 =  0.7087437500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.71309875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.381
NEC for r=0.3 class 0 = 0.598 +- 0.270 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 1 = 0.567 +- 0.270 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 2 = 0.6 +- 0.270 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all KL = 0.665 +- 0.270 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all L1 = 0.589 +- 0.141 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  0.59718
Model XAI WIoU of binarized graphs for r=0.6 =  0.7969487500000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.488
NEC for r=0.6 class 0 = 0.543 +- 0.310 (in-sample avg dev_std = 0.494)
NEC for r=0.6 class 1 = 0.516 +- 0.310 (in-sample avg dev_std = 0.494)
NEC for r=0.6 class 2 = 0.582 +- 0.310 (in-sample avg dev_std = 0.494)
NEC for r=0.6 all KL = 0.583 +- 0.310 (in-sample avg dev_std = 0.494)
NEC for r=0.6 all L1 = 0.548 +- 0.178 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  0.46776249999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.8038425000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.57
NEC for r=0.9 class 0 = 0.483 +- 0.293 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 1 = 0.468 +- 0.293 (in-sample avg dev_std = 0.551)
NEC for r=0.9 class 2 = 0.496 +- 0.293 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all KL = 0.506 +- 0.293 (in-sample avg dev_std = 0.551)
NEC for r=0.9 all L1 = 0.483 +- 0.166 (in-sample avg dev_std = 0.551)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.906
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.8038425000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.475 +- 0.293 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 1 = 0.464 +- 0.293 (in-sample avg dev_std = 0.544)
NEC for r=1.0 class 2 = 0.501 +- 0.293 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all KL = 0.503 +- 0.293 (in-sample avg dev_std = 0.544)
NEC for r=1.0 all L1 = 0.48 +- 0.166 (in-sample avg dev_std = 0.544)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.683
Model XAI F1 of binarized graphs for r=0.3 =  0.47423250000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.58244125
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.453
NEC for r=0.3 class 0 = 0.447 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 1 = 0.465 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 class 2 = 0.515 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all KL = 0.41 +- 0.222 (in-sample avg dev_std = 0.458)
NEC for r=0.3 all L1 = 0.476 +- 0.123 (in-sample avg dev_std = 0.458)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  0.5155825
Model XAI WIoU of binarized graphs for r=0.6 =  0.75621375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.559
NEC for r=0.6 class 0 = 0.432 +- 0.350 (in-sample avg dev_std = 0.541)
NEC for r=0.6 class 1 = 0.388 +- 0.350 (in-sample avg dev_std = 0.541)
NEC for r=0.6 class 2 = 0.54 +- 0.350 (in-sample avg dev_std = 0.541)
NEC for r=0.6 all KL = 0.481 +- 0.350 (in-sample avg dev_std = 0.541)
NEC for r=0.6 all L1 = 0.453 +- 0.231 (in-sample avg dev_std = 0.541)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.805
Model XAI F1 of binarized graphs for r=0.9 =  0.39854875000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.7475125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.617
NEC for r=0.9 class 0 = 0.399 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 1 = 0.384 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 2 = 0.433 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all KL = 0.442 +- 0.323 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all L1 = 0.405 +- 0.207 (in-sample avg dev_std = 0.575)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.805
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7475125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.637
NEC for r=1.0 class 0 = 0.405 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 1 = 0.368 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 class 2 = 0.436 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all KL = 0.435 +- 0.310 (in-sample avg dev_std = 0.570)
NEC for r=1.0 all L1 = 0.403 +- 0.196 (in-sample avg dev_std = 0.570)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:16:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:16:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9160
ID Validation Loss: 0.3999
ID Test ACCURACY: 0.9063
ID Test Loss: 0.4570
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.4378
OOD Test ACCURACY: 0.7653
OOD Test Loss: 0.7567

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ACCURACY: 0.8616
Train Loss: 0.5039
ID Validation ACCURACY: 0.8560
ID Validation Loss: 0.5048
ID Test ACCURACY: 0.8567
ID Test Loss: 0.5356
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4136
OOD Test ACCURACY: 0.7727
OOD Test Loss: 0.6722

[0m[1;37mINFO[0m: [1mChartInfo 0.9063 0.7653 0.8567 0.7727 0.8560 0.9293[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.683
WIoU for r=0.3 = 0.670
F1 for r=0.6 = 0.595
WIoU for r=0.6 = 0.765
F1 for r=0.9 = 0.476
WIoU for r=0.9 = 0.777
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.777
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.694
WIoU for r=0.3 = 0.692
F1 for r=0.6 = 0.590
WIoU for r=0.6 = 0.780
F1 for r=0.9 = 0.469
WIoU for r=0.9 = 0.790
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.790
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.365
WIoU for r=0.3 = 0.522
F1 for r=0.6 = 0.451
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.402
WIoU for r=0.9 = 0.738
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.738


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.6830075
Model XAI WIoU of binarized graphs for r=0.3 =  0.669955
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.495 +- 0.304 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 class 1 = 0.612 +- 0.304 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 class 2 = 0.455 +- 0.304 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 all KL = 0.42 +- 0.304 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.3 all L1 = 0.521 +- 0.184 (in-sample avg dev_std = 0.555)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.59516125
Model XAI WIoU of binarized graphs for r=0.6 =  0.765335
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.721
SUFF++ for r=0.6 class 0 = 0.586 +- 0.291 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 class 1 = 0.707 +- 0.291 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 class 2 = 0.613 +- 0.291 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 all KL = 0.583 +- 0.291 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 all L1 = 0.635 +- 0.184 (in-sample avg dev_std = 0.526)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47566
Model XAI WIoU of binarized graphs for r=0.9 =  0.7768124999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0 = 0.788 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 1 = 0.852 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 2 = 0.889 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all KL = 0.883 +- 0.171 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.158 (in-sample avg dev_std = 0.247)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  0.6935637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6923887499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.457
SUFF++ for r=0.3 class 0 = 0.48 +- 0.289 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 1 = 0.618 +- 0.289 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 2 = 0.461 +- 0.289 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all KL = 0.404 +- 0.289 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all L1 = 0.519 +- 0.174 (in-sample avg dev_std = 0.582)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.5901225
Model XAI WIoU of binarized graphs for r=0.6 =  0.77968625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.704
SUFF++ for r=0.6 class 0 = 0.596 +- 0.289 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 1 = 0.703 +- 0.289 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 class 2 = 0.6 +- 0.289 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 all KL = 0.576 +- 0.289 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.181 (in-sample avg dev_std = 0.540)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.46884125
Model XAI WIoU of binarized graphs for r=0.9 =  0.78970375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0 = 0.803 +- 0.159 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 1 = 0.858 +- 0.159 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 2 = 0.893 +- 0.159 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all KL = 0.892 +- 0.159 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all L1 = 0.852 +- 0.148 (in-sample avg dev_std = 0.243)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.36501875
Model XAI WIoU of binarized graphs for r=0.3 =  0.52244875
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0 = 0.565 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 class 1 = 0.629 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 class 2 = 0.582 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 all KL = 0.519 +- 0.307 (in-sample avg dev_std = 0.580)
SUFF++ for r=0.3 all L1 = 0.592 +- 0.179 (in-sample avg dev_std = 0.580)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.45104
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934600000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.636
SUFF++ for r=0.6 class 0 = 0.527 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 class 1 = 0.582 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 class 2 = 0.575 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 all KL = 0.585 +- 0.290 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.6 all L1 = 0.562 +- 0.213 (in-sample avg dev_std = 0.475)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.761
Model XAI F1 of binarized graphs for r=0.9 =  0.40172875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7375375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.691
SUFF++ for r=0.9 class 0 = 0.688 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 1 = 0.778 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 2 = 0.743 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all KL = 0.711 +- 0.338 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all L1 = 0.737 +- 0.201 (in-sample avg dev_std = 0.323)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.652
Model XAI F1 of binarized graphs for r=0.3 =  0.6830075
Model XAI WIoU of binarized graphs for r=0.3 =  0.669955
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.392
NEC for r=0.3 class 0 = 0.519 +- 0.319 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 1 = 0.452 +- 0.319 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 2 = 0.587 +- 0.319 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all KL = 0.612 +- 0.319 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all L1 = 0.519 +- 0.186 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  0.59516125
Model XAI WIoU of binarized graphs for r=0.6 =  0.765335
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.522
NEC for r=0.6 class 0 = 0.517 +- 0.304 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 1 = 0.486 +- 0.304 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 2 = 0.592 +- 0.304 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all KL = 0.587 +- 0.304 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all L1 = 0.531 +- 0.167 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  0.47566
Model XAI WIoU of binarized graphs for r=0.9 =  0.7768124999999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.613
NEC for r=0.9 class 0 = 0.469 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 class 1 = 0.438 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 class 2 = 0.54 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 all KL = 0.521 +- 0.302 (in-sample avg dev_std = 0.540)
NEC for r=0.9 all L1 = 0.482 +- 0.167 (in-sample avg dev_std = 0.540)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.77693625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.627
NEC for r=1.0 class 0 = 0.465 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 1 = 0.417 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 class 2 = 0.515 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all KL = 0.508 +- 0.298 (in-sample avg dev_std = 0.547)
NEC for r=1.0 all L1 = 0.465 +- 0.165 (in-sample avg dev_std = 0.547)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  0.6935637500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6923887499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.393
NEC for r=0.3 class 0 = 0.544 +- 0.308 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 1 = 0.461 +- 0.308 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 2 = 0.569 +- 0.308 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all KL = 0.625 +- 0.308 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all L1 = 0.526 +- 0.181 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.865
Model XAI F1 of binarized graphs for r=0.6 =  0.5901225
Model XAI WIoU of binarized graphs for r=0.6 =  0.77968625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.548
NEC for r=0.6 class 0 = 0.51 +- 0.311 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 1 = 0.467 +- 0.311 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 2 = 0.575 +- 0.311 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all KL = 0.569 +- 0.311 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all L1 = 0.519 +- 0.175 (in-sample avg dev_std = 0.527)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.46884125
Model XAI WIoU of binarized graphs for r=0.9 =  0.78970375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.617
NEC for r=0.9 class 0 = 0.464 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 1 = 0.437 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 2 = 0.507 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all KL = 0.508 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all L1 = 0.47 +- 0.167 (in-sample avg dev_std = 0.539)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7898274999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.624
NEC for r=1.0 class 0 = 0.463 +- 0.296 (in-sample avg dev_std = 0.546)
NEC for r=1.0 class 1 = 0.43 +- 0.296 (in-sample avg dev_std = 0.546)
NEC for r=1.0 class 2 = 0.513 +- 0.296 (in-sample avg dev_std = 0.546)
NEC for r=1.0 all KL = 0.51 +- 0.296 (in-sample avg dev_std = 0.546)
NEC for r=1.0 all L1 = 0.47 +- 0.160 (in-sample avg dev_std = 0.546)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  0.36501875
Model XAI WIoU of binarized graphs for r=0.3 =  0.52244875
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.525
NEC for r=0.3 class 0 = 0.586 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 class 1 = 0.486 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 class 2 = 0.658 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 all KL = 0.653 +- 0.312 (in-sample avg dev_std = 0.519)
NEC for r=0.3 all L1 = 0.576 +- 0.186 (in-sample avg dev_std = 0.519)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  0.45104
Model XAI WIoU of binarized graphs for r=0.6 =  0.6934600000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.588
NEC for r=0.6 class 0 = 0.452 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 1 = 0.462 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 class 2 = 0.518 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all KL = 0.454 +- 0.301 (in-sample avg dev_std = 0.523)
NEC for r=0.6 all L1 = 0.477 +- 0.213 (in-sample avg dev_std = 0.523)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.761
Model XAI F1 of binarized graphs for r=0.9 =  0.40172875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7375375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.643
NEC for r=0.9 class 0 = 0.402 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 1 = 0.4 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 class 2 = 0.494 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all KL = 0.487 +- 0.353 (in-sample avg dev_std = 0.573)
NEC for r=0.9 all L1 = 0.432 +- 0.208 (in-sample avg dev_std = 0.573)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.761
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.7375375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.673
NEC for r=1.0 class 0 = 0.416 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 1 = 0.388 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 class 2 = 0.455 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all KL = 0.48 +- 0.340 (in-sample avg dev_std = 0.572)
NEC for r=1.0 all L1 = 0.42 +- 0.192 (in-sample avg dev_std = 0.572)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.456, 0.543, 0.827, 1.0], 'all_L1': [0.51, 0.621, 0.813, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.401, 0.641, 0.898, 1.0], 'all_L1': [0.494, 0.677, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.707, 0.881, 1.0], 'all_L1': [0.501, 0.684, 0.826, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.465, 0.693, 0.896, 1.0], 'all_L1': [0.543, 0.695, 0.849, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.583, 0.883, 1.0], 'all_L1': [0.521, 0.635, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.575, 0.636, 0.563, 0.562], 'all_L1': [0.548, 0.567, 0.52, 0.519]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.627, 0.554, 0.554], 'all_L1': [0.587, 0.554, 0.499, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.573, 0.485, 0.476], 'all_L1': [0.524, 0.544, 0.478, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.666, 0.593, 0.514, 0.507], 'all_L1': [0.592, 0.557, 0.49, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.612, 0.587, 0.521, 0.508], 'all_L1': [0.519, 0.531, 0.482, 0.465]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.438, 0.544, 0.824, 1.0], 'all_L1': [0.505, 0.615, 0.805, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.401, 0.646, 0.895, 1.0], 'all_L1': [0.499, 0.68, 0.848, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.531, 0.699, 0.886, 1.0], 'all_L1': [0.514, 0.676, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.48, 0.685, 0.904, 1.0], 'all_L1': [0.555, 0.689, 0.856, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.576, 0.892, 1.0], 'all_L1': [0.519, 0.632, 0.852, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.596, 0.619, 0.549, 0.548], 'all_L1': [0.556, 0.561, 0.511, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.627, 0.557, 0.543], 'all_L1': [0.589, 0.553, 0.5, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.561, 0.481, 0.476], 'all_L1': [0.521, 0.537, 0.476, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.583, 0.506, 0.503], 'all_L1': [0.589, 0.548, 0.483, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.625, 0.569, 0.508, 0.51], 'all_L1': [0.526, 0.519, 0.47, 0.47]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.464, 0.57, 0.837, 1.0], 'all_L1': [0.533, 0.585, 0.823, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.558, 0.615, 0.838, 1.0], 'all_L1': [0.589, 0.649, 0.861, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.669, 0.866, 1.0], 'all_L1': [0.507, 0.65, 0.825, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.681, 0.594, 0.793, 1.0], 'all_L1': [0.637, 0.634, 0.785, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.519, 0.585, 0.711, 1.0], 'all_L1': [0.592, 0.562, 0.737, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.668, 0.482, 0.475, 0.452], 'all_L1': [0.599, 0.47, 0.441, 0.428]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.473, 0.481, 0.485], 'all_L1': [0.523, 0.456, 0.417, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.459, 0.417, 0.426], 'all_L1': [0.533, 0.471, 0.402, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.481, 0.442, 0.435], 'all_L1': [0.476, 0.453, 0.405, 0.403]}), defaultdict(<class 'list'>, {'all_KL': [0.653, 0.454, 0.487, 0.48], 'all_L1': [0.576, 0.477, 0.432, 0.42]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.514 +- 0.017, 0.662 +- 0.029, 0.836 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.453 +- 0.042, 0.633 +- 0.063, 0.877 +- 0.026, 1.000 +- 0.000
suff++_acc_int  =  0.467 +- 0.020, 0.745 +- 0.018, 0.878 +- 0.008
nec class all_L1  =  0.554 +- 0.031, 0.551 +- 0.012, 0.494 +- 0.015, 0.488 +- 0.019
nec class all_KL  =  0.602 +- 0.065, 0.603 +- 0.024, 0.527 +- 0.028, 0.521 +- 0.032
nec_acc_int  =  0.386 +- 0.016, 0.499 +- 0.014, 0.581 +- 0.022, 0.594 +- 0.024

Eval split id_test
suff++ class all_L1  =  0.518 +- 0.020, 0.658 +- 0.029, 0.839 +- 0.019, 1.000 +- 0.000
suff++ class all_KL  =  0.451 +- 0.049, 0.630 +- 0.061, 0.880 +- 0.029, 1.000 +- 0.000
suff++_acc_int  =  0.473 +- 0.017, 0.728 +- 0.023, 0.873 +- 0.011
nec class all_L1  =  0.556 +- 0.029, 0.544 +- 0.015, 0.488 +- 0.015, 0.484 +- 0.015
nec class all_KL  =  0.609 +- 0.065, 0.592 +- 0.027, 0.520 +- 0.029, 0.516 +- 0.027
nec_acc_int  =  0.387 +- 0.022, 0.507 +- 0.021, 0.588 +- 0.018, 0.590 +- 0.023

Eval split test
suff++ class all_L1  =  0.572 +- 0.046, 0.616 +- 0.036, 0.806 +- 0.042, 1.000 +- 0.000
suff++ class all_KL  =  0.541 +- 0.077, 0.607 +- 0.034, 0.809 +- 0.054, 1.000 +- 0.000
suff++_acc_int  =  0.538 +- 0.033, 0.684 +- 0.031, 0.784 +- 0.063
nec class all_L1  =  0.541 +- 0.043, 0.465 +- 0.009, 0.419 +- 0.015, 0.413 +- 0.011
nec class all_KL  =  0.568 +- 0.093, 0.470 +- 0.011, 0.460 +- 0.027, 0.456 +- 0.024
nec_acc_int  =  0.477 +- 0.031, 0.577 +- 0.015, 0.636 +- 0.019, 0.653 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.534 +- 0.019, 0.606 +- 0.016, 0.665 +- 0.007, 0.744 +- 0.010
Faith. Armon (L1)= 		  =  0.533 +- 0.019, 0.601 +- 0.014, 0.621 +- 0.010, 0.655 +- 0.017
Faith. GMean (L1)= 	  =  0.533 +- 0.019, 0.604 +- 0.015, 0.642 +- 0.008, 0.698 +- 0.014
Faith. Aritm (KL)= 		  =  0.527 +- 0.021, 0.618 +- 0.026, 0.702 +- 0.014, 0.761 +- 0.016
Faith. Armon (KL)= 		  =  0.512 +- 0.018, 0.615 +- 0.025, 0.658 +- 0.020, 0.685 +- 0.028
Faith. GMean (KL)= 	  =  0.520 +- 0.019, 0.617 +- 0.025, 0.680 +- 0.016, 0.722 +- 0.022

Eval split id_test
Faith. Aritm (L1)= 		  =  0.537 +- 0.020, 0.601 +- 0.017, 0.663 +- 0.007, 0.742 +- 0.007
Faith. Armon (L1)= 		  =  0.536 +- 0.019, 0.595 +- 0.015, 0.617 +- 0.010, 0.653 +- 0.013
Faith. GMean (L1)= 	  =  0.537 +- 0.019, 0.598 +- 0.016, 0.640 +- 0.008, 0.696 +- 0.011
Faith. Aritm (KL)= 		  =  0.530 +- 0.023, 0.611 +- 0.028, 0.700 +- 0.015, 0.758 +- 0.013
Faith. Armon (KL)= 		  =  0.513 +- 0.023, 0.608 +- 0.027, 0.653 +- 0.020, 0.680 +- 0.023
Faith. GMean (KL)= 	  =  0.521 +- 0.022, 0.609 +- 0.027, 0.676 +- 0.017, 0.718 +- 0.019

Eval split test
Faith. Aritm (L1)= 		  =  0.556 +- 0.021, 0.541 +- 0.015, 0.613 +- 0.021, 0.707 +- 0.005
Faith. Armon (L1)= 		  =  0.553 +- 0.021, 0.530 +- 0.011, 0.551 +- 0.015, 0.585 +- 0.011
Faith. GMean (L1)= 	  =  0.555 +- 0.021, 0.535 +- 0.013, 0.581 +- 0.017, 0.643 +- 0.008
Faith. Aritm (KL)= 		  =  0.554 +- 0.025, 0.538 +- 0.015, 0.635 +- 0.023, 0.728 +- 0.012
Faith. Armon (KL)= 		  =  0.542 +- 0.027, 0.529 +- 0.011, 0.585 +- 0.020, 0.626 +- 0.022
Faith. GMean (KL)= 	  =  0.548 +- 0.025, 0.534 +- 0.013, 0.609 +- 0.020, 0.675 +- 0.017
Computed for split load_split = id



Completed in  0:16:29.428717  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:19:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:19:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.6308
Train Loss: 2.3385
ID Validation ACCURACY: 0.6420
ID Validation Loss: 2.3082
ID Test ACCURACY: 0.6163
ID Test Loss: 2.4129
OOD Validation ACCURACY: 0.6277
OOD Validation Loss: 2.3570
OOD Test ACCURACY: 0.3420
OOD Test Loss: 3.0846

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.6308
Train Loss: 2.3385
ID Validation ACCURACY: 0.6420
ID Validation Loss: 2.3082
ID Test ACCURACY: 0.6163
ID Test Loss: 2.4129
OOD Validation ACCURACY: 0.6277
OOD Validation Loss: 2.3570
OOD Test ACCURACY: 0.3420
OOD Test Loss: 3.0846

[0m[1;37mINFO[0m: [1mChartInfo 0.6163 0.3420 0.6163 0.3420 0.6420 0.6277[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.448
WIoU for r=0.3 = 0.495
F1 for r=0.6 = 0.396
WIoU for r=0.6 = 0.518
F1 for r=0.9 = 0.418
WIoU for r=0.9 = 0.519
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.519
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.437
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.383
WIoU for r=0.6 = 0.503
F1 for r=0.9 = 0.409
WIoU for r=0.9 = 0.503
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.503
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.150
WIoU for r=0.3 = 0.127
F1 for r=0.6 = 0.160
WIoU for r=0.6 = 0.101
F1 for r=0.9 = 0.315
WIoU for r=0.9 = 0.092
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.092


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.448395
Model XAI WIoU of binarized graphs for r=0.3 =  0.49450249999999996
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.465
SUFF++ for r=0.3 class 0 = 0.702 +- 0.096 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 class 1 = 0.841 +- 0.096 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 class 2 = 0.716 +- 0.096 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 all KL = 0.88 +- 0.096 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.3 all L1 = 0.753 +- 0.149 (in-sample avg dev_std = 0.325)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.3959
Model XAI WIoU of binarized graphs for r=0.6 =  0.51787125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.442
SUFF++ for r=0.6 class 0 = 0.749 +- 0.112 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 1 = 0.764 +- 0.112 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 2 = 0.864 +- 0.112 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all KL = 0.896 +- 0.112 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all L1 = 0.792 +- 0.147 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  0.41847375
Model XAI WIoU of binarized graphs for r=0.9 =  0.5185675000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.57
SUFF++ for r=0.9 class 0 = 0.888 +- 0.042 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 class 1 = 0.894 +- 0.042 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 class 2 = 0.889 +- 0.042 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 all KL = 0.967 +- 0.042 (in-sample avg dev_std = 0.187)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.097 (in-sample avg dev_std = 0.187)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.43689999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.4825125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.449
SUFF++ for r=0.3 class 0 = 0.702 +- 0.093 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.3 class 1 = 0.827 +- 0.093 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.3 class 2 = 0.707 +- 0.093 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.3 all KL = 0.874 +- 0.093 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.3 all L1 = 0.744 +- 0.143 (in-sample avg dev_std = 0.337)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.38317124999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.50286
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.45
SUFF++ for r=0.6 class 0 = 0.767 +- 0.111 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 class 1 = 0.772 +- 0.111 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 class 2 = 0.854 +- 0.111 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 all KL = 0.901 +- 0.111 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 all L1 = 0.799 +- 0.148 (in-sample avg dev_std = 0.287)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  0.409205
Model XAI WIoU of binarized graphs for r=0.9 =  0.50346
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.56
SUFF++ for r=0.9 class 0 = 0.89 +- 0.043 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 1 = 0.901 +- 0.043 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 2 = 0.885 +- 0.043 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all KL = 0.968 +- 0.043 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.096 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.1499925
Model XAI WIoU of binarized graphs for r=0.3 =  0.12748125000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.396
SUFF++ for r=0.3 class 0 = 0.73 +- 0.112 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 1 = 0.864 +- 0.112 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 2 = 0.727 +- 0.112 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all KL = 0.887 +- 0.112 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all L1 = 0.775 +- 0.129 (in-sample avg dev_std = 0.259)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.343
Model XAI F1 of binarized graphs for r=0.6 =  0.15981874999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.1007025
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.353
SUFF++ for r=0.6 class 0 = 0.863 +- 0.054 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 class 1 = 0.872 +- 0.054 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 class 2 = 0.886 +- 0.054 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 all KL = 0.957 +- 0.054 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.6 all L1 = 0.874 +- 0.086 (in-sample avg dev_std = 0.140)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.343
Model XAI F1 of binarized graphs for r=0.9 =  0.31467
Model XAI WIoU of binarized graphs for r=0.9 =  0.09241125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.346
SUFF++ for r=0.9 class 0 = 0.873 +- 0.041 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 class 1 = 0.9 +- 0.041 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 class 2 = 0.947 +- 0.041 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 all KL = 0.974 +- 0.041 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 all L1 = 0.907 +- 0.080 (in-sample avg dev_std = 0.072)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.448395
Model XAI WIoU of binarized graphs for r=0.3 =  0.49450249999999996
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.293
NEC for r=0.3 class 0 = 0.297 +- 0.146 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1 = 0.447 +- 0.146 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 2 = 0.141 +- 0.146 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.18 +- 0.146 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.296 +- 0.196 (in-sample avg dev_std = 0.320)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.3959
Model XAI WIoU of binarized graphs for r=0.6 =  0.51787125
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.375
NEC for r=0.6 class 0 = 0.258 +- 0.125 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 1 = 0.36 +- 0.125 (in-sample avg dev_std = 0.332)
NEC for r=0.6 class 2 = 0.164 +- 0.125 (in-sample avg dev_std = 0.332)
NEC for r=0.6 all KL = 0.146 +- 0.125 (in-sample avg dev_std = 0.332)
NEC for r=0.6 all L1 = 0.261 +- 0.155 (in-sample avg dev_std = 0.332)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  0.41847375
Model XAI WIoU of binarized graphs for r=0.9 =  0.5185675000000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.419
NEC for r=0.9 class 0 = 0.227 +- 0.096 (in-sample avg dev_std = 0.282)
NEC for r=0.9 class 1 = 0.293 +- 0.096 (in-sample avg dev_std = 0.282)
NEC for r=0.9 class 2 = 0.137 +- 0.096 (in-sample avg dev_std = 0.282)
NEC for r=0.9 all KL = 0.097 +- 0.096 (in-sample avg dev_std = 0.282)
NEC for r=0.9 all L1 = 0.22 +- 0.135 (in-sample avg dev_std = 0.282)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.635
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.5185675000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.419
NEC for r=1.0 class 0 = 0.207 +- 0.069 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 1 = 0.28 +- 0.069 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 2 = 0.123 +- 0.069 (in-sample avg dev_std = 0.261)
NEC for r=1.0 all KL = 0.079 +- 0.069 (in-sample avg dev_std = 0.261)
NEC for r=1.0 all L1 = 0.204 +- 0.126 (in-sample avg dev_std = 0.261)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.43689999999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.4825125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.295
NEC for r=0.3 class 0 = 0.303 +- 0.143 (in-sample avg dev_std = 0.324)
NEC for r=0.3 class 1 = 0.427 +- 0.143 (in-sample avg dev_std = 0.324)
NEC for r=0.3 class 2 = 0.149 +- 0.143 (in-sample avg dev_std = 0.324)
NEC for r=0.3 all KL = 0.175 +- 0.143 (in-sample avg dev_std = 0.324)
NEC for r=0.3 all L1 = 0.29 +- 0.194 (in-sample avg dev_std = 0.324)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.38317124999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.50286
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.362
NEC for r=0.6 class 0 = 0.272 +- 0.128 (in-sample avg dev_std = 0.327)
NEC for r=0.6 class 1 = 0.354 +- 0.128 (in-sample avg dev_std = 0.327)
NEC for r=0.6 class 2 = 0.16 +- 0.128 (in-sample avg dev_std = 0.327)
NEC for r=0.6 all KL = 0.145 +- 0.128 (in-sample avg dev_std = 0.327)
NEC for r=0.6 all L1 = 0.26 +- 0.160 (in-sample avg dev_std = 0.327)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  0.409205
Model XAI WIoU of binarized graphs for r=0.9 =  0.50346
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.407
NEC for r=0.9 class 0 = 0.226 +- 0.095 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 1 = 0.285 +- 0.095 (in-sample avg dev_std = 0.278)
NEC for r=0.9 class 2 = 0.139 +- 0.095 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all KL = 0.095 +- 0.095 (in-sample avg dev_std = 0.278)
NEC for r=0.9 all L1 = 0.215 +- 0.136 (in-sample avg dev_std = 0.278)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.626
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.50346
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.41
NEC for r=1.0 class 0 = 0.211 +- 0.072 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 1 = 0.278 +- 0.072 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 2 = 0.121 +- 0.072 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all KL = 0.078 +- 0.072 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all L1 = 0.202 +- 0.128 (in-sample avg dev_std = 0.257)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.1499925
Model XAI WIoU of binarized graphs for r=0.3 =  0.12748125000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.378
NEC for r=0.3 class 0 = 0.298 +- 0.100 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 1 = 0.216 +- 0.100 (in-sample avg dev_std = 0.276)
NEC for r=0.3 class 2 = 0.371 +- 0.100 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all KL = 0.154 +- 0.100 (in-sample avg dev_std = 0.276)
NEC for r=0.3 all L1 = 0.294 +- 0.136 (in-sample avg dev_std = 0.276)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.343
Model XAI F1 of binarized graphs for r=0.6 =  0.15981874999999998
Model XAI WIoU of binarized graphs for r=0.6 =  0.1007025
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.425
NEC for r=0.6 class 0 = 0.405 +- 0.180 (in-sample avg dev_std = 0.301)
NEC for r=0.6 class 1 = 0.219 +- 0.180 (in-sample avg dev_std = 0.301)
NEC for r=0.6 class 2 = 0.431 +- 0.180 (in-sample avg dev_std = 0.301)
NEC for r=0.6 all KL = 0.239 +- 0.180 (in-sample avg dev_std = 0.301)
NEC for r=0.6 all L1 = 0.35 +- 0.153 (in-sample avg dev_std = 0.301)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.343
Model XAI F1 of binarized graphs for r=0.9 =  0.31467
Model XAI WIoU of binarized graphs for r=0.9 =  0.09241125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.391
NEC for r=0.9 class 0 = 0.346 +- 0.145 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 1 = 0.243 +- 0.145 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 2 = 0.387 +- 0.145 (in-sample avg dev_std = 0.325)
NEC for r=0.9 all KL = 0.219 +- 0.145 (in-sample avg dev_std = 0.325)
NEC for r=0.9 all L1 = 0.324 +- 0.123 (in-sample avg dev_std = 0.325)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.343
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.0924025
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.385
NEC for r=1.0 class 0 = 0.334 +- 0.143 (in-sample avg dev_std = 0.323)
NEC for r=1.0 class 1 = 0.234 +- 0.143 (in-sample avg dev_std = 0.323)
NEC for r=1.0 class 2 = 0.381 +- 0.143 (in-sample avg dev_std = 0.323)
NEC for r=1.0 all KL = 0.212 +- 0.143 (in-sample avg dev_std = 0.323)
NEC for r=1.0 all L1 = 0.315 +- 0.121 (in-sample avg dev_std = 0.323)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:23:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:23:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.6308
Train Loss: 0.7895
ID Validation ACCURACY: 0.6420
ID Validation Loss: 0.7798
ID Test ACCURACY: 0.6163
ID Test Loss: 0.8117
OOD Validation ACCURACY: 0.6303
OOD Validation Loss: 0.7933
OOD Test ACCURACY: 0.5007
OOD Test Loss: 1.5765

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.6308
Train Loss: 0.7895
ID Validation ACCURACY: 0.6420
ID Validation Loss: 0.7798
ID Test ACCURACY: 0.6163
ID Test Loss: 0.8117
OOD Validation ACCURACY: 0.6303
OOD Validation Loss: 0.7933
OOD Test ACCURACY: 0.5007
OOD Test Loss: 1.5765

[0m[1;37mINFO[0m: [1mChartInfo 0.6163 0.5007 0.6163 0.5007 0.6420 0.6303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.452
WIoU for r=0.3 = 0.271
F1 for r=0.6 = 0.453
WIoU for r=0.6 = 0.272
F1 for r=0.9 = 0.440
WIoU for r=0.9 = 0.272
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.272
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.437
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.450
WIoU for r=0.6 = 0.266
F1 for r=0.9 = 0.433
WIoU for r=0.9 = 0.266
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.266
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.157
WIoU for r=0.3 = 0.224
F1 for r=0.6 = 0.175
WIoU for r=0.6 = 0.223
F1 for r=0.9 = 0.319
WIoU for r=0.9 = 0.222
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.222


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.45234375
Model XAI WIoU of binarized graphs for r=0.3 =  0.27082375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.447
SUFF++ for r=0.3 class 0 = 0.569 +- 0.219 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.736 +- 0.219 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.219 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.643 +- 0.219 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.635 +- 0.188 (in-sample avg dev_std = 0.608)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.45253
Model XAI WIoU of binarized graphs for r=0.6 =  0.27178375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.493
SUFF++ for r=0.6 class 0 = 0.663 +- 0.192 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 1 = 0.786 +- 0.192 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 2 = 0.647 +- 0.192 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all KL = 0.767 +- 0.192 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all L1 = 0.699 +- 0.193 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  0.4396875
Model XAI WIoU of binarized graphs for r=0.9 =  0.27178375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.544
SUFF++ for r=0.9 class 0 = 0.782 +- 0.116 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 1 = 0.85 +- 0.116 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 class 2 = 0.862 +- 0.116 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all KL = 0.901 +- 0.116 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.9 all L1 = 0.831 +- 0.152 (in-sample avg dev_std = 0.341)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.43724624999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.2647225
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.454
SUFF++ for r=0.3 class 0 = 0.578 +- 0.223 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.3 class 1 = 0.762 +- 0.223 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.3 class 2 = 0.599 +- 0.223 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.3 all KL = 0.657 +- 0.223 (in-sample avg dev_std = 0.602)
SUFF++ for r=0.3 all L1 = 0.645 +- 0.190 (in-sample avg dev_std = 0.602)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.45013625000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.265565
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.492
SUFF++ for r=0.6 class 0 = 0.659 +- 0.186 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 1 = 0.808 +- 0.186 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 2 = 0.669 +- 0.186 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all KL = 0.779 +- 0.186 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all L1 = 0.711 +- 0.188 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  0.4333225
Model XAI WIoU of binarized graphs for r=0.9 =  0.265565
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.531
SUFF++ for r=0.9 class 0 = 0.782 +- 0.117 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 1 = 0.868 +- 0.117 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 class 2 = 0.868 +- 0.117 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 all KL = 0.907 +- 0.117 (in-sample avg dev_std = 0.326)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.156 (in-sample avg dev_std = 0.326)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  0.15707375
Model XAI WIoU of binarized graphs for r=0.3 =  0.22365250000000003
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.418
SUFF++ for r=0.3 class 0 = 0.545 +- 0.230 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 class 1 = 0.811 +- 0.230 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 class 2 = 0.549 +- 0.230 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 all KL = 0.61 +- 0.230 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.3 all L1 = 0.637 +- 0.215 (in-sample avg dev_std = 0.548)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.502
Model XAI F1 of binarized graphs for r=0.6 =  0.17489124999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.22300125
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.447
SUFF++ for r=0.6 class 0 = 0.644 +- 0.205 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.772 +- 0.205 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.666 +- 0.205 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.731 +- 0.205 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.695 +- 0.165 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.499
Model XAI F1 of binarized graphs for r=0.9 =  0.31929375
Model XAI WIoU of binarized graphs for r=0.9 =  0.22211999999999998
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.467
SUFF++ for r=0.9 class 0 = 0.803 +- 0.116 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 1 = 0.819 +- 0.116 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 class 2 = 0.784 +- 0.116 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 all KL = 0.888 +- 0.116 (in-sample avg dev_std = 0.297)
SUFF++ for r=0.9 all L1 = 0.802 +- 0.147 (in-sample avg dev_std = 0.297)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.45234375
Model XAI WIoU of binarized graphs for r=0.3 =  0.27082375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.322
NEC for r=0.3 class 0 = 0.306 +- 0.356 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 1 = 0.632 +- 0.356 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 2 = 0.182 +- 0.356 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all KL = 0.404 +- 0.356 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all L1 = 0.375 +- 0.263 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.45253
Model XAI WIoU of binarized graphs for r=0.6 =  0.27178375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.388
NEC for r=0.6 class 0 = 0.27 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 1 = 0.525 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.6 class 2 = 0.15 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all KL = 0.295 +- 0.280 (in-sample avg dev_std = 0.460)
NEC for r=0.6 all L1 = 0.316 +- 0.239 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  0.4396875
Model XAI WIoU of binarized graphs for r=0.9 =  0.27178375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.405
NEC for r=0.9 class 0 = 0.272 +- 0.199 (in-sample avg dev_std = 0.427)
NEC for r=0.9 class 1 = 0.443 +- 0.199 (in-sample avg dev_std = 0.427)
NEC for r=0.9 class 2 = 0.154 +- 0.199 (in-sample avg dev_std = 0.427)
NEC for r=0.9 all KL = 0.218 +- 0.199 (in-sample avg dev_std = 0.427)
NEC for r=0.9 all L1 = 0.291 +- 0.209 (in-sample avg dev_std = 0.427)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.635
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.27178375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.397
NEC for r=1.0 class 0 = 0.27 +- 0.189 (in-sample avg dev_std = 0.415)
NEC for r=1.0 class 1 = 0.442 +- 0.189 (in-sample avg dev_std = 0.415)
NEC for r=1.0 class 2 = 0.15 +- 0.189 (in-sample avg dev_std = 0.415)
NEC for r=1.0 all KL = 0.206 +- 0.189 (in-sample avg dev_std = 0.415)
NEC for r=1.0 all L1 = 0.288 +- 0.205 (in-sample avg dev_std = 0.415)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.43724624999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.2647225
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.325
NEC for r=0.3 class 0 = 0.302 +- 0.353 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 1 = 0.608 +- 0.353 (in-sample avg dev_std = 0.490)
NEC for r=0.3 class 2 = 0.174 +- 0.353 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all KL = 0.385 +- 0.353 (in-sample avg dev_std = 0.490)
NEC for r=0.3 all L1 = 0.358 +- 0.262 (in-sample avg dev_std = 0.490)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.45013625000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.265565
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.267 +- 0.281 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 1 = 0.507 +- 0.281 (in-sample avg dev_std = 0.455)
NEC for r=0.6 class 2 = 0.144 +- 0.281 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all KL = 0.281 +- 0.281 (in-sample avg dev_std = 0.455)
NEC for r=0.6 all L1 = 0.302 +- 0.236 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  0.4333225
Model XAI WIoU of binarized graphs for r=0.9 =  0.265565
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.416
NEC for r=0.9 class 0 = 0.253 +- 0.198 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 1 = 0.422 +- 0.198 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 2 = 0.151 +- 0.198 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all KL = 0.204 +- 0.198 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all L1 = 0.273 +- 0.204 (in-sample avg dev_std = 0.419)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.626
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.265565
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.408
NEC for r=1.0 class 0 = 0.271 +- 0.187 (in-sample avg dev_std = 0.411)
NEC for r=1.0 class 1 = 0.421 +- 0.187 (in-sample avg dev_std = 0.411)
NEC for r=1.0 class 2 = 0.135 +- 0.187 (in-sample avg dev_std = 0.411)
NEC for r=1.0 all KL = 0.195 +- 0.187 (in-sample avg dev_std = 0.411)
NEC for r=1.0 all L1 = 0.273 +- 0.205 (in-sample avg dev_std = 0.411)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.505
Model XAI F1 of binarized graphs for r=0.3 =  0.15707375
Model XAI WIoU of binarized graphs for r=0.3 =  0.22365250000000003
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.358
NEC for r=0.3 class 0 = 0.399 +- 0.319 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 1 = 0.431 +- 0.319 (in-sample avg dev_std = 0.538)
NEC for r=0.3 class 2 = 0.334 +- 0.319 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all KL = 0.444 +- 0.319 (in-sample avg dev_std = 0.538)
NEC for r=0.3 all L1 = 0.388 +- 0.222 (in-sample avg dev_std = 0.538)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.502
Model XAI F1 of binarized graphs for r=0.6 =  0.17489124999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.22300125
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.409 +- 0.256 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 1 = 0.391 +- 0.256 (in-sample avg dev_std = 0.527)
NEC for r=0.6 class 2 = 0.404 +- 0.256 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all KL = 0.395 +- 0.256 (in-sample avg dev_std = 0.527)
NEC for r=0.6 all L1 = 0.401 +- 0.177 (in-sample avg dev_std = 0.527)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.499
Model XAI F1 of binarized graphs for r=0.9 =  0.31929375
Model XAI WIoU of binarized graphs for r=0.9 =  0.22211999999999998
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.398
NEC for r=0.9 class 0 = 0.4 +- 0.197 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 1 = 0.35 +- 0.197 (in-sample avg dev_std = 0.507)
NEC for r=0.9 class 2 = 0.359 +- 0.197 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all KL = 0.328 +- 0.197 (in-sample avg dev_std = 0.507)
NEC for r=0.9 all L1 = 0.369 +- 0.154 (in-sample avg dev_std = 0.507)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.499
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.22211875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.407
NEC for r=1.0 class 0 = 0.388 +- 0.189 (in-sample avg dev_std = 0.490)
NEC for r=1.0 class 1 = 0.338 +- 0.189 (in-sample avg dev_std = 0.490)
NEC for r=1.0 class 2 = 0.339 +- 0.189 (in-sample avg dev_std = 0.490)
NEC for r=1.0 all KL = 0.307 +- 0.189 (in-sample avg dev_std = 0.490)
NEC for r=1.0 all L1 = 0.354 +- 0.153 (in-sample avg dev_std = 0.490)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:26:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:26:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.6282
Train Loss: 0.8635
ID Validation ACCURACY: 0.6400
ID Validation Loss: 0.8324
ID Test ACCURACY: 0.6127
ID Test Loss: 0.9066
OOD Validation ACCURACY: 0.6110
OOD Validation Loss: 0.8932
OOD Test ACCURACY: 0.4260
OOD Test Loss: 2.9838

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.6282
Train Loss: 0.8635
ID Validation ACCURACY: 0.6400
ID Validation Loss: 0.8324
ID Test ACCURACY: 0.6127
ID Test Loss: 0.9066
OOD Validation ACCURACY: 0.6110
OOD Validation Loss: 0.8932
OOD Test ACCURACY: 0.4260
OOD Test Loss: 2.9838

[0m[1;37mINFO[0m: [1mChartInfo 0.6127 0.4260 0.6127 0.4260 0.6400 0.6110[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.480
WIoU for r=0.3 = 0.505
F1 for r=0.6 = 0.494
WIoU for r=0.6 = 0.533
F1 for r=0.9 = 0.450
WIoU for r=0.9 = 0.536
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.536
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.468
WIoU for r=0.3 = 0.488
F1 for r=0.6 = 0.490
WIoU for r=0.6 = 0.515
F1 for r=0.9 = 0.444
WIoU for r=0.9 = 0.518
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.518
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.146
WIoU for r=0.3 = 0.173
F1 for r=0.6 = 0.212
WIoU for r=0.6 = 0.167
F1 for r=0.9 = 0.353
WIoU for r=0.9 = 0.176
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.176


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.4795762499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5045175000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.451
SUFF++ for r=0.3 class 0 = 0.406 +- 0.349 (in-sample avg dev_std = 0.694)
SUFF++ for r=0.3 class 1 = 0.873 +- 0.349 (in-sample avg dev_std = 0.694)
SUFF++ for r=0.3 class 2 = 0.488 +- 0.349 (in-sample avg dev_std = 0.694)
SUFF++ for r=0.3 all KL = 0.475 +- 0.349 (in-sample avg dev_std = 0.694)
SUFF++ for r=0.3 all L1 = 0.59 +- 0.292 (in-sample avg dev_std = 0.694)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  0.4937474999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.53275875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.509
SUFF++ for r=0.6 class 0 = 0.551 +- 0.318 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.6 class 1 = 0.873 +- 0.318 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.6 class 2 = 0.583 +- 0.318 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.6 all KL = 0.615 +- 0.318 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.6 all L1 = 0.67 +- 0.255 (in-sample avg dev_std = 0.589)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  0.45037875
Model XAI WIoU of binarized graphs for r=0.9 =  0.5360375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.572
SUFF++ for r=0.9 class 0 = 0.772 +- 0.218 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.9 class 1 = 0.851 +- 0.218 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.9 class 2 = 0.771 +- 0.218 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.9 all KL = 0.802 +- 0.218 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.172 (in-sample avg dev_std = 0.430)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.4677075
Model XAI WIoU of binarized graphs for r=0.3 =  0.4876225
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.443
SUFF++ for r=0.3 class 0 = 0.403 +- 0.338 (in-sample avg dev_std = 0.717)
SUFF++ for r=0.3 class 1 = 0.875 +- 0.338 (in-sample avg dev_std = 0.717)
SUFF++ for r=0.3 class 2 = 0.487 +- 0.338 (in-sample avg dev_std = 0.717)
SUFF++ for r=0.3 all KL = 0.465 +- 0.338 (in-sample avg dev_std = 0.717)
SUFF++ for r=0.3 all L1 = 0.586 +- 0.280 (in-sample avg dev_std = 0.717)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.49044375
Model XAI WIoU of binarized graphs for r=0.6 =  0.51481
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.497
SUFF++ for r=0.6 class 0 = 0.547 +- 0.324 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.6 class 1 = 0.875 +- 0.324 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.6 class 2 = 0.574 +- 0.324 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.6 all KL = 0.606 +- 0.324 (in-sample avg dev_std = 0.595)
SUFF++ for r=0.6 all L1 = 0.663 +- 0.261 (in-sample avg dev_std = 0.595)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.44384999999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.517545
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.558
SUFF++ for r=0.9 class 0 = 0.778 +- 0.221 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 1 = 0.843 +- 0.221 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 class 2 = 0.782 +- 0.221 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 all KL = 0.806 +- 0.221 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.9 all L1 = 0.801 +- 0.177 (in-sample avg dev_std = 0.426)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.426
Model XAI F1 of binarized graphs for r=0.3 =  0.14634875
Model XAI WIoU of binarized graphs for r=0.3 =  0.17257625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.388
SUFF++ for r=0.3 class 0 = 0.593 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 1 = 0.799 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 2 = 0.592 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all KL = 0.579 +- 0.323 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all L1 = 0.663 +- 0.200 (in-sample avg dev_std = 0.530)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.409
Model XAI F1 of binarized graphs for r=0.6 =  0.2118
Model XAI WIoU of binarized graphs for r=0.6 =  0.16707750000000002
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.443
SUFF++ for r=0.6 class 0 = 0.592 +- 0.243 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 1 = 0.785 +- 0.243 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 2 = 0.715 +- 0.243 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all KL = 0.698 +- 0.243 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all L1 = 0.699 +- 0.178 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.42
Model XAI F1 of binarized graphs for r=0.9 =  0.35333375000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.17589125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.466
SUFF++ for r=0.9 class 0 = 0.554 +- 0.304 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.9 class 1 = 0.777 +- 0.304 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.9 class 2 = 0.835 +- 0.304 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.9 all KL = 0.734 +- 0.304 (in-sample avg dev_std = 0.358)
SUFF++ for r=0.9 all L1 = 0.724 +- 0.211 (in-sample avg dev_std = 0.358)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.635
Model XAI F1 of binarized graphs for r=0.3 =  0.4795762499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5045175000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.376 +- 0.347 (in-sample avg dev_std = 0.748)
NEC for r=0.3 class 1 = 0.649 +- 0.347 (in-sample avg dev_std = 0.748)
NEC for r=0.3 class 2 = 0.314 +- 0.347 (in-sample avg dev_std = 0.748)
NEC for r=0.3 all KL = 0.593 +- 0.347 (in-sample avg dev_std = 0.748)
NEC for r=0.3 all L1 = 0.448 +- 0.262 (in-sample avg dev_std = 0.748)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  0.4937474999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.53275875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.438 +- 0.295 (in-sample avg dev_std = 0.751)
NEC for r=0.6 class 1 = 0.524 +- 0.295 (in-sample avg dev_std = 0.751)
NEC for r=0.6 class 2 = 0.29 +- 0.295 (in-sample avg dev_std = 0.751)
NEC for r=0.6 all KL = 0.543 +- 0.295 (in-sample avg dev_std = 0.751)
NEC for r=0.6 all L1 = 0.418 +- 0.221 (in-sample avg dev_std = 0.751)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.632
Model XAI F1 of binarized graphs for r=0.9 =  0.45037875
Model XAI WIoU of binarized graphs for r=0.9 =  0.5360375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.438
NEC for r=0.9 class 0 = 0.388 +- 0.261 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 1 = 0.469 +- 0.261 (in-sample avg dev_std = 0.644)
NEC for r=0.9 class 2 = 0.252 +- 0.261 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all KL = 0.417 +- 0.261 (in-sample avg dev_std = 0.644)
NEC for r=0.9 all L1 = 0.37 +- 0.206 (in-sample avg dev_std = 0.644)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.631
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.5360375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.441
NEC for r=1.0 class 0 = 0.38 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 class 1 = 0.453 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 class 2 = 0.236 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 all KL = 0.388 +- 0.251 (in-sample avg dev_std = 0.619)
NEC for r=1.0 all L1 = 0.357 +- 0.204 (in-sample avg dev_std = 0.619)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  0.4677075
Model XAI WIoU of binarized graphs for r=0.3 =  0.4876225
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.361
NEC for r=0.3 class 0 = 0.376 +- 0.351 (in-sample avg dev_std = 0.734)
NEC for r=0.3 class 1 = 0.631 +- 0.351 (in-sample avg dev_std = 0.734)
NEC for r=0.3 class 2 = 0.303 +- 0.351 (in-sample avg dev_std = 0.734)
NEC for r=0.3 all KL = 0.577 +- 0.351 (in-sample avg dev_std = 0.734)
NEC for r=0.3 all L1 = 0.433 +- 0.265 (in-sample avg dev_std = 0.734)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.49044375
Model XAI WIoU of binarized graphs for r=0.6 =  0.51481
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.4
NEC for r=0.6 class 0 = 0.439 +- 0.301 (in-sample avg dev_std = 0.733)
NEC for r=0.6 class 1 = 0.502 +- 0.301 (in-sample avg dev_std = 0.733)
NEC for r=0.6 class 2 = 0.302 +- 0.301 (in-sample avg dev_std = 0.733)
NEC for r=0.6 all KL = 0.532 +- 0.301 (in-sample avg dev_std = 0.733)
NEC for r=0.6 all L1 = 0.412 +- 0.226 (in-sample avg dev_std = 0.733)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.44384999999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.517545
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.425
NEC for r=0.9 class 0 = 0.397 +- 0.273 (in-sample avg dev_std = 0.641)
NEC for r=0.9 class 1 = 0.455 +- 0.273 (in-sample avg dev_std = 0.641)
NEC for r=0.9 class 2 = 0.257 +- 0.273 (in-sample avg dev_std = 0.641)
NEC for r=0.9 all KL = 0.417 +- 0.273 (in-sample avg dev_std = 0.641)
NEC for r=0.9 all L1 = 0.367 +- 0.216 (in-sample avg dev_std = 0.641)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.623
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.517545
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.426
NEC for r=1.0 class 0 = 0.386 +- 0.258 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 1 = 0.457 +- 0.258 (in-sample avg dev_std = 0.617)
NEC for r=1.0 class 2 = 0.232 +- 0.258 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all KL = 0.39 +- 0.258 (in-sample avg dev_std = 0.617)
NEC for r=1.0 all L1 = 0.356 +- 0.209 (in-sample avg dev_std = 0.617)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.426
Model XAI F1 of binarized graphs for r=0.3 =  0.14634875
Model XAI WIoU of binarized graphs for r=0.3 =  0.17257625
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.472
NEC for r=0.3 class 0 = 0.655 +- 0.340 (in-sample avg dev_std = 0.454)
NEC for r=0.3 class 1 = 0.367 +- 0.340 (in-sample avg dev_std = 0.454)
NEC for r=0.3 class 2 = 0.647 +- 0.340 (in-sample avg dev_std = 0.454)
NEC for r=0.3 all KL = 0.594 +- 0.340 (in-sample avg dev_std = 0.454)
NEC for r=0.3 all L1 = 0.554 +- 0.240 (in-sample avg dev_std = 0.454)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.409
Model XAI F1 of binarized graphs for r=0.6 =  0.2118
Model XAI WIoU of binarized graphs for r=0.6 =  0.16707750000000002
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.426
NEC for r=0.6 class 0 = 0.547 +- 0.360 (in-sample avg dev_std = 0.618)
NEC for r=0.6 class 1 = 0.374 +- 0.360 (in-sample avg dev_std = 0.618)
NEC for r=0.6 class 2 = 0.58 +- 0.360 (in-sample avg dev_std = 0.618)
NEC for r=0.6 all KL = 0.537 +- 0.360 (in-sample avg dev_std = 0.618)
NEC for r=0.6 all L1 = 0.499 +- 0.203 (in-sample avg dev_std = 0.618)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.419
Model XAI F1 of binarized graphs for r=0.9 =  0.35333375000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.17589125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.445
NEC for r=0.9 class 0 = 0.507 +- 0.363 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 1 = 0.337 +- 0.363 (in-sample avg dev_std = 0.625)
NEC for r=0.9 class 2 = 0.549 +- 0.363 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all KL = 0.516 +- 0.363 (in-sample avg dev_std = 0.625)
NEC for r=0.9 all L1 = 0.463 +- 0.190 (in-sample avg dev_std = 0.625)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.42
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.17588749999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.452
NEC for r=1.0 class 0 = 0.495 +- 0.351 (in-sample avg dev_std = 0.621)
NEC for r=1.0 class 1 = 0.344 +- 0.351 (in-sample avg dev_std = 0.621)
NEC for r=1.0 class 2 = 0.539 +- 0.351 (in-sample avg dev_std = 0.621)
NEC for r=1.0 all KL = 0.512 +- 0.351 (in-sample avg dev_std = 0.621)
NEC for r=1.0 all L1 = 0.458 +- 0.177 (in-sample avg dev_std = 0.621)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:30:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:30:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ACCURACY: 0.7819
Train Loss: 0.6725
ID Validation ACCURACY: 0.7790
ID Validation Loss: 0.6938
ID Test ACCURACY: 0.7720
ID Test Loss: 0.7083
OOD Validation ACCURACY: 0.7353
OOD Validation Loss: 0.7452
OOD Test ACCURACY: 0.5947
OOD Test Loss: 1.4849

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.7207
Train Loss: 0.7109
ID Validation ACCURACY: 0.7390
ID Validation Loss: 0.6992
ID Test ACCURACY: 0.7180
ID Test Loss: 0.7203
OOD Validation ACCURACY: 0.8057
OOD Validation Loss: 0.6672
OOD Test ACCURACY: 0.8347
OOD Test Loss: 0.6731

[0m[1;37mINFO[0m: [1mChartInfo 0.7720 0.5947 0.7180 0.8347 0.7390 0.8057[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.673
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.597
WIoU for r=0.6 = 0.712
F1 for r=0.9 = 0.471
WIoU for r=0.9 = 0.714
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.714
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.663
WIoU for r=0.3 = 0.636
F1 for r=0.6 = 0.600
WIoU for r=0.6 = 0.699
F1 for r=0.9 = 0.467
WIoU for r=0.9 = 0.701
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.701
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.550
WIoU for r=0.3 = 0.555
F1 for r=0.6 = 0.428
WIoU for r=0.6 = 0.555
F1 for r=0.9 = 0.395
WIoU for r=0.9 = 0.573
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.574


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.475
Model XAI F1 of binarized graphs for r=0.3 =  0.6728575000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6531174999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.409
SUFF++ for r=0.3 class 0 = 0.576 +- 0.206 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 class 1 = 0.676 +- 0.206 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 class 2 = 0.613 +- 0.206 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all KL = 0.765 +- 0.206 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all L1 = 0.622 +- 0.139 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.589
Model XAI F1 of binarized graphs for r=0.6 =  0.5968375
Model XAI WIoU of binarized graphs for r=0.6 =  0.71202
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.528
SUFF++ for r=0.6 class 0 = 0.556 +- 0.227 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 1 = 0.609 +- 0.227 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 2 = 0.507 +- 0.227 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all KL = 0.675 +- 0.227 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all L1 = 0.558 +- 0.136 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  0.471395
Model XAI WIoU of binarized graphs for r=0.9 =  0.7143275
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.706
SUFF++ for r=0.9 class 0 = 0.735 +- 0.171 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 1 = 0.731 +- 0.171 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 2 = 0.719 +- 0.171 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all KL = 0.842 +- 0.171 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all L1 = 0.729 +- 0.165 (in-sample avg dev_std = 0.294)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.472
Model XAI F1 of binarized graphs for r=0.3 =  0.6628075
Model XAI WIoU of binarized graphs for r=0.3 =  0.6360662499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.407
SUFF++ for r=0.3 class 0 = 0.573 +- 0.193 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 class 1 = 0.684 +- 0.193 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 class 2 = 0.625 +- 0.193 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all KL = 0.772 +- 0.193 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all L1 = 0.627 +- 0.135 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.599
Model XAI F1 of binarized graphs for r=0.6 =  0.6003937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.6986199999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.528
SUFF++ for r=0.6 class 0 = 0.541 +- 0.224 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 class 1 = 0.606 +- 0.224 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 class 2 = 0.544 +- 0.224 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 all KL = 0.676 +- 0.224 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 all L1 = 0.563 +- 0.146 (in-sample avg dev_std = 0.392)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.702
Model XAI F1 of binarized graphs for r=0.9 =  0.46737875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7009025
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0 = 0.719 +- 0.172 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 1 = 0.722 +- 0.172 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 2 = 0.72 +- 0.172 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all KL = 0.837 +- 0.172 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all L1 = 0.72 +- 0.173 (in-sample avg dev_std = 0.293)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  0.5504875
Model XAI WIoU of binarized graphs for r=0.3 =  0.5547375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.508
SUFF++ for r=0.3 class 0 = 0.617 +- 0.173 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 1 = 0.718 +- 0.173 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 2 = 0.641 +- 0.173 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 all KL = 0.782 +- 0.173 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 all L1 = 0.66 +- 0.125 (in-sample avg dev_std = 0.393)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  0.42793375000000006
Model XAI WIoU of binarized graphs for r=0.6 =  0.5549262500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.56
SUFF++ for r=0.6 class 0 = 0.559 +- 0.231 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 1 = 0.628 +- 0.231 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 class 2 = 0.53 +- 0.231 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all KL = 0.659 +- 0.231 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.6 all L1 = 0.573 +- 0.151 (in-sample avg dev_std = 0.425)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.584
Model XAI F1 of binarized graphs for r=0.9 =  0.39506875
Model XAI WIoU of binarized graphs for r=0.9 =  0.5731
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.627
SUFF++ for r=0.9 class 0 = 0.658 +- 0.335 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.335 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 class 2 = 0.63 +- 0.335 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 all KL = 0.701 +- 0.335 (in-sample avg dev_std = 0.340)
SUFF++ for r=0.9 all L1 = 0.672 +- 0.241 (in-sample avg dev_std = 0.340)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.477
Model XAI F1 of binarized graphs for r=0.3 =  0.6728575000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.6531174999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.378
NEC for r=0.3 class 0 = 0.423 +- 0.237 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 1 = 0.221 +- 0.237 (in-sample avg dev_std = 0.236)
NEC for r=0.3 class 2 = 0.377 +- 0.237 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all KL = 0.198 +- 0.237 (in-sample avg dev_std = 0.236)
NEC for r=0.3 all L1 = 0.34 +- 0.180 (in-sample avg dev_std = 0.236)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.59
Model XAI F1 of binarized graphs for r=0.6 =  0.5968375
Model XAI WIoU of binarized graphs for r=0.6 =  0.71202
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.45
NEC for r=0.6 class 0 = 0.479 +- 0.258 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 1 = 0.338 +- 0.258 (in-sample avg dev_std = 0.334)
NEC for r=0.6 class 2 = 0.515 +- 0.258 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all KL = 0.323 +- 0.258 (in-sample avg dev_std = 0.334)
NEC for r=0.6 all L1 = 0.443 +- 0.160 (in-sample avg dev_std = 0.334)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.729
Model XAI F1 of binarized graphs for r=0.9 =  0.471395
Model XAI WIoU of binarized graphs for r=0.9 =  0.7143275
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.457 +- 0.266 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 1 = 0.348 +- 0.266 (in-sample avg dev_std = 0.393)
NEC for r=0.9 class 2 = 0.524 +- 0.266 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all KL = 0.342 +- 0.266 (in-sample avg dev_std = 0.393)
NEC for r=0.9 all L1 = 0.443 +- 0.155 (in-sample avg dev_std = 0.393)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.783
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.71432375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.529
NEC for r=1.0 class 0 = 0.454 +- 0.299 (in-sample avg dev_std = 0.404)
NEC for r=1.0 class 1 = 0.372 +- 0.299 (in-sample avg dev_std = 0.404)
NEC for r=1.0 class 2 = 0.529 +- 0.299 (in-sample avg dev_std = 0.404)
NEC for r=1.0 all KL = 0.375 +- 0.299 (in-sample avg dev_std = 0.404)
NEC for r=1.0 all L1 = 0.451 +- 0.168 (in-sample avg dev_std = 0.404)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.471
Model XAI F1 of binarized graphs for r=0.3 =  0.6628075
Model XAI WIoU of binarized graphs for r=0.3 =  0.6360662499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.365
NEC for r=0.3 class 0 = 0.421 +- 0.233 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 1 = 0.231 +- 0.233 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 2 = 0.389 +- 0.233 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all KL = 0.205 +- 0.233 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all L1 = 0.349 +- 0.178 (in-sample avg dev_std = 0.245)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.591
Model XAI F1 of binarized graphs for r=0.6 =  0.6003937500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.6986199999999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.441
NEC for r=0.6 class 0 = 0.498 +- 0.265 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 1 = 0.342 +- 0.265 (in-sample avg dev_std = 0.347)
NEC for r=0.6 class 2 = 0.517 +- 0.265 (in-sample avg dev_std = 0.347)
NEC for r=0.6 all KL = 0.34 +- 0.265 (in-sample avg dev_std = 0.347)
NEC for r=0.6 all L1 = 0.454 +- 0.163 (in-sample avg dev_std = 0.347)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  0.46737875
Model XAI WIoU of binarized graphs for r=0.9 =  0.7009025
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.496
NEC for r=0.9 class 0 = 0.46 +- 0.268 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 1 = 0.361 +- 0.268 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 2 = 0.529 +- 0.268 (in-sample avg dev_std = 0.402)
NEC for r=0.9 all KL = 0.353 +- 0.268 (in-sample avg dev_std = 0.402)
NEC for r=0.9 all L1 = 0.451 +- 0.157 (in-sample avg dev_std = 0.402)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.751
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7008987499999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.528
NEC for r=1.0 class 0 = 0.445 +- 0.299 (in-sample avg dev_std = 0.397)
NEC for r=1.0 class 1 = 0.388 +- 0.299 (in-sample avg dev_std = 0.397)
NEC for r=1.0 class 2 = 0.525 +- 0.299 (in-sample avg dev_std = 0.397)
NEC for r=1.0 all KL = 0.379 +- 0.299 (in-sample avg dev_std = 0.397)
NEC for r=1.0 all L1 = 0.454 +- 0.174 (in-sample avg dev_std = 0.397)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.56
Model XAI F1 of binarized graphs for r=0.3 =  0.5504875
Model XAI WIoU of binarized graphs for r=0.3 =  0.5547375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.416
NEC for r=0.3 class 0 = 0.388 +- 0.259 (in-sample avg dev_std = 0.305)
NEC for r=0.3 class 1 = 0.218 +- 0.259 (in-sample avg dev_std = 0.305)
NEC for r=0.3 class 2 = 0.345 +- 0.259 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all KL = 0.227 +- 0.259 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all L1 = 0.315 +- 0.219 (in-sample avg dev_std = 0.305)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  0.42793375000000006
Model XAI WIoU of binarized graphs for r=0.6 =  0.5549262500000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.564
NEC for r=0.6 class 0 = 0.468 +- 0.280 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 1 = 0.296 +- 0.280 (in-sample avg dev_std = 0.381)
NEC for r=0.6 class 2 = 0.539 +- 0.280 (in-sample avg dev_std = 0.381)
NEC for r=0.6 all KL = 0.355 +- 0.280 (in-sample avg dev_std = 0.381)
NEC for r=0.6 all L1 = 0.433 +- 0.191 (in-sample avg dev_std = 0.381)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.584
Model XAI F1 of binarized graphs for r=0.9 =  0.39506875
Model XAI WIoU of binarized graphs for r=0.9 =  0.5731
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.588
NEC for r=0.9 class 0 = 0.424 +- 0.354 (in-sample avg dev_std = 0.437)
NEC for r=0.9 class 1 = 0.312 +- 0.354 (in-sample avg dev_std = 0.437)
NEC for r=0.9 class 2 = 0.541 +- 0.354 (in-sample avg dev_std = 0.437)
NEC for r=0.9 all KL = 0.388 +- 0.354 (in-sample avg dev_std = 0.437)
NEC for r=0.9 all L1 = 0.425 +- 0.228 (in-sample avg dev_std = 0.437)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.584
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.5735862500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.6
NEC for r=1.0 class 0 = 0.388 +- 0.349 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 1 = 0.336 +- 0.349 (in-sample avg dev_std = 0.431)
NEC for r=1.0 class 2 = 0.52 +- 0.349 (in-sample avg dev_std = 0.431)
NEC for r=1.0 all KL = 0.359 +- 0.349 (in-sample avg dev_std = 0.431)
NEC for r=1.0 all L1 = 0.415 +- 0.228 (in-sample avg dev_std = 0.431)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:33:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:33:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.6287
Train Loss: 0.8293
ID Validation ACCURACY: 0.6390
ID Validation Loss: 0.8255
ID Test ACCURACY: 0.6337
ID Test Loss: 0.8342
OOD Validation ACCURACY: 0.7670
OOD Validation Loss: 0.7514
OOD Test ACCURACY: 0.5217
OOD Test Loss: 0.9256

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.6287
Train Loss: 0.8293
ID Validation ACCURACY: 0.6390
ID Validation Loss: 0.8255
ID Test ACCURACY: 0.6337
ID Test Loss: 0.8342
OOD Validation ACCURACY: 0.7670
OOD Validation Loss: 0.7514
OOD Test ACCURACY: 0.5217
OOD Test Loss: 0.9256

[0m[1;37mINFO[0m: [1mChartInfo 0.6337 0.5217 0.6337 0.5217 0.6390 0.7670[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.470
WIoU for r=0.3 = 0.410
F1 for r=0.6 = 0.434
WIoU for r=0.6 = 0.440
F1 for r=0.9 = 0.429
WIoU for r=0.9 = 0.442
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.442
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.474
WIoU for r=0.3 = 0.418
F1 for r=0.6 = 0.435
WIoU for r=0.6 = 0.448
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.450
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.450
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.496
WIoU for r=0.3 = 0.558
F1 for r=0.6 = 0.411
WIoU for r=0.6 = 0.578
F1 for r=0.9 = 0.369
WIoU for r=0.9 = 0.578
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.578


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  0.47031625
Model XAI WIoU of binarized graphs for r=0.3 =  0.40969624999999993
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.463
SUFF++ for r=0.3 class 0 = 0.652 +- 0.225 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 class 1 = 0.722 +- 0.225 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 class 2 = 0.538 +- 0.225 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 all KL = 0.708 +- 0.225 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.183 (in-sample avg dev_std = 0.436)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.621
Model XAI F1 of binarized graphs for r=0.6 =  0.43443125000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.44008
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.532
SUFF++ for r=0.6 class 0 = 0.73 +- 0.208 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 1 = 0.785 +- 0.208 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 2 = 0.636 +- 0.208 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 all KL = 0.813 +- 0.208 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 all L1 = 0.718 +- 0.179 (in-sample avg dev_std = 0.329)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.4285062500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.44199625000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.605
SUFF++ for r=0.9 class 0 = 0.817 +- 0.110 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1 = 0.918 +- 0.110 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 2 = 0.787 +- 0.110 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.928 +- 0.110 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.841 +- 0.140 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.511
Model XAI F1 of binarized graphs for r=0.3 =  0.47424124999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.41759124999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.46
SUFF++ for r=0.3 class 0 = 0.644 +- 0.224 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 class 1 = 0.715 +- 0.224 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 class 2 = 0.528 +- 0.224 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 all KL = 0.696 +- 0.224 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 all L1 = 0.627 +- 0.182 (in-sample avg dev_std = 0.449)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.616
Model XAI F1 of binarized graphs for r=0.6 =  0.43521875
Model XAI WIoU of binarized graphs for r=0.6 =  0.4484425
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.525
SUFF++ for r=0.6 class 0 = 0.713 +- 0.208 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.6 class 1 = 0.765 +- 0.208 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.6 class 2 = 0.653 +- 0.208 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.6 all KL = 0.805 +- 0.208 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.6 all L1 = 0.709 +- 0.173 (in-sample avg dev_std = 0.342)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.626
Model XAI F1 of binarized graphs for r=0.9 =  0.421995
Model XAI WIoU of binarized graphs for r=0.9 =  0.449975
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.593
SUFF++ for r=0.9 class 0 = 0.818 +- 0.106 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 class 1 = 0.91 +- 0.106 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 class 2 = 0.804 +- 0.106 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 all KL = 0.931 +- 0.106 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.9 all L1 = 0.843 +- 0.136 (in-sample avg dev_std = 0.212)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.429
Model XAI F1 of binarized graphs for r=0.3 =  0.49565
Model XAI WIoU of binarized graphs for r=0.3 =  0.558335
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.686 +- 0.178 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 1 = 0.68 +- 0.178 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 2 = 0.6 +- 0.178 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 all KL = 0.735 +- 0.178 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 all L1 = 0.655 +- 0.152 (in-sample avg dev_std = 0.491)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.506
Model XAI F1 of binarized graphs for r=0.6 =  0.41071874999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.57823375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.506
SUFF++ for r=0.6 class 0 = 0.696 +- 0.133 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 1 = 0.793 +- 0.133 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 class 2 = 0.683 +- 0.133 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 all KL = 0.833 +- 0.133 (in-sample avg dev_std = 0.402)
SUFF++ for r=0.6 all L1 = 0.725 +- 0.151 (in-sample avg dev_std = 0.402)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.506
Model XAI F1 of binarized graphs for r=0.9 =  0.36909624999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.57823375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.535
SUFF++ for r=0.9 class 0 = 0.902 +- 0.064 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 class 1 = 0.91 +- 0.064 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 class 2 = 0.836 +- 0.064 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all KL = 0.955 +- 0.064 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.9 all L1 = 0.883 +- 0.124 (in-sample avg dev_std = 0.208)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.519
Model XAI F1 of binarized graphs for r=0.3 =  0.47031625
Model XAI WIoU of binarized graphs for r=0.3 =  0.40969624999999993
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.363
NEC for r=0.3 class 0 = 0.285 +- 0.355 (in-sample avg dev_std = 0.288)
NEC for r=0.3 class 1 = 0.209 +- 0.355 (in-sample avg dev_std = 0.288)
NEC for r=0.3 class 2 = 0.623 +- 0.355 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all KL = 0.37 +- 0.355 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all L1 = 0.371 +- 0.253 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.623
Model XAI F1 of binarized graphs for r=0.6 =  0.43443125000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.44008
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.418
NEC for r=0.6 class 0 = 0.226 +- 0.323 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 1 = 0.172 +- 0.323 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 2 = 0.552 +- 0.323 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all KL = 0.286 +- 0.323 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all L1 = 0.315 +- 0.229 (in-sample avg dev_std = 0.287)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.4285062500000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.44199625000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.456
NEC for r=0.9 class 0 = 0.196 +- 0.268 (in-sample avg dev_std = 0.266)
NEC for r=0.9 class 1 = 0.137 +- 0.268 (in-sample avg dev_std = 0.266)
NEC for r=0.9 class 2 = 0.488 +- 0.268 (in-sample avg dev_std = 0.266)
NEC for r=0.9 all KL = 0.21 +- 0.268 (in-sample avg dev_std = 0.266)
NEC for r=0.9 all L1 = 0.273 +- 0.215 (in-sample avg dev_std = 0.266)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.635
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.44199625000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.45
NEC for r=1.0 class 0 = 0.187 +- 0.254 (in-sample avg dev_std = 0.256)
NEC for r=1.0 class 1 = 0.135 +- 0.254 (in-sample avg dev_std = 0.256)
NEC for r=1.0 class 2 = 0.472 +- 0.254 (in-sample avg dev_std = 0.256)
NEC for r=1.0 all KL = 0.191 +- 0.254 (in-sample avg dev_std = 0.256)
NEC for r=1.0 all L1 = 0.264 +- 0.210 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  0.47424124999999995
Model XAI WIoU of binarized graphs for r=0.3 =  0.41759124999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.357
NEC for r=0.3 class 0 = 0.295 +- 0.355 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 1 = 0.219 +- 0.355 (in-sample avg dev_std = 0.292)
NEC for r=0.3 class 2 = 0.615 +- 0.355 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all KL = 0.376 +- 0.355 (in-sample avg dev_std = 0.292)
NEC for r=0.3 all L1 = 0.381 +- 0.251 (in-sample avg dev_std = 0.292)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  0.43521875
Model XAI WIoU of binarized graphs for r=0.6 =  0.4484425
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.237 +- 0.325 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 1 = 0.164 +- 0.325 (in-sample avg dev_std = 0.290)
NEC for r=0.6 class 2 = 0.546 +- 0.325 (in-sample avg dev_std = 0.290)
NEC for r=0.6 all KL = 0.291 +- 0.325 (in-sample avg dev_std = 0.290)
NEC for r=0.6 all L1 = 0.32 +- 0.230 (in-sample avg dev_std = 0.290)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.625
Model XAI F1 of binarized graphs for r=0.9 =  0.421995
Model XAI WIoU of binarized graphs for r=0.9 =  0.449975
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.44
NEC for r=0.9 class 0 = 0.207 +- 0.275 (in-sample avg dev_std = 0.276)
NEC for r=0.9 class 1 = 0.141 +- 0.275 (in-sample avg dev_std = 0.276)
NEC for r=0.9 class 2 = 0.475 +- 0.275 (in-sample avg dev_std = 0.276)
NEC for r=0.9 all KL = 0.218 +- 0.275 (in-sample avg dev_std = 0.276)
NEC for r=0.9 all L1 = 0.278 +- 0.216 (in-sample avg dev_std = 0.276)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.637
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.449975
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.452
NEC for r=1.0 class 0 = 0.202 +- 0.257 (in-sample avg dev_std = 0.258)
NEC for r=1.0 class 1 = 0.125 +- 0.257 (in-sample avg dev_std = 0.258)
NEC for r=1.0 class 2 = 0.462 +- 0.257 (in-sample avg dev_std = 0.258)
NEC for r=1.0 all KL = 0.196 +- 0.257 (in-sample avg dev_std = 0.258)
NEC for r=1.0 all L1 = 0.267 +- 0.212 (in-sample avg dev_std = 0.258)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.429
Model XAI F1 of binarized graphs for r=0.3 =  0.49565
Model XAI WIoU of binarized graphs for r=0.3 =  0.558335
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.349
NEC for r=0.3 class 0 = 0.169 +- 0.376 (in-sample avg dev_std = 0.295)
NEC for r=0.3 class 1 = 0.174 +- 0.376 (in-sample avg dev_std = 0.295)
NEC for r=0.3 class 2 = 0.631 +- 0.376 (in-sample avg dev_std = 0.295)
NEC for r=0.3 all KL = 0.346 +- 0.376 (in-sample avg dev_std = 0.295)
NEC for r=0.3 all L1 = 0.325 +- 0.285 (in-sample avg dev_std = 0.295)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.506
Model XAI F1 of binarized graphs for r=0.6 =  0.41071874999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.57823375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.39
NEC for r=0.6 class 0 = 0.165 +- 0.288 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 1 = 0.164 +- 0.288 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 2 = 0.507 +- 0.288 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all KL = 0.26 +- 0.288 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all L1 = 0.279 +- 0.229 (in-sample avg dev_std = 0.331)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.506
Model XAI F1 of binarized graphs for r=0.9 =  0.36909624999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.57823375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.439
NEC for r=0.9 class 0 = 0.142 +- 0.202 (in-sample avg dev_std = 0.284)
NEC for r=0.9 class 1 = 0.118 +- 0.202 (in-sample avg dev_std = 0.284)
NEC for r=0.9 class 2 = 0.378 +- 0.202 (in-sample avg dev_std = 0.284)
NEC for r=0.9 all KL = 0.159 +- 0.202 (in-sample avg dev_std = 0.284)
NEC for r=0.9 all L1 = 0.212 +- 0.183 (in-sample avg dev_std = 0.284)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.506
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.57823375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.444
NEC for r=1.0 class 0 = 0.147 +- 0.171 (in-sample avg dev_std = 0.281)
NEC for r=1.0 class 1 = 0.114 +- 0.171 (in-sample avg dev_std = 0.281)
NEC for r=1.0 class 2 = 0.371 +- 0.171 (in-sample avg dev_std = 0.281)
NEC for r=1.0 all KL = 0.144 +- 0.171 (in-sample avg dev_std = 0.281)
NEC for r=1.0 all L1 = 0.211 +- 0.180 (in-sample avg dev_std = 0.281)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.88, 0.896, 0.967, 1.0], 'all_L1': [0.753, 0.792, 0.89, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.767, 0.901, 1.0], 'all_L1': [0.635, 0.699, 0.831, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.475, 0.615, 0.802, 1.0], 'all_L1': [0.59, 0.67, 0.798, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.675, 0.842, 1.0], 'all_L1': [0.622, 0.558, 0.729, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.813, 0.928, 1.0], 'all_L1': [0.638, 0.718, 0.841, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.18, 0.146, 0.097, 0.079], 'all_L1': [0.296, 0.261, 0.22, 0.204]}), defaultdict(<class 'list'>, {'all_KL': [0.404, 0.295, 0.218, 0.206], 'all_L1': [0.375, 0.316, 0.291, 0.288]}), defaultdict(<class 'list'>, {'all_KL': [0.593, 0.543, 0.417, 0.388], 'all_L1': [0.448, 0.418, 0.37, 0.357]}), defaultdict(<class 'list'>, {'all_KL': [0.198, 0.323, 0.342, 0.375], 'all_L1': [0.34, 0.443, 0.443, 0.451]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.286, 0.21, 0.191], 'all_L1': [0.371, 0.315, 0.273, 0.264]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.874, 0.901, 0.968, 1.0], 'all_L1': [0.744, 0.799, 0.892, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.779, 0.907, 1.0], 'all_L1': [0.645, 0.711, 0.84, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.465, 0.606, 0.806, 1.0], 'all_L1': [0.586, 0.663, 0.801, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.772, 0.676, 0.837, 1.0], 'all_L1': [0.627, 0.563, 0.72, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.805, 0.931, 1.0], 'all_L1': [0.627, 0.709, 0.843, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.175, 0.145, 0.095, 0.078], 'all_L1': [0.29, 0.26, 0.215, 0.202]}), defaultdict(<class 'list'>, {'all_KL': [0.385, 0.281, 0.204, 0.195], 'all_L1': [0.358, 0.302, 0.273, 0.273]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.532, 0.417, 0.39], 'all_L1': [0.433, 0.412, 0.367, 0.356]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.34, 0.353, 0.379], 'all_L1': [0.349, 0.454, 0.451, 0.454]}), defaultdict(<class 'list'>, {'all_KL': [0.376, 0.291, 0.218, 0.196], 'all_L1': [0.381, 0.32, 0.278, 0.267]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.887, 0.957, 0.974, 1.0], 'all_L1': [0.775, 0.874, 0.907, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.731, 0.888, 1.0], 'all_L1': [0.637, 0.695, 0.802, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.579, 0.698, 0.734, 1.0], 'all_L1': [0.663, 0.699, 0.724, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.782, 0.659, 0.701, 1.0], 'all_L1': [0.66, 0.573, 0.672, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.735, 0.833, 0.955, 1.0], 'all_L1': [0.655, 0.725, 0.883, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.154, 0.239, 0.219, 0.212], 'all_L1': [0.294, 0.35, 0.324, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.395, 0.328, 0.307], 'all_L1': [0.388, 0.401, 0.369, 0.354]}), defaultdict(<class 'list'>, {'all_KL': [0.594, 0.537, 0.516, 0.512], 'all_L1': [0.554, 0.499, 0.463, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.227, 0.355, 0.388, 0.359], 'all_L1': [0.315, 0.433, 0.425, 0.415]}), defaultdict(<class 'list'>, {'all_KL': [0.346, 0.26, 0.159, 0.144], 'all_L1': [0.325, 0.279, 0.212, 0.211]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.648 +- 0.055, 0.687 +- 0.076, 0.818 +- 0.053, 1.000 +- 0.000
suff++ class all_KL  =  0.694 +- 0.134, 0.753 +- 0.099, 0.888 +- 0.059, 1.000 +- 0.000
suff++_acc_int  =  0.447 +- 0.020, 0.501 +- 0.032, 0.599 +- 0.057
nec class all_L1  =  0.366 +- 0.050, 0.351 +- 0.069, 0.319 +- 0.078, 0.313 +- 0.085
nec class all_KL  =  0.349 +- 0.151, 0.319 +- 0.128, 0.257 +- 0.111, 0.248 +- 0.118
nec_acc_int  =  0.344 +- 0.032, 0.406 +- 0.026, 0.445 +- 0.035, 0.447 +- 0.045

Eval split id_test
suff++ class all_L1  =  0.646 +- 0.053, 0.689 +- 0.077, 0.819 +- 0.057, 1.000 +- 0.000
suff++ class all_KL  =  0.693 +- 0.136, 0.753 +- 0.103, 0.890 +- 0.060, 1.000 +- 0.000
suff++_acc_int  =  0.442 +- 0.019, 0.499 +- 0.028, 0.586 +- 0.054
nec class all_L1  =  0.362 +- 0.046, 0.350 +- 0.072, 0.317 +- 0.083, 0.310 +- 0.087
nec class all_KL  =  0.344 +- 0.145, 0.318 +- 0.125, 0.257 +- 0.114, 0.248 +- 0.120
nec_acc_int  =  0.340 +- 0.027, 0.401 +- 0.027, 0.437 +- 0.032, 0.445 +- 0.044

Eval split test
suff++ class all_L1  =  0.678 +- 0.049, 0.713 +- 0.096, 0.798 +- 0.090, 1.000 +- 0.000
suff++ class all_KL  =  0.719 +- 0.113, 0.776 +- 0.108, 0.850 +- 0.113, 1.000 +- 0.000
suff++_acc_int  =  0.431 +- 0.043, 0.462 +- 0.069, 0.488 +- 0.092
nec class all_L1  =  0.375 +- 0.095, 0.392 +- 0.074, 0.359 +- 0.087, 0.351 +- 0.085
nec class all_KL  =  0.353 +- 0.156, 0.357 +- 0.107, 0.322 +- 0.126, 0.307 +- 0.127
nec_acc_int  =  0.395 +- 0.045, 0.438 +- 0.066, 0.452 +- 0.071, 0.458 +- 0.075


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.507 +- 0.015, 0.519 +- 0.015, 0.569 +- 0.014, 0.656 +- 0.042
Faith. Armon (L1)= 		  =  0.463 +- 0.029, 0.455 +- 0.044, 0.451 +- 0.070, 0.470 +- 0.097
Faith. GMean (L1)= 	  =  0.484 +- 0.018, 0.485 +- 0.026, 0.505 +- 0.045, 0.554 +- 0.075
Faith. Aritm (KL)= 		  =  0.522 +- 0.021, 0.536 +- 0.027, 0.572 +- 0.027, 0.624 +- 0.059
Faith. Armon (KL)= 		  =  0.425 +- 0.097, 0.423 +- 0.103, 0.381 +- 0.129, 0.383 +- 0.154
Faith. GMean (KL)= 	  =  0.468 +- 0.061, 0.473 +- 0.069, 0.461 +- 0.094, 0.481 +- 0.127

Eval split id_test
Faith. Aritm (L1)= 		  =  0.504 +- 0.010, 0.519 +- 0.012, 0.568 +- 0.014, 0.655 +- 0.043
Faith. Armon (L1)= 		  =  0.460 +- 0.027, 0.454 +- 0.045, 0.447 +- 0.073, 0.467 +- 0.099
Faith. GMean (L1)= 	  =  0.481 +- 0.014, 0.485 +- 0.025, 0.503 +- 0.047, 0.552 +- 0.077
Faith. Aritm (KL)= 		  =  0.518 +- 0.016, 0.536 +- 0.021, 0.574 +- 0.028, 0.624 +- 0.060
Faith. Armon (KL)= 		  =  0.421 +- 0.093, 0.422 +- 0.102, 0.381 +- 0.133, 0.382 +- 0.157
Faith. GMean (KL)= 	  =  0.464 +- 0.057, 0.472 +- 0.066, 0.461 +- 0.097, 0.481 +- 0.128

Eval split test
Faith. Aritm (L1)= 		  =  0.527 +- 0.044, 0.553 +- 0.046, 0.578 +- 0.026, 0.675 +- 0.043
Faith. Armon (L1)= 		  =  0.475 +- 0.068, 0.497 +- 0.057, 0.482 +- 0.076, 0.513 +- 0.097
Faith. GMean (L1)= 	  =  0.500 +- 0.055, 0.524 +- 0.048, 0.526 +- 0.049, 0.587 +- 0.075
Faith. Aritm (KL)= 		  =  0.536 +- 0.028, 0.566 +- 0.039, 0.586 +- 0.031, 0.653 +- 0.063
Faith. Armon (KL)= 		  =  0.437 +- 0.116, 0.472 +- 0.082, 0.443 +- 0.116, 0.455 +- 0.147
Faith. GMean (KL)= 	  =  0.480 +- 0.076, 0.515 +- 0.054, 0.506 +- 0.076, 0.542 +- 0.115
Computed for split load_split = id



Completed in  0:16:52.999270  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:37:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:37:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.8847
Train Loss: 0.4772
ID Validation ACCURACY: 0.8887
ID Validation Loss: 0.4564
ID Test ACCURACY: 0.8847
ID Test Loss: 0.4977
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.4300
OOD Test ACCURACY: 0.8193
OOD Test Loss: 0.6518

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8679
Train Loss: 0.4876
ID Validation ACCURACY: 0.8757
ID Validation Loss: 0.4706
ID Test ACCURACY: 0.8630
ID Test Loss: 0.5023
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4590
OOD Test ACCURACY: 0.6953
OOD Test Loss: 0.7364

[0m[1;37mINFO[0m: [1mChartInfo 0.8847 0.8193 0.8630 0.6953 0.8757 0.9310[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.746
WIoU for r=0.3 = 0.718
F1 for r=0.6 = 0.626
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.751
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.751
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.748
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.617
WIoU for r=0.6 = 0.775
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.774
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.774
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.599
WIoU for r=0.3 = 0.659
F1 for r=0.6 = 0.507
WIoU for r=0.6 = 0.704
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.695
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.694


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.637
Model XAI F1 of binarized graphs for r=0.3 =  0.74615625
Model XAI WIoU of binarized graphs for r=0.3 =  0.7184712499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.466
SUFF++ for r=0.3 class 0 = 0.5 +- 0.340 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 1 = 0.7 +- 0.340 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 2 = 0.484 +- 0.340 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all KL = 0.504 +- 0.340 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all L1 = 0.562 +- 0.181 (in-sample avg dev_std = 0.544)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  0.6255275
Model XAI WIoU of binarized graphs for r=0.6 =  0.7536875000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.714
SUFF++ for r=0.6 class 0 = 0.574 +- 0.294 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 class 1 = 0.771 +- 0.294 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 class 2 = 0.65 +- 0.294 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 all KL = 0.615 +- 0.294 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.6 all L1 = 0.665 +- 0.204 (in-sample avg dev_std = 0.498)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.48133875
Model XAI WIoU of binarized graphs for r=0.9 =  0.75126125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.818
SUFF++ for r=0.9 class 0 = 0.76 +- 0.218 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 1 = 0.792 +- 0.218 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 class 2 = 0.841 +- 0.218 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all KL = 0.834 +- 0.218 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.9 all L1 = 0.797 +- 0.199 (in-sample avg dev_std = 0.271)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.655
Model XAI F1 of binarized graphs for r=0.3 =  0.7480612499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.73448
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.47
SUFF++ for r=0.3 class 0 = 0.483 +- 0.342 (in-sample avg dev_std = 0.556)
SUFF++ for r=0.3 class 1 = 0.699 +- 0.342 (in-sample avg dev_std = 0.556)
SUFF++ for r=0.3 class 2 = 0.506 +- 0.342 (in-sample avg dev_std = 0.556)
SUFF++ for r=0.3 all KL = 0.493 +- 0.342 (in-sample avg dev_std = 0.556)
SUFF++ for r=0.3 all L1 = 0.561 +- 0.184 (in-sample avg dev_std = 0.556)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.864
Model XAI F1 of binarized graphs for r=0.6 =  0.6169875
Model XAI WIoU of binarized graphs for r=0.6 =  0.774685
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.704
SUFF++ for r=0.6 class 0 = 0.576 +- 0.295 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 1 = 0.768 +- 0.295 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 class 2 = 0.651 +- 0.295 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all KL = 0.621 +- 0.295 (in-sample avg dev_std = 0.485)
SUFF++ for r=0.6 all L1 = 0.664 +- 0.209 (in-sample avg dev_std = 0.485)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.47328625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7741612500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.821
SUFF++ for r=0.9 class 0 = 0.756 +- 0.220 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 1 = 0.796 +- 0.220 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 class 2 = 0.842 +- 0.220 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all KL = 0.836 +- 0.220 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.196 (in-sample avg dev_std = 0.280)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.59851
Model XAI WIoU of binarized graphs for r=0.3 =  0.65903375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.529
SUFF++ for r=0.3 class 0 = 0.545 +- 0.313 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 class 1 = 0.72 +- 0.313 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 class 2 = 0.647 +- 0.313 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 all KL = 0.599 +- 0.313 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.3 all L1 = 0.639 +- 0.170 (in-sample avg dev_std = 0.533)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.785
Model XAI F1 of binarized graphs for r=0.6 =  0.5065500000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7040974999999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.636
SUFF++ for r=0.6 class 0 = 0.522 +- 0.323 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.6 class 1 = 0.747 +- 0.323 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.6 class 2 = 0.523 +- 0.323 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.6 all KL = 0.595 +- 0.323 (in-sample avg dev_std = 0.564)
SUFF++ for r=0.6 all L1 = 0.599 +- 0.217 (in-sample avg dev_std = 0.564)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6952625
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.816
SUFF++ for r=0.9 class 0 = 0.795 +- 0.275 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 1 = 0.773 +- 0.275 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 2 = 0.943 +- 0.275 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all KL = 0.813 +- 0.275 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all L1 = 0.837 +- 0.206 (in-sample avg dev_std = 0.286)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.636
Model XAI F1 of binarized graphs for r=0.3 =  0.74615625
Model XAI WIoU of binarized graphs for r=0.3 =  0.7184712499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.36
NEC for r=0.3 class 0 = 0.598 +- 0.311 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.492 +- 0.311 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.599 +- 0.311 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.606 +- 0.311 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.563 +- 0.182 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  0.6255275
Model XAI WIoU of binarized graphs for r=0.6 =  0.7536875000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.478
NEC for r=0.6 class 0 = 0.54 +- 0.313 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.508 +- 0.313 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.629 +- 0.313 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.63 +- 0.313 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.559 +- 0.177 (in-sample avg dev_std = 0.510)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.48133875
Model XAI WIoU of binarized graphs for r=0.9 =  0.75126125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.537
NEC for r=0.9 class 0 = 0.505 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 1 = 0.489 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.9 class 2 = 0.539 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all KL = 0.553 +- 0.295 (in-sample avg dev_std = 0.568)
NEC for r=0.9 all L1 = 0.511 +- 0.157 (in-sample avg dev_std = 0.568)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7512049999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.54
NEC for r=1.0 class 0 = 0.499 +- 0.295 (in-sample avg dev_std = 0.554)
NEC for r=1.0 class 1 = 0.499 +- 0.295 (in-sample avg dev_std = 0.554)
NEC for r=1.0 class 2 = 0.538 +- 0.295 (in-sample avg dev_std = 0.554)
NEC for r=1.0 all KL = 0.544 +- 0.295 (in-sample avg dev_std = 0.554)
NEC for r=1.0 all L1 = 0.512 +- 0.158 (in-sample avg dev_std = 0.554)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.655
Model XAI F1 of binarized graphs for r=0.3 =  0.7480612499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.73448
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.362
NEC for r=0.3 class 0 = 0.602 +- 0.309 (in-sample avg dev_std = 0.409)
NEC for r=0.3 class 1 = 0.499 +- 0.309 (in-sample avg dev_std = 0.409)
NEC for r=0.3 class 2 = 0.609 +- 0.309 (in-sample avg dev_std = 0.409)
NEC for r=0.3 all KL = 0.621 +- 0.309 (in-sample avg dev_std = 0.409)
NEC for r=0.3 all L1 = 0.571 +- 0.179 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.864
Model XAI F1 of binarized graphs for r=0.6 =  0.6169875
Model XAI WIoU of binarized graphs for r=0.6 =  0.774685
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.465
NEC for r=0.6 class 0 = 0.533 +- 0.307 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 1 = 0.51 +- 0.307 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 2 = 0.63 +- 0.307 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all KL = 0.626 +- 0.307 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all L1 = 0.559 +- 0.177 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.899
Model XAI F1 of binarized graphs for r=0.9 =  0.47328625
Model XAI WIoU of binarized graphs for r=0.9 =  0.7741612500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 0 = 0.504 +- 0.301 (in-sample avg dev_std = 0.553)
NEC for r=0.9 class 1 = 0.487 +- 0.301 (in-sample avg dev_std = 0.553)
NEC for r=0.9 class 2 = 0.538 +- 0.301 (in-sample avg dev_std = 0.553)
NEC for r=0.9 all KL = 0.55 +- 0.301 (in-sample avg dev_std = 0.553)
NEC for r=0.9 all L1 = 0.51 +- 0.166 (in-sample avg dev_std = 0.553)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.774105
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.539
NEC for r=1.0 class 0 = 0.507 +- 0.295 (in-sample avg dev_std = 0.556)
NEC for r=1.0 class 1 = 0.495 +- 0.295 (in-sample avg dev_std = 0.556)
NEC for r=1.0 class 2 = 0.526 +- 0.295 (in-sample avg dev_std = 0.556)
NEC for r=1.0 all KL = 0.541 +- 0.295 (in-sample avg dev_std = 0.556)
NEC for r=1.0 all L1 = 0.51 +- 0.160 (in-sample avg dev_std = 0.556)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  0.59851
Model XAI WIoU of binarized graphs for r=0.3 =  0.65903375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.408
NEC for r=0.3 class 0 = 0.55 +- 0.351 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 1 = 0.436 +- 0.351 (in-sample avg dev_std = 0.432)
NEC for r=0.3 class 2 = 0.452 +- 0.351 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all KL = 0.511 +- 0.351 (in-sample avg dev_std = 0.432)
NEC for r=0.3 all L1 = 0.478 +- 0.209 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.784
Model XAI F1 of binarized graphs for r=0.6 =  0.5065500000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.7040974999999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.474
NEC for r=0.6 class 0 = 0.463 +- 0.289 (in-sample avg dev_std = 0.552)
NEC for r=0.6 class 1 = 0.424 +- 0.289 (in-sample avg dev_std = 0.552)
NEC for r=0.6 class 2 = 0.503 +- 0.289 (in-sample avg dev_std = 0.552)
NEC for r=0.6 all KL = 0.459 +- 0.289 (in-sample avg dev_std = 0.552)
NEC for r=0.6 all L1 = 0.463 +- 0.191 (in-sample avg dev_std = 0.552)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6952625
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.556
NEC for r=0.9 class 0 = 0.42 +- 0.362 (in-sample avg dev_std = 0.626)
NEC for r=0.9 class 1 = 0.458 +- 0.362 (in-sample avg dev_std = 0.626)
NEC for r=0.9 class 2 = 0.463 +- 0.362 (in-sample avg dev_std = 0.626)
NEC for r=0.9 all KL = 0.514 +- 0.362 (in-sample avg dev_std = 0.626)
NEC for r=0.9 all L1 = 0.447 +- 0.208 (in-sample avg dev_std = 0.626)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.81
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.694265
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.57
NEC for r=1.0 class 0 = 0.4 +- 0.352 (in-sample avg dev_std = 0.608)
NEC for r=1.0 class 1 = 0.458 +- 0.352 (in-sample avg dev_std = 0.608)
NEC for r=1.0 class 2 = 0.391 +- 0.352 (in-sample avg dev_std = 0.608)
NEC for r=1.0 all KL = 0.483 +- 0.352 (in-sample avg dev_std = 0.608)
NEC for r=1.0 all L1 = 0.417 +- 0.202 (in-sample avg dev_std = 0.608)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:40:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:40:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.8983
Train Loss: 0.4415
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.4217
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4640
OOD Validation ACCURACY: 0.8753
OOD Validation Loss: 0.4884
OOD Test ACCURACY: 0.7910
OOD Test Loss: 0.5701

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.8614
Train Loss: 0.4580
ID Validation ACCURACY: 0.8647
ID Validation Loss: 0.4463
ID Test ACCURACY: 0.8490
ID Test Loss: 0.4903
OOD Validation ACCURACY: 0.8987
OOD Validation Loss: 0.5225
OOD Test ACCURACY: 0.8547
OOD Test Loss: 0.4549

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.7910 0.8490 0.8547 0.8647 0.8987[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.737
WIoU for r=0.3 = 0.709
F1 for r=0.6 = 0.625
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.766
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.766
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.737
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.616
WIoU for r=0.6 = 0.781
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.778
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.778
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.767
WIoU for r=0.3 = 0.900
F1 for r=0.6 = 0.565
WIoU for r=0.6 = 0.868
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.862
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.862


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  0.7370337499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.7091937500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.437
SUFF++ for r=0.3 class 0 = 0.475 +- 0.306 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 1 = 0.641 +- 0.306 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 class 2 = 0.412 +- 0.306 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all KL = 0.493 +- 0.306 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.3 all L1 = 0.51 +- 0.171 (in-sample avg dev_std = 0.530)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.6249312499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7698075
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.712
SUFF++ for r=0.6 class 0 = 0.568 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 1 = 0.74 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 class 2 = 0.604 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 all KL = 0.58 +- 0.297 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.6 all L1 = 0.638 +- 0.196 (in-sample avg dev_std = 0.519)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4814387499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.7655775
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.83
SUFF++ for r=0.9 class 0 = 0.712 +- 0.234 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 1 = 0.809 +- 0.234 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 2 = 0.86 +- 0.234 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all KL = 0.838 +- 0.234 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.206 (in-sample avg dev_std = 0.320)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.601
Model XAI F1 of binarized graphs for r=0.3 =  0.7369412499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.719065
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.452
SUFF++ for r=0.3 class 0 = 0.477 +- 0.302 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 class 1 = 0.65 +- 0.302 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 class 2 = 0.449 +- 0.302 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 all KL = 0.497 +- 0.302 (in-sample avg dev_std = 0.549)
SUFF++ for r=0.3 all L1 = 0.524 +- 0.166 (in-sample avg dev_std = 0.549)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.871
Model XAI F1 of binarized graphs for r=0.6 =  0.61565125
Model XAI WIoU of binarized graphs for r=0.6 =  0.781395
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.703
SUFF++ for r=0.6 class 0 = 0.584 +- 0.295 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 1 = 0.737 +- 0.295 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 2 = 0.588 +- 0.295 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all KL = 0.583 +- 0.295 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all L1 = 0.635 +- 0.192 (in-sample avg dev_std = 0.524)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.47318625
Model XAI WIoU of binarized graphs for r=0.9 =  0.77792125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.834
SUFF++ for r=0.9 class 0 = 0.737 +- 0.217 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 1 = 0.82 +- 0.217 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 class 2 = 0.867 +- 0.217 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all KL = 0.856 +- 0.217 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.9 all L1 = 0.809 +- 0.202 (in-sample avg dev_std = 0.286)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.649
Model XAI F1 of binarized graphs for r=0.3 =  0.76653
Model XAI WIoU of binarized graphs for r=0.3 =  0.8999475
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.572
SUFF++ for r=0.3 class 0 = 0.549 +- 0.308 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 class 1 = 0.751 +- 0.308 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 class 2 = 0.546 +- 0.308 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 all KL = 0.564 +- 0.308 (in-sample avg dev_std = 0.592)
SUFF++ for r=0.3 all L1 = 0.617 +- 0.165 (in-sample avg dev_std = 0.592)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.86844875
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.699
SUFF++ for r=0.6 class 0 = 0.512 +- 0.319 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 class 1 = 0.729 +- 0.319 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 class 2 = 0.571 +- 0.319 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 all KL = 0.546 +- 0.319 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.6 all L1 = 0.606 +- 0.210 (in-sample avg dev_std = 0.591)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.8624475000000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.787
SUFF++ for r=0.9 class 0 = 0.814 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 1 = 0.92 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 class 2 = 0.933 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all KL = 0.935 +- 0.112 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.145 (in-sample avg dev_std = 0.239)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  0.7370337499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.7091937500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.327
NEC for r=0.3 class 0 = 0.557 +- 0.301 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 1 = 0.48 +- 0.301 (in-sample avg dev_std = 0.430)
NEC for r=0.3 class 2 = 0.617 +- 0.301 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all KL = 0.552 +- 0.301 (in-sample avg dev_std = 0.430)
NEC for r=0.3 all L1 = 0.551 +- 0.156 (in-sample avg dev_std = 0.430)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  0.6249312499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.7698075
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.485
NEC for r=0.6 class 0 = 0.504 +- 0.318 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 1 = 0.506 +- 0.318 (in-sample avg dev_std = 0.505)
NEC for r=0.6 class 2 = 0.616 +- 0.318 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all KL = 0.599 +- 0.318 (in-sample avg dev_std = 0.505)
NEC for r=0.6 all L1 = 0.541 +- 0.165 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.91
Model XAI F1 of binarized graphs for r=0.9 =  0.4814387499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.7655775
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.55
NEC for r=0.9 class 0 = 0.478 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 1 = 0.489 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 class 2 = 0.552 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all KL = 0.537 +- 0.298 (in-sample avg dev_std = 0.539)
NEC for r=0.9 all L1 = 0.506 +- 0.165 (in-sample avg dev_std = 0.539)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.7655250000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.561
NEC for r=1.0 class 0 = 0.478 +- 0.290 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 1 = 0.483 +- 0.290 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 2 = 0.543 +- 0.290 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all KL = 0.524 +- 0.290 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all L1 = 0.501 +- 0.160 (in-sample avg dev_std = 0.533)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.6
Model XAI F1 of binarized graphs for r=0.3 =  0.7369412499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.719065
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.57 +- 0.302 (in-sample avg dev_std = 0.431)
NEC for r=0.3 class 1 = 0.502 +- 0.302 (in-sample avg dev_std = 0.431)
NEC for r=0.3 class 2 = 0.603 +- 0.302 (in-sample avg dev_std = 0.431)
NEC for r=0.3 all KL = 0.564 +- 0.302 (in-sample avg dev_std = 0.431)
NEC for r=0.3 all L1 = 0.559 +- 0.152 (in-sample avg dev_std = 0.431)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.871
Model XAI F1 of binarized graphs for r=0.6 =  0.61565125
Model XAI WIoU of binarized graphs for r=0.6 =  0.781395
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.48
NEC for r=0.6 class 0 = 0.511 +- 0.319 (in-sample avg dev_std = 0.509)
NEC for r=0.6 class 1 = 0.499 +- 0.319 (in-sample avg dev_std = 0.509)
NEC for r=0.6 class 2 = 0.607 +- 0.319 (in-sample avg dev_std = 0.509)
NEC for r=0.6 all KL = 0.588 +- 0.319 (in-sample avg dev_std = 0.509)
NEC for r=0.6 all L1 = 0.54 +- 0.164 (in-sample avg dev_std = 0.509)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  0.47318625
Model XAI WIoU of binarized graphs for r=0.9 =  0.77792125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.548
NEC for r=0.9 class 0 = 0.48 +- 0.298 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 1 = 0.476 +- 0.298 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 2 = 0.563 +- 0.298 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all KL = 0.535 +- 0.298 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all L1 = 0.507 +- 0.160 (in-sample avg dev_std = 0.546)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.908
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7778687500000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.462 +- 0.297 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 1 = 0.476 +- 0.297 (in-sample avg dev_std = 0.543)
NEC for r=1.0 class 2 = 0.541 +- 0.297 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all KL = 0.517 +- 0.297 (in-sample avg dev_std = 0.543)
NEC for r=1.0 all L1 = 0.494 +- 0.163 (in-sample avg dev_std = 0.543)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.649
Model XAI F1 of binarized graphs for r=0.3 =  0.76653
Model XAI WIoU of binarized graphs for r=0.3 =  0.8999475
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.383
NEC for r=0.3 class 0 = 0.5 +- 0.291 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 1 = 0.481 +- 0.291 (in-sample avg dev_std = 0.506)
NEC for r=0.3 class 2 = 0.631 +- 0.291 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all KL = 0.568 +- 0.291 (in-sample avg dev_std = 0.506)
NEC for r=0.3 all L1 = 0.537 +- 0.125 (in-sample avg dev_std = 0.506)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.772
Model XAI F1 of binarized graphs for r=0.6 =  0.5651437500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.86844875
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.548
NEC for r=0.6 class 0 = 0.442 +- 0.328 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 1 = 0.385 +- 0.328 (in-sample avg dev_std = 0.510)
NEC for r=0.6 class 2 = 0.573 +- 0.328 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all KL = 0.501 +- 0.328 (in-sample avg dev_std = 0.510)
NEC for r=0.6 all L1 = 0.466 +- 0.194 (in-sample avg dev_std = 0.510)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.8624475000000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.577
NEC for r=0.9 class 0 = 0.412 +- 0.308 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 1 = 0.34 +- 0.308 (in-sample avg dev_std = 0.561)
NEC for r=0.9 class 2 = 0.517 +- 0.308 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all KL = 0.432 +- 0.308 (in-sample avg dev_std = 0.561)
NEC for r=0.9 all L1 = 0.422 +- 0.191 (in-sample avg dev_std = 0.561)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.775
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.8624475000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.587
NEC for r=1.0 class 0 = 0.411 +- 0.310 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.337 +- 0.310 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.518 +- 0.310 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.435 +- 0.310 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.421 +- 0.194 (in-sample avg dev_std = 0.576)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:43:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:43:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9062
Train Loss: 0.4276
ID Validation ACCURACY: 0.9130
ID Validation Loss: 0.3966
ID Test ACCURACY: 0.9047
ID Test Loss: 0.4482
OOD Validation ACCURACY: 0.9047
OOD Validation Loss: 0.5081
OOD Test ACCURACY: 0.8917
OOD Test Loss: 0.4905

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ACCURACY: 0.8554
Train Loss: 0.5371
ID Validation ACCURACY: 0.8563
ID Validation Loss: 0.5371
ID Test ACCURACY: 0.8543
ID Test Loss: 0.5657
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.5360
OOD Test ACCURACY: 0.8190
OOD Test Loss: 0.7022

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8917 0.8543 0.8190 0.8563 0.9280[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.708
WIoU for r=0.3 = 0.683
F1 for r=0.6 = 0.627
WIoU for r=0.6 = 0.766
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.760
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.760
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.716
WIoU for r=0.3 = 0.701
F1 for r=0.6 = 0.619
WIoU for r=0.6 = 0.776
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.772
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.772
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.572
WIoU for r=0.3 = 0.598
F1 for r=0.6 = 0.534
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.667
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.667


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.623
Model XAI F1 of binarized graphs for r=0.3 =  0.70843625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6828025
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
SUFF++ for r=0.3 class 0 = 0.494 +- 0.284 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.3 class 1 = 0.546 +- 0.284 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.3 class 2 = 0.432 +- 0.284 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.3 all KL = 0.466 +- 0.284 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.3 all L1 = 0.491 +- 0.146 (in-sample avg dev_std = 0.563)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.836
Model XAI F1 of binarized graphs for r=0.6 =  0.6269825
Model XAI WIoU of binarized graphs for r=0.6 =  0.7655000000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.722
SUFF++ for r=0.6 class 0 = 0.549 +- 0.276 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 class 1 = 0.706 +- 0.276 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 class 2 = 0.643 +- 0.276 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 all KL = 0.596 +- 0.276 (in-sample avg dev_std = 0.499)
SUFF++ for r=0.6 all L1 = 0.633 +- 0.195 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.4814387499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.76009375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.871
SUFF++ for r=0.9 class 0 = 0.781 +- 0.175 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1 = 0.816 +- 0.175 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 2 = 0.863 +- 0.175 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.871 +- 0.175 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.82 +- 0.170 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.627
Model XAI F1 of binarized graphs for r=0.3 =  0.7163675
Model XAI WIoU of binarized graphs for r=0.3 =  0.7011587499999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.402
SUFF++ for r=0.3 class 0 = 0.476 +- 0.285 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 class 1 = 0.563 +- 0.285 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 class 2 = 0.465 +- 0.285 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 all KL = 0.474 +- 0.285 (in-sample avg dev_std = 0.562)
SUFF++ for r=0.3 all L1 = 0.5 +- 0.151 (in-sample avg dev_std = 0.562)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.6187475
Model XAI WIoU of binarized graphs for r=0.6 =  0.7763624999999998
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.71
SUFF++ for r=0.6 class 0 = 0.57 +- 0.284 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 class 1 = 0.702 +- 0.284 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 class 2 = 0.637 +- 0.284 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 all KL = 0.594 +- 0.284 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.6 all L1 = 0.636 +- 0.196 (in-sample avg dev_std = 0.509)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.47328625
Model XAI WIoU of binarized graphs for r=0.9 =  0.77184375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0 = 0.814 +- 0.169 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 1 = 0.813 +- 0.169 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 class 2 = 0.872 +- 0.169 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 all KL = 0.886 +- 0.169 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.9 all L1 = 0.834 +- 0.169 (in-sample avg dev_std = 0.242)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  0.57244125
Model XAI WIoU of binarized graphs for r=0.3 =  0.59815375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.485
SUFF++ for r=0.3 class 0 = 0.497 +- 0.221 (in-sample avg dev_std = 0.616)
SUFF++ for r=0.3 class 1 = 0.517 +- 0.221 (in-sample avg dev_std = 0.616)
SUFF++ for r=0.3 class 2 = 0.477 +- 0.221 (in-sample avg dev_std = 0.616)
SUFF++ for r=0.3 all KL = 0.459 +- 0.221 (in-sample avg dev_std = 0.616)
SUFF++ for r=0.3 all L1 = 0.497 +- 0.155 (in-sample avg dev_std = 0.616)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  0.533705
Model XAI WIoU of binarized graphs for r=0.6 =  0.6958375000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.672
SUFF++ for r=0.6 class 0 = 0.582 +- 0.331 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 1 = 0.628 +- 0.331 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 2 = 0.543 +- 0.331 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all KL = 0.582 +- 0.331 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all L1 = 0.585 +- 0.204 (in-sample avg dev_std = 0.524)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6670124999999999
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.795
SUFF++ for r=0.9 class 0 = 0.685 +- 0.309 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.9 class 1 = 0.686 +- 0.309 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.9 class 2 = 0.803 +- 0.309 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.9 all KL = 0.751 +- 0.309 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.9 all L1 = 0.724 +- 0.207 (in-sample avg dev_std = 0.374)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.623
Model XAI F1 of binarized graphs for r=0.3 =  0.70843625
Model XAI WIoU of binarized graphs for r=0.3 =  0.6828025
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.321
NEC for r=0.3 class 0 = 0.561 +- 0.329 (in-sample avg dev_std = 0.449)
NEC for r=0.3 class 1 = 0.514 +- 0.329 (in-sample avg dev_std = 0.449)
NEC for r=0.3 class 2 = 0.606 +- 0.329 (in-sample avg dev_std = 0.449)
NEC for r=0.3 all KL = 0.583 +- 0.329 (in-sample avg dev_std = 0.449)
NEC for r=0.3 all L1 = 0.56 +- 0.193 (in-sample avg dev_std = 0.449)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.836
Model XAI F1 of binarized graphs for r=0.6 =  0.6269825
Model XAI WIoU of binarized graphs for r=0.6 =  0.7655000000000001
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.476
NEC for r=0.6 class 0 = 0.54 +- 0.288 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 1 = 0.551 +- 0.288 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 2 = 0.615 +- 0.288 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.611 +- 0.288 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.569 +- 0.161 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.4814387499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.76009375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.501 +- 0.294 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.52 +- 0.294 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.537 +- 0.294 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.551 +- 0.294 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.519 +- 0.165 (in-sample avg dev_std = 0.566)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.760075
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.554
NEC for r=1.0 class 0 = 0.482 +- 0.283 (in-sample avg dev_std = 0.566)
NEC for r=1.0 class 1 = 0.52 +- 0.283 (in-sample avg dev_std = 0.566)
NEC for r=1.0 class 2 = 0.516 +- 0.283 (in-sample avg dev_std = 0.566)
NEC for r=1.0 all KL = 0.534 +- 0.283 (in-sample avg dev_std = 0.566)
NEC for r=1.0 all L1 = 0.506 +- 0.157 (in-sample avg dev_std = 0.566)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  0.7163675
Model XAI WIoU of binarized graphs for r=0.3 =  0.7011587499999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
NEC for r=0.3 class 0 = 0.558 +- 0.332 (in-sample avg dev_std = 0.459)
NEC for r=0.3 class 1 = 0.488 +- 0.332 (in-sample avg dev_std = 0.459)
NEC for r=0.3 class 2 = 0.594 +- 0.332 (in-sample avg dev_std = 0.459)
NEC for r=0.3 all KL = 0.572 +- 0.332 (in-sample avg dev_std = 0.459)
NEC for r=0.3 all L1 = 0.548 +- 0.192 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.851
Model XAI F1 of binarized graphs for r=0.6 =  0.6187475
Model XAI WIoU of binarized graphs for r=0.6 =  0.7763624999999998
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.474
NEC for r=0.6 class 0 = 0.543 +- 0.290 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 1 = 0.551 +- 0.290 (in-sample avg dev_std = 0.538)
NEC for r=0.6 class 2 = 0.593 +- 0.290 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all KL = 0.609 +- 0.290 (in-sample avg dev_std = 0.538)
NEC for r=0.6 all L1 = 0.563 +- 0.168 (in-sample avg dev_std = 0.538)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.47328625
Model XAI WIoU of binarized graphs for r=0.9 =  0.77184375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.536
NEC for r=0.9 class 0 = 0.49 +- 0.288 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 1 = 0.513 +- 0.288 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 2 = 0.537 +- 0.288 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all KL = 0.542 +- 0.288 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all L1 = 0.514 +- 0.159 (in-sample avg dev_std = 0.569)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.7718250000000001
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.545
NEC for r=1.0 class 0 = 0.482 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=1.0 class 1 = 0.522 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=1.0 class 2 = 0.508 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=1.0 all KL = 0.524 +- 0.293 (in-sample avg dev_std = 0.561)
NEC for r=1.0 all L1 = 0.504 +- 0.164 (in-sample avg dev_std = 0.561)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  0.57244125
Model XAI WIoU of binarized graphs for r=0.3 =  0.59815375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.441
NEC for r=0.3 class 0 = 0.531 +- 0.248 (in-sample avg dev_std = 0.583)
NEC for r=0.3 class 1 = 0.561 +- 0.248 (in-sample avg dev_std = 0.583)
NEC for r=0.3 class 2 = 0.575 +- 0.248 (in-sample avg dev_std = 0.583)
NEC for r=0.3 all KL = 0.585 +- 0.248 (in-sample avg dev_std = 0.583)
NEC for r=0.3 all L1 = 0.556 +- 0.138 (in-sample avg dev_std = 0.583)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  0.533705
Model XAI WIoU of binarized graphs for r=0.6 =  0.6958375000000001
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.442
NEC for r=0.6 class 0 = 0.439 +- 0.275 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 1 = 0.517 +- 0.275 (in-sample avg dev_std = 0.537)
NEC for r=0.6 class 2 = 0.531 +- 0.275 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all KL = 0.497 +- 0.275 (in-sample avg dev_std = 0.537)
NEC for r=0.6 all L1 = 0.497 +- 0.175 (in-sample avg dev_std = 0.537)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.6670124999999999
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.561
NEC for r=0.9 class 0 = 0.405 +- 0.339 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 1 = 0.482 +- 0.339 (in-sample avg dev_std = 0.575)
NEC for r=0.9 class 2 = 0.473 +- 0.339 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all KL = 0.473 +- 0.339 (in-sample avg dev_std = 0.575)
NEC for r=0.9 all L1 = 0.454 +- 0.208 (in-sample avg dev_std = 0.575)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.9
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.666585
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.608
NEC for r=1.0 class 0 = 0.403 +- 0.317 (in-sample avg dev_std = 0.579)
NEC for r=1.0 class 1 = 0.472 +- 0.317 (in-sample avg dev_std = 0.579)
NEC for r=1.0 class 2 = 0.417 +- 0.317 (in-sample avg dev_std = 0.579)
NEC for r=1.0 all KL = 0.445 +- 0.317 (in-sample avg dev_std = 0.579)
NEC for r=1.0 all L1 = 0.431 +- 0.189 (in-sample avg dev_std = 0.579)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:46:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:46:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.8718
Train Loss: 0.4753
ID Validation ACCURACY: 0.8760
ID Validation Loss: 0.4638
ID Test ACCURACY: 0.8723
ID Test Loss: 0.4886
OOD Validation ACCURACY: 0.8783
OOD Validation Loss: 0.5438
OOD Test ACCURACY: 0.8270
OOD Test Loss: 0.5613

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8508
Train Loss: 0.5047
ID Validation ACCURACY: 0.8530
ID Validation Loss: 0.4872
ID Test ACCURACY: 0.8500
ID Test Loss: 0.5190
OOD Validation ACCURACY: 0.9013
OOD Validation Loss: 0.5288
OOD Test ACCURACY: 0.8983
OOD Test Loss: 0.5012

[0m[1;37mINFO[0m: [1mChartInfo 0.8723 0.8270 0.8500 0.8983 0.8530 0.9013[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.664
WIoU for r=0.3 = 0.577
F1 for r=0.6 = 0.623
WIoU for r=0.6 = 0.660
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.661
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.661
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.658
WIoU for r=0.3 = 0.575
F1 for r=0.6 = 0.615
WIoU for r=0.6 = 0.659
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.660
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.660
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.742
WIoU for r=0.3 = 0.632
F1 for r=0.6 = 0.564
WIoU for r=0.6 = 0.564
F1 for r=0.9 = 0.423
WIoU for r=0.9 = 0.557
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.557


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.499
Model XAI F1 of binarized graphs for r=0.3 =  0.66406125
Model XAI WIoU of binarized graphs for r=0.3 =  0.57719625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.451
SUFF++ for r=0.3 class 0 = 0.525 +- 0.269 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 class 1 = 0.605 +- 0.269 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 class 2 = 0.511 +- 0.269 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 all KL = 0.568 +- 0.269 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.3 all L1 = 0.547 +- 0.159 (in-sample avg dev_std = 0.514)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.6228625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6604075
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.698
SUFF++ for r=0.6 class 0 = 0.543 +- 0.303 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 class 1 = 0.719 +- 0.303 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 class 2 = 0.654 +- 0.303 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 all KL = 0.604 +- 0.303 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.6 all L1 = 0.639 +- 0.198 (in-sample avg dev_std = 0.526)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.887
Model XAI F1 of binarized graphs for r=0.9 =  0.48064
Model XAI WIoU of binarized graphs for r=0.9 =  0.66133125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.862
SUFF++ for r=0.9 class 0 = 0.833 +- 0.141 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 1 = 0.821 +- 0.141 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 class 2 = 0.895 +- 0.141 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all KL = 0.906 +- 0.141 (in-sample avg dev_std = 0.215)
SUFF++ for r=0.9 all L1 = 0.849 +- 0.163 (in-sample avg dev_std = 0.215)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.48
Model XAI F1 of binarized graphs for r=0.3 =  0.6578274999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5753
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.445
SUFF++ for r=0.3 class 0 = 0.521 +- 0.263 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 class 1 = 0.605 +- 0.263 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 class 2 = 0.519 +- 0.263 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 all KL = 0.56 +- 0.263 (in-sample avg dev_std = 0.515)
SUFF++ for r=0.3 all L1 = 0.548 +- 0.152 (in-sample avg dev_std = 0.515)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.6148675
Model XAI WIoU of binarized graphs for r=0.6 =  0.6586212499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0 = 0.548 +- 0.296 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 class 1 = 0.712 +- 0.296 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 class 2 = 0.641 +- 0.296 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 all KL = 0.607 +- 0.296 (in-sample avg dev_std = 0.521)
SUFF++ for r=0.6 all L1 = 0.634 +- 0.197 (in-sample avg dev_std = 0.521)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.4729625
Model XAI WIoU of binarized graphs for r=0.9 =  0.6601587499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.845
SUFF++ for r=0.9 class 0 = 0.822 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 1 = 0.821 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 2 = 0.892 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all KL = 0.9 +- 0.155 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all L1 = 0.846 +- 0.166 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.524
Model XAI F1 of binarized graphs for r=0.3 =  0.7416225
Model XAI WIoU of binarized graphs for r=0.3 =  0.63188
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.564
SUFF++ for r=0.3 class 0 = 0.546 +- 0.257 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 1 = 0.662 +- 0.257 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 class 2 = 0.571 +- 0.257 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all KL = 0.549 +- 0.257 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.3 all L1 = 0.594 +- 0.199 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.837
Model XAI F1 of binarized graphs for r=0.6 =  0.56440375
Model XAI WIoU of binarized graphs for r=0.6 =  0.5640325
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.795
SUFF++ for r=0.6 class 0 = 0.661 +- 0.275 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 class 1 = 0.654 +- 0.275 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 class 2 = 0.836 +- 0.275 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all KL = 0.652 +- 0.275 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all L1 = 0.717 +- 0.209 (in-sample avg dev_std = 0.423)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  0.42343875000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.5570499999999999
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.811
SUFF++ for r=0.9 class 0 = 0.806 +- 0.149 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 1 = 0.788 +- 0.149 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 2 = 0.944 +- 0.149 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all KL = 0.882 +- 0.149 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all L1 = 0.846 +- 0.140 (in-sample avg dev_std = 0.279)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.499
Model XAI F1 of binarized graphs for r=0.3 =  0.66406125
Model XAI WIoU of binarized graphs for r=0.3 =  0.57719625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.298
NEC for r=0.3 class 0 = 0.496 +- 0.285 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 1 = 0.485 +- 0.285 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 2 = 0.48 +- 0.285 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all KL = 0.454 +- 0.285 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all L1 = 0.487 +- 0.181 (in-sample avg dev_std = 0.404)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  0.6228625
Model XAI WIoU of binarized graphs for r=0.6 =  0.6604075
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.421
NEC for r=0.6 class 0 = 0.588 +- 0.281 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 1 = 0.526 +- 0.281 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 2 = 0.645 +- 0.281 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all KL = 0.622 +- 0.281 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all L1 = 0.586 +- 0.164 (in-sample avg dev_std = 0.507)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.887
Model XAI F1 of binarized graphs for r=0.9 =  0.48064
Model XAI WIoU of binarized graphs for r=0.9 =  0.66133125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.532
NEC for r=0.9 class 0 = 0.524 +- 0.303 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 1 = 0.487 +- 0.303 (in-sample avg dev_std = 0.546)
NEC for r=0.9 class 2 = 0.538 +- 0.303 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all KL = 0.555 +- 0.303 (in-sample avg dev_std = 0.546)
NEC for r=0.9 all L1 = 0.516 +- 0.163 (in-sample avg dev_std = 0.546)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.889
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.66128625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.53
NEC for r=1.0 class 0 = 0.516 +- 0.302 (in-sample avg dev_std = 0.538)
NEC for r=1.0 class 1 = 0.495 +- 0.302 (in-sample avg dev_std = 0.538)
NEC for r=1.0 class 2 = 0.524 +- 0.302 (in-sample avg dev_std = 0.538)
NEC for r=1.0 all KL = 0.535 +- 0.302 (in-sample avg dev_std = 0.538)
NEC for r=1.0 all L1 = 0.512 +- 0.164 (in-sample avg dev_std = 0.538)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.48
Model XAI F1 of binarized graphs for r=0.3 =  0.6578274999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5753
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.285
NEC for r=0.3 class 0 = 0.498 +- 0.286 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 1 = 0.466 +- 0.286 (in-sample avg dev_std = 0.426)
NEC for r=0.3 class 2 = 0.499 +- 0.286 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all KL = 0.462 +- 0.286 (in-sample avg dev_std = 0.426)
NEC for r=0.3 all L1 = 0.488 +- 0.173 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.821
Model XAI F1 of binarized graphs for r=0.6 =  0.6148675
Model XAI WIoU of binarized graphs for r=0.6 =  0.6586212499999999
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.423
NEC for r=0.6 class 0 = 0.582 +- 0.279 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 1 = 0.526 +- 0.279 (in-sample avg dev_std = 0.516)
NEC for r=0.6 class 2 = 0.627 +- 0.279 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all KL = 0.613 +- 0.279 (in-sample avg dev_std = 0.516)
NEC for r=0.6 all L1 = 0.579 +- 0.163 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.4729625
Model XAI WIoU of binarized graphs for r=0.9 =  0.6601587499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.525
NEC for r=0.9 class 0 = 0.519 +- 0.311 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 1 = 0.491 +- 0.311 (in-sample avg dev_std = 0.538)
NEC for r=0.9 class 2 = 0.542 +- 0.311 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all KL = 0.555 +- 0.311 (in-sample avg dev_std = 0.538)
NEC for r=0.9 all L1 = 0.518 +- 0.169 (in-sample avg dev_std = 0.538)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.881
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.660105
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.541
NEC for r=1.0 class 0 = 0.51 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=1.0 class 1 = 0.485 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=1.0 class 2 = 0.536 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=1.0 all KL = 0.534 +- 0.300 (in-sample avg dev_std = 0.534)
NEC for r=1.0 all L1 = 0.511 +- 0.164 (in-sample avg dev_std = 0.534)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.524
Model XAI F1 of binarized graphs for r=0.3 =  0.7416225
Model XAI WIoU of binarized graphs for r=0.3 =  0.63188
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.388
NEC for r=0.3 class 0 = 0.54 +- 0.311 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 1 = 0.487 +- 0.311 (in-sample avg dev_std = 0.591)
NEC for r=0.3 class 2 = 0.574 +- 0.311 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all KL = 0.61 +- 0.311 (in-sample avg dev_std = 0.591)
NEC for r=0.3 all L1 = 0.533 +- 0.203 (in-sample avg dev_std = 0.591)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.837
Model XAI F1 of binarized graphs for r=0.6 =  0.56440375
Model XAI WIoU of binarized graphs for r=0.6 =  0.5640325
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.488
NEC for r=0.6 class 0 = 0.585 +- 0.266 (in-sample avg dev_std = 0.601)
NEC for r=0.6 class 1 = 0.573 +- 0.266 (in-sample avg dev_std = 0.601)
NEC for r=0.6 class 2 = 0.597 +- 0.266 (in-sample avg dev_std = 0.601)
NEC for r=0.6 all KL = 0.728 +- 0.266 (in-sample avg dev_std = 0.601)
NEC for r=0.6 all L1 = 0.585 +- 0.161 (in-sample avg dev_std = 0.601)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  0.42343875000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.5570499999999999
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.59
NEC for r=0.9 class 0 = 0.444 +- 0.296 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 1 = 0.493 +- 0.296 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 2 = 0.478 +- 0.296 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all KL = 0.522 +- 0.296 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all L1 = 0.472 +- 0.153 (in-sample avg dev_std = 0.581)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.836
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.5570499999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.596
NEC for r=1.0 class 0 = 0.423 +- 0.286 (in-sample avg dev_std = 0.557)
NEC for r=1.0 class 1 = 0.473 +- 0.286 (in-sample avg dev_std = 0.557)
NEC for r=1.0 class 2 = 0.471 +- 0.286 (in-sample avg dev_std = 0.557)
NEC for r=1.0 all KL = 0.481 +- 0.286 (in-sample avg dev_std = 0.557)
NEC for r=1.0 all L1 = 0.456 +- 0.151 (in-sample avg dev_std = 0.557)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:50:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:07 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:07 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:50:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:50:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.8943
Train Loss: 0.4664
ID Validation ACCURACY: 0.8900
ID Validation Loss: 0.4540
ID Test ACCURACY: 0.8863
ID Test Loss: 0.4885
OOD Validation ACCURACY: 0.9250
OOD Validation Loss: 0.4649
OOD Test ACCURACY: 0.8883
OOD Test Loss: 0.5286

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.8432
Train Loss: 0.5071
ID Validation ACCURACY: 0.8423
ID Validation Loss: 0.4963
ID Test ACCURACY: 0.8323
ID Test Loss: 0.5197
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4486
OOD Test ACCURACY: 0.7553
OOD Test Loss: 0.6816

[0m[1;37mINFO[0m: [1mChartInfo 0.8863 0.8883 0.8323 0.7553 0.8423 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.733
WIoU for r=0.3 = 0.710
F1 for r=0.6 = 0.626
WIoU for r=0.6 = 0.808
F1 for r=0.9 = 0.481
WIoU for r=0.9 = 0.812
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.812
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.737
WIoU for r=0.3 = 0.730
F1 for r=0.6 = 0.618
WIoU for r=0.6 = 0.823
F1 for r=0.9 = 0.473
WIoU for r=0.9 = 0.826
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.826
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.584
WIoU for r=0.3 = 0.679
F1 for r=0.6 = 0.506
WIoU for r=0.6 = 0.740
F1 for r=0.9 = 0.424
WIoU for r=0.9 = 0.715
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.712


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  0.7333812499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.7104199999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.431
SUFF++ for r=0.3 class 0 = 0.48 +- 0.280 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 1 = 0.527 +- 0.280 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 2 = 0.463 +- 0.280 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 all KL = 0.489 +- 0.280 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 all L1 = 0.49 +- 0.148 (in-sample avg dev_std = 0.513)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.6260275
Model XAI WIoU of binarized graphs for r=0.6 =  0.8080825
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.674
SUFF++ for r=0.6 class 0 = 0.558 +- 0.311 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 class 1 = 0.684 +- 0.311 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 class 2 = 0.534 +- 0.311 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all KL = 0.534 +- 0.311 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all L1 = 0.592 +- 0.198 (in-sample avg dev_std = 0.530)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.901
Model XAI F1 of binarized graphs for r=0.9 =  0.48123875
Model XAI WIoU of binarized graphs for r=0.9 =  0.811515
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0 = 0.759 +- 0.226 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 1 = 0.786 +- 0.226 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 2 = 0.766 +- 0.226 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all KL = 0.816 +- 0.226 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.196 (in-sample avg dev_std = 0.294)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.665
Model XAI F1 of binarized graphs for r=0.3 =  0.7373575
Model XAI WIoU of binarized graphs for r=0.3 =  0.7295212499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.43
SUFF++ for r=0.3 class 0 = 0.485 +- 0.281 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 class 1 = 0.526 +- 0.281 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 class 2 = 0.474 +- 0.281 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 all KL = 0.483 +- 0.281 (in-sample avg dev_std = 0.526)
SUFF++ for r=0.3 all L1 = 0.494 +- 0.149 (in-sample avg dev_std = 0.526)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.61768625
Model XAI WIoU of binarized graphs for r=0.6 =  0.8225337500000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.665
SUFF++ for r=0.6 class 0 = 0.567 +- 0.308 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 1 = 0.69 +- 0.308 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 class 2 = 0.541 +- 0.308 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all KL = 0.537 +- 0.308 (in-sample avg dev_std = 0.534)
SUFF++ for r=0.6 all L1 = 0.598 +- 0.194 (in-sample avg dev_std = 0.534)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.47320999999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.82553625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.827
SUFF++ for r=0.9 class 0 = 0.753 +- 0.211 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 1 = 0.79 +- 0.211 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 2 = 0.774 +- 0.211 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all KL = 0.824 +- 0.211 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all L1 = 0.773 +- 0.195 (in-sample avg dev_std = 0.294)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.561
Model XAI F1 of binarized graphs for r=0.3 =  0.58419
Model XAI WIoU of binarized graphs for r=0.3 =  0.6794337499999998
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.502
SUFF++ for r=0.3 class 0 = 0.555 +- 0.231 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 class 1 = 0.535 +- 0.231 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 class 2 = 0.535 +- 0.231 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 all KL = 0.557 +- 0.231 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.3 all L1 = 0.542 +- 0.150 (in-sample avg dev_std = 0.529)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.684
Model XAI F1 of binarized graphs for r=0.6 =  0.5056125
Model XAI WIoU of binarized graphs for r=0.6 =  0.74029875
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.682
SUFF++ for r=0.6 class 0 = 0.536 +- 0.348 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 1 = 0.6 +- 0.348 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 class 2 = 0.516 +- 0.348 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all KL = 0.556 +- 0.348 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.6 all L1 = 0.551 +- 0.221 (in-sample avg dev_std = 0.510)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7150987500000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0 = 0.797 +- 0.184 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1 = 0.914 +- 0.184 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 2 = 0.736 +- 0.184 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.881 +- 0.184 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.817 +- 0.225 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  0.7333812499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.7104199999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.361
NEC for r=0.3 class 0 = 0.502 +- 0.323 (in-sample avg dev_std = 0.409)
NEC for r=0.3 class 1 = 0.559 +- 0.323 (in-sample avg dev_std = 0.409)
NEC for r=0.3 class 2 = 0.517 +- 0.323 (in-sample avg dev_std = 0.409)
NEC for r=0.3 all KL = 0.509 +- 0.323 (in-sample avg dev_std = 0.409)
NEC for r=0.3 all L1 = 0.526 +- 0.179 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  0.6260275
Model XAI WIoU of binarized graphs for r=0.6 =  0.8080825
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.437
NEC for r=0.6 class 0 = 0.571 +- 0.298 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.574 +- 0.298 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.604 +- 0.298 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.638 +- 0.298 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.583 +- 0.151 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.901
Model XAI F1 of binarized graphs for r=0.9 =  0.48123875
Model XAI WIoU of binarized graphs for r=0.9 =  0.811515
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.478
NEC for r=0.9 class 0 = 0.531 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=0.9 class 1 = 0.522 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=0.9 class 2 = 0.556 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=0.9 all KL = 0.549 +- 0.298 (in-sample avg dev_std = 0.521)
NEC for r=0.9 all L1 = 0.536 +- 0.162 (in-sample avg dev_std = 0.521)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.811515
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.48
NEC for r=1.0 class 0 = 0.526 +- 0.294 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 1 = 0.508 +- 0.294 (in-sample avg dev_std = 0.515)
NEC for r=1.0 class 2 = 0.544 +- 0.294 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all KL = 0.529 +- 0.294 (in-sample avg dev_std = 0.515)
NEC for r=1.0 all L1 = 0.526 +- 0.164 (in-sample avg dev_std = 0.515)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.663
Model XAI F1 of binarized graphs for r=0.3 =  0.7373575
Model XAI WIoU of binarized graphs for r=0.3 =  0.7295212499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.37
NEC for r=0.3 class 0 = 0.51 +- 0.320 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 1 = 0.556 +- 0.320 (in-sample avg dev_std = 0.422)
NEC for r=0.3 class 2 = 0.523 +- 0.320 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all KL = 0.524 +- 0.320 (in-sample avg dev_std = 0.422)
NEC for r=0.3 all L1 = 0.53 +- 0.174 (in-sample avg dev_std = 0.422)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  0.61768625
Model XAI WIoU of binarized graphs for r=0.6 =  0.8225337500000001
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.451
NEC for r=0.6 class 0 = 0.573 +- 0.303 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 1 = 0.543 +- 0.303 (in-sample avg dev_std = 0.498)
NEC for r=0.6 class 2 = 0.597 +- 0.303 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all KL = 0.622 +- 0.303 (in-sample avg dev_std = 0.498)
NEC for r=0.6 all L1 = 0.572 +- 0.156 (in-sample avg dev_std = 0.498)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  0.47320999999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.82553625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.471
NEC for r=0.9 class 0 = 0.528 +- 0.297 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 1 = 0.51 +- 0.297 (in-sample avg dev_std = 0.517)
NEC for r=0.9 class 2 = 0.553 +- 0.297 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all KL = 0.541 +- 0.297 (in-sample avg dev_std = 0.517)
NEC for r=0.9 all L1 = 0.531 +- 0.161 (in-sample avg dev_std = 0.517)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.896
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.82553625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.488
NEC for r=1.0 class 0 = 0.512 +- 0.290 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 1 = 0.508 +- 0.290 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 2 = 0.53 +- 0.290 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all KL = 0.515 +- 0.290 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all L1 = 0.517 +- 0.157 (in-sample avg dev_std = 0.521)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.561
Model XAI F1 of binarized graphs for r=0.3 =  0.58419
Model XAI WIoU of binarized graphs for r=0.3 =  0.6794337499999998
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.559 +- 0.239 (in-sample avg dev_std = 0.491)
NEC for r=0.3 class 1 = 0.601 +- 0.239 (in-sample avg dev_std = 0.491)
NEC for r=0.3 class 2 = 0.567 +- 0.239 (in-sample avg dev_std = 0.491)
NEC for r=0.3 all KL = 0.562 +- 0.239 (in-sample avg dev_std = 0.491)
NEC for r=0.3 all L1 = 0.576 +- 0.115 (in-sample avg dev_std = 0.491)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  0.5056125
Model XAI WIoU of binarized graphs for r=0.6 =  0.74029875
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.502
NEC for r=0.6 class 0 = 0.469 +- 0.326 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 1 = 0.454 +- 0.326 (in-sample avg dev_std = 0.546)
NEC for r=0.6 class 2 = 0.514 +- 0.326 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all KL = 0.482 +- 0.326 (in-sample avg dev_std = 0.546)
NEC for r=0.6 all L1 = 0.479 +- 0.194 (in-sample avg dev_std = 0.546)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  0.42370375000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.7150987500000001
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.589
NEC for r=0.9 class 0 = 0.404 +- 0.321 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 1 = 0.459 +- 0.321 (in-sample avg dev_std = 0.510)
NEC for r=0.9 class 2 = 0.433 +- 0.321 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all KL = 0.416 +- 0.321 (in-sample avg dev_std = 0.510)
NEC for r=0.9 all L1 = 0.432 +- 0.196 (in-sample avg dev_std = 0.510)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.892
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.71208875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.594
NEC for r=1.0 class 0 = 0.41 +- 0.302 (in-sample avg dev_std = 0.519)
NEC for r=1.0 class 1 = 0.443 +- 0.302 (in-sample avg dev_std = 0.519)
NEC for r=1.0 class 2 = 0.374 +- 0.302 (in-sample avg dev_std = 0.519)
NEC for r=1.0 all KL = 0.392 +- 0.302 (in-sample avg dev_std = 0.519)
NEC for r=1.0 all L1 = 0.409 +- 0.184 (in-sample avg dev_std = 0.519)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.504, 0.615, 0.834, 1.0], 'all_L1': [0.562, 0.665, 0.797, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.493, 0.58, 0.838, 1.0], 'all_L1': [0.51, 0.638, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.596, 0.871, 1.0], 'all_L1': [0.491, 0.633, 0.82, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.604, 0.906, 1.0], 'all_L1': [0.547, 0.639, 0.849, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.534, 0.816, 1.0], 'all_L1': [0.49, 0.592, 0.77, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.606, 0.63, 0.553, 0.544], 'all_L1': [0.563, 0.559, 0.511, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.599, 0.537, 0.524], 'all_L1': [0.551, 0.541, 0.506, 0.501]}), defaultdict(<class 'list'>, {'all_KL': [0.583, 0.611, 0.551, 0.534], 'all_L1': [0.56, 0.569, 0.519, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.622, 0.555, 0.535], 'all_L1': [0.487, 0.586, 0.516, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.509, 0.638, 0.549, 0.529], 'all_L1': [0.526, 0.583, 0.536, 0.526]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.493, 0.621, 0.836, 1.0], 'all_L1': [0.561, 0.664, 0.798, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.497, 0.583, 0.856, 1.0], 'all_L1': [0.524, 0.635, 0.809, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.474, 0.594, 0.886, 1.0], 'all_L1': [0.5, 0.636, 0.834, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.56, 0.607, 0.9, 1.0], 'all_L1': [0.548, 0.634, 0.846, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.537, 0.824, 1.0], 'all_L1': [0.494, 0.598, 0.773, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.621, 0.626, 0.55, 0.541], 'all_L1': [0.571, 0.559, 0.51, 0.51]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.588, 0.535, 0.517], 'all_L1': [0.559, 0.54, 0.507, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.609, 0.542, 0.524], 'all_L1': [0.548, 0.563, 0.514, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.462, 0.613, 0.555, 0.534], 'all_L1': [0.488, 0.579, 0.518, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.622, 0.541, 0.515], 'all_L1': [0.53, 0.572, 0.531, 0.517]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.599, 0.595, 0.813, 1.0], 'all_L1': [0.639, 0.599, 0.837, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.546, 0.935, 1.0], 'all_L1': [0.617, 0.606, 0.89, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.582, 0.751, 1.0], 'all_L1': [0.497, 0.585, 0.724, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.549, 0.652, 0.882, 1.0], 'all_L1': [0.594, 0.717, 0.846, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.556, 0.881, 1.0], 'all_L1': [0.542, 0.551, 0.817, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.511, 0.459, 0.514, 0.483], 'all_L1': [0.478, 0.463, 0.447, 0.417]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.501, 0.432, 0.435], 'all_L1': [0.537, 0.466, 0.422, 0.421]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.497, 0.473, 0.445], 'all_L1': [0.556, 0.497, 0.454, 0.431]}), defaultdict(<class 'list'>, {'all_KL': [0.61, 0.728, 0.522, 0.481], 'all_L1': [0.533, 0.585, 0.472, 0.456]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.482, 0.416, 0.392], 'all_L1': [0.576, 0.479, 0.432, 0.409]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.520 +- 0.029, 0.633 +- 0.024, 0.806 +- 0.027, 1.000 +- 0.000
suff++ class all_KL  =  0.504 +- 0.034, 0.586 +- 0.028, 0.853 +- 0.032, 1.000 +- 0.000
suff++_acc_int  =  0.439 +- 0.020, 0.704 +- 0.017, 0.845 +- 0.019
nec class all_L1  =  0.537 +- 0.028, 0.568 +- 0.016, 0.518 +- 0.010, 0.511 +- 0.008
nec class all_KL  =  0.541 +- 0.054, 0.620 +- 0.014, 0.549 +- 0.006, 0.533 +- 0.007
nec_acc_int  =  0.333 +- 0.024, 0.459 +- 0.026, 0.526 +- 0.025, 0.533 +- 0.029

Eval split id_test
suff++ class all_L1  =  0.525 +- 0.026, 0.633 +- 0.021, 0.812 +- 0.026, 1.000 +- 0.000
suff++ class all_KL  =  0.501 +- 0.030, 0.588 +- 0.029, 0.860 +- 0.029, 1.000 +- 0.000
suff++_acc_int  =  0.440 +- 0.023, 0.694 +- 0.016, 0.838 +- 0.015
nec class all_L1  =  0.539 +- 0.029, 0.563 +- 0.013, 0.516 +- 0.008, 0.507 +- 0.008
nec class all_KL  =  0.549 +- 0.053, 0.612 +- 0.013, 0.545 +- 0.007, 0.526 +- 0.010
nec_acc_int  =  0.332 +- 0.032, 0.459 +- 0.020, 0.525 +- 0.029, 0.534 +- 0.024

Eval split test
suff++ class all_L1  =  0.578 +- 0.052, 0.612 +- 0.056, 0.823 +- 0.055, 1.000 +- 0.000
suff++ class all_KL  =  0.546 +- 0.047, 0.586 +- 0.037, 0.852 +- 0.064, 1.000 +- 0.000
suff++_acc_int  =  0.530 +- 0.034, 0.697 +- 0.053, 0.809 +- 0.017
nec class all_L1  =  0.536 +- 0.033, 0.498 +- 0.045, 0.445 +- 0.017, 0.427 +- 0.016
nec class all_KL  =  0.567 +- 0.033, 0.533 +- 0.098, 0.471 +- 0.042, 0.447 +- 0.034
nec_acc_int  =  0.398 +- 0.025, 0.491 +- 0.035, 0.575 +- 0.014, 0.591 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.529 +- 0.019, 0.600 +- 0.011, 0.662 +- 0.012, 0.756 +- 0.004
Faith. Armon (L1)= 		  =  0.528 +- 0.019, 0.598 +- 0.010, 0.630 +- 0.009, 0.677 +- 0.007
Faith. GMean (L1)= 	  =  0.528 +- 0.019, 0.599 +- 0.010, 0.646 +- 0.010, 0.715 +- 0.006
Faith. Aritm (KL)= 		  =  0.522 +- 0.019, 0.603 +- 0.014, 0.701 +- 0.018, 0.767 +- 0.003
Faith. Armon (KL)= 		  =  0.519 +- 0.018, 0.602 +- 0.015, 0.668 +- 0.013, 0.696 +- 0.006
Faith. GMean (KL)= 	  =  0.520 +- 0.018, 0.602 +- 0.014, 0.684 +- 0.015, 0.730 +- 0.005

Eval split id_test
Faith. Aritm (L1)= 		  =  0.532 +- 0.020, 0.598 +- 0.010, 0.664 +- 0.012, 0.754 +- 0.004
Faith. Armon (L1)= 		  =  0.531 +- 0.020, 0.596 +- 0.010, 0.631 +- 0.008, 0.673 +- 0.007
Faith. GMean (L1)= 	  =  0.532 +- 0.020, 0.597 +- 0.010, 0.647 +- 0.009, 0.712 +- 0.005
Faith. Aritm (KL)= 		  =  0.525 +- 0.019, 0.600 +- 0.016, 0.702 +- 0.016, 0.763 +- 0.005
Faith. Armon (KL)= 		  =  0.521 +- 0.017, 0.599 +- 0.017, 0.667 +- 0.012, 0.690 +- 0.009
Faith. GMean (KL)= 	  =  0.523 +- 0.018, 0.600 +- 0.016, 0.684 +- 0.014, 0.725 +- 0.007

Eval split test
Faith. Aritm (L1)= 		  =  0.557 +- 0.017, 0.555 +- 0.049, 0.634 +- 0.026, 0.713 +- 0.008
Faith. Armon (L1)= 		  =  0.553 +- 0.017, 0.549 +- 0.048, 0.577 +- 0.017, 0.598 +- 0.016
Faith. GMean (L1)= 	  =  0.555 +- 0.017, 0.552 +- 0.049, 0.605 +- 0.020, 0.653 +- 0.012
Faith. Aritm (KL)= 		  =  0.556 +- 0.019, 0.560 +- 0.065, 0.662 +- 0.031, 0.724 +- 0.017
Faith. Armon (KL)= 		  =  0.554 +- 0.022, 0.556 +- 0.066, 0.604 +- 0.033, 0.617 +- 0.032
Faith. GMean (KL)= 	  =  0.555 +- 0.020, 0.558 +- 0.066, 0.632 +- 0.030, 0.668 +- 0.025
Computed for split load_split = id



Completed in  0:16:20.073943  for LECIGIN GOODMotif2/basis



DONE LECI GOODMotif2/basis Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:53:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 07:53:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3211
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3074
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3410
OOD Validation ACCURACY: 0.7400
OOD Validation Loss: 0.6348
OOD Test ACCURACY: 0.6430
OOD Test Loss: 0.9218

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9288
Train Loss: 0.3242
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3107
ID Test ACCURACY: 0.9250
ID Test Loss: 0.3504
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4082
OOD Test ACCURACY: 0.6947
OOD Test Loss: 1.4640

[0m[1;37mINFO[0m: [1mChartInfo 0.9257 0.6430 0.9250 0.6947 0.9323 0.9310[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.719
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.598
WIoU for r=0.6 = 0.478
F1 for r=0.9 = 0.472
WIoU for r=0.9 = 0.349
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.330
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.709
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.589
WIoU for r=0.6 = 0.470
F1 for r=0.9 = 0.466
WIoU for r=0.9 = 0.343
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.581
WIoU for r=0.3 = 0.464
F1 for r=0.6 = 0.437
WIoU for r=0.6 = 0.314
F1 for r=0.9 = 0.380
WIoU for r=0.9 = 0.255
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.263


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.71900875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6033325
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.455
SUFF++ for r=0.3 class 0 = 0.448 +- 0.271 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.3 class 1 = 0.449 +- 0.271 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.3 class 2 = 0.516 +- 0.271 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.3 all KL = 0.477 +- 0.271 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.3 all L1 = 0.471 +- 0.160 (in-sample avg dev_std = 0.471)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.741
Model XAI F1 of binarized graphs for r=0.6 =  0.5975975
Model XAI WIoU of binarized graphs for r=0.6 =  0.47765500000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0 = 0.523 +- 0.249 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.6 class 1 = 0.692 +- 0.249 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.6 class 2 = 0.652 +- 0.249 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.6 all KL = 0.66 +- 0.249 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.6 all L1 = 0.622 +- 0.198 (in-sample avg dev_std = 0.393)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.919
Model XAI F1 of binarized graphs for r=0.9 =  0.47193624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.34861374999999994
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF++ for r=0.9 class 0 = 0.737 +- 0.174 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1 = 0.807 +- 0.174 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 2 = 0.807 +- 0.174 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.852 +- 0.174 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.784 +- 0.151 (in-sample avg dev_std = 0.278)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.47
Model XAI F1 of binarized graphs for r=0.3 =  0.7087299999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5927162500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.458
SUFF++ for r=0.3 class 0 = 0.459 +- 0.266 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 class 1 = 0.46 +- 0.266 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 class 2 = 0.518 +- 0.266 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 all KL = 0.496 +- 0.266 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 all L1 = 0.48 +- 0.157 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.686
Model XAI F1 of binarized graphs for r=0.6 =  0.5885125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4696875
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.706
SUFF++ for r=0.6 class 0 = 0.516 +- 0.255 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 1 = 0.69 +- 0.255 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 2 = 0.627 +- 0.255 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all KL = 0.65 +- 0.255 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all L1 = 0.611 +- 0.200 (in-sample avg dev_std = 0.394)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.46555125
Model XAI WIoU of binarized graphs for r=0.9 =  0.3430012499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.854
SUFF++ for r=0.9 class 0 = 0.739 +- 0.179 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 1 = 0.785 +- 0.179 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 class 2 = 0.799 +- 0.179 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all KL = 0.845 +- 0.179 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.9 all L1 = 0.775 +- 0.156 (in-sample avg dev_std = 0.275)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.551
Model XAI F1 of binarized graphs for r=0.3 =  0.58139875
Model XAI WIoU of binarized graphs for r=0.3 =  0.46376249999999997
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0 = 0.574 +- 0.295 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 1 = 0.573 +- 0.295 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 class 2 = 0.6 +- 0.295 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all KL = 0.597 +- 0.295 (in-sample avg dev_std = 0.488)
SUFF++ for r=0.3 all L1 = 0.583 +- 0.164 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.63
Model XAI F1 of binarized graphs for r=0.6 =  0.43725375
Model XAI WIoU of binarized graphs for r=0.6 =  0.31427374999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.639
SUFF++ for r=0.6 class 0 = 0.436 +- 0.271 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 1 = 0.608 +- 0.271 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 2 = 0.691 +- 0.271 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all KL = 0.631 +- 0.271 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all L1 = 0.58 +- 0.176 (in-sample avg dev_std = 0.386)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.544
Model XAI F1 of binarized graphs for r=0.9 =  0.379765
Model XAI WIoU of binarized graphs for r=0.9 =  0.25459125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.605
SUFF++ for r=0.9 class 0 = 0.595 +- 0.228 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 1 = 0.673 +- 0.228 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.228 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all KL = 0.803 +- 0.228 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all L1 = 0.708 +- 0.171 (in-sample avg dev_std = 0.308)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.71900875
Model XAI WIoU of binarized graphs for r=0.3 =  0.6033325
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.626 +- 0.260 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 1 = 0.607 +- 0.260 (in-sample avg dev_std = 0.403)
NEC for r=0.3 class 2 = 0.647 +- 0.260 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all KL = 0.638 +- 0.260 (in-sample avg dev_std = 0.403)
NEC for r=0.3 all L1 = 0.627 +- 0.140 (in-sample avg dev_std = 0.403)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.5975975
Model XAI WIoU of binarized graphs for r=0.6 =  0.47765500000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.397
NEC for r=0.6 class 0 = 0.598 +- 0.269 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 1 = 0.519 +- 0.269 (in-sample avg dev_std = 0.479)
NEC for r=0.6 class 2 = 0.651 +- 0.269 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all KL = 0.611 +- 0.269 (in-sample avg dev_std = 0.479)
NEC for r=0.6 all L1 = 0.589 +- 0.170 (in-sample avg dev_std = 0.479)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.918
Model XAI F1 of binarized graphs for r=0.9 =  0.47193624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.34861374999999994
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.503
NEC for r=0.9 class 0 = 0.56 +- 0.224 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 1 = 0.533 +- 0.224 (in-sample avg dev_std = 0.588)
NEC for r=0.9 class 2 = 0.569 +- 0.224 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all KL = 0.589 +- 0.224 (in-sample avg dev_std = 0.588)
NEC for r=0.9 all L1 = 0.554 +- 0.150 (in-sample avg dev_std = 0.588)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.33003249999999995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.539
NEC for r=1.0 class 0 = 0.537 +- 0.223 (in-sample avg dev_std = 0.640)
NEC for r=1.0 class 1 = 0.469 +- 0.223 (in-sample avg dev_std = 0.640)
NEC for r=1.0 class 2 = 0.582 +- 0.223 (in-sample avg dev_std = 0.640)
NEC for r=1.0 all KL = 0.581 +- 0.223 (in-sample avg dev_std = 0.640)
NEC for r=1.0 all L1 = 0.529 +- 0.157 (in-sample avg dev_std = 0.640)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.47
Model XAI F1 of binarized graphs for r=0.3 =  0.7087299999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5927162500000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.311
NEC for r=0.3 class 0 = 0.624 +- 0.267 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 1 = 0.592 +- 0.267 (in-sample avg dev_std = 0.405)
NEC for r=0.3 class 2 = 0.629 +- 0.267 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all KL = 0.616 +- 0.267 (in-sample avg dev_std = 0.405)
NEC for r=0.3 all L1 = 0.616 +- 0.146 (in-sample avg dev_std = 0.405)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.684
Model XAI F1 of binarized graphs for r=0.6 =  0.5885125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4696875
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.397
NEC for r=0.6 class 0 = 0.596 +- 0.267 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 1 = 0.517 +- 0.267 (in-sample avg dev_std = 0.466)
NEC for r=0.6 class 2 = 0.636 +- 0.267 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all KL = 0.599 +- 0.267 (in-sample avg dev_std = 0.466)
NEC for r=0.6 all L1 = 0.584 +- 0.169 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.46555125
Model XAI WIoU of binarized graphs for r=0.9 =  0.3430012499999999
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.513
NEC for r=0.9 class 0 = 0.555 +- 0.221 (in-sample avg dev_std = 0.594)
NEC for r=0.9 class 1 = 0.525 +- 0.221 (in-sample avg dev_std = 0.594)
NEC for r=0.9 class 2 = 0.575 +- 0.221 (in-sample avg dev_std = 0.594)
NEC for r=0.9 all KL = 0.587 +- 0.221 (in-sample avg dev_std = 0.594)
NEC for r=0.9 all L1 = 0.552 +- 0.145 (in-sample avg dev_std = 0.594)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32317125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.542
NEC for r=1.0 class 0 = 0.539 +- 0.230 (in-sample avg dev_std = 0.641)
NEC for r=1.0 class 1 = 0.465 +- 0.230 (in-sample avg dev_std = 0.641)
NEC for r=1.0 class 2 = 0.569 +- 0.230 (in-sample avg dev_std = 0.641)
NEC for r=1.0 all KL = 0.58 +- 0.230 (in-sample avg dev_std = 0.641)
NEC for r=1.0 all L1 = 0.525 +- 0.161 (in-sample avg dev_std = 0.641)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.551
Model XAI F1 of binarized graphs for r=0.3 =  0.58139875
Model XAI WIoU of binarized graphs for r=0.3 =  0.46376249999999997
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.423
NEC for r=0.3 class 0 = 0.515 +- 0.262 (in-sample avg dev_std = 0.492)
NEC for r=0.3 class 1 = 0.623 +- 0.262 (in-sample avg dev_std = 0.492)
NEC for r=0.3 class 2 = 0.601 +- 0.262 (in-sample avg dev_std = 0.492)
NEC for r=0.3 all KL = 0.609 +- 0.262 (in-sample avg dev_std = 0.492)
NEC for r=0.3 all L1 = 0.581 +- 0.145 (in-sample avg dev_std = 0.492)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.63
Model XAI F1 of binarized graphs for r=0.6 =  0.43725375
Model XAI WIoU of binarized graphs for r=0.6 =  0.31427374999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.43
NEC for r=0.6 class 0 = 0.602 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.6 class 1 = 0.57 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.6 class 2 = 0.592 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.6 all KL = 0.564 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.6 all L1 = 0.588 +- 0.149 (in-sample avg dev_std = 0.464)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.546
Model XAI F1 of binarized graphs for r=0.9 =  0.379765
Model XAI WIoU of binarized graphs for r=0.9 =  0.25459125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.532
NEC for r=0.9 class 0 = 0.547 +- 0.292 (in-sample avg dev_std = 0.494)
NEC for r=0.9 class 1 = 0.487 +- 0.292 (in-sample avg dev_std = 0.494)
NEC for r=0.9 class 2 = 0.447 +- 0.292 (in-sample avg dev_std = 0.494)
NEC for r=0.9 all KL = 0.48 +- 0.292 (in-sample avg dev_std = 0.494)
NEC for r=0.9 all L1 = 0.493 +- 0.150 (in-sample avg dev_std = 0.494)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.663
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26272125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.568
NEC for r=1.0 class 0 = 0.499 +- 0.254 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 1 = 0.427 +- 0.254 (in-sample avg dev_std = 0.486)
NEC for r=1.0 class 2 = 0.375 +- 0.254 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all KL = 0.419 +- 0.254 (in-sample avg dev_std = 0.486)
NEC for r=1.0 all L1 = 0.433 +- 0.147 (in-sample avg dev_std = 0.486)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 19:57:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 07:57:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3181
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3082
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3613
OOD Test ACCURACY: 0.6100
OOD Test Loss: 1.0959

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3180
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.3069
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3479
OOD Test ACCURACY: 0.7810
OOD Test Loss: 0.8339

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.6100 0.9257 0.7810 0.9340 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.653
WIoU for r=0.3 = 0.532
F1 for r=0.6 = 0.538
WIoU for r=0.6 = 0.417
F1 for r=0.9 = 0.452
WIoU for r=0.9 = 0.327
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.325
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.640
WIoU for r=0.3 = 0.517
F1 for r=0.6 = 0.529
WIoU for r=0.6 = 0.410
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.320
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.318
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.578
WIoU for r=0.3 = 0.454
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.298
F1 for r=0.9 = 0.376
WIoU for r=0.9 = 0.250
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.259


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.398
Model XAI F1 of binarized graphs for r=0.3 =  0.6531812499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.53188
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.429
SUFF++ for r=0.3 class 0 = 0.469 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 class 1 = 0.542 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 class 2 = 0.548 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 all KL = 0.564 +- 0.259 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.3 all L1 = 0.52 +- 0.149 (in-sample avg dev_std = 0.474)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.654
Model XAI F1 of binarized graphs for r=0.6 =  0.5376175000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.4172624999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0 = 0.5 +- 0.225 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 1 = 0.629 +- 0.225 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 2 = 0.675 +- 0.225 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 all KL = 0.663 +- 0.225 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 all L1 = 0.601 +- 0.168 (in-sample avg dev_std = 0.413)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.45206874999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.3273125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.85
SUFF++ for r=0.9 class 0 = 0.634 +- 0.172 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 1 = 0.877 +- 0.172 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 class 2 = 0.818 +- 0.172 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all KL = 0.849 +- 0.172 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.157 (in-sample avg dev_std = 0.338)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.398
Model XAI F1 of binarized graphs for r=0.3 =  0.6398675
Model XAI WIoU of binarized graphs for r=0.3 =  0.51730875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.439
SUFF++ for r=0.3 class 0 = 0.471 +- 0.248 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 1 = 0.558 +- 0.248 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 class 2 = 0.556 +- 0.248 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all KL = 0.581 +- 0.248 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.3 all L1 = 0.529 +- 0.149 (in-sample avg dev_std = 0.465)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  0.5293950000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.4098075
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0 = 0.508 +- 0.226 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 1 = 0.629 +- 0.226 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 2 = 0.653 +- 0.226 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all KL = 0.658 +- 0.226 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all L1 = 0.597 +- 0.170 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.44312875000000007
Model XAI WIoU of binarized graphs for r=0.9 =  0.32033500000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.845
SUFF++ for r=0.9 class 0 = 0.638 +- 0.166 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 1 = 0.865 +- 0.166 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 2 = 0.825 +- 0.166 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all KL = 0.852 +- 0.166 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.151 (in-sample avg dev_std = 0.335)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.577925
Model XAI WIoU of binarized graphs for r=0.3 =  0.45382999999999996
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.478
SUFF++ for r=0.3 class 0 = 0.592 +- 0.299 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 class 1 = 0.611 +- 0.299 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 class 2 = 0.582 +- 0.299 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 all KL = 0.641 +- 0.299 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 all L1 = 0.595 +- 0.165 (in-sample avg dev_std = 0.450)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.52
Model XAI F1 of binarized graphs for r=0.6 =  0.4180175
Model XAI WIoU of binarized graphs for r=0.6 =  0.29779625000000004
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.578
SUFF++ for r=0.6 class 0 = 0.443 +- 0.302 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 1 = 0.609 +- 0.302 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 class 2 = 0.56 +- 0.302 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all KL = 0.597 +- 0.302 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.6 all L1 = 0.539 +- 0.181 (in-sample avg dev_std = 0.379)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.62
Model XAI F1 of binarized graphs for r=0.9 =  0.3762175
Model XAI WIoU of binarized graphs for r=0.9 =  0.24959
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.594
SUFF++ for r=0.9 class 0 = 0.655 +- 0.197 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1 = 0.73 +- 0.197 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 2 = 0.835 +- 0.197 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.812 +- 0.197 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.741 +- 0.162 (in-sample avg dev_std = 0.261)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.398
Model XAI F1 of binarized graphs for r=0.3 =  0.6531812499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.53188
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.521 +- 0.287 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 1 = 0.413 +- 0.287 (in-sample avg dev_std = 0.367)
NEC for r=0.3 class 2 = 0.591 +- 0.287 (in-sample avg dev_std = 0.367)
NEC for r=0.3 all KL = 0.447 +- 0.287 (in-sample avg dev_std = 0.367)
NEC for r=0.3 all L1 = 0.508 +- 0.190 (in-sample avg dev_std = 0.367)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.654
Model XAI F1 of binarized graphs for r=0.6 =  0.5376175000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.4172624999999999
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.353
NEC for r=0.6 class 0 = 0.51 +- 0.288 (in-sample avg dev_std = 0.419)
NEC for r=0.6 class 1 = 0.5 +- 0.288 (in-sample avg dev_std = 0.419)
NEC for r=0.6 class 2 = 0.63 +- 0.288 (in-sample avg dev_std = 0.419)
NEC for r=0.6 all KL = 0.526 +- 0.288 (in-sample avg dev_std = 0.419)
NEC for r=0.6 all L1 = 0.546 +- 0.179 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.94
Model XAI F1 of binarized graphs for r=0.9 =  0.45206874999999996
Model XAI WIoU of binarized graphs for r=0.9 =  0.3273125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.484
NEC for r=0.9 class 0 = 0.609 +- 0.214 (in-sample avg dev_std = 0.556)
NEC for r=0.9 class 1 = 0.457 +- 0.214 (in-sample avg dev_std = 0.556)
NEC for r=0.9 class 2 = 0.571 +- 0.214 (in-sample avg dev_std = 0.556)
NEC for r=0.9 all KL = 0.564 +- 0.214 (in-sample avg dev_std = 0.556)
NEC for r=0.9 all L1 = 0.545 +- 0.161 (in-sample avg dev_std = 0.556)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.3246724999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.525
NEC for r=1.0 class 0 = 0.597 +- 0.214 (in-sample avg dev_std = 0.614)
NEC for r=1.0 class 1 = 0.438 +- 0.214 (in-sample avg dev_std = 0.614)
NEC for r=1.0 class 2 = 0.555 +- 0.214 (in-sample avg dev_std = 0.614)
NEC for r=1.0 all KL = 0.573 +- 0.214 (in-sample avg dev_std = 0.614)
NEC for r=1.0 all L1 = 0.53 +- 0.169 (in-sample avg dev_std = 0.614)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.396
Model XAI F1 of binarized graphs for r=0.3 =  0.6398675
Model XAI WIoU of binarized graphs for r=0.3 =  0.51730875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.32
NEC for r=0.3 class 0 = 0.523 +- 0.285 (in-sample avg dev_std = 0.380)
NEC for r=0.3 class 1 = 0.388 +- 0.285 (in-sample avg dev_std = 0.380)
NEC for r=0.3 class 2 = 0.58 +- 0.285 (in-sample avg dev_std = 0.380)
NEC for r=0.3 all KL = 0.439 +- 0.285 (in-sample avg dev_std = 0.380)
NEC for r=0.3 all L1 = 0.499 +- 0.191 (in-sample avg dev_std = 0.380)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.619
Model XAI F1 of binarized graphs for r=0.6 =  0.5293950000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.4098075
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.353
NEC for r=0.6 class 0 = 0.511 +- 0.286 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 1 = 0.478 +- 0.286 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 2 = 0.627 +- 0.286 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all KL = 0.514 +- 0.286 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all L1 = 0.541 +- 0.184 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  0.44312875000000007
Model XAI WIoU of binarized graphs for r=0.9 =  0.32033500000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.497
NEC for r=0.9 class 0 = 0.598 +- 0.212 (in-sample avg dev_std = 0.556)
NEC for r=0.9 class 1 = 0.437 +- 0.212 (in-sample avg dev_std = 0.556)
NEC for r=0.9 class 2 = 0.562 +- 0.212 (in-sample avg dev_std = 0.556)
NEC for r=0.9 all KL = 0.545 +- 0.212 (in-sample avg dev_std = 0.556)
NEC for r=0.9 all L1 = 0.533 +- 0.162 (in-sample avg dev_std = 0.556)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.936
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31817
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.59 +- 0.230 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 1 = 0.406 +- 0.230 (in-sample avg dev_std = 0.610)
NEC for r=1.0 class 2 = 0.555 +- 0.230 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all KL = 0.557 +- 0.230 (in-sample avg dev_std = 0.610)
NEC for r=1.0 all L1 = 0.518 +- 0.179 (in-sample avg dev_std = 0.610)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.577925
Model XAI WIoU of binarized graphs for r=0.3 =  0.45382999999999996
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.388
NEC for r=0.3 class 0 = 0.507 +- 0.283 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 1 = 0.564 +- 0.283 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 2 = 0.642 +- 0.283 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all KL = 0.557 +- 0.283 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all L1 = 0.571 +- 0.145 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.52
Model XAI F1 of binarized graphs for r=0.6 =  0.4180175
Model XAI WIoU of binarized graphs for r=0.6 =  0.29779625000000004
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.583 +- 0.304 (in-sample avg dev_std = 0.400)
NEC for r=0.6 class 1 = 0.479 +- 0.304 (in-sample avg dev_std = 0.400)
NEC for r=0.6 class 2 = 0.569 +- 0.304 (in-sample avg dev_std = 0.400)
NEC for r=0.6 all KL = 0.547 +- 0.304 (in-sample avg dev_std = 0.400)
NEC for r=0.6 all L1 = 0.543 +- 0.172 (in-sample avg dev_std = 0.400)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.62
Model XAI F1 of binarized graphs for r=0.9 =  0.3762175
Model XAI WIoU of binarized graphs for r=0.9 =  0.24959
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.538
NEC for r=0.9 class 0 = 0.579 +- 0.305 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 1 = 0.409 +- 0.305 (in-sample avg dev_std = 0.514)
NEC for r=0.9 class 2 = 0.464 +- 0.305 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all KL = 0.495 +- 0.305 (in-sample avg dev_std = 0.514)
NEC for r=0.9 all L1 = 0.483 +- 0.172 (in-sample avg dev_std = 0.514)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.629
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.25863875000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.572
NEC for r=1.0 class 0 = 0.492 +- 0.267 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 1 = 0.391 +- 0.267 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 2 = 0.409 +- 0.267 (in-sample avg dev_std = 0.462)
NEC for r=1.0 all KL = 0.408 +- 0.267 (in-sample avg dev_std = 0.462)
NEC for r=1.0 all L1 = 0.43 +- 0.145 (in-sample avg dev_std = 0.462)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:00:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 08:00:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9307
Train Loss: 0.3209
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3150
ID Test ACCURACY: 0.9263
ID Test Loss: 0.3448
OOD Validation ACCURACY: 0.9003
OOD Validation Loss: 0.4153
OOD Test ACCURACY: 0.6290
OOD Test Loss: 1.2379

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3329
ID Validation ACCURACY: 0.9350
ID Validation Loss: 0.3287
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3579
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3915
OOD Test ACCURACY: 0.6263
OOD Test Loss: 1.1262

[0m[1;37mINFO[0m: [1mChartInfo 0.9263 0.6290 0.9257 0.6263 0.9350 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.707
WIoU for r=0.3 = 0.588
F1 for r=0.6 = 0.587
WIoU for r=0.6 = 0.465
F1 for r=0.9 = 0.458
WIoU for r=0.9 = 0.334
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.328
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.700
WIoU for r=0.3 = 0.579
F1 for r=0.6 = 0.580
WIoU for r=0.6 = 0.458
F1 for r=0.9 = 0.451
WIoU for r=0.9 = 0.328
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.321
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.662
WIoU for r=0.3 = 0.529
F1 for r=0.6 = 0.482
WIoU for r=0.6 = 0.350
F1 for r=0.9 = 0.395
WIoU for r=0.9 = 0.269
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.264


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.425
Model XAI F1 of binarized graphs for r=0.3 =  0.7067762500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.58772125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.419
SUFF++ for r=0.3 class 0 = 0.478 +- 0.254 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 1 = 0.483 +- 0.254 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 2 = 0.547 +- 0.254 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all KL = 0.574 +- 0.254 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all L1 = 0.503 +- 0.159 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.58728125
Model XAI WIoU of binarized graphs for r=0.6 =  0.46539499999999995
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.693
SUFF++ for r=0.6 class 0 = 0.474 +- 0.232 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1 = 0.653 +- 0.232 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.232 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.691 +- 0.232 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.621 +- 0.194 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.45797625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.33411
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.843
SUFF++ for r=0.9 class 0 = 0.641 +- 0.187 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 class 1 = 0.821 +- 0.187 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.187 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 all KL = 0.845 +- 0.187 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.9 all L1 = 0.772 +- 0.165 (in-sample avg dev_std = 0.317)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.394
Model XAI F1 of binarized graphs for r=0.3 =  0.6996475000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5791474999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.421
SUFF++ for r=0.3 class 0 = 0.478 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 class 1 = 0.477 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 class 2 = 0.563 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 all KL = 0.587 +- 0.252 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.3 all L1 = 0.507 +- 0.159 (in-sample avg dev_std = 0.423)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.735
Model XAI F1 of binarized graphs for r=0.6 =  0.57975125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4579625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0 = 0.475 +- 0.236 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 class 1 = 0.663 +- 0.236 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 class 2 = 0.705 +- 0.236 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 all KL = 0.69 +- 0.236 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.6 all L1 = 0.616 +- 0.192 (in-sample avg dev_std = 0.380)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.45069249999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.32804375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.841
SUFF++ for r=0.9 class 0 = 0.643 +- 0.186 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 class 1 = 0.817 +- 0.186 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 class 2 = 0.863 +- 0.186 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 all KL = 0.849 +- 0.186 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.167 (in-sample avg dev_std = 0.310)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.562
Model XAI F1 of binarized graphs for r=0.3 =  0.6615937500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.52871375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.512
SUFF++ for r=0.3 class 0 = 0.567 +- 0.273 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 1 = 0.571 +- 0.273 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 2 = 0.588 +- 0.273 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all KL = 0.613 +- 0.273 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all L1 = 0.575 +- 0.170 (in-sample avg dev_std = 0.479)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.48150000000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.35010874999999997
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.696
SUFF++ for r=0.6 class 0 = 0.511 +- 0.170 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 class 1 = 0.641 +- 0.170 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 class 2 = 0.771 +- 0.170 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 all KL = 0.75 +- 0.170 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.6 all L1 = 0.642 +- 0.165 (in-sample avg dev_std = 0.353)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.645
Model XAI F1 of binarized graphs for r=0.9 =  0.39462875
Model XAI WIoU of binarized graphs for r=0.9 =  0.26871875
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.681
SUFF++ for r=0.9 class 0 = 0.645 +- 0.233 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1 = 0.66 +- 0.233 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 2 = 0.888 +- 0.233 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.796 +- 0.233 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.731 +- 0.200 (in-sample avg dev_std = 0.278)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.426
Model XAI F1 of binarized graphs for r=0.3 =  0.7067762500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.58772125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.315
NEC for r=0.3 class 0 = 0.597 +- 0.271 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 1 = 0.549 +- 0.271 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 2 = 0.604 +- 0.271 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all KL = 0.52 +- 0.271 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all L1 = 0.584 +- 0.158 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  0.58728125
Model XAI WIoU of binarized graphs for r=0.6 =  0.46539499999999995
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.364
NEC for r=0.6 class 0 = 0.605 +- 0.256 (in-sample avg dev_std = 0.448)
NEC for r=0.6 class 1 = 0.571 +- 0.256 (in-sample avg dev_std = 0.448)
NEC for r=0.6 class 2 = 0.614 +- 0.256 (in-sample avg dev_std = 0.448)
NEC for r=0.6 all KL = 0.581 +- 0.256 (in-sample avg dev_std = 0.448)
NEC for r=0.6 all L1 = 0.596 +- 0.143 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  0.45797625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.33411
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.485
NEC for r=0.9 class 0 = 0.588 +- 0.223 (in-sample avg dev_std = 0.550)
NEC for r=0.9 class 1 = 0.496 +- 0.223 (in-sample avg dev_std = 0.550)
NEC for r=0.9 class 2 = 0.557 +- 0.223 (in-sample avg dev_std = 0.550)
NEC for r=0.9 all KL = 0.546 +- 0.223 (in-sample avg dev_std = 0.550)
NEC for r=0.9 all L1 = 0.547 +- 0.154 (in-sample avg dev_std = 0.550)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32782875000000006
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.532
NEC for r=1.0 class 0 = 0.558 +- 0.225 (in-sample avg dev_std = 0.589)
NEC for r=1.0 class 1 = 0.442 +- 0.225 (in-sample avg dev_std = 0.589)
NEC for r=1.0 class 2 = 0.542 +- 0.225 (in-sample avg dev_std = 0.589)
NEC for r=1.0 all KL = 0.522 +- 0.225 (in-sample avg dev_std = 0.589)
NEC for r=1.0 all L1 = 0.514 +- 0.163 (in-sample avg dev_std = 0.589)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.395
Model XAI F1 of binarized graphs for r=0.3 =  0.6996475000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5791474999999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.584 +- 0.274 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 1 = 0.538 +- 0.274 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 2 = 0.597 +- 0.274 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all KL = 0.504 +- 0.274 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all L1 = 0.574 +- 0.159 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.736
Model XAI F1 of binarized graphs for r=0.6 =  0.57975125
Model XAI WIoU of binarized graphs for r=0.6 =  0.4579625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.367
NEC for r=0.6 class 0 = 0.61 +- 0.254 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 1 = 0.556 +- 0.254 (in-sample avg dev_std = 0.446)
NEC for r=0.6 class 2 = 0.616 +- 0.254 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all KL = 0.573 +- 0.254 (in-sample avg dev_std = 0.446)
NEC for r=0.6 all L1 = 0.594 +- 0.142 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.924
Model XAI F1 of binarized graphs for r=0.9 =  0.45069249999999994
Model XAI WIoU of binarized graphs for r=0.9 =  0.32804375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.583 +- 0.226 (in-sample avg dev_std = 0.545)
NEC for r=0.9 class 1 = 0.493 +- 0.226 (in-sample avg dev_std = 0.545)
NEC for r=0.9 class 2 = 0.543 +- 0.226 (in-sample avg dev_std = 0.545)
NEC for r=0.9 all KL = 0.537 +- 0.226 (in-sample avg dev_std = 0.545)
NEC for r=0.9 all L1 = 0.54 +- 0.158 (in-sample avg dev_std = 0.545)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.936
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32116875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.534
NEC for r=1.0 class 0 = 0.559 +- 0.235 (in-sample avg dev_std = 0.589)
NEC for r=1.0 class 1 = 0.443 +- 0.235 (in-sample avg dev_std = 0.589)
NEC for r=1.0 class 2 = 0.532 +- 0.235 (in-sample avg dev_std = 0.589)
NEC for r=1.0 all KL = 0.521 +- 0.235 (in-sample avg dev_std = 0.589)
NEC for r=1.0 all L1 = 0.512 +- 0.167 (in-sample avg dev_std = 0.589)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.561
Model XAI F1 of binarized graphs for r=0.3 =  0.6615937500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.52871375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.393
NEC for r=0.3 class 0 = 0.512 +- 0.273 (in-sample avg dev_std = 0.502)
NEC for r=0.3 class 1 = 0.625 +- 0.273 (in-sample avg dev_std = 0.502)
NEC for r=0.3 class 2 = 0.683 +- 0.273 (in-sample avg dev_std = 0.502)
NEC for r=0.3 all KL = 0.63 +- 0.273 (in-sample avg dev_std = 0.502)
NEC for r=0.3 all L1 = 0.608 +- 0.140 (in-sample avg dev_std = 0.502)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.676
Model XAI F1 of binarized graphs for r=0.6 =  0.48150000000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.35010874999999997
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.431
NEC for r=0.6 class 0 = 0.502 +- 0.248 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 1 = 0.527 +- 0.248 (in-sample avg dev_std = 0.506)
NEC for r=0.6 class 2 = 0.592 +- 0.248 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all KL = 0.495 +- 0.248 (in-sample avg dev_std = 0.506)
NEC for r=0.6 all L1 = 0.541 +- 0.138 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.644
Model XAI F1 of binarized graphs for r=0.9 =  0.39462875
Model XAI WIoU of binarized graphs for r=0.9 =  0.26871875
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.551
NEC for r=0.9 class 0 = 0.57 +- 0.314 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 1 = 0.465 +- 0.314 (in-sample avg dev_std = 0.523)
NEC for r=0.9 class 2 = 0.43 +- 0.314 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all KL = 0.525 +- 0.314 (in-sample avg dev_std = 0.523)
NEC for r=0.9 all L1 = 0.487 +- 0.164 (in-sample avg dev_std = 0.523)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.649
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.26445
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.48 +- 0.277 (in-sample avg dev_std = 0.490)
NEC for r=1.0 class 1 = 0.419 +- 0.277 (in-sample avg dev_std = 0.490)
NEC for r=1.0 class 2 = 0.345 +- 0.277 (in-sample avg dev_std = 0.490)
NEC for r=1.0 all KL = 0.423 +- 0.277 (in-sample avg dev_std = 0.490)
NEC for r=1.0 all L1 = 0.414 +- 0.156 (in-sample avg dev_std = 0.490)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:03:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 08:03:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3166
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3061
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3380
OOD Validation ACCURACY: 0.8590
OOD Validation Loss: 0.4854
OOD Test ACCURACY: 0.6477
OOD Test Loss: 1.2088

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9204
Train Loss: 0.3412
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3331
ID Test ACCURACY: 0.9170
ID Test Loss: 0.3587
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3909
OOD Test ACCURACY: 0.5560
OOD Test Loss: 1.3177

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6477 0.9170 0.5560 0.9260 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.691
WIoU for r=0.3 = 0.567
F1 for r=0.6 = 0.568
WIoU for r=0.6 = 0.443
F1 for r=0.9 = 0.462
WIoU for r=0.9 = 0.337
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.328
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.679
WIoU for r=0.3 = 0.554
F1 for r=0.6 = 0.555
WIoU for r=0.6 = 0.430
F1 for r=0.9 = 0.454
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.321
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.678
WIoU for r=0.3 = 0.550
F1 for r=0.6 = 0.485
WIoU for r=0.6 = 0.351
F1 for r=0.9 = 0.393
WIoU for r=0.9 = 0.267
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.264


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.391
Model XAI F1 of binarized graphs for r=0.3 =  0.6908924999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.56724125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.422
SUFF++ for r=0.3 class 0 = 0.484 +- 0.243 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 class 1 = 0.525 +- 0.243 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 class 2 = 0.545 +- 0.243 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 all KL = 0.582 +- 0.243 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 all L1 = 0.518 +- 0.145 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.678
Model XAI F1 of binarized graphs for r=0.6 =  0.5677550000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.44275374999999995
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.619
SUFF++ for r=0.6 class 0 = 0.489 +- 0.226 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 1 = 0.65 +- 0.226 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 class 2 = 0.651 +- 0.226 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 all KL = 0.66 +- 0.226 (in-sample avg dev_std = 0.413)
SUFF++ for r=0.6 all L1 = 0.597 +- 0.168 (in-sample avg dev_std = 0.413)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  0.46211874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.3373175
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0 = 0.642 +- 0.181 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 1 = 0.836 +- 0.181 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 2 = 0.775 +- 0.181 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all KL = 0.833 +- 0.181 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all L1 = 0.751 +- 0.173 (in-sample avg dev_std = 0.315)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.386
Model XAI F1 of binarized graphs for r=0.3 =  0.6788537499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5537175000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.429
SUFF++ for r=0.3 class 0 = 0.475 +- 0.236 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 1 = 0.532 +- 0.236 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 2 = 0.537 +- 0.236 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all KL = 0.586 +- 0.236 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all L1 = 0.515 +- 0.144 (in-sample avg dev_std = 0.453)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.5549062499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4297175
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.613
SUFF++ for r=0.6 class 0 = 0.489 +- 0.227 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 class 1 = 0.65 +- 0.227 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 class 2 = 0.634 +- 0.227 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all KL = 0.661 +- 0.227 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all L1 = 0.591 +- 0.168 (in-sample avg dev_std = 0.408)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.45367375000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.33000999999999997
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0 = 0.664 +- 0.169 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.169 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.9 class 2 = 0.777 +- 0.169 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.9 all KL = 0.835 +- 0.169 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.9 all L1 = 0.753 +- 0.159 (in-sample avg dev_std = 0.318)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.377
Model XAI F1 of binarized graphs for r=0.3 =  0.6782024999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.5498237499999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.488
SUFF++ for r=0.3 class 0 = 0.487 +- 0.287 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 1 = 0.606 +- 0.287 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 2 = 0.586 +- 0.287 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all KL = 0.58 +- 0.287 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all L1 = 0.561 +- 0.177 (in-sample avg dev_std = 0.454)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.548
Model XAI F1 of binarized graphs for r=0.6 =  0.48478375000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.3511475
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.609
SUFF++ for r=0.6 class 0 = 0.549 +- 0.184 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.6 class 1 = 0.687 +- 0.184 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.6 class 2 = 0.634 +- 0.184 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.6 all KL = 0.728 +- 0.184 (in-sample avg dev_std = 0.317)
SUFF++ for r=0.6 all L1 = 0.624 +- 0.150 (in-sample avg dev_std = 0.317)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.55
Model XAI F1 of binarized graphs for r=0.9 =  0.39322375
Model XAI WIoU of binarized graphs for r=0.9 =  0.26726374999999997
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.538
SUFF++ for r=0.9 class 0 = 0.602 +- 0.212 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 class 1 = 0.709 +- 0.212 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 class 2 = 0.83 +- 0.212 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 all KL = 0.788 +- 0.212 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 all L1 = 0.715 +- 0.183 (in-sample avg dev_std = 0.312)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.391
Model XAI F1 of binarized graphs for r=0.3 =  0.6908924999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.56724125
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
NEC for r=0.3 class 0 = 0.588 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 1 = 0.447 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 2 = 0.604 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all KL = 0.485 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all L1 = 0.546 +- 0.179 (in-sample avg dev_std = 0.382)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.678
Model XAI F1 of binarized graphs for r=0.6 =  0.5677550000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.44275374999999995
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.38
NEC for r=0.6 class 0 = 0.561 +- 0.258 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 1 = 0.478 +- 0.258 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 2 = 0.62 +- 0.258 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all KL = 0.539 +- 0.258 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all L1 = 0.553 +- 0.164 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  0.46211874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.3373175
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.49
NEC for r=0.9 class 0 = 0.612 +- 0.198 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 1 = 0.496 +- 0.198 (in-sample avg dev_std = 0.543)
NEC for r=0.9 class 2 = 0.554 +- 0.198 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all KL = 0.561 +- 0.198 (in-sample avg dev_std = 0.543)
NEC for r=0.9 all L1 = 0.554 +- 0.138 (in-sample avg dev_std = 0.543)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32786249999999995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.531
NEC for r=1.0 class 0 = 0.59 +- 0.217 (in-sample avg dev_std = 0.604)
NEC for r=1.0 class 1 = 0.429 +- 0.217 (in-sample avg dev_std = 0.604)
NEC for r=1.0 class 2 = 0.552 +- 0.217 (in-sample avg dev_std = 0.604)
NEC for r=1.0 all KL = 0.56 +- 0.217 (in-sample avg dev_std = 0.604)
NEC for r=1.0 all L1 = 0.523 +- 0.164 (in-sample avg dev_std = 0.604)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.387
Model XAI F1 of binarized graphs for r=0.3 =  0.6788537499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.5537175000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.578 +- 0.278 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 1 = 0.445 +- 0.278 (in-sample avg dev_std = 0.388)
NEC for r=0.3 class 2 = 0.6 +- 0.278 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all KL = 0.481 +- 0.278 (in-sample avg dev_std = 0.388)
NEC for r=0.3 all L1 = 0.542 +- 0.177 (in-sample avg dev_std = 0.388)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.626
Model XAI F1 of binarized graphs for r=0.6 =  0.5549062499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4297175
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.378
NEC for r=0.6 class 0 = 0.555 +- 0.252 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 1 = 0.461 +- 0.252 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 2 = 0.607 +- 0.252 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all KL = 0.521 +- 0.252 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all L1 = 0.542 +- 0.166 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  0.45367375000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.33000999999999997
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.501
NEC for r=0.9 class 0 = 0.608 +- 0.201 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 1 = 0.478 +- 0.201 (in-sample avg dev_std = 0.532)
NEC for r=0.9 class 2 = 0.544 +- 0.201 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all KL = 0.543 +- 0.201 (in-sample avg dev_std = 0.532)
NEC for r=0.9 all L1 = 0.544 +- 0.146 (in-sample avg dev_std = 0.532)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.32105125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.582 +- 0.218 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 1 = 0.427 +- 0.218 (in-sample avg dev_std = 0.606)
NEC for r=1.0 class 2 = 0.547 +- 0.218 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all KL = 0.557 +- 0.218 (in-sample avg dev_std = 0.606)
NEC for r=1.0 all L1 = 0.52 +- 0.163 (in-sample avg dev_std = 0.606)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.377
Model XAI F1 of binarized graphs for r=0.3 =  0.6782024999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.5498237499999999
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.407
NEC for r=0.3 class 0 = 0.595 +- 0.255 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 1 = 0.592 +- 0.255 (in-sample avg dev_std = 0.470)
NEC for r=0.3 class 2 = 0.659 +- 0.255 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all KL = 0.657 +- 0.255 (in-sample avg dev_std = 0.470)
NEC for r=0.3 all L1 = 0.615 +- 0.138 (in-sample avg dev_std = 0.470)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.548
Model XAI F1 of binarized graphs for r=0.6 =  0.48478375000000007
Model XAI WIoU of binarized graphs for r=0.6 =  0.3511475
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.421
NEC for r=0.6 class 0 = 0.466 +- 0.270 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 1 = 0.429 +- 0.270 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 2 = 0.503 +- 0.270 (in-sample avg dev_std = 0.441)
NEC for r=0.6 all KL = 0.42 +- 0.270 (in-sample avg dev_std = 0.441)
NEC for r=0.6 all L1 = 0.466 +- 0.155 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.55
Model XAI F1 of binarized graphs for r=0.9 =  0.39322375
Model XAI WIoU of binarized graphs for r=0.9 =  0.26726374999999997
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.572 +- 0.284 (in-sample avg dev_std = 0.491)
NEC for r=0.9 class 1 = 0.419 +- 0.284 (in-sample avg dev_std = 0.491)
NEC for r=0.9 class 2 = 0.452 +- 0.284 (in-sample avg dev_std = 0.491)
NEC for r=0.9 all KL = 0.471 +- 0.284 (in-sample avg dev_std = 0.491)
NEC for r=0.9 all L1 = 0.479 +- 0.171 (in-sample avg dev_std = 0.491)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.673
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.264395
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.557
NEC for r=1.0 class 0 = 0.537 +- 0.272 (in-sample avg dev_std = 0.510)
NEC for r=1.0 class 1 = 0.409 +- 0.272 (in-sample avg dev_std = 0.510)
NEC for r=1.0 class 2 = 0.411 +- 0.272 (in-sample avg dev_std = 0.510)
NEC for r=1.0 all KL = 0.45 +- 0.272 (in-sample avg dev_std = 0.510)
NEC for r=1.0 all L1 = 0.451 +- 0.159 (in-sample avg dev_std = 0.510)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:07:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 08:07:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3208
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3133
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3438
OOD Validation ACCURACY: 0.8060
OOD Validation Loss: 0.5279
OOD Test ACCURACY: 0.5877
OOD Test Loss: 1.2931

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9217
Train Loss: 0.3378
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3296
ID Test ACCURACY: 0.9203
ID Test Loss: 0.3566
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3789
OOD Test ACCURACY: 0.8207
OOD Test Loss: 0.7479

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5877 0.9203 0.8207 0.9257 0.9310[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.636
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.567
WIoU for r=0.6 = 0.438
F1 for r=0.9 = 0.460
WIoU for r=0.9 = 0.331
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.615
WIoU for r=0.3 = 0.490
F1 for r=0.6 = 0.556
WIoU for r=0.6 = 0.427
F1 for r=0.9 = 0.452
WIoU for r=0.9 = 0.324
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.317
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.525
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.432
WIoU for r=0.6 = 0.304
F1 for r=0.9 = 0.383
WIoU for r=0.9 = 0.253
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.256


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.382
Model XAI F1 of binarized graphs for r=0.3 =  0.6361275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5114037499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.389
SUFF++ for r=0.3 class 0 = 0.473 +- 0.259 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 class 1 = 0.49 +- 0.259 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 class 2 = 0.525 +- 0.259 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 all KL = 0.561 +- 0.259 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 all L1 = 0.496 +- 0.144 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.691
Model XAI F1 of binarized graphs for r=0.6 =  0.56730625
Model XAI WIoU of binarized graphs for r=0.6 =  0.43802375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.645
SUFF++ for r=0.6 class 0 = 0.514 +- 0.213 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 1 = 0.674 +- 0.213 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 class 2 = 0.65 +- 0.213 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all KL = 0.678 +- 0.213 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.6 all L1 = 0.613 +- 0.171 (in-sample avg dev_std = 0.382)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.46011624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.33128875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0 = 0.625 +- 0.180 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 class 1 = 0.844 +- 0.180 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 class 2 = 0.805 +- 0.180 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 all KL = 0.837 +- 0.180 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.166 (in-sample avg dev_std = 0.312)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.375
Model XAI F1 of binarized graphs for r=0.3 =  0.61548625
Model XAI WIoU of binarized graphs for r=0.3 =  0.4899825
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.408
SUFF++ for r=0.3 class 0 = 0.477 +- 0.246 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 class 1 = 0.495 +- 0.246 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 class 2 = 0.529 +- 0.246 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 all KL = 0.572 +- 0.246 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.140 (in-sample avg dev_std = 0.450)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.664
Model XAI F1 of binarized graphs for r=0.6 =  0.555835
Model XAI WIoU of binarized graphs for r=0.6 =  0.42704125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.619
SUFF++ for r=0.6 class 0 = 0.524 +- 0.209 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 class 1 = 0.658 +- 0.209 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 class 2 = 0.637 +- 0.209 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 all KL = 0.671 +- 0.209 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.6 all L1 = 0.607 +- 0.162 (in-sample avg dev_std = 0.392)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  0.45151125000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.3240575
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.846
SUFF++ for r=0.9 class 0 = 0.645 +- 0.176 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 1 = 0.819 +- 0.176 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 2 = 0.807 +- 0.176 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all KL = 0.84 +- 0.176 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all L1 = 0.758 +- 0.162 (in-sample avg dev_std = 0.301)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.501
Model XAI F1 of binarized graphs for r=0.3 =  0.5249812500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.41229
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.469
SUFF++ for r=0.3 class 0 = 0.537 +- 0.283 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 1 = 0.566 +- 0.283 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 2 = 0.546 +- 0.283 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all KL = 0.596 +- 0.283 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all L1 = 0.55 +- 0.166 (in-sample avg dev_std = 0.454)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.61
Model XAI F1 of binarized graphs for r=0.6 =  0.4318175
Model XAI WIoU of binarized graphs for r=0.6 =  0.30358874999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.643
SUFF++ for r=0.6 class 0 = 0.588 +- 0.189 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 class 1 = 0.64 +- 0.189 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 class 2 = 0.662 +- 0.189 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 all KL = 0.739 +- 0.189 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 all L1 = 0.631 +- 0.149 (in-sample avg dev_std = 0.351)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.642
Model XAI F1 of binarized graphs for r=0.9 =  0.3825425
Model XAI WIoU of binarized graphs for r=0.9 =  0.25250124999999995
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.664
SUFF++ for r=0.9 class 0 = 0.529 +- 0.232 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 1 = 0.799 +- 0.232 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 2 = 0.8 +- 0.232 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all KL = 0.811 +- 0.232 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all L1 = 0.712 +- 0.189 (in-sample avg dev_std = 0.296)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.384
Model XAI F1 of binarized graphs for r=0.3 =  0.6361275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5114037499999999
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.305
NEC for r=0.3 class 0 = 0.548 +- 0.259 (in-sample avg dev_std = 0.369)
NEC for r=0.3 class 1 = 0.521 +- 0.259 (in-sample avg dev_std = 0.369)
NEC for r=0.3 class 2 = 0.615 +- 0.259 (in-sample avg dev_std = 0.369)
NEC for r=0.3 all KL = 0.486 +- 0.259 (in-sample avg dev_std = 0.369)
NEC for r=0.3 all L1 = 0.561 +- 0.143 (in-sample avg dev_std = 0.369)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.692
Model XAI F1 of binarized graphs for r=0.6 =  0.56730625
Model XAI WIoU of binarized graphs for r=0.6 =  0.43802375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.367
NEC for r=0.6 class 0 = 0.543 +- 0.280 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 1 = 0.443 +- 0.280 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 2 = 0.624 +- 0.280 (in-sample avg dev_std = 0.410)
NEC for r=0.6 all KL = 0.505 +- 0.280 (in-sample avg dev_std = 0.410)
NEC for r=0.6 all L1 = 0.536 +- 0.178 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  0.46011624999999995
Model XAI WIoU of binarized graphs for r=0.9 =  0.33128875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.492
NEC for r=0.9 class 0 = 0.593 +- 0.214 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 1 = 0.493 +- 0.214 (in-sample avg dev_std = 0.535)
NEC for r=0.9 class 2 = 0.575 +- 0.214 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all KL = 0.559 +- 0.214 (in-sample avg dev_std = 0.535)
NEC for r=0.9 all L1 = 0.554 +- 0.147 (in-sample avg dev_std = 0.535)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.944
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.32347000000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.531
NEC for r=1.0 class 0 = 0.585 +- 0.227 (in-sample avg dev_std = 0.599)
NEC for r=1.0 class 1 = 0.436 +- 0.227 (in-sample avg dev_std = 0.599)
NEC for r=1.0 class 2 = 0.562 +- 0.227 (in-sample avg dev_std = 0.599)
NEC for r=1.0 all KL = 0.558 +- 0.227 (in-sample avg dev_std = 0.599)
NEC for r=1.0 all L1 = 0.527 +- 0.167 (in-sample avg dev_std = 0.599)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.374
Model XAI F1 of binarized graphs for r=0.3 =  0.61548625
Model XAI WIoU of binarized graphs for r=0.3 =  0.4899825
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.31
NEC for r=0.3 class 0 = 0.544 +- 0.256 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 1 = 0.531 +- 0.256 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 2 = 0.594 +- 0.256 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all KL = 0.479 +- 0.256 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all L1 = 0.557 +- 0.140 (in-sample avg dev_std = 0.379)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.664
Model XAI F1 of binarized graphs for r=0.6 =  0.555835
Model XAI WIoU of binarized graphs for r=0.6 =  0.42704125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.376
NEC for r=0.6 class 0 = 0.536 +- 0.275 (in-sample avg dev_std = 0.404)
NEC for r=0.6 class 1 = 0.418 +- 0.275 (in-sample avg dev_std = 0.404)
NEC for r=0.6 class 2 = 0.612 +- 0.275 (in-sample avg dev_std = 0.404)
NEC for r=0.6 all KL = 0.482 +- 0.275 (in-sample avg dev_std = 0.404)
NEC for r=0.6 all L1 = 0.524 +- 0.172 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  0.45151125000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.3240575
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.506
NEC for r=0.9 class 0 = 0.601 +- 0.205 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 1 = 0.485 +- 0.205 (in-sample avg dev_std = 0.541)
NEC for r=0.9 class 2 = 0.554 +- 0.205 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all KL = 0.549 +- 0.205 (in-sample avg dev_std = 0.541)
NEC for r=0.9 all L1 = 0.547 +- 0.147 (in-sample avg dev_std = 0.541)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.935
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.3165
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.525
NEC for r=1.0 class 0 = 0.584 +- 0.217 (in-sample avg dev_std = 0.608)
NEC for r=1.0 class 1 = 0.45 +- 0.217 (in-sample avg dev_std = 0.608)
NEC for r=1.0 class 2 = 0.559 +- 0.217 (in-sample avg dev_std = 0.608)
NEC for r=1.0 all KL = 0.567 +- 0.217 (in-sample avg dev_std = 0.608)
NEC for r=1.0 all L1 = 0.532 +- 0.157 (in-sample avg dev_std = 0.608)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.501
Model XAI F1 of binarized graphs for r=0.3 =  0.5249812500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.41229
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.362
NEC for r=0.3 class 0 = 0.525 +- 0.252 (in-sample avg dev_std = 0.475)
NEC for r=0.3 class 1 = 0.57 +- 0.252 (in-sample avg dev_std = 0.475)
NEC for r=0.3 class 2 = 0.538 +- 0.252 (in-sample avg dev_std = 0.475)
NEC for r=0.3 all KL = 0.545 +- 0.252 (in-sample avg dev_std = 0.475)
NEC for r=0.3 all L1 = 0.545 +- 0.155 (in-sample avg dev_std = 0.475)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  0.4318175
Model XAI WIoU of binarized graphs for r=0.6 =  0.30358874999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.439
NEC for r=0.6 class 0 = 0.409 +- 0.269 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 1 = 0.417 +- 0.269 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 2 = 0.535 +- 0.269 (in-sample avg dev_std = 0.403)
NEC for r=0.6 all KL = 0.384 +- 0.269 (in-sample avg dev_std = 0.403)
NEC for r=0.6 all L1 = 0.454 +- 0.153 (in-sample avg dev_std = 0.403)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.642
Model XAI F1 of binarized graphs for r=0.9 =  0.3825425
Model XAI WIoU of binarized graphs for r=0.9 =  0.25250124999999995
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.505
NEC for r=0.9 class 0 = 0.567 +- 0.266 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 1 = 0.393 +- 0.266 (in-sample avg dev_std = 0.500)
NEC for r=0.9 class 2 = 0.452 +- 0.266 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all KL = 0.446 +- 0.266 (in-sample avg dev_std = 0.500)
NEC for r=0.9 all L1 = 0.469 +- 0.170 (in-sample avg dev_std = 0.500)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.61
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.25649875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.538
NEC for r=1.0 class 0 = 0.531 +- 0.226 (in-sample avg dev_std = 0.474)
NEC for r=1.0 class 1 = 0.437 +- 0.226 (in-sample avg dev_std = 0.474)
NEC for r=1.0 class 2 = 0.396 +- 0.226 (in-sample avg dev_std = 0.474)
NEC for r=1.0 all KL = 0.446 +- 0.226 (in-sample avg dev_std = 0.474)
NEC for r=1.0 all L1 = 0.454 +- 0.135 (in-sample avg dev_std = 0.474)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.477, 0.66, 0.852, 1.0], 'all_L1': [0.471, 0.622, 0.784, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.564, 0.663, 0.849, 1.0], 'all_L1': [0.52, 0.601, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.574, 0.691, 0.845, 1.0], 'all_L1': [0.503, 0.621, 0.772, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.66, 0.833, 1.0], 'all_L1': [0.518, 0.597, 0.751, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.678, 0.837, 1.0], 'all_L1': [0.496, 0.613, 0.758, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.638, 0.611, 0.589, 0.581], 'all_L1': [0.627, 0.589, 0.554, 0.529]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.526, 0.564, 0.573], 'all_L1': [0.508, 0.546, 0.545, 0.53]}), defaultdict(<class 'list'>, {'all_KL': [0.52, 0.581, 0.546, 0.522], 'all_L1': [0.584, 0.596, 0.547, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.485, 0.539, 0.561, 0.56], 'all_L1': [0.546, 0.553, 0.554, 0.523]}), defaultdict(<class 'list'>, {'all_KL': [0.486, 0.505, 0.559, 0.558], 'all_L1': [0.561, 0.536, 0.554, 0.527]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.496, 0.65, 0.845, 1.0], 'all_L1': [0.48, 0.611, 0.775, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.658, 0.852, 1.0], 'all_L1': [0.529, 0.597, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.587, 0.69, 0.849, 1.0], 'all_L1': [0.507, 0.616, 0.776, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.586, 0.661, 0.835, 1.0], 'all_L1': [0.515, 0.591, 0.753, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.671, 0.84, 1.0], 'all_L1': [0.501, 0.607, 0.758, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.616, 0.599, 0.587, 0.58], 'all_L1': [0.616, 0.584, 0.552, 0.525]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.514, 0.545, 0.557], 'all_L1': [0.499, 0.541, 0.533, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.504, 0.573, 0.537, 0.521], 'all_L1': [0.574, 0.594, 0.54, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.481, 0.521, 0.543, 0.557], 'all_L1': [0.542, 0.542, 0.544, 0.52]}), defaultdict(<class 'list'>, {'all_KL': [0.479, 0.482, 0.549, 0.567], 'all_L1': [0.557, 0.524, 0.547, 0.532]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.597, 0.631, 0.803, 1.0], 'all_L1': [0.583, 0.58, 0.708, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.641, 0.597, 0.812, 1.0], 'all_L1': [0.595, 0.539, 0.741, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.75, 0.796, 1.0], 'all_L1': [0.575, 0.642, 0.731, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.58, 0.728, 0.788, 1.0], 'all_L1': [0.561, 0.624, 0.715, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.596, 0.739, 0.811, 1.0], 'all_L1': [0.55, 0.631, 0.712, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.609, 0.564, 0.48, 0.419], 'all_L1': [0.581, 0.588, 0.493, 0.433]}), defaultdict(<class 'list'>, {'all_KL': [0.557, 0.547, 0.495, 0.408], 'all_L1': [0.571, 0.543, 0.483, 0.43]}), defaultdict(<class 'list'>, {'all_KL': [0.63, 0.495, 0.525, 0.423], 'all_L1': [0.608, 0.541, 0.487, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.42, 0.471, 0.45], 'all_L1': [0.615, 0.466, 0.479, 0.451]}), defaultdict(<class 'list'>, {'all_KL': [0.545, 0.384, 0.446, 0.446], 'all_L1': [0.545, 0.454, 0.469, 0.454]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.502 +- 0.018, 0.611 +- 0.010, 0.768 +- 0.012, 1.000 +- 0.000
suff++ class all_KL  =  0.552 +- 0.038, 0.670 +- 0.012, 0.843 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.423 +- 0.021, 0.660 +- 0.038, 0.850 +- 0.011
nec class all_L1  =  0.565 +- 0.040, 0.564 +- 0.024, 0.551 +- 0.004, 0.525 +- 0.006
nec class all_KL  =  0.515 +- 0.066, 0.552 +- 0.038, 0.564 +- 0.014, 0.559 +- 0.020
nec_acc_int  =  0.315 +- 0.012, 0.372 +- 0.015, 0.491 +- 0.007, 0.532 +- 0.004

Eval split id_test
suff++ class all_L1  =  0.506 +- 0.016, 0.604 +- 0.009, 0.768 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.564 +- 0.035, 0.666 +- 0.014, 0.844 +- 0.006, 1.000 +- 0.000
suff++_acc_int  =  0.431 +- 0.017, 0.647 +- 0.041, 0.844 +- 0.006
nec class all_L1  =  0.558 +- 0.038, 0.557 +- 0.027, 0.543 +- 0.006, 0.521 +- 0.007
nec class all_KL  =  0.504 +- 0.060, 0.538 +- 0.042, 0.552 +- 0.018, 0.556 +- 0.020
nec_acc_int  =  0.322 +- 0.011, 0.374 +- 0.014, 0.502 +- 0.006, 0.534 +- 0.005

Eval split test
suff++ class all_L1  =  0.573 +- 0.016, 0.603 +- 0.038, 0.721 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.605 +- 0.021, 0.689 +- 0.063, 0.802 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.495 +- 0.021, 0.633 +- 0.039, 0.617 +- 0.051
nec class all_L1  =  0.584 +- 0.025, 0.518 +- 0.051, 0.482 +- 0.008, 0.436 +- 0.015
nec class all_KL  =  0.600 +- 0.043, 0.482 +- 0.070, 0.483 +- 0.026, 0.429 +- 0.016
nec_acc_int  =  0.394 +- 0.020, 0.424 +- 0.014, 0.526 +- 0.019, 0.558 +- 0.012


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.533 +- 0.012, 0.587 +- 0.016, 0.660 +- 0.006, 0.762 +- 0.003
Faith. Armon (L1)= 		  =  0.530 +- 0.009, 0.586 +- 0.017, 0.642 +- 0.004, 0.688 +- 0.005
Faith. GMean (L1)= 	  =  0.532 +- 0.011, 0.587 +- 0.016, 0.650 +- 0.005, 0.724 +- 0.004
Faith. Aritm (KL)= 		  =  0.533 +- 0.018, 0.611 +- 0.020, 0.703 +- 0.009, 0.779 +- 0.010
Faith. Armon (KL)= 		  =  0.528 +- 0.018, 0.605 +- 0.023, 0.676 +- 0.011, 0.717 +- 0.017
Faith. GMean (KL)= 	  =  0.531 +- 0.018, 0.608 +- 0.022, 0.689 +- 0.010, 0.747 +- 0.014

Eval split id_test
Faith. Aritm (L1)= 		  =  0.532 +- 0.012, 0.581 +- 0.017, 0.655 +- 0.005, 0.761 +- 0.003
Faith. Armon (L1)= 		  =  0.529 +- 0.009, 0.580 +- 0.018, 0.636 +- 0.005, 0.685 +- 0.006
Faith. GMean (L1)= 	  =  0.531 +- 0.010, 0.580 +- 0.017, 0.646 +- 0.005, 0.722 +- 0.005
Faith. Aritm (KL)= 		  =  0.534 +- 0.016, 0.602 +- 0.022, 0.698 +- 0.009, 0.778 +- 0.010
Faith. Armon (KL)= 		  =  0.528 +- 0.017, 0.594 +- 0.026, 0.667 +- 0.013, 0.715 +- 0.016
Faith. GMean (KL)= 	  =  0.531 +- 0.017, 0.598 +- 0.024, 0.683 +- 0.011, 0.746 +- 0.013

Eval split test
Faith. Aritm (L1)= 		  =  0.578 +- 0.016, 0.561 +- 0.022, 0.602 +- 0.008, 0.718 +- 0.007
Faith. Armon (L1)= 		  =  0.578 +- 0.016, 0.555 +- 0.026, 0.578 +- 0.007, 0.607 +- 0.014
Faith. GMean (L1)= 	  =  0.578 +- 0.016, 0.558 +- 0.024, 0.590 +- 0.008, 0.661 +- 0.011
Faith. Aritm (KL)= 		  =  0.602 +- 0.018, 0.586 +- 0.022, 0.643 +- 0.013, 0.715 +- 0.008
Faith. Armon (KL)= 		  =  0.601 +- 0.018, 0.560 +- 0.036, 0.603 +- 0.020, 0.600 +- 0.016
Faith. GMean (KL)= 	  =  0.602 +- 0.018, 0.573 +- 0.028, 0.622 +- 0.016, 0.655 +- 0.012
Computed for split load_split = id



Completed in  0:17:02.371069  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:10:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:10:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.4104
Train Loss: 2.7083
ID Validation ACCURACY: 0.4200
ID Validation Loss: 2.5795
ID Test ACCURACY: 0.4190
ID Test Loss: 2.6615
OOD Validation ACCURACY: 0.3403
OOD Validation Loss: 1.7336
OOD Test ACCURACY: 0.4687
OOD Test Loss: 1.7786

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.3104
Train Loss: 3.0254
ID Validation ACCURACY: 0.3137
ID Validation Loss: 3.0087
ID Test ACCURACY: 0.3120
ID Test Loss: 3.0020
OOD Validation ACCURACY: 0.4300
OOD Validation Loss: 1.9935
OOD Test ACCURACY: 0.4723
OOD Test Loss: 2.0225

[0m[1;37mINFO[0m: [1mChartInfo 0.4190 0.4687 0.3120 0.4723 0.3137 0.4300[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.293
WIoU for r=0.3 = 0.219
F1 for r=0.6 = 0.420
WIoU for r=0.6 = 0.323
F1 for r=0.9 = 0.447
WIoU for r=0.9 = 0.316
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.315
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.274
WIoU for r=0.3 = 0.205
F1 for r=0.6 = 0.399
WIoU for r=0.6 = 0.303
F1 for r=0.9 = 0.435
WIoU for r=0.9 = 0.306
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.308
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.319
WIoU for r=0.3 = 0.229
F1 for r=0.6 = 0.374
WIoU for r=0.6 = 0.259
F1 for r=0.9 = 0.364
WIoU for r=0.9 = 0.237
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.253


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.336
Model XAI F1 of binarized graphs for r=0.3 =  0.292505
Model XAI WIoU of binarized graphs for r=0.3 =  0.2186675
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF++ for r=0.3 class 0 = 0.774 +- 0.081 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 1 = 0.785 +- 0.081 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 2 = 0.788 +- 0.081 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all KL = 0.891 +- 0.081 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all L1 = 0.782 +- 0.093 (in-sample avg dev_std = 0.238)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.349
Model XAI F1 of binarized graphs for r=0.6 =  0.4203425
Model XAI WIoU of binarized graphs for r=0.6 =  0.32274500000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.335
SUFF++ for r=0.6 class 0 = 0.736 +- 0.154 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 class 1 = 0.774 +- 0.154 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 class 2 = 0.745 +- 0.154 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 all KL = 0.849 +- 0.154 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 all L1 = 0.752 +- 0.144 (in-sample avg dev_std = 0.294)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.403
Model XAI F1 of binarized graphs for r=0.9 =  0.44695875
Model XAI WIoU of binarized graphs for r=0.9 =  0.31561375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.361
SUFF++ for r=0.9 class 0 = 0.724 +- 0.253 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 class 1 = 0.814 +- 0.253 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 class 2 = 0.667 +- 0.253 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 all KL = 0.791 +- 0.253 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.9 all L1 = 0.735 +- 0.209 (in-sample avg dev_std = 0.330)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.325
Model XAI F1 of binarized graphs for r=0.3 =  0.27425375
Model XAI WIoU of binarized graphs for r=0.3 =  0.20538249999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.329
SUFF++ for r=0.3 class 0 = 0.779 +- 0.084 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 1 = 0.776 +- 0.084 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 2 = 0.779 +- 0.084 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 all KL = 0.888 +- 0.084 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 all L1 = 0.778 +- 0.095 (in-sample avg dev_std = 0.241)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.351
Model XAI F1 of binarized graphs for r=0.6 =  0.39858125
Model XAI WIoU of binarized graphs for r=0.6 =  0.30339625000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.331
SUFF++ for r=0.6 class 0 = 0.749 +- 0.150 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 1 = 0.773 +- 0.150 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.150 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all KL = 0.85 +- 0.150 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all L1 = 0.758 +- 0.137 (in-sample avg dev_std = 0.303)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.407
Model XAI F1 of binarized graphs for r=0.9 =  0.43537125000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.30574375000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.366
SUFF++ for r=0.9 class 0 = 0.717 +- 0.258 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 1 = 0.792 +- 0.258 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 class 2 = 0.676 +- 0.258 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 all KL = 0.776 +- 0.258 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.9 all L1 = 0.727 +- 0.212 (in-sample avg dev_std = 0.339)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.336
Model XAI F1 of binarized graphs for r=0.3 =  0.31894625
Model XAI WIoU of binarized graphs for r=0.3 =  0.22912500000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.345
SUFF++ for r=0.3 class 0 = 0.764 +- 0.123 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 class 1 = 0.771 +- 0.123 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 class 2 = 0.729 +- 0.123 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 all KL = 0.858 +- 0.123 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.120 (in-sample avg dev_std = 0.264)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.334
Model XAI F1 of binarized graphs for r=0.6 =  0.37400500000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.25897125
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.368
SUFF++ for r=0.6 class 0 = 0.688 +- 0.224 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.6 class 1 = 0.713 +- 0.224 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.6 class 2 = 0.58 +- 0.224 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.6 all KL = 0.742 +- 0.224 (in-sample avg dev_std = 0.355)
SUFF++ for r=0.6 all L1 = 0.661 +- 0.205 (in-sample avg dev_std = 0.355)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  0.3643175
Model XAI WIoU of binarized graphs for r=0.9 =  0.23732
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.354
SUFF++ for r=0.9 class 0 = 0.711 +- 0.209 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 1 = 0.718 +- 0.209 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 2 = 0.591 +- 0.209 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 all KL = 0.778 +- 0.209 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 all L1 = 0.673 +- 0.207 (in-sample avg dev_std = 0.290)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.335
Model XAI F1 of binarized graphs for r=0.3 =  0.292505
Model XAI WIoU of binarized graphs for r=0.3 =  0.2186675
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
NEC for r=0.3 class 0 = 0.195 +- 0.113 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 1 = 0.221 +- 0.113 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 2 = 0.188 +- 0.113 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.106 +- 0.113 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.201 +- 0.124 (in-sample avg dev_std = 0.193)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.346
Model XAI F1 of binarized graphs for r=0.6 =  0.4203425
Model XAI WIoU of binarized graphs for r=0.6 =  0.32274500000000006
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.321
NEC for r=0.6 class 0 = 0.226 +- 0.144 (in-sample avg dev_std = 0.249)
NEC for r=0.6 class 1 = 0.206 +- 0.144 (in-sample avg dev_std = 0.249)
NEC for r=0.6 class 2 = 0.235 +- 0.144 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all KL = 0.127 +- 0.144 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all L1 = 0.222 +- 0.152 (in-sample avg dev_std = 0.249)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.403
Model XAI F1 of binarized graphs for r=0.9 =  0.44695875
Model XAI WIoU of binarized graphs for r=0.9 =  0.31561375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.327
NEC for r=0.9 class 0 = 0.332 +- 0.292 (in-sample avg dev_std = 0.329)
NEC for r=0.9 class 1 = 0.203 +- 0.292 (in-sample avg dev_std = 0.329)
NEC for r=0.9 class 2 = 0.41 +- 0.292 (in-sample avg dev_std = 0.329)
NEC for r=0.9 all KL = 0.261 +- 0.292 (in-sample avg dev_std = 0.329)
NEC for r=0.9 all L1 = 0.314 +- 0.217 (in-sample avg dev_std = 0.329)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.424
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.31512499999999993
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.321
NEC for r=1.0 class 0 = 0.389 +- 0.304 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 1 = 0.222 +- 0.304 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 2 = 0.449 +- 0.304 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all KL = 0.299 +- 0.304 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all L1 = 0.352 +- 0.229 (in-sample avg dev_std = 0.325)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.325
Model XAI F1 of binarized graphs for r=0.3 =  0.27425375
Model XAI WIoU of binarized graphs for r=0.3 =  0.20538249999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.323
NEC for r=0.3 class 0 = 0.183 +- 0.110 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1 = 0.223 +- 0.110 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 2 = 0.199 +- 0.110 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.104 +- 0.110 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.201 +- 0.123 (in-sample avg dev_std = 0.194)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.35
Model XAI F1 of binarized graphs for r=0.6 =  0.39858125
Model XAI WIoU of binarized graphs for r=0.6 =  0.30339625000000003
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.322
NEC for r=0.6 class 0 = 0.228 +- 0.155 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.208 +- 0.155 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.234 +- 0.155 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.132 +- 0.155 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.223 +- 0.150 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.407
Model XAI F1 of binarized graphs for r=0.9 =  0.43537125000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.30574375000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.332
NEC for r=0.9 class 0 = 0.346 +- 0.302 (in-sample avg dev_std = 0.359)
NEC for r=0.9 class 1 = 0.212 +- 0.302 (in-sample avg dev_std = 0.359)
NEC for r=0.9 class 2 = 0.406 +- 0.302 (in-sample avg dev_std = 0.359)
NEC for r=0.9 all KL = 0.286 +- 0.302 (in-sample avg dev_std = 0.359)
NEC for r=0.9 all L1 = 0.323 +- 0.219 (in-sample avg dev_std = 0.359)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.429
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.30764875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.317
NEC for r=1.0 class 0 = 0.37 +- 0.303 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 1 = 0.224 +- 0.303 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 2 = 0.446 +- 0.303 (in-sample avg dev_std = 0.332)
NEC for r=1.0 all KL = 0.298 +- 0.303 (in-sample avg dev_std = 0.332)
NEC for r=1.0 all L1 = 0.349 +- 0.226 (in-sample avg dev_std = 0.332)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.335
Model XAI F1 of binarized graphs for r=0.3 =  0.31894625
Model XAI WIoU of binarized graphs for r=0.3 =  0.22912500000000002
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.342
NEC for r=0.3 class 0 = 0.18 +- 0.119 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 1 = 0.194 +- 0.119 (in-sample avg dev_std = 0.191)
NEC for r=0.3 class 2 = 0.274 +- 0.119 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all KL = 0.117 +- 0.119 (in-sample avg dev_std = 0.191)
NEC for r=0.3 all L1 = 0.216 +- 0.131 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.334
Model XAI F1 of binarized graphs for r=0.6 =  0.37400500000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.25897125
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.352
NEC for r=0.6 class 0 = 0.301 +- 0.212 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 1 = 0.266 +- 0.212 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 2 = 0.406 +- 0.212 (in-sample avg dev_std = 0.300)
NEC for r=0.6 all KL = 0.23 +- 0.212 (in-sample avg dev_std = 0.300)
NEC for r=0.6 all L1 = 0.324 +- 0.200 (in-sample avg dev_std = 0.300)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  0.3643175
Model XAI WIoU of binarized graphs for r=0.9 =  0.23732
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.362
NEC for r=0.9 class 0 = 0.295 +- 0.220 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 1 = 0.297 +- 0.220 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 2 = 0.445 +- 0.220 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all KL = 0.247 +- 0.220 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all L1 = 0.346 +- 0.213 (in-sample avg dev_std = 0.298)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.464
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.25294
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.361
NEC for r=1.0 class 0 = 0.31 +- 0.191 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 1 = 0.262 +- 0.191 (in-sample avg dev_std = 0.314)
NEC for r=1.0 class 2 = 0.431 +- 0.191 (in-sample avg dev_std = 0.314)
NEC for r=1.0 all KL = 0.231 +- 0.191 (in-sample avg dev_std = 0.314)
NEC for r=1.0 all L1 = 0.334 +- 0.189 (in-sample avg dev_std = 0.314)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:14:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:14:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.4193
Train Loss: 1.0912
ID Validation ACCURACY: 0.4187
ID Validation Loss: 1.0904
ID Test ACCURACY: 0.4387
ID Test Loss: 1.0894
OOD Validation ACCURACY: 0.3073
OOD Validation Loss: 1.1136
OOD Test ACCURACY: 0.2653
OOD Test Loss: 1.1329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ACCURACY: 0.3920
Train Loss: 1.0960
ID Validation ACCURACY: 0.3950
ID Validation Loss: 1.0940
ID Test ACCURACY: 0.3933
ID Test Loss: 1.0943
OOD Validation ACCURACY: 0.4270
OOD Validation Loss: 1.0847
OOD Test ACCURACY: 0.3620
OOD Test Loss: 1.0722

[0m[1;37mINFO[0m: [1mChartInfo 0.4387 0.2653 0.3933 0.3620 0.3950 0.4270[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.352
WIoU for r=0.3 = 0.240
F1 for r=0.6 = 0.436
WIoU for r=0.6 = 0.295
F1 for r=0.9 = 0.449
WIoU for r=0.9 = 0.309
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.310
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.355
WIoU for r=0.3 = 0.241
F1 for r=0.6 = 0.418
WIoU for r=0.6 = 0.279
F1 for r=0.9 = 0.437
WIoU for r=0.9 = 0.299
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.303
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.477
WIoU for r=0.3 = 0.346
F1 for r=0.6 = 0.462
WIoU for r=0.6 = 0.311
F1 for r=0.9 = 0.409
WIoU for r=0.9 = 0.265
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.252


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.29
Model XAI F1 of binarized graphs for r=0.3 =  0.3519925
Model XAI WIoU of binarized graphs for r=0.3 =  0.2397775
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.355
SUFF++ for r=0.3 class 0 = 0.963 +- 0.004 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.3 class 1 = 0.959 +- 0.004 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.3 class 2 = 0.957 +- 0.004 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.3 all KL = 0.998 +- 0.004 (in-sample avg dev_std = 0.040)
SUFF++ for r=0.3 all L1 = 0.96 +- 0.027 (in-sample avg dev_std = 0.040)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.475
Model XAI F1 of binarized graphs for r=0.6 =  0.43564249999999993
Model XAI WIoU of binarized graphs for r=0.6 =  0.29461375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.366
SUFF++ for r=0.6 class 0 = 0.952 +- 0.004 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.6 class 1 = 0.955 +- 0.004 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.6 class 2 = 0.933 +- 0.004 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.6 all KL = 0.997 +- 0.004 (in-sample avg dev_std = 0.038)
SUFF++ for r=0.6 all L1 = 0.947 +- 0.028 (in-sample avg dev_std = 0.038)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  0.44903
Model XAI WIoU of binarized graphs for r=0.9 =  0.309455
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.371
SUFF++ for r=0.9 class 0 = 0.955 +- 0.002 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 class 1 = 0.955 +- 0.002 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 class 2 = 0.953 +- 0.002 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 all KL = 0.998 +- 0.002 (in-sample avg dev_std = 0.032)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.025 (in-sample avg dev_std = 0.032)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.312
Model XAI F1 of binarized graphs for r=0.3 =  0.35486000000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.24149875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.358
SUFF++ for r=0.3 class 0 = 0.956 +- 0.004 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 class 1 = 0.96 +- 0.004 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 class 2 = 0.953 +- 0.004 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 all KL = 0.997 +- 0.004 (in-sample avg dev_std = 0.043)
SUFF++ for r=0.3 all L1 = 0.956 +- 0.029 (in-sample avg dev_std = 0.043)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.445
Model XAI F1 of binarized graphs for r=0.6 =  0.41802500000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.2785375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.358
SUFF++ for r=0.6 class 0 = 0.946 +- 0.004 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.6 class 1 = 0.952 +- 0.004 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.6 class 2 = 0.933 +- 0.004 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.6 all KL = 0.996 +- 0.004 (in-sample avg dev_std = 0.041)
SUFF++ for r=0.6 all L1 = 0.944 +- 0.029 (in-sample avg dev_std = 0.041)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.46
Model XAI F1 of binarized graphs for r=0.9 =  0.43662625000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.29949624999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.366
SUFF++ for r=0.9 class 0 = 0.951 +- 0.003 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 class 1 = 0.957 +- 0.003 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 class 2 = 0.953 +- 0.003 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 all KL = 0.998 +- 0.003 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.025 (in-sample avg dev_std = 0.031)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.264
Model XAI F1 of binarized graphs for r=0.3 =  0.47719124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.34597249999999996
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.379
SUFF++ for r=0.3 class 0 = 0.958 +- 0.003 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.3 class 1 = 0.965 +- 0.003 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.3 class 2 = 0.961 +- 0.003 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.3 all KL = 0.998 +- 0.003 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.3 all L1 = 0.961 +- 0.026 (in-sample avg dev_std = 0.036)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.396
Model XAI F1 of binarized graphs for r=0.6 =  0.4618625
Model XAI WIoU of binarized graphs for r=0.6 =  0.31055374999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.373
SUFF++ for r=0.6 class 0 = 0.952 +- 0.007 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.6 class 1 = 0.957 +- 0.007 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.6 class 2 = 0.923 +- 0.007 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.6 all KL = 0.996 +- 0.007 (in-sample avg dev_std = 0.036)
SUFF++ for r=0.6 all L1 = 0.944 +- 0.043 (in-sample avg dev_std = 0.036)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.278
Model XAI F1 of binarized graphs for r=0.9 =  0.40897625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.2648775
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.357
SUFF++ for r=0.9 class 0 = 0.964 +- 0.002 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 class 1 = 0.954 +- 0.002 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 class 2 = 0.946 +- 0.002 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 all KL = 0.998 +- 0.002 (in-sample avg dev_std = 0.031)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.021 (in-sample avg dev_std = 0.031)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.29
Model XAI F1 of binarized graphs for r=0.3 =  0.3519925
Model XAI WIoU of binarized graphs for r=0.3 =  0.2397775
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.342
NEC for r=0.3 class 0 = 0.027 +- 0.004 (in-sample avg dev_std = 0.025)
NEC for r=0.3 class 1 = 0.033 +- 0.004 (in-sample avg dev_std = 0.025)
NEC for r=0.3 class 2 = 0.036 +- 0.004 (in-sample avg dev_std = 0.025)
NEC for r=0.3 all KL = 0.002 +- 0.004 (in-sample avg dev_std = 0.025)
NEC for r=0.3 all L1 = 0.032 +- 0.031 (in-sample avg dev_std = 0.025)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.475
Model XAI F1 of binarized graphs for r=0.6 =  0.43564249999999993
Model XAI WIoU of binarized graphs for r=0.6 =  0.29461375
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.352
NEC for r=0.6 class 0 = 0.046 +- 0.005 (in-sample avg dev_std = 0.037)
NEC for r=0.6 class 1 = 0.042 +- 0.005 (in-sample avg dev_std = 0.037)
NEC for r=0.6 class 2 = 0.069 +- 0.005 (in-sample avg dev_std = 0.037)
NEC for r=0.6 all KL = 0.004 +- 0.005 (in-sample avg dev_std = 0.037)
NEC for r=0.6 all L1 = 0.052 +- 0.035 (in-sample avg dev_std = 0.037)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.44903
Model XAI WIoU of binarized graphs for r=0.9 =  0.309455
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.358
NEC for r=0.9 class 0 = 0.052 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.9 class 1 = 0.051 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.9 class 2 = 0.063 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.9 all KL = 0.003 +- 0.003 (in-sample avg dev_std = 0.034)
NEC for r=0.9 all L1 = 0.055 +- 0.030 (in-sample avg dev_std = 0.034)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.431
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.31010375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.345
NEC for r=1.0 class 0 = 0.049 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 class 1 = 0.055 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 class 2 = 0.062 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 all KL = 0.003 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 all L1 = 0.055 +- 0.028 (in-sample avg dev_std = 0.035)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.311
Model XAI F1 of binarized graphs for r=0.3 =  0.35486000000000006
Model XAI WIoU of binarized graphs for r=0.3 =  0.24149875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.336
NEC for r=0.3 class 0 = 0.032 +- 0.004 (in-sample avg dev_std = 0.030)
NEC for r=0.3 class 1 = 0.034 +- 0.004 (in-sample avg dev_std = 0.030)
NEC for r=0.3 class 2 = 0.037 +- 0.004 (in-sample avg dev_std = 0.030)
NEC for r=0.3 all KL = 0.002 +- 0.004 (in-sample avg dev_std = 0.030)
NEC for r=0.3 all L1 = 0.034 +- 0.033 (in-sample avg dev_std = 0.030)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.446
Model XAI F1 of binarized graphs for r=0.6 =  0.41802500000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.2785375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.05 +- 0.005 (in-sample avg dev_std = 0.038)
NEC for r=0.6 class 1 = 0.043 +- 0.005 (in-sample avg dev_std = 0.038)
NEC for r=0.6 class 2 = 0.063 +- 0.005 (in-sample avg dev_std = 0.038)
NEC for r=0.6 all KL = 0.004 +- 0.005 (in-sample avg dev_std = 0.038)
NEC for r=0.6 all L1 = 0.052 +- 0.036 (in-sample avg dev_std = 0.038)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.46
Model XAI F1 of binarized graphs for r=0.9 =  0.43662625000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.29949624999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.354
NEC for r=0.9 class 0 = 0.052 +- 0.004 (in-sample avg dev_std = 0.034)
NEC for r=0.9 class 1 = 0.055 +- 0.004 (in-sample avg dev_std = 0.034)
NEC for r=0.9 class 2 = 0.06 +- 0.004 (in-sample avg dev_std = 0.034)
NEC for r=0.9 all KL = 0.003 +- 0.004 (in-sample avg dev_std = 0.034)
NEC for r=0.9 all L1 = 0.056 +- 0.031 (in-sample avg dev_std = 0.034)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.436
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.30342875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.35
NEC for r=1.0 class 0 = 0.048 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 class 1 = 0.057 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 class 2 = 0.061 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 all KL = 0.003 +- 0.003 (in-sample avg dev_std = 0.035)
NEC for r=1.0 all L1 = 0.055 +- 0.029 (in-sample avg dev_std = 0.035)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.264
Model XAI F1 of binarized graphs for r=0.3 =  0.47719124999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.34597249999999996
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.353
NEC for r=0.3 class 0 = 0.057 +- 0.005 (in-sample avg dev_std = 0.033)
NEC for r=0.3 class 1 = 0.037 +- 0.005 (in-sample avg dev_std = 0.033)
NEC for r=0.3 class 2 = 0.042 +- 0.005 (in-sample avg dev_std = 0.033)
NEC for r=0.3 all KL = 0.003 +- 0.005 (in-sample avg dev_std = 0.033)
NEC for r=0.3 all L1 = 0.045 +- 0.038 (in-sample avg dev_std = 0.033)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.396
Model XAI F1 of binarized graphs for r=0.6 =  0.4618625
Model XAI WIoU of binarized graphs for r=0.6 =  0.31055374999999996
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.34
NEC for r=0.6 class 0 = 0.038 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.6 class 1 = 0.046 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.6 class 2 = 0.071 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all KL = 0.004 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all L1 = 0.052 +- 0.043 (in-sample avg dev_std = 0.034)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.278
Model XAI F1 of binarized graphs for r=0.9 =  0.40897625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.2648775
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.326
NEC for r=0.9 class 0 = 0.038 +- 0.003 (in-sample avg dev_std = 0.027)
NEC for r=0.9 class 1 = 0.037 +- 0.003 (in-sample avg dev_std = 0.027)
NEC for r=0.9 class 2 = 0.053 +- 0.003 (in-sample avg dev_std = 0.027)
NEC for r=0.9 all KL = 0.002 +- 0.003 (in-sample avg dev_std = 0.027)
NEC for r=0.9 all L1 = 0.043 +- 0.026 (in-sample avg dev_std = 0.027)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.271
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.25188625000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.358
NEC for r=1.0 class 0 = 0.034 +- 0.005 (in-sample avg dev_std = 0.029)
NEC for r=1.0 class 1 = 0.067 +- 0.005 (in-sample avg dev_std = 0.029)
NEC for r=1.0 class 2 = 0.048 +- 0.005 (in-sample avg dev_std = 0.029)
NEC for r=1.0 all KL = 0.003 +- 0.005 (in-sample avg dev_std = 0.029)
NEC for r=1.0 all L1 = 0.05 +- 0.041 (in-sample avg dev_std = 0.029)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:17:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:17:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ACCURACY: 0.4521
Train Loss: 1.2984
ID Validation ACCURACY: 0.4527
ID Validation Loss: 1.2838
ID Test ACCURACY: 0.4470
ID Test Loss: 1.3127
OOD Validation ACCURACY: 0.4130
OOD Validation Loss: 1.2722
OOD Test ACCURACY: 0.1907
OOD Test Loss: 1.9365

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.3723
Train Loss: 1.7516
ID Validation ACCURACY: 0.3710
ID Validation Loss: 1.7582
ID Test ACCURACY: 0.3620
ID Test Loss: 1.7715
OOD Validation ACCURACY: 0.4483
OOD Validation Loss: 1.1439
OOD Test ACCURACY: 0.3330
OOD Test Loss: 1.8597

[0m[1;37mINFO[0m: [1mChartInfo 0.4470 0.1907 0.3620 0.3330 0.3710 0.4483[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.277
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.359
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.439
WIoU for r=0.9 = 0.299
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.305
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.272
WIoU for r=0.3 = 0.202
F1 for r=0.6 = 0.353
WIoU for r=0.6 = 0.259
F1 for r=0.9 = 0.430
WIoU for r=0.9 = 0.292
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.298
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.121
WIoU for r=0.3 = 0.079
F1 for r=0.6 = 0.182
WIoU for r=0.6 = 0.119
F1 for r=0.9 = 0.336
WIoU for r=0.9 = 0.205
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.235


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.329
Model XAI F1 of binarized graphs for r=0.3 =  0.2772725
Model XAI WIoU of binarized graphs for r=0.3 =  0.20685874999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF++ for r=0.3 class 0 = 0.804 +- 0.092 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.3 class 1 = 0.817 +- 0.092 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.3 class 2 = 0.827 +- 0.092 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.3 all KL = 0.912 +- 0.092 (in-sample avg dev_std = 0.175)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.093 (in-sample avg dev_std = 0.175)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.347
Model XAI F1 of binarized graphs for r=0.6 =  0.35916375
Model XAI WIoU of binarized graphs for r=0.6 =  0.26177
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.34
SUFF++ for r=0.6 class 0 = 0.785 +- 0.165 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 class 1 = 0.768 +- 0.165 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 class 2 = 0.641 +- 0.165 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 all KL = 0.836 +- 0.165 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.6 all L1 = 0.732 +- 0.138 (in-sample avg dev_std = 0.294)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.405
Model XAI F1 of binarized graphs for r=0.9 =  0.43922875
Model XAI WIoU of binarized graphs for r=0.9 =  0.2989875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.387
SUFF++ for r=0.9 class 0 = 0.756 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 1 = 0.808 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 2 = 0.572 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all KL = 0.795 +- 0.232 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all L1 = 0.713 +- 0.188 (in-sample avg dev_std = 0.315)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.324
Model XAI F1 of binarized graphs for r=0.3 =  0.27155999999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.20176624999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.331
SUFF++ for r=0.3 class 0 = 0.798 +- 0.094 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 class 1 = 0.823 +- 0.094 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 class 2 = 0.811 +- 0.094 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 all KL = 0.907 +- 0.094 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 all L1 = 0.81 +- 0.093 (in-sample avg dev_std = 0.183)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.336
Model XAI F1 of binarized graphs for r=0.6 =  0.3530125
Model XAI WIoU of binarized graphs for r=0.6 =  0.258775
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF++ for r=0.6 class 0 = 0.768 +- 0.168 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 1 = 0.766 +- 0.168 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 class 2 = 0.654 +- 0.168 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all KL = 0.834 +- 0.168 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.6 all L1 = 0.728 +- 0.144 (in-sample avg dev_std = 0.296)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  0.42956000000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.29241500000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.387
SUFF++ for r=0.9 class 0 = 0.737 +- 0.235 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 class 1 = 0.783 +- 0.235 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 class 2 = 0.584 +- 0.235 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 all KL = 0.778 +- 0.235 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.9 all L1 = 0.699 +- 0.189 (in-sample avg dev_std = 0.331)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.311
Model XAI F1 of binarized graphs for r=0.3 =  0.12089124999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.07881375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.344
SUFF++ for r=0.3 class 0 = 0.789 +- 0.095 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 class 1 = 0.764 +- 0.095 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 class 2 = 0.812 +- 0.095 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 all KL = 0.88 +- 0.095 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 all L1 = 0.788 +- 0.113 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.255
Model XAI F1 of binarized graphs for r=0.6 =  0.18155374999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.11909874999999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.338
SUFF++ for r=0.6 class 0 = 0.66 +- 0.253 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 class 1 = 0.563 +- 0.253 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 class 2 = 0.675 +- 0.253 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all KL = 0.696 +- 0.253 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.197 (in-sample avg dev_std = 0.337)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.221
Model XAI F1 of binarized graphs for r=0.9 =  0.33600250000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.20531
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.359
SUFF++ for r=0.9 class 0 = 0.55 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 class 1 = 0.469 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 class 2 = 0.575 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 all KL = 0.625 +- 0.247 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.9 all L1 = 0.531 +- 0.177 (in-sample avg dev_std = 0.390)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.329
Model XAI F1 of binarized graphs for r=0.3 =  0.2772725
Model XAI WIoU of binarized graphs for r=0.3 =  0.20685874999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.374
NEC for r=0.3 class 0 = 0.169 +- 0.096 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.168 +- 0.096 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.175 +- 0.096 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.075 +- 0.096 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.171 +- 0.105 (in-sample avg dev_std = 0.155)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.347
Model XAI F1 of binarized graphs for r=0.6 =  0.35916375
Model XAI WIoU of binarized graphs for r=0.6 =  0.26177
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.328
NEC for r=0.6 class 0 = 0.191 +- 0.150 (in-sample avg dev_std = 0.239)
NEC for r=0.6 class 1 = 0.216 +- 0.150 (in-sample avg dev_std = 0.239)
NEC for r=0.6 class 2 = 0.318 +- 0.150 (in-sample avg dev_std = 0.239)
NEC for r=0.6 all KL = 0.127 +- 0.150 (in-sample avg dev_std = 0.239)
NEC for r=0.6 all L1 = 0.241 +- 0.149 (in-sample avg dev_std = 0.239)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.405
Model XAI F1 of binarized graphs for r=0.9 =  0.43922875
Model XAI WIoU of binarized graphs for r=0.9 =  0.2989875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.327
NEC for r=0.9 class 0 = 0.257 +- 0.277 (in-sample avg dev_std = 0.286)
NEC for r=0.9 class 1 = 0.239 +- 0.277 (in-sample avg dev_std = 0.286)
NEC for r=0.9 class 2 = 0.493 +- 0.277 (in-sample avg dev_std = 0.286)
NEC for r=0.9 all KL = 0.243 +- 0.277 (in-sample avg dev_std = 0.286)
NEC for r=0.9 all L1 = 0.329 +- 0.216 (in-sample avg dev_std = 0.286)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.441
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.3047225
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.34
NEC for r=1.0 class 0 = 0.274 +- 0.222 (in-sample avg dev_std = 0.284)
NEC for r=1.0 class 1 = 0.291 +- 0.222 (in-sample avg dev_std = 0.284)
NEC for r=1.0 class 2 = 0.48 +- 0.222 (in-sample avg dev_std = 0.284)
NEC for r=1.0 all KL = 0.238 +- 0.222 (in-sample avg dev_std = 0.284)
NEC for r=1.0 all L1 = 0.348 +- 0.193 (in-sample avg dev_std = 0.284)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.324
Model XAI F1 of binarized graphs for r=0.3 =  0.27155999999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.20176624999999998
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.363
NEC for r=0.3 class 0 = 0.184 +- 0.098 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 1 = 0.165 +- 0.098 (in-sample avg dev_std = 0.155)
NEC for r=0.3 class 2 = 0.192 +- 0.098 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all KL = 0.078 +- 0.098 (in-sample avg dev_std = 0.155)
NEC for r=0.3 all L1 = 0.181 +- 0.111 (in-sample avg dev_std = 0.155)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.338
Model XAI F1 of binarized graphs for r=0.6 =  0.3530125
Model XAI WIoU of binarized graphs for r=0.6 =  0.258775
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.334
NEC for r=0.6 class 0 = 0.208 +- 0.155 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 1 = 0.222 +- 0.155 (in-sample avg dev_std = 0.263)
NEC for r=0.6 class 2 = 0.315 +- 0.155 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all KL = 0.139 +- 0.155 (in-sample avg dev_std = 0.263)
NEC for r=0.6 all L1 = 0.25 +- 0.152 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.44
Model XAI F1 of binarized graphs for r=0.9 =  0.42956000000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.29241500000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.322
NEC for r=0.9 class 0 = 0.276 +- 0.282 (in-sample avg dev_std = 0.294)
NEC for r=0.9 class 1 = 0.26 +- 0.282 (in-sample avg dev_std = 0.294)
NEC for r=0.9 class 2 = 0.487 +- 0.282 (in-sample avg dev_std = 0.294)
NEC for r=0.9 all KL = 0.266 +- 0.282 (in-sample avg dev_std = 0.294)
NEC for r=0.9 all L1 = 0.344 +- 0.219 (in-sample avg dev_std = 0.294)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.47
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.29846375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.34
NEC for r=1.0 class 0 = 0.297 +- 0.230 (in-sample avg dev_std = 0.297)
NEC for r=1.0 class 1 = 0.298 +- 0.230 (in-sample avg dev_std = 0.297)
NEC for r=1.0 class 2 = 0.48 +- 0.230 (in-sample avg dev_std = 0.297)
NEC for r=1.0 all KL = 0.253 +- 0.230 (in-sample avg dev_std = 0.297)
NEC for r=1.0 all L1 = 0.361 +- 0.196 (in-sample avg dev_std = 0.297)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.311
Model XAI F1 of binarized graphs for r=0.3 =  0.12089124999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.07881375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.342
NEC for r=0.3 class 0 = 0.144 +- 0.102 (in-sample avg dev_std = 0.097)
NEC for r=0.3 class 1 = 0.184 +- 0.102 (in-sample avg dev_std = 0.097)
NEC for r=0.3 class 2 = 0.145 +- 0.102 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all KL = 0.072 +- 0.102 (in-sample avg dev_std = 0.097)
NEC for r=0.3 all L1 = 0.158 +- 0.145 (in-sample avg dev_std = 0.097)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.255
Model XAI F1 of binarized graphs for r=0.6 =  0.18155374999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.11909874999999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.334
NEC for r=0.6 class 0 = 0.315 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1 = 0.456 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 2 = 0.347 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.3 +- 0.252 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.374 +- 0.194 (in-sample avg dev_std = 0.304)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.221
Model XAI F1 of binarized graphs for r=0.9 =  0.33600250000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.20531
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.357
NEC for r=0.9 class 0 = 0.447 +- 0.266 (in-sample avg dev_std = 0.344)
NEC for r=0.9 class 1 = 0.548 +- 0.266 (in-sample avg dev_std = 0.344)
NEC for r=0.9 class 2 = 0.378 +- 0.266 (in-sample avg dev_std = 0.344)
NEC for r=0.9 all KL = 0.355 +- 0.266 (in-sample avg dev_std = 0.344)
NEC for r=0.9 all L1 = 0.459 +- 0.185 (in-sample avg dev_std = 0.344)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.188
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.23499375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.388
NEC for r=1.0 class 0 = 0.539 +- 0.221 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 1 = 0.57 +- 0.221 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 2 = 0.441 +- 0.221 (in-sample avg dev_std = 0.394)
NEC for r=1.0 all KL = 0.411 +- 0.221 (in-sample avg dev_std = 0.394)
NEC for r=1.0 all L1 = 0.517 +- 0.143 (in-sample avg dev_std = 0.394)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:21:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:21:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.4275
Train Loss: 1.0818
ID Validation ACCURACY: 0.4457
ID Validation Loss: 1.0785
ID Test ACCURACY: 0.4200
ID Test Loss: 1.0831
OOD Validation ACCURACY: 0.3920
OOD Validation Loss: 1.0853
OOD Test ACCURACY: 0.4870
OOD Test Loss: 1.0467

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 16...
[0m[1;37mINFO[0m: [1mCheckpoint 16: 
-----------------------------------
Train ACCURACY: 0.3607
Train Loss: 2.3760
ID Validation ACCURACY: 0.3623
ID Validation Loss: 2.3464
ID Test ACCURACY: 0.3440
ID Test Loss: 2.4079
OOD Validation ACCURACY: 0.4673
OOD Validation Loss: 1.3915
OOD Test ACCURACY: 0.3537
OOD Test Loss: 2.2154

[0m[1;37mINFO[0m: [1mChartInfo 0.4200 0.4870 0.3440 0.3537 0.3623 0.4673[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.414
WIoU for r=0.3 = 0.305
F1 for r=0.6 = 0.486
WIoU for r=0.6 = 0.365
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.308
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.310
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.416
WIoU for r=0.3 = 0.304
F1 for r=0.6 = 0.471
WIoU for r=0.6 = 0.350
F1 for r=0.9 = 0.429
WIoU for r=0.9 = 0.296
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.304
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.260
WIoU for r=0.3 = 0.170
F1 for r=0.6 = 0.350
WIoU for r=0.6 = 0.229
F1 for r=0.9 = 0.400
WIoU for r=0.9 = 0.258
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.252


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.331
Model XAI F1 of binarized graphs for r=0.3 =  0.41366749999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.30499624999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
SUFF++ for r=0.3 class 0 = 0.884 +- 0.012 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 class 1 = 0.889 +- 0.012 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 class 2 = 0.897 +- 0.012 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 all KL = 0.988 +- 0.012 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 all L1 = 0.89 +- 0.050 (in-sample avg dev_std = 0.089)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.395
Model XAI F1 of binarized graphs for r=0.6 =  0.48576125000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.36509375000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.334
SUFF++ for r=0.6 class 0 = 0.892 +- 0.016 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 class 1 = 0.897 +- 0.016 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 class 2 = 0.868 +- 0.016 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 all KL = 0.986 +- 0.016 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 all L1 = 0.886 +- 0.064 (in-sample avg dev_std = 0.083)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.389
Model XAI F1 of binarized graphs for r=0.9 =  0.44325625
Model XAI WIoU of binarized graphs for r=0.9 =  0.307975
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.383
SUFF++ for r=0.9 class 0 = 0.909 +- 0.008 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.9 class 1 = 0.923 +- 0.008 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.9 class 2 = 0.905 +- 0.008 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.9 all KL = 0.991 +- 0.008 (in-sample avg dev_std = 0.074)
SUFF++ for r=0.9 all L1 = 0.912 +- 0.047 (in-sample avg dev_std = 0.074)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.338
Model XAI F1 of binarized graphs for r=0.3 =  0.41649749999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.30376250000000005
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.324
SUFF++ for r=0.3 class 0 = 0.879 +- 0.015 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.3 class 1 = 0.888 +- 0.015 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.3 class 2 = 0.89 +- 0.015 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.3 all KL = 0.986 +- 0.015 (in-sample avg dev_std = 0.093)
SUFF++ for r=0.3 all L1 = 0.885 +- 0.055 (in-sample avg dev_std = 0.093)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.391
Model XAI F1 of binarized graphs for r=0.6 =  0.47102499999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.35043375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.328
SUFF++ for r=0.6 class 0 = 0.889 +- 0.019 (in-sample avg dev_std = 0.084)
SUFF++ for r=0.6 class 1 = 0.891 +- 0.019 (in-sample avg dev_std = 0.084)
SUFF++ for r=0.6 class 2 = 0.863 +- 0.019 (in-sample avg dev_std = 0.084)
SUFF++ for r=0.6 all KL = 0.984 +- 0.019 (in-sample avg dev_std = 0.084)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.068 (in-sample avg dev_std = 0.084)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.356
Model XAI F1 of binarized graphs for r=0.9 =  0.42896
Model XAI WIoU of binarized graphs for r=0.9 =  0.29637250000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.378
SUFF++ for r=0.9 class 0 = 0.907 +- 0.008 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 class 1 = 0.925 +- 0.008 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 class 2 = 0.912 +- 0.008 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 all KL = 0.992 +- 0.008 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 all L1 = 0.914 +- 0.046 (in-sample avg dev_std = 0.071)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.2604925
Model XAI WIoU of binarized graphs for r=0.3 =  0.1704
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.337
SUFF++ for r=0.3 class 0 = 0.907 +- 0.006 (in-sample avg dev_std = 0.080)
SUFF++ for r=0.3 class 1 = 0.907 +- 0.006 (in-sample avg dev_std = 0.080)
SUFF++ for r=0.3 class 2 = 0.918 +- 0.006 (in-sample avg dev_std = 0.080)
SUFF++ for r=0.3 all KL = 0.992 +- 0.006 (in-sample avg dev_std = 0.080)
SUFF++ for r=0.3 all L1 = 0.911 +- 0.037 (in-sample avg dev_std = 0.080)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.365
Model XAI F1 of binarized graphs for r=0.6 =  0.35041125
Model XAI WIoU of binarized graphs for r=0.6 =  0.22877375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.35
SUFF++ for r=0.6 class 0 = 0.911 +- 0.016 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.6 class 1 = 0.936 +- 0.016 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.6 class 2 = 0.904 +- 0.016 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.6 all KL = 0.992 +- 0.016 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.6 all L1 = 0.918 +- 0.056 (in-sample avg dev_std = 0.069)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.524
Model XAI F1 of binarized graphs for r=0.9 =  0.40022874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.2576475
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.418
SUFF++ for r=0.9 class 0 = 0.923 +- 0.034 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 class 1 = 0.943 +- 0.034 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 class 2 = 0.83 +- 0.034 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 all KL = 0.983 +- 0.034 (in-sample avg dev_std = 0.076)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.091 (in-sample avg dev_std = 0.076)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.331
Model XAI F1 of binarized graphs for r=0.3 =  0.41366749999999997
Model XAI WIoU of binarized graphs for r=0.3 =  0.30499624999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.309
NEC for r=0.3 class 0 = 0.118 +- 0.013 (in-sample avg dev_std = 0.077)
NEC for r=0.3 class 1 = 0.098 +- 0.013 (in-sample avg dev_std = 0.077)
NEC for r=0.3 class 2 = 0.104 +- 0.013 (in-sample avg dev_std = 0.077)
NEC for r=0.3 all KL = 0.012 +- 0.013 (in-sample avg dev_std = 0.077)
NEC for r=0.3 all L1 = 0.106 +- 0.062 (in-sample avg dev_std = 0.077)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.395
Model XAI F1 of binarized graphs for r=0.6 =  0.48576125000000003
Model XAI WIoU of binarized graphs for r=0.6 =  0.36509375000000005
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.336
NEC for r=0.6 class 0 = 0.099 +- 0.017 (in-sample avg dev_std = 0.066)
NEC for r=0.6 class 1 = 0.089 +- 0.017 (in-sample avg dev_std = 0.066)
NEC for r=0.6 class 2 = 0.119 +- 0.017 (in-sample avg dev_std = 0.066)
NEC for r=0.6 all KL = 0.012 +- 0.017 (in-sample avg dev_std = 0.066)
NEC for r=0.6 all L1 = 0.102 +- 0.064 (in-sample avg dev_std = 0.066)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.389
Model XAI F1 of binarized graphs for r=0.9 =  0.44325625
Model XAI WIoU of binarized graphs for r=0.9 =  0.307975
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.325
NEC for r=0.9 class 0 = 0.104 +- 0.010 (in-sample avg dev_std = 0.075)
NEC for r=0.9 class 1 = 0.095 +- 0.010 (in-sample avg dev_std = 0.075)
NEC for r=0.9 class 2 = 0.105 +- 0.010 (in-sample avg dev_std = 0.075)
NEC for r=0.9 all KL = 0.01 +- 0.010 (in-sample avg dev_std = 0.075)
NEC for r=0.9 all L1 = 0.101 +- 0.051 (in-sample avg dev_std = 0.075)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.455
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.31027125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.335
NEC for r=1.0 class 0 = 0.107 +- 0.012 (in-sample avg dev_std = 0.077)
NEC for r=1.0 class 1 = 0.094 +- 0.012 (in-sample avg dev_std = 0.077)
NEC for r=1.0 class 2 = 0.121 +- 0.012 (in-sample avg dev_std = 0.077)
NEC for r=1.0 all KL = 0.012 +- 0.012 (in-sample avg dev_std = 0.077)
NEC for r=1.0 all L1 = 0.107 +- 0.055 (in-sample avg dev_std = 0.077)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.338
Model XAI F1 of binarized graphs for r=0.3 =  0.41649749999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.30376250000000005
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.306
NEC for r=0.3 class 0 = 0.12 +- 0.015 (in-sample avg dev_std = 0.076)
NEC for r=0.3 class 1 = 0.097 +- 0.015 (in-sample avg dev_std = 0.076)
NEC for r=0.3 class 2 = 0.108 +- 0.015 (in-sample avg dev_std = 0.076)
NEC for r=0.3 all KL = 0.013 +- 0.015 (in-sample avg dev_std = 0.076)
NEC for r=0.3 all L1 = 0.109 +- 0.067 (in-sample avg dev_std = 0.076)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.391
Model XAI F1 of binarized graphs for r=0.6 =  0.47102499999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.35043375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.102 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 class 1 = 0.094 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 class 2 = 0.119 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all KL = 0.012 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all L1 = 0.105 +- 0.064 (in-sample avg dev_std = 0.071)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.356
Model XAI F1 of binarized graphs for r=0.9 =  0.42896
Model XAI WIoU of binarized graphs for r=0.9 =  0.29637250000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.316
NEC for r=0.9 class 0 = 0.106 +- 0.009 (in-sample avg dev_std = 0.070)
NEC for r=0.9 class 1 = 0.093 +- 0.009 (in-sample avg dev_std = 0.070)
NEC for r=0.9 class 2 = 0.099 +- 0.009 (in-sample avg dev_std = 0.070)
NEC for r=0.9 all KL = 0.01 +- 0.009 (in-sample avg dev_std = 0.070)
NEC for r=0.9 all L1 = 0.099 +- 0.049 (in-sample avg dev_std = 0.070)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.412
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.30358125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.321
NEC for r=1.0 class 0 = 0.11 +- 0.011 (in-sample avg dev_std = 0.076)
NEC for r=1.0 class 1 = 0.093 +- 0.011 (in-sample avg dev_std = 0.076)
NEC for r=1.0 class 2 = 0.11 +- 0.011 (in-sample avg dev_std = 0.076)
NEC for r=1.0 all KL = 0.011 +- 0.011 (in-sample avg dev_std = 0.076)
NEC for r=1.0 all L1 = 0.104 +- 0.054 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.2604925
Model XAI WIoU of binarized graphs for r=0.3 =  0.1704
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.338
NEC for r=0.3 class 0 = 0.083 +- 0.009 (in-sample avg dev_std = 0.074)
NEC for r=0.3 class 1 = 0.091 +- 0.009 (in-sample avg dev_std = 0.074)
NEC for r=0.3 class 2 = 0.073 +- 0.009 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all KL = 0.008 +- 0.009 (in-sample avg dev_std = 0.074)
NEC for r=0.3 all L1 = 0.082 +- 0.049 (in-sample avg dev_std = 0.074)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.365
Model XAI F1 of binarized graphs for r=0.6 =  0.35041125
Model XAI WIoU of binarized graphs for r=0.6 =  0.22877375
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.351
NEC for r=0.6 class 0 = 0.091 +- 0.014 (in-sample avg dev_std = 0.071)
NEC for r=0.6 class 1 = 0.077 +- 0.014 (in-sample avg dev_std = 0.071)
NEC for r=0.6 class 2 = 0.089 +- 0.014 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all KL = 0.009 +- 0.014 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all L1 = 0.085 +- 0.057 (in-sample avg dev_std = 0.071)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.524
Model XAI F1 of binarized graphs for r=0.9 =  0.40022874999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.2576475
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.387
NEC for r=0.9 class 0 = 0.069 +- 0.035 (in-sample avg dev_std = 0.070)
NEC for r=0.9 class 1 = 0.066 +- 0.035 (in-sample avg dev_std = 0.070)
NEC for r=0.9 class 2 = 0.18 +- 0.035 (in-sample avg dev_std = 0.070)
NEC for r=0.9 all KL = 0.018 +- 0.035 (in-sample avg dev_std = 0.070)
NEC for r=0.9 all L1 = 0.105 +- 0.096 (in-sample avg dev_std = 0.070)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.489
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.25154375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.409
NEC for r=1.0 class 0 = 0.07 +- 0.048 (in-sample avg dev_std = 0.071)
NEC for r=1.0 class 1 = 0.066 +- 0.048 (in-sample avg dev_std = 0.071)
NEC for r=1.0 class 2 = 0.181 +- 0.048 (in-sample avg dev_std = 0.071)
NEC for r=1.0 all KL = 0.021 +- 0.048 (in-sample avg dev_std = 0.071)
NEC for r=1.0 all L1 = 0.106 +- 0.100 (in-sample avg dev_std = 0.071)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:24:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:24:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.4244
Train Loss: 1.0672
ID Validation ACCURACY: 0.4457
ID Validation Loss: 1.0633
ID Test ACCURACY: 0.4233
ID Test Loss: 1.0685
OOD Validation ACCURACY: 0.4857
OOD Validation Loss: 1.0662
OOD Test ACCURACY: 0.4877
OOD Test Loss: 1.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.4244
Train Loss: 1.0672
ID Validation ACCURACY: 0.4457
ID Validation Loss: 1.0633
ID Test ACCURACY: 0.4233
ID Test Loss: 1.0685
OOD Validation ACCURACY: 0.4857
OOD Validation Loss: 1.0662
OOD Test ACCURACY: 0.4877
OOD Test Loss: 1.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.4233 0.4877 0.4233 0.4877 0.4457 0.4857[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.318
WIoU for r=0.3 = 0.239
F1 for r=0.6 = 0.450
WIoU for r=0.6 = 0.343
F1 for r=0.9 = 0.446
WIoU for r=0.9 = 0.311
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.311
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.300
WIoU for r=0.3 = 0.226
F1 for r=0.6 = 0.430
WIoU for r=0.6 = 0.327
F1 for r=0.9 = 0.430
WIoU for r=0.9 = 0.299
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.304
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.413
WIoU for r=0.3 = 0.285
F1 for r=0.6 = 0.400
WIoU for r=0.6 = 0.260
F1 for r=0.9 = 0.413
WIoU for r=0.9 = 0.269
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.252


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.319
Model XAI F1 of binarized graphs for r=0.3 =  0.31772500000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.23891624999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.328
SUFF++ for r=0.3 class 0 = 0.95 +- 0.005 (in-sample avg dev_std = 0.042)
SUFF++ for r=0.3 class 1 = 0.949 +- 0.005 (in-sample avg dev_std = 0.042)
SUFF++ for r=0.3 class 2 = 0.94 +- 0.005 (in-sample avg dev_std = 0.042)
SUFF++ for r=0.3 all KL = 0.996 +- 0.005 (in-sample avg dev_std = 0.042)
SUFF++ for r=0.3 all L1 = 0.946 +- 0.031 (in-sample avg dev_std = 0.042)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.346
Model XAI F1 of binarized graphs for r=0.6 =  0.44982875000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.34316374999999993
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.305
SUFF++ for r=0.6 class 0 = 0.921 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 class 1 = 0.932 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 class 2 = 0.903 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 all KL = 0.993 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 all L1 = 0.919 +- 0.038 (in-sample avg dev_std = 0.054)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.364
Model XAI F1 of binarized graphs for r=0.9 =  0.44561500000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.31060375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.349
SUFF++ for r=0.9 class 0 = 0.92 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 1 = 0.933 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 2 = 0.918 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all KL = 0.993 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all L1 = 0.924 +- 0.040 (in-sample avg dev_std = 0.057)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.341
Model XAI F1 of binarized graphs for r=0.3 =  0.29962625
Model XAI WIoU of binarized graphs for r=0.3 =  0.22559249999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.318
SUFF++ for r=0.3 class 0 = 0.946 +- 0.006 (in-sample avg dev_std = 0.046)
SUFF++ for r=0.3 class 1 = 0.946 +- 0.006 (in-sample avg dev_std = 0.046)
SUFF++ for r=0.3 class 2 = 0.938 +- 0.006 (in-sample avg dev_std = 0.046)
SUFF++ for r=0.3 all KL = 0.996 +- 0.006 (in-sample avg dev_std = 0.046)
SUFF++ for r=0.3 all L1 = 0.943 +- 0.034 (in-sample avg dev_std = 0.046)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.326
Model XAI F1 of binarized graphs for r=0.6 =  0.430385
Model XAI WIoU of binarized graphs for r=0.6 =  0.32678375000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.315
SUFF++ for r=0.6 class 0 = 0.918 +- 0.008 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 class 1 = 0.93 +- 0.008 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 class 2 = 0.9 +- 0.008 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 all KL = 0.992 +- 0.008 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.6 all L1 = 0.916 +- 0.038 (in-sample avg dev_std = 0.054)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.347
Model XAI F1 of binarized graphs for r=0.9 =  0.430325
Model XAI WIoU of binarized graphs for r=0.9 =  0.2985275
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.34
SUFF++ for r=0.9 class 0 = 0.924 +- 0.007 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 class 1 = 0.931 +- 0.007 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 class 2 = 0.915 +- 0.007 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 all KL = 0.993 +- 0.007 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.040 (in-sample avg dev_std = 0.058)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.41314
Model XAI WIoU of binarized graphs for r=0.3 =  0.2851475
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.327
SUFF++ for r=0.3 class 0 = 0.945 +- 0.004 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.3 class 1 = 0.938 +- 0.004 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.3 class 2 = 0.929 +- 0.004 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.3 all KL = 0.996 +- 0.004 (in-sample avg dev_std = 0.048)
SUFF++ for r=0.3 all L1 = 0.937 +- 0.030 (in-sample avg dev_std = 0.048)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.365
Model XAI F1 of binarized graphs for r=0.6 =  0.399525
Model XAI WIoU of binarized graphs for r=0.6 =  0.26014875
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.378
SUFF++ for r=0.6 class 0 = 0.933 +- 0.006 (in-sample avg dev_std = 0.056)
SUFF++ for r=0.6 class 1 = 0.908 +- 0.006 (in-sample avg dev_std = 0.056)
SUFF++ for r=0.6 class 2 = 0.909 +- 0.006 (in-sample avg dev_std = 0.056)
SUFF++ for r=0.6 all KL = 0.993 +- 0.006 (in-sample avg dev_std = 0.056)
SUFF++ for r=0.6 all L1 = 0.917 +- 0.032 (in-sample avg dev_std = 0.056)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.48
Model XAI F1 of binarized graphs for r=0.9 =  0.41293625000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.26855874999999996
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.441
SUFF++ for r=0.9 class 0 = 0.927 +- 0.009 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 class 1 = 0.928 +- 0.009 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 class 2 = 0.896 +- 0.009 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 all KL = 0.993 +- 0.009 (in-sample avg dev_std = 0.050)
SUFF++ for r=0.9 all L1 = 0.917 +- 0.041 (in-sample avg dev_std = 0.050)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.319
Model XAI F1 of binarized graphs for r=0.3 =  0.31772500000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.23891624999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.333
NEC for r=0.3 class 0 = 0.044 +- 0.006 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 1 = 0.047 +- 0.006 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 2 = 0.06 +- 0.006 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all KL = 0.004 +- 0.006 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all L1 = 0.05 +- 0.036 (in-sample avg dev_std = 0.036)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.346
Model XAI F1 of binarized graphs for r=0.6 =  0.44982875000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.34316374999999993
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.341
NEC for r=0.6 class 0 = 0.072 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 class 1 = 0.06 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 class 2 = 0.087 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 all KL = 0.006 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 all L1 = 0.073 +- 0.041 (in-sample avg dev_std = 0.046)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.364
Model XAI F1 of binarized graphs for r=0.9 =  0.44561500000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.31060375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.346
NEC for r=0.9 class 0 = 0.093 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 class 1 = 0.076 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 class 2 = 0.097 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 all KL = 0.008 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 all L1 = 0.089 +- 0.041 (in-sample avg dev_std = 0.051)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.442
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.31059125000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.362
NEC for r=1.0 class 0 = 0.106 +- 0.010 (in-sample avg dev_std = 0.053)
NEC for r=1.0 class 1 = 0.091 +- 0.010 (in-sample avg dev_std = 0.053)
NEC for r=1.0 class 2 = 0.11 +- 0.010 (in-sample avg dev_std = 0.053)
NEC for r=1.0 all KL = 0.011 +- 0.010 (in-sample avg dev_std = 0.053)
NEC for r=1.0 all L1 = 0.102 +- 0.050 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.341
Model XAI F1 of binarized graphs for r=0.3 =  0.29962625
Model XAI WIoU of binarized graphs for r=0.3 =  0.22559249999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.322
NEC for r=0.3 class 0 = 0.048 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.3 class 1 = 0.048 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.3 class 2 = 0.064 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.3 all KL = 0.004 +- 0.007 (in-sample avg dev_std = 0.034)
NEC for r=0.3 all L1 = 0.053 +- 0.039 (in-sample avg dev_std = 0.034)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.326
Model XAI F1 of binarized graphs for r=0.6 =  0.430385
Model XAI WIoU of binarized graphs for r=0.6 =  0.32678375000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.333
NEC for r=0.6 class 0 = 0.072 +- 0.009 (in-sample avg dev_std = 0.045)
NEC for r=0.6 class 1 = 0.061 +- 0.009 (in-sample avg dev_std = 0.045)
NEC for r=0.6 class 2 = 0.091 +- 0.009 (in-sample avg dev_std = 0.045)
NEC for r=0.6 all KL = 0.007 +- 0.009 (in-sample avg dev_std = 0.045)
NEC for r=0.6 all L1 = 0.075 +- 0.044 (in-sample avg dev_std = 0.045)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.347
Model XAI F1 of binarized graphs for r=0.9 =  0.430325
Model XAI WIoU of binarized graphs for r=0.9 =  0.2985275
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.34
NEC for r=0.9 class 0 = 0.093 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 class 1 = 0.079 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 class 2 = 0.1 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 all KL = 0.008 +- 0.007 (in-sample avg dev_std = 0.051)
NEC for r=0.9 all L1 = 0.091 +- 0.042 (in-sample avg dev_std = 0.051)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.41
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.30382750000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.354
NEC for r=1.0 class 0 = 0.104 +- 0.011 (in-sample avg dev_std = 0.053)
NEC for r=1.0 class 1 = 0.094 +- 0.011 (in-sample avg dev_std = 0.053)
NEC for r=1.0 class 2 = 0.111 +- 0.011 (in-sample avg dev_std = 0.053)
NEC for r=1.0 all KL = 0.011 +- 0.011 (in-sample avg dev_std = 0.053)
NEC for r=1.0 all L1 = 0.103 +- 0.051 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.343
Model XAI F1 of binarized graphs for r=0.3 =  0.41314
Model XAI WIoU of binarized graphs for r=0.3 =  0.2851475
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.254
NEC for r=0.3 class 0 = 0.047 +- 0.003 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 1 = 0.058 +- 0.003 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 2 = 0.067 +- 0.003 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all KL = 0.003 +- 0.003 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all L1 = 0.057 +- 0.027 (in-sample avg dev_std = 0.036)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.365
Model XAI F1 of binarized graphs for r=0.6 =  0.399525
Model XAI WIoU of binarized graphs for r=0.6 =  0.26014875
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.391
NEC for r=0.6 class 0 = 0.068 +- 0.004 (in-sample avg dev_std = 0.043)
NEC for r=0.6 class 1 = 0.081 +- 0.004 (in-sample avg dev_std = 0.043)
NEC for r=0.6 class 2 = 0.091 +- 0.004 (in-sample avg dev_std = 0.043)
NEC for r=0.6 all KL = 0.006 +- 0.004 (in-sample avg dev_std = 0.043)
NEC for r=0.6 all L1 = 0.08 +- 0.031 (in-sample avg dev_std = 0.043)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.48
Model XAI F1 of binarized graphs for r=0.9 =  0.41293625000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.26855874999999996
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.38
NEC for r=0.9 class 0 = 0.071 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.9 class 1 = 0.074 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.9 class 2 = 0.113 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.9 all KL = 0.008 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.9 all L1 = 0.086 +- 0.042 (in-sample avg dev_std = 0.052)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.491
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.25181375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.405
NEC for r=1.0 class 0 = 0.073 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=1.0 class 1 = 0.081 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=1.0 class 2 = 0.11 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=1.0 all KL = 0.009 +- 0.011 (in-sample avg dev_std = 0.060)
NEC for r=1.0 all L1 = 0.088 +- 0.047 (in-sample avg dev_std = 0.060)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.891, 0.849, 0.791, 1.0], 'all_L1': [0.782, 0.752, 0.735, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.997, 0.998, 1.0], 'all_L1': [0.96, 0.947, 0.954, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.836, 0.795, 1.0], 'all_L1': [0.816, 0.732, 0.713, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 0.986, 0.991, 1.0], 'all_L1': [0.89, 0.886, 0.912, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.993, 0.993, 1.0], 'all_L1': [0.946, 0.919, 0.924, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.106, 0.127, 0.261, 0.299], 'all_L1': [0.201, 0.222, 0.314, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.004, 0.003, 0.003], 'all_L1': [0.032, 0.052, 0.055, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.127, 0.243, 0.238], 'all_L1': [0.171, 0.241, 0.329, 0.348]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.012, 0.01, 0.012], 'all_L1': [0.106, 0.102, 0.101, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.006, 0.008, 0.011], 'all_L1': [0.05, 0.073, 0.089, 0.102]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.888, 0.85, 0.776, 1.0], 'all_L1': [0.778, 0.758, 0.727, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.997, 0.996, 0.998, 1.0], 'all_L1': [0.956, 0.944, 0.954, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.907, 0.834, 0.778, 1.0], 'all_L1': [0.81, 0.728, 0.699, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.984, 0.992, 1.0], 'all_L1': [0.885, 0.881, 0.914, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.992, 0.993, 1.0], 'all_L1': [0.943, 0.916, 0.923, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.104, 0.132, 0.286, 0.298], 'all_L1': [0.201, 0.223, 0.323, 0.349]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.004, 0.003, 0.003], 'all_L1': [0.034, 0.052, 0.056, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.139, 0.266, 0.253], 'all_L1': [0.181, 0.25, 0.344, 0.361]}), defaultdict(<class 'list'>, {'all_KL': [0.013, 0.012, 0.01, 0.011], 'all_L1': [0.109, 0.105, 0.099, 0.104]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.007, 0.008, 0.011], 'all_L1': [0.053, 0.075, 0.091, 0.103]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.858, 0.742, 0.778, 1.0], 'all_L1': [0.755, 0.661, 0.673, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.998, 0.996, 0.998, 1.0], 'all_L1': [0.961, 0.944, 0.954, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.696, 0.625, 1.0], 'all_L1': [0.788, 0.632, 0.531, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.992, 0.992, 0.983, 1.0], 'all_L1': [0.911, 0.918, 0.899, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.996, 0.993, 0.993, 1.0], 'all_L1': [0.937, 0.917, 0.917, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.117, 0.23, 0.247, 0.231], 'all_L1': [0.216, 0.324, 0.346, 0.334]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.004, 0.002, 0.003], 'all_L1': [0.045, 0.052, 0.043, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.3, 0.355, 0.411], 'all_L1': [0.158, 0.374, 0.459, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.009, 0.018, 0.021], 'all_L1': [0.082, 0.085, 0.105, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.006, 0.008, 0.009], 'all_L1': [0.057, 0.08, 0.086, 0.088]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.879 +- 0.070, 0.847 +- 0.088, 0.848 +- 0.102, 1.000 +- 0.000
suff++ class all_KL  =  0.957 +- 0.046, 0.932 +- 0.073, 0.914 +- 0.099, 1.000 +- 0.000
suff++_acc_int  =  0.338 +- 0.009, 0.336 +- 0.019, 0.370 +- 0.014
nec class all_L1  =  0.112 +- 0.066, 0.138 +- 0.078, 0.178 +- 0.119, 0.193 +- 0.130
nec class all_KL  =  0.040 +- 0.043, 0.055 +- 0.059, 0.105 +- 0.120, 0.113 +- 0.129
nec_acc_int  =  0.339 +- 0.021, 0.336 +- 0.010, 0.337 +- 0.013, 0.340 +- 0.013

Eval split id_test
suff++ class all_L1  =  0.874 +- 0.071, 0.845 +- 0.086, 0.843 +- 0.108, 1.000 +- 0.000
suff++ class all_KL  =  0.955 +- 0.047, 0.931 +- 0.073, 0.907 +- 0.106, 1.000 +- 0.000
suff++_acc_int  =  0.332 +- 0.014, 0.334 +- 0.014, 0.367 +- 0.016
nec class all_L1  =  0.116 +- 0.067, 0.141 +- 0.080, 0.183 +- 0.124, 0.194 +- 0.132
nec class all_KL  =  0.040 +- 0.042, 0.059 +- 0.063, 0.115 +- 0.132, 0.115 +- 0.132
nec_acc_int  =  0.330 +- 0.019, 0.334 +- 0.011, 0.333 +- 0.014, 0.336 +- 0.015

Eval split test
suff++ class all_L1  =  0.870 +- 0.083, 0.814 +- 0.138, 0.795 +- 0.165, 1.000 +- 0.000
suff++ class all_KL  =  0.945 +- 0.062, 0.884 +- 0.135, 0.875 +- 0.150, 1.000 +- 0.000
suff++_acc_int  =  0.346 +- 0.018, 0.362 +- 0.015, 0.386 +- 0.036
nec class all_L1  =  0.112 +- 0.065, 0.183 +- 0.137, 0.208 +- 0.164, 0.219 +- 0.179
nec class all_KL  =  0.041 +- 0.046, 0.110 +- 0.129, 0.126 +- 0.147, 0.135 +- 0.162
nec_acc_int  =  0.326 +- 0.036, 0.354 +- 0.020, 0.362 +- 0.021, 0.384 +- 0.021


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.495 +- 0.003, 0.493 +- 0.005, 0.513 +- 0.008, 0.596 +- 0.065
Faith. Armon (L1)= 		  =  0.190 +- 0.101, 0.224 +- 0.108, 0.268 +- 0.147, 0.304 +- 0.178
Faith. GMean (L1)= 	  =  0.294 +- 0.086, 0.322 +- 0.079, 0.357 +- 0.105, 0.413 +- 0.150
Faith. Aritm (KL)= 		  =  0.498 +- 0.003, 0.494 +- 0.008, 0.509 +- 0.011, 0.556 +- 0.064
Faith. Armon (KL)= 		  =  0.073 +- 0.077, 0.097 +- 0.101, 0.161 +- 0.181, 0.179 +- 0.200
Faith. GMean (KL)= 	  =  0.157 +- 0.107, 0.181 +- 0.120, 0.227 +- 0.180, 0.261 +- 0.211

Eval split id_test
Faith. Aritm (L1)= 		  =  0.495 +- 0.003, 0.493 +- 0.003, 0.513 +- 0.008, 0.597 +- 0.066
Faith. Armon (L1)= 		  =  0.195 +- 0.101, 0.228 +- 0.110, 0.272 +- 0.151, 0.305 +- 0.181
Faith. GMean (L1)= 	  =  0.299 +- 0.085, 0.325 +- 0.081, 0.359 +- 0.107, 0.414 +- 0.152
Faith. Aritm (KL)= 		  =  0.498 +- 0.003, 0.495 +- 0.005, 0.511 +- 0.013, 0.558 +- 0.066
Faith. Armon (KL)= 		  =  0.073 +- 0.076, 0.102 +- 0.107, 0.171 +- 0.193, 0.183 +- 0.204
Faith. GMean (KL)= 	  =  0.158 +- 0.107, 0.186 +- 0.125, 0.234 +- 0.188, 0.263 +- 0.215

Eval split test
Faith. Aritm (L1)= 		  =  0.491 +- 0.011, 0.499 +- 0.004, 0.501 +- 0.005, 0.610 +- 0.090
Faith. Armon (L1)= 		  =  0.189 +- 0.096, 0.261 +- 0.158, 0.275 +- 0.167, 0.326 +- 0.226
Faith. GMean (L1)= 	  =  0.294 +- 0.074, 0.344 +- 0.108, 0.353 +- 0.115, 0.429 +- 0.188
Faith. Aritm (KL)= 		  =  0.493 +- 0.010, 0.497 +- 0.005, 0.501 +- 0.007, 0.567 +- 0.081
Faith. Armon (KL)= 		  =  0.073 +- 0.082, 0.162 +- 0.184, 0.177 +- 0.196, 0.205 +- 0.234
Faith. GMean (KL)= 	  =  0.153 +- 0.110, 0.221 +- 0.176, 0.235 +- 0.182, 0.283 +- 0.234
Computed for split load_split = id



Completed in  0:16:47.264948  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:28:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:28:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ACCURACY: 0.6028
Train Loss: 1.3109
ID Validation ACCURACY: 0.6023
ID Validation Loss: 1.3769
ID Test ACCURACY: 0.5940
ID Test Loss: 1.4297
OOD Validation ACCURACY: 0.5293
OOD Validation Loss: 0.9889
OOD Test ACCURACY: 0.5980
OOD Test Loss: 0.8742

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ACCURACY: 0.6028
Train Loss: 1.3109
ID Validation ACCURACY: 0.6023
ID Validation Loss: 1.3769
ID Test ACCURACY: 0.5940
ID Test Loss: 1.4297
OOD Validation ACCURACY: 0.5293
OOD Validation Loss: 0.9889
OOD Test ACCURACY: 0.5980
OOD Test Loss: 0.8742

[0m[1;37mINFO[0m: [1mChartInfo 0.5940 0.5980 0.5940 0.5980 0.6023 0.5293[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.394
WIoU for r=0.3 = 0.302
F1 for r=0.6 = 0.372
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.437
WIoU for r=0.9 = 0.290
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.301
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.399
WIoU for r=0.3 = 0.305
F1 for r=0.6 = 0.374
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.428
WIoU for r=0.9 = 0.283
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.295
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.422
WIoU for r=0.3 = 0.320
F1 for r=0.6 = 0.389
WIoU for r=0.6 = 0.284
F1 for r=0.9 = 0.387
WIoU for r=0.9 = 0.247
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.246


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.333
Model XAI F1 of binarized graphs for r=0.3 =  0.3942625
Model XAI WIoU of binarized graphs for r=0.3 =  0.30203625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.374
SUFF++ for r=0.3 class 0 = 0.628 +- 0.301 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.698 +- 0.301 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.301 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.473 +- 0.301 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.642 +- 0.206 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.249
Model XAI F1 of binarized graphs for r=0.6 =  0.37206125
Model XAI WIoU of binarized graphs for r=0.6 =  0.26204875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.333
SUFF++ for r=0.6 class 0 = 0.561 +- 0.277 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 class 1 = 0.451 +- 0.277 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 class 2 = 0.545 +- 0.277 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 all KL = 0.425 +- 0.277 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.6 all L1 = 0.519 +- 0.173 (in-sample avg dev_std = 0.518)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.498
Model XAI F1 of binarized graphs for r=0.9 =  0.43741625
Model XAI WIoU of binarized graphs for r=0.9 =  0.28981625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.427
SUFF++ for r=0.9 class 0 = 0.564 +- 0.239 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.9 class 1 = 0.697 +- 0.239 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.9 class 2 = 0.571 +- 0.239 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.9 all KL = 0.697 +- 0.239 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.9 all L1 = 0.611 +- 0.182 (in-sample avg dev_std = 0.373)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.304
Model XAI F1 of binarized graphs for r=0.3 =  0.39890125
Model XAI WIoU of binarized graphs for r=0.3 =  0.30519874999999996
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.372
SUFF++ for r=0.3 class 0 = 0.617 +- 0.300 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.668 +- 0.300 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.599 +- 0.300 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.471 +- 0.300 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.627 +- 0.212 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.24
Model XAI F1 of binarized graphs for r=0.6 =  0.37412499999999993
Model XAI WIoU of binarized graphs for r=0.6 =  0.26154000000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.32
SUFF++ for r=0.6 class 0 = 0.578 +- 0.274 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 1 = 0.456 +- 0.274 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 class 2 = 0.568 +- 0.274 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all KL = 0.422 +- 0.274 (in-sample avg dev_std = 0.516)
SUFF++ for r=0.6 all L1 = 0.535 +- 0.181 (in-sample avg dev_std = 0.516)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.488
Model XAI F1 of binarized graphs for r=0.9 =  0.42833375
Model XAI WIoU of binarized graphs for r=0.9 =  0.2833325
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.403
SUFF++ for r=0.9 class 0 = 0.542 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.9 class 1 = 0.672 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.9 class 2 = 0.561 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.9 all KL = 0.672 +- 0.245 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.9 all L1 = 0.591 +- 0.186 (in-sample avg dev_std = 0.385)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.269
Model XAI F1 of binarized graphs for r=0.3 =  0.4222075
Model XAI WIoU of binarized graphs for r=0.3 =  0.32020375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.289
SUFF++ for r=0.3 class 0 = 0.628 +- 0.272 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 1 = 0.579 +- 0.272 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 2 = 0.603 +- 0.272 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all KL = 0.476 +- 0.272 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.150 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.326
Model XAI F1 of binarized graphs for r=0.6 =  0.38853875000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.284265
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.268
SUFF++ for r=0.6 class 0 = 0.437 +- 0.259 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 1 = 0.512 +- 0.259 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 class 2 = 0.503 +- 0.259 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all KL = 0.569 +- 0.259 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.6 all L1 = 0.485 +- 0.163 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.469
Model XAI F1 of binarized graphs for r=0.9 =  0.38733000000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.24735
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.552
SUFF++ for r=0.9 class 0 = 0.574 +- 0.174 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 1 = 0.629 +- 0.174 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 class 2 = 0.576 +- 0.174 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all KL = 0.76 +- 0.174 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.9 all L1 = 0.593 +- 0.149 (in-sample avg dev_std = 0.287)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.333
Model XAI F1 of binarized graphs for r=0.3 =  0.3942625
Model XAI WIoU of binarized graphs for r=0.3 =  0.30203625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
NEC for r=0.3 class 0 = 0.348 +- 0.350 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.328 +- 0.350 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.27 +- 0.350 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.42 +- 0.350 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.315 +- 0.271 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.249
Model XAI F1 of binarized graphs for r=0.6 =  0.37206125
Model XAI WIoU of binarized graphs for r=0.6 =  0.26204875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.309
NEC for r=0.6 class 0 = 0.448 +- 0.287 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 1 = 0.579 +- 0.287 (in-sample avg dev_std = 0.501)
NEC for r=0.6 class 2 = 0.442 +- 0.287 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all KL = 0.58 +- 0.287 (in-sample avg dev_std = 0.501)
NEC for r=0.6 all L1 = 0.49 +- 0.206 (in-sample avg dev_std = 0.501)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.495
Model XAI F1 of binarized graphs for r=0.9 =  0.43741625
Model XAI WIoU of binarized graphs for r=0.9 =  0.28981625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.397
NEC for r=0.9 class 0 = 0.506 +- 0.256 (in-sample avg dev_std = 0.387)
NEC for r=0.9 class 1 = 0.392 +- 0.256 (in-sample avg dev_std = 0.387)
NEC for r=0.9 class 2 = 0.521 +- 0.256 (in-sample avg dev_std = 0.387)
NEC for r=0.9 all KL = 0.401 +- 0.256 (in-sample avg dev_std = 0.387)
NEC for r=0.9 all L1 = 0.473 +- 0.158 (in-sample avg dev_std = 0.387)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.611
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.30100125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.456
NEC for r=1.0 class 0 = 0.492 +- 0.240 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 1 = 0.318 +- 0.240 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 2 = 0.533 +- 0.240 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all KL = 0.368 +- 0.240 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all L1 = 0.447 +- 0.169 (in-sample avg dev_std = 0.382)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.304
Model XAI F1 of binarized graphs for r=0.3 =  0.39890125
Model XAI WIoU of binarized graphs for r=0.3 =  0.30519874999999996
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.358
NEC for r=0.3 class 0 = 0.375 +- 0.351 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 1 = 0.344 +- 0.351 (in-sample avg dev_std = 0.401)
NEC for r=0.3 class 2 = 0.288 +- 0.351 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all KL = 0.429 +- 0.351 (in-sample avg dev_std = 0.401)
NEC for r=0.3 all L1 = 0.334 +- 0.278 (in-sample avg dev_std = 0.401)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  0.37412499999999993
Model XAI WIoU of binarized graphs for r=0.6 =  0.26154000000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.289
NEC for r=0.6 class 0 = 0.444 +- 0.296 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 1 = 0.581 +- 0.296 (in-sample avg dev_std = 0.499)
NEC for r=0.6 class 2 = 0.426 +- 0.296 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all KL = 0.588 +- 0.296 (in-sample avg dev_std = 0.499)
NEC for r=0.6 all L1 = 0.482 +- 0.215 (in-sample avg dev_std = 0.499)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.488
Model XAI F1 of binarized graphs for r=0.9 =  0.42833375
Model XAI WIoU of binarized graphs for r=0.9 =  0.2833325
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.384
NEC for r=0.9 class 0 = 0.51 +- 0.254 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 1 = 0.398 +- 0.254 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 2 = 0.514 +- 0.254 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all KL = 0.406 +- 0.254 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all L1 = 0.475 +- 0.159 (in-sample avg dev_std = 0.383)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.29525375000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.442
NEC for r=1.0 class 0 = 0.489 +- 0.234 (in-sample avg dev_std = 0.383)
NEC for r=1.0 class 1 = 0.327 +- 0.234 (in-sample avg dev_std = 0.383)
NEC for r=1.0 class 2 = 0.516 +- 0.234 (in-sample avg dev_std = 0.383)
NEC for r=1.0 all KL = 0.366 +- 0.234 (in-sample avg dev_std = 0.383)
NEC for r=1.0 all L1 = 0.446 +- 0.164 (in-sample avg dev_std = 0.383)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.269
Model XAI F1 of binarized graphs for r=0.3 =  0.4222075
Model XAI WIoU of binarized graphs for r=0.3 =  0.32020375
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.233
NEC for r=0.3 class 0 = 0.438 +- 0.311 (in-sample avg dev_std = 0.543)
NEC for r=0.3 class 1 = 0.501 +- 0.311 (in-sample avg dev_std = 0.543)
NEC for r=0.3 class 2 = 0.408 +- 0.311 (in-sample avg dev_std = 0.543)
NEC for r=0.3 all KL = 0.553 +- 0.311 (in-sample avg dev_std = 0.543)
NEC for r=0.3 all L1 = 0.45 +- 0.182 (in-sample avg dev_std = 0.543)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.326
Model XAI F1 of binarized graphs for r=0.6 =  0.38853875000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.284265
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.216
NEC for r=0.6 class 0 = 0.556 +- 0.233 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 1 = 0.411 +- 0.233 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 2 = 0.516 +- 0.233 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all KL = 0.397 +- 0.233 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all L1 = 0.493 +- 0.171 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.469
Model XAI F1 of binarized graphs for r=0.9 =  0.38733000000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.24735
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.377
NEC for r=0.9 class 0 = 0.465 +- 0.293 (in-sample avg dev_std = 0.301)
NEC for r=0.9 class 1 = 0.317 +- 0.293 (in-sample avg dev_std = 0.301)
NEC for r=0.9 class 2 = 0.546 +- 0.293 (in-sample avg dev_std = 0.301)
NEC for r=0.9 all KL = 0.316 +- 0.293 (in-sample avg dev_std = 0.301)
NEC for r=0.9 all L1 = 0.441 +- 0.206 (in-sample avg dev_std = 0.301)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.585
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.24588749999999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.47
NEC for r=1.0 class 0 = 0.429 +- 0.239 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 1 = 0.272 +- 0.239 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 2 = 0.499 +- 0.239 (in-sample avg dev_std = 0.324)
NEC for r=1.0 all KL = 0.256 +- 0.239 (in-sample avg dev_std = 0.324)
NEC for r=1.0 all L1 = 0.399 +- 0.191 (in-sample avg dev_std = 0.324)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:31:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:31:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5381
Train Loss: 1.0950
ID Validation ACCURACY: 0.5360
ID Validation Loss: 1.1089
ID Test ACCURACY: 0.5317
ID Test Loss: 1.1001
OOD Validation ACCURACY: 0.4023
OOD Validation Loss: 1.1556
OOD Test ACCURACY: 0.4657
OOD Test Loss: 1.2003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ACCURACY: 0.4654
Train Loss: 1.6427
ID Validation ACCURACY: 0.4630
ID Validation Loss: 1.6315
ID Test ACCURACY: 0.4567
ID Test Loss: 1.6634
OOD Validation ACCURACY: 0.4967
OOD Validation Loss: 1.5536
OOD Test ACCURACY: 0.2770
OOD Test Loss: 1.5453

[0m[1;37mINFO[0m: [1mChartInfo 0.5317 0.4657 0.4567 0.2770 0.4630 0.4967[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.341
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.356
WIoU for r=0.6 = 0.245
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.283
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.303
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.348
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.364
WIoU for r=0.6 = 0.249
F1 for r=0.9 = 0.419
WIoU for r=0.9 = 0.280
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.297
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.159
WIoU for r=0.3 = 0.105
F1 for r=0.6 = 0.241
WIoU for r=0.6 = 0.168
F1 for r=0.9 = 0.324
WIoU for r=0.9 = 0.202
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.242


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.404
Model XAI F1 of binarized graphs for r=0.3 =  0.34103625
Model XAI WIoU of binarized graphs for r=0.3 =  0.2647975
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
SUFF++ for r=0.3 class 0 = 0.615 +- 0.229 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 1 = 0.671 +- 0.229 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 2 = 0.549 +- 0.229 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all KL = 0.573 +- 0.229 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all L1 = 0.612 +- 0.161 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.319
Model XAI F1 of binarized graphs for r=0.6 =  0.35620374999999993
Model XAI WIoU of binarized graphs for r=0.6 =  0.24488875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.408
SUFF++ for r=0.6 class 0 = 0.54 +- 0.202 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 class 1 = 0.501 +- 0.202 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 class 2 = 0.519 +- 0.202 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 all KL = 0.617 +- 0.202 (in-sample avg dev_std = 0.431)
SUFF++ for r=0.6 all L1 = 0.52 +- 0.113 (in-sample avg dev_std = 0.431)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.403
Model XAI F1 of binarized graphs for r=0.9 =  0.42170500000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.2830475
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.524
SUFF++ for r=0.9 class 0 = 0.609 +- 0.229 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 1 = 0.58 +- 0.229 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 2 = 0.584 +- 0.229 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all KL = 0.724 +- 0.229 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all L1 = 0.591 +- 0.178 (in-sample avg dev_std = 0.324)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.407
Model XAI F1 of binarized graphs for r=0.3 =  0.34817750000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.26600124999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
SUFF++ for r=0.3 class 0 = 0.582 +- 0.233 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 1 = 0.677 +- 0.233 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 class 2 = 0.584 +- 0.233 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all KL = 0.581 +- 0.233 (in-sample avg dev_std = 0.480)
SUFF++ for r=0.3 all L1 = 0.614 +- 0.158 (in-sample avg dev_std = 0.480)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.331
Model XAI F1 of binarized graphs for r=0.6 =  0.3640025
Model XAI WIoU of binarized graphs for r=0.6 =  0.24938375000000002
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.399
SUFF++ for r=0.6 class 0 = 0.535 +- 0.202 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 1 = 0.5 +- 0.202 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 class 2 = 0.524 +- 0.202 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all KL = 0.616 +- 0.202 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.6 all L1 = 0.52 +- 0.115 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.431
Model XAI F1 of binarized graphs for r=0.9 =  0.41885374999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.2803525
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.526
SUFF++ for r=0.9 class 0 = 0.585 +- 0.232 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.9 class 1 = 0.564 +- 0.232 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.9 class 2 = 0.586 +- 0.232 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.9 all KL = 0.705 +- 0.232 (in-sample avg dev_std = 0.332)
SUFF++ for r=0.9 all L1 = 0.579 +- 0.180 (in-sample avg dev_std = 0.332)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.339
Model XAI F1 of binarized graphs for r=0.3 =  0.15946249999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.10492000000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.367
SUFF++ for r=0.3 class 0 = 0.541 +- 0.235 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 class 1 = 0.512 +- 0.235 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 class 2 = 0.6 +- 0.235 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 all KL = 0.597 +- 0.235 (in-sample avg dev_std = 0.464)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.118 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.404
Model XAI F1 of binarized graphs for r=0.6 =  0.24079749999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.16820374999999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.32
SUFF++ for r=0.6 class 0 = 0.566 +- 0.178 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 class 1 = 0.555 +- 0.178 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 class 2 = 0.551 +- 0.178 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all KL = 0.715 +- 0.178 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all L1 = 0.557 +- 0.124 (in-sample avg dev_std = 0.360)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.442
Model XAI F1 of binarized graphs for r=0.9 =  0.32358000000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.20216375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.49
SUFF++ for r=0.9 class 0 = 0.703 +- 0.104 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1 = 0.745 +- 0.104 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 2 = 0.659 +- 0.104 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.874 +- 0.104 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.703 +- 0.126 (in-sample avg dev_std = 0.219)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.404
Model XAI F1 of binarized graphs for r=0.3 =  0.34103625
Model XAI WIoU of binarized graphs for r=0.3 =  0.2647975
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.39
NEC for r=0.3 class 0 = 0.406 +- 0.327 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 1 = 0.239 +- 0.327 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 2 = 0.464 +- 0.327 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all KL = 0.378 +- 0.327 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all L1 = 0.369 +- 0.257 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.32
Model XAI F1 of binarized graphs for r=0.6 =  0.35620374999999993
Model XAI WIoU of binarized graphs for r=0.6 =  0.24488875
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.352
NEC for r=0.6 class 0 = 0.486 +- 0.223 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 1 = 0.457 +- 0.223 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 2 = 0.501 +- 0.223 (in-sample avg dev_std = 0.434)
NEC for r=0.6 all KL = 0.394 +- 0.223 (in-sample avg dev_std = 0.434)
NEC for r=0.6 all L1 = 0.481 +- 0.153 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.403
Model XAI F1 of binarized graphs for r=0.9 =  0.42170500000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.2830475
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.426
NEC for r=0.9 class 0 = 0.477 +- 0.225 (in-sample avg dev_std = 0.359)
NEC for r=0.9 class 1 = 0.461 +- 0.225 (in-sample avg dev_std = 0.359)
NEC for r=0.9 class 2 = 0.501 +- 0.225 (in-sample avg dev_std = 0.359)
NEC for r=0.9 all KL = 0.356 +- 0.225 (in-sample avg dev_std = 0.359)
NEC for r=0.9 all L1 = 0.48 +- 0.146 (in-sample avg dev_std = 0.359)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.544
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.30290999999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.468
NEC for r=1.0 class 0 = 0.474 +- 0.196 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 1 = 0.416 +- 0.196 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 2 = 0.498 +- 0.196 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all KL = 0.315 +- 0.196 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all L1 = 0.462 +- 0.135 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.407
Model XAI F1 of binarized graphs for r=0.3 =  0.34817750000000003
Model XAI WIoU of binarized graphs for r=0.3 =  0.26600124999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.382
NEC for r=0.3 class 0 = 0.425 +- 0.322 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 1 = 0.239 +- 0.322 (in-sample avg dev_std = 0.390)
NEC for r=0.3 class 2 = 0.436 +- 0.322 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all KL = 0.368 +- 0.322 (in-sample avg dev_std = 0.390)
NEC for r=0.3 all L1 = 0.368 +- 0.250 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.331
Model XAI F1 of binarized graphs for r=0.6 =  0.3640025
Model XAI WIoU of binarized graphs for r=0.6 =  0.24938375000000002
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.348
NEC for r=0.6 class 0 = 0.484 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 1 = 0.465 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 2 = 0.498 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all KL = 0.397 +- 0.233 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all L1 = 0.482 +- 0.158 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.431
Model XAI F1 of binarized graphs for r=0.9 =  0.41885374999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.2803525
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.444
NEC for r=0.9 class 0 = 0.475 +- 0.231 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 1 = 0.466 +- 0.231 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 2 = 0.498 +- 0.231 (in-sample avg dev_std = 0.367)
NEC for r=0.9 all KL = 0.364 +- 0.231 (in-sample avg dev_std = 0.367)
NEC for r=0.9 all L1 = 0.48 +- 0.149 (in-sample avg dev_std = 0.367)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.54
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.296775
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.456
NEC for r=1.0 class 0 = 0.47 +- 0.202 (in-sample avg dev_std = 0.361)
NEC for r=1.0 class 1 = 0.425 +- 0.202 (in-sample avg dev_std = 0.361)
NEC for r=1.0 class 2 = 0.495 +- 0.202 (in-sample avg dev_std = 0.361)
NEC for r=1.0 all KL = 0.322 +- 0.202 (in-sample avg dev_std = 0.361)
NEC for r=1.0 all L1 = 0.464 +- 0.135 (in-sample avg dev_std = 0.361)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.339
Model XAI F1 of binarized graphs for r=0.3 =  0.15946249999999998
Model XAI WIoU of binarized graphs for r=0.3 =  0.10492000000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.438
NEC for r=0.3 class 0 = 0.414 +- 0.194 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 1 = 0.367 +- 0.194 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 2 = 0.429 +- 0.194 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all KL = 0.34 +- 0.194 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all L1 = 0.403 +- 0.137 (in-sample avg dev_std = 0.404)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.404
Model XAI F1 of binarized graphs for r=0.6 =  0.24079749999999997
Model XAI WIoU of binarized graphs for r=0.6 =  0.16820374999999999
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.329
NEC for r=0.6 class 0 = 0.406 +- 0.193 (in-sample avg dev_std = 0.337)
NEC for r=0.6 class 1 = 0.404 +- 0.193 (in-sample avg dev_std = 0.337)
NEC for r=0.6 class 2 = 0.441 +- 0.193 (in-sample avg dev_std = 0.337)
NEC for r=0.6 all KL = 0.263 +- 0.193 (in-sample avg dev_std = 0.337)
NEC for r=0.6 all L1 = 0.417 +- 0.150 (in-sample avg dev_std = 0.337)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.456
Model XAI F1 of binarized graphs for r=0.9 =  0.32358000000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.20216375
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.346
NEC for r=0.9 class 0 = 0.329 +- 0.138 (in-sample avg dev_std = 0.237)
NEC for r=0.9 class 1 = 0.288 +- 0.138 (in-sample avg dev_std = 0.237)
NEC for r=0.9 class 2 = 0.393 +- 0.138 (in-sample avg dev_std = 0.237)
NEC for r=0.9 all KL = 0.163 +- 0.138 (in-sample avg dev_std = 0.237)
NEC for r=0.9 all L1 = 0.336 +- 0.143 (in-sample avg dev_std = 0.237)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.469
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.24219749999999998
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.367
NEC for r=1.0 class 0 = 0.373 +- 0.145 (in-sample avg dev_std = 0.221)
NEC for r=1.0 class 1 = 0.236 +- 0.145 (in-sample avg dev_std = 0.221)
NEC for r=1.0 class 2 = 0.372 +- 0.145 (in-sample avg dev_std = 0.221)
NEC for r=1.0 all KL = 0.164 +- 0.145 (in-sample avg dev_std = 0.221)
NEC for r=1.0 all L1 = 0.326 +- 0.146 (in-sample avg dev_std = 0.221)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:34:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:34:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.6714
Train Loss: 0.8260
ID Validation ACCURACY: 0.6680
ID Validation Loss: 0.8314
ID Test ACCURACY: 0.6670
ID Test Loss: 0.8269
OOD Validation ACCURACY: 0.4190
OOD Validation Loss: 1.0951
OOD Test ACCURACY: 0.5823
OOD Test Loss: 0.9768

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.5975
Train Loss: 1.0049
ID Validation ACCURACY: 0.5990
ID Validation Loss: 0.9857
ID Test ACCURACY: 0.5690
ID Test Loss: 1.0483
OOD Validation ACCURACY: 0.6363
OOD Validation Loss: 0.9072
OOD Test ACCURACY: 0.3210
OOD Test Loss: 1.4836

[0m[1;37mINFO[0m: [1mChartInfo 0.6670 0.5823 0.5690 0.3210 0.5990 0.6363[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.459
WIoU for r=0.3 = 0.359
F1 for r=0.6 = 0.408
WIoU for r=0.6 = 0.299
F1 for r=0.9 = 0.426
WIoU for r=0.9 = 0.289
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.305
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.466
WIoU for r=0.3 = 0.362
F1 for r=0.6 = 0.413
WIoU for r=0.6 = 0.300
F1 for r=0.9 = 0.422
WIoU for r=0.9 = 0.284
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.299
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.500
WIoU for r=0.3 = 0.397
F1 for r=0.6 = 0.399
WIoU for r=0.6 = 0.287
F1 for r=0.9 = 0.370
WIoU for r=0.9 = 0.236
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.249


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.45858625
Model XAI WIoU of binarized graphs for r=0.3 =  0.359255
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.397
SUFF++ for r=0.3 class 0 = 0.516 +- 0.227 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 class 1 = 0.668 +- 0.227 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 class 2 = 0.599 +- 0.227 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 all KL = 0.581 +- 0.227 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 all L1 = 0.595 +- 0.184 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.301
Model XAI F1 of binarized graphs for r=0.6 =  0.40777375000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.29850625000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.469
SUFF++ for r=0.6 class 0 = 0.475 +- 0.244 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1 = 0.457 +- 0.244 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 2 = 0.499 +- 0.244 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.549 +- 0.244 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.477 +- 0.141 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.599
Model XAI F1 of binarized graphs for r=0.9 =  0.42644875
Model XAI WIoU of binarized graphs for r=0.9 =  0.28864375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.626
SUFF++ for r=0.9 class 0 = 0.611 +- 0.173 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 1 = 0.597 +- 0.173 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 2 = 0.653 +- 0.173 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all KL = 0.774 +- 0.173 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all L1 = 0.62 +- 0.164 (in-sample avg dev_std = 0.282)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.46641625
Model XAI WIoU of binarized graphs for r=0.3 =  0.36249624999999996
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.388
SUFF++ for r=0.3 class 0 = 0.501 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 class 1 = 0.68 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 class 2 = 0.593 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 all KL = 0.582 +- 0.225 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.3 all L1 = 0.591 +- 0.179 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.281
Model XAI F1 of binarized graphs for r=0.6 =  0.41290750000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.29975375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.464
SUFF++ for r=0.6 class 0 = 0.48 +- 0.252 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 1 = 0.45 +- 0.252 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 class 2 = 0.497 +- 0.252 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all KL = 0.544 +- 0.252 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.6 all L1 = 0.476 +- 0.142 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  0.42183875
Model XAI WIoU of binarized graphs for r=0.9 =  0.28419249999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.598
SUFF++ for r=0.9 class 0 = 0.605 +- 0.168 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 1 = 0.59 +- 0.168 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 class 2 = 0.664 +- 0.168 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all KL = 0.773 +- 0.168 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.9 all L1 = 0.621 +- 0.159 (in-sample avg dev_std = 0.282)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.428
Model XAI F1 of binarized graphs for r=0.3 =  0.50033125
Model XAI WIoU of binarized graphs for r=0.3 =  0.397045
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.403
SUFF++ for r=0.3 class 0 = 0.589 +- 0.213 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 class 1 = 0.713 +- 0.213 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 class 2 = 0.701 +- 0.213 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 all KL = 0.633 +- 0.213 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.3 all L1 = 0.669 +- 0.138 (in-sample avg dev_std = 0.449)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.577
Model XAI F1 of binarized graphs for r=0.6 =  0.3989575
Model XAI WIoU of binarized graphs for r=0.6 =  0.28687999999999997
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.51
SUFF++ for r=0.6 class 0 = 0.539 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 1 = 0.57 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 class 2 = 0.574 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all KL = 0.698 +- 0.179 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.6 all L1 = 0.561 +- 0.114 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.589
Model XAI F1 of binarized graphs for r=0.9 =  0.36990249999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.23604750000000002
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.552
SUFF++ for r=0.9 class 0 = 0.662 +- 0.097 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 class 1 = 0.773 +- 0.097 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 class 2 = 0.675 +- 0.097 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all KL = 0.884 +- 0.097 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.9 all L1 = 0.704 +- 0.121 (in-sample avg dev_std = 0.199)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.45858625
Model XAI WIoU of binarized graphs for r=0.3 =  0.359255
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.366
NEC for r=0.3 class 0 = 0.495 +- 0.305 (in-sample avg dev_std = 0.340)
NEC for r=0.3 class 1 = 0.245 +- 0.305 (in-sample avg dev_std = 0.340)
NEC for r=0.3 class 2 = 0.438 +- 0.305 (in-sample avg dev_std = 0.340)
NEC for r=0.3 all KL = 0.377 +- 0.305 (in-sample avg dev_std = 0.340)
NEC for r=0.3 all L1 = 0.392 +- 0.252 (in-sample avg dev_std = 0.340)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.303
Model XAI F1 of binarized graphs for r=0.6 =  0.40777375000000005
Model XAI WIoU of binarized graphs for r=0.6 =  0.29850625000000003
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.363
NEC for r=0.6 class 0 = 0.535 +- 0.226 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 1 = 0.534 +- 0.226 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 2 = 0.511 +- 0.226 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all KL = 0.458 +- 0.226 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all L1 = 0.527 +- 0.138 (in-sample avg dev_std = 0.420)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.599
Model XAI F1 of binarized graphs for r=0.9 =  0.42644875
Model XAI WIoU of binarized graphs for r=0.9 =  0.28864375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.445
NEC for r=0.9 class 0 = 0.496 +- 0.218 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 1 = 0.466 +- 0.218 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 2 = 0.484 +- 0.218 (in-sample avg dev_std = 0.327)
NEC for r=0.9 all KL = 0.34 +- 0.218 (in-sample avg dev_std = 0.327)
NEC for r=0.9 all L1 = 0.482 +- 0.145 (in-sample avg dev_std = 0.327)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.711
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.30493125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.522
NEC for r=1.0 class 0 = 0.493 +- 0.208 (in-sample avg dev_std = 0.326)
NEC for r=1.0 class 1 = 0.407 +- 0.208 (in-sample avg dev_std = 0.326)
NEC for r=1.0 class 2 = 0.455 +- 0.208 (in-sample avg dev_std = 0.326)
NEC for r=1.0 all KL = 0.304 +- 0.208 (in-sample avg dev_std = 0.326)
NEC for r=1.0 all L1 = 0.451 +- 0.140 (in-sample avg dev_std = 0.326)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.464
Model XAI F1 of binarized graphs for r=0.3 =  0.46641625
Model XAI WIoU of binarized graphs for r=0.3 =  0.36249624999999996
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.355
NEC for r=0.3 class 0 = 0.493 +- 0.298 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 1 = 0.226 +- 0.298 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 2 = 0.43 +- 0.298 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all KL = 0.362 +- 0.298 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all L1 = 0.385 +- 0.249 (in-sample avg dev_std = 0.349)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.281
Model XAI F1 of binarized graphs for r=0.6 =  0.41290750000000004
Model XAI WIoU of binarized graphs for r=0.6 =  0.29975375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.367
NEC for r=0.6 class 0 = 0.527 +- 0.234 (in-sample avg dev_std = 0.424)
NEC for r=0.6 class 1 = 0.547 +- 0.234 (in-sample avg dev_std = 0.424)
NEC for r=0.6 class 2 = 0.496 +- 0.234 (in-sample avg dev_std = 0.424)
NEC for r=0.6 all KL = 0.458 +- 0.234 (in-sample avg dev_std = 0.424)
NEC for r=0.6 all L1 = 0.523 +- 0.141 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.565
Model XAI F1 of binarized graphs for r=0.9 =  0.42183875
Model XAI WIoU of binarized graphs for r=0.9 =  0.28419249999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.435
NEC for r=0.9 class 0 = 0.485 +- 0.218 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 1 = 0.474 +- 0.218 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 2 = 0.474 +- 0.218 (in-sample avg dev_std = 0.311)
NEC for r=0.9 all KL = 0.332 +- 0.218 (in-sample avg dev_std = 0.311)
NEC for r=0.9 all L1 = 0.478 +- 0.146 (in-sample avg dev_std = 0.311)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.665
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.29862
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.515
NEC for r=1.0 class 0 = 0.487 +- 0.199 (in-sample avg dev_std = 0.322)
NEC for r=1.0 class 1 = 0.423 +- 0.199 (in-sample avg dev_std = 0.322)
NEC for r=1.0 class 2 = 0.449 +- 0.199 (in-sample avg dev_std = 0.322)
NEC for r=1.0 all KL = 0.304 +- 0.199 (in-sample avg dev_std = 0.322)
NEC for r=1.0 all L1 = 0.453 +- 0.136 (in-sample avg dev_std = 0.322)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.428
Model XAI F1 of binarized graphs for r=0.3 =  0.50033125
Model XAI WIoU of binarized graphs for r=0.3 =  0.397045
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.364
NEC for r=0.3 class 0 = 0.494 +- 0.236 (in-sample avg dev_std = 0.329)
NEC for r=0.3 class 1 = 0.23 +- 0.236 (in-sample avg dev_std = 0.329)
NEC for r=0.3 class 2 = 0.282 +- 0.236 (in-sample avg dev_std = 0.329)
NEC for r=0.3 all KL = 0.356 +- 0.236 (in-sample avg dev_std = 0.329)
NEC for r=0.3 all L1 = 0.332 +- 0.185 (in-sample avg dev_std = 0.329)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.576
Model XAI F1 of binarized graphs for r=0.6 =  0.3989575
Model XAI WIoU of binarized graphs for r=0.6 =  0.28687999999999997
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.419
NEC for r=0.6 class 0 = 0.527 +- 0.235 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 1 = 0.476 +- 0.235 (in-sample avg dev_std = 0.428)
NEC for r=0.6 class 2 = 0.469 +- 0.235 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all KL = 0.39 +- 0.235 (in-sample avg dev_std = 0.428)
NEC for r=0.6 all L1 = 0.49 +- 0.144 (in-sample avg dev_std = 0.428)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  0.36990249999999997
Model XAI WIoU of binarized graphs for r=0.9 =  0.23604750000000002
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.495
NEC for r=0.9 class 0 = 0.355 +- 0.138 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 1 = 0.303 +- 0.138 (in-sample avg dev_std = 0.263)
NEC for r=0.9 class 2 = 0.41 +- 0.138 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all KL = 0.178 +- 0.138 (in-sample avg dev_std = 0.263)
NEC for r=0.9 all L1 = 0.355 +- 0.135 (in-sample avg dev_std = 0.263)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.587
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.24856749999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.513
NEC for r=1.0 class 0 = 0.398 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=1.0 class 1 = 0.306 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=1.0 class 2 = 0.384 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=1.0 all KL = 0.211 +- 0.207 (in-sample avg dev_std = 0.262)
NEC for r=1.0 all L1 = 0.362 +- 0.146 (in-sample avg dev_std = 0.262)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:37:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:37:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.6150
Train Loss: 1.0118
ID Validation ACCURACY: 0.6187
ID Validation Loss: 1.0257
ID Test ACCURACY: 0.6043
ID Test Loss: 1.0345
OOD Validation ACCURACY: 0.4457
OOD Validation Loss: 1.1671
OOD Test ACCURACY: 0.4197
OOD Test Loss: 1.1596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5282
Train Loss: 1.1771
ID Validation ACCURACY: 0.5107
ID Validation Loss: 1.1922
ID Test ACCURACY: 0.5100
ID Test Loss: 1.2002
OOD Validation ACCURACY: 0.4607
OOD Validation Loss: 1.0813
OOD Test ACCURACY: 0.3930
OOD Test Loss: 1.1981

[0m[1;37mINFO[0m: [1mChartInfo 0.6043 0.4197 0.5100 0.3930 0.5107 0.4607[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.369
WIoU for r=0.3 = 0.281
F1 for r=0.6 = 0.320
WIoU for r=0.6 = 0.218
F1 for r=0.9 = 0.400
WIoU for r=0.9 = 0.265
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.304
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.377
WIoU for r=0.3 = 0.287
F1 for r=0.6 = 0.323
WIoU for r=0.6 = 0.219
F1 for r=0.9 = 0.395
WIoU for r=0.9 = 0.261
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.298
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.217
WIoU for r=0.3 = 0.155
F1 for r=0.6 = 0.182
WIoU for r=0.6 = 0.116
F1 for r=0.9 = 0.316
WIoU for r=0.9 = 0.197
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.245


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.431
Model XAI F1 of binarized graphs for r=0.3 =  0.36925749999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.28146875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.392
SUFF++ for r=0.3 class 0 = 0.618 +- 0.239 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 class 1 = 0.687 +- 0.239 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 class 2 = 0.533 +- 0.239 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 all KL = 0.591 +- 0.239 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.3 all L1 = 0.613 +- 0.190 (in-sample avg dev_std = 0.432)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.344
Model XAI F1 of binarized graphs for r=0.6 =  0.32043875
Model XAI WIoU of binarized graphs for r=0.6 =  0.21789250000000002
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.388
SUFF++ for r=0.6 class 0 = 0.523 +- 0.199 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1 = 0.527 +- 0.199 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 2 = 0.501 +- 0.199 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.617 +- 0.199 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.517 +- 0.134 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.509
Model XAI F1 of binarized graphs for r=0.9 =  0.40036125
Model XAI WIoU of binarized graphs for r=0.9 =  0.26494
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.531
SUFF++ for r=0.9 class 0 = 0.551 +- 0.171 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 1 = 0.619 +- 0.171 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 class 2 = 0.591 +- 0.171 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 all KL = 0.735 +- 0.171 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.9 all L1 = 0.587 +- 0.141 (in-sample avg dev_std = 0.346)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.377235
Model XAI WIoU of binarized graphs for r=0.3 =  0.28652
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.385
SUFF++ for r=0.3 class 0 = 0.615 +- 0.243 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 1 = 0.694 +- 0.243 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 class 2 = 0.549 +- 0.243 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all KL = 0.595 +- 0.243 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.3 all L1 = 0.618 +- 0.190 (in-sample avg dev_std = 0.437)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.344
Model XAI F1 of binarized graphs for r=0.6 =  0.3232875
Model XAI WIoU of binarized graphs for r=0.6 =  0.21908625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.391
SUFF++ for r=0.6 class 0 = 0.534 +- 0.203 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1 = 0.517 +- 0.203 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 2 = 0.519 +- 0.203 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.621 +- 0.203 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.523 +- 0.138 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.5
Model XAI F1 of binarized graphs for r=0.9 =  0.3945975
Model XAI WIoU of binarized graphs for r=0.9 =  0.26050625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.5
SUFF++ for r=0.9 class 0 = 0.546 +- 0.167 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 1 = 0.59 +- 0.167 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 2 = 0.601 +- 0.167 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all KL = 0.726 +- 0.167 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all L1 = 0.58 +- 0.138 (in-sample avg dev_std = 0.354)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.412
Model XAI F1 of binarized graphs for r=0.3 =  0.217375
Model XAI WIoU of binarized graphs for r=0.3 =  0.15480750000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.407
SUFF++ for r=0.3 class 0 = 0.618 +- 0.219 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 1 = 0.709 +- 0.219 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 class 2 = 0.583 +- 0.219 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all KL = 0.587 +- 0.219 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.3 all L1 = 0.638 +- 0.135 (in-sample avg dev_std = 0.453)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  0.18163125000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.115625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.377
SUFF++ for r=0.6 class 0 = 0.472 +- 0.287 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.576 +- 0.287 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.475 +- 0.287 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.588 +- 0.287 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.509 +- 0.148 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.374
Model XAI F1 of binarized graphs for r=0.9 =  0.3164575
Model XAI WIoU of binarized graphs for r=0.9 =  0.1968775
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.351
SUFF++ for r=0.9 class 0 = 0.63 +- 0.163 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 class 1 = 0.752 +- 0.163 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 class 2 = 0.643 +- 0.163 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 all KL = 0.822 +- 0.163 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.9 all L1 = 0.676 +- 0.138 (in-sample avg dev_std = 0.328)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.431
Model XAI F1 of binarized graphs for r=0.3 =  0.36925749999999996
Model XAI WIoU of binarized graphs for r=0.3 =  0.28146875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
NEC for r=0.3 class 0 = 0.419 +- 0.320 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 1 = 0.282 +- 0.320 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 2 = 0.482 +- 0.320 (in-sample avg dev_std = 0.359)
NEC for r=0.3 all KL = 0.396 +- 0.320 (in-sample avg dev_std = 0.359)
NEC for r=0.3 all L1 = 0.394 +- 0.256 (in-sample avg dev_std = 0.359)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.344
Model XAI F1 of binarized graphs for r=0.6 =  0.32043875
Model XAI WIoU of binarized graphs for r=0.6 =  0.21789250000000002
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.521 +- 0.215 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 1 = 0.503 +- 0.215 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 2 = 0.508 +- 0.215 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all KL = 0.433 +- 0.215 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all L1 = 0.511 +- 0.149 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.509
Model XAI F1 of binarized graphs for r=0.9 =  0.40036125
Model XAI WIoU of binarized graphs for r=0.9 =  0.26494
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.442
NEC for r=0.9 class 0 = 0.491 +- 0.218 (in-sample avg dev_std = 0.344)
NEC for r=0.9 class 1 = 0.461 +- 0.218 (in-sample avg dev_std = 0.344)
NEC for r=0.9 class 2 = 0.519 +- 0.218 (in-sample avg dev_std = 0.344)
NEC for r=0.9 all KL = 0.353 +- 0.218 (in-sample avg dev_std = 0.344)
NEC for r=0.9 all L1 = 0.49 +- 0.149 (in-sample avg dev_std = 0.344)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.636
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.30373
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.486
NEC for r=1.0 class 0 = 0.467 +- 0.202 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 1 = 0.429 +- 0.202 (in-sample avg dev_std = 0.351)
NEC for r=1.0 class 2 = 0.51 +- 0.202 (in-sample avg dev_std = 0.351)
NEC for r=1.0 all KL = 0.319 +- 0.202 (in-sample avg dev_std = 0.351)
NEC for r=1.0 all L1 = 0.468 +- 0.137 (in-sample avg dev_std = 0.351)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.456
Model XAI F1 of binarized graphs for r=0.3 =  0.377235
Model XAI WIoU of binarized graphs for r=0.3 =  0.28652
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.381
NEC for r=0.3 class 0 = 0.424 +- 0.312 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 1 = 0.264 +- 0.312 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 2 = 0.476 +- 0.312 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all KL = 0.391 +- 0.312 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all L1 = 0.39 +- 0.249 (in-sample avg dev_std = 0.365)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.344
Model XAI F1 of binarized graphs for r=0.6 =  0.3232875
Model XAI WIoU of binarized graphs for r=0.6 =  0.21908625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.358
NEC for r=0.6 class 0 = 0.505 +- 0.228 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 1 = 0.516 +- 0.228 (in-sample avg dev_std = 0.449)
NEC for r=0.6 class 2 = 0.518 +- 0.228 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all KL = 0.445 +- 0.228 (in-sample avg dev_std = 0.449)
NEC for r=0.6 all L1 = 0.513 +- 0.159 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.5
Model XAI F1 of binarized graphs for r=0.9 =  0.3945975
Model XAI WIoU of binarized graphs for r=0.9 =  0.26050625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.434
NEC for r=0.9 class 0 = 0.489 +- 0.216 (in-sample avg dev_std = 0.342)
NEC for r=0.9 class 1 = 0.474 +- 0.216 (in-sample avg dev_std = 0.342)
NEC for r=0.9 class 2 = 0.499 +- 0.216 (in-sample avg dev_std = 0.342)
NEC for r=0.9 all KL = 0.347 +- 0.216 (in-sample avg dev_std = 0.342)
NEC for r=0.9 all L1 = 0.488 +- 0.144 (in-sample avg dev_std = 0.342)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.624
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.29753875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.485
NEC for r=1.0 class 0 = 0.469 +- 0.192 (in-sample avg dev_std = 0.360)
NEC for r=1.0 class 1 = 0.423 +- 0.192 (in-sample avg dev_std = 0.360)
NEC for r=1.0 class 2 = 0.5 +- 0.192 (in-sample avg dev_std = 0.360)
NEC for r=1.0 all KL = 0.314 +- 0.192 (in-sample avg dev_std = 0.360)
NEC for r=1.0 all L1 = 0.465 +- 0.130 (in-sample avg dev_std = 0.360)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.412
Model XAI F1 of binarized graphs for r=0.3 =  0.217375
Model XAI WIoU of binarized graphs for r=0.3 =  0.15480750000000001
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.41
NEC for r=0.3 class 0 = 0.404 +- 0.257 (in-sample avg dev_std = 0.383)
NEC for r=0.3 class 1 = 0.294 +- 0.257 (in-sample avg dev_std = 0.383)
NEC for r=0.3 class 2 = 0.334 +- 0.257 (in-sample avg dev_std = 0.383)
NEC for r=0.3 all KL = 0.37 +- 0.257 (in-sample avg dev_std = 0.383)
NEC for r=0.3 all L1 = 0.343 +- 0.185 (in-sample avg dev_std = 0.383)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  0.18163125000000002
Model XAI WIoU of binarized graphs for r=0.6 =  0.115625
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.312
NEC for r=0.6 class 0 = 0.49 +- 0.296 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.397 +- 0.296 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.469 +- 0.296 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.367 +- 0.296 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.451 +- 0.158 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.374
Model XAI F1 of binarized graphs for r=0.9 =  0.3164575
Model XAI WIoU of binarized graphs for r=0.9 =  0.1968775
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.351
NEC for r=0.9 class 0 = 0.367 +- 0.188 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 1 = 0.332 +- 0.188 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 2 = 0.442 +- 0.188 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all KL = 0.223 +- 0.188 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all L1 = 0.38 +- 0.152 (in-sample avg dev_std = 0.299)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.417
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.24493499999999999
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.339
NEC for r=1.0 class 0 = 0.364 +- 0.152 (in-sample avg dev_std = 0.252)
NEC for r=1.0 class 1 = 0.318 +- 0.152 (in-sample avg dev_std = 0.252)
NEC for r=1.0 class 2 = 0.408 +- 0.152 (in-sample avg dev_std = 0.252)
NEC for r=1.0 all KL = 0.193 +- 0.152 (in-sample avg dev_std = 0.252)
NEC for r=1.0 all L1 = 0.363 +- 0.156 (in-sample avg dev_std = 0.252)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:41:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 08:41:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.5438
Train Loss: 1.0004
ID Validation ACCURACY: 0.5313
ID Validation Loss: 1.0050
ID Test ACCURACY: 0.5313
ID Test Loss: 1.0141
OOD Validation ACCURACY: 0.4240
OOD Validation Loss: 1.1226
OOD Test ACCURACY: 0.6110
OOD Test Loss: 0.9849

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.4751
Train Loss: 1.4782
ID Validation ACCURACY: 0.4653
ID Validation Loss: 1.4918
ID Test ACCURACY: 0.4697
ID Test Loss: 1.5145
OOD Validation ACCURACY: 0.4803
OOD Validation Loss: 0.9759
OOD Test ACCURACY: 0.4317
OOD Test Loss: 1.2856

[0m[1;37mINFO[0m: [1mChartInfo 0.5313 0.6110 0.4697 0.4317 0.4653 0.4803[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3098) +- tensor(0.1593)
F1 for r=0.3 = 0.407
WIoU for r=0.3 = 0.322
F1 for r=0.6 = 0.375
WIoU for r=0.6 = 0.266
F1 for r=0.9 = 0.419
WIoU for r=0.9 = 0.278
F1 for r=1.0 = 0.452
WIoU for r=1.0 = 0.301
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.410
WIoU for r=0.3 = 0.324
F1 for r=0.6 = 0.375
WIoU for r=0.6 = 0.264
F1 for r=0.9 = 0.415
WIoU for r=0.9 = 0.275
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.295
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))

Gold ratio (test) =  tensor(0.2515) +- tensor(0.1001)
F1 for r=0.3 = 0.459
WIoU for r=0.3 = 0.355
F1 for r=0.6 = 0.387
WIoU for r=0.6 = 0.276
F1 for r=0.9 = 0.377
WIoU for r=0.9 = 0.240
F1 for r=1.0 = 0.392
WIoU for r=1.0 = 0.246


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.399
Model XAI F1 of binarized graphs for r=0.3 =  0.40671125
Model XAI WIoU of binarized graphs for r=0.3 =  0.32220624999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.377
SUFF++ for r=0.3 class 0 = 0.584 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 1 = 0.705 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 class 2 = 0.583 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all KL = 0.482 +- 0.297 (in-sample avg dev_std = 0.511)
SUFF++ for r=0.3 all L1 = 0.624 +- 0.196 (in-sample avg dev_std = 0.511)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.351
Model XAI F1 of binarized graphs for r=0.6 =  0.37472125
Model XAI WIoU of binarized graphs for r=0.6 =  0.2664275
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.394
SUFF++ for r=0.6 class 0 = 0.526 +- 0.267 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 1 = 0.486 +- 0.267 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 2 = 0.551 +- 0.267 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all KL = 0.538 +- 0.267 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all L1 = 0.521 +- 0.150 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.509
Model XAI F1 of binarized graphs for r=0.9 =  0.4187837499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.27781875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.51
SUFF++ for r=0.9 class 0 = 0.574 +- 0.215 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 1 = 0.706 +- 0.215 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 class 2 = 0.579 +- 0.215 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 all KL = 0.744 +- 0.215 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.9 all L1 = 0.62 +- 0.186 (in-sample avg dev_std = 0.349)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.385
Model XAI F1 of binarized graphs for r=0.3 =  0.41014625000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.32370625000000003
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.368
SUFF++ for r=0.3 class 0 = 0.555 +- 0.302 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 class 1 = 0.665 +- 0.302 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 class 2 = 0.589 +- 0.302 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 all KL = 0.466 +- 0.302 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.204 (in-sample avg dev_std = 0.524)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.304
Model XAI F1 of binarized graphs for r=0.6 =  0.37526499999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.2638675
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.381
SUFF++ for r=0.6 class 0 = 0.546 +- 0.265 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 1 = 0.465 +- 0.265 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 2 = 0.577 +- 0.265 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all KL = 0.56 +- 0.265 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all L1 = 0.531 +- 0.152 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.49
Model XAI F1 of binarized graphs for r=0.9 =  0.41474625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.27495875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.516
SUFF++ for r=0.9 class 0 = 0.581 +- 0.212 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.9 class 1 = 0.692 +- 0.212 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.9 class 2 = 0.594 +- 0.212 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.9 all KL = 0.742 +- 0.212 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.9 all L1 = 0.622 +- 0.183 (in-sample avg dev_std = 0.361)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.338
Model XAI F1 of binarized graphs for r=0.3 =  0.45885875000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.35530874999999995
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.324
SUFF++ for r=0.3 class 0 = 0.541 +- 0.242 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 1 = 0.588 +- 0.242 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 2 = 0.601 +- 0.242 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 all KL = 0.553 +- 0.242 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 all L1 = 0.577 +- 0.152 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.527
Model XAI F1 of binarized graphs for r=0.6 =  0.38672375
Model XAI WIoU of binarized graphs for r=0.6 =  0.275555
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.401
SUFF++ for r=0.6 class 0 = 0.558 +- 0.215 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 1 = 0.575 +- 0.215 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 class 2 = 0.544 +- 0.215 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all KL = 0.687 +- 0.215 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.6 all L1 = 0.559 +- 0.151 (in-sample avg dev_std = 0.391)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.642
Model XAI F1 of binarized graphs for r=0.9 =  0.37655125
Model XAI WIoU of binarized graphs for r=0.9 =  0.23952125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.585
SUFF++ for r=0.9 class 0 = 0.696 +- 0.074 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1 = 0.724 +- 0.074 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 2 = 0.745 +- 0.074 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.899 +- 0.074 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.722 +- 0.114 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.399
Model XAI F1 of binarized graphs for r=0.3 =  0.40671125
Model XAI WIoU of binarized graphs for r=0.3 =  0.32220624999999997
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.371
NEC for r=0.3 class 0 = 0.42 +- 0.355 (in-sample avg dev_std = 0.439)
NEC for r=0.3 class 1 = 0.274 +- 0.355 (in-sample avg dev_std = 0.439)
NEC for r=0.3 class 2 = 0.33 +- 0.355 (in-sample avg dev_std = 0.439)
NEC for r=0.3 all KL = 0.411 +- 0.355 (in-sample avg dev_std = 0.439)
NEC for r=0.3 all L1 = 0.341 +- 0.260 (in-sample avg dev_std = 0.439)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.352
Model XAI F1 of binarized graphs for r=0.6 =  0.37472125
Model XAI WIoU of binarized graphs for r=0.6 =  0.2664275
len(reference) = 800
Effective ratio: 0.612 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.354
NEC for r=0.6 class 0 = 0.504 +- 0.273 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 1 = 0.526 +- 0.273 (in-sample avg dev_std = 0.483)
NEC for r=0.6 class 2 = 0.479 +- 0.273 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all KL = 0.494 +- 0.273 (in-sample avg dev_std = 0.483)
NEC for r=0.6 all L1 = 0.503 +- 0.163 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.507
Model XAI F1 of binarized graphs for r=0.9 =  0.4187837499999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.27781875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.435 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.9 class 1 = 0.319 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.9 class 2 = 0.416 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.9 all KL = 0.249 +- 0.194 (in-sample avg dev_std = 0.316)
NEC for r=0.9 all L1 = 0.39 +- 0.161 (in-sample avg dev_std = 0.316)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.55
Model XAI F1 of binarized graphs for r=1.0 =  0.45171999999999995
Model XAI WIoU of binarized graphs for r=1.0 =  0.30061875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.465
NEC for r=1.0 class 0 = 0.422 +- 0.162 (in-sample avg dev_std = 0.322)
NEC for r=1.0 class 1 = 0.322 +- 0.162 (in-sample avg dev_std = 0.322)
NEC for r=1.0 class 2 = 0.408 +- 0.162 (in-sample avg dev_std = 0.322)
NEC for r=1.0 all KL = 0.236 +- 0.162 (in-sample avg dev_std = 0.322)
NEC for r=1.0 all L1 = 0.384 +- 0.159 (in-sample avg dev_std = 0.322)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.385
Model XAI F1 of binarized graphs for r=0.3 =  0.41014625000000005
Model XAI WIoU of binarized graphs for r=0.3 =  0.32370625000000003
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.363
NEC for r=0.3 class 0 = 0.427 +- 0.354 (in-sample avg dev_std = 0.427)
NEC for r=0.3 class 1 = 0.29 +- 0.354 (in-sample avg dev_std = 0.427)
NEC for r=0.3 class 2 = 0.326 +- 0.354 (in-sample avg dev_std = 0.427)
NEC for r=0.3 all KL = 0.403 +- 0.354 (in-sample avg dev_std = 0.427)
NEC for r=0.3 all L1 = 0.347 +- 0.268 (in-sample avg dev_std = 0.427)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.304
Model XAI F1 of binarized graphs for r=0.6 =  0.37526499999999996
Model XAI WIoU of binarized graphs for r=0.6 =  0.2638675
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.347
NEC for r=0.6 class 0 = 0.49 +- 0.265 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 1 = 0.537 +- 0.265 (in-sample avg dev_std = 0.487)
NEC for r=0.6 class 2 = 0.484 +- 0.265 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all KL = 0.483 +- 0.265 (in-sample avg dev_std = 0.487)
NEC for r=0.6 all L1 = 0.503 +- 0.156 (in-sample avg dev_std = 0.487)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.49
Model XAI F1 of binarized graphs for r=0.9 =  0.41474625000000004
Model XAI WIoU of binarized graphs for r=0.9 =  0.27495875
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.41
NEC for r=0.9 class 0 = 0.426 +- 0.193 (in-sample avg dev_std = 0.322)
NEC for r=0.9 class 1 = 0.317 +- 0.193 (in-sample avg dev_std = 0.322)
NEC for r=0.9 class 2 = 0.395 +- 0.193 (in-sample avg dev_std = 0.322)
NEC for r=0.9 all KL = 0.243 +- 0.193 (in-sample avg dev_std = 0.322)
NEC for r=0.9 all L1 = 0.38 +- 0.160 (in-sample avg dev_std = 0.322)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.543
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.2948675
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.454
NEC for r=1.0 class 0 = 0.41 +- 0.157 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 1 = 0.321 +- 0.157 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 2 = 0.395 +- 0.157 (in-sample avg dev_std = 0.321)
NEC for r=1.0 all KL = 0.228 +- 0.157 (in-sample avg dev_std = 0.321)
NEC for r=1.0 all L1 = 0.376 +- 0.153 (in-sample avg dev_std = 0.321)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.338
Model XAI F1 of binarized graphs for r=0.3 =  0.45885875000000004
Model XAI WIoU of binarized graphs for r=0.3 =  0.35530874999999995
len(reference) = 800
Effective ratio: 0.306 +- 0.006
Model Accuracy over intervened graphs for r=0.3 =  0.301
NEC for r=0.3 class 0 = 0.427 +- 0.262 (in-sample avg dev_std = 0.451)
NEC for r=0.3 class 1 = 0.469 +- 0.262 (in-sample avg dev_std = 0.451)
NEC for r=0.3 class 2 = 0.42 +- 0.262 (in-sample avg dev_std = 0.451)
NEC for r=0.3 all KL = 0.443 +- 0.262 (in-sample avg dev_std = 0.451)
NEC for r=0.3 all L1 = 0.439 +- 0.166 (in-sample avg dev_std = 0.451)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.527
Model XAI F1 of binarized graphs for r=0.6 =  0.38672375
Model XAI WIoU of binarized graphs for r=0.6 =  0.275555
len(reference) = 800
Effective ratio: 0.608 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.373
NEC for r=0.6 class 0 = 0.518 +- 0.248 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 1 = 0.423 +- 0.248 (in-sample avg dev_std = 0.361)
NEC for r=0.6 class 2 = 0.461 +- 0.248 (in-sample avg dev_std = 0.361)
NEC for r=0.6 all KL = 0.345 +- 0.248 (in-sample avg dev_std = 0.361)
NEC for r=0.6 all L1 = 0.466 +- 0.170 (in-sample avg dev_std = 0.361)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.642
Model XAI F1 of binarized graphs for r=0.9 =  0.37655125
Model XAI WIoU of binarized graphs for r=0.9 =  0.23952125
len(reference) = 800
Effective ratio: 0.904 +- 0.005
Model Accuracy over intervened graphs for r=0.9 =  0.462
NEC for r=0.9 class 0 = 0.35 +- 0.144 (in-sample avg dev_std = 0.283)
NEC for r=0.9 class 1 = 0.304 +- 0.144 (in-sample avg dev_std = 0.283)
NEC for r=0.9 class 2 = 0.387 +- 0.144 (in-sample avg dev_std = 0.283)
NEC for r=0.9 all KL = 0.179 +- 0.144 (in-sample avg dev_std = 0.283)
NEC for r=0.9 all L1 = 0.347 +- 0.140 (in-sample avg dev_std = 0.283)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.637
Model XAI F1 of binarized graphs for r=1.0 =  0.39177750000000006
Model XAI WIoU of binarized graphs for r=1.0 =  0.24640875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.356 +- 0.162 (in-sample avg dev_std = 0.278)
NEC for r=1.0 class 1 = 0.33 +- 0.162 (in-sample avg dev_std = 0.278)
NEC for r=1.0 class 2 = 0.372 +- 0.162 (in-sample avg dev_std = 0.278)
NEC for r=1.0 all KL = 0.192 +- 0.162 (in-sample avg dev_std = 0.278)
NEC for r=1.0 all L1 = 0.353 +- 0.158 (in-sample avg dev_std = 0.278)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.473, 0.425, 0.697, 1.0], 'all_L1': [0.642, 0.519, 0.611, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.573, 0.617, 0.724, 1.0], 'all_L1': [0.612, 0.52, 0.591, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.549, 0.774, 1.0], 'all_L1': [0.595, 0.477, 0.62, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.591, 0.617, 0.735, 1.0], 'all_L1': [0.613, 0.517, 0.587, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.482, 0.538, 0.744, 1.0], 'all_L1': [0.624, 0.521, 0.62, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.42, 0.58, 0.401, 0.368], 'all_L1': [0.315, 0.49, 0.473, 0.447]}), defaultdict(<class 'list'>, {'all_KL': [0.378, 0.394, 0.356, 0.315], 'all_L1': [0.369, 0.481, 0.48, 0.462]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.458, 0.34, 0.304], 'all_L1': [0.392, 0.527, 0.482, 0.451]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.433, 0.353, 0.319], 'all_L1': [0.394, 0.511, 0.49, 0.468]}), defaultdict(<class 'list'>, {'all_KL': [0.411, 0.494, 0.249, 0.236], 'all_L1': [0.341, 0.503, 0.39, 0.384]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.471, 0.422, 0.672, 1.0], 'all_L1': [0.627, 0.535, 0.591, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.581, 0.616, 0.705, 1.0], 'all_L1': [0.614, 0.52, 0.579, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.582, 0.544, 0.773, 1.0], 'all_L1': [0.591, 0.476, 0.621, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.595, 0.621, 0.726, 1.0], 'all_L1': [0.618, 0.523, 0.58, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.466, 0.56, 0.742, 1.0], 'all_L1': [0.603, 0.531, 0.622, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.429, 0.588, 0.406, 0.366], 'all_L1': [0.334, 0.482, 0.475, 0.446]}), defaultdict(<class 'list'>, {'all_KL': [0.368, 0.397, 0.364, 0.322], 'all_L1': [0.368, 0.482, 0.48, 0.464]}), defaultdict(<class 'list'>, {'all_KL': [0.362, 0.458, 0.332, 0.304], 'all_L1': [0.385, 0.523, 0.478, 0.453]}), defaultdict(<class 'list'>, {'all_KL': [0.391, 0.445, 0.347, 0.314], 'all_L1': [0.39, 0.513, 0.488, 0.465]}), defaultdict(<class 'list'>, {'all_KL': [0.403, 0.483, 0.243, 0.228], 'all_L1': [0.347, 0.503, 0.38, 0.376]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.476, 0.569, 0.76, 1.0], 'all_L1': [0.603, 0.485, 0.593, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.715, 0.874, 1.0], 'all_L1': [0.551, 0.557, 0.703, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.633, 0.698, 0.884, 1.0], 'all_L1': [0.669, 0.561, 0.704, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.587, 0.588, 0.822, 1.0], 'all_L1': [0.638, 0.509, 0.676, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.553, 0.687, 0.899, 1.0], 'all_L1': [0.577, 0.559, 0.722, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.553, 0.397, 0.316, 0.256], 'all_L1': [0.45, 0.493, 0.441, 0.399]}), defaultdict(<class 'list'>, {'all_KL': [0.34, 0.263, 0.163, 0.164], 'all_L1': [0.403, 0.417, 0.336, 0.326]}), defaultdict(<class 'list'>, {'all_KL': [0.356, 0.39, 0.178, 0.211], 'all_L1': [0.332, 0.49, 0.355, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.367, 0.223, 0.193], 'all_L1': [0.343, 0.451, 0.38, 0.363]}), defaultdict(<class 'list'>, {'all_KL': [0.443, 0.345, 0.179, 0.192], 'all_L1': [0.439, 0.466, 0.347, 0.353]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.617 +- 0.015, 0.511 +- 0.017, 0.606 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.540 +- 0.051, 0.549 +- 0.070, 0.735 +- 0.025, 1.000 +- 0.000
suff++_acc_int  =  0.384 +- 0.009, 0.398 +- 0.044, 0.524 +- 0.064
nec class all_L1  =  0.362 +- 0.030, 0.502 +- 0.016, 0.463 +- 0.037, 0.442 +- 0.030
nec class all_KL  =  0.396 +- 0.017, 0.472 +- 0.063, 0.340 +- 0.050, 0.308 +- 0.042
nec_acc_int  =  0.374 +- 0.009, 0.347 +- 0.020, 0.428 +- 0.017, 0.479 +- 0.023

Eval split id_test
suff++ class all_L1  =  0.611 +- 0.012, 0.517 +- 0.021, 0.599 +- 0.019, 1.000 +- 0.000
suff++ class all_KL  =  0.539 +- 0.058, 0.553 +- 0.072, 0.724 +- 0.034, 1.000 +- 0.000
suff++_acc_int  =  0.379 +- 0.008, 0.391 +- 0.046, 0.509 +- 0.063
nec class all_L1  =  0.365 +- 0.022, 0.501 +- 0.016, 0.460 +- 0.040, 0.441 +- 0.033
nec class all_KL  =  0.391 +- 0.024, 0.474 +- 0.063, 0.338 +- 0.054, 0.307 +- 0.045
nec_acc_int  =  0.368 +- 0.011, 0.342 +- 0.028, 0.421 +- 0.022, 0.470 +- 0.026

Eval split test
suff++ class all_L1  =  0.608 +- 0.042, 0.534 +- 0.031, 0.680 +- 0.046, 1.000 +- 0.000
suff++ class all_KL  =  0.569 +- 0.053, 0.651 +- 0.060, 0.848 +- 0.051, 1.000 +- 0.000
suff++_acc_int  =  0.358 +- 0.046, 0.375 +- 0.082, 0.506 +- 0.083
nec class all_L1  =  0.393 +- 0.048, 0.463 +- 0.028, 0.372 +- 0.038, 0.361 +- 0.023
nec class all_KL  =  0.412 +- 0.079, 0.352 +- 0.048, 0.212 +- 0.056, 0.203 +- 0.030
nec_acc_int  =  0.349 +- 0.074, 0.330 +- 0.068, 0.406 +- 0.061, 0.449 +- 0.083


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.490 +- 0.009, 0.507 +- 0.005, 0.534 +- 0.016, 0.721 +- 0.015
Faith. Armon (L1)= 		  =  0.455 +- 0.021, 0.506 +- 0.006, 0.524 +- 0.023, 0.613 +- 0.030
Faith. GMean (L1)= 	  =  0.472 +- 0.015, 0.506 +- 0.006, 0.529 +- 0.019, 0.665 +- 0.023
Faith. Aritm (KL)= 		  =  0.468 +- 0.019, 0.511 +- 0.009, 0.537 +- 0.021, 0.654 +- 0.021
Faith. Armon (KL)= 		  =  0.455 +- 0.011, 0.499 +- 0.012, 0.462 +- 0.046, 0.470 +- 0.050
Faith. GMean (KL)= 	  =  0.462 +- 0.015, 0.505 +- 0.010, 0.498 +- 0.035, 0.554 +- 0.039

Eval split id_test
Faith. Aritm (L1)= 		  =  0.488 +- 0.010, 0.509 +- 0.008, 0.529 +- 0.016, 0.720 +- 0.017
Faith. Armon (L1)= 		  =  0.456 +- 0.016, 0.508 +- 0.008, 0.519 +- 0.024, 0.611 +- 0.033
Faith. GMean (L1)= 	  =  0.472 +- 0.013, 0.508 +- 0.008, 0.524 +- 0.020, 0.663 +- 0.026
Faith. Aritm (KL)= 		  =  0.465 +- 0.020, 0.513 +- 0.012, 0.531 +- 0.020, 0.653 +- 0.022
Faith. Armon (KL)= 		  =  0.450 +- 0.013, 0.502 +- 0.014, 0.457 +- 0.048, 0.468 +- 0.054
Faith. GMean (KL)= 	  =  0.457 +- 0.016, 0.508 +- 0.013, 0.492 +- 0.035, 0.552 +- 0.042

Eval split test
Faith. Aritm (L1)= 		  =  0.501 +- 0.017, 0.499 +- 0.017, 0.526 +- 0.007, 0.680 +- 0.012
Faith. Armon (L1)= 		  =  0.474 +- 0.029, 0.495 +- 0.018, 0.478 +- 0.017, 0.530 +- 0.025
Faith. GMean (L1)= 	  =  0.487 +- 0.021, 0.497 +- 0.018, 0.501 +- 0.009, 0.600 +- 0.019
Faith. Aritm (KL)= 		  =  0.491 +- 0.016, 0.502 +- 0.025, 0.530 +- 0.008, 0.602 +- 0.015
Faith. Armon (KL)= 		  =  0.469 +- 0.028, 0.453 +- 0.038, 0.333 +- 0.062, 0.337 +- 0.041
Faith. GMean (KL)= 	  =  0.480 +- 0.022, 0.476 +- 0.029, 0.419 +- 0.039, 0.450 +- 0.033
Computed for split load_split = id



Completed in  0:16:28.475571  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:44:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 08:44:54 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 08:45:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 08:45:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 08:45:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:24 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:24 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:46:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ROC-AUC: 0.9606
Train Loss: 0.1904
ID Validation ROC-AUC: 0.9212
ID Validation Loss: 0.2962
ID Test ROC-AUC: 0.9210
ID Test Loss: 0.3012
OOD Validation ROC-AUC: 0.6635
OOD Validation Loss: 0.4561
OOD Test ROC-AUC: 0.7091
OOD Test Loss: 0.6939

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 40...
[0m[1;37mINFO[0m: [1mCheckpoint 40: 
-----------------------------------
Train ROC-AUC: 0.9251
Train Loss: 0.2264
ID Validation ROC-AUC: 0.9081
ID Validation Loss: 0.2504
ID Test ROC-AUC: 0.9110
ID Test Loss: 0.2528
OOD Validation ROC-AUC: 0.6936
OOD Validation Loss: 0.3228
OOD Test ROC-AUC: 0.7297
OOD Test Loss: 0.4971

[0m[1;37mINFO[0m: [1mChartInfo 0.9210 0.7091 0.9110 0.7297 0.9081 0.6936[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 08:46:28 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 08:46:33 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 08:46:37 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.621
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 789
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.593
SUFF++ for r=0.3 class 0.0 = 0.892 +- 0.040 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 class 1.0 = 0.896 +- 0.040 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 all KL = 0.981 +- 0.040 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 all L1 = 0.895 +- 0.065 (in-sample avg dev_std = 0.124)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0.0 = 0.901 +- 0.122 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 class 1.0 = 0.831 +- 0.122 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 all KL = 0.943 +- 0.122 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 all L1 = 0.839 +- 0.125 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0.0 = 0.946 +- 0.039 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 class 1.0 = 0.922 +- 0.039 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 all KL = 0.979 +- 0.039 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 all L1 = 0.925 +- 0.070 (in-sample avg dev_std = 0.138)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.567
SUFF++ for r=0.3 class 0.0 = 0.905 +- 0.061 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.3 class 1.0 = 0.895 +- 0.061 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.3 all KL = 0.979 +- 0.061 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.3 all L1 = 0.896 +- 0.067 (in-sample avg dev_std = 0.125)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.661
SUFF++ for r=0.6 class 0.0 = 0.902 +- 0.107 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 class 1.0 = 0.834 +- 0.107 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 all KL = 0.946 +- 0.107 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 all L1 = 0.842 +- 0.120 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0.0 = 0.942 +- 0.044 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 class 1.0 = 0.92 +- 0.044 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 all KL = 0.977 +- 0.044 (in-sample avg dev_std = 0.139)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.081 (in-sample avg dev_std = 0.139)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.54
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0.0 = 0.9 +- 0.040 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 class 1.0 = 0.895 +- 0.040 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 all KL = 0.981 +- 0.040 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.3 all L1 = 0.896 +- 0.062 (in-sample avg dev_std = 0.124)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.572
SUFF++ for r=0.6 class 0.0 = 0.897 +- 0.075 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.6 class 1.0 = 0.858 +- 0.075 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.6 all KL = 0.963 +- 0.075 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.6 all L1 = 0.865 +- 0.104 (in-sample avg dev_std = 0.133)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.646
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.64
SUFF++ for r=0.9 class 0.0 = 0.942 +- 0.051 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.9 class 1.0 = 0.921 +- 0.051 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.9 all KL = 0.978 +- 0.051 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.9 all L1 = 0.924 +- 0.081 (in-sample avg dev_std = 0.135)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.617
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 0.0 = 0.089 +- 0.027 (in-sample avg dev_std = 0.099)
NEC for r=0.3 class 1.0 = 0.094 +- 0.027 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all KL = 0.014 +- 0.027 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all L1 = 0.093 +- 0.065 (in-sample avg dev_std = 0.099)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.631
NEC for r=0.6 class 0.0 = 0.119 +- 0.072 (in-sample avg dev_std = 0.183)
NEC for r=0.6 class 1.0 = 0.155 +- 0.072 (in-sample avg dev_std = 0.183)
NEC for r=0.6 all KL = 0.046 +- 0.072 (in-sample avg dev_std = 0.183)
NEC for r=0.6 all L1 = 0.151 +- 0.106 (in-sample avg dev_std = 0.183)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.773
NEC for r=0.9 class 0.0 = 0.176 +- 0.151 (in-sample avg dev_std = 0.282)
NEC for r=0.9 class 1.0 = 0.229 +- 0.151 (in-sample avg dev_std = 0.282)
NEC for r=0.9 all KL = 0.126 +- 0.151 (in-sample avg dev_std = 0.282)
NEC for r=0.9 all L1 = 0.223 +- 0.143 (in-sample avg dev_std = 0.282)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.901
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.817
NEC for r=1.0 class 0.0 = 0.195 +- 0.177 (in-sample avg dev_std = 0.304)
NEC for r=1.0 class 1.0 = 0.226 +- 0.177 (in-sample avg dev_std = 0.304)
NEC for r=1.0 all KL = 0.152 +- 0.177 (in-sample avg dev_std = 0.304)
NEC for r=1.0 all L1 = 0.223 +- 0.159 (in-sample avg dev_std = 0.304)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.605
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0.0 = 0.081 +- 0.031 (in-sample avg dev_std = 0.099)
NEC for r=0.3 class 1.0 = 0.093 +- 0.031 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all KL = 0.015 +- 0.031 (in-sample avg dev_std = 0.099)
NEC for r=0.3 all L1 = 0.092 +- 0.065 (in-sample avg dev_std = 0.099)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.673
NEC for r=0.6 class 0.0 = 0.099 +- 0.071 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 1.0 = 0.155 +- 0.071 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all KL = 0.045 +- 0.071 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all L1 = 0.148 +- 0.101 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.794
NEC for r=0.9 class 0.0 = 0.155 +- 0.155 (in-sample avg dev_std = 0.292)
NEC for r=0.9 class 1.0 = 0.236 +- 0.155 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all KL = 0.13 +- 0.155 (in-sample avg dev_std = 0.292)
NEC for r=0.9 all L1 = 0.226 +- 0.147 (in-sample avg dev_std = 0.292)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.903
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.833
NEC for r=1.0 class 0.0 = 0.173 +- 0.170 (in-sample avg dev_std = 0.299)
NEC for r=1.0 class 1.0 = 0.23 +- 0.170 (in-sample avg dev_std = 0.299)
NEC for r=1.0 all KL = 0.143 +- 0.170 (in-sample avg dev_std = 0.299)
NEC for r=1.0 all L1 = 0.223 +- 0.155 (in-sample avg dev_std = 0.299)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.546
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.555
NEC for r=0.3 class 0.0 = 0.091 +- 0.031 (in-sample avg dev_std = 0.102)
NEC for r=0.3 class 1.0 = 0.098 +- 0.031 (in-sample avg dev_std = 0.102)
NEC for r=0.3 all KL = 0.017 +- 0.031 (in-sample avg dev_std = 0.102)
NEC for r=0.3 all L1 = 0.096 +- 0.076 (in-sample avg dev_std = 0.102)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.585
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.581
NEC for r=0.6 class 0.0 = 0.12 +- 0.070 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.145 +- 0.070 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.041 +- 0.070 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.141 +- 0.101 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.646
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.625
NEC for r=0.9 class 0.0 = 0.167 +- 0.137 (in-sample avg dev_std = 0.272)
NEC for r=0.9 class 1.0 = 0.221 +- 0.137 (in-sample avg dev_std = 0.272)
NEC for r=0.9 all KL = 0.109 +- 0.137 (in-sample avg dev_std = 0.272)
NEC for r=0.9 all L1 = 0.212 +- 0.143 (in-sample avg dev_std = 0.272)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.67
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.651
NEC for r=1.0 class 0.0 = 0.199 +- 0.162 (in-sample avg dev_std = 0.310)
NEC for r=1.0 class 1.0 = 0.238 +- 0.162 (in-sample avg dev_std = 0.310)
NEC for r=1.0 all KL = 0.14 +- 0.162 (in-sample avg dev_std = 0.310)
NEC for r=1.0 all L1 = 0.231 +- 0.152 (in-sample avg dev_std = 0.310)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:50:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 08:50:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 08:50:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:00 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:51:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.2505
ID Validation ROC-AUC: 0.9157
ID Validation Loss: 0.3918
ID Test ROC-AUC: 0.9192
ID Test Loss: 0.3917
OOD Validation ROC-AUC: 0.6648
OOD Validation Loss: 0.5222
OOD Test ROC-AUC: 0.7175
OOD Test Loss: 0.8314

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ROC-AUC: 0.9381
Train Loss: 0.2348
ID Validation ROC-AUC: 0.9119
ID Validation Loss: 0.2767
ID Test ROC-AUC: 0.9142
ID Test Loss: 0.2805
OOD Validation ROC-AUC: 0.6863
OOD Validation Loss: 0.3481
OOD Test ROC-AUC: 0.7199
OOD Test Loss: 0.5608

[0m[1;37mINFO[0m: [1mChartInfo 0.9192 0.7175 0.9142 0.7199 0.9119 0.6863[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 08:51:43 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 08:51:47 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 08:51:51 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.437
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.448
SUFF++ for r=0.3 class 0.0 = 0.837 +- 0.039 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 1.0 = 0.835 +- 0.039 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 all KL = 0.963 +- 0.039 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 all L1 = 0.835 +- 0.073 (in-sample avg dev_std = 0.170)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.613
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.551
SUFF++ for r=0.6 class 0.0 = 0.842 +- 0.129 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 class 1.0 = 0.787 +- 0.129 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all KL = 0.915 +- 0.129 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.130 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.834
SUFF++ for r=0.9 class 0.0 = 0.94 +- 0.058 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.058 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 all KL = 0.975 +- 0.058 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 all L1 = 0.926 +- 0.082 (in-sample avg dev_std = 0.142)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.438
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 782
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.466
SUFF++ for r=0.3 class 0.0 = 0.841 +- 0.040 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.3 class 1.0 = 0.836 +- 0.040 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.3 all KL = 0.963 +- 0.040 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.3 all L1 = 0.837 +- 0.074 (in-sample avg dev_std = 0.171)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.504
SUFF++ for r=0.6 class 0.0 = 0.835 +- 0.132 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.6 class 1.0 = 0.779 +- 0.132 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.6 all KL = 0.912 +- 0.132 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.6 all L1 = 0.786 +- 0.137 (in-sample avg dev_std = 0.210)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.789
SUFF++ for r=0.9 class 0.0 = 0.925 +- 0.065 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 class 1.0 = 0.917 +- 0.065 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all KL = 0.97 +- 0.065 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all L1 = 0.918 +- 0.093 (in-sample avg dev_std = 0.158)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.44
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.481
SUFF++ for r=0.3 class 0.0 = 0.834 +- 0.053 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 class 1.0 = 0.829 +- 0.053 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 all KL = 0.958 +- 0.053 (in-sample avg dev_std = 0.183)
SUFF++ for r=0.3 all L1 = 0.83 +- 0.080 (in-sample avg dev_std = 0.183)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.518
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.495
SUFF++ for r=0.6 class 0.0 = 0.825 +- 0.104 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 class 1.0 = 0.815 +- 0.104 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 all KL = 0.935 +- 0.104 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 all L1 = 0.816 +- 0.121 (in-sample avg dev_std = 0.196)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.662
SUFF++ for r=0.9 class 0.0 = 0.943 +- 0.077 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 class 1.0 = 0.907 +- 0.077 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 all KL = 0.967 +- 0.077 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 all L1 = 0.913 +- 0.095 (in-sample avg dev_std = 0.169)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.442
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.443
NEC for r=0.3 class 0.0 = 0.12 +- 0.048 (in-sample avg dev_std = 0.136)
NEC for r=0.3 class 1.0 = 0.136 +- 0.048 (in-sample avg dev_std = 0.136)
NEC for r=0.3 all KL = 0.027 +- 0.048 (in-sample avg dev_std = 0.136)
NEC for r=0.3 all L1 = 0.134 +- 0.080 (in-sample avg dev_std = 0.136)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.613
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.571
NEC for r=0.6 class 0.0 = 0.135 +- 0.104 (in-sample avg dev_std = 0.221)
NEC for r=0.6 class 1.0 = 0.191 +- 0.104 (in-sample avg dev_std = 0.221)
NEC for r=0.6 all KL = 0.071 +- 0.104 (in-sample avg dev_std = 0.221)
NEC for r=0.6 all L1 = 0.185 +- 0.114 (in-sample avg dev_std = 0.221)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.766
NEC for r=0.9 class 0.0 = 0.189 +- 0.181 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 1.0 = 0.236 +- 0.181 (in-sample avg dev_std = 0.327)
NEC for r=0.9 all KL = 0.161 +- 0.181 (in-sample avg dev_std = 0.327)
NEC for r=0.9 all L1 = 0.231 +- 0.152 (in-sample avg dev_std = 0.327)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.881
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.823
NEC for r=1.0 class 0.0 = 0.178 +- 0.191 (in-sample avg dev_std = 0.320)
NEC for r=1.0 class 1.0 = 0.219 +- 0.191 (in-sample avg dev_std = 0.320)
NEC for r=1.0 all KL = 0.165 +- 0.191 (in-sample avg dev_std = 0.320)
NEC for r=1.0 all L1 = 0.214 +- 0.160 (in-sample avg dev_std = 0.320)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.435
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.436
NEC for r=0.3 class 0.0 = 0.135 +- 0.039 (in-sample avg dev_std = 0.137)
NEC for r=0.3 class 1.0 = 0.138 +- 0.039 (in-sample avg dev_std = 0.137)
NEC for r=0.3 all KL = 0.027 +- 0.039 (in-sample avg dev_std = 0.137)
NEC for r=0.3 all L1 = 0.137 +- 0.076 (in-sample avg dev_std = 0.137)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.531
NEC for r=0.6 class 0.0 = 0.164 +- 0.101 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 1.0 = 0.193 +- 0.101 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all KL = 0.072 +- 0.101 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all L1 = 0.19 +- 0.115 (in-sample avg dev_std = 0.225)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.729
NEC for r=0.9 class 0.0 = 0.194 +- 0.180 (in-sample avg dev_std = 0.320)
NEC for r=0.9 class 1.0 = 0.24 +- 0.180 (in-sample avg dev_std = 0.320)
NEC for r=0.9 all KL = 0.158 +- 0.180 (in-sample avg dev_std = 0.320)
NEC for r=0.9 all L1 = 0.234 +- 0.157 (in-sample avg dev_std = 0.320)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.848
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.775
NEC for r=1.0 class 0.0 = 0.198 +- 0.221 (in-sample avg dev_std = 0.350)
NEC for r=1.0 class 1.0 = 0.236 +- 0.221 (in-sample avg dev_std = 0.350)
NEC for r=1.0 all KL = 0.188 +- 0.221 (in-sample avg dev_std = 0.350)
NEC for r=1.0 all L1 = 0.231 +- 0.181 (in-sample avg dev_std = 0.350)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.436
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.439
NEC for r=0.3 class 0.0 = 0.146 +- 0.056 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 1.0 = 0.147 +- 0.056 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all KL = 0.033 +- 0.056 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all L1 = 0.146 +- 0.090 (in-sample avg dev_std = 0.144)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.518
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.513
NEC for r=0.6 class 0.0 = 0.167 +- 0.105 (in-sample avg dev_std = 0.219)
NEC for r=0.6 class 1.0 = 0.18 +- 0.105 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all KL = 0.065 +- 0.105 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all L1 = 0.178 +- 0.118 (in-sample avg dev_std = 0.219)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.667
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.641
NEC for r=0.9 class 0.0 = 0.183 +- 0.173 (in-sample avg dev_std = 0.311)
NEC for r=0.9 class 1.0 = 0.241 +- 0.173 (in-sample avg dev_std = 0.311)
NEC for r=0.9 all KL = 0.143 +- 0.173 (in-sample avg dev_std = 0.311)
NEC for r=0.9 all L1 = 0.232 +- 0.150 (in-sample avg dev_std = 0.311)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.687
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.651
NEC for r=1.0 class 0.0 = 0.204 +- 0.192 (in-sample avg dev_std = 0.339)
NEC for r=1.0 class 1.0 = 0.249 +- 0.192 (in-sample avg dev_std = 0.339)
NEC for r=1.0 all KL = 0.165 +- 0.192 (in-sample avg dev_std = 0.339)
NEC for r=1.0 all L1 = 0.241 +- 0.165 (in-sample avg dev_std = 0.339)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 20:55:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 08:55:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 08:56:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.2057
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2740
ID Test ROC-AUC: 0.9223
ID Test Loss: 0.2792
OOD Validation ROC-AUC: 0.6772
OOD Validation Loss: 0.3678
OOD Test ROC-AUC: 0.7146
OOD Test Loss: 0.5936

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.9155
Train Loss: 0.2480
ID Validation ROC-AUC: 0.9024
ID Validation Loss: 0.2639
ID Test ROC-AUC: 0.9052
ID Test Loss: 0.2658
OOD Validation ROC-AUC: 0.7014
OOD Validation Loss: 0.3032
OOD Test ROC-AUC: 0.7263
OOD Test Loss: 0.4896

[0m[1;37mINFO[0m: [1mChartInfo 0.9223 0.7146 0.9052 0.7263 0.9024 0.7014[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 08:56:59 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 08:57:03 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 08:57:08 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.551
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 785
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.543
SUFF++ for r=0.3 class 0.0 = 0.892 +- 0.019 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.3 class 1.0 = 0.888 +- 0.019 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.3 all KL = 0.983 +- 0.019 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.3 all L1 = 0.888 +- 0.058 (in-sample avg dev_std = 0.123)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.699
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.641
SUFF++ for r=0.6 class 0.0 = 0.877 +- 0.038 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.6 class 1.0 = 0.858 +- 0.038 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.6 all KL = 0.972 +- 0.038 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.6 all L1 = 0.86 +- 0.082 (in-sample avg dev_std = 0.125)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.878
SUFF++ for r=0.9 class 0.0 = 0.94 +- 0.019 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.9 class 1.0 = 0.945 +- 0.019 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.9 all KL = 0.99 +- 0.019 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.051 (in-sample avg dev_std = 0.089)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.497
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.503
SUFF++ for r=0.3 class 0.0 = 0.894 +- 0.020 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.3 class 1.0 = 0.887 +- 0.020 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.3 all KL = 0.982 +- 0.020 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.3 all L1 = 0.887 +- 0.058 (in-sample avg dev_std = 0.125)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.63
SUFF++ for r=0.6 class 0.0 = 0.883 +- 0.034 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.6 class 1.0 = 0.86 +- 0.034 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.6 all KL = 0.974 +- 0.034 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.6 all L1 = 0.863 +- 0.078 (in-sample avg dev_std = 0.119)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.838
SUFF++ for r=0.9 class 0.0 = 0.938 +- 0.021 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.9 class 1.0 = 0.946 +- 0.021 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.9 all KL = 0.99 +- 0.021 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.049 (in-sample avg dev_std = 0.089)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.525
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 776
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.534
SUFF++ for r=0.3 class 0.0 = 0.897 +- 0.022 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.3 class 1.0 = 0.892 +- 0.022 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.3 all KL = 0.984 +- 0.022 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.3 all L1 = 0.893 +- 0.056 (in-sample avg dev_std = 0.118)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.608
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
SUFF++ for r=0.6 class 0.0 = 0.889 +- 0.028 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 1.0 = 0.866 +- 0.028 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all KL = 0.978 +- 0.028 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all L1 = 0.87 +- 0.075 (in-sample avg dev_std = 0.108)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.673
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.67
SUFF++ for r=0.9 class 0.0 = 0.937 +- 0.029 (in-sample avg dev_std = 0.106)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.029 (in-sample avg dev_std = 0.106)
SUFF++ for r=0.9 all KL = 0.987 +- 0.029 (in-sample avg dev_std = 0.106)
SUFF++ for r=0.9 all L1 = 0.933 +- 0.062 (in-sample avg dev_std = 0.106)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.552
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.51
NEC for r=0.3 class 0.0 = 0.115 +- 0.025 (in-sample avg dev_std = 0.103)
NEC for r=0.3 class 1.0 = 0.103 +- 0.025 (in-sample avg dev_std = 0.103)
NEC for r=0.3 all KL = 0.015 +- 0.025 (in-sample avg dev_std = 0.103)
NEC for r=0.3 all L1 = 0.105 +- 0.068 (in-sample avg dev_std = 0.103)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.699
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.64
NEC for r=0.6 class 0.0 = 0.133 +- 0.044 (in-sample avg dev_std = 0.157)
NEC for r=0.6 class 1.0 = 0.145 +- 0.044 (in-sample avg dev_std = 0.157)
NEC for r=0.6 all KL = 0.032 +- 0.044 (in-sample avg dev_std = 0.157)
NEC for r=0.6 all L1 = 0.143 +- 0.079 (in-sample avg dev_std = 0.157)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.886
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.796
NEC for r=0.9 class 0.0 = 0.203 +- 0.083 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.175 +- 0.083 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.071 +- 0.083 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.178 +- 0.105 (in-sample avg dev_std = 0.194)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.906
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.822
NEC for r=1.0 class 0.0 = 0.236 +- 0.100 (in-sample avg dev_std = 0.208)
NEC for r=1.0 class 1.0 = 0.161 +- 0.100 (in-sample avg dev_std = 0.208)
NEC for r=1.0 all KL = 0.082 +- 0.100 (in-sample avg dev_std = 0.208)
NEC for r=1.0 all L1 = 0.17 +- 0.115 (in-sample avg dev_std = 0.208)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.504
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.474
NEC for r=0.3 class 0.0 = 0.111 +- 0.029 (in-sample avg dev_std = 0.106)
NEC for r=0.3 class 1.0 = 0.108 +- 0.029 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all KL = 0.017 +- 0.029 (in-sample avg dev_std = 0.106)
NEC for r=0.3 all L1 = 0.108 +- 0.071 (in-sample avg dev_std = 0.106)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.603
NEC for r=0.6 class 0.0 = 0.116 +- 0.038 (in-sample avg dev_std = 0.150)
NEC for r=0.6 class 1.0 = 0.14 +- 0.038 (in-sample avg dev_std = 0.150)
NEC for r=0.6 all KL = 0.029 +- 0.038 (in-sample avg dev_std = 0.150)
NEC for r=0.6 all L1 = 0.137 +- 0.074 (in-sample avg dev_std = 0.150)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.754
NEC for r=0.9 class 0.0 = 0.177 +- 0.081 (in-sample avg dev_std = 0.201)
NEC for r=0.9 class 1.0 = 0.174 +- 0.081 (in-sample avg dev_std = 0.201)
NEC for r=0.9 all KL = 0.069 +- 0.081 (in-sample avg dev_std = 0.201)
NEC for r=0.9 all L1 = 0.174 +- 0.102 (in-sample avg dev_std = 0.201)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.89
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.801
NEC for r=1.0 class 0.0 = 0.212 +- 0.089 (in-sample avg dev_std = 0.206)
NEC for r=1.0 class 1.0 = 0.162 +- 0.089 (in-sample avg dev_std = 0.206)
NEC for r=1.0 all KL = 0.078 +- 0.089 (in-sample avg dev_std = 0.206)
NEC for r=1.0 all L1 = 0.168 +- 0.112 (in-sample avg dev_std = 0.206)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.528
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.531
NEC for r=0.3 class 0.0 = 0.106 +- 0.023 (in-sample avg dev_std = 0.108)
NEC for r=0.3 class 1.0 = 0.108 +- 0.023 (in-sample avg dev_std = 0.108)
NEC for r=0.3 all KL = 0.016 +- 0.023 (in-sample avg dev_std = 0.108)
NEC for r=0.3 all L1 = 0.108 +- 0.067 (in-sample avg dev_std = 0.108)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.608
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.578
NEC for r=0.6 class 0.0 = 0.136 +- 0.044 (in-sample avg dev_std = 0.147)
NEC for r=0.6 class 1.0 = 0.14 +- 0.044 (in-sample avg dev_std = 0.147)
NEC for r=0.6 all KL = 0.03 +- 0.044 (in-sample avg dev_std = 0.147)
NEC for r=0.6 all L1 = 0.139 +- 0.082 (in-sample avg dev_std = 0.147)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.673
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.636
NEC for r=0.9 class 0.0 = 0.18 +- 0.084 (in-sample avg dev_std = 0.207)
NEC for r=0.9 class 1.0 = 0.186 +- 0.084 (in-sample avg dev_std = 0.207)
NEC for r=0.9 all KL = 0.066 +- 0.084 (in-sample avg dev_std = 0.207)
NEC for r=0.9 all L1 = 0.185 +- 0.106 (in-sample avg dev_std = 0.207)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.689
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.643
NEC for r=1.0 class 0.0 = 0.218 +- 0.096 (in-sample avg dev_std = 0.230)
NEC for r=1.0 class 1.0 = 0.192 +- 0.096 (in-sample avg dev_std = 0.230)
NEC for r=1.0 all KL = 0.08 +- 0.096 (in-sample avg dev_std = 0.230)
NEC for r=1.0 all L1 = 0.196 +- 0.119 (in-sample avg dev_std = 0.230)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:00:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:00:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:01:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:01:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:01:45 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:01 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:02:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ROC-AUC: 0.9637
Train Loss: 0.1733
ID Validation ROC-AUC: 0.9197
ID Validation Loss: 0.2855
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2842
OOD Validation ROC-AUC: 0.6698
OOD Validation Loss: 0.4491
OOD Test ROC-AUC: 0.7168
OOD Test Loss: 0.6524

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ROC-AUC: 0.9142
Train Loss: 0.2487
ID Validation ROC-AUC: 0.8961
ID Validation Loss: 0.2652
ID Test ROC-AUC: 0.9014
ID Test Loss: 0.2653
OOD Validation ROC-AUC: 0.6964
OOD Validation Loss: 0.2900
OOD Test ROC-AUC: 0.7264
OOD Test Loss: 0.4688

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.7168 0.9014 0.7264 0.8961 0.6964[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:02:18 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:02:22 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:02:27 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0.0 = 0.811 +- 0.114 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 class 1.0 = 0.739 +- 0.114 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 all KL = 0.901 +- 0.114 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.3 all L1 = 0.748 +- 0.131 (in-sample avg dev_std = 0.240)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.736
SUFF++ for r=0.6 class 0.0 = 0.816 +- 0.122 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.6 class 1.0 = 0.747 +- 0.122 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.6 all KL = 0.879 +- 0.122 (in-sample avg dev_std = 0.286)
SUFF++ for r=0.6 all L1 = 0.755 +- 0.147 (in-sample avg dev_std = 0.286)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.862
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0.0 = 0.87 +- 0.097 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1.0 = 0.854 +- 0.097 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.934 +- 0.097 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.856 +- 0.141 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.653
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.565
SUFF++ for r=0.3 class 0.0 = 0.805 +- 0.119 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 1.0 = 0.745 +- 0.119 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all KL = 0.898 +- 0.119 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all L1 = 0.752 +- 0.130 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.723
SUFF++ for r=0.6 class 0.0 = 0.825 +- 0.121 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 class 1.0 = 0.755 +- 0.121 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 all KL = 0.886 +- 0.121 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.6 all L1 = 0.763 +- 0.147 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0.0 = 0.858 +- 0.097 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1.0 = 0.849 +- 0.097 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.932 +- 0.097 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.85 +- 0.144 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.586
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0.0 = 0.799 +- 0.115 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 class 1.0 = 0.758 +- 0.115 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 all KL = 0.909 +- 0.115 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.3 all L1 = 0.765 +- 0.133 (in-sample avg dev_std = 0.222)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.625
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.637
SUFF++ for r=0.6 class 0.0 = 0.819 +- 0.102 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 1.0 = 0.775 +- 0.102 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all KL = 0.901 +- 0.102 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all L1 = 0.782 +- 0.129 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.674
SUFF++ for r=0.9 class 0.0 = 0.856 +- 0.096 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 class 1.0 = 0.833 +- 0.096 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all KL = 0.931 +- 0.096 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all L1 = 0.837 +- 0.137 (in-sample avg dev_std = 0.203)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.531
NEC for r=0.3 class 0.0 = 0.183 +- 0.126 (in-sample avg dev_std = 0.203)
NEC for r=0.3 class 1.0 = 0.262 +- 0.126 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all KL = 0.098 +- 0.126 (in-sample avg dev_std = 0.203)
NEC for r=0.3 all L1 = 0.253 +- 0.146 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.68
NEC for r=0.6 class 0.0 = 0.168 +- 0.152 (in-sample avg dev_std = 0.284)
NEC for r=0.6 class 1.0 = 0.27 +- 0.152 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all KL = 0.136 +- 0.152 (in-sample avg dev_std = 0.284)
NEC for r=0.6 all L1 = 0.258 +- 0.155 (in-sample avg dev_std = 0.284)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.862
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.827
NEC for r=0.9 class 0.0 = 0.207 +- 0.150 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 1.0 = 0.205 +- 0.150 (in-sample avg dev_std = 0.277)
NEC for r=0.9 all KL = 0.126 +- 0.150 (in-sample avg dev_std = 0.277)
NEC for r=0.9 all L1 = 0.205 +- 0.163 (in-sample avg dev_std = 0.277)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.906
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.848
NEC for r=1.0 class 0.0 = 0.2 +- 0.156 (in-sample avg dev_std = 0.276)
NEC for r=1.0 class 1.0 = 0.18 +- 0.156 (in-sample avg dev_std = 0.276)
NEC for r=1.0 all KL = 0.123 +- 0.156 (in-sample avg dev_std = 0.276)
NEC for r=1.0 all L1 = 0.182 +- 0.162 (in-sample avg dev_std = 0.276)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.653
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.545
NEC for r=0.3 class 0.0 = 0.182 +- 0.120 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 1.0 = 0.244 +- 0.120 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all KL = 0.09 +- 0.120 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all L1 = 0.236 +- 0.142 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.68
NEC for r=0.6 class 0.0 = 0.173 +- 0.142 (in-sample avg dev_std = 0.268)
NEC for r=0.6 class 1.0 = 0.249 +- 0.142 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all KL = 0.12 +- 0.142 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all L1 = 0.24 +- 0.152 (in-sample avg dev_std = 0.268)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.869
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.808
NEC for r=0.9 class 0.0 = 0.193 +- 0.158 (in-sample avg dev_std = 0.280)
NEC for r=0.9 class 1.0 = 0.207 +- 0.158 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all KL = 0.127 +- 0.158 (in-sample avg dev_std = 0.280)
NEC for r=0.9 all L1 = 0.206 +- 0.167 (in-sample avg dev_std = 0.280)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.893
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.832
NEC for r=1.0 class 0.0 = 0.197 +- 0.159 (in-sample avg dev_std = 0.273)
NEC for r=1.0 class 1.0 = 0.179 +- 0.159 (in-sample avg dev_std = 0.273)
NEC for r=1.0 all KL = 0.122 +- 0.159 (in-sample avg dev_std = 0.273)
NEC for r=1.0 all L1 = 0.181 +- 0.158 (in-sample avg dev_std = 0.273)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.586
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.535
NEC for r=0.3 class 0.0 = 0.199 +- 0.118 (in-sample avg dev_std = 0.188)
NEC for r=0.3 class 1.0 = 0.242 +- 0.118 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all KL = 0.088 +- 0.118 (in-sample avg dev_std = 0.188)
NEC for r=0.3 all L1 = 0.235 +- 0.141 (in-sample avg dev_std = 0.188)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.625
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.586
NEC for r=0.6 class 0.0 = 0.175 +- 0.128 (in-sample avg dev_std = 0.257)
NEC for r=0.6 class 1.0 = 0.233 +- 0.128 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all KL = 0.106 +- 0.128 (in-sample avg dev_std = 0.257)
NEC for r=0.6 all L1 = 0.223 +- 0.139 (in-sample avg dev_std = 0.257)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.668
NEC for r=0.9 class 0.0 = 0.186 +- 0.154 (in-sample avg dev_std = 0.297)
NEC for r=0.9 class 1.0 = 0.238 +- 0.154 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all KL = 0.135 +- 0.154 (in-sample avg dev_std = 0.297)
NEC for r=0.9 all L1 = 0.229 +- 0.155 (in-sample avg dev_std = 0.297)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.678
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.661
NEC for r=1.0 class 0.0 = 0.193 +- 0.166 (in-sample avg dev_std = 0.319)
NEC for r=1.0 class 1.0 = 0.229 +- 0.166 (in-sample avg dev_std = 0.319)
NEC for r=1.0 all KL = 0.144 +- 0.166 (in-sample avg dev_std = 0.319)
NEC for r=1.0 all L1 = 0.223 +- 0.163 (in-sample avg dev_std = 0.319)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:06:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:06:22 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:06:53 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:12 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:28 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:07:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9564
Train Loss: 0.2145
ID Validation ROC-AUC: 0.9201
ID Validation Loss: 0.3048
ID Test ROC-AUC: 0.9208
ID Test Loss: 0.3133
OOD Validation ROC-AUC: 0.6613
OOD Validation Loss: 0.4567
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6765

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ROC-AUC: 0.9022
Train Loss: 0.2623
ID Validation ROC-AUC: 0.8925
ID Validation Loss: 0.2723
ID Test ROC-AUC: 0.8954
ID Test Loss: 0.2749
OOD Validation ROC-AUC: 0.6933
OOD Validation Loss: 0.3003
OOD Test ROC-AUC: 0.7343
OOD Test Loss: 0.4787

[0m[1;37mINFO[0m: [1mChartInfo 0.9208 0.7128 0.8954 0.7343 0.8925 0.6933[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:07:45 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:07:49 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:07:53 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.533
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0.0 = 0.923 +- 0.017 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.3 class 1.0 = 0.916 +- 0.017 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.3 all KL = 0.99 +- 0.017 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.3 all L1 = 0.917 +- 0.047 (in-sample avg dev_std = 0.092)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.648
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.601
SUFF++ for r=0.6 class 0.0 = 0.916 +- 0.045 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.6 class 1.0 = 0.867 +- 0.045 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.6 all KL = 0.975 +- 0.045 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.6 all L1 = 0.873 +- 0.096 (in-sample avg dev_std = 0.111)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.852
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.838
SUFF++ for r=0.9 class 0.0 = 0.953 +- 0.045 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.9 class 1.0 = 0.918 +- 0.045 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.9 all KL = 0.98 +- 0.045 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.9 all L1 = 0.922 +- 0.074 (in-sample avg dev_std = 0.132)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.55
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 780
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.532
SUFF++ for r=0.3 class 0.0 = 0.923 +- 0.015 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 class 1.0 = 0.915 +- 0.015 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 all KL = 0.99 +- 0.015 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 all L1 = 0.916 +- 0.047 (in-sample avg dev_std = 0.088)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.656
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0.0 = 0.916 +- 0.048 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.6 class 1.0 = 0.868 +- 0.048 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.6 all KL = 0.974 +- 0.048 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.6 all L1 = 0.874 +- 0.094 (in-sample avg dev_std = 0.122)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0.0 = 0.955 +- 0.049 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.049 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all KL = 0.981 +- 0.049 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all L1 = 0.927 +- 0.071 (in-sample avg dev_std = 0.126)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 785
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.53
SUFF++ for r=0.3 class 0.0 = 0.923 +- 0.011 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 class 1.0 = 0.916 +- 0.011 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 all KL = 0.991 +- 0.011 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 all L1 = 0.917 +- 0.043 (in-sample avg dev_std = 0.088)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.518
SUFF++ for r=0.6 class 0.0 = 0.905 +- 0.039 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.6 class 1.0 = 0.89 +- 0.039 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.6 all KL = 0.982 +- 0.039 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.6 all L1 = 0.892 +- 0.080 (in-sample avg dev_std = 0.097)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.632
SUFF++ for r=0.9 class 0.0 = 0.942 +- 0.033 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 1.0 = 0.92 +- 0.033 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all KL = 0.983 +- 0.033 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.069 (in-sample avg dev_std = 0.123)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.537
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.515
NEC for r=0.3 class 0.0 = 0.077 +- 0.022 (in-sample avg dev_std = 0.076)
NEC for r=0.3 class 1.0 = 0.073 +- 0.022 (in-sample avg dev_std = 0.076)
NEC for r=0.3 all KL = 0.008 +- 0.022 (in-sample avg dev_std = 0.076)
NEC for r=0.3 all L1 = 0.073 +- 0.053 (in-sample avg dev_std = 0.076)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.648
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.591
NEC for r=0.6 class 0.0 = 0.101 +- 0.047 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 1.0 = 0.132 +- 0.047 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all KL = 0.028 +- 0.047 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all L1 = 0.128 +- 0.090 (in-sample avg dev_std = 0.137)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.852
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.766
NEC for r=0.9 class 0.0 = 0.15 +- 0.130 (in-sample avg dev_std = 0.255)
NEC for r=0.9 class 1.0 = 0.237 +- 0.130 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all KL = 0.109 +- 0.130 (in-sample avg dev_std = 0.255)
NEC for r=0.9 all L1 = 0.227 +- 0.132 (in-sample avg dev_std = 0.255)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.821
NEC for r=1.0 class 0.0 = 0.177 +- 0.154 (in-sample avg dev_std = 0.285)
NEC for r=1.0 class 1.0 = 0.234 +- 0.154 (in-sample avg dev_std = 0.285)
NEC for r=1.0 all KL = 0.138 +- 0.154 (in-sample avg dev_std = 0.285)
NEC for r=1.0 all L1 = 0.228 +- 0.139 (in-sample avg dev_std = 0.285)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.544
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.532
NEC for r=0.3 class 0.0 = 0.068 +- 0.020 (in-sample avg dev_std = 0.079)
NEC for r=0.3 class 1.0 = 0.079 +- 0.020 (in-sample avg dev_std = 0.079)
NEC for r=0.3 all KL = 0.009 +- 0.020 (in-sample avg dev_std = 0.079)
NEC for r=0.3 all L1 = 0.078 +- 0.060 (in-sample avg dev_std = 0.079)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.656
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.599
NEC for r=0.6 class 0.0 = 0.086 +- 0.049 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 1.0 = 0.129 +- 0.049 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all KL = 0.027 +- 0.049 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all L1 = 0.124 +- 0.089 (in-sample avg dev_std = 0.137)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.844
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.748
NEC for r=0.9 class 0.0 = 0.137 +- 0.146 (in-sample avg dev_std = 0.269)
NEC for r=0.9 class 1.0 = 0.238 +- 0.146 (in-sample avg dev_std = 0.269)
NEC for r=0.9 all KL = 0.118 +- 0.146 (in-sample avg dev_std = 0.269)
NEC for r=0.9 all L1 = 0.226 +- 0.137 (in-sample avg dev_std = 0.269)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.883
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.797
NEC for r=1.0 class 0.0 = 0.161 +- 0.162 (in-sample avg dev_std = 0.297)
NEC for r=1.0 class 1.0 = 0.242 +- 0.162 (in-sample avg dev_std = 0.297)
NEC for r=1.0 all KL = 0.146 +- 0.162 (in-sample avg dev_std = 0.297)
NEC for r=1.0 all L1 = 0.233 +- 0.139 (in-sample avg dev_std = 0.297)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.541
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.524
NEC for r=0.3 class 0.0 = 0.075 +- 0.016 (in-sample avg dev_std = 0.077)
NEC for r=0.3 class 1.0 = 0.075 +- 0.016 (in-sample avg dev_std = 0.077)
NEC for r=0.3 all KL = 0.008 +- 0.016 (in-sample avg dev_std = 0.077)
NEC for r=0.3 all L1 = 0.075 +- 0.051 (in-sample avg dev_std = 0.077)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.538
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.533
NEC for r=0.6 class 0.0 = 0.107 +- 0.043 (in-sample avg dev_std = 0.127)
NEC for r=0.6 class 1.0 = 0.112 +- 0.043 (in-sample avg dev_std = 0.127)
NEC for r=0.6 all KL = 0.022 +- 0.043 (in-sample avg dev_std = 0.127)
NEC for r=0.6 all L1 = 0.111 +- 0.080 (in-sample avg dev_std = 0.127)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.635
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.599
NEC for r=0.9 class 0.0 = 0.157 +- 0.107 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 1.0 = 0.21 +- 0.107 (in-sample avg dev_std = 0.223)
NEC for r=0.9 all KL = 0.079 +- 0.107 (in-sample avg dev_std = 0.223)
NEC for r=0.9 all L1 = 0.201 +- 0.121 (in-sample avg dev_std = 0.223)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.666
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.619
NEC for r=1.0 class 0.0 = 0.182 +- 0.122 (in-sample avg dev_std = 0.269)
NEC for r=1.0 class 1.0 = 0.233 +- 0.122 (in-sample avg dev_std = 0.269)
NEC for r=1.0 all KL = 0.106 +- 0.122 (in-sample avg dev_std = 0.269)
NEC for r=1.0 all L1 = 0.225 +- 0.131 (in-sample avg dev_std = 0.269)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.981, 0.943, 0.979, 1.0], 'all_L1': [0.895, 0.839, 0.925, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.915, 0.975, 1.0], 'all_L1': [0.835, 0.793, 0.926, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.983, 0.972, 0.99, 1.0], 'all_L1': [0.888, 0.86, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.901, 0.879, 0.934, 1.0], 'all_L1': [0.748, 0.755, 0.856, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.975, 0.98, 1.0], 'all_L1': [0.917, 0.873, 0.922, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.014, 0.046, 0.126, 0.152], 'all_L1': [0.093, 0.151, 0.223, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.071, 0.161, 0.165], 'all_L1': [0.134, 0.185, 0.231, 0.214]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.032, 0.071, 0.082], 'all_L1': [0.105, 0.143, 0.178, 0.17]}), defaultdict(<class 'list'>, {'all_KL': [0.098, 0.136, 0.126, 0.123], 'all_L1': [0.253, 0.258, 0.205, 0.182]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.028, 0.109, 0.138], 'all_L1': [0.073, 0.128, 0.227, 0.228]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.979, 0.946, 0.977, 1.0], 'all_L1': [0.896, 0.842, 0.923, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.912, 0.97, 1.0], 'all_L1': [0.837, 0.786, 0.918, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.982, 0.974, 0.99, 1.0], 'all_L1': [0.887, 0.863, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.898, 0.886, 0.932, 1.0], 'all_L1': [0.752, 0.763, 0.85, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.974, 0.981, 1.0], 'all_L1': [0.916, 0.874, 0.927, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.015, 0.045, 0.13, 0.143], 'all_L1': [0.092, 0.148, 0.226, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.072, 0.158, 0.188], 'all_L1': [0.137, 0.19, 0.234, 0.231]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.029, 0.069, 0.078], 'all_L1': [0.108, 0.137, 0.174, 0.168]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.12, 0.127, 0.122], 'all_L1': [0.236, 0.24, 0.206, 0.181]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.027, 0.118, 0.146], 'all_L1': [0.078, 0.124, 0.226, 0.233]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.981, 0.963, 0.978, 1.0], 'all_L1': [0.896, 0.865, 0.924, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.958, 0.935, 0.967, 1.0], 'all_L1': [0.83, 0.816, 0.913, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.984, 0.978, 0.987, 1.0], 'all_L1': [0.893, 0.87, 0.933, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.909, 0.901, 0.931, 1.0], 'all_L1': [0.765, 0.782, 0.837, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.982, 0.983, 1.0], 'all_L1': [0.917, 0.892, 0.923, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.017, 0.041, 0.109, 0.14], 'all_L1': [0.096, 0.141, 0.212, 0.231]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.065, 0.143, 0.165], 'all_L1': [0.146, 0.178, 0.232, 0.241]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.03, 0.066, 0.08], 'all_L1': [0.108, 0.139, 0.185, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.106, 0.135, 0.144], 'all_L1': [0.235, 0.223, 0.229, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.022, 0.079, 0.106], 'all_L1': [0.075, 0.111, 0.201, 0.225]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.857 +- 0.061, 0.824 +- 0.044, 0.915 +- 0.030, 1.000 +- 0.000
suff++ class all_KL  =  0.964 +- 0.033, 0.937 +- 0.036, 0.972 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.540 +- 0.052, 0.631 +- 0.061, 0.852 +- 0.016
nec class all_L1  =  0.132 +- 0.064, 0.173 +- 0.046, 0.213 +- 0.020, 0.203 +- 0.023
nec class all_KL  =  0.032 +- 0.033, 0.063 +- 0.040, 0.119 +- 0.029, 0.132 +- 0.029
nec_acc_int  =  0.517 +- 0.046, 0.623 +- 0.038, 0.786 +- 0.023, 0.826 +- 0.011

Eval split id_test
suff++ class all_L1  =  0.858 +- 0.059, 0.826 +- 0.044, 0.913 +- 0.033, 1.000 +- 0.000
suff++ class all_KL  =  0.962 +- 0.033, 0.938 +- 0.035, 0.970 +- 0.020, 1.000 +- 0.000
suff++_acc_int  =  0.526 +- 0.039, 0.627 +- 0.072, 0.832 +- 0.023
nec class all_L1  =  0.130 +- 0.056, 0.168 +- 0.042, 0.213 +- 0.022, 0.207 +- 0.027
nec class all_KL  =  0.032 +- 0.030, 0.059 +- 0.035, 0.120 +- 0.029, 0.135 +- 0.036
nec_acc_int  =  0.517 +- 0.057, 0.617 +- 0.055, 0.767 +- 0.030, 0.808 +- 0.022

Eval split test
suff++ class all_L1  =  0.860 +- 0.056, 0.845 +- 0.040, 0.906 +- 0.035, 1.000 +- 0.000
suff++ class all_KL  =  0.965 +- 0.030, 0.952 +- 0.030, 0.969 +- 0.020, 1.000 +- 0.000
suff++_acc_int  =  0.521 +- 0.020, 0.566 +- 0.053, 0.655 +- 0.017
nec class all_L1  =  0.132 +- 0.056, 0.158 +- 0.039, 0.212 +- 0.018, 0.223 +- 0.015
nec class all_KL  =  0.032 +- 0.029, 0.053 +- 0.030, 0.106 +- 0.030, 0.127 +- 0.030
nec_acc_int  =  0.517 +- 0.040, 0.558 +- 0.029, 0.634 +- 0.022, 0.645 +- 0.014


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.494 +- 0.005, 0.499 +- 0.006, 0.564 +- 0.018, 0.602 +- 0.012
Faith. Armon (L1)= 		  =  0.220 +- 0.085, 0.282 +- 0.057, 0.345 +- 0.026, 0.337 +- 0.032
Faith. GMean (L1)= 	  =  0.324 +- 0.061, 0.373 +- 0.038, 0.441 +- 0.022, 0.450 +- 0.026
Faith. Aritm (KL)= 		  =  0.498 +- 0.002, 0.500 +- 0.005, 0.545 +- 0.014, 0.566 +- 0.014
Faith. Armon (KL)= 		  =  0.060 +- 0.059, 0.114 +- 0.066, 0.210 +- 0.047, 0.232 +- 0.046
Faith. GMean (KL)= 	  =  0.157 +- 0.074, 0.230 +- 0.066, 0.336 +- 0.042, 0.361 +- 0.042

Eval split id_test
Faith. Aritm (L1)= 		  =  0.494 +- 0.004, 0.497 +- 0.005, 0.563 +- 0.019, 0.604 +- 0.014
Faith. Armon (L1)= 		  =  0.220 +- 0.076, 0.275 +- 0.054, 0.345 +- 0.029, 0.342 +- 0.038
Faith. GMean (L1)= 	  =  0.325 +- 0.054, 0.368 +- 0.035, 0.440 +- 0.024, 0.454 +- 0.030
Faith. Aritm (KL)= 		  =  0.497 +- 0.002, 0.498 +- 0.004, 0.545 +- 0.014, 0.568 +- 0.018
Faith. Armon (KL)= 		  =  0.059 +- 0.053, 0.108 +- 0.059, 0.213 +- 0.047, 0.237 +- 0.056
Faith. GMean (KL)= 	  =  0.158 +- 0.067, 0.224 +- 0.061, 0.339 +- 0.043, 0.364 +- 0.051

Eval split test
Faith. Aritm (L1)= 		  =  0.496 +- 0.004, 0.502 +- 0.003, 0.559 +- 0.014, 0.612 +- 0.007
Faith. Armon (L1)= 		  =  0.223 +- 0.077, 0.264 +- 0.051, 0.343 +- 0.022, 0.365 +- 0.020
Faith. GMean (L1)= 	  =  0.328 +- 0.056, 0.362 +- 0.035, 0.437 +- 0.015, 0.472 +- 0.016
Faith. Aritm (KL)= 		  =  0.499 +- 0.002, 0.502 +- 0.001, 0.538 +- 0.010, 0.563 +- 0.015
Faith. Armon (KL)= 		  =  0.061 +- 0.052, 0.098 +- 0.053, 0.190 +- 0.049, 0.224 +- 0.048
Faith. GMean (KL)= 	  =  0.161 +- 0.067, 0.215 +- 0.058, 0.317 +- 0.044, 0.354 +- 0.044
Computed for split load_split = id



Completed in  0:26:41.879703  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:11:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:11:47 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:12:16 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:12:25 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:12:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:12:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:13:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.8811
Train Loss: 0.2557
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.2674
ID Test ROC-AUC: 0.8737
ID Test Loss: 0.2665
OOD Validation ROC-AUC: 0.6517
OOD Validation Loss: 0.3251
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.4760

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.8365
Train Loss: 0.2849
ID Validation ROC-AUC: 0.8359
ID Validation Loss: 0.2863
ID Test ROC-AUC: 0.8384
ID Test Loss: 0.2892
OOD Validation ROC-AUC: 0.6936
OOD Validation Loss: 0.2765
OOD Test ROC-AUC: 0.7131
OOD Test Loss: 0.4403

[0m[1;37mINFO[0m: [1mChartInfo 0.8737 0.6956 0.8384 0.7131 0.8359 0.6936[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:13:07 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:13:12 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:13:15 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 789
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0.0 = 0.936 +- 0.022 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.3 class 1.0 = 0.928 +- 0.022 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.3 all KL = 0.991 +- 0.022 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.3 all L1 = 0.929 +- 0.057 (in-sample avg dev_std = 0.085)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.678
SUFF++ for r=0.6 class 0.0 = 0.947 +- 0.042 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.042 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.6 all KL = 0.979 +- 0.042 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.6 all L1 = 0.901 +- 0.090 (in-sample avg dev_std = 0.107)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.797
SUFF++ for r=0.9 class 0.0 = 0.977 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 1.0 = 0.956 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all KL = 0.995 +- 0.012 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all L1 = 0.959 +- 0.040 (in-sample avg dev_std = 0.070)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.62
SUFF++ for r=0.3 class 0.0 = 0.942 +- 0.023 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 class 1.0 = 0.925 +- 0.023 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all KL = 0.99 +- 0.023 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all L1 = 0.927 +- 0.062 (in-sample avg dev_std = 0.094)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.751
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.705
SUFF++ for r=0.6 class 0.0 = 0.945 +- 0.051 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.6 class 1.0 = 0.894 +- 0.051 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.6 all KL = 0.978 +- 0.051 (in-sample avg dev_std = 0.112)
SUFF++ for r=0.6 all L1 = 0.9 +- 0.088 (in-sample avg dev_std = 0.112)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.010 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 class 1.0 = 0.958 +- 0.010 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 all KL = 0.995 +- 0.010 (in-sample avg dev_std = 0.069)
SUFF++ for r=0.9 all L1 = 0.96 +- 0.040 (in-sample avg dev_std = 0.069)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.572
SUFF++ for r=0.3 class 0.0 = 0.932 +- 0.021 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 class 1.0 = 0.927 +- 0.021 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 all KL = 0.99 +- 0.021 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.3 all L1 = 0.928 +- 0.063 (in-sample avg dev_std = 0.088)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.624
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.62
SUFF++ for r=0.6 class 0.0 = 0.935 +- 0.033 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.6 class 1.0 = 0.913 +- 0.033 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.6 all KL = 0.986 +- 0.033 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.6 all L1 = 0.917 +- 0.075 (in-sample avg dev_std = 0.089)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.683
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.681
SUFF++ for r=0.9 class 0.0 = 0.977 +- 0.009 (in-sample avg dev_std = 0.061)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.009 (in-sample avg dev_std = 0.061)
SUFF++ for r=0.9 all KL = 0.996 +- 0.009 (in-sample avg dev_std = 0.061)
SUFF++ for r=0.9 all L1 = 0.965 +- 0.037 (in-sample avg dev_std = 0.061)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.615
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.598
NEC for r=0.3 class 0.0 = 0.042 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.3 class 1.0 = 0.051 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all KL = 0.004 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all L1 = 0.05 +- 0.040 (in-sample avg dev_std = 0.052)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.695
NEC for r=0.6 class 0.0 = 0.051 +- 0.024 (in-sample avg dev_std = 0.087)
NEC for r=0.6 class 1.0 = 0.081 +- 0.024 (in-sample avg dev_std = 0.087)
NEC for r=0.6 all KL = 0.012 +- 0.024 (in-sample avg dev_std = 0.087)
NEC for r=0.6 all L1 = 0.077 +- 0.067 (in-sample avg dev_std = 0.087)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.774
NEC for r=0.9 class 0.0 = 0.061 +- 0.035 (in-sample avg dev_std = 0.111)
NEC for r=0.9 class 1.0 = 0.101 +- 0.035 (in-sample avg dev_std = 0.111)
NEC for r=0.9 all KL = 0.02 +- 0.035 (in-sample avg dev_std = 0.111)
NEC for r=0.9 all L1 = 0.097 +- 0.072 (in-sample avg dev_std = 0.111)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.826
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.798
NEC for r=1.0 class 0.0 = 0.057 +- 0.042 (in-sample avg dev_std = 0.117)
NEC for r=1.0 class 1.0 = 0.106 +- 0.042 (in-sample avg dev_std = 0.117)
NEC for r=1.0 all KL = 0.023 +- 0.042 (in-sample avg dev_std = 0.117)
NEC for r=1.0 all L1 = 0.1 +- 0.076 (in-sample avg dev_std = 0.117)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.674
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.655
NEC for r=0.3 class 0.0 = 0.039 +- 0.011 (in-sample avg dev_std = 0.052)
NEC for r=0.3 class 1.0 = 0.051 +- 0.011 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all KL = 0.004 +- 0.011 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all L1 = 0.05 +- 0.043 (in-sample avg dev_std = 0.052)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.751
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.725
NEC for r=0.6 class 0.0 = 0.043 +- 0.021 (in-sample avg dev_std = 0.085)
NEC for r=0.6 class 1.0 = 0.08 +- 0.021 (in-sample avg dev_std = 0.085)
NEC for r=0.6 all KL = 0.011 +- 0.021 (in-sample avg dev_std = 0.085)
NEC for r=0.6 all L1 = 0.076 +- 0.060 (in-sample avg dev_std = 0.085)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.851
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.824
NEC for r=0.9 class 0.0 = 0.046 +- 0.035 (in-sample avg dev_std = 0.109)
NEC for r=0.9 class 1.0 = 0.099 +- 0.035 (in-sample avg dev_std = 0.109)
NEC for r=0.9 all KL = 0.019 +- 0.035 (in-sample avg dev_std = 0.109)
NEC for r=0.9 all L1 = 0.092 +- 0.070 (in-sample avg dev_std = 0.109)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.866
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.846
NEC for r=1.0 class 0.0 = 0.052 +- 0.035 (in-sample avg dev_std = 0.111)
NEC for r=1.0 class 1.0 = 0.101 +- 0.035 (in-sample avg dev_std = 0.111)
NEC for r=1.0 all KL = 0.021 +- 0.035 (in-sample avg dev_std = 0.111)
NEC for r=1.0 all L1 = 0.095 +- 0.072 (in-sample avg dev_std = 0.111)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.584
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.577
NEC for r=0.3 class 0.0 = 0.05 +- 0.012 (in-sample avg dev_std = 0.054)
NEC for r=0.3 class 1.0 = 0.053 +- 0.012 (in-sample avg dev_std = 0.054)
NEC for r=0.3 all KL = 0.004 +- 0.012 (in-sample avg dev_std = 0.054)
NEC for r=0.3 all L1 = 0.053 +- 0.044 (in-sample avg dev_std = 0.054)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.624
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.616
NEC for r=0.6 class 0.0 = 0.054 +- 0.025 (in-sample avg dev_std = 0.080)
NEC for r=0.6 class 1.0 = 0.075 +- 0.025 (in-sample avg dev_std = 0.080)
NEC for r=0.6 all KL = 0.01 +- 0.025 (in-sample avg dev_std = 0.080)
NEC for r=0.6 all L1 = 0.072 +- 0.062 (in-sample avg dev_std = 0.080)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.683
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0.0 = 0.055 +- 0.024 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 1.0 = 0.09 +- 0.024 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all KL = 0.013 +- 0.024 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all L1 = 0.084 +- 0.065 (in-sample avg dev_std = 0.091)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.695
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.686
NEC for r=1.0 class 0.0 = 0.062 +- 0.031 (in-sample avg dev_std = 0.101)
NEC for r=1.0 class 1.0 = 0.096 +- 0.031 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all KL = 0.016 +- 0.031 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all L1 = 0.09 +- 0.070 (in-sample avg dev_std = 0.101)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:16:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:16:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:17:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:17:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:17:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:17:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:18:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ROC-AUC: 0.8771
Train Loss: 0.2559
ID Validation ROC-AUC: 0.8652
ID Validation Loss: 0.2688
ID Test ROC-AUC: 0.8709
ID Test Loss: 0.2669
OOD Validation ROC-AUC: 0.6641
OOD Validation Loss: 0.3382
OOD Test ROC-AUC: 0.6946
OOD Test Loss: 0.4904

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ROC-AUC: 0.8352
Train Loss: 0.2919
ID Validation ROC-AUC: 0.8339
ID Validation Loss: 0.2928
ID Test ROC-AUC: 0.8361
ID Test Loss: 0.2965
OOD Validation ROC-AUC: 0.6778
OOD Validation Loss: 0.2794
OOD Test ROC-AUC: 0.7041
OOD Test Loss: 0.4486

[0m[1;37mINFO[0m: [1mChartInfo 0.8709 0.6946 0.8361 0.7041 0.8339 0.6778[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:18:09 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:18:13 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:18:17 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.624
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
SUFF++ for r=0.3 class 0.0 = 0.939 +- 0.022 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.3 class 1.0 = 0.929 +- 0.022 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.3 all KL = 0.991 +- 0.022 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.3 all L1 = 0.93 +- 0.060 (in-sample avg dev_std = 0.087)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.728
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.676
SUFF++ for r=0.6 class 0.0 = 0.942 +- 0.045 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.6 class 1.0 = 0.899 +- 0.045 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.6 all KL = 0.979 +- 0.045 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.6 all L1 = 0.904 +- 0.083 (in-sample avg dev_std = 0.105)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.806
SUFF++ for r=0.9 class 0.0 = 0.979 +- 0.013 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 class 1.0 = 0.964 +- 0.013 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 all KL = 0.996 +- 0.013 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 all L1 = 0.966 +- 0.036 (in-sample avg dev_std = 0.055)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 782
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
SUFF++ for r=0.3 class 0.0 = 0.941 +- 0.022 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.3 class 1.0 = 0.926 +- 0.022 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.3 all KL = 0.99 +- 0.022 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.3 all L1 = 0.928 +- 0.064 (in-sample avg dev_std = 0.095)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.761
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.712
SUFF++ for r=0.6 class 0.0 = 0.953 +- 0.035 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.6 class 1.0 = 0.902 +- 0.035 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.6 all KL = 0.983 +- 0.035 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.6 all L1 = 0.908 +- 0.078 (in-sample avg dev_std = 0.098)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0.0 = 0.978 +- 0.011 (in-sample avg dev_std = 0.059)
SUFF++ for r=0.9 class 1.0 = 0.963 +- 0.011 (in-sample avg dev_std = 0.059)
SUFF++ for r=0.9 all KL = 0.996 +- 0.011 (in-sample avg dev_std = 0.059)
SUFF++ for r=0.9 all L1 = 0.964 +- 0.035 (in-sample avg dev_std = 0.059)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.55
SUFF++ for r=0.3 class 0.0 = 0.941 +- 0.018 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.3 class 1.0 = 0.934 +- 0.018 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.3 all KL = 0.992 +- 0.018 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.3 all L1 = 0.935 +- 0.056 (in-sample avg dev_std = 0.082)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.599
SUFF++ for r=0.6 class 0.0 = 0.936 +- 0.036 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 class 1.0 = 0.917 +- 0.036 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 all KL = 0.987 +- 0.036 (in-sample avg dev_std = 0.083)
SUFF++ for r=0.6 all L1 = 0.92 +- 0.076 (in-sample avg dev_std = 0.083)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.664
SUFF++ for r=0.9 class 0.0 = 0.975 +- 0.010 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 class 1.0 = 0.966 +- 0.010 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 all KL = 0.996 +- 0.010 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 all L1 = 0.967 +- 0.036 (in-sample avg dev_std = 0.055)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.626
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.619
NEC for r=0.3 class 0.0 = 0.045 +- 0.011 (in-sample avg dev_std = 0.054)
NEC for r=0.3 class 1.0 = 0.05 +- 0.011 (in-sample avg dev_std = 0.054)
NEC for r=0.3 all KL = 0.004 +- 0.011 (in-sample avg dev_std = 0.054)
NEC for r=0.3 all L1 = 0.049 +- 0.042 (in-sample avg dev_std = 0.054)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.728
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.7
NEC for r=0.6 class 0.0 = 0.047 +- 0.017 (in-sample avg dev_std = 0.074)
NEC for r=0.6 class 1.0 = 0.072 +- 0.017 (in-sample avg dev_std = 0.074)
NEC for r=0.6 all KL = 0.009 +- 0.017 (in-sample avg dev_std = 0.074)
NEC for r=0.6 all L1 = 0.069 +- 0.056 (in-sample avg dev_std = 0.074)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.784
NEC for r=0.9 class 0.0 = 0.056 +- 0.037 (in-sample avg dev_std = 0.097)
NEC for r=0.9 class 1.0 = 0.091 +- 0.037 (in-sample avg dev_std = 0.097)
NEC for r=0.9 all KL = 0.018 +- 0.037 (in-sample avg dev_std = 0.097)
NEC for r=0.9 all L1 = 0.087 +- 0.070 (in-sample avg dev_std = 0.097)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.822
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.804
NEC for r=1.0 class 0.0 = 0.058 +- 0.038 (in-sample avg dev_std = 0.100)
NEC for r=1.0 class 1.0 = 0.091 +- 0.038 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all KL = 0.019 +- 0.038 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all L1 = 0.087 +- 0.068 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.641
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.645
NEC for r=0.3 class 0.0 = 0.041 +- 0.014 (in-sample avg dev_std = 0.051)
NEC for r=0.3 class 1.0 = 0.049 +- 0.014 (in-sample avg dev_std = 0.051)
NEC for r=0.3 all KL = 0.004 +- 0.014 (in-sample avg dev_std = 0.051)
NEC for r=0.3 all L1 = 0.048 +- 0.043 (in-sample avg dev_std = 0.051)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.761
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.753
NEC for r=0.6 class 0.0 = 0.042 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 class 1.0 = 0.072 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all KL = 0.008 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.6 all L1 = 0.068 +- 0.052 (in-sample avg dev_std = 0.071)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.837
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.823
NEC for r=0.9 class 0.0 = 0.046 +- 0.024 (in-sample avg dev_std = 0.089)
NEC for r=0.9 class 1.0 = 0.086 +- 0.024 (in-sample avg dev_std = 0.089)
NEC for r=0.9 all KL = 0.014 +- 0.024 (in-sample avg dev_std = 0.089)
NEC for r=0.9 all L1 = 0.081 +- 0.062 (in-sample avg dev_std = 0.089)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.861
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.846
NEC for r=1.0 class 0.0 = 0.049 +- 0.031 (in-sample avg dev_std = 0.096)
NEC for r=1.0 class 1.0 = 0.091 +- 0.031 (in-sample avg dev_std = 0.096)
NEC for r=1.0 all KL = 0.017 +- 0.031 (in-sample avg dev_std = 0.096)
NEC for r=1.0 all L1 = 0.086 +- 0.064 (in-sample avg dev_std = 0.096)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.576
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
NEC for r=0.3 class 0.0 = 0.04 +- 0.008 (in-sample avg dev_std = 0.048)
NEC for r=0.3 class 1.0 = 0.048 +- 0.008 (in-sample avg dev_std = 0.048)
NEC for r=0.3 all KL = 0.003 +- 0.008 (in-sample avg dev_std = 0.048)
NEC for r=0.3 all L1 = 0.046 +- 0.039 (in-sample avg dev_std = 0.048)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.622
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.622
NEC for r=0.6 class 0.0 = 0.052 +- 0.016 (in-sample avg dev_std = 0.072)
NEC for r=0.6 class 1.0 = 0.065 +- 0.016 (in-sample avg dev_std = 0.072)
NEC for r=0.6 all KL = 0.007 +- 0.016 (in-sample avg dev_std = 0.072)
NEC for r=0.6 all L1 = 0.063 +- 0.053 (in-sample avg dev_std = 0.072)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0.0 = 0.055 +- 0.023 (in-sample avg dev_std = 0.082)
NEC for r=0.9 class 1.0 = 0.078 +- 0.023 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all KL = 0.011 +- 0.023 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all L1 = 0.074 +- 0.060 (in-sample avg dev_std = 0.082)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.677
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.669
NEC for r=1.0 class 0.0 = 0.06 +- 0.028 (in-sample avg dev_std = 0.084)
NEC for r=1.0 class 1.0 = 0.081 +- 0.028 (in-sample avg dev_std = 0.084)
NEC for r=1.0 all KL = 0.013 +- 0.028 (in-sample avg dev_std = 0.084)
NEC for r=1.0 all L1 = 0.078 +- 0.063 (in-sample avg dev_std = 0.084)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:21:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:21:58 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:22:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:22:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:22:45 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:23:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.8738
Train Loss: 0.2614
ID Validation ROC-AUC: 0.8615
ID Validation Loss: 0.2740
ID Test ROC-AUC: 0.8682
ID Test Loss: 0.2722
OOD Validation ROC-AUC: 0.6586
OOD Validation Loss: 0.3252
OOD Test ROC-AUC: 0.6972
OOD Test Loss: 0.4807

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.8423
Train Loss: 0.2929
ID Validation ROC-AUC: 0.8362
ID Validation Loss: 0.2970
ID Test ROC-AUC: 0.8397
ID Test Loss: 0.2993
OOD Validation ROC-AUC: 0.6882
OOD Validation Loss: 0.2742
OOD Test ROC-AUC: 0.7207
OOD Test Loss: 0.4397

[0m[1;37mINFO[0m: [1mChartInfo 0.8682 0.6972 0.8397 0.7207 0.8362 0.6882[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:23:16 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:23:20 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:23:24 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.529
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 785
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.513
SUFF++ for r=0.3 class 0.0 = 0.926 +- 0.027 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.3 class 1.0 = 0.919 +- 0.027 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.3 all KL = 0.988 +- 0.027 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.3 all L1 = 0.919 +- 0.068 (in-sample avg dev_std = 0.101)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.658
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0.0 = 0.934 +- 0.041 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 1.0 = 0.891 +- 0.041 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all KL = 0.98 +- 0.041 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all L1 = 0.896 +- 0.084 (in-sample avg dev_std = 0.108)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.77
SUFF++ for r=0.9 class 0.0 = 0.974 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all KL = 0.996 +- 0.007 (in-sample avg dev_std = 0.057)
SUFF++ for r=0.9 all L1 = 0.964 +- 0.033 (in-sample avg dev_std = 0.057)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.591
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.555
SUFF++ for r=0.3 class 0.0 = 0.931 +- 0.022 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.3 class 1.0 = 0.922 +- 0.022 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.3 all KL = 0.99 +- 0.022 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.3 all L1 = 0.923 +- 0.062 (in-sample avg dev_std = 0.092)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
SUFF++ for r=0.6 class 0.0 = 0.942 +- 0.034 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.6 class 1.0 = 0.901 +- 0.034 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.6 all KL = 0.984 +- 0.034 (in-sample avg dev_std = 0.098)
SUFF++ for r=0.6 all L1 = 0.906 +- 0.076 (in-sample avg dev_std = 0.098)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.815
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.808
SUFF++ for r=0.9 class 0.0 = 0.976 +- 0.008 (in-sample avg dev_std = 0.062)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.008 (in-sample avg dev_std = 0.062)
SUFF++ for r=0.9 all KL = 0.996 +- 0.008 (in-sample avg dev_std = 0.062)
SUFF++ for r=0.9 all L1 = 0.963 +- 0.034 (in-sample avg dev_std = 0.062)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.493
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 776
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.499
SUFF++ for r=0.3 class 0.0 = 0.938 +- 0.020 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 class 1.0 = 0.925 +- 0.020 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 all KL = 0.991 +- 0.020 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 all L1 = 0.927 +- 0.059 (in-sample avg dev_std = 0.089)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.556
SUFF++ for r=0.6 class 0.0 = 0.936 +- 0.032 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.6 class 1.0 = 0.908 +- 0.032 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.6 all KL = 0.986 +- 0.032 (in-sample avg dev_std = 0.088)
SUFF++ for r=0.6 all L1 = 0.913 +- 0.077 (in-sample avg dev_std = 0.088)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.62
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.622
SUFF++ for r=0.9 class 0.0 = 0.97 +- 0.012 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.012 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 all KL = 0.996 +- 0.012 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.040 (in-sample avg dev_std = 0.064)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.534
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.527
NEC for r=0.3 class 0.0 = 0.054 +- 0.010 (in-sample avg dev_std = 0.056)
NEC for r=0.3 class 1.0 = 0.056 +- 0.010 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all KL = 0.005 +- 0.010 (in-sample avg dev_std = 0.056)
NEC for r=0.3 all L1 = 0.056 +- 0.047 (in-sample avg dev_std = 0.056)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.658
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
NEC for r=0.6 class 0.0 = 0.061 +- 0.026 (in-sample avg dev_std = 0.085)
NEC for r=0.6 class 1.0 = 0.082 +- 0.026 (in-sample avg dev_std = 0.085)
NEC for r=0.6 all KL = 0.012 +- 0.026 (in-sample avg dev_std = 0.085)
NEC for r=0.6 all L1 = 0.079 +- 0.062 (in-sample avg dev_std = 0.085)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.744
NEC for r=0.9 class 0.0 = 0.059 +- 0.025 (in-sample avg dev_std = 0.098)
NEC for r=0.9 class 1.0 = 0.094 +- 0.025 (in-sample avg dev_std = 0.098)
NEC for r=0.9 all KL = 0.016 +- 0.025 (in-sample avg dev_std = 0.098)
NEC for r=0.9 all L1 = 0.09 +- 0.062 (in-sample avg dev_std = 0.098)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.793
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.769
NEC for r=1.0 class 0.0 = 0.069 +- 0.028 (in-sample avg dev_std = 0.101)
NEC for r=1.0 class 1.0 = 0.097 +- 0.028 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all KL = 0.018 +- 0.028 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all L1 = 0.094 +- 0.067 (in-sample avg dev_std = 0.101)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 0.0 = 0.042 +- 0.012 (in-sample avg dev_std = 0.055)
NEC for r=0.3 class 1.0 = 0.055 +- 0.012 (in-sample avg dev_std = 0.055)
NEC for r=0.3 all KL = 0.005 +- 0.012 (in-sample avg dev_std = 0.055)
NEC for r=0.3 all L1 = 0.054 +- 0.045 (in-sample avg dev_std = 0.055)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.7
NEC for r=0.6 class 0.0 = 0.044 +- 0.018 (in-sample avg dev_std = 0.079)
NEC for r=0.6 class 1.0 = 0.078 +- 0.018 (in-sample avg dev_std = 0.079)
NEC for r=0.6 all KL = 0.009 +- 0.018 (in-sample avg dev_std = 0.079)
NEC for r=0.6 all L1 = 0.074 +- 0.056 (in-sample avg dev_std = 0.079)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.815
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.795
NEC for r=0.9 class 0.0 = 0.053 +- 0.026 (in-sample avg dev_std = 0.097)
NEC for r=0.9 class 1.0 = 0.094 +- 0.026 (in-sample avg dev_std = 0.097)
NEC for r=0.9 all KL = 0.015 +- 0.026 (in-sample avg dev_std = 0.097)
NEC for r=0.9 all L1 = 0.089 +- 0.060 (in-sample avg dev_std = 0.097)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.84
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.809
NEC for r=1.0 class 0.0 = 0.059 +- 0.032 (in-sample avg dev_std = 0.101)
NEC for r=1.0 class 1.0 = 0.1 +- 0.032 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all KL = 0.019 +- 0.032 (in-sample avg dev_std = 0.101)
NEC for r=1.0 all L1 = 0.095 +- 0.069 (in-sample avg dev_std = 0.101)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.498
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.494
NEC for r=0.3 class 0.0 = 0.051 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.3 class 1.0 = 0.053 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all KL = 0.004 +- 0.010 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all L1 = 0.053 +- 0.043 (in-sample avg dev_std = 0.052)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.58
NEC for r=0.6 class 0.0 = 0.064 +- 0.019 (in-sample avg dev_std = 0.078)
NEC for r=0.6 class 1.0 = 0.073 +- 0.019 (in-sample avg dev_std = 0.078)
NEC for r=0.6 all KL = 0.009 +- 0.019 (in-sample avg dev_std = 0.078)
NEC for r=0.6 all L1 = 0.072 +- 0.059 (in-sample avg dev_std = 0.078)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.62
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.624
NEC for r=0.9 class 0.0 = 0.075 +- 0.027 (in-sample avg dev_std = 0.093)
NEC for r=0.9 class 1.0 = 0.088 +- 0.027 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all KL = 0.014 +- 0.027 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all L1 = 0.086 +- 0.062 (in-sample avg dev_std = 0.093)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.643
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.64
NEC for r=1.0 class 0.0 = 0.079 +- 0.023 (in-sample avg dev_std = 0.095)
NEC for r=1.0 class 1.0 = 0.09 +- 0.023 (in-sample avg dev_std = 0.095)
NEC for r=1.0 all KL = 0.014 +- 0.023 (in-sample avg dev_std = 0.095)
NEC for r=1.0 all L1 = 0.088 +- 0.063 (in-sample avg dev_std = 0.095)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:26:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:26:58 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:27:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:27:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:27:45 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:28:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ROC-AUC: 0.8780
Train Loss: 0.2580
ID Validation ROC-AUC: 0.8658
ID Validation Loss: 0.2704
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.2699
OOD Validation ROC-AUC: 0.6541
OOD Validation Loss: 0.3371
OOD Test ROC-AUC: 0.6975
OOD Test Loss: 0.4828

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.8376
Train Loss: 0.2909
ID Validation ROC-AUC: 0.8335
ID Validation Loss: 0.2939
ID Test ROC-AUC: 0.8335
ID Test Loss: 0.2988
OOD Validation ROC-AUC: 0.6750
OOD Validation Loss: 0.2966
OOD Test ROC-AUC: 0.7064
OOD Test Loss: 0.4742

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.6975 0.8335 0.7064 0.8335 0.6750[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:28:16 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:28:20 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:28:25 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 784
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0.0 = 0.928 +- 0.022 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 class 1.0 = 0.931 +- 0.022 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 all KL = 0.991 +- 0.022 (in-sample avg dev_std = 0.089)
SUFF++ for r=0.3 all L1 = 0.931 +- 0.055 (in-sample avg dev_std = 0.089)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.628
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.577
SUFF++ for r=0.6 class 0.0 = 0.938 +- 0.036 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.6 class 1.0 = 0.911 +- 0.036 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.6 all KL = 0.985 +- 0.036 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.6 all L1 = 0.914 +- 0.073 (in-sample avg dev_std = 0.095)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.727
SUFF++ for r=0.9 class 0.0 = 0.976 +- 0.012 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 class 1.0 = 0.965 +- 0.012 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 all KL = 0.996 +- 0.012 (in-sample avg dev_std = 0.058)
SUFF++ for r=0.9 all L1 = 0.966 +- 0.037 (in-sample avg dev_std = 0.058)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 789
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.592
SUFF++ for r=0.3 class 0.0 = 0.934 +- 0.023 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.3 class 1.0 = 0.927 +- 0.023 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.3 all KL = 0.99 +- 0.023 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.3 all L1 = 0.927 +- 0.058 (in-sample avg dev_std = 0.095)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.674
SUFF++ for r=0.6 class 0.0 = 0.95 +- 0.042 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.6 class 1.0 = 0.911 +- 0.042 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.6 all KL = 0.985 +- 0.042 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.6 all L1 = 0.916 +- 0.072 (in-sample avg dev_std = 0.094)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.816
SUFF++ for r=0.9 class 0.0 = 0.982 +- 0.009 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 class 1.0 = 0.966 +- 0.009 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 all KL = 0.997 +- 0.009 (in-sample avg dev_std = 0.055)
SUFF++ for r=0.9 all L1 = 0.968 +- 0.033 (in-sample avg dev_std = 0.055)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.524
SUFF++ for r=0.3 class 0.0 = 0.937 +- 0.018 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.3 class 1.0 = 0.932 +- 0.018 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.3 all KL = 0.992 +- 0.018 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.3 all L1 = 0.933 +- 0.055 (in-sample avg dev_std = 0.085)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.574
SUFF++ for r=0.6 class 0.0 = 0.944 +- 0.028 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.6 class 1.0 = 0.928 +- 0.028 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.6 all KL = 0.991 +- 0.028 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.6 all L1 = 0.931 +- 0.064 (in-sample avg dev_std = 0.070)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.629
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.628
SUFF++ for r=0.9 class 0.0 = 0.979 +- 0.009 (in-sample avg dev_std = 0.047)
SUFF++ for r=0.9 class 1.0 = 0.969 +- 0.009 (in-sample avg dev_std = 0.047)
SUFF++ for r=0.9 all KL = 0.997 +- 0.009 (in-sample avg dev_std = 0.047)
SUFF++ for r=0.9 all L1 = 0.971 +- 0.033 (in-sample avg dev_std = 0.047)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.556
NEC for r=0.3 class 0.0 = 0.051 +- 0.010 (in-sample avg dev_std = 0.049)
NEC for r=0.3 class 1.0 = 0.049 +- 0.010 (in-sample avg dev_std = 0.049)
NEC for r=0.3 all KL = 0.004 +- 0.010 (in-sample avg dev_std = 0.049)
NEC for r=0.3 all L1 = 0.049 +- 0.040 (in-sample avg dev_std = 0.049)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.628
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.601
NEC for r=0.6 class 0.0 = 0.055 +- 0.022 (in-sample avg dev_std = 0.075)
NEC for r=0.6 class 1.0 = 0.07 +- 0.022 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all KL = 0.009 +- 0.022 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all L1 = 0.068 +- 0.056 (in-sample avg dev_std = 0.075)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.738
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.703
NEC for r=0.9 class 0.0 = 0.062 +- 0.043 (in-sample avg dev_std = 0.103)
NEC for r=0.9 class 1.0 = 0.089 +- 0.043 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all KL = 0.019 +- 0.043 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all L1 = 0.086 +- 0.068 (in-sample avg dev_std = 0.103)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.77
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.735
NEC for r=1.0 class 0.0 = 0.06 +- 0.039 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 1.0 = 0.092 +- 0.039 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all KL = 0.02 +- 0.039 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all L1 = 0.089 +- 0.068 (in-sample avg dev_std = 0.102)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.649
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0.0 = 0.04 +- 0.013 (in-sample avg dev_std = 0.052)
NEC for r=0.3 class 1.0 = 0.051 +- 0.013 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all KL = 0.004 +- 0.013 (in-sample avg dev_std = 0.052)
NEC for r=0.3 all L1 = 0.05 +- 0.043 (in-sample avg dev_std = 0.052)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.703
NEC for r=0.6 class 0.0 = 0.04 +- 0.020 (in-sample avg dev_std = 0.067)
NEC for r=0.6 class 1.0 = 0.068 +- 0.020 (in-sample avg dev_std = 0.067)
NEC for r=0.6 all KL = 0.008 +- 0.020 (in-sample avg dev_std = 0.067)
NEC for r=0.6 all L1 = 0.065 +- 0.053 (in-sample avg dev_std = 0.067)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.793
NEC for r=0.9 class 0.0 = 0.041 +- 0.027 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.085 +- 0.027 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.014 +- 0.027 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.08 +- 0.063 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.834
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.812
NEC for r=1.0 class 0.0 = 0.044 +- 0.030 (in-sample avg dev_std = 0.094)
NEC for r=1.0 class 1.0 = 0.088 +- 0.030 (in-sample avg dev_std = 0.094)
NEC for r=1.0 all KL = 0.016 +- 0.030 (in-sample avg dev_std = 0.094)
NEC for r=1.0 all L1 = 0.083 +- 0.064 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.506
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.506
NEC for r=0.3 class 0.0 = 0.046 +- 0.012 (in-sample avg dev_std = 0.048)
NEC for r=0.3 class 1.0 = 0.047 +- 0.012 (in-sample avg dev_std = 0.048)
NEC for r=0.3 all KL = 0.003 +- 0.012 (in-sample avg dev_std = 0.048)
NEC for r=0.3 all L1 = 0.047 +- 0.039 (in-sample avg dev_std = 0.048)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.581
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.572
NEC for r=0.6 class 0.0 = 0.052 +- 0.022 (in-sample avg dev_std = 0.065)
NEC for r=0.6 class 1.0 = 0.061 +- 0.022 (in-sample avg dev_std = 0.065)
NEC for r=0.6 all KL = 0.007 +- 0.022 (in-sample avg dev_std = 0.065)
NEC for r=0.6 all L1 = 0.06 +- 0.053 (in-sample avg dev_std = 0.065)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.629
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.617
NEC for r=0.9 class 0.0 = 0.058 +- 0.022 (in-sample avg dev_std = 0.079)
NEC for r=0.9 class 1.0 = 0.074 +- 0.022 (in-sample avg dev_std = 0.079)
NEC for r=0.9 all KL = 0.01 +- 0.022 (in-sample avg dev_std = 0.079)
NEC for r=0.9 all L1 = 0.071 +- 0.054 (in-sample avg dev_std = 0.079)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.645
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.635
NEC for r=1.0 class 0.0 = 0.059 +- 0.027 (in-sample avg dev_std = 0.088)
NEC for r=1.0 class 1.0 = 0.082 +- 0.027 (in-sample avg dev_std = 0.088)
NEC for r=1.0 all KL = 0.013 +- 0.027 (in-sample avg dev_std = 0.088)
NEC for r=1.0 all L1 = 0.078 +- 0.063 (in-sample avg dev_std = 0.088)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:32:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:32:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:32:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:32:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:32:48 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:33:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ROC-AUC: 0.8730
Train Loss: 0.2780
ID Validation ROC-AUC: 0.8609
ID Validation Loss: 0.2919
ID Test ROC-AUC: 0.8676
ID Test Loss: 0.2896
OOD Validation ROC-AUC: 0.6597
OOD Validation Loss: 0.3333
OOD Test ROC-AUC: 0.6972
OOD Test Loss: 0.5175

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 40...
[0m[1;37mINFO[0m: [1mCheckpoint 40: 
-----------------------------------
Train ROC-AUC: 0.8484
Train Loss: 0.2820
ID Validation ROC-AUC: 0.8380
ID Validation Loss: 0.2876
ID Test ROC-AUC: 0.8388
ID Test Loss: 0.2910
OOD Validation ROC-AUC: 0.6868
OOD Validation Loss: 0.2801
OOD Test ROC-AUC: 0.6854
OOD Test Loss: 0.4567

[0m[1;37mINFO[0m: [1mChartInfo 0.8676 0.6972 0.8388 0.6854 0.8380 0.6868[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:33:20 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:33:24 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:33:28 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.669
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.613
SUFF++ for r=0.3 class 0.0 = 0.928 +- 0.042 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.3 class 1.0 = 0.91 +- 0.042 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.3 all KL = 0.983 +- 0.042 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.3 all L1 = 0.912 +- 0.078 (in-sample avg dev_std = 0.118)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.725
SUFF++ for r=0.6 class 0.0 = 0.931 +- 0.048 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.6 class 1.0 = 0.885 +- 0.048 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.6 all KL = 0.976 +- 0.048 (in-sample avg dev_std = 0.115)
SUFF++ for r=0.6 all L1 = 0.891 +- 0.087 (in-sample avg dev_std = 0.115)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.819
SUFF++ for r=0.9 class 0.0 = 0.975 +- 0.013 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.9 class 1.0 = 0.96 +- 0.013 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.9 all KL = 0.995 +- 0.013 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.039 (in-sample avg dev_std = 0.065)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.712
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 780
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.64
SUFF++ for r=0.3 class 0.0 = 0.917 +- 0.033 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 class 1.0 = 0.906 +- 0.033 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 all KL = 0.983 +- 0.033 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 all L1 = 0.907 +- 0.077 (in-sample avg dev_std = 0.119)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.804
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.762
SUFF++ for r=0.6 class 0.0 = 0.942 +- 0.049 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.6 class 1.0 = 0.884 +- 0.049 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.6 all KL = 0.976 +- 0.049 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.6 all L1 = 0.891 +- 0.083 (in-sample avg dev_std = 0.118)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.854
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.853
SUFF++ for r=0.9 class 0.0 = 0.973 +- 0.014 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.014 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.9 all KL = 0.995 +- 0.014 (in-sample avg dev_std = 0.065)
SUFF++ for r=0.9 all L1 = 0.963 +- 0.039 (in-sample avg dev_std = 0.065)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.573
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 785
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0.0 = 0.927 +- 0.035 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.3 class 1.0 = 0.915 +- 0.035 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.3 all KL = 0.986 +- 0.035 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.3 all L1 = 0.917 +- 0.070 (in-sample avg dev_std = 0.109)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.628
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.606
SUFF++ for r=0.6 class 0.0 = 0.92 +- 0.034 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.6 class 1.0 = 0.904 +- 0.034 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.6 all KL = 0.984 +- 0.034 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.6 all L1 = 0.907 +- 0.075 (in-sample avg dev_std = 0.092)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.657
SUFF++ for r=0.9 class 0.0 = 0.966 +- 0.009 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.009 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 all KL = 0.996 +- 0.009 (in-sample avg dev_std = 0.064)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.038 (in-sample avg dev_std = 0.064)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.669
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.67
NEC for r=0.3 class 0.0 = 0.051 +- 0.025 (in-sample avg dev_std = 0.068)
NEC for r=0.3 class 1.0 = 0.063 +- 0.025 (in-sample avg dev_std = 0.068)
NEC for r=0.3 all KL = 0.008 +- 0.025 (in-sample avg dev_std = 0.068)
NEC for r=0.3 all L1 = 0.062 +- 0.059 (in-sample avg dev_std = 0.068)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.758
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.751
NEC for r=0.6 class 0.0 = 0.061 +- 0.033 (in-sample avg dev_std = 0.091)
NEC for r=0.6 class 1.0 = 0.088 +- 0.033 (in-sample avg dev_std = 0.091)
NEC for r=0.6 all KL = 0.014 +- 0.033 (in-sample avg dev_std = 0.091)
NEC for r=0.6 all L1 = 0.085 +- 0.065 (in-sample avg dev_std = 0.091)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.813
NEC for r=0.9 class 0.0 = 0.07 +- 0.033 (in-sample avg dev_std = 0.098)
NEC for r=0.9 class 1.0 = 0.094 +- 0.033 (in-sample avg dev_std = 0.098)
NEC for r=0.9 all KL = 0.019 +- 0.033 (in-sample avg dev_std = 0.098)
NEC for r=0.9 all L1 = 0.092 +- 0.068 (in-sample avg dev_std = 0.098)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.839
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.831
NEC for r=1.0 class 0.0 = 0.07 +- 0.037 (in-sample avg dev_std = 0.097)
NEC for r=1.0 class 1.0 = 0.093 +- 0.037 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all KL = 0.02 +- 0.037 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all L1 = 0.09 +- 0.069 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.721
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.718
NEC for r=0.3 class 0.0 = 0.047 +- 0.017 (in-sample avg dev_std = 0.069)
NEC for r=0.3 class 1.0 = 0.065 +- 0.017 (in-sample avg dev_std = 0.069)
NEC for r=0.3 all KL = 0.007 +- 0.017 (in-sample avg dev_std = 0.069)
NEC for r=0.3 all L1 = 0.063 +- 0.055 (in-sample avg dev_std = 0.069)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.804
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.797
NEC for r=0.6 class 0.0 = 0.052 +- 0.019 (in-sample avg dev_std = 0.083)
NEC for r=0.6 class 1.0 = 0.084 +- 0.019 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all KL = 0.011 +- 0.019 (in-sample avg dev_std = 0.083)
NEC for r=0.6 all L1 = 0.08 +- 0.055 (in-sample avg dev_std = 0.083)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.854
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.844
NEC for r=0.9 class 0.0 = 0.059 +- 0.026 (in-sample avg dev_std = 0.094)
NEC for r=0.9 class 1.0 = 0.088 +- 0.026 (in-sample avg dev_std = 0.094)
NEC for r=0.9 all KL = 0.016 +- 0.026 (in-sample avg dev_std = 0.094)
NEC for r=0.9 all L1 = 0.085 +- 0.059 (in-sample avg dev_std = 0.094)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.869
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.855
NEC for r=1.0 class 0.0 = 0.065 +- 0.029 (in-sample avg dev_std = 0.097)
NEC for r=1.0 class 1.0 = 0.088 +- 0.029 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all KL = 0.017 +- 0.029 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all L1 = 0.085 +- 0.062 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.577
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.568
NEC for r=0.3 class 0.0 = 0.049 +- 0.018 (in-sample avg dev_std = 0.062)
NEC for r=0.3 class 1.0 = 0.06 +- 0.018 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all KL = 0.006 +- 0.018 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all L1 = 0.058 +- 0.050 (in-sample avg dev_std = 0.062)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.628
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.613
NEC for r=0.6 class 0.0 = 0.069 +- 0.021 (in-sample avg dev_std = 0.080)
NEC for r=0.6 class 1.0 = 0.077 +- 0.021 (in-sample avg dev_std = 0.080)
NEC for r=0.6 all KL = 0.01 +- 0.021 (in-sample avg dev_std = 0.080)
NEC for r=0.6 all L1 = 0.076 +- 0.059 (in-sample avg dev_std = 0.080)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.662
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.645
NEC for r=0.9 class 0.0 = 0.074 +- 0.020 (in-sample avg dev_std = 0.086)
NEC for r=0.9 class 1.0 = 0.088 +- 0.020 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all KL = 0.013 +- 0.020 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all L1 = 0.085 +- 0.060 (in-sample avg dev_std = 0.086)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.664
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.653
NEC for r=1.0 class 0.0 = 0.078 +- 0.024 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.091 +- 0.024 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.015 +- 0.024 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.089 +- 0.065 (in-sample avg dev_std = 0.091)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.991, 0.979, 0.995, 1.0], 'all_L1': [0.929, 0.901, 0.959, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.979, 0.996, 1.0], 'all_L1': [0.93, 0.904, 0.966, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 0.98, 0.996, 1.0], 'all_L1': [0.919, 0.896, 0.964, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.985, 0.996, 1.0], 'all_L1': [0.931, 0.914, 0.966, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.983, 0.976, 0.995, 1.0], 'all_L1': [0.912, 0.891, 0.962, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.004, 0.012, 0.02, 0.023], 'all_L1': [0.05, 0.077, 0.097, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.009, 0.018, 0.019], 'all_L1': [0.049, 0.069, 0.087, 0.087]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.012, 0.016, 0.018], 'all_L1': [0.056, 0.079, 0.09, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.009, 0.019, 0.02], 'all_L1': [0.049, 0.068, 0.086, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.014, 0.019, 0.02], 'all_L1': [0.062, 0.085, 0.092, 0.09]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.99, 0.978, 0.995, 1.0], 'all_L1': [0.927, 0.9, 0.96, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.983, 0.996, 1.0], 'all_L1': [0.928, 0.908, 0.964, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.984, 0.996, 1.0], 'all_L1': [0.923, 0.906, 0.963, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.99, 0.985, 0.997, 1.0], 'all_L1': [0.927, 0.916, 0.968, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.983, 0.976, 0.995, 1.0], 'all_L1': [0.907, 0.891, 0.963, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.004, 0.011, 0.019, 0.021], 'all_L1': [0.05, 0.076, 0.092, 0.095]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.008, 0.014, 0.017], 'all_L1': [0.048, 0.068, 0.081, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.009, 0.015, 0.019], 'all_L1': [0.054, 0.074, 0.089, 0.095]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.008, 0.014, 0.016], 'all_L1': [0.05, 0.065, 0.08, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.007, 0.011, 0.016, 0.017], 'all_L1': [0.063, 0.08, 0.085, 0.085]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.99, 0.986, 0.996, 1.0], 'all_L1': [0.928, 0.917, 0.965, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.992, 0.987, 0.996, 1.0], 'all_L1': [0.935, 0.92, 0.967, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.991, 0.986, 0.996, 1.0], 'all_L1': [0.927, 0.913, 0.962, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.992, 0.991, 0.997, 1.0], 'all_L1': [0.933, 0.931, 0.971, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.984, 0.996, 1.0], 'all_L1': [0.917, 0.907, 0.962, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.004, 0.01, 0.013, 0.016], 'all_L1': [0.053, 0.072, 0.084, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.007, 0.011, 0.013], 'all_L1': [0.046, 0.063, 0.074, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.009, 0.014, 0.014], 'all_L1': [0.053, 0.072, 0.086, 0.088]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.007, 0.01, 0.013], 'all_L1': [0.047, 0.06, 0.071, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.01, 0.013, 0.015], 'all_L1': [0.058, 0.076, 0.085, 0.089]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.924 +- 0.007, 0.901 +- 0.008, 0.963 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.989 +- 0.003, 0.980 +- 0.003, 0.996 +- 0.000, 1.000 +- 0.000
suff++_acc_int  =  0.565 +- 0.037, 0.653 +- 0.053, 0.784 +- 0.033
nec class all_L1  =  0.053 +- 0.005, 0.076 +- 0.006, 0.090 +- 0.004, 0.092 +- 0.005
nec class all_KL  =  0.005 +- 0.002, 0.011 +- 0.002, 0.018 +- 0.001, 0.020 +- 0.002
nec_acc_int  =  0.594 +- 0.050, 0.677 +- 0.052, 0.764 +- 0.038, 0.787 +- 0.033

Eval split id_test
suff++ class all_L1  =  0.922 +- 0.008, 0.904 +- 0.008, 0.964 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.989 +- 0.003, 0.981 +- 0.004, 0.996 +- 0.001, 1.000 +- 0.000
suff++_acc_int  =  0.602 +- 0.028, 0.705 +- 0.033, 0.831 +- 0.017
nec class all_L1  =  0.053 +- 0.005, 0.073 +- 0.005, 0.085 +- 0.005, 0.089 +- 0.005
nec class all_KL  =  0.005 +- 0.001, 0.009 +- 0.001, 0.016 +- 0.002, 0.018 +- 0.002
nec_acc_int  =  0.646 +- 0.043, 0.736 +- 0.036, 0.816 +- 0.019, 0.833 +- 0.019

Eval split test
suff++ class all_L1  =  0.928 +- 0.006, 0.918 +- 0.008, 0.965 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.990 +- 0.002, 0.987 +- 0.002, 0.996 +- 0.000, 1.000 +- 0.000
suff++_acc_int  =  0.541 +- 0.026, 0.591 +- 0.023, 0.650 +- 0.022
nec class all_L1  =  0.051 +- 0.004, 0.069 +- 0.006, 0.080 +- 0.006, 0.085 +- 0.005
nec class all_KL  =  0.004 +- 0.001, 0.009 +- 0.001, 0.012 +- 0.001, 0.014 +- 0.001
nec_acc_int  =  0.545 +- 0.037, 0.601 +- 0.020, 0.642 +- 0.020, 0.657 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.489 +- 0.001, 0.488 +- 0.002, 0.527 +- 0.001, 0.546 +- 0.002
Faith. Armon (L1)= 		  =  0.101 +- 0.009, 0.139 +- 0.011, 0.165 +- 0.007, 0.168 +- 0.008
Faith. GMean (L1)= 	  =  0.221 +- 0.010, 0.261 +- 0.010, 0.295 +- 0.006, 0.303 +- 0.008
Faith. Aritm (KL)= 		  =  0.497 +- 0.001, 0.495 +- 0.001, 0.507 +- 0.001, 0.510 +- 0.001
Faith. Armon (KL)= 		  =  0.010 +- 0.003, 0.022 +- 0.004, 0.036 +- 0.003, 0.039 +- 0.003
Faith. GMean (KL)= 	  =  0.070 +- 0.010, 0.104 +- 0.009, 0.135 +- 0.005, 0.141 +- 0.006

Eval split id_test
Faith. Aritm (L1)= 		  =  0.488 +- 0.001, 0.488 +- 0.002, 0.525 +- 0.001, 0.544 +- 0.003
Faith. Armon (L1)= 		  =  0.100 +- 0.009, 0.134 +- 0.009, 0.157 +- 0.008, 0.163 +- 0.009
Faith. GMean (L1)= 	  =  0.221 +- 0.010, 0.256 +- 0.008, 0.287 +- 0.007, 0.298 +- 0.009
Faith. Aritm (KL)= 		  =  0.497 +- 0.001, 0.495 +- 0.001, 0.506 +- 0.001, 0.509 +- 0.001
Faith. Armon (KL)= 		  =  0.010 +- 0.002, 0.019 +- 0.003, 0.031 +- 0.004, 0.035 +- 0.003
Faith. GMean (KL)= 	  =  0.068 +- 0.008, 0.096 +- 0.007, 0.124 +- 0.007, 0.134 +- 0.007

Eval split test
Faith. Aritm (L1)= 		  =  0.490 +- 0.001, 0.493 +- 0.002, 0.523 +- 0.002, 0.542 +- 0.003
Faith. Armon (L1)= 		  =  0.097 +- 0.008, 0.128 +- 0.010, 0.148 +- 0.011, 0.156 +- 0.009
Faith. GMean (L1)= 	  =  0.218 +- 0.009, 0.251 +- 0.010, 0.278 +- 0.010, 0.291 +- 0.009
Faith. Aritm (KL)= 		  =  0.497 +- 0.001, 0.498 +- 0.001, 0.504 +- 0.001, 0.507 +- 0.001
Faith. Armon (KL)= 		  =  0.008 +- 0.002, 0.017 +- 0.003, 0.024 +- 0.003, 0.028 +- 0.002
Faith. GMean (KL)= 	  =  0.062 +- 0.008, 0.092 +- 0.007, 0.110 +- 0.007, 0.119 +- 0.005
Computed for split load_split = id



Completed in  0:25:19.507805  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:37:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:37:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:37:54 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:14 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:38:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ROC-AUC: 0.9439
Train Loss: 0.1989
ID Validation ROC-AUC: 0.9088
ID Validation Loss: 0.2679
ID Test ROC-AUC: 0.9114
ID Test Loss: 0.2669
OOD Validation ROC-AUC: 0.6523
OOD Validation Loss: 0.4368
OOD Test ROC-AUC: 0.7046
OOD Test Loss: 0.6058

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.8706
Train Loss: 0.2677
ID Validation ROC-AUC: 0.8607
ID Validation Loss: 0.2758
ID Test ROC-AUC: 0.8635
ID Test Loss: 0.2778
OOD Validation ROC-AUC: 0.6896
OOD Validation Loss: 0.2864
OOD Test ROC-AUC: 0.7178
OOD Test Loss: 0.4374

[0m[1;37mINFO[0m: [1mChartInfo 0.9114 0.7046 0.8635 0.7178 0.8607 0.6896[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:38:47 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:38:53 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:38:57 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.709
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 789
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.61
SUFF++ for r=0.3 class 0.0 = 0.822 +- 0.116 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 class 1.0 = 0.789 +- 0.116 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 all KL = 0.915 +- 0.116 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.3 all L1 = 0.793 +- 0.124 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.833
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.755
SUFF++ for r=0.6 class 0.0 = 0.842 +- 0.149 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 class 1.0 = 0.79 +- 0.149 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all KL = 0.884 +- 0.149 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.6 all L1 = 0.796 +- 0.141 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.884
SUFF++ for r=0.9 class 0.0 = 0.939 +- 0.035 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 class 1.0 = 0.956 +- 0.035 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 all KL = 0.987 +- 0.035 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.060 (in-sample avg dev_std = 0.092)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.721
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
SUFF++ for r=0.3 class 0.0 = 0.854 +- 0.119 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 class 1.0 = 0.785 +- 0.119 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all KL = 0.915 +- 0.119 (in-sample avg dev_std = 0.250)
SUFF++ for r=0.3 all L1 = 0.793 +- 0.124 (in-sample avg dev_std = 0.250)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.782
SUFF++ for r=0.6 class 0.0 = 0.853 +- 0.139 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 class 1.0 = 0.802 +- 0.139 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 all KL = 0.895 +- 0.139 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 all L1 = 0.808 +- 0.134 (in-sample avg dev_std = 0.240)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.899
SUFF++ for r=0.9 class 0.0 = 0.943 +- 0.020 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 class 1.0 = 0.959 +- 0.020 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 all KL = 0.991 +- 0.020 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 all L1 = 0.958 +- 0.055 (in-sample avg dev_std = 0.082)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.556
SUFF++ for r=0.3 class 0.0 = 0.84 +- 0.091 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 class 1.0 = 0.811 +- 0.091 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 all KL = 0.934 +- 0.091 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.3 all L1 = 0.815 +- 0.116 (in-sample avg dev_std = 0.224)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.694
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.664
SUFF++ for r=0.6 class 0.0 = 0.86 +- 0.107 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 class 1.0 = 0.82 +- 0.107 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 all KL = 0.928 +- 0.107 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.6 all L1 = 0.827 +- 0.119 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.033 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.033 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 all KL = 0.986 +- 0.033 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.063 (in-sample avg dev_std = 0.107)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.703
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.678
NEC for r=0.3 class 0.0 = 0.115 +- 0.055 (in-sample avg dev_std = 0.143)
NEC for r=0.3 class 1.0 = 0.146 +- 0.055 (in-sample avg dev_std = 0.143)
NEC for r=0.3 all KL = 0.036 +- 0.055 (in-sample avg dev_std = 0.143)
NEC for r=0.3 all L1 = 0.142 +- 0.092 (in-sample avg dev_std = 0.143)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.833
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.805
NEC for r=0.6 class 0.0 = 0.128 +- 0.088 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 1.0 = 0.139 +- 0.088 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all KL = 0.055 +- 0.088 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all L1 = 0.138 +- 0.110 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.852
NEC for r=0.9 class 0.0 = 0.154 +- 0.098 (in-sample avg dev_std = 0.179)
NEC for r=0.9 class 1.0 = 0.101 +- 0.098 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all KL = 0.053 +- 0.098 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all L1 = 0.107 +- 0.112 (in-sample avg dev_std = 0.179)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.86
NEC for r=1.0 class 0.0 = 0.169 +- 0.107 (in-sample avg dev_std = 0.180)
NEC for r=1.0 class 1.0 = 0.096 +- 0.107 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all KL = 0.055 +- 0.107 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all L1 = 0.105 +- 0.119 (in-sample avg dev_std = 0.180)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.727
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.701
NEC for r=0.3 class 0.0 = 0.103 +- 0.060 (in-sample avg dev_std = 0.142)
NEC for r=0.3 class 1.0 = 0.147 +- 0.060 (in-sample avg dev_std = 0.142)
NEC for r=0.3 all KL = 0.036 +- 0.060 (in-sample avg dev_std = 0.142)
NEC for r=0.3 all L1 = 0.142 +- 0.092 (in-sample avg dev_std = 0.142)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.824
NEC for r=0.6 class 0.0 = 0.095 +- 0.072 (in-sample avg dev_std = 0.167)
NEC for r=0.6 class 1.0 = 0.133 +- 0.072 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all KL = 0.047 +- 0.072 (in-sample avg dev_std = 0.167)
NEC for r=0.6 all L1 = 0.128 +- 0.101 (in-sample avg dev_std = 0.167)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.883
NEC for r=0.9 class 0.0 = 0.128 +- 0.084 (in-sample avg dev_std = 0.162)
NEC for r=0.9 class 1.0 = 0.096 +- 0.084 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all KL = 0.046 +- 0.084 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all L1 = 0.1 +- 0.107 (in-sample avg dev_std = 0.162)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.907
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.886
NEC for r=1.0 class 0.0 = 0.137 +- 0.098 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 1.0 = 0.093 +- 0.098 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all KL = 0.051 +- 0.098 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all L1 = 0.098 +- 0.115 (in-sample avg dev_std = 0.175)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.594
NEC for r=0.3 class 0.0 = 0.108 +- 0.050 (in-sample avg dev_std = 0.129)
NEC for r=0.3 class 1.0 = 0.138 +- 0.050 (in-sample avg dev_std = 0.129)
NEC for r=0.3 all KL = 0.03 +- 0.050 (in-sample avg dev_std = 0.129)
NEC for r=0.3 all L1 = 0.133 +- 0.091 (in-sample avg dev_std = 0.129)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.694
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.684
NEC for r=0.6 class 0.0 = 0.124 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.6 class 1.0 = 0.14 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all KL = 0.043 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all L1 = 0.137 +- 0.099 (in-sample avg dev_std = 0.162)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.699
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0.0 = 0.146 +- 0.096 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 1.0 = 0.14 +- 0.096 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all KL = 0.06 +- 0.096 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all L1 = 0.141 +- 0.114 (in-sample avg dev_std = 0.192)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.7
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.692
NEC for r=1.0 class 0.0 = 0.159 +- 0.096 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1.0 = 0.139 +- 0.096 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.062 +- 0.096 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.142 +- 0.120 (in-sample avg dev_std = 0.205)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:42:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:42:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:43:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9399
Train Loss: 0.2261
ID Validation ROC-AUC: 0.9061
ID Validation Loss: 0.2987
ID Test ROC-AUC: 0.9090
ID Test Loss: 0.2986
OOD Validation ROC-AUC: 0.6658
OOD Validation Loss: 0.4290
OOD Test ROC-AUC: 0.7104
OOD Test Loss: 0.6511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.8859
Train Loss: 0.2578
ID Validation ROC-AUC: 0.8790
ID Validation Loss: 0.2641
ID Test ROC-AUC: 0.8829
ID Test Loss: 0.2664
OOD Validation ROC-AUC: 0.6931
OOD Validation Loss: 0.2867
OOD Test ROC-AUC: 0.7206
OOD Test Loss: 0.4491

[0m[1;37mINFO[0m: [1mChartInfo 0.9090 0.7104 0.8829 0.7206 0.8790 0.6931[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:43:59 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:44:03 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:44:07 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.592
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.557
SUFF++ for r=0.3 class 0.0 = 0.842 +- 0.082 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.3 class 1.0 = 0.816 +- 0.082 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.3 all KL = 0.942 +- 0.082 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.3 all L1 = 0.819 +- 0.090 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.731
SUFF++ for r=0.6 class 0.0 = 0.877 +- 0.130 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 class 1.0 = 0.798 +- 0.130 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all KL = 0.9 +- 0.130 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.130 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.887
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.043 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 class 1.0 = 0.955 +- 0.043 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 all KL = 0.987 +- 0.043 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.063 (in-sample avg dev_std = 0.097)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 782
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.606
SUFF++ for r=0.3 class 0.0 = 0.841 +- 0.076 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.3 class 1.0 = 0.819 +- 0.076 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.3 all KL = 0.945 +- 0.076 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.3 all L1 = 0.822 +- 0.096 (in-sample avg dev_std = 0.207)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.843
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.761
SUFF++ for r=0.6 class 0.0 = 0.873 +- 0.138 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.6 class 1.0 = 0.799 +- 0.138 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.6 all KL = 0.9 +- 0.138 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.125 (in-sample avg dev_std = 0.225)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.903
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.897
SUFF++ for r=0.9 class 0.0 = 0.95 +- 0.042 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.042 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 all KL = 0.987 +- 0.042 (in-sample avg dev_std = 0.097)
SUFF++ for r=0.9 all L1 = 0.952 +- 0.063 (in-sample avg dev_std = 0.097)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.569
SUFF++ for r=0.3 class 0.0 = 0.84 +- 0.066 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.3 class 1.0 = 0.83 +- 0.066 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.3 all KL = 0.952 +- 0.066 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.3 all L1 = 0.831 +- 0.089 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.614
SUFF++ for r=0.6 class 0.0 = 0.874 +- 0.109 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.6 class 1.0 = 0.824 +- 0.109 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.6 all KL = 0.935 +- 0.109 (in-sample avg dev_std = 0.193)
SUFF++ for r=0.6 all L1 = 0.832 +- 0.113 (in-sample avg dev_std = 0.193)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.69
SUFF++ for r=0.9 class 0.0 = 0.945 +- 0.043 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 1.0 = 0.934 +- 0.043 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all KL = 0.984 +- 0.043 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all L1 = 0.935 +- 0.072 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.594
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 0.0 = 0.101 +- 0.042 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 1.0 = 0.131 +- 0.042 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all KL = 0.027 +- 0.042 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all L1 = 0.128 +- 0.081 (in-sample avg dev_std = 0.127)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.778
NEC for r=0.6 class 0.0 = 0.106 +- 0.068 (in-sample avg dev_std = 0.163)
NEC for r=0.6 class 1.0 = 0.13 +- 0.068 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all KL = 0.044 +- 0.068 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all L1 = 0.127 +- 0.094 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.896
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.863
NEC for r=0.9 class 0.0 = 0.153 +- 0.097 (in-sample avg dev_std = 0.174)
NEC for r=0.9 class 1.0 = 0.102 +- 0.097 (in-sample avg dev_std = 0.174)
NEC for r=0.9 all KL = 0.052 +- 0.097 (in-sample avg dev_std = 0.174)
NEC for r=0.9 all L1 = 0.108 +- 0.111 (in-sample avg dev_std = 0.174)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0.0 = 0.156 +- 0.108 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1.0 = 0.096 +- 0.108 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.052 +- 0.108 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.103 +- 0.113 (in-sample avg dev_std = 0.173)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.682
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.671
NEC for r=0.3 class 0.0 = 0.096 +- 0.046 (in-sample avg dev_std = 0.126)
NEC for r=0.3 class 1.0 = 0.132 +- 0.046 (in-sample avg dev_std = 0.126)
NEC for r=0.3 all KL = 0.026 +- 0.046 (in-sample avg dev_std = 0.126)
NEC for r=0.3 all L1 = 0.128 +- 0.078 (in-sample avg dev_std = 0.126)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.843
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.813
NEC for r=0.6 class 0.0 = 0.093 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.6 class 1.0 = 0.134 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all KL = 0.045 +- 0.072 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all L1 = 0.129 +- 0.095 (in-sample avg dev_std = 0.162)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.903
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.878
NEC for r=0.9 class 0.0 = 0.114 +- 0.083 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 1.0 = 0.105 +- 0.083 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all KL = 0.047 +- 0.083 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all L1 = 0.106 +- 0.106 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.884
NEC for r=1.0 class 0.0 = 0.12 +- 0.100 (in-sample avg dev_std = 0.169)
NEC for r=1.0 class 1.0 = 0.099 +- 0.100 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all KL = 0.051 +- 0.100 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all L1 = 0.101 +- 0.110 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.59
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.586
NEC for r=0.3 class 0.0 = 0.107 +- 0.052 (in-sample avg dev_std = 0.118)
NEC for r=0.3 class 1.0 = 0.124 +- 0.052 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all KL = 0.024 +- 0.052 (in-sample avg dev_std = 0.118)
NEC for r=0.3 all L1 = 0.121 +- 0.078 (in-sample avg dev_std = 0.118)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.645
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.629
NEC for r=0.6 class 0.0 = 0.117 +- 0.076 (in-sample avg dev_std = 0.151)
NEC for r=0.6 class 1.0 = 0.134 +- 0.076 (in-sample avg dev_std = 0.151)
NEC for r=0.6 all KL = 0.039 +- 0.076 (in-sample avg dev_std = 0.151)
NEC for r=0.6 all L1 = 0.131 +- 0.099 (in-sample avg dev_std = 0.151)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.693
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0.0 = 0.127 +- 0.099 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.144 +- 0.099 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.057 +- 0.099 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.141 +- 0.116 (in-sample avg dev_std = 0.194)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.713
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.689
NEC for r=1.0 class 0.0 = 0.142 +- 0.100 (in-sample avg dev_std = 0.197)
NEC for r=1.0 class 1.0 = 0.142 +- 0.100 (in-sample avg dev_std = 0.197)
NEC for r=1.0 all KL = 0.06 +- 0.100 (in-sample avg dev_std = 0.197)
NEC for r=1.0 all L1 = 0.142 +- 0.117 (in-sample avg dev_std = 0.197)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:47:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:47:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:48:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:48:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:48:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:48:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:49:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ROC-AUC: 0.9501
Train Loss: 0.2206
ID Validation ROC-AUC: 0.9123
ID Validation Loss: 0.3004
ID Test ROC-AUC: 0.9153
ID Test Loss: 0.3028
OOD Validation ROC-AUC: 0.6581
OOD Validation Loss: 0.4240
OOD Test ROC-AUC: 0.7112
OOD Test Loss: 0.6431

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ROC-AUC: 0.9069
Train Loss: 0.2492
ID Validation ROC-AUC: 0.8927
ID Validation Loss: 0.2644
ID Test ROC-AUC: 0.8942
ID Test Loss: 0.2687
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.3065
OOD Test ROC-AUC: 0.7241
OOD Test Loss: 0.4812

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.7112 0.8942 0.7241 0.8927 0.6866[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:49:05 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:49:09 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:49:13 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.671
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 785
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0.0 = 0.804 +- 0.105 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 1.0 = 0.793 +- 0.105 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 all KL = 0.92 +- 0.105 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 all L1 = 0.794 +- 0.103 (in-sample avg dev_std = 0.235)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.858
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.766
SUFF++ for r=0.6 class 0.0 = 0.822 +- 0.131 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 class 1.0 = 0.791 +- 0.131 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all KL = 0.89 +- 0.131 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all L1 = 0.795 +- 0.130 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.905
SUFF++ for r=0.9 class 0.0 = 0.945 +- 0.035 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.035 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.9 all KL = 0.986 +- 0.035 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.9 all L1 = 0.951 +- 0.064 (in-sample avg dev_std = 0.101)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.693
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.631
SUFF++ for r=0.3 class 0.0 = 0.815 +- 0.103 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 class 1.0 = 0.782 +- 0.103 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 all KL = 0.915 +- 0.103 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.3 all L1 = 0.786 +- 0.101 (in-sample avg dev_std = 0.251)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.852
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.777
SUFF++ for r=0.6 class 0.0 = 0.836 +- 0.139 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 class 1.0 = 0.797 +- 0.139 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 all KL = 0.891 +- 0.139 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 all L1 = 0.801 +- 0.124 (in-sample avg dev_std = 0.237)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.892
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.033 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 class 1.0 = 0.949 +- 0.033 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all KL = 0.985 +- 0.033 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all L1 = 0.949 +- 0.063 (in-sample avg dev_std = 0.104)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.578
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 776
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.536
SUFF++ for r=0.3 class 0.0 = 0.819 +- 0.093 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.3 class 1.0 = 0.794 +- 0.093 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.3 all KL = 0.927 +- 0.093 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.099 (in-sample avg dev_std = 0.236)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.629
SUFF++ for r=0.6 class 0.0 = 0.838 +- 0.110 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 class 1.0 = 0.804 +- 0.110 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all KL = 0.92 +- 0.110 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all L1 = 0.809 +- 0.119 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0.0 = 0.935 +- 0.046 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 class 1.0 = 0.927 +- 0.046 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 all KL = 0.981 +- 0.046 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.9 all L1 = 0.928 +- 0.076 (in-sample avg dev_std = 0.124)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.675
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.653
NEC for r=0.3 class 0.0 = 0.125 +- 0.058 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 1.0 = 0.154 +- 0.058 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all KL = 0.038 +- 0.058 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all L1 = 0.151 +- 0.092 (in-sample avg dev_std = 0.147)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.858
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.82
NEC for r=0.6 class 0.0 = 0.139 +- 0.079 (in-sample avg dev_std = 0.177)
NEC for r=0.6 class 1.0 = 0.132 +- 0.079 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all KL = 0.049 +- 0.079 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all L1 = 0.133 +- 0.105 (in-sample avg dev_std = 0.177)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.909
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.878
NEC for r=0.9 class 0.0 = 0.142 +- 0.096 (in-sample avg dev_std = 0.179)
NEC for r=0.9 class 1.0 = 0.106 +- 0.096 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all KL = 0.053 +- 0.096 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all L1 = 0.11 +- 0.111 (in-sample avg dev_std = 0.179)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.914
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.883
NEC for r=1.0 class 0.0 = 0.165 +- 0.118 (in-sample avg dev_std = 0.197)
NEC for r=1.0 class 1.0 = 0.104 +- 0.118 (in-sample avg dev_std = 0.197)
NEC for r=1.0 all KL = 0.061 +- 0.118 (in-sample avg dev_std = 0.197)
NEC for r=1.0 all L1 = 0.111 +- 0.124 (in-sample avg dev_std = 0.197)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.697
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.681
NEC for r=0.3 class 0.0 = 0.127 +- 0.051 (in-sample avg dev_std = 0.145)
NEC for r=0.3 class 1.0 = 0.154 +- 0.051 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all KL = 0.036 +- 0.051 (in-sample avg dev_std = 0.145)
NEC for r=0.3 all L1 = 0.151 +- 0.089 (in-sample avg dev_std = 0.145)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.852
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.834
NEC for r=0.6 class 0.0 = 0.119 +- 0.078 (in-sample avg dev_std = 0.164)
NEC for r=0.6 class 1.0 = 0.13 +- 0.078 (in-sample avg dev_std = 0.164)
NEC for r=0.6 all KL = 0.047 +- 0.078 (in-sample avg dev_std = 0.164)
NEC for r=0.6 all L1 = 0.128 +- 0.098 (in-sample avg dev_std = 0.164)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.897
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.873
NEC for r=0.9 class 0.0 = 0.136 +- 0.087 (in-sample avg dev_std = 0.181)
NEC for r=0.9 class 1.0 = 0.107 +- 0.087 (in-sample avg dev_std = 0.181)
NEC for r=0.9 all KL = 0.05 +- 0.087 (in-sample avg dev_std = 0.181)
NEC for r=0.9 all L1 = 0.11 +- 0.111 (in-sample avg dev_std = 0.181)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.905
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.883
NEC for r=1.0 class 0.0 = 0.133 +- 0.108 (in-sample avg dev_std = 0.188)
NEC for r=1.0 class 1.0 = 0.11 +- 0.108 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all KL = 0.057 +- 0.108 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all L1 = 0.112 +- 0.125 (in-sample avg dev_std = 0.188)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.568
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.556
NEC for r=0.3 class 0.0 = 0.128 +- 0.047 (in-sample avg dev_std = 0.135)
NEC for r=0.3 class 1.0 = 0.142 +- 0.047 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all KL = 0.031 +- 0.047 (in-sample avg dev_std = 0.135)
NEC for r=0.3 all L1 = 0.14 +- 0.086 (in-sample avg dev_std = 0.135)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
NEC for r=0.6 class 0.0 = 0.134 +- 0.070 (in-sample avg dev_std = 0.165)
NEC for r=0.6 class 1.0 = 0.143 +- 0.070 (in-sample avg dev_std = 0.165)
NEC for r=0.6 all KL = 0.043 +- 0.070 (in-sample avg dev_std = 0.165)
NEC for r=0.6 all L1 = 0.142 +- 0.102 (in-sample avg dev_std = 0.165)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.672
NEC for r=0.9 class 0.0 = 0.149 +- 0.103 (in-sample avg dev_std = 0.196)
NEC for r=0.9 class 1.0 = 0.144 +- 0.103 (in-sample avg dev_std = 0.196)
NEC for r=0.9 all KL = 0.061 +- 0.103 (in-sample avg dev_std = 0.196)
NEC for r=0.9 all L1 = 0.144 +- 0.122 (in-sample avg dev_std = 0.196)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.703
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.683
NEC for r=1.0 class 0.0 = 0.168 +- 0.106 (in-sample avg dev_std = 0.212)
NEC for r=1.0 class 1.0 = 0.146 +- 0.106 (in-sample avg dev_std = 0.212)
NEC for r=1.0 all KL = 0.066 +- 0.106 (in-sample avg dev_std = 0.212)
NEC for r=1.0 all L1 = 0.149 +- 0.127 (in-sample avg dev_std = 0.212)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:52:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:52:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:53:24 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:53:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:53:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:53:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:54:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ROC-AUC: 0.9441
Train Loss: 0.2295
ID Validation ROC-AUC: 0.9109
ID Validation Loss: 0.3069
ID Test ROC-AUC: 0.9132
ID Test Loss: 0.3087
OOD Validation ROC-AUC: 0.6524
OOD Validation Loss: 0.4527
OOD Test ROC-AUC: 0.7114
OOD Test Loss: 0.6609

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.8911
Train Loss: 0.2524
ID Validation ROC-AUC: 0.8866
ID Validation Loss: 0.2571
ID Test ROC-AUC: 0.8838
ID Test Loss: 0.2627
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.2880
OOD Test ROC-AUC: 0.7175
OOD Test Loss: 0.4457

[0m[1;37mINFO[0m: [1mChartInfo 0.9132 0.7114 0.8838 0.7175 0.8866 0.6885[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:54:16 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:54:21 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:54:25 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.665
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 784
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0.0 = 0.826 +- 0.092 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 class 1.0 = 0.794 +- 0.092 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 all KL = 0.924 +- 0.092 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.103 (in-sample avg dev_std = 0.232)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.832
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.736
SUFF++ for r=0.6 class 0.0 = 0.834 +- 0.161 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 class 1.0 = 0.79 +- 0.161 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all KL = 0.874 +- 0.161 (in-sample avg dev_std = 0.256)
SUFF++ for r=0.6 all L1 = 0.795 +- 0.147 (in-sample avg dev_std = 0.256)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0.0 = 0.937 +- 0.038 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.9 class 1.0 = 0.959 +- 0.038 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.9 all KL = 0.986 +- 0.038 (in-sample avg dev_std = 0.095)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.063 (in-sample avg dev_std = 0.095)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 789
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.627
SUFF++ for r=0.3 class 0.0 = 0.828 +- 0.097 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 1.0 = 0.791 +- 0.097 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 all KL = 0.922 +- 0.097 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 all L1 = 0.795 +- 0.106 (in-sample avg dev_std = 0.241)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.784
SUFF++ for r=0.6 class 0.0 = 0.85 +- 0.146 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 class 1.0 = 0.802 +- 0.146 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all KL = 0.888 +- 0.146 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.136 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.911
SUFF++ for r=0.9 class 0.0 = 0.943 +- 0.026 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 class 1.0 = 0.959 +- 0.026 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 all KL = 0.989 +- 0.026 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.057 (in-sample avg dev_std = 0.087)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.599
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.57
SUFF++ for r=0.3 class 0.0 = 0.83 +- 0.086 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.3 class 1.0 = 0.813 +- 0.086 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.3 all KL = 0.938 +- 0.086 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.100 (in-sample avg dev_std = 0.217)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.667
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
SUFF++ for r=0.6 class 0.0 = 0.845 +- 0.119 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.6 class 1.0 = 0.819 +- 0.119 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.6 all KL = 0.923 +- 0.119 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.6 all L1 = 0.823 +- 0.124 (in-sample avg dev_std = 0.198)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.685
SUFF++ for r=0.9 class 0.0 = 0.935 +- 0.036 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 class 1.0 = 0.94 +- 0.036 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all KL = 0.985 +- 0.036 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.069 (in-sample avg dev_std = 0.116)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.662
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.651
NEC for r=0.3 class 0.0 = 0.126 +- 0.057 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1.0 = 0.157 +- 0.057 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.04 +- 0.057 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.153 +- 0.091 (in-sample avg dev_std = 0.153)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.832
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.79
NEC for r=0.6 class 0.0 = 0.142 +- 0.074 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 1.0 = 0.13 +- 0.074 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.052 +- 0.074 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.132 +- 0.105 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.858
NEC for r=0.9 class 0.0 = 0.148 +- 0.101 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.091 +- 0.101 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.051 +- 0.101 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.098 +- 0.110 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.901
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.874
NEC for r=1.0 class 0.0 = 0.17 +- 0.113 (in-sample avg dev_std = 0.185)
NEC for r=1.0 class 1.0 = 0.087 +- 0.113 (in-sample avg dev_std = 0.185)
NEC for r=1.0 all KL = 0.056 +- 0.113 (in-sample avg dev_std = 0.185)
NEC for r=1.0 all L1 = 0.097 +- 0.114 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.704
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.695
NEC for r=0.3 class 0.0 = 0.109 +- 0.046 (in-sample avg dev_std = 0.139)
NEC for r=0.3 class 1.0 = 0.147 +- 0.046 (in-sample avg dev_std = 0.139)
NEC for r=0.3 all KL = 0.034 +- 0.046 (in-sample avg dev_std = 0.139)
NEC for r=0.3 all L1 = 0.143 +- 0.086 (in-sample avg dev_std = 0.139)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.841
NEC for r=0.6 class 0.0 = 0.102 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.6 class 1.0 = 0.123 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all KL = 0.044 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all L1 = 0.121 +- 0.095 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.889
NEC for r=0.9 class 0.0 = 0.13 +- 0.104 (in-sample avg dev_std = 0.175)
NEC for r=0.9 class 1.0 = 0.093 +- 0.104 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all KL = 0.051 +- 0.104 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all L1 = 0.097 +- 0.106 (in-sample avg dev_std = 0.175)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.895
NEC for r=1.0 class 0.0 = 0.137 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=1.0 class 1.0 = 0.091 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=1.0 all KL = 0.053 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=1.0 all L1 = 0.096 +- 0.113 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.57
NEC for r=0.3 class 0.0 = 0.139 +- 0.059 (in-sample avg dev_std = 0.143)
NEC for r=0.3 class 1.0 = 0.147 +- 0.059 (in-sample avg dev_std = 0.143)
NEC for r=0.3 all KL = 0.036 +- 0.059 (in-sample avg dev_std = 0.143)
NEC for r=0.3 all L1 = 0.145 +- 0.089 (in-sample avg dev_std = 0.143)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.667
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.137 +- 0.073 (in-sample avg dev_std = 0.161)
NEC for r=0.6 class 1.0 = 0.137 +- 0.073 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all KL = 0.045 +- 0.073 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all L1 = 0.137 +- 0.096 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.682
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.667
NEC for r=0.9 class 0.0 = 0.155 +- 0.089 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 1.0 = 0.13 +- 0.089 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all KL = 0.056 +- 0.089 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all L1 = 0.134 +- 0.116 (in-sample avg dev_std = 0.192)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.694
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.68
NEC for r=1.0 class 0.0 = 0.165 +- 0.102 (in-sample avg dev_std = 0.202)
NEC for r=1.0 class 1.0 = 0.133 +- 0.102 (in-sample avg dev_std = 0.202)
NEC for r=1.0 all KL = 0.063 +- 0.102 (in-sample avg dev_std = 0.202)
NEC for r=1.0 all L1 = 0.138 +- 0.126 (in-sample avg dev_std = 0.202)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 21:58:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 09:58:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 09:58:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 09:58:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 09:59:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9460
Train Loss: 0.2073
ID Validation ROC-AUC: 0.9116
ID Validation Loss: 0.2741
ID Test ROC-AUC: 0.9163
ID Test Loss: 0.2698
OOD Validation ROC-AUC: 0.6566
OOD Validation Loss: 0.4102
OOD Test ROC-AUC: 0.7052
OOD Test Loss: 0.6052

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9006
Train Loss: 0.2613
ID Validation ROC-AUC: 0.8857
ID Validation Loss: 0.2791
ID Test ROC-AUC: 0.8886
ID Test Loss: 0.2807
OOD Validation ROC-AUC: 0.6964
OOD Validation Loss: 0.3076
OOD Test ROC-AUC: 0.7087
OOD Test Loss: 0.5126

[0m[1;37mINFO[0m: [1mChartInfo 0.9163 0.7052 0.8886 0.7087 0.8857 0.6964[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 09:59:34 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 09:59:38 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 09:59:42 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.614
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 781
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.58
SUFF++ for r=0.3 class 0.0 = 0.852 +- 0.069 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.3 class 1.0 = 0.839 +- 0.069 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.3 all KL = 0.956 +- 0.069 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.3 all L1 = 0.84 +- 0.089 (in-sample avg dev_std = 0.180)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.801
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.724
SUFF++ for r=0.6 class 0.0 = 0.879 +- 0.125 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.803 +- 0.125 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.913 +- 0.125 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.812 +- 0.123 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.877
SUFF++ for r=0.9 class 0.0 = 0.948 +- 0.037 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 class 1.0 = 0.947 +- 0.037 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all KL = 0.986 +- 0.037 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.065 (in-sample avg dev_std = 0.105)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.649
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 780
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
SUFF++ for r=0.3 class 0.0 = 0.86 +- 0.067 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.3 class 1.0 = 0.839 +- 0.067 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.3 all KL = 0.958 +- 0.067 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.3 all L1 = 0.841 +- 0.088 (in-sample avg dev_std = 0.180)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.723
SUFF++ for r=0.6 class 0.0 = 0.873 +- 0.116 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 class 1.0 = 0.798 +- 0.116 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 all KL = 0.914 +- 0.116 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.122 (in-sample avg dev_std = 0.216)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.883
SUFF++ for r=0.9 class 0.0 = 0.958 +- 0.030 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 class 1.0 = 0.95 +- 0.030 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 all KL = 0.988 +- 0.030 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.9 all L1 = 0.951 +- 0.056 (in-sample avg dev_std = 0.096)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.568
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 785
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0.0 = 0.862 +- 0.049 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 class 1.0 = 0.846 +- 0.049 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 all KL = 0.964 +- 0.049 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.3 all L1 = 0.849 +- 0.079 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.607
SUFF++ for r=0.6 class 0.0 = 0.862 +- 0.092 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.6 class 1.0 = 0.821 +- 0.092 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.6 all KL = 0.94 +- 0.092 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.6 all L1 = 0.828 +- 0.109 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.684
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.68
SUFF++ for r=0.9 class 0.0 = 0.947 +- 0.030 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 class 1.0 = 0.933 +- 0.030 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all KL = 0.986 +- 0.030 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all L1 = 0.936 +- 0.063 (in-sample avg dev_std = 0.108)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.618
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0.0 = 0.105 +- 0.034 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 1.0 = 0.121 +- 0.034 (in-sample avg dev_std = 0.113)
NEC for r=0.3 all KL = 0.021 +- 0.034 (in-sample avg dev_std = 0.113)
NEC for r=0.3 all L1 = 0.119 +- 0.074 (in-sample avg dev_std = 0.113)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.801
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.776
NEC for r=0.6 class 0.0 = 0.107 +- 0.074 (in-sample avg dev_std = 0.165)
NEC for r=0.6 class 1.0 = 0.14 +- 0.074 (in-sample avg dev_std = 0.165)
NEC for r=0.6 all KL = 0.045 +- 0.074 (in-sample avg dev_std = 0.165)
NEC for r=0.6 all L1 = 0.136 +- 0.095 (in-sample avg dev_std = 0.165)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.859
NEC for r=0.9 class 0.0 = 0.125 +- 0.084 (in-sample avg dev_std = 0.172)
NEC for r=0.9 class 1.0 = 0.117 +- 0.084 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all KL = 0.051 +- 0.084 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all L1 = 0.118 +- 0.105 (in-sample avg dev_std = 0.172)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.894
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0.0 = 0.136 +- 0.100 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 1.0 = 0.11 +- 0.100 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all KL = 0.055 +- 0.100 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all L1 = 0.113 +- 0.110 (in-sample avg dev_std = 0.175)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.653
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0.0 = 0.092 +- 0.033 (in-sample avg dev_std = 0.111)
NEC for r=0.3 class 1.0 = 0.119 +- 0.033 (in-sample avg dev_std = 0.111)
NEC for r=0.3 all KL = 0.02 +- 0.033 (in-sample avg dev_std = 0.111)
NEC for r=0.3 all L1 = 0.116 +- 0.070 (in-sample avg dev_std = 0.111)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.817
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.788
NEC for r=0.6 class 0.0 = 0.094 +- 0.063 (in-sample avg dev_std = 0.154)
NEC for r=0.6 class 1.0 = 0.135 +- 0.063 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all KL = 0.039 +- 0.063 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all L1 = 0.13 +- 0.087 (in-sample avg dev_std = 0.154)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.862
NEC for r=0.9 class 0.0 = 0.125 +- 0.090 (in-sample avg dev_std = 0.174)
NEC for r=0.9 class 1.0 = 0.121 +- 0.090 (in-sample avg dev_std = 0.174)
NEC for r=0.9 all KL = 0.054 +- 0.090 (in-sample avg dev_std = 0.174)
NEC for r=0.9 all L1 = 0.122 +- 0.107 (in-sample avg dev_std = 0.174)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.901
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0.0 = 0.128 +- 0.099 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 1.0 = 0.111 +- 0.099 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all KL = 0.055 +- 0.099 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all L1 = 0.113 +- 0.108 (in-sample avg dev_std = 0.183)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.569
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.543
NEC for r=0.3 class 0.0 = 0.109 +- 0.032 (in-sample avg dev_std = 0.107)
NEC for r=0.3 class 1.0 = 0.111 +- 0.032 (in-sample avg dev_std = 0.107)
NEC for r=0.3 all KL = 0.019 +- 0.032 (in-sample avg dev_std = 0.107)
NEC for r=0.3 all L1 = 0.111 +- 0.071 (in-sample avg dev_std = 0.107)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.623
NEC for r=0.6 class 0.0 = 0.117 +- 0.052 (in-sample avg dev_std = 0.146)
NEC for r=0.6 class 1.0 = 0.139 +- 0.052 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all KL = 0.034 +- 0.052 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all L1 = 0.135 +- 0.090 (in-sample avg dev_std = 0.146)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.684
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0.0 = 0.137 +- 0.082 (in-sample avg dev_std = 0.181)
NEC for r=0.9 class 1.0 = 0.144 +- 0.082 (in-sample avg dev_std = 0.181)
NEC for r=0.9 all KL = 0.05 +- 0.082 (in-sample avg dev_std = 0.181)
NEC for r=0.9 all L1 = 0.143 +- 0.105 (in-sample avg dev_std = 0.181)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.695
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.678
NEC for r=1.0 class 0.0 = 0.147 +- 0.090 (in-sample avg dev_std = 0.196)
NEC for r=1.0 class 1.0 = 0.15 +- 0.090 (in-sample avg dev_std = 0.196)
NEC for r=1.0 all KL = 0.058 +- 0.090 (in-sample avg dev_std = 0.196)
NEC for r=1.0 all L1 = 0.149 +- 0.116 (in-sample avg dev_std = 0.196)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.915, 0.884, 0.987, 1.0], 'all_L1': [0.793, 0.796, 0.954, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.942, 0.9, 0.987, 1.0], 'all_L1': [0.819, 0.807, 0.954, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.89, 0.986, 1.0], 'all_L1': [0.794, 0.795, 0.951, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.924, 0.874, 0.986, 1.0], 'all_L1': [0.798, 0.795, 0.957, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.956, 0.913, 0.986, 1.0], 'all_L1': [0.84, 0.812, 0.948, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.036, 0.055, 0.053, 0.055], 'all_L1': [0.142, 0.138, 0.107, 0.105]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.044, 0.052, 0.052], 'all_L1': [0.128, 0.127, 0.108, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.049, 0.053, 0.061], 'all_L1': [0.151, 0.133, 0.11, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.04, 0.052, 0.051, 0.056], 'all_L1': [0.153, 0.132, 0.098, 0.097]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.045, 0.051, 0.055], 'all_L1': [0.119, 0.136, 0.118, 0.113]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.915, 0.895, 0.991, 1.0], 'all_L1': [0.793, 0.808, 0.958, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.9, 0.987, 1.0], 'all_L1': [0.822, 0.807, 0.952, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.915, 0.891, 0.985, 1.0], 'all_L1': [0.786, 0.801, 0.949, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.922, 0.888, 0.989, 1.0], 'all_L1': [0.795, 0.807, 0.957, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.958, 0.914, 0.988, 1.0], 'all_L1': [0.841, 0.807, 0.951, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.036, 0.047, 0.046, 0.051], 'all_L1': [0.142, 0.128, 0.1, 0.098]}), defaultdict(<class 'list'>, {'all_KL': [0.026, 0.045, 0.047, 0.051], 'all_L1': [0.128, 0.129, 0.106, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.047, 0.05, 0.057], 'all_L1': [0.151, 0.128, 0.11, 0.112]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.044, 0.051, 0.053], 'all_L1': [0.143, 0.121, 0.097, 0.096]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.039, 0.054, 0.055], 'all_L1': [0.116, 0.13, 0.122, 0.113]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.934, 0.928, 0.986, 1.0], 'all_L1': [0.815, 0.827, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.952, 0.935, 0.984, 1.0], 'all_L1': [0.831, 0.832, 0.935, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.92, 0.981, 1.0], 'all_L1': [0.798, 0.809, 0.928, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.938, 0.923, 0.985, 1.0], 'all_L1': [0.816, 0.823, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.94, 0.986, 1.0], 'all_L1': [0.849, 0.828, 0.936, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.03, 0.043, 0.06, 0.062], 'all_L1': [0.133, 0.137, 0.141, 0.142]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.039, 0.057, 0.06], 'all_L1': [0.121, 0.131, 0.141, 0.142]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.043, 0.061, 0.066], 'all_L1': [0.14, 0.142, 0.144, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.045, 0.056, 0.063], 'all_L1': [0.145, 0.137, 0.134, 0.138]}), defaultdict(<class 'list'>, {'all_KL': [0.019, 0.034, 0.05, 0.058], 'all_L1': [0.111, 0.135, 0.143, 0.149]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.809 +- 0.018, 0.801 +- 0.007, 0.953 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.931 +- 0.015, 0.892 +- 0.013, 0.986 +- 0.000, 1.000 +- 0.000
suff++_acc_int  =  0.585 +- 0.017, 0.742 +- 0.016, 0.887 +- 0.009
nec class all_L1  =  0.139 +- 0.013, 0.133 +- 0.004, 0.108 +- 0.006, 0.106 +- 0.006
nec class all_KL  =  0.032 +- 0.007, 0.049 +- 0.004, 0.052 +- 0.001, 0.056 +- 0.003
nec_acc_int  =  0.632 +- 0.037, 0.794 +- 0.017, 0.862 +- 0.009, 0.871 +- 0.008

Eval split id_test
suff++ class all_L1  =  0.807 +- 0.021, 0.806 +- 0.003, 0.953 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.931 +- 0.017, 0.898 +- 0.009, 0.988 +- 0.002, 1.000 +- 0.000
suff++_acc_int  =  0.615 +- 0.017, 0.765 +- 0.023, 0.896 +- 0.009
nec class all_L1  =  0.136 +- 0.012, 0.127 +- 0.003, 0.107 +- 0.009, 0.104 +- 0.007
nec class all_KL  =  0.030 +- 0.006, 0.044 +- 0.003, 0.050 +- 0.003, 0.053 +- 0.002
nec_acc_int  =  0.678 +- 0.020, 0.820 +- 0.019, 0.877 +- 0.009, 0.883 +- 0.008

Eval split test
suff++ class all_L1  =  0.822 +- 0.017, 0.824 +- 0.008, 0.935 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.943 +- 0.013, 0.929 +- 0.007, 0.984 +- 0.002, 1.000 +- 0.000
suff++_acc_int  =  0.558 +- 0.012, 0.630 +- 0.020, 0.687 +- 0.005
nec class all_L1  =  0.130 +- 0.012, 0.136 +- 0.004, 0.141 +- 0.003, 0.144 +- 0.004
nec class all_KL  =  0.028 +- 0.006, 0.041 +- 0.004, 0.057 +- 0.004, 0.062 +- 0.003
nec_acc_int  =  0.570 +- 0.018, 0.645 +- 0.022, 0.675 +- 0.010, 0.684 +- 0.005


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.004, 0.467 +- 0.004, 0.531 +- 0.002, 0.553 +- 0.003
Faith. Armon (L1)= 		  =  0.236 +- 0.019, 0.228 +- 0.006, 0.194 +- 0.010, 0.191 +- 0.009
Faith. GMean (L1)= 	  =  0.334 +- 0.013, 0.327 +- 0.005, 0.321 +- 0.009, 0.325 +- 0.009
Faith. Aritm (KL)= 		  =  0.482 +- 0.004, 0.471 +- 0.005, 0.519 +- 0.001, 0.528 +- 0.001
Faith. Armon (KL)= 		  =  0.063 +- 0.014, 0.093 +- 0.007, 0.099 +- 0.002, 0.106 +- 0.005
Faith. GMean (KL)= 	  =  0.172 +- 0.019, 0.209 +- 0.008, 0.226 +- 0.002, 0.236 +- 0.006

Eval split id_test
Faith. Aritm (L1)= 		  =  0.472 +- 0.004, 0.467 +- 0.002, 0.530 +- 0.003, 0.552 +- 0.004
Faith. Armon (L1)= 		  =  0.232 +- 0.018, 0.220 +- 0.005, 0.192 +- 0.014, 0.188 +- 0.012
Faith. GMean (L1)= 	  =  0.331 +- 0.011, 0.320 +- 0.004, 0.319 +- 0.012, 0.322 +- 0.011
Faith. Aritm (KL)= 		  =  0.481 +- 0.006, 0.471 +- 0.004, 0.519 +- 0.002, 0.527 +- 0.001
Faith. Armon (KL)= 		  =  0.059 +- 0.012, 0.085 +- 0.005, 0.094 +- 0.005, 0.101 +- 0.004
Faith. GMean (KL)= 	  =  0.167 +- 0.017, 0.199 +- 0.006, 0.221 +- 0.006, 0.231 +- 0.005

Eval split test
Faith. Aritm (L1)= 		  =  0.476 +- 0.004, 0.480 +- 0.002, 0.538 +- 0.002, 0.572 +- 0.002
Faith. Armon (L1)= 		  =  0.224 +- 0.018, 0.234 +- 0.005, 0.244 +- 0.005, 0.252 +- 0.007
Faith. GMean (L1)= 	  =  0.326 +- 0.013, 0.335 +- 0.003, 0.363 +- 0.004, 0.379 +- 0.006
Faith. Aritm (KL)= 		  =  0.486 +- 0.004, 0.485 +- 0.002, 0.521 +- 0.002, 0.531 +- 0.001
Faith. Armon (KL)= 		  =  0.054 +- 0.011, 0.078 +- 0.007, 0.107 +- 0.007, 0.116 +- 0.005
Faith. GMean (KL)= 	  =  0.161 +- 0.017, 0.194 +- 0.009, 0.236 +- 0.008, 0.249 +- 0.005
Computed for split load_split = id



Completed in  0:25:58.911592  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:03:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:03:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:08 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:18 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:28 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:04:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ROC-AUC: 0.9434
Train Loss: 0.1941
ID Validation ROC-AUC: 0.9184
ID Validation Loss: 0.2283
ID Test ROC-AUC: 0.9179
ID Test Loss: 0.2347
OOD Validation ROC-AUC: 0.6649
OOD Validation Loss: 0.3398
OOD Test ROC-AUC: 0.7120
OOD Test Loss: 0.4943

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3330
ID Validation ROC-AUC: 0.8611
ID Validation Loss: 0.3363
ID Test ROC-AUC: 0.8629
ID Test Loss: 0.3384
OOD Validation ROC-AUC: 0.7077
OOD Validation Loss: 0.2844
OOD Test ROC-AUC: 0.7179
OOD Test Loss: 0.5042

[0m[1;37mINFO[0m: [1mChartInfo 0.9179 0.7120 0.8629 0.7179 0.8611 0.7077[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:04:59 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:05:04 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:05:08 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.572
SUFF++ for r=0.3 class 0.0 = 0.778 +- 0.090 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.3 class 1.0 = 0.816 +- 0.090 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.3 all KL = 0.895 +- 0.090 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.3 all L1 = 0.811 +- 0.111 (in-sample avg dev_std = 0.214)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.708
SUFF++ for r=0.6 class 0.0 = 0.796 +- 0.073 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.073 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 all KL = 0.935 +- 0.073 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.6 all L1 = 0.883 +- 0.116 (in-sample avg dev_std = 0.147)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.802
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.768
SUFF++ for r=0.9 class 0.0 = 0.848 +- 0.052 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 class 1.0 = 0.917 +- 0.052 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all KL = 0.965 +- 0.052 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.089 (in-sample avg dev_std = 0.111)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.691
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.597
SUFF++ for r=0.3 class 0.0 = 0.755 +- 0.090 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.3 class 1.0 = 0.814 +- 0.090 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.3 all KL = 0.893 +- 0.090 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.3 all L1 = 0.807 +- 0.115 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.712
SUFF++ for r=0.6 class 0.0 = 0.759 +- 0.074 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 class 1.0 = 0.896 +- 0.074 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 all KL = 0.933 +- 0.074 (in-sample avg dev_std = 0.154)
SUFF++ for r=0.6 all L1 = 0.879 +- 0.120 (in-sample avg dev_std = 0.154)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.784
SUFF++ for r=0.9 class 0.0 = 0.83 +- 0.052 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 class 1.0 = 0.912 +- 0.052 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 all KL = 0.962 +- 0.052 (in-sample avg dev_std = 0.113)
SUFF++ for r=0.9 all L1 = 0.902 +- 0.094 (in-sample avg dev_std = 0.113)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.557
SUFF++ for r=0.3 class 0.0 = 0.77 +- 0.087 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.3 class 1.0 = 0.786 +- 0.087 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.3 all KL = 0.89 +- 0.087 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.3 all L1 = 0.784 +- 0.113 (in-sample avg dev_std = 0.228)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.636
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.629
SUFF++ for r=0.6 class 0.0 = 0.806 +- 0.077 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 class 1.0 = 0.853 +- 0.077 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 all KL = 0.918 +- 0.077 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.6 all L1 = 0.845 +- 0.121 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.647
SUFF++ for r=0.9 class 0.0 = 0.849 +- 0.063 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 class 1.0 = 0.886 +- 0.063 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all KL = 0.954 +- 0.063 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all L1 = 0.88 +- 0.100 (in-sample avg dev_std = 0.129)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.647
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.7
NEC for r=0.3 class 0.0 = 0.178 +- 0.080 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1.0 = 0.148 +- 0.080 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.069 +- 0.080 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.151 +- 0.107 (in-sample avg dev_std = 0.153)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.785
NEC for r=0.6 class 0.0 = 0.166 +- 0.074 (in-sample avg dev_std = 0.130)
NEC for r=0.6 class 1.0 = 0.094 +- 0.074 (in-sample avg dev_std = 0.130)
NEC for r=0.6 all KL = 0.055 +- 0.074 (in-sample avg dev_std = 0.130)
NEC for r=0.6 all L1 = 0.102 +- 0.099 (in-sample avg dev_std = 0.130)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.802
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.81
NEC for r=0.9 class 0.0 = 0.138 +- 0.060 (in-sample avg dev_std = 0.113)
NEC for r=0.9 class 1.0 = 0.081 +- 0.060 (in-sample avg dev_std = 0.113)
NEC for r=0.9 all KL = 0.036 +- 0.060 (in-sample avg dev_std = 0.113)
NEC for r=0.9 all L1 = 0.088 +- 0.084 (in-sample avg dev_std = 0.113)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.794
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.803
NEC for r=1.0 class 0.0 = 0.124 +- 0.043 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 1.0 = 0.077 +- 0.043 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all KL = 0.028 +- 0.043 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all L1 = 0.082 +- 0.075 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.691
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.72
NEC for r=0.3 class 0.0 = 0.2 +- 0.090 (in-sample avg dev_std = 0.158)
NEC for r=0.3 class 1.0 = 0.156 +- 0.090 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all KL = 0.076 +- 0.090 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all L1 = 0.161 +- 0.113 (in-sample avg dev_std = 0.158)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.82
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.813
NEC for r=0.6 class 0.0 = 0.182 +- 0.073 (in-sample avg dev_std = 0.129)
NEC for r=0.6 class 1.0 = 0.093 +- 0.073 (in-sample avg dev_std = 0.129)
NEC for r=0.6 all KL = 0.053 +- 0.073 (in-sample avg dev_std = 0.129)
NEC for r=0.6 all L1 = 0.104 +- 0.102 (in-sample avg dev_std = 0.129)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.84
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.832
NEC for r=0.9 class 0.0 = 0.155 +- 0.055 (in-sample avg dev_std = 0.115)
NEC for r=0.9 class 1.0 = 0.084 +- 0.055 (in-sample avg dev_std = 0.115)
NEC for r=0.9 all KL = 0.036 +- 0.055 (in-sample avg dev_std = 0.115)
NEC for r=0.9 all L1 = 0.093 +- 0.088 (in-sample avg dev_std = 0.115)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.849
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.824
NEC for r=1.0 class 0.0 = 0.132 +- 0.049 (in-sample avg dev_std = 0.115)
NEC for r=1.0 class 1.0 = 0.084 +- 0.049 (in-sample avg dev_std = 0.115)
NEC for r=1.0 all KL = 0.031 +- 0.049 (in-sample avg dev_std = 0.115)
NEC for r=1.0 all L1 = 0.09 +- 0.081 (in-sample avg dev_std = 0.115)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.58
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0.0 = 0.176 +- 0.082 (in-sample avg dev_std = 0.164)
NEC for r=0.3 class 1.0 = 0.172 +- 0.082 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all KL = 0.073 +- 0.082 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all L1 = 0.173 +- 0.105 (in-sample avg dev_std = 0.164)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.636
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.163 +- 0.085 (in-sample avg dev_std = 0.146)
NEC for r=0.6 class 1.0 = 0.126 +- 0.085 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all KL = 0.065 +- 0.085 (in-sample avg dev_std = 0.146)
NEC for r=0.6 all L1 = 0.132 +- 0.103 (in-sample avg dev_std = 0.146)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.664
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0.0 = 0.134 +- 0.056 (in-sample avg dev_std = 0.124)
NEC for r=0.9 class 1.0 = 0.109 +- 0.056 (in-sample avg dev_std = 0.124)
NEC for r=0.9 all KL = 0.042 +- 0.056 (in-sample avg dev_std = 0.124)
NEC for r=0.9 all L1 = 0.113 +- 0.091 (in-sample avg dev_std = 0.124)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.665
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.667
NEC for r=1.0 class 0.0 = 0.124 +- 0.061 (in-sample avg dev_std = 0.126)
NEC for r=1.0 class 1.0 = 0.105 +- 0.061 (in-sample avg dev_std = 0.126)
NEC for r=1.0 all KL = 0.038 +- 0.061 (in-sample avg dev_std = 0.126)
NEC for r=1.0 all L1 = 0.109 +- 0.086 (in-sample avg dev_std = 0.126)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:09:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:09:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:09:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:09:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:09:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9587
Train Loss: 0.1771
ID Validation ROC-AUC: 0.9201
ID Validation Loss: 0.2391
ID Test ROC-AUC: 0.9152
ID Test Loss: 0.2527
OOD Validation ROC-AUC: 0.6421
OOD Validation Loss: 0.3820
OOD Test ROC-AUC: 0.7028
OOD Test Loss: 0.5354

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8699
Train Loss: 0.3302
ID Validation ROC-AUC: 0.8692
ID Validation Loss: 0.3319
ID Test ROC-AUC: 0.8661
ID Test Loss: 0.3387
OOD Validation ROC-AUC: 0.7078
OOD Validation Loss: 0.2934
OOD Test ROC-AUC: 0.7256
OOD Test Loss: 0.5169

[0m[1;37mINFO[0m: [1mChartInfo 0.9152 0.7028 0.8661 0.7256 0.8692 0.7078[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:10:21 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:10:25 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:10:29 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.664
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.592
SUFF++ for r=0.3 class 0.0 = 0.759 +- 0.082 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 1.0 = 0.744 +- 0.082 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all KL = 0.906 +- 0.082 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all L1 = 0.746 +- 0.095 (in-sample avg dev_std = 0.272)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.722
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
SUFF++ for r=0.6 class 0.0 = 0.72 +- 0.123 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 class 1.0 = 0.68 +- 0.123 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all KL = 0.834 +- 0.123 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.6 all L1 = 0.685 +- 0.115 (in-sample avg dev_std = 0.360)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.734
SUFF++ for r=0.9 class 0.0 = 0.838 +- 0.112 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1.0 = 0.787 +- 0.112 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.908 +- 0.112 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.131 (in-sample avg dev_std = 0.225)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.581
SUFF++ for r=0.3 class 0.0 = 0.77 +- 0.066 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 1.0 = 0.748 +- 0.066 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all KL = 0.912 +- 0.066 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all L1 = 0.751 +- 0.089 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.657
SUFF++ for r=0.6 class 0.0 = 0.741 +- 0.110 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.6 class 1.0 = 0.693 +- 0.110 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.6 all KL = 0.848 +- 0.110 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.6 all L1 = 0.698 +- 0.110 (in-sample avg dev_std = 0.349)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.761
SUFF++ for r=0.9 class 0.0 = 0.835 +- 0.119 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 1.0 = 0.78 +- 0.119 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all KL = 0.903 +- 0.119 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all L1 = 0.787 +- 0.134 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.601
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.583
SUFF++ for r=0.3 class 0.0 = 0.77 +- 0.082 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 1.0 = 0.737 +- 0.082 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 all KL = 0.9 +- 0.082 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 all L1 = 0.742 +- 0.098 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0.0 = 0.751 +- 0.115 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 1.0 = 0.699 +- 0.115 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all KL = 0.856 +- 0.115 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all L1 = 0.708 +- 0.117 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.694
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.661
SUFF++ for r=0.9 class 0.0 = 0.834 +- 0.110 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 class 1.0 = 0.794 +- 0.110 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all KL = 0.918 +- 0.110 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.9 all L1 = 0.8 +- 0.129 (in-sample avg dev_std = 0.217)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.664
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.61
NEC for r=0.3 class 0.0 = 0.156 +- 0.061 (in-sample avg dev_std = 0.167)
NEC for r=0.3 class 1.0 = 0.178 +- 0.061 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all KL = 0.046 +- 0.061 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all L1 = 0.176 +- 0.101 (in-sample avg dev_std = 0.167)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.722
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.69
NEC for r=0.6 class 0.0 = 0.148 +- 0.080 (in-sample avg dev_std = 0.201)
NEC for r=0.6 class 1.0 = 0.191 +- 0.080 (in-sample avg dev_std = 0.201)
NEC for r=0.6 all KL = 0.064 +- 0.080 (in-sample avg dev_std = 0.201)
NEC for r=0.6 all L1 = 0.186 +- 0.110 (in-sample avg dev_std = 0.201)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.772
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.749
NEC for r=0.9 class 0.0 = 0.138 +- 0.087 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 1.0 = 0.164 +- 0.087 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all KL = 0.061 +- 0.087 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all L1 = 0.161 +- 0.103 (in-sample avg dev_std = 0.192)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.776
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.757
NEC for r=1.0 class 0.0 = 0.126 +- 0.069 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1.0 = 0.142 +- 0.069 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.05 +- 0.069 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.14 +- 0.093 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.591
NEC for r=0.3 class 0.0 = 0.177 +- 0.045 (in-sample avg dev_std = 0.167)
NEC for r=0.3 class 1.0 = 0.167 +- 0.045 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all KL = 0.041 +- 0.045 (in-sample avg dev_std = 0.167)
NEC for r=0.3 all L1 = 0.168 +- 0.090 (in-sample avg dev_std = 0.167)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
NEC for r=0.6 class 0.0 = 0.157 +- 0.081 (in-sample avg dev_std = 0.202)
NEC for r=0.6 class 1.0 = 0.19 +- 0.081 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all KL = 0.063 +- 0.081 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all L1 = 0.186 +- 0.109 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.779
NEC for r=0.9 class 0.0 = 0.137 +- 0.100 (in-sample avg dev_std = 0.192)
NEC for r=0.9 class 1.0 = 0.164 +- 0.100 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all KL = 0.064 +- 0.100 (in-sample avg dev_std = 0.192)
NEC for r=0.9 all L1 = 0.161 +- 0.110 (in-sample avg dev_std = 0.192)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.821
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.782
NEC for r=1.0 class 0.0 = 0.125 +- 0.082 (in-sample avg dev_std = 0.171)
NEC for r=1.0 class 1.0 = 0.141 +- 0.082 (in-sample avg dev_std = 0.171)
NEC for r=1.0 all KL = 0.051 +- 0.082 (in-sample avg dev_std = 0.171)
NEC for r=1.0 all L1 = 0.139 +- 0.099 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.601
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.573
NEC for r=0.3 class 0.0 = 0.155 +- 0.056 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1.0 = 0.177 +- 0.056 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.045 +- 0.056 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.173 +- 0.102 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.638
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.64
NEC for r=0.6 class 0.0 = 0.145 +- 0.083 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1.0 = 0.18 +- 0.083 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.056 +- 0.083 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.175 +- 0.115 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.694
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.676
NEC for r=0.9 class 0.0 = 0.133 +- 0.080 (in-sample avg dev_std = 0.177)
NEC for r=0.9 class 1.0 = 0.165 +- 0.080 (in-sample avg dev_std = 0.177)
NEC for r=0.9 all KL = 0.053 +- 0.080 (in-sample avg dev_std = 0.177)
NEC for r=0.9 all L1 = 0.159 +- 0.106 (in-sample avg dev_std = 0.177)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.705
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.682
NEC for r=1.0 class 0.0 = 0.129 +- 0.068 (in-sample avg dev_std = 0.164)
NEC for r=1.0 class 1.0 = 0.147 +- 0.068 (in-sample avg dev_std = 0.164)
NEC for r=1.0 all KL = 0.044 +- 0.068 (in-sample avg dev_std = 0.164)
NEC for r=1.0 all L1 = 0.144 +- 0.095 (in-sample avg dev_std = 0.164)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:14:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:14:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:14:51 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:00 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9691
Train Loss: 0.1494
ID Validation ROC-AUC: 0.9199
ID Validation Loss: 0.2706
ID Test ROC-AUC: 0.9186
ID Test Loss: 0.2761
OOD Validation ROC-AUC: 0.6356
OOD Validation Loss: 0.5016
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.6745

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8589
Train Loss: 0.3314
ID Validation ROC-AUC: 0.8579
ID Validation Loss: 0.3351
ID Test ROC-AUC: 0.8575
ID Test Loss: 0.3381
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2843
OOD Test ROC-AUC: 0.7264
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mChartInfo 0.9186 0.6983 0.8575 0.7264 0.8579 0.7045[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:15:40 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:15:45 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:15:49 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
SUFF++ for r=0.3 class 0.0 = 0.572 +- 0.181 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 1.0 = 0.608 +- 0.181 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all KL = 0.702 +- 0.181 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all L1 = 0.604 +- 0.141 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.71
SUFF++ for r=0.6 class 0.0 = 0.594 +- 0.192 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 class 1.0 = 0.718 +- 0.192 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all KL = 0.747 +- 0.192 (in-sample avg dev_std = 0.389)
SUFF++ for r=0.6 all L1 = 0.704 +- 0.188 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.792
SUFF++ for r=0.9 class 0.0 = 0.741 +- 0.186 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 class 1.0 = 0.837 +- 0.186 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all KL = 0.866 +- 0.186 (in-sample avg dev_std = 0.278)
SUFF++ for r=0.9 all L1 = 0.825 +- 0.196 (in-sample avg dev_std = 0.278)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.721
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
SUFF++ for r=0.3 class 0.0 = 0.565 +- 0.182 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 class 1.0 = 0.608 +- 0.182 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 all KL = 0.692 +- 0.182 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.142 (in-sample avg dev_std = 0.450)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.698
SUFF++ for r=0.6 class 0.0 = 0.56 +- 0.200 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1.0 = 0.71 +- 0.200 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.734 +- 0.200 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.692 +- 0.187 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.79
SUFF++ for r=0.9 class 0.0 = 0.705 +- 0.201 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 class 1.0 = 0.823 +- 0.201 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all KL = 0.846 +- 0.201 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.9 all L1 = 0.809 +- 0.206 (in-sample avg dev_std = 0.293)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.588
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.533
SUFF++ for r=0.3 class 0.0 = 0.604 +- 0.168 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 1.0 = 0.605 +- 0.168 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all KL = 0.713 +- 0.168 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all L1 = 0.605 +- 0.127 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
SUFF++ for r=0.6 class 0.0 = 0.639 +- 0.192 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1.0 = 0.676 +- 0.192 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.731 +- 0.192 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.67 +- 0.177 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.659
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.652
SUFF++ for r=0.9 class 0.0 = 0.761 +- 0.194 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 class 1.0 = 0.791 +- 0.194 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all KL = 0.84 +- 0.194 (in-sample avg dev_std = 0.315)
SUFF++ for r=0.9 all L1 = 0.786 +- 0.198 (in-sample avg dev_std = 0.315)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.694
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.684
NEC for r=0.3 class 0.0 = 0.343 +- 0.171 (in-sample avg dev_std = 0.339)
NEC for r=0.3 class 1.0 = 0.313 +- 0.171 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all KL = 0.201 +- 0.171 (in-sample avg dev_std = 0.339)
NEC for r=0.3 all L1 = 0.317 +- 0.158 (in-sample avg dev_std = 0.339)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.771
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.781
NEC for r=0.6 class 0.0 = 0.291 +- 0.163 (in-sample avg dev_std = 0.291)
NEC for r=0.6 class 1.0 = 0.217 +- 0.163 (in-sample avg dev_std = 0.291)
NEC for r=0.6 all KL = 0.156 +- 0.163 (in-sample avg dev_std = 0.291)
NEC for r=0.6 all L1 = 0.226 +- 0.166 (in-sample avg dev_std = 0.291)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.796
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.794
NEC for r=0.9 class 0.0 = 0.223 +- 0.163 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 1.0 = 0.138 +- 0.163 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all KL = 0.104 +- 0.163 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all L1 = 0.148 +- 0.171 (in-sample avg dev_std = 0.256)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.799
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.792
NEC for r=1.0 class 0.0 = 0.227 +- 0.169 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 1.0 = 0.125 +- 0.169 (in-sample avg dev_std = 0.254)
NEC for r=1.0 all KL = 0.101 +- 0.169 (in-sample avg dev_std = 0.254)
NEC for r=1.0 all L1 = 0.137 +- 0.172 (in-sample avg dev_std = 0.254)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.721
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.663
NEC for r=0.3 class 0.0 = 0.353 +- 0.181 (in-sample avg dev_std = 0.353)
NEC for r=0.3 class 1.0 = 0.326 +- 0.181 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all KL = 0.222 +- 0.181 (in-sample avg dev_std = 0.353)
NEC for r=0.3 all L1 = 0.329 +- 0.155 (in-sample avg dev_std = 0.353)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.818
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.772
NEC for r=0.6 class 0.0 = 0.295 +- 0.176 (in-sample avg dev_std = 0.301)
NEC for r=0.6 class 1.0 = 0.221 +- 0.176 (in-sample avg dev_std = 0.301)
NEC for r=0.6 all KL = 0.165 +- 0.176 (in-sample avg dev_std = 0.301)
NEC for r=0.6 all L1 = 0.23 +- 0.167 (in-sample avg dev_std = 0.301)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.79
NEC for r=0.9 class 0.0 = 0.244 +- 0.172 (in-sample avg dev_std = 0.264)
NEC for r=0.9 class 1.0 = 0.148 +- 0.172 (in-sample avg dev_std = 0.264)
NEC for r=0.9 all KL = 0.118 +- 0.172 (in-sample avg dev_std = 0.264)
NEC for r=0.9 all L1 = 0.16 +- 0.177 (in-sample avg dev_std = 0.264)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.828
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.795
NEC for r=1.0 class 0.0 = 0.237 +- 0.171 (in-sample avg dev_std = 0.268)
NEC for r=1.0 class 1.0 = 0.134 +- 0.171 (in-sample avg dev_std = 0.268)
NEC for r=1.0 all KL = 0.111 +- 0.171 (in-sample avg dev_std = 0.268)
NEC for r=1.0 all L1 = 0.146 +- 0.173 (in-sample avg dev_std = 0.268)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.588
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.589
NEC for r=0.3 class 0.0 = 0.337 +- 0.167 (in-sample avg dev_std = 0.325)
NEC for r=0.3 class 1.0 = 0.316 +- 0.167 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all KL = 0.195 +- 0.167 (in-sample avg dev_std = 0.325)
NEC for r=0.3 all L1 = 0.319 +- 0.156 (in-sample avg dev_std = 0.325)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.65
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.652
NEC for r=0.6 class 0.0 = 0.266 +- 0.156 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 1.0 = 0.241 +- 0.156 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all KL = 0.161 +- 0.156 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all L1 = 0.245 +- 0.161 (in-sample avg dev_std = 0.299)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.659
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.658
NEC for r=0.9 class 0.0 = 0.215 +- 0.162 (in-sample avg dev_std = 0.290)
NEC for r=0.9 class 1.0 = 0.187 +- 0.162 (in-sample avg dev_std = 0.290)
NEC for r=0.9 all KL = 0.13 +- 0.162 (in-sample avg dev_std = 0.290)
NEC for r=0.9 all L1 = 0.192 +- 0.173 (in-sample avg dev_std = 0.290)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.659
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.661
NEC for r=1.0 class 0.0 = 0.199 +- 0.171 (in-sample avg dev_std = 0.286)
NEC for r=1.0 class 1.0 = 0.176 +- 0.171 (in-sample avg dev_std = 0.286)
NEC for r=1.0 all KL = 0.127 +- 0.171 (in-sample avg dev_std = 0.286)
NEC for r=1.0 all L1 = 0.18 +- 0.173 (in-sample avg dev_std = 0.286)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:19:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:19:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:20:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:20:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:20:31 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:20:46 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ROC-AUC: 0.9786
Train Loss: 0.1194
ID Validation ROC-AUC: 0.9204
ID Validation Loss: 0.2571
ID Test ROC-AUC: 0.9175
ID Test Loss: 0.2682
OOD Validation ROC-AUC: 0.6270
OOD Validation Loss: 0.5487
OOD Test ROC-AUC: 0.6845
OOD Test Loss: 0.6993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8637
Train Loss: 0.3014
ID Validation ROC-AUC: 0.8644
ID Validation Loss: 0.3040
ID Test ROC-AUC: 0.8624
ID Test Loss: 0.3078
OOD Validation ROC-AUC: 0.7048
OOD Validation Loss: 0.2705
OOD Test ROC-AUC: 0.7173
OOD Test Loss: 0.4554

[0m[1;37mINFO[0m: [1mChartInfo 0.9175 0.6845 0.8624 0.7173 0.8644 0.7048[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:21:01 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:21:05 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:21:09 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.497
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.452
SUFF++ for r=0.3 class 0.0 = 0.873 +- 0.193 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.3 class 1.0 = 0.834 +- 0.193 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.3 all KL = 0.825 +- 0.193 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.3 all L1 = 0.838 +- 0.161 (in-sample avg dev_std = 0.368)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.509
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.434
SUFF++ for r=0.6 class 0.0 = 0.807 +- 0.199 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 1.0 = 0.787 +- 0.199 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all KL = 0.802 +- 0.199 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all L1 = 0.789 +- 0.174 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.584
SUFF++ for r=0.9 class 0.0 = 0.865 +- 0.129 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 1.0 = 0.786 +- 0.129 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all KL = 0.896 +- 0.129 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all L1 = 0.795 +- 0.157 (in-sample avg dev_std = 0.260)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.499
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.466
SUFF++ for r=0.3 class 0.0 = 0.861 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 class 1.0 = 0.839 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all KL = 0.823 +- 0.195 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all L1 = 0.842 +- 0.152 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.504
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.488
SUFF++ for r=0.6 class 0.0 = 0.845 +- 0.197 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1.0 = 0.786 +- 0.197 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.801 +- 0.197 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.166 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.661
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.623
SUFF++ for r=0.9 class 0.0 = 0.888 +- 0.135 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 class 1.0 = 0.787 +- 0.135 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all KL = 0.894 +- 0.135 (in-sample avg dev_std = 0.279)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.152 (in-sample avg dev_std = 0.279)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.51
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.485
SUFF++ for r=0.3 class 0.0 = 0.879 +- 0.163 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 class 1.0 = 0.857 +- 0.163 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 all KL = 0.868 +- 0.163 (in-sample avg dev_std = 0.299)
SUFF++ for r=0.3 all L1 = 0.861 +- 0.146 (in-sample avg dev_std = 0.299)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.522
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.504
SUFF++ for r=0.6 class 0.0 = 0.835 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 class 1.0 = 0.797 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all KL = 0.833 +- 0.188 (in-sample avg dev_std = 0.367)
SUFF++ for r=0.6 all L1 = 0.803 +- 0.169 (in-sample avg dev_std = 0.367)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.571
SUFF++ for r=0.9 class 0.0 = 0.881 +- 0.121 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 1.0 = 0.824 +- 0.121 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all KL = 0.923 +- 0.121 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all L1 = 0.834 +- 0.145 (in-sample avg dev_std = 0.223)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.496
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.47
NEC for r=0.3 class 0.0 = 0.068 +- 0.113 (in-sample avg dev_std = 0.166)
NEC for r=0.3 class 1.0 = 0.085 +- 0.113 (in-sample avg dev_std = 0.166)
NEC for r=0.3 all KL = 0.055 +- 0.113 (in-sample avg dev_std = 0.166)
NEC for r=0.3 all L1 = 0.083 +- 0.121 (in-sample avg dev_std = 0.166)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.508
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.55
NEC for r=0.6 class 0.0 = 0.083 +- 0.146 (in-sample avg dev_std = 0.240)
NEC for r=0.6 class 1.0 = 0.123 +- 0.146 (in-sample avg dev_std = 0.240)
NEC for r=0.6 all KL = 0.079 +- 0.146 (in-sample avg dev_std = 0.240)
NEC for r=0.6 all L1 = 0.119 +- 0.146 (in-sample avg dev_std = 0.240)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.621
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.63
NEC for r=0.9 class 0.0 = 0.115 +- 0.105 (in-sample avg dev_std = 0.224)
NEC for r=0.9 class 1.0 = 0.167 +- 0.105 (in-sample avg dev_std = 0.224)
NEC for r=0.9 all KL = 0.07 +- 0.105 (in-sample avg dev_std = 0.224)
NEC for r=0.9 all L1 = 0.161 +- 0.134 (in-sample avg dev_std = 0.224)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.642
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.643
NEC for r=1.0 class 0.0 = 0.117 +- 0.102 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 1.0 = 0.167 +- 0.102 (in-sample avg dev_std = 0.222)
NEC for r=1.0 all KL = 0.068 +- 0.102 (in-sample avg dev_std = 0.222)
NEC for r=1.0 all L1 = 0.161 +- 0.132 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.499
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.485
NEC for r=0.3 class 0.0 = 0.065 +- 0.123 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 1.0 = 0.081 +- 0.123 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all KL = 0.056 +- 0.123 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all L1 = 0.079 +- 0.117 (in-sample avg dev_std = 0.185)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.504
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.538
NEC for r=0.6 class 0.0 = 0.084 +- 0.150 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 1.0 = 0.121 +- 0.150 (in-sample avg dev_std = 0.234)
NEC for r=0.6 all KL = 0.08 +- 0.150 (in-sample avg dev_std = 0.234)
NEC for r=0.6 all L1 = 0.117 +- 0.147 (in-sample avg dev_std = 0.234)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.661
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.648
NEC for r=0.9 class 0.0 = 0.107 +- 0.115 (in-sample avg dev_std = 0.238)
NEC for r=0.9 class 1.0 = 0.174 +- 0.115 (in-sample avg dev_std = 0.238)
NEC for r=0.9 all KL = 0.075 +- 0.115 (in-sample avg dev_std = 0.238)
NEC for r=0.9 all L1 = 0.166 +- 0.138 (in-sample avg dev_std = 0.238)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.694
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.677
NEC for r=1.0 class 0.0 = 0.098 +- 0.107 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 1.0 = 0.17 +- 0.107 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all KL = 0.069 +- 0.107 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all L1 = 0.162 +- 0.130 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.511
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.514
NEC for r=0.3 class 0.0 = 0.078 +- 0.113 (in-sample avg dev_std = 0.168)
NEC for r=0.3 class 1.0 = 0.097 +- 0.113 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all KL = 0.061 +- 0.113 (in-sample avg dev_std = 0.168)
NEC for r=0.3 all L1 = 0.094 +- 0.131 (in-sample avg dev_std = 0.168)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.521
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.522
NEC for r=0.6 class 0.0 = 0.112 +- 0.141 (in-sample avg dev_std = 0.222)
NEC for r=0.6 class 1.0 = 0.12 +- 0.141 (in-sample avg dev_std = 0.222)
NEC for r=0.6 all KL = 0.074 +- 0.141 (in-sample avg dev_std = 0.222)
NEC for r=0.6 all L1 = 0.119 +- 0.146 (in-sample avg dev_std = 0.222)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.579
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.561
NEC for r=0.9 class 0.0 = 0.126 +- 0.112 (in-sample avg dev_std = 0.209)
NEC for r=0.9 class 1.0 = 0.158 +- 0.112 (in-sample avg dev_std = 0.209)
NEC for r=0.9 all KL = 0.067 +- 0.112 (in-sample avg dev_std = 0.209)
NEC for r=0.9 all L1 = 0.152 +- 0.135 (in-sample avg dev_std = 0.209)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.577
NEC for r=1.0 class 0.0 = 0.132 +- 0.105 (in-sample avg dev_std = 0.199)
NEC for r=1.0 class 1.0 = 0.153 +- 0.105 (in-sample avg dev_std = 0.199)
NEC for r=1.0 all KL = 0.061 +- 0.105 (in-sample avg dev_std = 0.199)
NEC for r=1.0 all L1 = 0.149 +- 0.129 (in-sample avg dev_std = 0.199)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:25:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:25:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:25:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:25:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:25:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:26:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9567
Train Loss: 0.1730
ID Validation ROC-AUC: 0.9183
ID Validation Loss: 0.2552
ID Test ROC-AUC: 0.9169
ID Test Loss: 0.2613
OOD Validation ROC-AUC: 0.6320
OOD Validation Loss: 0.4599
OOD Test ROC-AUC: 0.7081
OOD Test Loss: 0.6149

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 16...
[0m[1;37mINFO[0m: [1mCheckpoint 16: 
-----------------------------------
Train ROC-AUC: 0.9033
Train Loss: 0.2628
ID Validation ROC-AUC: 0.8960
ID Validation Loss: 0.2703
ID Test ROC-AUC: 0.8970
ID Test Loss: 0.2728
OOD Validation ROC-AUC: 0.6969
OOD Validation Loss: 0.2831
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.4601

[0m[1;37mINFO[0m: [1mChartInfo 0.9169 0.7081 0.8970 0.7331 0.8960 0.6969[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:26:21 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:26:25 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:26:29 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.588
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.526
SUFF++ for r=0.3 class 0.0 = 0.71 +- 0.103 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 class 1.0 = 0.692 +- 0.103 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 all KL = 0.867 +- 0.103 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.3 all L1 = 0.694 +- 0.100 (in-sample avg dev_std = 0.304)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.677
SUFF++ for r=0.6 class 0.0 = 0.697 +- 0.131 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.6 class 1.0 = 0.674 +- 0.131 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.6 all KL = 0.813 +- 0.131 (in-sample avg dev_std = 0.349)
SUFF++ for r=0.6 all L1 = 0.676 +- 0.133 (in-sample avg dev_std = 0.349)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.766
SUFF++ for r=0.9 class 0.0 = 0.79 +- 0.132 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1.0 = 0.8 +- 0.132 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.895 +- 0.132 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.164 (in-sample avg dev_std = 0.225)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.5
SUFF++ for r=0.3 class 0.0 = 0.7 +- 0.104 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 class 1.0 = 0.686 +- 0.104 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 all KL = 0.861 +- 0.104 (in-sample avg dev_std = 0.312)
SUFF++ for r=0.3 all L1 = 0.688 +- 0.102 (in-sample avg dev_std = 0.312)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
SUFF++ for r=0.6 class 0.0 = 0.703 +- 0.140 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 1.0 = 0.661 +- 0.140 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all KL = 0.796 +- 0.140 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all L1 = 0.666 +- 0.129 (in-sample avg dev_std = 0.371)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.812
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.789
SUFF++ for r=0.9 class 0.0 = 0.775 +- 0.137 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 class 1.0 = 0.777 +- 0.137 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 all KL = 0.879 +- 0.137 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.9 all L1 = 0.776 +- 0.175 (in-sample avg dev_std = 0.246)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.509
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.517
SUFF++ for r=0.3 class 0.0 = 0.722 +- 0.109 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 class 1.0 = 0.699 +- 0.109 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 all KL = 0.873 +- 0.109 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.3 all L1 = 0.702 +- 0.099 (in-sample avg dev_std = 0.298)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.598
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.581
SUFF++ for r=0.6 class 0.0 = 0.705 +- 0.122 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 class 1.0 = 0.68 +- 0.122 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 all KL = 0.83 +- 0.122 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.6 all L1 = 0.684 +- 0.121 (in-sample avg dev_std = 0.351)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.633
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.618
SUFF++ for r=0.9 class 0.0 = 0.776 +- 0.118 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 class 1.0 = 0.795 +- 0.118 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all KL = 0.903 +- 0.118 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.9 all L1 = 0.792 +- 0.152 (in-sample avg dev_std = 0.238)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.587
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.619
NEC for r=0.3 class 0.0 = 0.281 +- 0.095 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 1.0 = 0.254 +- 0.095 (in-sample avg dev_std = 0.232)
NEC for r=0.3 all KL = 0.095 +- 0.095 (in-sample avg dev_std = 0.232)
NEC for r=0.3 all L1 = 0.257 +- 0.120 (in-sample avg dev_std = 0.232)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.7
NEC for r=0.6 class 0.0 = 0.245 +- 0.121 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 1.0 = 0.259 +- 0.121 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all KL = 0.123 +- 0.121 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all L1 = 0.257 +- 0.136 (in-sample avg dev_std = 0.266)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.788
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.774
NEC for r=0.9 class 0.0 = 0.196 +- 0.109 (in-sample avg dev_std = 0.222)
NEC for r=0.9 class 1.0 = 0.187 +- 0.109 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all KL = 0.09 +- 0.109 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all L1 = 0.188 +- 0.151 (in-sample avg dev_std = 0.222)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.791
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.777
NEC for r=1.0 class 0.0 = 0.193 +- 0.099 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1.0 = 0.161 +- 0.099 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.074 +- 0.099 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.164 +- 0.148 (in-sample avg dev_std = 0.205)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.582
NEC for r=0.3 class 0.0 = 0.265 +- 0.090 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 1.0 = 0.246 +- 0.090 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.089 +- 0.090 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.249 +- 0.114 (in-sample avg dev_std = 0.231)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.675
NEC for r=0.6 class 0.0 = 0.234 +- 0.121 (in-sample avg dev_std = 0.271)
NEC for r=0.6 class 1.0 = 0.256 +- 0.121 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all KL = 0.123 +- 0.121 (in-sample avg dev_std = 0.271)
NEC for r=0.6 all L1 = 0.254 +- 0.128 (in-sample avg dev_std = 0.271)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.812
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.776
NEC for r=0.9 class 0.0 = 0.226 +- 0.116 (in-sample avg dev_std = 0.243)
NEC for r=0.9 class 1.0 = 0.197 +- 0.116 (in-sample avg dev_std = 0.243)
NEC for r=0.9 all KL = 0.101 +- 0.116 (in-sample avg dev_std = 0.243)
NEC for r=0.9 all L1 = 0.201 +- 0.151 (in-sample avg dev_std = 0.243)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.825
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.794
NEC for r=1.0 class 0.0 = 0.207 +- 0.107 (in-sample avg dev_std = 0.229)
NEC for r=1.0 class 1.0 = 0.176 +- 0.107 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all KL = 0.085 +- 0.107 (in-sample avg dev_std = 0.229)
NEC for r=1.0 all L1 = 0.18 +- 0.150 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.508
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.55
NEC for r=0.3 class 0.0 = 0.252 +- 0.103 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 1.0 = 0.262 +- 0.103 (in-sample avg dev_std = 0.227)
NEC for r=0.3 all KL = 0.096 +- 0.103 (in-sample avg dev_std = 0.227)
NEC for r=0.3 all L1 = 0.261 +- 0.122 (in-sample avg dev_std = 0.227)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.598
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.601
NEC for r=0.6 class 0.0 = 0.246 +- 0.111 (in-sample avg dev_std = 0.270)
NEC for r=0.6 class 1.0 = 0.266 +- 0.111 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all KL = 0.119 +- 0.111 (in-sample avg dev_std = 0.270)
NEC for r=0.6 all L1 = 0.263 +- 0.126 (in-sample avg dev_std = 0.270)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.633
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.635
NEC for r=0.9 class 0.0 = 0.234 +- 0.123 (in-sample avg dev_std = 0.247)
NEC for r=0.9 class 1.0 = 0.219 +- 0.123 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all KL = 0.103 +- 0.123 (in-sample avg dev_std = 0.247)
NEC for r=0.9 all L1 = 0.221 +- 0.153 (in-sample avg dev_std = 0.247)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.647
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.655
NEC for r=1.0 class 0.0 = 0.219 +- 0.124 (in-sample avg dev_std = 0.255)
NEC for r=1.0 class 1.0 = 0.205 +- 0.124 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all KL = 0.1 +- 0.124 (in-sample avg dev_std = 0.255)
NEC for r=1.0 all L1 = 0.207 +- 0.158 (in-sample avg dev_std = 0.255)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.895, 0.935, 0.965, 1.0], 'all_L1': [0.811, 0.883, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.906, 0.834, 0.908, 1.0], 'all_L1': [0.746, 0.685, 0.793, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.702, 0.747, 0.866, 1.0], 'all_L1': [0.604, 0.704, 0.825, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.825, 0.802, 0.896, 1.0], 'all_L1': [0.838, 0.789, 0.795, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.867, 0.813, 0.895, 1.0], 'all_L1': [0.694, 0.676, 0.799, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.069, 0.055, 0.036, 0.028], 'all_L1': [0.151, 0.102, 0.088, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.064, 0.061, 0.05], 'all_L1': [0.176, 0.186, 0.161, 0.14]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.156, 0.104, 0.101], 'all_L1': [0.317, 0.226, 0.148, 0.137]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.079, 0.07, 0.068], 'all_L1': [0.083, 0.119, 0.161, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.123, 0.09, 0.074], 'all_L1': [0.257, 0.257, 0.188, 0.164]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.893, 0.933, 0.962, 1.0], 'all_L1': [0.807, 0.879, 0.902, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.912, 0.848, 0.903, 1.0], 'all_L1': [0.751, 0.698, 0.787, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.692, 0.734, 0.846, 1.0], 'all_L1': [0.603, 0.692, 0.809, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.823, 0.801, 0.894, 1.0], 'all_L1': [0.842, 0.793, 0.799, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.861, 0.796, 0.879, 1.0], 'all_L1': [0.688, 0.666, 0.776, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.076, 0.053, 0.036, 0.031], 'all_L1': [0.161, 0.104, 0.093, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.041, 0.063, 0.064, 0.051], 'all_L1': [0.168, 0.186, 0.161, 0.139]}), defaultdict(<class 'list'>, {'all_KL': [0.222, 0.165, 0.118, 0.111], 'all_L1': [0.329, 0.23, 0.16, 0.146]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.08, 0.075, 0.069], 'all_L1': [0.079, 0.117, 0.166, 0.162]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.123, 0.101, 0.085], 'all_L1': [0.249, 0.254, 0.201, 0.18]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.89, 0.918, 0.954, 1.0], 'all_L1': [0.784, 0.845, 0.88, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.9, 0.856, 0.918, 1.0], 'all_L1': [0.742, 0.708, 0.8, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.713, 0.731, 0.84, 1.0], 'all_L1': [0.605, 0.67, 0.786, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.833, 0.923, 1.0], 'all_L1': [0.861, 0.803, 0.834, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.83, 0.903, 1.0], 'all_L1': [0.702, 0.684, 0.792, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.073, 0.065, 0.042, 0.038], 'all_L1': [0.173, 0.132, 0.113, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.045, 0.056, 0.053, 0.044], 'all_L1': [0.173, 0.175, 0.159, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.161, 0.13, 0.127], 'all_L1': [0.319, 0.245, 0.192, 0.18]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.074, 0.067, 0.061], 'all_L1': [0.094, 0.119, 0.152, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.119, 0.103, 0.1], 'all_L1': [0.261, 0.263, 0.221, 0.207]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.739 +- 0.084, 0.747 +- 0.079, 0.824 +- 0.044, 1.000 +- 0.000
suff++ class all_KL  =  0.839 +- 0.074, 0.826 +- 0.062, 0.906 +- 0.033, 1.000 +- 0.000
suff++_acc_int  =  0.548 +- 0.054, 0.633 +- 0.103, 0.729 +- 0.075
nec class all_L1  =  0.197 +- 0.082, 0.178 +- 0.060, 0.149 +- 0.033, 0.137 +- 0.029
nec class all_KL  =  0.093 +- 0.056, 0.095 +- 0.038, 0.072 +- 0.024, 0.064 +- 0.024
nec_acc_int  =  0.617 +- 0.081, 0.701 +- 0.085, 0.752 +- 0.064, 0.754 +- 0.058

Eval split id_test
suff++ class all_L1  =  0.738 +- 0.085, 0.746 +- 0.079, 0.815 +- 0.045, 1.000 +- 0.000
suff++ class all_KL  =  0.836 +- 0.078, 0.822 +- 0.066, 0.897 +- 0.038, 1.000 +- 0.000
suff++_acc_int  =  0.549 +- 0.056, 0.645 +- 0.081, 0.749 +- 0.064
nec class all_L1  =  0.197 +- 0.085, 0.178 +- 0.060, 0.156 +- 0.035, 0.143 +- 0.030
nec class all_KL  =  0.097 +- 0.065, 0.097 +- 0.042, 0.079 +- 0.029, 0.069 +- 0.028
nec_acc_int  =  0.608 +- 0.080, 0.701 +- 0.094, 0.765 +- 0.062, 0.774 +- 0.051

Eval split test
suff++ class all_L1  =  0.739 +- 0.085, 0.742 +- 0.069, 0.818 +- 0.035, 1.000 +- 0.000
suff++ class all_KL  =  0.849 +- 0.069, 0.834 +- 0.060, 0.908 +- 0.038, 1.000 +- 0.000
suff++_acc_int  =  0.535 +- 0.034, 0.586 +- 0.044, 0.630 +- 0.033
nec class all_L1  =  0.204 +- 0.078, 0.187 +- 0.058, 0.167 +- 0.037, 0.158 +- 0.033
nec class all_KL  =  0.094 +- 0.053, 0.095 +- 0.039, 0.079 +- 0.033, 0.074 +- 0.034
nec_acc_int  =  0.565 +- 0.030, 0.613 +- 0.049, 0.639 +- 0.041, 0.649 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.468 +- 0.009, 0.463 +- 0.019, 0.487 +- 0.008, 0.568 +- 0.015
Faith. Armon (L1)= 		  =  0.296 +- 0.093, 0.279 +- 0.074, 0.250 +- 0.048, 0.239 +- 0.047
Faith. GMean (L1)= 	  =  0.367 +- 0.062, 0.356 +- 0.047, 0.347 +- 0.035, 0.367 +- 0.043
Faith. Aritm (KL)= 		  =  0.466 +- 0.017, 0.461 +- 0.019, 0.489 +- 0.007, 0.532 +- 0.012
Faith. Armon (KL)= 		  =  0.161 +- 0.081, 0.168 +- 0.059, 0.133 +- 0.040, 0.120 +- 0.043
Faith. GMean (KL)= 	  =  0.266 +- 0.062, 0.273 +- 0.047, 0.251 +- 0.040, 0.248 +- 0.050

Eval split id_test
Faith. Aritm (L1)= 		  =  0.468 +- 0.009, 0.462 +- 0.016, 0.485 +- 0.008, 0.572 +- 0.015
Faith. Armon (L1)= 		  =  0.296 +- 0.096, 0.279 +- 0.073, 0.259 +- 0.049, 0.250 +- 0.047
Faith. GMean (L1)= 	  =  0.367 +- 0.064, 0.356 +- 0.046, 0.353 +- 0.035, 0.376 +- 0.042
Faith. Aritm (KL)= 		  =  0.466 +- 0.016, 0.460 +- 0.018, 0.488 +- 0.006, 0.535 +- 0.014
Faith. Armon (KL)= 		  =  0.164 +- 0.091, 0.169 +- 0.063, 0.143 +- 0.048, 0.129 +- 0.048
Faith. GMean (KL)= 	  =  0.267 +- 0.069, 0.274 +- 0.049, 0.260 +- 0.046, 0.258 +- 0.054

Eval split test
Faith. Aritm (L1)= 		  =  0.471 +- 0.010, 0.464 +- 0.016, 0.493 +- 0.009, 0.579 +- 0.017
Faith. Armon (L1)= 		  =  0.306 +- 0.087, 0.291 +- 0.069, 0.275 +- 0.049, 0.271 +- 0.050
Faith. GMean (L1)= 	  =  0.376 +- 0.056, 0.365 +- 0.043, 0.367 +- 0.035, 0.395 +- 0.042
Faith. Aritm (KL)= 		  =  0.471 +- 0.011, 0.464 +- 0.017, 0.493 +- 0.007, 0.537 +- 0.017
Faith. Armon (KL)= 		  =  0.163 +- 0.077, 0.167 +- 0.060, 0.143 +- 0.054, 0.136 +- 0.059
Faith. GMean (KL)= 	  =  0.270 +- 0.059, 0.274 +- 0.047, 0.261 +- 0.049, 0.265 +- 0.062
Computed for split load_split = id



Completed in  0:26:44.043062  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:30:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:30:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:31:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:31:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:31:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:31:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:32:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ROC-AUC: 0.8542
Train Loss: 0.3681
ID Validation ROC-AUC: 0.8444
ID Validation Loss: 0.3719
ID Test ROC-AUC: 0.8506
ID Test Loss: 0.3688
OOD Validation ROC-AUC: 0.6551
OOD Validation Loss: 0.4966
OOD Test ROC-AUC: 0.6876
OOD Test Loss: 0.5236

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ROC-AUC: 0.8110
Train Loss: 0.3061
ID Validation ROC-AUC: 0.8068
ID Validation Loss: 0.3085
ID Test ROC-AUC: 0.8111
ID Test Loss: 0.3116
OOD Validation ROC-AUC: 0.6855
OOD Validation Loss: 0.2737
OOD Test ROC-AUC: 0.6763
OOD Test Loss: 0.4405

[0m[1;37mINFO[0m: [1mChartInfo 0.8506 0.6876 0.8111 0.6763 0.8068 0.6855[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:32:01 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:32:06 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:32:10 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.649
SUFF++ for r=0.3 class 0.0 = 0.945 +- 0.023 (in-sample avg dev_std = 0.068)
SUFF++ for r=0.3 class 1.0 = 0.932 +- 0.023 (in-sample avg dev_std = 0.068)
SUFF++ for r=0.3 all KL = 0.993 +- 0.023 (in-sample avg dev_std = 0.068)
SUFF++ for r=0.3 all L1 = 0.933 +- 0.054 (in-sample avg dev_std = 0.068)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.658
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.664
SUFF++ for r=0.6 class 0.0 = 0.946 +- 0.014 (in-sample avg dev_std = 0.078)
SUFF++ for r=0.6 class 1.0 = 0.928 +- 0.014 (in-sample avg dev_std = 0.078)
SUFF++ for r=0.6 all KL = 0.992 +- 0.014 (in-sample avg dev_std = 0.078)
SUFF++ for r=0.6 all L1 = 0.931 +- 0.055 (in-sample avg dev_std = 0.078)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.68
SUFF++ for r=0.9 class 0.0 = 0.956 +- 0.019 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.019 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all KL = 0.993 +- 0.019 (in-sample avg dev_std = 0.070)
SUFF++ for r=0.9 all L1 = 0.94 +- 0.063 (in-sample avg dev_std = 0.070)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.697
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.681
SUFF++ for r=0.3 class 0.0 = 0.948 +- 0.026 (in-sample avg dev_std = 0.067)
SUFF++ for r=0.3 class 1.0 = 0.932 +- 0.026 (in-sample avg dev_std = 0.067)
SUFF++ for r=0.3 all KL = 0.993 +- 0.026 (in-sample avg dev_std = 0.067)
SUFF++ for r=0.3 all L1 = 0.934 +- 0.056 (in-sample avg dev_std = 0.067)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.699
SUFF++ for r=0.6 class 0.0 = 0.947 +- 0.015 (in-sample avg dev_std = 0.077)
SUFF++ for r=0.6 class 1.0 = 0.931 +- 0.015 (in-sample avg dev_std = 0.077)
SUFF++ for r=0.6 all KL = 0.993 +- 0.015 (in-sample avg dev_std = 0.077)
SUFF++ for r=0.6 all L1 = 0.933 +- 0.055 (in-sample avg dev_std = 0.077)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.736
SUFF++ for r=0.9 class 0.0 = 0.955 +- 0.018 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.018 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 all KL = 0.993 +- 0.018 (in-sample avg dev_std = 0.072)
SUFF++ for r=0.9 all L1 = 0.94 +- 0.060 (in-sample avg dev_std = 0.072)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.603
SUFF++ for r=0.3 class 0.0 = 0.943 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.3 class 1.0 = 0.942 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.3 all KL = 0.996 +- 0.007 (in-sample avg dev_std = 0.054)
SUFF++ for r=0.3 all L1 = 0.942 +- 0.036 (in-sample avg dev_std = 0.054)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.647
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.623
SUFF++ for r=0.6 class 0.0 = 0.945 +- 0.009 (in-sample avg dev_std = 0.063)
SUFF++ for r=0.6 class 1.0 = 0.941 +- 0.009 (in-sample avg dev_std = 0.063)
SUFF++ for r=0.6 all KL = 0.995 +- 0.009 (in-sample avg dev_std = 0.063)
SUFF++ for r=0.6 all L1 = 0.942 +- 0.044 (in-sample avg dev_std = 0.063)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.643
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.659
SUFF++ for r=0.9 class 0.0 = 0.952 +- 0.016 (in-sample avg dev_std = 0.063)
SUFF++ for r=0.9 class 1.0 = 0.946 +- 0.016 (in-sample avg dev_std = 0.063)
SUFF++ for r=0.9 all KL = 0.995 +- 0.016 (in-sample avg dev_std = 0.063)
SUFF++ for r=0.9 all L1 = 0.947 +- 0.053 (in-sample avg dev_std = 0.063)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.605
NEC for r=0.3 class 0.0 = 0.054 +- 0.007 (in-sample avg dev_std = 0.039)
NEC for r=0.3 class 1.0 = 0.049 +- 0.007 (in-sample avg dev_std = 0.039)
NEC for r=0.3 all KL = 0.003 +- 0.007 (in-sample avg dev_std = 0.039)
NEC for r=0.3 all L1 = 0.05 +- 0.037 (in-sample avg dev_std = 0.039)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.657
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.046 +- 0.010 (in-sample avg dev_std = 0.047)
NEC for r=0.6 class 1.0 = 0.049 +- 0.010 (in-sample avg dev_std = 0.047)
NEC for r=0.6 all KL = 0.004 +- 0.010 (in-sample avg dev_std = 0.047)
NEC for r=0.6 all L1 = 0.049 +- 0.043 (in-sample avg dev_std = 0.047)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.707
NEC for r=0.9 class 0.0 = 0.047 +- 0.015 (in-sample avg dev_std = 0.062)
NEC for r=0.9 class 1.0 = 0.057 +- 0.015 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all KL = 0.006 +- 0.015 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all L1 = 0.056 +- 0.054 (in-sample avg dev_std = 0.062)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.711
NEC for r=1.0 class 0.0 = 0.049 +- 0.017 (in-sample avg dev_std = 0.067)
NEC for r=1.0 class 1.0 = 0.063 +- 0.017 (in-sample avg dev_std = 0.067)
NEC for r=1.0 all KL = 0.007 +- 0.017 (in-sample avg dev_std = 0.067)
NEC for r=1.0 all L1 = 0.061 +- 0.058 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.697
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.666
NEC for r=0.3 class 0.0 = 0.048 +- 0.004 (in-sample avg dev_std = 0.036)
NEC for r=0.3 class 1.0 = 0.047 +- 0.004 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all KL = 0.002 +- 0.004 (in-sample avg dev_std = 0.036)
NEC for r=0.3 all L1 = 0.047 +- 0.031 (in-sample avg dev_std = 0.036)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.722
NEC for r=0.6 class 0.0 = 0.048 +- 0.007 (in-sample avg dev_std = 0.048)
NEC for r=0.6 class 1.0 = 0.048 +- 0.007 (in-sample avg dev_std = 0.048)
NEC for r=0.6 all KL = 0.003 +- 0.007 (in-sample avg dev_std = 0.048)
NEC for r=0.6 all L1 = 0.048 +- 0.040 (in-sample avg dev_std = 0.048)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.754
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.757
NEC for r=0.9 class 0.0 = 0.045 +- 0.014 (in-sample avg dev_std = 0.062)
NEC for r=0.9 class 1.0 = 0.055 +- 0.014 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all KL = 0.005 +- 0.014 (in-sample avg dev_std = 0.062)
NEC for r=0.9 all L1 = 0.053 +- 0.048 (in-sample avg dev_std = 0.062)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.761
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.769
NEC for r=1.0 class 0.0 = 0.045 +- 0.018 (in-sample avg dev_std = 0.067)
NEC for r=1.0 class 1.0 = 0.059 +- 0.018 (in-sample avg dev_std = 0.067)
NEC for r=1.0 all KL = 0.006 +- 0.018 (in-sample avg dev_std = 0.067)
NEC for r=1.0 all L1 = 0.057 +- 0.054 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.572
NEC for r=0.3 class 0.0 = 0.054 +- 0.005 (in-sample avg dev_std = 0.039)
NEC for r=0.3 class 1.0 = 0.051 +- 0.005 (in-sample avg dev_std = 0.039)
NEC for r=0.3 all KL = 0.003 +- 0.005 (in-sample avg dev_std = 0.039)
NEC for r=0.3 all L1 = 0.051 +- 0.037 (in-sample avg dev_std = 0.039)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.647
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.608
NEC for r=0.6 class 0.0 = 0.049 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 class 1.0 = 0.047 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 all KL = 0.003 +- 0.008 (in-sample avg dev_std = 0.046)
NEC for r=0.6 all L1 = 0.048 +- 0.040 (in-sample avg dev_std = 0.046)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.646
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.634
NEC for r=0.9 class 0.0 = 0.047 +- 0.014 (in-sample avg dev_std = 0.059)
NEC for r=0.9 class 1.0 = 0.053 +- 0.014 (in-sample avg dev_std = 0.059)
NEC for r=0.9 all KL = 0.005 +- 0.014 (in-sample avg dev_std = 0.059)
NEC for r=0.9 all L1 = 0.052 +- 0.048 (in-sample avg dev_std = 0.059)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.639
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.641
NEC for r=1.0 class 0.0 = 0.049 +- 0.014 (in-sample avg dev_std = 0.059)
NEC for r=1.0 class 1.0 = 0.056 +- 0.014 (in-sample avg dev_std = 0.059)
NEC for r=1.0 all KL = 0.005 +- 0.014 (in-sample avg dev_std = 0.059)
NEC for r=1.0 all L1 = 0.055 +- 0.049 (in-sample avg dev_std = 0.059)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:36:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:36:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:36:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:36:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:36:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:37:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ROC-AUC: 0.8660
Train Loss: 0.2893
ID Validation ROC-AUC: 0.8569
ID Validation Loss: 0.2955
ID Test ROC-AUC: 0.8563
ID Test Loss: 0.2953
OOD Validation ROC-AUC: 0.6683
OOD Validation Loss: 0.3919
OOD Test ROC-AUC: 0.6926
OOD Test Loss: 0.4681

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ROC-AUC: 0.8354
Train Loss: 0.2871
ID Validation ROC-AUC: 0.8308
ID Validation Loss: 0.2907
ID Test ROC-AUC: 0.8329
ID Test Loss: 0.2930
OOD Validation ROC-AUC: 0.6780
OOD Validation Loss: 0.2792
OOD Test ROC-AUC: 0.7033
OOD Test Loss: 0.4340

[0m[1;37mINFO[0m: [1mChartInfo 0.8563 0.6926 0.8329 0.7033 0.8308 0.6780[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:37:23 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:37:27 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:37:31 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.69
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.619
SUFF++ for r=0.3 class 0.0 = 0.859 +- 0.024 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 class 1.0 = 0.873 +- 0.024 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 all KL = 0.98 +- 0.024 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 all L1 = 0.871 +- 0.060 (in-sample avg dev_std = 0.119)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.679
SUFF++ for r=0.6 class 0.0 = 0.834 +- 0.027 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.6 class 1.0 = 0.847 +- 0.027 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.6 all KL = 0.972 +- 0.027 (in-sample avg dev_std = 0.144)
SUFF++ for r=0.6 all L1 = 0.846 +- 0.061 (in-sample avg dev_std = 0.144)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.721
SUFF++ for r=0.9 class 0.0 = 0.869 +- 0.040 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 class 1.0 = 0.862 +- 0.040 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 all KL = 0.973 +- 0.040 (in-sample avg dev_std = 0.131)
SUFF++ for r=0.9 all L1 = 0.863 +- 0.083 (in-sample avg dev_std = 0.131)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.75
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
SUFF++ for r=0.3 class 0.0 = 0.868 +- 0.032 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.3 class 1.0 = 0.871 +- 0.032 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.3 all KL = 0.98 +- 0.032 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.3 all L1 = 0.871 +- 0.057 (in-sample avg dev_std = 0.123)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.792
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.72
SUFF++ for r=0.6 class 0.0 = 0.849 +- 0.025 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.025 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.6 all KL = 0.972 +- 0.025 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.6 all L1 = 0.844 +- 0.058 (in-sample avg dev_std = 0.149)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.835
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.807
SUFF++ for r=0.9 class 0.0 = 0.888 +- 0.035 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 class 1.0 = 0.863 +- 0.035 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 all KL = 0.975 +- 0.035 (in-sample avg dev_std = 0.127)
SUFF++ for r=0.9 all L1 = 0.866 +- 0.077 (in-sample avg dev_std = 0.127)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.625
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.586
SUFF++ for r=0.3 class 0.0 = 0.861 +- 0.031 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.3 class 1.0 = 0.868 +- 0.031 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.3 all KL = 0.978 +- 0.031 (in-sample avg dev_std = 0.132)
SUFF++ for r=0.3 all L1 = 0.867 +- 0.063 (in-sample avg dev_std = 0.132)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.634
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.608
SUFF++ for r=0.6 class 0.0 = 0.844 +- 0.034 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.034 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.6 all KL = 0.97 +- 0.034 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.6 all L1 = 0.844 +- 0.069 (in-sample avg dev_std = 0.150)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.656
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.677
SUFF++ for r=0.9 class 0.0 = 0.877 +- 0.040 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 class 1.0 = 0.86 +- 0.040 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all KL = 0.974 +- 0.040 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all L1 = 0.863 +- 0.083 (in-sample avg dev_std = 0.126)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.691
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.689
NEC for r=0.3 class 0.0 = 0.104 +- 0.015 (in-sample avg dev_std = 0.082)
NEC for r=0.3 class 1.0 = 0.095 +- 0.015 (in-sample avg dev_std = 0.082)
NEC for r=0.3 all KL = 0.011 +- 0.015 (in-sample avg dev_std = 0.082)
NEC for r=0.3 all L1 = 0.096 +- 0.058 (in-sample avg dev_std = 0.082)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.727
NEC for r=0.6 class 0.0 = 0.113 +- 0.022 (in-sample avg dev_std = 0.104)
NEC for r=0.6 class 1.0 = 0.115 +- 0.022 (in-sample avg dev_std = 0.104)
NEC for r=0.6 all KL = 0.016 +- 0.022 (in-sample avg dev_std = 0.104)
NEC for r=0.6 all L1 = 0.115 +- 0.065 (in-sample avg dev_std = 0.104)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.745
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.766
NEC for r=0.9 class 0.0 = 0.134 +- 0.036 (in-sample avg dev_std = 0.131)
NEC for r=0.9 class 1.0 = 0.141 +- 0.036 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all KL = 0.027 +- 0.036 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all L1 = 0.14 +- 0.076 (in-sample avg dev_std = 0.131)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.759
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.779
NEC for r=1.0 class 0.0 = 0.135 +- 0.041 (in-sample avg dev_std = 0.136)
NEC for r=1.0 class 1.0 = 0.149 +- 0.041 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all KL = 0.031 +- 0.041 (in-sample avg dev_std = 0.136)
NEC for r=1.0 all L1 = 0.147 +- 0.080 (in-sample avg dev_std = 0.136)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.75
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.738
NEC for r=0.3 class 0.0 = 0.087 +- 0.023 (in-sample avg dev_std = 0.085)
NEC for r=0.3 class 1.0 = 0.096 +- 0.023 (in-sample avg dev_std = 0.085)
NEC for r=0.3 all KL = 0.011 +- 0.023 (in-sample avg dev_std = 0.085)
NEC for r=0.3 all L1 = 0.095 +- 0.058 (in-sample avg dev_std = 0.085)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.792
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.788
NEC for r=0.6 class 0.0 = 0.091 +- 0.020 (in-sample avg dev_std = 0.103)
NEC for r=0.6 class 1.0 = 0.114 +- 0.020 (in-sample avg dev_std = 0.103)
NEC for r=0.6 all KL = 0.015 +- 0.020 (in-sample avg dev_std = 0.103)
NEC for r=0.6 all L1 = 0.111 +- 0.061 (in-sample avg dev_std = 0.103)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.835
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.824
NEC for r=0.9 class 0.0 = 0.104 +- 0.028 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 1.0 = 0.14 +- 0.028 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all KL = 0.024 +- 0.028 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all L1 = 0.136 +- 0.067 (in-sample avg dev_std = 0.127)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.839
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.837
NEC for r=1.0 class 0.0 = 0.107 +- 0.031 (in-sample avg dev_std = 0.132)
NEC for r=1.0 class 1.0 = 0.144 +- 0.031 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all KL = 0.026 +- 0.031 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all L1 = 0.139 +- 0.069 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.625
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.651
NEC for r=0.3 class 0.0 = 0.107 +- 0.020 (in-sample avg dev_std = 0.085)
NEC for r=0.3 class 1.0 = 0.095 +- 0.020 (in-sample avg dev_std = 0.085)
NEC for r=0.3 all KL = 0.012 +- 0.020 (in-sample avg dev_std = 0.085)
NEC for r=0.3 all L1 = 0.097 +- 0.062 (in-sample avg dev_std = 0.085)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.107 +- 0.025 (in-sample avg dev_std = 0.106)
NEC for r=0.6 class 1.0 = 0.116 +- 0.025 (in-sample avg dev_std = 0.106)
NEC for r=0.6 all KL = 0.017 +- 0.025 (in-sample avg dev_std = 0.106)
NEC for r=0.6 all L1 = 0.115 +- 0.065 (in-sample avg dev_std = 0.106)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.656
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.665
NEC for r=0.9 class 0.0 = 0.128 +- 0.035 (in-sample avg dev_std = 0.135)
NEC for r=0.9 class 1.0 = 0.147 +- 0.035 (in-sample avg dev_std = 0.135)
NEC for r=0.9 all KL = 0.027 +- 0.035 (in-sample avg dev_std = 0.135)
NEC for r=0.9 all L1 = 0.144 +- 0.077 (in-sample avg dev_std = 0.135)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.671
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.681
NEC for r=1.0 class 0.0 = 0.137 +- 0.041 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1.0 = 0.156 +- 0.041 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.032 +- 0.041 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.153 +- 0.081 (in-sample avg dev_std = 0.142)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:41:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:41:22 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:41:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:12 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:27 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 75...
[0m[1;37mINFO[0m: [1mCheckpoint 75: 
-----------------------------------
Train ROC-AUC: 0.8606
Train Loss: 0.2740
ID Validation ROC-AUC: 0.8505
ID Validation Loss: 0.2797
ID Test ROC-AUC: 0.8539
ID Test Loss: 0.2798
OOD Validation ROC-AUC: 0.6671
OOD Validation Loss: 0.3235
OOD Test ROC-AUC: 0.6862
OOD Test Loss: 0.4325

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.8283
Train Loss: 0.2949
ID Validation ROC-AUC: 0.8256
ID Validation Loss: 0.2966
ID Test ROC-AUC: 0.8251
ID Test Loss: 0.2995
OOD Validation ROC-AUC: 0.6978
OOD Validation Loss: 0.2909
OOD Test ROC-AUC: 0.6930
OOD Test Loss: 0.4196

[0m[1;37mINFO[0m: [1mChartInfo 0.8539 0.6862 0.8251 0.6930 0.8256 0.6978[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:42:43 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:42:47 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:42:51 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.583
SUFF++ for r=0.3 class 0.0 = 0.91 +- 0.015 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 class 1.0 = 0.908 +- 0.015 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all KL = 0.989 +- 0.015 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all L1 = 0.908 +- 0.048 (in-sample avg dev_std = 0.094)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.694
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.666
SUFF++ for r=0.6 class 0.0 = 0.9 +- 0.021 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 class 1.0 = 0.88 +- 0.021 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 all KL = 0.982 +- 0.021 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 all L1 = 0.882 +- 0.056 (in-sample avg dev_std = 0.110)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.768
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.77
SUFF++ for r=0.9 class 0.0 = 0.915 +- 0.025 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.9 class 1.0 = 0.88 +- 0.025 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.9 all KL = 0.98 +- 0.025 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.9 all L1 = 0.884 +- 0.067 (in-sample avg dev_std = 0.101)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.642
SUFF++ for r=0.3 class 0.0 = 0.899 +- 0.016 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.3 class 1.0 = 0.909 +- 0.016 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.3 all KL = 0.988 +- 0.016 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.3 all L1 = 0.908 +- 0.049 (in-sample avg dev_std = 0.099)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.716
SUFF++ for r=0.6 class 0.0 = 0.891 +- 0.020 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.6 class 1.0 = 0.881 +- 0.020 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.6 all KL = 0.981 +- 0.020 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.6 all L1 = 0.882 +- 0.054 (in-sample avg dev_std = 0.116)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.816
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.796
SUFF++ for r=0.9 class 0.0 = 0.906 +- 0.026 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 class 1.0 = 0.882 +- 0.026 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all KL = 0.979 +- 0.026 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.065 (in-sample avg dev_std = 0.105)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.587
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.577
SUFF++ for r=0.3 class 0.0 = 0.912 +- 0.015 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 class 1.0 = 0.906 +- 0.015 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all KL = 0.989 +- 0.015 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all L1 = 0.907 +- 0.048 (in-sample avg dev_std = 0.094)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.61
SUFF++ for r=0.6 class 0.0 = 0.9 +- 0.019 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.6 class 1.0 = 0.886 +- 0.019 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.6 all KL = 0.983 +- 0.019 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.6 all L1 = 0.889 +- 0.053 (in-sample avg dev_std = 0.109)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.674
SUFF++ for r=0.9 class 0.0 = 0.909 +- 0.021 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 class 1.0 = 0.899 +- 0.021 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 all KL = 0.985 +- 0.021 (in-sample avg dev_std = 0.092)
SUFF++ for r=0.9 all L1 = 0.901 +- 0.061 (in-sample avg dev_std = 0.092)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.631
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.691
NEC for r=0.3 class 0.0 = 0.082 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.3 class 1.0 = 0.081 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.3 all KL = 0.009 +- 0.016 (in-sample avg dev_std = 0.071)
NEC for r=0.3 all L1 = 0.081 +- 0.055 (in-sample avg dev_std = 0.071)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.694
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.72
NEC for r=0.6 class 0.0 = 0.082 +- 0.019 (in-sample avg dev_std = 0.084)
NEC for r=0.6 class 1.0 = 0.095 +- 0.019 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all KL = 0.012 +- 0.019 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all L1 = 0.093 +- 0.055 (in-sample avg dev_std = 0.084)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.767
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.782
NEC for r=0.9 class 0.0 = 0.086 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 1.0 = 0.108 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all KL = 0.016 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all L1 = 0.106 +- 0.057 (in-sample avg dev_std = 0.091)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.797
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.799
NEC for r=1.0 class 0.0 = 0.087 +- 0.021 (in-sample avg dev_std = 0.095)
NEC for r=1.0 class 1.0 = 0.111 +- 0.021 (in-sample avg dev_std = 0.095)
NEC for r=1.0 all KL = 0.018 +- 0.021 (in-sample avg dev_std = 0.095)
NEC for r=1.0 all L1 = 0.109 +- 0.057 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.679
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.725
NEC for r=0.3 class 0.0 = 0.097 +- 0.022 (in-sample avg dev_std = 0.075)
NEC for r=0.3 class 1.0 = 0.081 +- 0.022 (in-sample avg dev_std = 0.075)
NEC for r=0.3 all KL = 0.01 +- 0.022 (in-sample avg dev_std = 0.075)
NEC for r=0.3 all L1 = 0.083 +- 0.063 (in-sample avg dev_std = 0.075)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.77
NEC for r=0.6 class 0.0 = 0.087 +- 0.019 (in-sample avg dev_std = 0.084)
NEC for r=0.6 class 1.0 = 0.095 +- 0.019 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all KL = 0.012 +- 0.019 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all L1 = 0.094 +- 0.055 (in-sample avg dev_std = 0.084)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.816
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.807
NEC for r=0.9 class 0.0 = 0.085 +- 0.023 (in-sample avg dev_std = 0.092)
NEC for r=0.9 class 1.0 = 0.109 +- 0.023 (in-sample avg dev_std = 0.092)
NEC for r=0.9 all KL = 0.017 +- 0.023 (in-sample avg dev_std = 0.092)
NEC for r=0.9 all L1 = 0.106 +- 0.059 (in-sample avg dev_std = 0.092)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.827
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.815
NEC for r=1.0 class 0.0 = 0.085 +- 0.023 (in-sample avg dev_std = 0.097)
NEC for r=1.0 class 1.0 = 0.11 +- 0.023 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all KL = 0.019 +- 0.023 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all L1 = 0.107 +- 0.059 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.587
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.628
NEC for r=0.3 class 0.0 = 0.091 +- 0.024 (in-sample avg dev_std = 0.072)
NEC for r=0.3 class 1.0 = 0.085 +- 0.024 (in-sample avg dev_std = 0.072)
NEC for r=0.3 all KL = 0.011 +- 0.024 (in-sample avg dev_std = 0.072)
NEC for r=0.3 all L1 = 0.086 +- 0.062 (in-sample avg dev_std = 0.072)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.646
NEC for r=0.6 class 0.0 = 0.084 +- 0.018 (in-sample avg dev_std = 0.082)
NEC for r=0.6 class 1.0 = 0.092 +- 0.018 (in-sample avg dev_std = 0.082)
NEC for r=0.6 all KL = 0.011 +- 0.018 (in-sample avg dev_std = 0.082)
NEC for r=0.6 all L1 = 0.091 +- 0.054 (in-sample avg dev_std = 0.082)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.674
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0.0 = 0.089 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 1.0 = 0.102 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all KL = 0.014 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all L1 = 0.1 +- 0.054 (in-sample avg dev_std = 0.091)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.682
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.678
NEC for r=1.0 class 0.0 = 0.092 +- 0.023 (in-sample avg dev_std = 0.093)
NEC for r=1.0 class 1.0 = 0.104 +- 0.023 (in-sample avg dev_std = 0.093)
NEC for r=1.0 all KL = 0.016 +- 0.023 (in-sample avg dev_std = 0.093)
NEC for r=1.0 all L1 = 0.102 +- 0.058 (in-sample avg dev_std = 0.093)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:46:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:46:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:47:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:47:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:47:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:47:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:48:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ROC-AUC: 0.8545
Train Loss: 0.2700
ID Validation ROC-AUC: 0.8433
ID Validation Loss: 0.2774
ID Test ROC-AUC: 0.8520
ID Test Loss: 0.2742
OOD Validation ROC-AUC: 0.6663
OOD Validation Loss: 0.3180
OOD Test ROC-AUC: 0.6927
OOD Test Loss: 0.4289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ROC-AUC: 0.8328
Train Loss: 0.4575
ID Validation ROC-AUC: 0.8232
ID Validation Loss: 0.4602
ID Test ROC-AUC: 0.8327
ID Test Loss: 0.4583
OOD Validation ROC-AUC: 0.6917
OOD Validation Loss: 0.5170
OOD Test ROC-AUC: 0.6783
OOD Test Loss: 0.5474

[0m[1;37mINFO[0m: [1mChartInfo 0.8520 0.6927 0.8327 0.6783 0.8232 0.6917[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:48:04 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:48:08 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:48:13 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.535
SUFF++ for r=0.3 class 0.0 = 0.909 +- 0.017 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.3 class 1.0 = 0.891 +- 0.017 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.3 all KL = 0.985 +- 0.017 (in-sample avg dev_std = 0.114)
SUFF++ for r=0.3 all L1 = 0.893 +- 0.055 (in-sample avg dev_std = 0.114)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.55
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.555
SUFF++ for r=0.6 class 0.0 = 0.925 +- 0.020 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.6 class 1.0 = 0.893 +- 0.020 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.6 all KL = 0.986 +- 0.020 (in-sample avg dev_std = 0.109)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.061 (in-sample avg dev_std = 0.109)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.611
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.609
SUFF++ for r=0.9 class 0.0 = 0.937 +- 0.022 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 1.0 = 0.899 +- 0.022 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all KL = 0.986 +- 0.022 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all L1 = 0.904 +- 0.067 (in-sample avg dev_std = 0.102)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.536
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.543
SUFF++ for r=0.3 class 0.0 = 0.922 +- 0.018 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 class 1.0 = 0.89 +- 0.018 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 all KL = 0.985 +- 0.018 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.3 all L1 = 0.894 +- 0.056 (in-sample avg dev_std = 0.119)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.607
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
SUFF++ for r=0.6 class 0.0 = 0.925 +- 0.018 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 1.0 = 0.892 +- 0.018 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all KL = 0.986 +- 0.018 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all L1 = 0.896 +- 0.059 (in-sample avg dev_std = 0.108)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.691
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.689
SUFF++ for r=0.9 class 0.0 = 0.946 +- 0.022 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.9 class 1.0 = 0.896 +- 0.022 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.9 all KL = 0.986 +- 0.022 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.9 all L1 = 0.902 +- 0.068 (in-sample avg dev_std = 0.103)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.523
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.506
SUFF++ for r=0.3 class 0.0 = 0.908 +- 0.022 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.3 class 1.0 = 0.895 +- 0.022 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.3 all KL = 0.986 +- 0.022 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.3 all L1 = 0.898 +- 0.059 (in-sample avg dev_std = 0.103)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.555
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.544
SUFF++ for r=0.6 class 0.0 = 0.914 +- 0.017 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 1.0 = 0.898 +- 0.017 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 all KL = 0.987 +- 0.017 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 all L1 = 0.901 +- 0.058 (in-sample avg dev_std = 0.103)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.592
SUFF++ for r=0.9 class 0.0 = 0.931 +- 0.017 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.9 class 1.0 = 0.912 +- 0.017 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.9 all KL = 0.99 +- 0.017 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.9 all L1 = 0.915 +- 0.062 (in-sample avg dev_std = 0.085)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.507
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.492
NEC for r=0.3 class 0.0 = 0.069 +- 0.019 (in-sample avg dev_std = 0.066)
NEC for r=0.3 class 1.0 = 0.078 +- 0.019 (in-sample avg dev_std = 0.066)
NEC for r=0.3 all KL = 0.008 +- 0.019 (in-sample avg dev_std = 0.066)
NEC for r=0.3 all L1 = 0.077 +- 0.064 (in-sample avg dev_std = 0.066)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.55
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.552
NEC for r=0.6 class 0.0 = 0.064 +- 0.016 (in-sample avg dev_std = 0.079)
NEC for r=0.6 class 1.0 = 0.083 +- 0.016 (in-sample avg dev_std = 0.079)
NEC for r=0.6 all KL = 0.009 +- 0.016 (in-sample avg dev_std = 0.079)
NEC for r=0.6 all L1 = 0.081 +- 0.055 (in-sample avg dev_std = 0.079)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.611
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.61
NEC for r=0.9 class 0.0 = 0.064 +- 0.022 (in-sample avg dev_std = 0.093)
NEC for r=0.9 class 1.0 = 0.093 +- 0.022 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all KL = 0.012 +- 0.022 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all L1 = 0.09 +- 0.061 (in-sample avg dev_std = 0.093)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.628
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.643
NEC for r=1.0 class 0.0 = 0.072 +- 0.022 (in-sample avg dev_std = 0.097)
NEC for r=1.0 class 1.0 = 0.097 +- 0.022 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all KL = 0.013 +- 0.022 (in-sample avg dev_std = 0.097)
NEC for r=1.0 all L1 = 0.095 +- 0.062 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.535
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.501
NEC for r=0.3 class 0.0 = 0.062 +- 0.018 (in-sample avg dev_std = 0.064)
NEC for r=0.3 class 1.0 = 0.079 +- 0.018 (in-sample avg dev_std = 0.064)
NEC for r=0.3 all KL = 0.008 +- 0.018 (in-sample avg dev_std = 0.064)
NEC for r=0.3 all L1 = 0.077 +- 0.065 (in-sample avg dev_std = 0.064)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.606
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.574
NEC for r=0.6 class 0.0 = 0.065 +- 0.016 (in-sample avg dev_std = 0.078)
NEC for r=0.6 class 1.0 = 0.085 +- 0.016 (in-sample avg dev_std = 0.078)
NEC for r=0.6 all KL = 0.009 +- 0.016 (in-sample avg dev_std = 0.078)
NEC for r=0.6 all L1 = 0.082 +- 0.058 (in-sample avg dev_std = 0.078)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.692
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.671
NEC for r=0.9 class 0.0 = 0.055 +- 0.016 (in-sample avg dev_std = 0.091)
NEC for r=0.9 class 1.0 = 0.094 +- 0.016 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all KL = 0.011 +- 0.016 (in-sample avg dev_std = 0.091)
NEC for r=0.9 all L1 = 0.089 +- 0.058 (in-sample avg dev_std = 0.091)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.699
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.683
NEC for r=1.0 class 0.0 = 0.059 +- 0.017 (in-sample avg dev_std = 0.092)
NEC for r=1.0 class 1.0 = 0.096 +- 0.017 (in-sample avg dev_std = 0.092)
NEC for r=1.0 all KL = 0.012 +- 0.017 (in-sample avg dev_std = 0.092)
NEC for r=1.0 all L1 = 0.092 +- 0.058 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.523
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.48
NEC for r=0.3 class 0.0 = 0.077 +- 0.026 (in-sample avg dev_std = 0.064)
NEC for r=0.3 class 1.0 = 0.078 +- 0.026 (in-sample avg dev_std = 0.064)
NEC for r=0.3 all KL = 0.009 +- 0.026 (in-sample avg dev_std = 0.064)
NEC for r=0.3 all L1 = 0.078 +- 0.064 (in-sample avg dev_std = 0.064)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.556
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.522
NEC for r=0.6 class 0.0 = 0.075 +- 0.021 (in-sample avg dev_std = 0.075)
NEC for r=0.6 class 1.0 = 0.082 +- 0.021 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all KL = 0.009 +- 0.021 (in-sample avg dev_std = 0.075)
NEC for r=0.6 all L1 = 0.081 +- 0.062 (in-sample avg dev_std = 0.075)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.558
NEC for r=0.9 class 0.0 = 0.071 +- 0.021 (in-sample avg dev_std = 0.084)
NEC for r=0.9 class 1.0 = 0.09 +- 0.021 (in-sample avg dev_std = 0.084)
NEC for r=0.9 all KL = 0.011 +- 0.021 (in-sample avg dev_std = 0.084)
NEC for r=0.9 all L1 = 0.086 +- 0.064 (in-sample avg dev_std = 0.084)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.606
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.585
NEC for r=1.0 class 0.0 = 0.075 +- 0.021 (in-sample avg dev_std = 0.090)
NEC for r=1.0 class 1.0 = 0.091 +- 0.021 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all KL = 0.011 +- 0.021 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all L1 = 0.089 +- 0.060 (in-sample avg dev_std = 0.090)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:52:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:52:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:52:34 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:52:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:52:55 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ROC-AUC: 0.8521
Train Loss: 0.2781
ID Validation ROC-AUC: 0.8450
ID Validation Loss: 0.2824
ID Test ROC-AUC: 0.8495
ID Test Loss: 0.2822
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3404
OOD Test ROC-AUC: 0.6740
OOD Test Loss: 0.4483

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ROC-AUC: 0.8310
Train Loss: 0.2841
ID Validation ROC-AUC: 0.8277
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.8220
ID Test Loss: 0.2921
OOD Validation ROC-AUC: 0.6811
OOD Validation Loss: 0.3048
OOD Test ROC-AUC: 0.6810
OOD Test Loss: 0.4319

[0m[1;37mINFO[0m: [1mChartInfo 0.8495 0.6740 0.8220 0.6810 0.8277 0.6811[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:53:25 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:53:29 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:53:33 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.602
SUFF++ for r=0.3 class 0.0 = 0.906 +- 0.054 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 class 1.0 = 0.906 +- 0.054 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all KL = 0.984 +- 0.054 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.3 all L1 = 0.906 +- 0.064 (in-sample avg dev_std = 0.094)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.718
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.686
SUFF++ for r=0.6 class 0.0 = 0.919 +- 0.041 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.6 class 1.0 = 0.879 +- 0.041 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.6 all KL = 0.976 +- 0.041 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.6 all L1 = 0.884 +- 0.073 (in-sample avg dev_std = 0.125)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.746
SUFF++ for r=0.9 class 0.0 = 0.938 +- 0.040 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 1.0 = 0.884 +- 0.040 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all KL = 0.976 +- 0.040 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.082 (in-sample avg dev_std = 0.102)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.642
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.584
SUFF++ for r=0.3 class 0.0 = 0.902 +- 0.057 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.3 class 1.0 = 0.901 +- 0.057 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.3 all KL = 0.982 +- 0.057 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.3 all L1 = 0.901 +- 0.067 (in-sample avg dev_std = 0.099)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.75
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.725
SUFF++ for r=0.6 class 0.0 = 0.919 +- 0.044 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.6 class 1.0 = 0.885 +- 0.044 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.6 all KL = 0.977 +- 0.044 (in-sample avg dev_std = 0.118)
SUFF++ for r=0.6 all L1 = 0.889 +- 0.068 (in-sample avg dev_std = 0.118)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.793
SUFF++ for r=0.9 class 0.0 = 0.938 +- 0.046 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 class 1.0 = 0.884 +- 0.046 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all KL = 0.974 +- 0.046 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.9 all L1 = 0.89 +- 0.083 (in-sample avg dev_std = 0.108)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.553
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.536
SUFF++ for r=0.3 class 0.0 = 0.896 +- 0.036 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.3 class 1.0 = 0.904 +- 0.036 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.3 all KL = 0.985 +- 0.036 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.3 all L1 = 0.903 +- 0.057 (in-sample avg dev_std = 0.101)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.601
SUFF++ for r=0.6 class 0.0 = 0.916 +- 0.032 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 class 1.0 = 0.898 +- 0.032 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 all KL = 0.983 +- 0.032 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 all L1 = 0.901 +- 0.064 (in-sample avg dev_std = 0.110)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.648
SUFF++ for r=0.9 class 0.0 = 0.939 +- 0.033 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 class 1.0 = 0.908 +- 0.033 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 all KL = 0.984 +- 0.033 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 all L1 = 0.913 +- 0.071 (in-sample avg dev_std = 0.094)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.61
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.614
NEC for r=0.3 class 0.0 = 0.083 +- 0.019 (in-sample avg dev_std = 0.062)
NEC for r=0.3 class 1.0 = 0.077 +- 0.019 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all KL = 0.008 +- 0.019 (in-sample avg dev_std = 0.062)
NEC for r=0.3 all L1 = 0.078 +- 0.054 (in-sample avg dev_std = 0.062)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.72
NEC for r=0.6 class 0.0 = 0.061 +- 0.033 (in-sample avg dev_std = 0.082)
NEC for r=0.6 class 1.0 = 0.096 +- 0.033 (in-sample avg dev_std = 0.082)
NEC for r=0.6 all KL = 0.015 +- 0.033 (in-sample avg dev_std = 0.082)
NEC for r=0.6 all L1 = 0.092 +- 0.068 (in-sample avg dev_std = 0.082)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.764
NEC for r=0.9 class 0.0 = 0.062 +- 0.036 (in-sample avg dev_std = 0.100)
NEC for r=0.9 class 1.0 = 0.114 +- 0.036 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all KL = 0.023 +- 0.036 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all L1 = 0.108 +- 0.077 (in-sample avg dev_std = 0.100)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.786
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.772
NEC for r=1.0 class 0.0 = 0.063 +- 0.036 (in-sample avg dev_std = 0.102)
NEC for r=1.0 class 1.0 = 0.114 +- 0.036 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all KL = 0.023 +- 0.036 (in-sample avg dev_std = 0.102)
NEC for r=1.0 all L1 = 0.108 +- 0.078 (in-sample avg dev_std = 0.102)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.642
NEC for r=0.3 class 0.0 = 0.085 +- 0.028 (in-sample avg dev_std = 0.070)
NEC for r=0.3 class 1.0 = 0.081 +- 0.028 (in-sample avg dev_std = 0.070)
NEC for r=0.3 all KL = 0.01 +- 0.028 (in-sample avg dev_std = 0.070)
NEC for r=0.3 all L1 = 0.081 +- 0.059 (in-sample avg dev_std = 0.070)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.75
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.723
NEC for r=0.6 class 0.0 = 0.068 +- 0.039 (in-sample avg dev_std = 0.088)
NEC for r=0.6 class 1.0 = 0.096 +- 0.039 (in-sample avg dev_std = 0.088)
NEC for r=0.6 all KL = 0.017 +- 0.039 (in-sample avg dev_std = 0.088)
NEC for r=0.6 all L1 = 0.093 +- 0.069 (in-sample avg dev_std = 0.088)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.793
NEC for r=0.9 class 0.0 = 0.056 +- 0.031 (in-sample avg dev_std = 0.101)
NEC for r=0.9 class 1.0 = 0.11 +- 0.031 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all KL = 0.021 +- 0.031 (in-sample avg dev_std = 0.101)
NEC for r=0.9 all L1 = 0.103 +- 0.074 (in-sample avg dev_std = 0.101)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.829
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.804
NEC for r=1.0 class 0.0 = 0.062 +- 0.039 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 1.0 = 0.115 +- 0.039 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all KL = 0.025 +- 0.039 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all L1 = 0.109 +- 0.077 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.553
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.582
NEC for r=0.3 class 0.0 = 0.086 +- 0.042 (in-sample avg dev_std = 0.068)
NEC for r=0.3 class 1.0 = 0.081 +- 0.042 (in-sample avg dev_std = 0.068)
NEC for r=0.3 all KL = 0.012 +- 0.042 (in-sample avg dev_std = 0.068)
NEC for r=0.3 all L1 = 0.082 +- 0.064 (in-sample avg dev_std = 0.068)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.618
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.612
NEC for r=0.6 class 0.0 = 0.073 +- 0.025 (in-sample avg dev_std = 0.074)
NEC for r=0.6 class 1.0 = 0.087 +- 0.025 (in-sample avg dev_std = 0.074)
NEC for r=0.6 all KL = 0.012 +- 0.025 (in-sample avg dev_std = 0.074)
NEC for r=0.6 all L1 = 0.084 +- 0.062 (in-sample avg dev_std = 0.074)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.666
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.649
NEC for r=0.9 class 0.0 = 0.065 +- 0.031 (in-sample avg dev_std = 0.086)
NEC for r=0.9 class 1.0 = 0.093 +- 0.031 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all KL = 0.015 +- 0.031 (in-sample avg dev_std = 0.086)
NEC for r=0.9 all L1 = 0.089 +- 0.067 (in-sample avg dev_std = 0.086)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.673
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.652
NEC for r=1.0 class 0.0 = 0.066 +- 0.031 (in-sample avg dev_std = 0.087)
NEC for r=1.0 class 1.0 = 0.092 +- 0.031 (in-sample avg dev_std = 0.087)
NEC for r=1.0 all KL = 0.015 +- 0.031 (in-sample avg dev_std = 0.087)
NEC for r=1.0 all L1 = 0.088 +- 0.067 (in-sample avg dev_std = 0.087)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.993, 0.992, 0.993, 1.0], 'all_L1': [0.933, 0.931, 0.94, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.972, 0.973, 1.0], 'all_L1': [0.871, 0.846, 0.863, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.982, 0.98, 1.0], 'all_L1': [0.908, 0.882, 0.884, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.985, 0.986, 0.986, 1.0], 'all_L1': [0.893, 0.897, 0.904, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.984, 0.976, 0.976, 1.0], 'all_L1': [0.906, 0.884, 0.89, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.003, 0.004, 0.006, 0.007], 'all_L1': [0.05, 0.049, 0.056, 0.061]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.016, 0.027, 0.031], 'all_L1': [0.096, 0.115, 0.14, 0.147]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.012, 0.016, 0.018], 'all_L1': [0.081, 0.093, 0.106, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.009, 0.012, 0.013], 'all_L1': [0.077, 0.081, 0.09, 0.095]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.015, 0.023, 0.023], 'all_L1': [0.078, 0.092, 0.108, 0.108]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.993, 0.993, 0.993, 1.0], 'all_L1': [0.934, 0.933, 0.94, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.98, 0.972, 0.975, 1.0], 'all_L1': [0.871, 0.844, 0.866, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 0.981, 0.979, 1.0], 'all_L1': [0.908, 0.882, 0.885, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.985, 0.986, 0.986, 1.0], 'all_L1': [0.894, 0.896, 0.902, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.982, 0.977, 0.974, 1.0], 'all_L1': [0.901, 0.889, 0.89, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.002, 0.003, 0.005, 0.006], 'all_L1': [0.047, 0.048, 0.053, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.015, 0.024, 0.026], 'all_L1': [0.095, 0.111, 0.136, 0.139]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.012, 0.017, 0.019], 'all_L1': [0.083, 0.094, 0.106, 0.107]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.009, 0.011, 0.012], 'all_L1': [0.077, 0.082, 0.089, 0.092]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.017, 0.021, 0.025], 'all_L1': [0.081, 0.093, 0.103, 0.109]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.996, 0.995, 0.995, 1.0], 'all_L1': [0.942, 0.942, 0.947, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.97, 0.974, 1.0], 'all_L1': [0.867, 0.844, 0.863, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.989, 0.983, 0.985, 1.0], 'all_L1': [0.907, 0.889, 0.901, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.986, 0.987, 0.99, 1.0], 'all_L1': [0.898, 0.901, 0.915, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.985, 0.983, 0.984, 1.0], 'all_L1': [0.903, 0.901, 0.913, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.003, 0.003, 0.005, 0.005], 'all_L1': [0.051, 0.048, 0.052, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.017, 0.027, 0.032], 'all_L1': [0.097, 0.115, 0.144, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.011, 0.014, 0.016], 'all_L1': [0.086, 0.091, 0.1, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.009, 0.011, 0.011], 'all_L1': [0.078, 0.081, 0.086, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.012, 0.015, 0.015], 'all_L1': [0.082, 0.084, 0.089, 0.088]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.902 +- 0.020, 0.888 +- 0.027, 0.896 +- 0.026, 1.000 +- 0.000
suff++ class all_KL  =  0.986 +- 0.004, 0.982 +- 0.007, 0.982 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.598 +- 0.038, 0.650 +- 0.048, 0.705 +- 0.057
nec class all_L1  =  0.076 +- 0.015, 0.086 +- 0.022, 0.100 +- 0.027, 0.104 +- 0.028
nec class all_KL  =  0.008 +- 0.003, 0.011 +- 0.004, 0.017 +- 0.008, 0.018 +- 0.008
nec_acc_int  =  0.618 +- 0.073, 0.674 +- 0.067, 0.726 +- 0.063, 0.741 +- 0.057

Eval split id_test
suff++ class all_L1  =  0.902 +- 0.020, 0.889 +- 0.028, 0.897 +- 0.025, 1.000 +- 0.000
suff++ class all_KL  =  0.986 +- 0.005, 0.982 +- 0.007, 0.981 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.622 +- 0.051, 0.693 +- 0.045, 0.764 +- 0.045
nec class all_L1  =  0.077 +- 0.016, 0.086 +- 0.021, 0.097 +- 0.027, 0.101 +- 0.027
nec class all_KL  =  0.008 +- 0.003, 0.011 +- 0.005, 0.016 +- 0.007, 0.018 +- 0.008
nec_acc_int  =  0.654 +- 0.085, 0.715 +- 0.075, 0.771 +- 0.055, 0.782 +- 0.054

Eval split test
suff++ class all_L1  =  0.903 +- 0.024, 0.895 +- 0.031, 0.908 +- 0.027, 1.000 +- 0.000
suff++ class all_KL  =  0.987 +- 0.006, 0.984 +- 0.008, 0.986 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.562 +- 0.035, 0.597 +- 0.028, 0.650 +- 0.031
nec class all_L1  =  0.079 +- 0.015, 0.084 +- 0.022, 0.094 +- 0.030, 0.097 +- 0.032
nec class all_KL  =  0.009 +- 0.003, 0.010 +- 0.005, 0.014 +- 0.007, 0.016 +- 0.009
nec_acc_int  =  0.583 +- 0.059, 0.608 +- 0.046, 0.636 +- 0.041, 0.647 +- 0.035


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.489 +- 0.004, 0.487 +- 0.003, 0.498 +- 0.002, 0.552 +- 0.014
Faith. Armon (L1)= 		  =  0.140 +- 0.025, 0.156 +- 0.036, 0.178 +- 0.044, 0.187 +- 0.045
Faith. GMean (L1)= 	  =  0.261 +- 0.024, 0.273 +- 0.033, 0.296 +- 0.039, 0.319 +- 0.044
Faith. Aritm (KL)= 		  =  0.497 +- 0.001, 0.496 +- 0.001, 0.499 +- 0.001, 0.509 +- 0.004
Faith. Armon (KL)= 		  =  0.015 +- 0.005, 0.022 +- 0.009, 0.033 +- 0.015, 0.036 +- 0.016
Faith. GMean (KL)= 	  =  0.086 +- 0.017, 0.102 +- 0.022, 0.125 +- 0.030, 0.132 +- 0.032

Eval split id_test
Faith. Aritm (L1)= 		  =  0.489 +- 0.004, 0.487 +- 0.005, 0.497 +- 0.002, 0.550 +- 0.013
Faith. Armon (L1)= 		  =  0.141 +- 0.027, 0.155 +- 0.035, 0.174 +- 0.044, 0.182 +- 0.044
Faith. GMean (L1)= 	  =  0.261 +- 0.027, 0.273 +- 0.033, 0.292 +- 0.039, 0.314 +- 0.044
Faith. Aritm (KL)= 		  =  0.497 +- 0.001, 0.497 +- 0.002, 0.499 +- 0.001, 0.509 +- 0.004
Faith. Armon (KL)= 		  =  0.016 +- 0.006, 0.022 +- 0.010, 0.031 +- 0.013, 0.034 +- 0.015
Faith. GMean (KL)= 	  =  0.087 +- 0.022, 0.101 +- 0.026, 0.120 +- 0.030, 0.129 +- 0.032

Eval split test
Faith. Aritm (L1)= 		  =  0.491 +- 0.006, 0.490 +- 0.005, 0.501 +- 0.001, 0.549 +- 0.016
Faith. Armon (L1)= 		  =  0.144 +- 0.026, 0.152 +- 0.036, 0.169 +- 0.048, 0.176 +- 0.052
Faith. GMean (L1)= 	  =  0.265 +- 0.024, 0.271 +- 0.032, 0.288 +- 0.042, 0.308 +- 0.050
Faith. Aritm (KL)= 		  =  0.498 +- 0.002, 0.497 +- 0.002, 0.500 +- 0.000, 0.508 +- 0.004
Faith. Armon (KL)= 		  =  0.019 +- 0.007, 0.021 +- 0.009, 0.028 +- 0.014, 0.031 +- 0.017
Faith. GMean (KL)= 	  =  0.094 +- 0.020, 0.098 +- 0.024, 0.115 +- 0.030, 0.121 +- 0.035
Computed for split load_split = id



Completed in  0:26:47.340039  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 22:57:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 10:57:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 10:58:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 10:58:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 10:58:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 10:58:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 10:59:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ROC-AUC: 0.9307
Train Loss: 0.2195
ID Validation ROC-AUC: 0.9067
ID Validation Loss: 0.2526
ID Test ROC-AUC: 0.9044
ID Test Loss: 0.2601
OOD Validation ROC-AUC: 0.6860
OOD Validation Loss: 0.3291
OOD Test ROC-AUC: 0.7122
OOD Test Loss: 0.5158

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 8...
[0m[1;37mINFO[0m: [1mCheckpoint 8: 
-----------------------------------
Train ROC-AUC: 0.8557
Train Loss: 0.3070
ID Validation ROC-AUC: 0.8576
ID Validation Loss: 0.3082
ID Test ROC-AUC: 0.8529
ID Test Loss: 0.3152
OOD Validation ROC-AUC: 0.6955
OOD Validation Loss: 0.2755
OOD Test ROC-AUC: 0.7120
OOD Test Loss: 0.4701

[0m[1;37mINFO[0m: [1mChartInfo 0.9044 0.7122 0.8529 0.7120 0.8576 0.6955[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 10:59:04 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 10:59:09 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 10:59:13 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.667
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.671
SUFF++ for r=0.3 class 0.0 = 0.831 +- 0.073 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 class 1.0 = 0.769 +- 0.073 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all KL = 0.92 +- 0.073 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.096 (in-sample avg dev_std = 0.255)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.722
SUFF++ for r=0.6 class 0.0 = 0.839 +- 0.083 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.765 +- 0.083 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.908 +- 0.083 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.774 +- 0.120 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.778
SUFF++ for r=0.9 class 0.0 = 0.891 +- 0.063 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 class 1.0 = 0.836 +- 0.063 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 all KL = 0.95 +- 0.063 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.9 all L1 = 0.842 +- 0.113 (in-sample avg dev_std = 0.165)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.688
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.666
SUFF++ for r=0.3 class 0.0 = 0.823 +- 0.080 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.3 class 1.0 = 0.765 +- 0.080 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.3 all KL = 0.914 +- 0.080 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.3 all L1 = 0.772 +- 0.101 (in-sample avg dev_std = 0.267)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.732
SUFF++ for r=0.6 class 0.0 = 0.844 +- 0.085 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 1.0 = 0.762 +- 0.085 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all KL = 0.905 +- 0.085 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all L1 = 0.772 +- 0.116 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.796
SUFF++ for r=0.9 class 0.0 = 0.891 +- 0.067 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 class 1.0 = 0.839 +- 0.067 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all KL = 0.95 +- 0.067 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.9 all L1 = 0.845 +- 0.113 (in-sample avg dev_std = 0.163)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.578
SUFF++ for r=0.3 class 0.0 = 0.824 +- 0.082 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.3 class 1.0 = 0.795 +- 0.082 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.3 all KL = 0.932 +- 0.082 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.3 all L1 = 0.8 +- 0.104 (in-sample avg dev_std = 0.236)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.611
SUFF++ for r=0.6 class 0.0 = 0.823 +- 0.082 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.6 class 1.0 = 0.785 +- 0.082 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.6 all KL = 0.922 +- 0.082 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.6 all L1 = 0.791 +- 0.110 (in-sample avg dev_std = 0.241)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.65
SUFF++ for r=0.9 class 0.0 = 0.883 +- 0.064 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1.0 = 0.843 +- 0.064 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.956 +- 0.064 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.85 +- 0.106 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.667
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.668
NEC for r=0.3 class 0.0 = 0.138 +- 0.058 (in-sample avg dev_std = 0.158)
NEC for r=0.3 class 1.0 = 0.157 +- 0.058 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all KL = 0.04 +- 0.058 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all L1 = 0.155 +- 0.098 (in-sample avg dev_std = 0.158)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
NEC for r=0.6 class 0.0 = 0.123 +- 0.054 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 1.0 = 0.164 +- 0.054 (in-sample avg dev_std = 0.168)
NEC for r=0.6 all KL = 0.044 +- 0.054 (in-sample avg dev_std = 0.168)
NEC for r=0.6 all L1 = 0.159 +- 0.096 (in-sample avg dev_std = 0.168)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.783
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.778
NEC for r=0.9 class 0.0 = 0.101 +- 0.052 (in-sample avg dev_std = 0.154)
NEC for r=0.9 class 1.0 = 0.146 +- 0.052 (in-sample avg dev_std = 0.154)
NEC for r=0.9 all KL = 0.04 +- 0.052 (in-sample avg dev_std = 0.154)
NEC for r=0.9 all L1 = 0.14 +- 0.098 (in-sample avg dev_std = 0.154)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.808
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.799
NEC for r=1.0 class 0.0 = 0.112 +- 0.047 (in-sample avg dev_std = 0.146)
NEC for r=1.0 class 1.0 = 0.13 +- 0.047 (in-sample avg dev_std = 0.146)
NEC for r=1.0 all KL = 0.036 +- 0.047 (in-sample avg dev_std = 0.146)
NEC for r=1.0 all L1 = 0.128 +- 0.091 (in-sample avg dev_std = 0.146)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.688
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.684
NEC for r=0.3 class 0.0 = 0.14 +- 0.059 (in-sample avg dev_std = 0.158)
NEC for r=0.3 class 1.0 = 0.158 +- 0.059 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all KL = 0.041 +- 0.059 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all L1 = 0.156 +- 0.097 (in-sample avg dev_std = 0.158)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.72
NEC for r=0.6 class 0.0 = 0.112 +- 0.065 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 1.0 = 0.164 +- 0.065 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.046 +- 0.065 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.158 +- 0.103 (in-sample avg dev_std = 0.166)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.788
NEC for r=0.9 class 0.0 = 0.106 +- 0.058 (in-sample avg dev_std = 0.155)
NEC for r=0.9 class 1.0 = 0.143 +- 0.058 (in-sample avg dev_std = 0.155)
NEC for r=0.9 all KL = 0.041 +- 0.058 (in-sample avg dev_std = 0.155)
NEC for r=0.9 all L1 = 0.139 +- 0.096 (in-sample avg dev_std = 0.155)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.828
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.805
NEC for r=1.0 class 0.0 = 0.104 +- 0.049 (in-sample avg dev_std = 0.145)
NEC for r=1.0 class 1.0 = 0.128 +- 0.049 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all KL = 0.035 +- 0.049 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all L1 = 0.125 +- 0.092 (in-sample avg dev_std = 0.145)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.598
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.596
NEC for r=0.3 class 0.0 = 0.137 +- 0.054 (in-sample avg dev_std = 0.141)
NEC for r=0.3 class 1.0 = 0.143 +- 0.054 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all KL = 0.032 +- 0.054 (in-sample avg dev_std = 0.141)
NEC for r=0.3 all L1 = 0.142 +- 0.090 (in-sample avg dev_std = 0.141)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.627
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.607
NEC for r=0.6 class 0.0 = 0.124 +- 0.057 (in-sample avg dev_std = 0.154)
NEC for r=0.6 class 1.0 = 0.152 +- 0.057 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all KL = 0.038 +- 0.057 (in-sample avg dev_std = 0.154)
NEC for r=0.6 all L1 = 0.148 +- 0.094 (in-sample avg dev_std = 0.154)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.65
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.646
NEC for r=0.9 class 0.0 = 0.112 +- 0.052 (in-sample avg dev_std = 0.152)
NEC for r=0.9 class 1.0 = 0.143 +- 0.052 (in-sample avg dev_std = 0.152)
NEC for r=0.9 all KL = 0.036 +- 0.052 (in-sample avg dev_std = 0.152)
NEC for r=0.9 all L1 = 0.138 +- 0.091 (in-sample avg dev_std = 0.152)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.667
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.656
NEC for r=1.0 class 0.0 = 0.12 +- 0.058 (in-sample avg dev_std = 0.149)
NEC for r=1.0 class 1.0 = 0.139 +- 0.058 (in-sample avg dev_std = 0.149)
NEC for r=1.0 all KL = 0.037 +- 0.058 (in-sample avg dev_std = 0.149)
NEC for r=1.0 all L1 = 0.136 +- 0.095 (in-sample avg dev_std = 0.149)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:03:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 11:03:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 11:03:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 11:03:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 11:03:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ROC-AUC: 0.9440
Train Loss: 0.1865
ID Validation ROC-AUC: 0.9098
ID Validation Loss: 0.2347
ID Test ROC-AUC: 0.9112
ID Test Loss: 0.2356
OOD Validation ROC-AUC: 0.6757
OOD Validation Loss: 0.3539
OOD Test ROC-AUC: 0.7176
OOD Test Loss: 0.5022

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ROC-AUC: 0.9142
Train Loss: 0.2578
ID Validation ROC-AUC: 0.8920
ID Validation Loss: 0.2833
ID Test ROC-AUC: 0.8940
ID Test Loss: 0.2834
OOD Validation ROC-AUC: 0.6971
OOD Validation Loss: 0.3031
OOD Test ROC-AUC: 0.7179
OOD Test Loss: 0.4948

[0m[1;37mINFO[0m: [1mChartInfo 0.9112 0.7176 0.8940 0.7179 0.8920 0.6971[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 11:04:21 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 11:04:25 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 11:04:29 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.711
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.702
SUFF++ for r=0.3 class 0.0 = 0.794 +- 0.055 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.3 class 1.0 = 0.803 +- 0.055 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.3 all KL = 0.944 +- 0.055 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.091 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.789
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.765
SUFF++ for r=0.6 class 0.0 = 0.799 +- 0.075 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 class 1.0 = 0.77 +- 0.075 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all KL = 0.911 +- 0.075 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all L1 = 0.773 +- 0.105 (in-sample avg dev_std = 0.243)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.828
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.815
SUFF++ for r=0.9 class 0.0 = 0.839 +- 0.094 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 class 1.0 = 0.84 +- 0.094 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all KL = 0.933 +- 0.094 (in-sample avg dev_std = 0.189)
SUFF++ for r=0.9 all L1 = 0.84 +- 0.133 (in-sample avg dev_std = 0.189)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.763
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.718
SUFF++ for r=0.3 class 0.0 = 0.805 +- 0.059 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.3 class 1.0 = 0.8 +- 0.059 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.3 all KL = 0.941 +- 0.059 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.3 all L1 = 0.801 +- 0.084 (in-sample avg dev_std = 0.220)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.794
SUFF++ for r=0.6 class 0.0 = 0.819 +- 0.082 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 class 1.0 = 0.77 +- 0.082 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all KL = 0.91 +- 0.082 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all L1 = 0.776 +- 0.108 (in-sample avg dev_std = 0.243)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.823
SUFF++ for r=0.9 class 0.0 = 0.872 +- 0.104 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 class 1.0 = 0.831 +- 0.104 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 all KL = 0.925 +- 0.104 (in-sample avg dev_std = 0.202)
SUFF++ for r=0.9 all L1 = 0.835 +- 0.131 (in-sample avg dev_std = 0.202)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.655
SUFF++ for r=0.3 class 0.0 = 0.805 +- 0.049 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 1.0 = 0.793 +- 0.049 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 all KL = 0.942 +- 0.049 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 all L1 = 0.795 +- 0.085 (in-sample avg dev_std = 0.218)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.678
SUFF++ for r=0.6 class 0.0 = 0.807 +- 0.079 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 class 1.0 = 0.773 +- 0.079 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all KL = 0.918 +- 0.079 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all L1 = 0.778 +- 0.102 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.701
SUFF++ for r=0.9 class 0.0 = 0.85 +- 0.092 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1.0 = 0.825 +- 0.092 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.935 +- 0.092 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.126 (in-sample avg dev_std = 0.197)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.712
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.689
NEC for r=0.3 class 0.0 = 0.186 +- 0.044 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 1.0 = 0.155 +- 0.044 (in-sample avg dev_std = 0.148)
NEC for r=0.3 all KL = 0.035 +- 0.044 (in-sample avg dev_std = 0.148)
NEC for r=0.3 all L1 = 0.159 +- 0.092 (in-sample avg dev_std = 0.148)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.789
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.767
NEC for r=0.6 class 0.0 = 0.168 +- 0.070 (in-sample avg dev_std = 0.162)
NEC for r=0.6 class 1.0 = 0.164 +- 0.070 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all KL = 0.049 +- 0.070 (in-sample avg dev_std = 0.162)
NEC for r=0.6 all L1 = 0.164 +- 0.090 (in-sample avg dev_std = 0.162)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.828
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.809
NEC for r=0.9 class 0.0 = 0.148 +- 0.067 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 1.0 = 0.131 +- 0.067 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all KL = 0.046 +- 0.067 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all L1 = 0.133 +- 0.100 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.837
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.819
NEC for r=1.0 class 0.0 = 0.145 +- 0.074 (in-sample avg dev_std = 0.169)
NEC for r=1.0 class 1.0 = 0.126 +- 0.074 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all KL = 0.048 +- 0.074 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all L1 = 0.129 +- 0.104 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.763
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.743
NEC for r=0.3 class 0.0 = 0.162 +- 0.050 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 1.0 = 0.15 +- 0.050 (in-sample avg dev_std = 0.140)
NEC for r=0.3 all KL = 0.034 +- 0.050 (in-sample avg dev_std = 0.140)
NEC for r=0.3 all L1 = 0.152 +- 0.093 (in-sample avg dev_std = 0.140)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.825
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.801
NEC for r=0.6 class 0.0 = 0.133 +- 0.070 (in-sample avg dev_std = 0.164)
NEC for r=0.6 class 1.0 = 0.166 +- 0.070 (in-sample avg dev_std = 0.164)
NEC for r=0.6 all KL = 0.05 +- 0.070 (in-sample avg dev_std = 0.164)
NEC for r=0.6 all L1 = 0.162 +- 0.094 (in-sample avg dev_std = 0.164)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.85
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.835
NEC for r=0.9 class 0.0 = 0.118 +- 0.079 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.138 +- 0.079 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.053 +- 0.079 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.136 +- 0.101 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.853
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.834
NEC for r=1.0 class 0.0 = 0.109 +- 0.078 (in-sample avg dev_std = 0.170)
NEC for r=1.0 class 1.0 = 0.13 +- 0.078 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all KL = 0.051 +- 0.078 (in-sample avg dev_std = 0.170)
NEC for r=1.0 all L1 = 0.128 +- 0.104 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.686
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.645
NEC for r=0.3 class 0.0 = 0.161 +- 0.050 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 1.0 = 0.17 +- 0.050 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all KL = 0.039 +- 0.050 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all L1 = 0.169 +- 0.099 (in-sample avg dev_std = 0.147)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.682
NEC for r=0.6 class 0.0 = 0.145 +- 0.070 (in-sample avg dev_std = 0.163)
NEC for r=0.6 class 1.0 = 0.167 +- 0.070 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all KL = 0.046 +- 0.070 (in-sample avg dev_std = 0.163)
NEC for r=0.6 all L1 = 0.163 +- 0.094 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.708
NEC for r=0.9 class 0.0 = 0.14 +- 0.072 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 1.0 = 0.147 +- 0.072 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all KL = 0.046 +- 0.072 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all L1 = 0.146 +- 0.099 (in-sample avg dev_std = 0.166)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.734
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.705
NEC for r=1.0 class 0.0 = 0.139 +- 0.068 (in-sample avg dev_std = 0.165)
NEC for r=1.0 class 1.0 = 0.144 +- 0.068 (in-sample avg dev_std = 0.165)
NEC for r=1.0 all KL = 0.046 +- 0.068 (in-sample avg dev_std = 0.165)
NEC for r=1.0 all L1 = 0.143 +- 0.102 (in-sample avg dev_std = 0.165)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:08:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 11:08:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 11:08:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 11:08:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:09:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ROC-AUC: 0.9378
Train Loss: 0.2092
ID Validation ROC-AUC: 0.9078
ID Validation Loss: 0.2597
ID Test ROC-AUC: 0.9080
ID Test Loss: 0.2634
OOD Validation ROC-AUC: 0.6711
OOD Validation Loss: 0.3712
OOD Test ROC-AUC: 0.7230
OOD Test Loss: 0.5335

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ROC-AUC: 0.9173
Train Loss: 0.2503
ID Validation ROC-AUC: 0.8989
ID Validation Loss: 0.2693
ID Test ROC-AUC: 0.9022
ID Test Loss: 0.2709
OOD Validation ROC-AUC: 0.6962
OOD Validation Loss: 0.2969
OOD Test ROC-AUC: 0.7204
OOD Test Loss: 0.4850

[0m[1;37mINFO[0m: [1mChartInfo 0.9080 0.7230 0.9022 0.7204 0.8989 0.6962[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 11:09:35 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 11:09:39 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 11:09:43 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.703
SUFF++ for r=0.3 class 0.0 = 0.825 +- 0.063 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.3 class 1.0 = 0.804 +- 0.063 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.3 all KL = 0.945 +- 0.063 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.3 all L1 = 0.807 +- 0.085 (in-sample avg dev_std = 0.210)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.796
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.754
SUFF++ for r=0.6 class 0.0 = 0.781 +- 0.103 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 1.0 = 0.746 +- 0.103 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all KL = 0.874 +- 0.103 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all L1 = 0.75 +- 0.127 (in-sample avg dev_std = 0.300)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.807
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0.0 = 0.862 +- 0.102 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1.0 = 0.845 +- 0.102 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.927 +- 0.102 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.847 +- 0.136 (in-sample avg dev_std = 0.197)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.773
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.694
SUFF++ for r=0.3 class 0.0 = 0.819 +- 0.064 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 class 1.0 = 0.795 +- 0.064 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 all KL = 0.938 +- 0.064 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.089 (in-sample avg dev_std = 0.227)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.808
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.743
SUFF++ for r=0.6 class 0.0 = 0.767 +- 0.097 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 class 1.0 = 0.737 +- 0.097 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 all KL = 0.866 +- 0.097 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 all L1 = 0.741 +- 0.121 (in-sample avg dev_std = 0.318)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.795
SUFF++ for r=0.9 class 0.0 = 0.843 +- 0.109 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1.0 = 0.835 +- 0.109 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.916 +- 0.109 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.836 +- 0.143 (in-sample avg dev_std = 0.219)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.618
SUFF++ for r=0.3 class 0.0 = 0.824 +- 0.059 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.3 class 1.0 = 0.809 +- 0.059 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.3 all KL = 0.947 +- 0.059 (in-sample avg dev_std = 0.212)
SUFF++ for r=0.3 all L1 = 0.812 +- 0.086 (in-sample avg dev_std = 0.212)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.642
SUFF++ for r=0.6 class 0.0 = 0.767 +- 0.099 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 1.0 = 0.754 +- 0.099 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 all KL = 0.884 +- 0.099 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 all L1 = 0.756 +- 0.123 (in-sample avg dev_std = 0.305)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.666
SUFF++ for r=0.9 class 0.0 = 0.835 +- 0.090 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 class 1.0 = 0.834 +- 0.090 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all KL = 0.932 +- 0.090 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all L1 = 0.834 +- 0.132 (in-sample avg dev_std = 0.203)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0.0 = 0.121 +- 0.057 (in-sample avg dev_std = 0.129)
NEC for r=0.3 class 1.0 = 0.142 +- 0.057 (in-sample avg dev_std = 0.129)
NEC for r=0.3 all KL = 0.031 +- 0.057 (in-sample avg dev_std = 0.129)
NEC for r=0.3 all L1 = 0.139 +- 0.095 (in-sample avg dev_std = 0.129)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.796
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.774
NEC for r=0.6 class 0.0 = 0.126 +- 0.080 (in-sample avg dev_std = 0.179)
NEC for r=0.6 class 1.0 = 0.172 +- 0.080 (in-sample avg dev_std = 0.179)
NEC for r=0.6 all KL = 0.062 +- 0.080 (in-sample avg dev_std = 0.179)
NEC for r=0.6 all L1 = 0.166 +- 0.106 (in-sample avg dev_std = 0.179)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.806
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.807
NEC for r=0.9 class 0.0 = 0.135 +- 0.091 (in-sample avg dev_std = 0.182)
NEC for r=0.9 class 1.0 = 0.138 +- 0.091 (in-sample avg dev_std = 0.182)
NEC for r=0.9 all KL = 0.062 +- 0.091 (in-sample avg dev_std = 0.182)
NEC for r=0.9 all L1 = 0.138 +- 0.110 (in-sample avg dev_std = 0.182)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.813
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.818
NEC for r=1.0 class 0.0 = 0.135 +- 0.080 (in-sample avg dev_std = 0.157)
NEC for r=1.0 class 1.0 = 0.121 +- 0.080 (in-sample avg dev_std = 0.157)
NEC for r=1.0 all KL = 0.051 +- 0.080 (in-sample avg dev_std = 0.157)
NEC for r=1.0 all L1 = 0.123 +- 0.104 (in-sample avg dev_std = 0.157)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.773
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.737
NEC for r=0.3 class 0.0 = 0.117 +- 0.058 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 1.0 = 0.136 +- 0.058 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all KL = 0.03 +- 0.058 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all L1 = 0.134 +- 0.098 (in-sample avg dev_std = 0.127)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.808
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.782
NEC for r=0.6 class 0.0 = 0.124 +- 0.091 (in-sample avg dev_std = 0.180)
NEC for r=0.6 class 1.0 = 0.174 +- 0.091 (in-sample avg dev_std = 0.180)
NEC for r=0.6 all KL = 0.065 +- 0.091 (in-sample avg dev_std = 0.180)
NEC for r=0.6 all L1 = 0.168 +- 0.116 (in-sample avg dev_std = 0.180)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.811
NEC for r=0.9 class 0.0 = 0.12 +- 0.088 (in-sample avg dev_std = 0.178)
NEC for r=0.9 class 1.0 = 0.135 +- 0.088 (in-sample avg dev_std = 0.178)
NEC for r=0.9 all KL = 0.058 +- 0.088 (in-sample avg dev_std = 0.178)
NEC for r=0.9 all L1 = 0.133 +- 0.112 (in-sample avg dev_std = 0.178)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.837
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.815
NEC for r=1.0 class 0.0 = 0.134 +- 0.093 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 1.0 = 0.129 +- 0.093 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all KL = 0.058 +- 0.093 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all L1 = 0.13 +- 0.114 (in-sample avg dev_std = 0.177)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.647
NEC for r=0.3 class 0.0 = 0.123 +- 0.046 (in-sample avg dev_std = 0.130)
NEC for r=0.3 class 1.0 = 0.14 +- 0.046 (in-sample avg dev_std = 0.130)
NEC for r=0.3 all KL = 0.028 +- 0.046 (in-sample avg dev_std = 0.130)
NEC for r=0.3 all L1 = 0.137 +- 0.093 (in-sample avg dev_std = 0.130)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.679
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.664
NEC for r=0.6 class 0.0 = 0.132 +- 0.083 (in-sample avg dev_std = 0.176)
NEC for r=0.6 class 1.0 = 0.164 +- 0.083 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all KL = 0.055 +- 0.083 (in-sample avg dev_std = 0.176)
NEC for r=0.6 all L1 = 0.158 +- 0.109 (in-sample avg dev_std = 0.176)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.69
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.665
NEC for r=0.9 class 0.0 = 0.148 +- 0.089 (in-sample avg dev_std = 0.180)
NEC for r=0.9 class 1.0 = 0.153 +- 0.089 (in-sample avg dev_std = 0.180)
NEC for r=0.9 all KL = 0.058 +- 0.089 (in-sample avg dev_std = 0.180)
NEC for r=0.9 all L1 = 0.152 +- 0.115 (in-sample avg dev_std = 0.180)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.685
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.667
NEC for r=1.0 class 0.0 = 0.147 +- 0.086 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1.0 = 0.142 +- 0.086 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.053 +- 0.086 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.143 +- 0.109 (in-sample avg dev_std = 0.168)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:13:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 11:13:32 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:14:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ROC-AUC: 0.9399
Train Loss: 0.1892
ID Validation ROC-AUC: 0.9108
ID Validation Loss: 0.2307
ID Test ROC-AUC: 0.9105
ID Test Loss: 0.2346
OOD Validation ROC-AUC: 0.6573
OOD Validation Loss: 0.3818
OOD Test ROC-AUC: 0.7075
OOD Test Loss: 0.5100

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8478
Train Loss: 0.3183
ID Validation ROC-AUC: 0.8480
ID Validation Loss: 0.3204
ID Test ROC-AUC: 0.8453
ID Test Loss: 0.3256
OOD Validation ROC-AUC: 0.6953
OOD Validation Loss: 0.2753
OOD Test ROC-AUC: 0.7002
OOD Test Loss: 0.4757

[0m[1;37mINFO[0m: [1mChartInfo 0.9105 0.7075 0.8453 0.7002 0.8480 0.6953[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 11:14:52 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 11:14:56 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 11:15:00 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.503
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.549
SUFF++ for r=0.3 class 0.0 = 0.873 +- 0.040 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 class 1.0 = 0.855 +- 0.040 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 all KL = 0.97 +- 0.040 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.3 all L1 = 0.857 +- 0.071 (in-sample avg dev_std = 0.148)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.508
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.547
SUFF++ for r=0.6 class 0.0 = 0.907 +- 0.029 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.6 class 1.0 = 0.877 +- 0.029 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.6 all KL = 0.98 +- 0.029 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.063 (in-sample avg dev_std = 0.123)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.589
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.599
SUFF++ for r=0.9 class 0.0 = 0.929 +- 0.029 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 class 1.0 = 0.896 +- 0.029 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 all KL = 0.986 +- 0.029 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.069 (in-sample avg dev_std = 0.094)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.551
SUFF++ for r=0.3 class 0.0 = 0.879 +- 0.046 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.3 class 1.0 = 0.849 +- 0.046 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.3 all KL = 0.968 +- 0.046 (in-sample avg dev_std = 0.150)
SUFF++ for r=0.3 all L1 = 0.853 +- 0.073 (in-sample avg dev_std = 0.150)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.543
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.582
SUFF++ for r=0.6 class 0.0 = 0.909 +- 0.026 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.6 class 1.0 = 0.876 +- 0.026 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.6 all KL = 0.98 +- 0.026 (in-sample avg dev_std = 0.124)
SUFF++ for r=0.6 all L1 = 0.88 +- 0.066 (in-sample avg dev_std = 0.124)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.636
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.638
SUFF++ for r=0.9 class 0.0 = 0.94 +- 0.029 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 class 1.0 = 0.898 +- 0.029 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 all KL = 0.986 +- 0.029 (in-sample avg dev_std = 0.094)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.069 (in-sample avg dev_std = 0.094)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.522
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.522
SUFF++ for r=0.3 class 0.0 = 0.862 +- 0.036 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.3 class 1.0 = 0.862 +- 0.036 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.3 all KL = 0.973 +- 0.036 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.3 all L1 = 0.862 +- 0.069 (in-sample avg dev_std = 0.140)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.502
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.517
SUFF++ for r=0.6 class 0.0 = 0.903 +- 0.021 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.6 class 1.0 = 0.888 +- 0.021 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.6 all KL = 0.984 +- 0.021 (in-sample avg dev_std = 0.105)
SUFF++ for r=0.6 all L1 = 0.891 +- 0.061 (in-sample avg dev_std = 0.105)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.535
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.533
SUFF++ for r=0.9 class 0.0 = 0.928 +- 0.024 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 class 1.0 = 0.91 +- 0.024 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 all KL = 0.989 +- 0.024 (in-sample avg dev_std = 0.082)
SUFF++ for r=0.9 all L1 = 0.913 +- 0.064 (in-sample avg dev_std = 0.082)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.503
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.47
NEC for r=0.3 class 0.0 = 0.119 +- 0.025 (in-sample avg dev_std = 0.095)
NEC for r=0.3 class 1.0 = 0.098 +- 0.025 (in-sample avg dev_std = 0.095)
NEC for r=0.3 all KL = 0.015 +- 0.025 (in-sample avg dev_std = 0.095)
NEC for r=0.3 all L1 = 0.1 +- 0.065 (in-sample avg dev_std = 0.095)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.508
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.491
NEC for r=0.6 class 0.0 = 0.103 +- 0.020 (in-sample avg dev_std = 0.093)
NEC for r=0.6 class 1.0 = 0.088 +- 0.020 (in-sample avg dev_std = 0.093)
NEC for r=0.6 all KL = 0.012 +- 0.020 (in-sample avg dev_std = 0.093)
NEC for r=0.6 all L1 = 0.09 +- 0.058 (in-sample avg dev_std = 0.093)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.59
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.573
NEC for r=0.9 class 0.0 = 0.089 +- 0.025 (in-sample avg dev_std = 0.100)
NEC for r=0.9 class 1.0 = 0.086 +- 0.025 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all KL = 0.012 +- 0.025 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all L1 = 0.087 +- 0.059 (in-sample avg dev_std = 0.100)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.603
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.599
NEC for r=1.0 class 0.0 = 0.084 +- 0.026 (in-sample avg dev_std = 0.099)
NEC for r=1.0 class 1.0 = 0.09 +- 0.026 (in-sample avg dev_std = 0.099)
NEC for r=1.0 all KL = 0.012 +- 0.026 (in-sample avg dev_std = 0.099)
NEC for r=1.0 all L1 = 0.089 +- 0.059 (in-sample avg dev_std = 0.099)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.545
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.523
NEC for r=0.3 class 0.0 = 0.126 +- 0.023 (in-sample avg dev_std = 0.094)
NEC for r=0.3 class 1.0 = 0.098 +- 0.023 (in-sample avg dev_std = 0.094)
NEC for r=0.3 all KL = 0.014 +- 0.023 (in-sample avg dev_std = 0.094)
NEC for r=0.3 all L1 = 0.101 +- 0.061 (in-sample avg dev_std = 0.094)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.543
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.541
NEC for r=0.6 class 0.0 = 0.098 +- 0.018 (in-sample avg dev_std = 0.089)
NEC for r=0.6 class 1.0 = 0.086 +- 0.018 (in-sample avg dev_std = 0.089)
NEC for r=0.6 all KL = 0.011 +- 0.018 (in-sample avg dev_std = 0.089)
NEC for r=0.6 all L1 = 0.087 +- 0.055 (in-sample avg dev_std = 0.089)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.636
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.607
NEC for r=0.9 class 0.0 = 0.07 +- 0.016 (in-sample avg dev_std = 0.087)
NEC for r=0.9 class 1.0 = 0.081 +- 0.016 (in-sample avg dev_std = 0.087)
NEC for r=0.9 all KL = 0.009 +- 0.016 (in-sample avg dev_std = 0.087)
NEC for r=0.9 all L1 = 0.08 +- 0.049 (in-sample avg dev_std = 0.087)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.653
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.636
NEC for r=1.0 class 0.0 = 0.067 +- 0.019 (in-sample avg dev_std = 0.095)
NEC for r=1.0 class 1.0 = 0.086 +- 0.019 (in-sample avg dev_std = 0.095)
NEC for r=1.0 all KL = 0.011 +- 0.019 (in-sample avg dev_std = 0.095)
NEC for r=1.0 all L1 = 0.084 +- 0.054 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.522
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.493
NEC for r=0.3 class 0.0 = 0.114 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.3 class 1.0 = 0.101 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.3 all KL = 0.014 +- 0.019 (in-sample avg dev_std = 0.091)
NEC for r=0.3 all L1 = 0.103 +- 0.062 (in-sample avg dev_std = 0.091)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.502
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.504
NEC for r=0.6 class 0.0 = 0.096 +- 0.024 (in-sample avg dev_std = 0.077)
NEC for r=0.6 class 1.0 = 0.089 +- 0.024 (in-sample avg dev_std = 0.077)
NEC for r=0.6 all KL = 0.011 +- 0.024 (in-sample avg dev_std = 0.077)
NEC for r=0.6 all L1 = 0.09 +- 0.061 (in-sample avg dev_std = 0.077)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.536
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.529
NEC for r=0.9 class 0.0 = 0.075 +- 0.014 (in-sample avg dev_std = 0.078)
NEC for r=0.9 class 1.0 = 0.078 +- 0.014 (in-sample avg dev_std = 0.078)
NEC for r=0.9 all KL = 0.008 +- 0.014 (in-sample avg dev_std = 0.078)
NEC for r=0.9 all L1 = 0.077 +- 0.047 (in-sample avg dev_std = 0.078)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.537
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.549
NEC for r=1.0 class 0.0 = 0.076 +- 0.021 (in-sample avg dev_std = 0.081)
NEC for r=1.0 class 1.0 = 0.08 +- 0.021 (in-sample avg dev_std = 0.081)
NEC for r=1.0 all KL = 0.009 +- 0.021 (in-sample avg dev_std = 0.081)
NEC for r=1.0 all L1 = 0.079 +- 0.053 (in-sample avg dev_std = 0.081)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:18:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 07/29/2024 11:18:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 07/29/2024 11:19:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 07/29/2024 11:19:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 07/29/2024 11:19:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 07/29/2024 11:19:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ROC-AUC: 0.9443
Train Loss: 0.1882
ID Validation ROC-AUC: 0.9128
ID Validation Loss: 0.2242
ID Test ROC-AUC: 0.9130
ID Test Loss: 0.2259
OOD Validation ROC-AUC: 0.6568
OOD Validation Loss: 0.3354
OOD Test ROC-AUC: 0.7075
OOD Test Loss: 0.4649

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ROC-AUC: 0.9031
Train Loss: 0.2393
ID Validation ROC-AUC: 0.8916
ID Validation Loss: 0.2501
ID Test ROC-AUC: 0.8874
ID Test Loss: 0.2582
OOD Validation ROC-AUC: 0.6903
OOD Validation Loss: 0.2974
OOD Test ROC-AUC: 0.7103
OOD Test Loss: 0.4628

[0m[1;37mINFO[0m: [1mChartInfo 0.9130 0.7075 0.8874 0.7103 0.8916 0.6903[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 07/29/2024 11:20:06 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(11683)
Data example from id_test: Data(x=[33, 39], edge_index=[2, 72], edge_attr=[72, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 72], node_perm=[33])
Label distribution from id_test: (tensor([0., 1.]), tensor([ 1386, 10297]))
[1;34mDEBUG[0m: 07/29/2024 11:20:10 PM : [1mUnbalanced warning for LBAPcore (id_test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 07/29/2024 11:20:14 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.709
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.68
SUFF++ for r=0.3 class 0.0 = 0.882 +- 0.037 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.3 class 1.0 = 0.853 +- 0.037 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.3 all KL = 0.971 +- 0.037 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.3 all L1 = 0.856 +- 0.069 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.741
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.739
SUFF++ for r=0.6 class 0.0 = 0.873 +- 0.061 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 class 1.0 = 0.787 +- 0.061 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 all KL = 0.927 +- 0.061 (in-sample avg dev_std = 0.242)
SUFF++ for r=0.6 all L1 = 0.797 +- 0.103 (in-sample avg dev_std = 0.242)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.788
SUFF++ for r=0.9 class 0.0 = 0.917 +- 0.057 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 class 1.0 = 0.868 +- 0.057 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 all KL = 0.961 +- 0.057 (in-sample avg dev_std = 0.153)
SUFF++ for r=0.9 all L1 = 0.874 +- 0.106 (in-sample avg dev_std = 0.153)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.74
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.691
SUFF++ for r=0.3 class 0.0 = 0.881 +- 0.038 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.3 class 1.0 = 0.853 +- 0.038 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.3 all KL = 0.97 +- 0.038 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.3 all L1 = 0.857 +- 0.064 (in-sample avg dev_std = 0.163)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.743
SUFF++ for r=0.6 class 0.0 = 0.879 +- 0.061 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.6 class 1.0 = 0.79 +- 0.061 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.6 all KL = 0.93 +- 0.061 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.6 all L1 = 0.801 +- 0.100 (in-sample avg dev_std = 0.241)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.812
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.812
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.056 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 class 1.0 = 0.858 +- 0.056 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all KL = 0.959 +- 0.056 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all L1 = 0.866 +- 0.104 (in-sample avg dev_std = 0.158)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.615
SUFF++ for r=0.3 class 0.0 = 0.889 +- 0.034 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.3 class 1.0 = 0.87 +- 0.034 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.3 all KL = 0.976 +- 0.034 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.3 all L1 = 0.873 +- 0.067 (in-sample avg dev_std = 0.149)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.624
SUFF++ for r=0.6 class 0.0 = 0.867 +- 0.062 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 1.0 = 0.818 +- 0.062 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 all KL = 0.943 +- 0.062 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 all L1 = 0.826 +- 0.106 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.636
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.647
SUFF++ for r=0.9 class 0.0 = 0.904 +- 0.055 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 class 1.0 = 0.87 +- 0.055 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 all KL = 0.966 +- 0.055 (in-sample avg dev_std = 0.149)
SUFF++ for r=0.9 all L1 = 0.875 +- 0.101 (in-sample avg dev_std = 0.149)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.709
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.729
NEC for r=0.3 class 0.0 = 0.078 +- 0.025 (in-sample avg dev_std = 0.087)
NEC for r=0.3 class 1.0 = 0.094 +- 0.025 (in-sample avg dev_std = 0.087)
NEC for r=0.3 all KL = 0.012 +- 0.025 (in-sample avg dev_std = 0.087)
NEC for r=0.3 all L1 = 0.092 +- 0.069 (in-sample avg dev_std = 0.087)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.738
NEC for r=0.6 class 0.0 = 0.076 +- 0.043 (in-sample avg dev_std = 0.115)
NEC for r=0.6 class 1.0 = 0.125 +- 0.043 (in-sample avg dev_std = 0.115)
NEC for r=0.6 all KL = 0.026 +- 0.043 (in-sample avg dev_std = 0.115)
NEC for r=0.6 all L1 = 0.119 +- 0.087 (in-sample avg dev_std = 0.115)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.784
NEC for r=0.9 class 0.0 = 0.08 +- 0.044 (in-sample avg dev_std = 0.123)
NEC for r=0.9 class 1.0 = 0.11 +- 0.044 (in-sample avg dev_std = 0.123)
NEC for r=0.9 all KL = 0.027 +- 0.044 (in-sample avg dev_std = 0.123)
NEC for r=0.9 all L1 = 0.106 +- 0.083 (in-sample avg dev_std = 0.123)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.794
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.796
NEC for r=1.0 class 0.0 = 0.079 +- 0.042 (in-sample avg dev_std = 0.118)
NEC for r=1.0 class 1.0 = 0.099 +- 0.042 (in-sample avg dev_std = 0.118)
NEC for r=1.0 all KL = 0.025 +- 0.042 (in-sample avg dev_std = 0.118)
NEC for r=1.0 all L1 = 0.097 +- 0.080 (in-sample avg dev_std = 0.118)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.741
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.744
NEC for r=0.3 class 0.0 = 0.072 +- 0.027 (in-sample avg dev_std = 0.089)
NEC for r=0.3 class 1.0 = 0.094 +- 0.027 (in-sample avg dev_std = 0.089)
NEC for r=0.3 all KL = 0.013 +- 0.027 (in-sample avg dev_std = 0.089)
NEC for r=0.3 all L1 = 0.091 +- 0.067 (in-sample avg dev_std = 0.089)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.751
NEC for r=0.6 class 0.0 = 0.07 +- 0.043 (in-sample avg dev_std = 0.114)
NEC for r=0.6 class 1.0 = 0.118 +- 0.043 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all KL = 0.024 +- 0.043 (in-sample avg dev_std = 0.114)
NEC for r=0.6 all L1 = 0.113 +- 0.081 (in-sample avg dev_std = 0.114)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.812
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.906 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.793
NEC for r=0.9 class 0.0 = 0.074 +- 0.048 (in-sample avg dev_std = 0.131)
NEC for r=0.9 class 1.0 = 0.115 +- 0.048 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all KL = 0.03 +- 0.048 (in-sample avg dev_std = 0.131)
NEC for r=0.9 all L1 = 0.11 +- 0.088 (in-sample avg dev_std = 0.131)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.821
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.803
NEC for r=1.0 class 0.0 = 0.077 +- 0.045 (in-sample avg dev_std = 0.124)
NEC for r=1.0 class 1.0 = 0.107 +- 0.045 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all KL = 0.027 +- 0.045 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all L1 = 0.104 +- 0.084 (in-sample avg dev_std = 0.124)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.649
NEC for r=0.3 class 0.0 = 0.08 +- 0.023 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 1.0 = 0.086 +- 0.023 (in-sample avg dev_std = 0.083)
NEC for r=0.3 all KL = 0.011 +- 0.023 (in-sample avg dev_std = 0.083)
NEC for r=0.3 all L1 = 0.085 +- 0.066 (in-sample avg dev_std = 0.083)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.633
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.636
NEC for r=0.6 class 0.0 = 0.09 +- 0.042 (in-sample avg dev_std = 0.110)
NEC for r=0.6 class 1.0 = 0.106 +- 0.042 (in-sample avg dev_std = 0.110)
NEC for r=0.6 all KL = 0.021 +- 0.042 (in-sample avg dev_std = 0.110)
NEC for r=0.6 all L1 = 0.103 +- 0.083 (in-sample avg dev_std = 0.110)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.636
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.644
NEC for r=0.9 class 0.0 = 0.087 +- 0.050 (in-sample avg dev_std = 0.128)
NEC for r=0.9 class 1.0 = 0.111 +- 0.050 (in-sample avg dev_std = 0.128)
NEC for r=0.9 all KL = 0.026 +- 0.050 (in-sample avg dev_std = 0.128)
NEC for r=0.9 all L1 = 0.107 +- 0.082 (in-sample avg dev_std = 0.128)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.648
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.648
NEC for r=1.0 class 0.0 = 0.085 +- 0.044 (in-sample avg dev_std = 0.123)
NEC for r=1.0 class 1.0 = 0.107 +- 0.044 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all KL = 0.024 +- 0.044 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all L1 = 0.103 +- 0.080 (in-sample avg dev_std = 0.123)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.92, 0.908, 0.95, 1.0], 'all_L1': [0.776, 0.774, 0.842, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.944, 0.911, 0.933, 1.0], 'all_L1': [0.802, 0.773, 0.84, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.874, 0.927, 1.0], 'all_L1': [0.807, 0.75, 0.847, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.97, 0.98, 0.986, 1.0], 'all_L1': [0.857, 0.881, 0.899, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.971, 0.927, 0.961, 1.0], 'all_L1': [0.856, 0.797, 0.874, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.04, 0.044, 0.04, 0.036], 'all_L1': [0.155, 0.159, 0.14, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.035, 0.049, 0.046, 0.048], 'all_L1': [0.159, 0.164, 0.133, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.062, 0.062, 0.051], 'all_L1': [0.139, 0.166, 0.138, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.012, 0.012, 0.012], 'all_L1': [0.1, 0.09, 0.087, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.026, 0.027, 0.025], 'all_L1': [0.092, 0.119, 0.106, 0.097]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.914, 0.905, 0.95, 1.0], 'all_L1': [0.772, 0.772, 0.845, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.91, 0.925, 1.0], 'all_L1': [0.801, 0.776, 0.835, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.938, 0.866, 0.916, 1.0], 'all_L1': [0.798, 0.741, 0.836, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.98, 0.986, 1.0], 'all_L1': [0.853, 0.88, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.97, 0.93, 0.959, 1.0], 'all_L1': [0.857, 0.801, 0.866, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.041, 0.046, 0.041, 0.035], 'all_L1': [0.156, 0.158, 0.139, 0.125]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.05, 0.053, 0.051], 'all_L1': [0.152, 0.162, 0.136, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.065, 0.058, 0.058], 'all_L1': [0.134, 0.168, 0.133, 0.13]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.011, 0.009, 0.011], 'all_L1': [0.101, 0.087, 0.08, 0.084]}), defaultdict(<class 'list'>, {'all_KL': [0.013, 0.024, 0.03, 0.027], 'all_L1': [0.091, 0.113, 0.11, 0.104]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.932, 0.922, 0.956, 1.0], 'all_L1': [0.8, 0.791, 0.85, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.942, 0.918, 0.935, 1.0], 'all_L1': [0.795, 0.778, 0.829, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.947, 0.884, 0.932, 1.0], 'all_L1': [0.812, 0.756, 0.834, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.973, 0.984, 0.989, 1.0], 'all_L1': [0.862, 0.891, 0.913, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.976, 0.943, 0.966, 1.0], 'all_L1': [0.873, 0.826, 0.875, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.032, 0.038, 0.036, 0.037], 'all_L1': [0.142, 0.148, 0.138, 0.136]}), defaultdict(<class 'list'>, {'all_KL': [0.039, 0.046, 0.046, 0.046], 'all_L1': [0.169, 0.163, 0.146, 0.143]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.055, 0.058, 0.053], 'all_L1': [0.137, 0.158, 0.152, 0.143]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.011, 0.008, 0.009], 'all_L1': [0.103, 0.09, 0.077, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.021, 0.026, 0.024], 'all_L1': [0.085, 0.103, 0.107, 0.103]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.820 +- 0.032, 0.795 +- 0.045, 0.860 +- 0.023, 1.000 +- 0.000
suff++ class all_KL  =  0.950 +- 0.019, 0.920 +- 0.035, 0.951 +- 0.021, 1.000 +- 0.000
suff++_acc_int  =  0.661 +- 0.058, 0.706 +- 0.081, 0.755 +- 0.079
nec class all_L1  =  0.129 +- 0.028, 0.140 +- 0.030, 0.121 +- 0.021, 0.113 +- 0.017
nec class all_KL  =  0.027 +- 0.011, 0.039 +- 0.018, 0.037 +- 0.017, 0.034 +- 0.015
nec_acc_int  =  0.659 +- 0.098, 0.695 +- 0.105, 0.750 +- 0.090, 0.766 +- 0.084

Eval split id_test
suff++ class all_L1  =  0.816 +- 0.033, 0.794 +- 0.047, 0.857 +- 0.026, 1.000 +- 0.000
suff++ class all_KL  =  0.946 +- 0.021, 0.918 +- 0.037, 0.947 +- 0.025, 1.000 +- 0.000
suff++_acc_int  =  0.664 +- 0.059, 0.719 +- 0.072, 0.773 +- 0.068
nec class all_L1  =  0.127 +- 0.026, 0.138 +- 0.032, 0.120 +- 0.022, 0.114 +- 0.018
nec class all_KL  =  0.026 +- 0.011, 0.039 +- 0.019, 0.038 +- 0.018, 0.036 +- 0.017
nec_acc_int  =  0.686 +- 0.085, 0.719 +- 0.093, 0.767 +- 0.082, 0.779 +- 0.072

Eval split test
suff++ class all_L1  =  0.828 +- 0.033, 0.808 +- 0.047, 0.860 +- 0.031, 1.000 +- 0.000
suff++ class all_KL  =  0.954 +- 0.017, 0.930 +- 0.033, 0.956 +- 0.021, 1.000 +- 0.000
suff++_acc_int  =  0.598 +- 0.045, 0.615 +- 0.054, 0.640 +- 0.056
nec class all_L1  =  0.127 +- 0.030, 0.132 +- 0.030, 0.124 +- 0.028, 0.121 +- 0.026
nec class all_KL  =  0.025 +- 0.011, 0.034 +- 0.016, 0.035 +- 0.017, 0.034 +- 0.016
nec_acc_int  =  0.606 +- 0.060, 0.619 +- 0.063, 0.638 +- 0.059, 0.645 +- 0.052


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.005, 0.467 +- 0.010, 0.491 +- 0.002, 0.557 +- 0.008
Faith. Armon (L1)= 		  =  0.221 +- 0.041, 0.235 +- 0.043, 0.211 +- 0.032, 0.203 +- 0.027
Faith. GMean (L1)= 	  =  0.322 +- 0.030, 0.330 +- 0.030, 0.321 +- 0.025, 0.335 +- 0.025
Faith. Aritm (KL)= 		  =  0.488 +- 0.004, 0.479 +- 0.009, 0.494 +- 0.003, 0.517 +- 0.007
Faith. Armon (KL)= 		  =  0.051 +- 0.021, 0.073 +- 0.033, 0.071 +- 0.031, 0.066 +- 0.027
Faith. GMean (KL)= 	  =  0.155 +- 0.034, 0.182 +- 0.044, 0.182 +- 0.045, 0.180 +- 0.043

Eval split id_test
Faith. Aritm (L1)= 		  =  0.472 +- 0.005, 0.466 +- 0.010, 0.488 +- 0.003, 0.557 +- 0.009
Faith. Armon (L1)= 		  =  0.218 +- 0.039, 0.232 +- 0.046, 0.209 +- 0.035, 0.205 +- 0.029
Faith. GMean (L1)= 	  =  0.319 +- 0.028, 0.327 +- 0.032, 0.318 +- 0.027, 0.337 +- 0.027
Faith. Aritm (KL)= 		  =  0.486 +- 0.005, 0.479 +- 0.010, 0.493 +- 0.004, 0.518 +- 0.008
Faith. Armon (KL)= 		  =  0.051 +- 0.021, 0.074 +- 0.035, 0.073 +- 0.033, 0.070 +- 0.031
Faith. GMean (KL)= 	  =  0.154 +- 0.033, 0.182 +- 0.048, 0.183 +- 0.049, 0.185 +- 0.048

Eval split test
Faith. Aritm (L1)= 		  =  0.478 +- 0.004, 0.470 +- 0.011, 0.492 +- 0.003, 0.560 +- 0.013
Faith. Armon (L1)= 		  =  0.219 +- 0.044, 0.225 +- 0.043, 0.215 +- 0.043, 0.215 +- 0.041
Faith. GMean (L1)= 	  =  0.321 +- 0.033, 0.324 +- 0.030, 0.324 +- 0.034, 0.345 +- 0.039
Faith. Aritm (KL)= 		  =  0.489 +- 0.004, 0.482 +- 0.009, 0.495 +- 0.003, 0.517 +- 0.008
Faith. Armon (KL)= 		  =  0.048 +- 0.020, 0.065 +- 0.030, 0.067 +- 0.032, 0.065 +- 0.030
Faith. GMean (KL)= 	  =  0.150 +- 0.034, 0.172 +- 0.043, 0.175 +- 0.049, 0.177 +- 0.048
Computed for split load_split = id



Completed in  0:26:21.946006  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:24:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:24:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4476
OOD Validation ACCURACY: 0.8772
OOD Validation Loss: 0.5532
OOD Test ACCURACY: 0.8226
OOD Test Loss: 0.9289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0021
ID Validation ACCURACY: 0.9159
ID Validation Loss: 0.3511
ID Test ACCURACY: 0.9110
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.8826
OOD Validation Loss: 0.4988
OOD Test ACCURACY: 0.8356
OOD Test Loss: 0.8592

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8226 0.9110 0.8356 0.9159 0.8826[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:24:26 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.805
SUFF++ for r=0.6 class 0.0 = 0.718 +- 0.327 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 class 1.0 = 0.827 +- 0.327 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all KL = 0.615 +- 0.327 (in-sample avg dev_std = 0.530)
SUFF++ for r=0.6 all L1 = 0.781 +- 0.212 (in-sample avg dev_std = 0.530)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.893
SUFF++ for r=0.9 class 0.0 = 0.968 +- 0.106 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1.0 = 0.982 +- 0.106 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.982 +- 0.106 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.976 +- 0.097 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.761
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.726
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1.0 = 0.849 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.701 +- 0.297 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.785 +- 0.219 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.808
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.787
SUFF++ for r=0.6 class 0.0 = 0.813 +- 0.262 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.262 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all KL = 0.8 +- 0.262 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.6 all L1 = 0.855 +- 0.194 (in-sample avg dev_std = 0.371)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.82
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.113 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.113 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all KL = 0.943 +- 0.113 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.9 all L1 = 0.942 +- 0.109 (in-sample avg dev_std = 0.219)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.853
NEC for r=0.6 class 0.0 = 0.157 +- 0.257 (in-sample avg dev_std = 0.249)
NEC for r=0.6 class 1.0 = 0.06 +- 0.257 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all KL = 0.114 +- 0.257 (in-sample avg dev_std = 0.249)
NEC for r=0.6 all L1 = 0.101 +- 0.209 (in-sample avg dev_std = 0.249)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.038 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=0.9 class 1.0 = 0.021 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all KL = 0.024 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=0.9 all L1 = 0.028 +- 0.116 (in-sample avg dev_std = 0.100)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.88
NEC for r=1.0 class 0.0 = 0.038 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=1.0 class 1.0 = 0.021 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all KL = 0.024 +- 0.130 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all L1 = 0.028 +- 0.116 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.761
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.754
NEC for r=0.3 class 0.0 = 0.219 +- 0.279 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 1.0 = 0.111 +- 0.279 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all KL = 0.172 +- 0.279 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all L1 = 0.163 +- 0.241 (in-sample avg dev_std = 0.300)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.808
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.803
NEC for r=0.6 class 0.0 = 0.099 +- 0.162 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1.0 = 0.057 +- 0.162 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.067 +- 0.162 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.077 +- 0.159 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.831
NEC for r=0.9 class 0.0 = 0.043 +- 0.061 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.019 +- 0.061 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.016 +- 0.061 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.031 +- 0.085 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.829
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.828
NEC for r=1.0 class 0.0 = 0.037 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.019 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.016 +- 0.066 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.028 +- 0.081 (in-sample avg dev_std = 0.091)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:26:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:26:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3737
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4207
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.5304
OOD Test ACCURACY: 0.8254
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4219
ID Test ACCURACY: 0.9157
ID Test Loss: 0.4817
OOD Validation ACCURACY: 0.8832
OOD Validation Loss: 0.6079
OOD Test ACCURACY: 0.8258
OOD Test Loss: 1.2557

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8254 0.9157 0.8258 0.9194 0.8832[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:26:07 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.811
SUFF++ for r=0.6 class 0.0 = 0.772 +- 0.312 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 class 1.0 = 0.825 +- 0.312 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all KL = 0.649 +- 0.312 (in-sample avg dev_std = 0.494)
SUFF++ for r=0.6 all L1 = 0.803 +- 0.192 (in-sample avg dev_std = 0.494)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0.0 = 0.951 +- 0.127 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.979 +- 0.127 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.973 +- 0.127 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.966 +- 0.120 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.739
SUFF++ for r=0.3 class 0.0 = 0.745 +- 0.290 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 class 1.0 = 0.809 +- 0.290 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all KL = 0.67 +- 0.290 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.3 all L1 = 0.778 +- 0.202 (in-sample avg dev_std = 0.482)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.795
SUFF++ for r=0.6 class 0.0 = 0.816 +- 0.266 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1.0 = 0.872 +- 0.266 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.782 +- 0.266 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.845 +- 0.197 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.848
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0.0 = 0.924 +- 0.133 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.133 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all KL = 0.932 +- 0.133 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.114 (in-sample avg dev_std = 0.232)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.857
NEC for r=0.6 class 0.0 = 0.138 +- 0.249 (in-sample avg dev_std = 0.220)
NEC for r=0.6 class 1.0 = 0.07 +- 0.249 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all KL = 0.113 +- 0.249 (in-sample avg dev_std = 0.220)
NEC for r=0.6 all L1 = 0.098 +- 0.200 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
NEC for r=0.9 class 0.0 = 0.043 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=0.9 class 1.0 = 0.019 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all KL = 0.028 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=0.9 all L1 = 0.029 +- 0.115 (in-sample avg dev_std = 0.090)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.871
NEC for r=1.0 class 0.0 = 0.043 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=1.0 class 1.0 = 0.019 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all KL = 0.028 +- 0.138 (in-sample avg dev_std = 0.090)
NEC for r=1.0 all L1 = 0.029 +- 0.115 (in-sample avg dev_std = 0.090)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.761
NEC for r=0.3 class 0.0 = 0.199 +- 0.268 (in-sample avg dev_std = 0.282)
NEC for r=0.3 class 1.0 = 0.114 +- 0.268 (in-sample avg dev_std = 0.282)
NEC for r=0.3 all KL = 0.163 +- 0.268 (in-sample avg dev_std = 0.282)
NEC for r=0.3 all L1 = 0.155 +- 0.229 (in-sample avg dev_std = 0.282)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.81
NEC for r=0.6 class 0.0 = 0.111 +- 0.196 (in-sample avg dev_std = 0.216)
NEC for r=0.6 class 1.0 = 0.073 +- 0.196 (in-sample avg dev_std = 0.216)
NEC for r=0.6 all KL = 0.085 +- 0.196 (in-sample avg dev_std = 0.216)
NEC for r=0.6 all L1 = 0.092 +- 0.180 (in-sample avg dev_std = 0.216)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.848
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.841
NEC for r=0.9 class 0.0 = 0.034 +- 0.074 (in-sample avg dev_std = 0.099)
NEC for r=0.9 class 1.0 = 0.027 +- 0.074 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all KL = 0.018 +- 0.074 (in-sample avg dev_std = 0.099)
NEC for r=0.9 all L1 = 0.03 +- 0.087 (in-sample avg dev_std = 0.099)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.849
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.845
NEC for r=1.0 class 0.0 = 0.027 +- 0.064 (in-sample avg dev_std = 0.087)
NEC for r=1.0 class 1.0 = 0.023 +- 0.064 (in-sample avg dev_std = 0.087)
NEC for r=1.0 all KL = 0.014 +- 0.064 (in-sample avg dev_std = 0.087)
NEC for r=1.0 all L1 = 0.025 +- 0.076 (in-sample avg dev_std = 0.087)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:27:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:27:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.4058
ID Test ACCURACY: 0.9147
ID Test Loss: 0.4863
OOD Validation ACCURACY: 0.8811
OOD Validation Loss: 0.5978
OOD Test ACCURACY: 0.8111
OOD Test Loss: 1.3825

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9211
ID Validation Loss: 0.4242
ID Test ACCURACY: 0.9145
ID Test Loss: 0.5078
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.6388
OOD Test ACCURACY: 0.8267
OOD Test Loss: 1.3856

[0m[1;37mINFO[0m: [1mChartInfo 0.9147 0.8111 0.9145 0.8267 0.9211 0.8839[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:27:50 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.825
SUFF++ for r=0.6 class 0.0 = 0.787 +- 0.324 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 class 1.0 = 0.845 +- 0.324 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all KL = 0.657 +- 0.324 (in-sample avg dev_std = 0.471)
SUFF++ for r=0.6 all L1 = 0.821 +- 0.191 (in-sample avg dev_std = 0.471)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.894
SUFF++ for r=0.9 class 0.0 = 0.969 +- 0.096 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 class 1.0 = 0.989 +- 0.096 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 all KL = 0.984 +- 0.096 (in-sample avg dev_std = 0.071)
SUFF++ for r=0.9 all L1 = 0.98 +- 0.086 (in-sample avg dev_std = 0.071)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.727
SUFF++ for r=0.3 class 0.0 = 0.715 +- 0.341 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 1.0 = 0.813 +- 0.341 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all KL = 0.606 +- 0.341 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all L1 = 0.766 +- 0.217 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.811
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.781
SUFF++ for r=0.6 class 0.0 = 0.78 +- 0.306 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 1.0 = 0.906 +- 0.306 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all KL = 0.75 +- 0.306 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all L1 = 0.845 +- 0.199 (in-sample avg dev_std = 0.412)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.812
SUFF++ for r=0.9 class 0.0 = 0.921 +- 0.148 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.148 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all KL = 0.932 +- 0.148 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.109 (in-sample avg dev_std = 0.233)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.864
NEC for r=0.6 class 0.0 = 0.098 +- 0.217 (in-sample avg dev_std = 0.169)
NEC for r=0.6 class 1.0 = 0.057 +- 0.217 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all KL = 0.084 +- 0.217 (in-sample avg dev_std = 0.169)
NEC for r=0.6 all L1 = 0.074 +- 0.170 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.882
NEC for r=0.9 class 0.0 = 0.035 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=0.9 class 1.0 = 0.014 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all KL = 0.021 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=0.9 all L1 = 0.023 +- 0.098 (in-sample avg dev_std = 0.085)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.882
NEC for r=1.0 class 0.0 = 0.035 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=1.0 class 1.0 = 0.014 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all KL = 0.021 +- 0.122 (in-sample avg dev_std = 0.085)
NEC for r=1.0 all L1 = 0.023 +- 0.098 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.783
NEC for r=0.3 class 0.0 = 0.194 +- 0.289 (in-sample avg dev_std = 0.303)
NEC for r=0.3 class 1.0 = 0.102 +- 0.289 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all KL = 0.171 +- 0.289 (in-sample avg dev_std = 0.303)
NEC for r=0.3 all L1 = 0.147 +- 0.234 (in-sample avg dev_std = 0.303)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.811
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.815
NEC for r=0.6 class 0.0 = 0.104 +- 0.182 (in-sample avg dev_std = 0.202)
NEC for r=0.6 class 1.0 = 0.051 +- 0.182 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all KL = 0.073 +- 0.182 (in-sample avg dev_std = 0.202)
NEC for r=0.6 all L1 = 0.076 +- 0.164 (in-sample avg dev_std = 0.202)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.82
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.815
NEC for r=0.9 class 0.0 = 0.034 +- 0.075 (in-sample avg dev_std = 0.093)
NEC for r=0.9 class 1.0 = 0.016 +- 0.075 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all KL = 0.015 +- 0.075 (in-sample avg dev_std = 0.093)
NEC for r=0.9 all L1 = 0.025 +- 0.084 (in-sample avg dev_std = 0.093)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.819
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.815
NEC for r=1.0 class 0.0 = 0.03 +- 0.062 (in-sample avg dev_std = 0.091)
NEC for r=1.0 class 1.0 = 0.014 +- 0.062 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all KL = 0.013 +- 0.062 (in-sample avg dev_std = 0.091)
NEC for r=1.0 all L1 = 0.022 +- 0.075 (in-sample avg dev_std = 0.091)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:29:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:29:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9223
ID Validation Loss: 0.3683
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4352
OOD Validation ACCURACY: 0.8814
OOD Validation Loss: 0.5797
OOD Test ACCURACY: 0.8193
OOD Test Loss: 1.6663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0050
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.3159
ID Test ACCURACY: 0.9144
ID Test Loss: 0.3601
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.5335
OOD Test ACCURACY: 0.8287
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8193 0.9144 0.8287 0.9183 0.8839[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:29:31 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.817
SUFF++ for r=0.6 class 0.0 = 0.778 +- 0.317 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1.0 = 0.834 +- 0.317 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.666 +- 0.317 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.811 +- 0.199 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.886
SUFF++ for r=0.9 class 0.0 = 0.957 +- 0.121 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 class 1.0 = 0.984 +- 0.121 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all KL = 0.976 +- 0.121 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.105 (in-sample avg dev_std = 0.104)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.78
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.734
SUFF++ for r=0.3 class 0.0 = 0.714 +- 0.328 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 1.0 = 0.831 +- 0.328 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all KL = 0.629 +- 0.328 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all L1 = 0.774 +- 0.215 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.785
SUFF++ for r=0.6 class 0.0 = 0.805 +- 0.311 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 class 1.0 = 0.9 +- 0.311 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all KL = 0.76 +- 0.311 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.6 all L1 = 0.854 +- 0.200 (in-sample avg dev_std = 0.408)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.829
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.138 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.138 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 all KL = 0.945 +- 0.138 (in-sample avg dev_std = 0.213)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.101 (in-sample avg dev_std = 0.213)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.859
NEC for r=0.6 class 0.0 = 0.147 +- 0.266 (in-sample avg dev_std = 0.227)
NEC for r=0.6 class 1.0 = 0.074 +- 0.266 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all KL = 0.128 +- 0.266 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all L1 = 0.105 +- 0.205 (in-sample avg dev_std = 0.227)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.872
NEC for r=0.9 class 0.0 = 0.05 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=0.9 class 1.0 = 0.017 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all KL = 0.029 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=0.9 all L1 = 0.031 +- 0.123 (in-sample avg dev_std = 0.083)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.872
NEC for r=1.0 class 0.0 = 0.05 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=1.0 class 1.0 = 0.017 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=1.0 all KL = 0.029 +- 0.143 (in-sample avg dev_std = 0.083)
NEC for r=1.0 all L1 = 0.031 +- 0.123 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.78
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.773
NEC for r=0.3 class 0.0 = 0.202 +- 0.279 (in-sample avg dev_std = 0.280)
NEC for r=0.3 class 1.0 = 0.098 +- 0.279 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all KL = 0.17 +- 0.279 (in-sample avg dev_std = 0.280)
NEC for r=0.3 all L1 = 0.148 +- 0.229 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.819
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.104 +- 0.200 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1.0 = 0.054 +- 0.200 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.083 +- 0.200 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.078 +- 0.169 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.83
NEC for r=0.9 class 0.0 = 0.031 +- 0.091 (in-sample avg dev_std = 0.103)
NEC for r=0.9 class 1.0 = 0.02 +- 0.091 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all KL = 0.019 +- 0.091 (in-sample avg dev_std = 0.103)
NEC for r=0.9 all L1 = 0.025 +- 0.093 (in-sample avg dev_std = 0.103)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.832
NEC for r=1.0 class 0.0 = 0.021 +- 0.077 (in-sample avg dev_std = 0.100)
NEC for r=1.0 class 1.0 = 0.017 +- 0.077 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all KL = 0.014 +- 0.077 (in-sample avg dev_std = 0.100)
NEC for r=1.0 all L1 = 0.019 +- 0.069 (in-sample avg dev_std = 0.100)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:31:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:31:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0042
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.3042
ID Test ACCURACY: 0.9100
ID Test Loss: 0.3409
OOD Validation ACCURACY: 0.8736
OOD Validation Loss: 0.4929
OOD Test ACCURACY: 0.8157
OOD Test Loss: 0.9444

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9155
ID Validation Loss: 0.4081
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4411
OOD Validation ACCURACY: 0.8864
OOD Validation Loss: 0.5536
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.0612

[0m[1;37mINFO[0m: [1mChartInfo 0.9100 0.8157 0.9153 0.8255 0.9155 0.8864[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:31:12 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.826
SUFF++ for r=0.6 class 0.0 = 0.784 +- 0.265 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1.0 = 0.839 +- 0.265 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.716 +- 0.265 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.816 +- 0.183 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.879
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.102 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.9 class 1.0 = 0.987 +- 0.102 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.9 all KL = 0.981 +- 0.102 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.9 all L1 = 0.968 +- 0.105 (in-sample avg dev_std = 0.079)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.71
SUFF++ for r=0.3 class 0.0 = 0.654 +- 0.292 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 class 1.0 = 0.817 +- 0.292 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all KL = 0.643 +- 0.292 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.3 all L1 = 0.738 +- 0.216 (in-sample avg dev_std = 0.503)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF++ for r=0.6 class 0.0 = 0.782 +- 0.253 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.253 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.787 +- 0.253 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.84 +- 0.193 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.824
SUFF++ for r=0.9 class 0.0 = 0.927 +- 0.107 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 class 1.0 = 0.963 +- 0.107 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all KL = 0.948 +- 0.107 (in-sample avg dev_std = 0.207)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.104 (in-sample avg dev_std = 0.207)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.852
NEC for r=0.6 class 0.0 = 0.138 +- 0.231 (in-sample avg dev_std = 0.208)
NEC for r=0.6 class 1.0 = 0.066 +- 0.231 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all KL = 0.096 +- 0.231 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all L1 = 0.096 +- 0.192 (in-sample avg dev_std = 0.208)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.87
NEC for r=0.9 class 0.0 = 0.052 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=0.9 class 1.0 = 0.02 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all KL = 0.023 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all L1 = 0.034 +- 0.107 (in-sample avg dev_std = 0.082)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.87
NEC for r=1.0 class 0.0 = 0.052 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=1.0 class 1.0 = 0.02 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all KL = 0.023 +- 0.111 (in-sample avg dev_std = 0.082)
NEC for r=1.0 all L1 = 0.034 +- 0.107 (in-sample avg dev_std = 0.082)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.763
NEC for r=0.3 class 0.0 = 0.259 +- 0.265 (in-sample avg dev_std = 0.281)
NEC for r=0.3 class 1.0 = 0.121 +- 0.265 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all KL = 0.184 +- 0.265 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all L1 = 0.188 +- 0.241 (in-sample avg dev_std = 0.281)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.809
NEC for r=0.6 class 0.0 = 0.121 +- 0.158 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 1.0 = 0.063 +- 0.158 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all KL = 0.073 +- 0.158 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all L1 = 0.091 +- 0.170 (in-sample avg dev_std = 0.189)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.828
NEC for r=0.9 class 0.0 = 0.041 +- 0.055 (in-sample avg dev_std = 0.082)
NEC for r=0.9 class 1.0 = 0.017 +- 0.055 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all KL = 0.014 +- 0.055 (in-sample avg dev_std = 0.082)
NEC for r=0.9 all L1 = 0.029 +- 0.080 (in-sample avg dev_std = 0.082)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0.0 = 0.034 +- 0.051 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.015 +- 0.051 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.011 +- 0.051 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.024 +- 0.072 (in-sample avg dev_std = 0.080)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.615, 0.982, 1.0], 'all_L1': [0.781, 0.976, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.649, 0.973, 1.0], 'all_L1': [0.803, 0.966, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.984, 1.0], 'all_L1': [0.821, 0.98, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.666, 0.976, 1.0], 'all_L1': [0.811, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.716, 0.981, 1.0], 'all_L1': [0.816, 0.968, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.114, 0.024, 0.024], 'all_L1': [0.101, 0.028, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.113, 0.028, 0.028], 'all_L1': [0.098, 0.029, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.084, 0.021, 0.021], 'all_L1': [0.074, 0.023, 0.023]}), defaultdict(<class 'list'>, {'all_KL': [0.128, 0.029, 0.029], 'all_L1': [0.105, 0.031, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.096, 0.023, 0.023], 'all_L1': [0.096, 0.034, 0.034]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.701, 0.8, 0.943, 1.0], 'all_L1': [0.785, 0.855, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.782, 0.932, 1.0], 'all_L1': [0.778, 0.845, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.606, 0.75, 0.932, 1.0], 'all_L1': [0.766, 0.845, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.629, 0.76, 0.945, 1.0], 'all_L1': [0.774, 0.854, 0.957, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.643, 0.787, 0.948, 1.0], 'all_L1': [0.738, 0.84, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.172, 0.067, 0.016, 0.016], 'all_L1': [0.163, 0.077, 0.031, 0.028]}), defaultdict(<class 'list'>, {'all_KL': [0.163, 0.085, 0.018, 0.014], 'all_L1': [0.155, 0.092, 0.03, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.171, 0.073, 0.015, 0.013], 'all_L1': [0.147, 0.076, 0.025, 0.022]}), defaultdict(<class 'list'>, {'all_KL': [0.17, 0.083, 0.019, 0.014], 'all_L1': [0.148, 0.078, 0.025, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.184, 0.073, 0.014, 0.011], 'all_L1': [0.188, 0.091, 0.029, 0.024]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.806 +- 0.014, 0.972 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.661 +- 0.033, 0.979 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.817 +- 0.008, 0.885 +- 0.008
nec class all_L1  =  0.095 +- 0.011, 0.029 +- 0.004, 0.029 +- 0.004
nec class all_KL  =  0.107 +- 0.015, 0.025 +- 0.003, 0.025 +- 0.003
nec_acc_int  =  0.857 +- 0.004, 0.875 +- 0.005, 0.875 +- 0.005

Eval split test
suff++ class all_L1  =  0.768 +- 0.016, 0.848 +- 0.006, 0.946 +- 0.006, 1.000 +- 0.000
suff++ class all_KL  =  0.650 +- 0.033, 0.776 +- 0.018, 0.940 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.727 +- 0.010, 0.785 +- 0.006, 0.824 +- 0.007
nec class all_L1  =  0.160 +- 0.015, 0.083 +- 0.007, 0.028 +- 0.003, 0.024 +- 0.003
nec class all_KL  =  0.172 +- 0.007, 0.076 +- 0.007, 0.016 +- 0.002, 0.014 +- 0.002
nec_acc_int  =  0.767 +- 0.010, 0.810 +- 0.004, 0.829 +- 0.008, 0.830 +- 0.010


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.451 +- 0.006, 0.501 +- 0.002, 0.515 +- 0.002
Faith. Armon (L1)= 		  =  0.169 +- 0.017, 0.056 +- 0.007, 0.056 +- 0.007
Faith. GMean (L1)= 	  =  0.276 +- 0.015, 0.168 +- 0.010, 0.170 +- 0.011
Faith. Aritm (KL)= 		  =  0.384 +- 0.016, 0.502 +- 0.001, 0.512 +- 0.002
Faith. Armon (KL)= 		  =  0.184 +- 0.022, 0.049 +- 0.006, 0.049 +- 0.006
Faith. GMean (KL)= 	  =  0.265 +- 0.018, 0.156 +- 0.009, 0.158 +- 0.010

Eval split test
Faith. Aritm (L1)= 		  =  0.464 +- 0.006, 0.465 +- 0.003, 0.487 +- 0.002, 0.512 +- 0.002
Faith. Armon (L1)= 		  =  0.265 +- 0.019, 0.151 +- 0.012, 0.054 +- 0.005, 0.046 +- 0.006
Faith. GMean (L1)= 	  =  0.350 +- 0.014, 0.265 +- 0.011, 0.163 +- 0.007, 0.153 +- 0.010
Faith. Aritm (KL)= 		  =  0.411 +- 0.016, 0.426 +- 0.008, 0.478 +- 0.003, 0.507 +- 0.001
Faith. Armon (KL)= 		  =  0.272 +- 0.008, 0.139 +- 0.011, 0.032 +- 0.004, 0.027 +- 0.003
Faith. GMean (KL)= 	  =  0.334 +- 0.010, 0.243 +- 0.010, 0.124 +- 0.007, 0.116 +- 0.007
Computed for split load_split = id



Completed in  0:08:39.093079  for LECIvGIN GOODSST2/length



DONE LECI GOODSST2/length anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:33:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:33:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9478
Train Loss: 0.0828
ID Validation ACCURACY: 0.8700
ID Validation Loss: 0.3477
ID Test ACCURACY: 0.8666
ID Test Loss: 0.3751
OOD Validation ACCURACY: 0.8543
OOD Validation Loss: 0.4835
OOD Test ACCURACY: 0.7968
OOD Test Loss: 0.9875

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9468
Train Loss: 0.0925
ID Validation ACCURACY: 0.8627
ID Validation Loss: 0.3335
ID Test ACCURACY: 0.8587
ID Test Loss: 0.3497
OOD Validation ACCURACY: 0.8643
OOD Validation Loss: 0.4259
OOD Test ACCURACY: 0.8173
OOD Test Loss: 0.8392

[0m[1;37mINFO[0m: [1mChartInfo 0.8666 0.7968 0.8587 0.8173 0.8627 0.8643[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:33:20 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.828
SUFF++ for r=0.6 class 0.0 = 0.779 +- 0.265 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 class 1.0 = 0.877 +- 0.265 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all KL = 0.773 +- 0.265 (in-sample avg dev_std = 0.405)
SUFF++ for r=0.6 all L1 = 0.836 +- 0.180 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.877
SUFF++ for r=0.9 class 0.0 = 0.896 +- 0.172 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.172 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all KL = 0.921 +- 0.172 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all L1 = 0.911 +- 0.156 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.754
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.744
SUFF++ for r=0.3 class 0.0 = 0.715 +- 0.216 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 1.0 = 0.873 +- 0.216 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all KL = 0.799 +- 0.216 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all L1 = 0.796 +- 0.197 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.784
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.781
SUFF++ for r=0.6 class 0.0 = 0.807 +- 0.198 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 class 1.0 = 0.911 +- 0.198 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all KL = 0.858 +- 0.198 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all L1 = 0.86 +- 0.177 (in-sample avg dev_std = 0.301)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.809
SUFF++ for r=0.9 class 0.0 = 0.893 +- 0.153 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 class 1.0 = 0.95 +- 0.153 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all KL = 0.926 +- 0.153 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.9 all L1 = 0.922 +- 0.144 (in-sample avg dev_std = 0.195)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.877
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.865
NEC for r=0.6 class 0.0 = 0.166 +- 0.206 (in-sample avg dev_std = 0.182)
NEC for r=0.6 class 1.0 = 0.084 +- 0.206 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all KL = 0.107 +- 0.206 (in-sample avg dev_std = 0.182)
NEC for r=0.6 all L1 = 0.118 +- 0.189 (in-sample avg dev_std = 0.182)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.884
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.881
NEC for r=0.9 class 0.0 = 0.084 +- 0.150 (in-sample avg dev_std = 0.156)
NEC for r=0.9 class 1.0 = 0.075 +- 0.150 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all KL = 0.062 +- 0.150 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all L1 = 0.078 +- 0.155 (in-sample avg dev_std = 0.156)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.884
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.881
NEC for r=1.0 class 0.0 = 0.084 +- 0.150 (in-sample avg dev_std = 0.156)
NEC for r=1.0 class 1.0 = 0.075 +- 0.150 (in-sample avg dev_std = 0.156)
NEC for r=1.0 all KL = 0.062 +- 0.150 (in-sample avg dev_std = 0.156)
NEC for r=1.0 all L1 = 0.078 +- 0.155 (in-sample avg dev_std = 0.156)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.754
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.763
NEC for r=0.3 class 0.0 = 0.29 +- 0.241 (in-sample avg dev_std = 0.253)
NEC for r=0.3 class 1.0 = 0.118 +- 0.241 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all KL = 0.169 +- 0.241 (in-sample avg dev_std = 0.253)
NEC for r=0.3 all L1 = 0.201 +- 0.234 (in-sample avg dev_std = 0.253)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.784
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.783
NEC for r=0.6 class 0.0 = 0.18 +- 0.189 (in-sample avg dev_std = 0.218)
NEC for r=0.6 class 1.0 = 0.081 +- 0.189 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all KL = 0.109 +- 0.189 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all L1 = 0.129 +- 0.188 (in-sample avg dev_std = 0.218)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.802
NEC for r=0.9 class 0.0 = 0.13 +- 0.165 (in-sample avg dev_std = 0.193)
NEC for r=0.9 class 1.0 = 0.059 +- 0.165 (in-sample avg dev_std = 0.193)
NEC for r=0.9 all KL = 0.082 +- 0.165 (in-sample avg dev_std = 0.193)
NEC for r=0.9 all L1 = 0.093 +- 0.165 (in-sample avg dev_std = 0.193)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.816
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.809
NEC for r=1.0 class 0.0 = 0.12 +- 0.140 (in-sample avg dev_std = 0.169)
NEC for r=1.0 class 1.0 = 0.05 +- 0.140 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all KL = 0.067 +- 0.140 (in-sample avg dev_std = 0.169)
NEC for r=1.0 all L1 = 0.084 +- 0.153 (in-sample avg dev_std = 0.169)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:35:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0767
ID Validation ACCURACY: 0.8721
ID Validation Loss: 0.4042
ID Test ACCURACY: 0.8681
ID Test Loss: 0.4102
OOD Validation ACCURACY: 0.8597
OOD Validation Loss: 0.5619
OOD Test ACCURACY: 0.8007
OOD Test Loss: 1.2330

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.9445
Train Loss: 0.0973
ID Validation ACCURACY: 0.8610
ID Validation Loss: 0.3537
ID Test ACCURACY: 0.8596
ID Test Loss: 0.3658
OOD Validation ACCURACY: 0.8627
OOD Validation Loss: 0.4058
OOD Test ACCURACY: 0.8250
OOD Test Loss: 0.6342

[0m[1;37mINFO[0m: [1mChartInfo 0.8681 0.8007 0.8596 0.8250 0.8610 0.8627[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:35:04 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.839
SUFF++ for r=0.6 class 0.0 = 0.777 +- 0.334 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 class 1.0 = 0.848 +- 0.334 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all KL = 0.691 +- 0.334 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.6 all L1 = 0.819 +- 0.200 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.939
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.884
SUFF++ for r=0.9 class 0.0 = 0.885 +- 0.157 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.9 class 1.0 = 0.928 +- 0.157 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.9 all KL = 0.926 +- 0.157 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.169 (in-sample avg dev_std = 0.170)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.739
SUFF++ for r=0.3 class 0.0 = 0.769 +- 0.274 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 1.0 = 0.864 +- 0.274 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all KL = 0.761 +- 0.274 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all L1 = 0.818 +- 0.201 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.789
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.774
SUFF++ for r=0.6 class 0.0 = 0.849 +- 0.235 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.6 class 1.0 = 0.915 +- 0.235 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.6 all KL = 0.86 +- 0.235 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.6 all L1 = 0.883 +- 0.181 (in-sample avg dev_std = 0.308)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.809
SUFF++ for r=0.9 class 0.0 = 0.929 +- 0.145 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 class 1.0 = 0.964 +- 0.145 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 all KL = 0.948 +- 0.145 (in-sample avg dev_std = 0.166)
SUFF++ for r=0.9 all L1 = 0.947 +- 0.124 (in-sample avg dev_std = 0.166)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.864
NEC for r=0.6 class 0.0 = 0.144 +- 0.209 (in-sample avg dev_std = 0.201)
NEC for r=0.6 class 1.0 = 0.076 +- 0.209 (in-sample avg dev_std = 0.201)
NEC for r=0.6 all KL = 0.103 +- 0.209 (in-sample avg dev_std = 0.201)
NEC for r=0.6 all L1 = 0.104 +- 0.189 (in-sample avg dev_std = 0.201)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.879
NEC for r=0.9 class 0.0 = 0.099 +- 0.159 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 1.0 = 0.07 +- 0.159 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all KL = 0.067 +- 0.159 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all L1 = 0.082 +- 0.170 (in-sample avg dev_std = 0.166)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.879
NEC for r=1.0 class 0.0 = 0.099 +- 0.159 (in-sample avg dev_std = 0.166)
NEC for r=1.0 class 1.0 = 0.07 +- 0.159 (in-sample avg dev_std = 0.166)
NEC for r=1.0 all KL = 0.067 +- 0.159 (in-sample avg dev_std = 0.166)
NEC for r=1.0 all L1 = 0.082 +- 0.170 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.759
NEC for r=0.3 class 0.0 = 0.206 +- 0.246 (in-sample avg dev_std = 0.267)
NEC for r=0.3 class 1.0 = 0.1 +- 0.246 (in-sample avg dev_std = 0.267)
NEC for r=0.3 all KL = 0.146 +- 0.246 (in-sample avg dev_std = 0.267)
NEC for r=0.3 all L1 = 0.151 +- 0.220 (in-sample avg dev_std = 0.267)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.789
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.787
NEC for r=0.6 class 0.0 = 0.147 +- 0.196 (in-sample avg dev_std = 0.234)
NEC for r=0.6 class 1.0 = 0.078 +- 0.196 (in-sample avg dev_std = 0.234)
NEC for r=0.6 all KL = 0.104 +- 0.196 (in-sample avg dev_std = 0.234)
NEC for r=0.6 all L1 = 0.111 +- 0.182 (in-sample avg dev_std = 0.234)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.811
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.81
NEC for r=0.9 class 0.0 = 0.113 +- 0.173 (in-sample avg dev_std = 0.208)
NEC for r=0.9 class 1.0 = 0.059 +- 0.173 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all KL = 0.08 +- 0.173 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all L1 = 0.085 +- 0.160 (in-sample avg dev_std = 0.208)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.821
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.814
NEC for r=1.0 class 0.0 = 0.104 +- 0.161 (in-sample avg dev_std = 0.194)
NEC for r=1.0 class 1.0 = 0.055 +- 0.161 (in-sample avg dev_std = 0.194)
NEC for r=1.0 all KL = 0.072 +- 0.161 (in-sample avg dev_std = 0.194)
NEC for r=1.0 all L1 = 0.079 +- 0.149 (in-sample avg dev_std = 0.194)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:36:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9422
Train Loss: 0.1008
ID Validation ACCURACY: 0.8666
ID Validation Loss: 0.3236
ID Test ACCURACY: 0.8630
ID Test Loss: 0.3560
OOD Validation ACCURACY: 0.8495
OOD Validation Loss: 0.4033
OOD Test ACCURACY: 0.7924
OOD Test Loss: 0.7094

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ACCURACY: 0.9424
Train Loss: 0.0983
ID Validation ACCURACY: 0.8564
ID Validation Loss: 0.3674
ID Test ACCURACY: 0.8564
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8621
OOD Validation Loss: 0.4289
OOD Test ACCURACY: 0.8120
OOD Test Loss: 0.7764

[0m[1;37mINFO[0m: [1mChartInfo 0.8630 0.7924 0.8564 0.8120 0.8564 0.8621[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:36:41 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.82
SUFF++ for r=0.6 class 0.0 = 0.755 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 class 1.0 = 0.82 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all KL = 0.751 +- 0.259 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all L1 = 0.793 +- 0.185 (in-sample avg dev_std = 0.411)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.867
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.852
SUFF++ for r=0.9 class 0.0 = 0.866 +- 0.149 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 1.0 = 0.901 +- 0.149 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all KL = 0.926 +- 0.149 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all L1 = 0.885 +- 0.159 (in-sample avg dev_std = 0.174)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.743
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.715
SUFF++ for r=0.3 class 0.0 = 0.737 +- 0.190 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 class 1.0 = 0.863 +- 0.190 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all KL = 0.83 +- 0.190 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all L1 = 0.802 +- 0.178 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.751
SUFF++ for r=0.6 class 0.0 = 0.796 +- 0.170 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.170 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all KL = 0.872 +- 0.170 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all L1 = 0.847 +- 0.169 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.791
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.786
SUFF++ for r=0.9 class 0.0 = 0.903 +- 0.104 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 class 1.0 = 0.936 +- 0.104 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all KL = 0.948 +- 0.104 (in-sample avg dev_std = 0.186)
SUFF++ for r=0.9 all L1 = 0.92 +- 0.127 (in-sample avg dev_std = 0.186)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.861
NEC for r=0.6 class 0.0 = 0.168 +- 0.186 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.11 +- 0.186 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.107 +- 0.186 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.135 +- 0.183 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
NEC for r=0.9 class 0.0 = 0.122 +- 0.143 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1.0 = 0.072 +- 0.143 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.063 +- 0.143 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.093 +- 0.148 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.874
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.871
NEC for r=1.0 class 0.0 = 0.122 +- 0.143 (in-sample avg dev_std = 0.140)
NEC for r=1.0 class 1.0 = 0.072 +- 0.143 (in-sample avg dev_std = 0.140)
NEC for r=1.0 all KL = 0.063 +- 0.143 (in-sample avg dev_std = 0.140)
NEC for r=1.0 all L1 = 0.093 +- 0.148 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.743
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.739
NEC for r=0.3 class 0.0 = 0.212 +- 0.167 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1.0 = 0.121 +- 0.167 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.108 +- 0.167 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.165 +- 0.185 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.769
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.766
NEC for r=0.6 class 0.0 = 0.166 +- 0.123 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 1.0 = 0.09 +- 0.123 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all KL = 0.076 +- 0.123 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all L1 = 0.127 +- 0.162 (in-sample avg dev_std = 0.175)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.791
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.795
NEC for r=0.9 class 0.0 = 0.135 +- 0.131 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 1.0 = 0.079 +- 0.131 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all KL = 0.066 +- 0.131 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all L1 = 0.106 +- 0.155 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.799
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.796
NEC for r=1.0 class 0.0 = 0.125 +- 0.131 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 1.0 = 0.079 +- 0.131 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all KL = 0.062 +- 0.131 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all L1 = 0.101 +- 0.157 (in-sample avg dev_std = 0.155)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:38:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0794
ID Validation ACCURACY: 0.8706
ID Validation Loss: 0.3827
ID Test ACCURACY: 0.8661
ID Test Loss: 0.3942
OOD Validation ACCURACY: 0.8532
OOD Validation Loss: 0.5503
OOD Test ACCURACY: 0.8099
OOD Test Loss: 0.9439

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9478
Train Loss: 0.0872
ID Validation ACCURACY: 0.8666
ID Validation Loss: 0.3396
ID Test ACCURACY: 0.8668
ID Test Loss: 0.3423
OOD Validation ACCURACY: 0.8664
OOD Validation Loss: 0.4373
OOD Test ACCURACY: 0.8217
OOD Test Loss: 0.8680

[0m[1;37mINFO[0m: [1mChartInfo 0.8661 0.8099 0.8668 0.8217 0.8666 0.8664[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:38:22 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.888
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.839
SUFF++ for r=0.6 class 0.0 = 0.856 +- 0.279 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 class 1.0 = 0.861 +- 0.279 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 all KL = 0.797 +- 0.279 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 all L1 = 0.859 +- 0.185 (in-sample avg dev_std = 0.403)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF++ for r=0.9 class 0.0 = 0.92 +- 0.146 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1.0 = 0.935 +- 0.146 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.945 +- 0.146 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.928 +- 0.151 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.764
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.748
SUFF++ for r=0.3 class 0.0 = 0.791 +- 0.265 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 class 1.0 = 0.767 +- 0.265 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all KL = 0.731 +- 0.265 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.3 all L1 = 0.779 +- 0.193 (in-sample avg dev_std = 0.419)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.786
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.779
SUFF++ for r=0.6 class 0.0 = 0.866 +- 0.220 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.6 class 1.0 = 0.833 +- 0.220 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.6 all KL = 0.824 +- 0.220 (in-sample avg dev_std = 0.330)
SUFF++ for r=0.6 all L1 = 0.849 +- 0.170 (in-sample avg dev_std = 0.330)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.794
SUFF++ for r=0.9 class 0.0 = 0.92 +- 0.151 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 class 1.0 = 0.913 +- 0.151 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all KL = 0.917 +- 0.151 (in-sample avg dev_std = 0.225)
SUFF++ for r=0.9 all L1 = 0.916 +- 0.139 (in-sample avg dev_std = 0.225)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.888
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.882
NEC for r=0.6 class 0.0 = 0.085 +- 0.168 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 1.0 = 0.079 +- 0.168 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all KL = 0.067 +- 0.168 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all L1 = 0.081 +- 0.168 (in-sample avg dev_std = 0.153)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.895
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.879
NEC for r=0.9 class 0.0 = 0.072 +- 0.126 (in-sample avg dev_std = 0.139)
NEC for r=0.9 class 1.0 = 0.055 +- 0.126 (in-sample avg dev_std = 0.139)
NEC for r=0.9 all KL = 0.044 +- 0.126 (in-sample avg dev_std = 0.139)
NEC for r=0.9 all L1 = 0.062 +- 0.139 (in-sample avg dev_std = 0.139)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.879
NEC for r=1.0 class 0.0 = 0.072 +- 0.126 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 1.0 = 0.055 +- 0.126 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all KL = 0.044 +- 0.126 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all L1 = 0.062 +- 0.139 (in-sample avg dev_std = 0.139)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.764
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.781
NEC for r=0.3 class 0.0 = 0.188 +- 0.239 (in-sample avg dev_std = 0.297)
NEC for r=0.3 class 1.0 = 0.184 +- 0.239 (in-sample avg dev_std = 0.297)
NEC for r=0.3 all KL = 0.176 +- 0.239 (in-sample avg dev_std = 0.297)
NEC for r=0.3 all L1 = 0.186 +- 0.213 (in-sample avg dev_std = 0.297)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.786
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.794
NEC for r=0.6 class 0.0 = 0.119 +- 0.185 (in-sample avg dev_std = 0.237)
NEC for r=0.6 class 1.0 = 0.141 +- 0.185 (in-sample avg dev_std = 0.237)
NEC for r=0.6 all KL = 0.11 +- 0.185 (in-sample avg dev_std = 0.237)
NEC for r=0.6 all L1 = 0.13 +- 0.184 (in-sample avg dev_std = 0.237)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.798
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.804
NEC for r=0.9 class 0.0 = 0.088 +- 0.137 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.103 +- 0.137 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.072 +- 0.137 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.096 +- 0.161 (in-sample avg dev_std = 0.194)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.806
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.81
NEC for r=1.0 class 0.0 = 0.088 +- 0.126 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 1.0 = 0.09 +- 0.126 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all KL = 0.064 +- 0.126 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all L1 = 0.089 +- 0.153 (in-sample avg dev_std = 0.183)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:40:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:40:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0762
ID Validation ACCURACY: 0.8698
ID Validation Loss: 0.4217
ID Test ACCURACY: 0.8638
ID Test Loss: 0.4697
OOD Validation ACCURACY: 0.8506
OOD Validation Loss: 0.5690
OOD Test ACCURACY: 0.8057
OOD Test Loss: 1.0706

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 0.9413
Train Loss: 0.1057
ID Validation ACCURACY: 0.8613
ID Validation Loss: 0.3217
ID Test ACCURACY: 0.8621
ID Test Loss: 0.3366
OOD Validation ACCURACY: 0.8657
OOD Validation Loss: 0.3797
OOD Test ACCURACY: 0.8224
OOD Test Loss: 0.6742

[0m[1;37mINFO[0m: [1mChartInfo 0.8638 0.8057 0.8621 0.8224 0.8613 0.8657[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:40:03 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.827
SUFF++ for r=0.6 class 0.0 = 0.769 +- 0.346 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 1.0 = 0.859 +- 0.346 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all KL = 0.657 +- 0.346 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all L1 = 0.821 +- 0.181 (in-sample avg dev_std = 0.507)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.9
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
SUFF++ for r=0.9 class 0.0 = 0.929 +- 0.197 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 1.0 = 0.923 +- 0.197 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all KL = 0.922 +- 0.197 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all L1 = 0.925 +- 0.167 (in-sample avg dev_std = 0.178)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.764
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.718
SUFF++ for r=0.3 class 0.0 = 0.677 +- 0.313 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 class 1.0 = 0.772 +- 0.313 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all KL = 0.598 +- 0.313 (in-sample avg dev_std = 0.544)
SUFF++ for r=0.3 all L1 = 0.726 +- 0.210 (in-sample avg dev_std = 0.544)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.796
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.769
SUFF++ for r=0.6 class 0.0 = 0.764 +- 0.307 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1.0 = 0.851 +- 0.307 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.725 +- 0.307 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.809 +- 0.215 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.804
SUFF++ for r=0.9 class 0.0 = 0.878 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1.0 = 0.935 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.89 +- 0.215 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.907 +- 0.166 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.895
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.876
NEC for r=0.6 class 0.0 = 0.097 +- 0.199 (in-sample avg dev_std = 0.180)
NEC for r=0.6 class 1.0 = 0.07 +- 0.199 (in-sample avg dev_std = 0.180)
NEC for r=0.6 all KL = 0.083 +- 0.199 (in-sample avg dev_std = 0.180)
NEC for r=0.6 all L1 = 0.081 +- 0.173 (in-sample avg dev_std = 0.180)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.877
NEC for r=0.9 class 0.0 = 0.064 +- 0.176 (in-sample avg dev_std = 0.152)
NEC for r=0.9 class 1.0 = 0.063 +- 0.176 (in-sample avg dev_std = 0.152)
NEC for r=0.9 all KL = 0.062 +- 0.176 (in-sample avg dev_std = 0.152)
NEC for r=0.9 all L1 = 0.063 +- 0.156 (in-sample avg dev_std = 0.152)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.902
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.877
NEC for r=1.0 class 0.0 = 0.064 +- 0.176 (in-sample avg dev_std = 0.152)
NEC for r=1.0 class 1.0 = 0.063 +- 0.176 (in-sample avg dev_std = 0.152)
NEC for r=1.0 all KL = 0.062 +- 0.176 (in-sample avg dev_std = 0.152)
NEC for r=1.0 all L1 = 0.063 +- 0.156 (in-sample avg dev_std = 0.152)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.764
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.769
NEC for r=0.3 class 0.0 = 0.254 +- 0.284 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1.0 = 0.127 +- 0.284 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.202 +- 0.284 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.189 +- 0.236 (in-sample avg dev_std = 0.320)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.796
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.796
NEC for r=0.6 class 0.0 = 0.18 +- 0.244 (in-sample avg dev_std = 0.287)
NEC for r=0.6 class 1.0 = 0.1 +- 0.244 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all KL = 0.148 +- 0.244 (in-sample avg dev_std = 0.287)
NEC for r=0.6 all L1 = 0.139 +- 0.207 (in-sample avg dev_std = 0.287)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.814
NEC for r=0.9 class 0.0 = 0.146 +- 0.220 (in-sample avg dev_std = 0.254)
NEC for r=0.9 class 1.0 = 0.077 +- 0.220 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all KL = 0.115 +- 0.220 (in-sample avg dev_std = 0.254)
NEC for r=0.9 all L1 = 0.11 +- 0.188 (in-sample avg dev_std = 0.254)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.817
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.812
NEC for r=1.0 class 0.0 = 0.138 +- 0.219 (in-sample avg dev_std = 0.247)
NEC for r=1.0 class 1.0 = 0.076 +- 0.219 (in-sample avg dev_std = 0.247)
NEC for r=1.0 all KL = 0.112 +- 0.219 (in-sample avg dev_std = 0.247)
NEC for r=1.0 all L1 = 0.106 +- 0.185 (in-sample avg dev_std = 0.247)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.773, 0.921, 1.0], 'all_L1': [0.836, 0.911, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.691, 0.926, 1.0], 'all_L1': [0.819, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.751, 0.926, 1.0], 'all_L1': [0.793, 0.885, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.797, 0.945, 1.0], 'all_L1': [0.859, 0.928, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.922, 1.0], 'all_L1': [0.821, 0.925, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.107, 0.062, 0.062], 'all_L1': [0.118, 0.078, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.103, 0.067, 0.067], 'all_L1': [0.104, 0.082, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.107, 0.063, 0.063], 'all_L1': [0.135, 0.093, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.044, 0.044], 'all_L1': [0.081, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.062, 0.062], 'all_L1': [0.081, 0.063, 0.063]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.799, 0.858, 0.926, 1.0], 'all_L1': [0.796, 0.86, 0.922, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.86, 0.948, 1.0], 'all_L1': [0.818, 0.883, 0.947, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.872, 0.948, 1.0], 'all_L1': [0.802, 0.847, 0.92, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.731, 0.824, 0.917, 1.0], 'all_L1': [0.779, 0.849, 0.916, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.598, 0.725, 0.89, 1.0], 'all_L1': [0.726, 0.809, 0.907, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.169, 0.109, 0.082, 0.067], 'all_L1': [0.201, 0.129, 0.093, 0.084]}), defaultdict(<class 'list'>, {'all_KL': [0.146, 0.104, 0.08, 0.072], 'all_L1': [0.151, 0.111, 0.085, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.076, 0.066, 0.062], 'all_L1': [0.165, 0.127, 0.106, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.176, 0.11, 0.072, 0.064], 'all_L1': [0.186, 0.13, 0.096, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.202, 0.148, 0.115, 0.112], 'all_L1': [0.189, 0.139, 0.11, 0.106]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.826 +- 0.022, 0.912 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.734 +- 0.052, 0.928 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.831 +- 0.007, 0.870 +- 0.011
nec class all_L1  =  0.104 +- 0.021, 0.076 +- 0.012, 0.076 +- 0.012
nec class all_KL  =  0.093 +- 0.016, 0.060 +- 0.008, 0.060 +- 0.008
nec_acc_int  =  0.870 +- 0.008, 0.878 +- 0.003, 0.878 +- 0.003

Eval split test
suff++ class all_L1  =  0.784 +- 0.032, 0.850 +- 0.024, 0.922 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.744 +- 0.080, 0.828 +- 0.054, 0.926 +- 0.022, 1.000 +- 0.000
suff++_acc_int  =  0.733 +- 0.014, 0.771 +- 0.011, 0.800 +- 0.009
nec class all_L1  =  0.178 +- 0.018, 0.127 +- 0.009, 0.098 +- 0.009, 0.092 +- 0.010
nec class all_KL  =  0.160 +- 0.032, 0.109 +- 0.023, 0.083 +- 0.017, 0.075 +- 0.019
nec_acc_int  =  0.762 +- 0.014, 0.785 +- 0.011, 0.805 +- 0.007, 0.808 +- 0.006


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.465 +- 0.009, 0.494 +- 0.002, 0.538 +- 0.006
Faith. Armon (L1)= 		  =  0.184 +- 0.033, 0.139 +- 0.020, 0.140 +- 0.020
Faith. GMean (L1)= 	  =  0.291 +- 0.027, 0.262 +- 0.018, 0.274 +- 0.021
Faith. Aritm (KL)= 		  =  0.414 +- 0.026, 0.494 +- 0.002, 0.530 +- 0.004
Faith. Armon (KL)= 		  =  0.165 +- 0.026, 0.112 +- 0.014, 0.112 +- 0.014
Faith. GMean (KL)= 	  =  0.260 +- 0.024, 0.235 +- 0.016, 0.244 +- 0.017

Eval split test
Faith. Aritm (L1)= 		  =  0.481 +- 0.013, 0.488 +- 0.008, 0.510 +- 0.004, 0.546 +- 0.005
Faith. Armon (L1)= 		  =  0.290 +- 0.023, 0.221 +- 0.013, 0.177 +- 0.015, 0.168 +- 0.017
Faith. GMean (L1)= 	  =  0.373 +- 0.016, 0.328 +- 0.008, 0.300 +- 0.012, 0.303 +- 0.017
Faith. Aritm (KL)= 		  =  0.452 +- 0.028, 0.469 +- 0.017, 0.504 +- 0.006, 0.538 +- 0.009
Faith. Armon (KL)= 		  =  0.260 +- 0.039, 0.192 +- 0.034, 0.152 +- 0.028, 0.140 +- 0.031
Faith. GMean (KL)= 	  =  0.341 +- 0.024, 0.298 +- 0.023, 0.276 +- 0.024, 0.273 +- 0.032
Computed for split load_split = id



Completed in  0:08:27.269165  for LECIvGIN GOODSST2/length



DONE LECI GOODSST2/length Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:42:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:42:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8770
ID Validation Loss: 0.4529
ID Test ACCURACY: 0.8757
ID Test Loss: 0.5041
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.6510
OOD Test ACCURACY: 0.8292
OOD Test Loss: 1.6667

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0763
ID Validation ACCURACY: 0.8704
ID Validation Loss: 0.4097
ID Test ACCURACY: 0.8702
ID Test Loss: 0.4348
OOD Validation ACCURACY: 0.8825
OOD Validation Loss: 0.5719
OOD Test ACCURACY: 0.8286
OOD Test Loss: 1.4316

[0m[1;37mINFO[0m: [1mChartInfo 0.8757 0.8292 0.8702 0.8286 0.8704 0.8825[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:42:04 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.825
SUFF++ for r=0.6 class 0.0 = 0.79 +- 0.321 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1.0 = 0.889 +- 0.321 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.717 +- 0.321 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.848 +- 0.185 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.86
SUFF++ for r=0.9 class 0.0 = 0.901 +- 0.192 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 class 1.0 = 0.948 +- 0.192 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all KL = 0.929 +- 0.192 (in-sample avg dev_std = 0.158)
SUFF++ for r=0.9 all L1 = 0.927 +- 0.177 (in-sample avg dev_std = 0.158)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.75
SUFF++ for r=0.3 class 0.0 = 0.831 +- 0.250 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 class 1.0 = 0.902 +- 0.250 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 all KL = 0.825 +- 0.250 (in-sample avg dev_std = 0.352)
SUFF++ for r=0.3 all L1 = 0.868 +- 0.182 (in-sample avg dev_std = 0.352)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.81
SUFF++ for r=0.6 class 0.0 = 0.888 +- 0.210 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 class 1.0 = 0.922 +- 0.210 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 all KL = 0.89 +- 0.210 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.6 all L1 = 0.906 +- 0.167 (in-sample avg dev_std = 0.270)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.844
SUFF++ for r=0.9 class 0.0 = 0.965 +- 0.103 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 class 1.0 = 0.972 +- 0.103 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 all KL = 0.972 +- 0.103 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 all L1 = 0.969 +- 0.096 (in-sample avg dev_std = 0.138)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.849
NEC for r=0.6 class 0.0 = 0.134 +- 0.227 (in-sample avg dev_std = 0.203)
NEC for r=0.6 class 1.0 = 0.056 +- 0.227 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all KL = 0.097 +- 0.227 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all L1 = 0.088 +- 0.190 (in-sample avg dev_std = 0.203)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.891
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.868
NEC for r=0.9 class 0.0 = 0.069 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=0.9 class 1.0 = 0.041 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=0.9 all KL = 0.052 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=0.9 all L1 = 0.053 +- 0.156 (in-sample avg dev_std = 0.133)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.891
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.868
NEC for r=1.0 class 0.0 = 0.069 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=1.0 class 1.0 = 0.041 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=1.0 all KL = 0.052 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=1.0 all L1 = 0.053 +- 0.156 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.786
NEC for r=0.3 class 0.0 = 0.134 +- 0.196 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 1.0 = 0.072 +- 0.196 (in-sample avg dev_std = 0.190)
NEC for r=0.3 all KL = 0.09 +- 0.196 (in-sample avg dev_std = 0.190)
NEC for r=0.3 all L1 = 0.102 +- 0.186 (in-sample avg dev_std = 0.190)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.813
NEC for r=0.6 class 0.0 = 0.09 +- 0.175 (in-sample avg dev_std = 0.181)
NEC for r=0.6 class 1.0 = 0.065 +- 0.175 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all KL = 0.069 +- 0.175 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all L1 = 0.077 +- 0.164 (in-sample avg dev_std = 0.181)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.85
NEC for r=0.9 class 0.0 = 0.057 +- 0.147 (in-sample avg dev_std = 0.158)
NEC for r=0.9 class 1.0 = 0.056 +- 0.147 (in-sample avg dev_std = 0.158)
NEC for r=0.9 all KL = 0.048 +- 0.147 (in-sample avg dev_std = 0.158)
NEC for r=0.9 all L1 = 0.057 +- 0.144 (in-sample avg dev_std = 0.158)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.854
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0.0 = 0.057 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=1.0 class 1.0 = 0.051 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=1.0 all KL = 0.044 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=1.0 all L1 = 0.054 +- 0.147 (in-sample avg dev_std = 0.157)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:43:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0761
ID Validation ACCURACY: 0.8785
ID Validation Loss: 0.4088
ID Test ACCURACY: 0.8751
ID Test Loss: 0.4603
OOD Validation ACCURACY: 0.8806
OOD Validation Loss: 0.5497
OOD Test ACCURACY: 0.8241
OOD Test Loss: 1.2824

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8759
ID Validation Loss: 0.4565
ID Test ACCURACY: 0.8734
ID Test Loss: 0.5042
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6320
OOD Test ACCURACY: 0.8264
OOD Test Loss: 1.3908

[0m[1;37mINFO[0m: [1mChartInfo 0.8751 0.8241 0.8734 0.8264 0.8759 0.8837[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:43:41 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.821
SUFF++ for r=0.6 class 0.0 = 0.788 +- 0.303 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1.0 = 0.866 +- 0.303 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.699 +- 0.303 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.833 +- 0.183 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.878
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0.0 = 0.932 +- 0.128 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 class 1.0 = 0.965 +- 0.128 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all KL = 0.963 +- 0.128 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.9 all L1 = 0.95 +- 0.129 (in-sample avg dev_std = 0.126)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.753
SUFF++ for r=0.3 class 0.0 = 0.866 +- 0.218 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 1.0 = 0.916 +- 0.218 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all KL = 0.863 +- 0.218 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all L1 = 0.891 +- 0.156 (in-sample avg dev_std = 0.294)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.811
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.801
SUFF++ for r=0.6 class 0.0 = 0.905 +- 0.147 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.6 class 1.0 = 0.945 +- 0.147 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.6 all KL = 0.927 +- 0.147 (in-sample avg dev_std = 0.205)
SUFF++ for r=0.6 all L1 = 0.926 +- 0.136 (in-sample avg dev_std = 0.205)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.827
SUFF++ for r=0.9 class 0.0 = 0.966 +- 0.075 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 class 1.0 = 0.978 +- 0.075 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 all KL = 0.981 +- 0.075 (in-sample avg dev_std = 0.107)
SUFF++ for r=0.9 all L1 = 0.972 +- 0.083 (in-sample avg dev_std = 0.107)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.855
NEC for r=0.6 class 0.0 = 0.11 +- 0.214 (in-sample avg dev_std = 0.148)
NEC for r=0.6 class 1.0 = 0.071 +- 0.214 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all KL = 0.09 +- 0.214 (in-sample avg dev_std = 0.148)
NEC for r=0.6 all L1 = 0.087 +- 0.185 (in-sample avg dev_std = 0.148)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.861
NEC for r=0.9 class 0.0 = 0.052 +- 0.115 (in-sample avg dev_std = 0.080)
NEC for r=0.9 class 1.0 = 0.028 +- 0.115 (in-sample avg dev_std = 0.080)
NEC for r=0.9 all KL = 0.029 +- 0.115 (in-sample avg dev_std = 0.080)
NEC for r=0.9 all L1 = 0.038 +- 0.114 (in-sample avg dev_std = 0.080)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.861
NEC for r=1.0 class 0.0 = 0.052 +- 0.115 (in-sample avg dev_std = 0.080)
NEC for r=1.0 class 1.0 = 0.028 +- 0.115 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all KL = 0.029 +- 0.115 (in-sample avg dev_std = 0.080)
NEC for r=1.0 all L1 = 0.038 +- 0.114 (in-sample avg dev_std = 0.080)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.772
NEC for r=0.3 class 0.0 = 0.105 +- 0.148 (in-sample avg dev_std = 0.152)
NEC for r=0.3 class 1.0 = 0.067 +- 0.148 (in-sample avg dev_std = 0.152)
NEC for r=0.3 all KL = 0.064 +- 0.148 (in-sample avg dev_std = 0.152)
NEC for r=0.3 all L1 = 0.085 +- 0.161 (in-sample avg dev_std = 0.152)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.811
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.802
NEC for r=0.6 class 0.0 = 0.085 +- 0.137 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 1.0 = 0.051 +- 0.137 (in-sample avg dev_std = 0.141)
NEC for r=0.6 all KL = 0.049 +- 0.137 (in-sample avg dev_std = 0.141)
NEC for r=0.6 all L1 = 0.068 +- 0.145 (in-sample avg dev_std = 0.141)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.817
NEC for r=0.9 class 0.0 = 0.063 +- 0.107 (in-sample avg dev_std = 0.134)
NEC for r=0.9 class 1.0 = 0.045 +- 0.107 (in-sample avg dev_std = 0.134)
NEC for r=0.9 all KL = 0.037 +- 0.107 (in-sample avg dev_std = 0.134)
NEC for r=0.9 all L1 = 0.054 +- 0.126 (in-sample avg dev_std = 0.134)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.836
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.831
NEC for r=1.0 class 0.0 = 0.058 +- 0.102 (in-sample avg dev_std = 0.121)
NEC for r=1.0 class 1.0 = 0.043 +- 0.102 (in-sample avg dev_std = 0.121)
NEC for r=1.0 all KL = 0.034 +- 0.102 (in-sample avg dev_std = 0.121)
NEC for r=1.0 all L1 = 0.05 +- 0.118 (in-sample avg dev_std = 0.121)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:45:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0766
ID Validation ACCURACY: 0.8778
ID Validation Loss: 0.3810
ID Test ACCURACY: 0.8723
ID Test Loss: 0.4331
OOD Validation ACCURACY: 0.8754
OOD Validation Loss: 0.5264
OOD Test ACCURACY: 0.8262
OOD Test Loss: 1.0977

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4819
ID Test ACCURACY: 0.8747
ID Test Loss: 0.5540
OOD Validation ACCURACY: 0.8826
OOD Validation Loss: 0.7049
OOD Test ACCURACY: 0.8361
OOD Test Loss: 1.6430

[0m[1;37mINFO[0m: [1mChartInfo 0.8723 0.8262 0.8747 0.8361 0.8762 0.8826[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:45:17 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.824
SUFF++ for r=0.6 class 0.0 = 0.803 +- 0.297 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.297 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.6 all KL = 0.699 +- 0.297 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.6 all L1 = 0.827 +- 0.180 (in-sample avg dev_std = 0.417)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.883
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.866
SUFF++ for r=0.9 class 0.0 = 0.938 +- 0.133 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 class 1.0 = 0.957 +- 0.133 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 all KL = 0.962 +- 0.133 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.9 all L1 = 0.949 +- 0.126 (in-sample avg dev_std = 0.130)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.78
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.72
SUFF++ for r=0.3 class 0.0 = 0.69 +- 0.308 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 1.0 = 0.739 +- 0.308 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all KL = 0.585 +- 0.308 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all L1 = 0.715 +- 0.198 (in-sample avg dev_std = 0.542)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.824
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.798
SUFF++ for r=0.6 class 0.0 = 0.797 +- 0.274 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 class 1.0 = 0.817 +- 0.274 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 all KL = 0.718 +- 0.274 (in-sample avg dev_std = 0.403)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.194 (in-sample avg dev_std = 0.403)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.839
SUFF++ for r=0.9 class 0.0 = 0.924 +- 0.141 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 class 1.0 = 0.916 +- 0.141 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 all KL = 0.93 +- 0.141 (in-sample avg dev_std = 0.190)
SUFF++ for r=0.9 all L1 = 0.92 +- 0.144 (in-sample avg dev_std = 0.190)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.863
NEC for r=0.6 class 0.0 = 0.112 +- 0.216 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1.0 = 0.072 +- 0.216 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.093 +- 0.216 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.088 +- 0.183 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.865
NEC for r=0.9 class 0.0 = 0.054 +- 0.105 (in-sample avg dev_std = 0.112)
NEC for r=0.9 class 1.0 = 0.037 +- 0.105 (in-sample avg dev_std = 0.112)
NEC for r=0.9 all KL = 0.032 +- 0.105 (in-sample avg dev_std = 0.112)
NEC for r=0.9 all L1 = 0.044 +- 0.111 (in-sample avg dev_std = 0.112)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.865
NEC for r=1.0 class 0.0 = 0.054 +- 0.105 (in-sample avg dev_std = 0.112)
NEC for r=1.0 class 1.0 = 0.037 +- 0.105 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all KL = 0.032 +- 0.105 (in-sample avg dev_std = 0.112)
NEC for r=1.0 all L1 = 0.044 +- 0.111 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.78
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.795
NEC for r=0.3 class 0.0 = 0.224 +- 0.307 (in-sample avg dev_std = 0.295)
NEC for r=0.3 class 1.0 = 0.215 +- 0.307 (in-sample avg dev_std = 0.295)
NEC for r=0.3 all KL = 0.235 +- 0.307 (in-sample avg dev_std = 0.295)
NEC for r=0.3 all L1 = 0.219 +- 0.257 (in-sample avg dev_std = 0.295)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.824
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.832
NEC for r=0.6 class 0.0 = 0.125 +- 0.189 (in-sample avg dev_std = 0.223)
NEC for r=0.6 class 1.0 = 0.128 +- 0.189 (in-sample avg dev_std = 0.223)
NEC for r=0.6 all KL = 0.112 +- 0.189 (in-sample avg dev_std = 0.223)
NEC for r=0.6 all L1 = 0.127 +- 0.191 (in-sample avg dev_std = 0.223)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.842
NEC for r=0.9 class 0.0 = 0.068 +- 0.114 (in-sample avg dev_std = 0.151)
NEC for r=0.9 class 1.0 = 0.076 +- 0.114 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all KL = 0.049 +- 0.114 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all L1 = 0.072 +- 0.138 (in-sample avg dev_std = 0.151)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.848
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.847
NEC for r=1.0 class 0.0 = 0.055 +- 0.093 (in-sample avg dev_std = 0.123)
NEC for r=1.0 class 1.0 = 0.065 +- 0.093 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all KL = 0.036 +- 0.093 (in-sample avg dev_std = 0.123)
NEC for r=1.0 all L1 = 0.06 +- 0.125 (in-sample avg dev_std = 0.123)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:47:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0765
ID Validation ACCURACY: 0.8772
ID Validation Loss: 0.4004
ID Test ACCURACY: 0.8725
ID Test Loss: 0.4340
OOD Validation ACCURACY: 0.8702
OOD Validation Loss: 0.5362
OOD Test ACCURACY: 0.8052
OOD Test Loss: 1.2425

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0766
ID Validation ACCURACY: 0.8725
ID Validation Loss: 0.4026
ID Test ACCURACY: 0.8721
ID Test Loss: 0.4277
OOD Validation ACCURACY: 0.8810
OOD Validation Loss: 0.5027
OOD Test ACCURACY: 0.8273
OOD Test Loss: 0.9208

[0m[1;37mINFO[0m: [1mChartInfo 0.8725 0.8052 0.8721 0.8273 0.8725 0.8810[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:47:01 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.737 +- 0.309 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 1.0 = 0.858 +- 0.309 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all KL = 0.673 +- 0.309 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all L1 = 0.808 +- 0.195 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.875
SUFF++ for r=0.9 class 0.0 = 0.937 +- 0.163 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 class 1.0 = 0.945 +- 0.163 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 all KL = 0.949 +- 0.163 (in-sample avg dev_std = 0.142)
SUFF++ for r=0.9 all L1 = 0.942 +- 0.149 (in-sample avg dev_std = 0.142)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.739
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.714
SUFF++ for r=0.3 class 0.0 = 0.805 +- 0.242 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 class 1.0 = 0.919 +- 0.242 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all KL = 0.83 +- 0.242 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all L1 = 0.864 +- 0.178 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.777
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.764
SUFF++ for r=0.6 class 0.0 = 0.849 +- 0.196 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.6 class 1.0 = 0.94 +- 0.196 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.6 all KL = 0.89 +- 0.196 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.6 all L1 = 0.896 +- 0.166 (in-sample avg dev_std = 0.265)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.087 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 class 1.0 = 0.98 +- 0.087 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all KL = 0.972 +- 0.087 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all L1 = 0.962 +- 0.093 (in-sample avg dev_std = 0.136)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.863
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.857
NEC for r=0.6 class 0.0 = 0.106 +- 0.189 (in-sample avg dev_std = 0.189)
NEC for r=0.6 class 1.0 = 0.061 +- 0.189 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all KL = 0.075 +- 0.189 (in-sample avg dev_std = 0.189)
NEC for r=0.6 all L1 = 0.08 +- 0.168 (in-sample avg dev_std = 0.189)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
NEC for r=0.9 class 0.0 = 0.056 +- 0.148 (in-sample avg dev_std = 0.109)
NEC for r=0.9 class 1.0 = 0.043 +- 0.148 (in-sample avg dev_std = 0.109)
NEC for r=0.9 all KL = 0.044 +- 0.148 (in-sample avg dev_std = 0.109)
NEC for r=0.9 all L1 = 0.048 +- 0.141 (in-sample avg dev_std = 0.109)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.871
NEC for r=1.0 class 0.0 = 0.056 +- 0.148 (in-sample avg dev_std = 0.109)
NEC for r=1.0 class 1.0 = 0.043 +- 0.148 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all KL = 0.044 +- 0.148 (in-sample avg dev_std = 0.109)
NEC for r=1.0 all L1 = 0.048 +- 0.141 (in-sample avg dev_std = 0.109)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.739
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.728
NEC for r=0.3 class 0.0 = 0.165 +- 0.208 (in-sample avg dev_std = 0.201)
NEC for r=0.3 class 1.0 = 0.062 +- 0.208 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all KL = 0.098 +- 0.208 (in-sample avg dev_std = 0.201)
NEC for r=0.3 all L1 = 0.112 +- 0.191 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.777
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.771
NEC for r=0.6 class 0.0 = 0.126 +- 0.161 (in-sample avg dev_std = 0.165)
NEC for r=0.6 class 1.0 = 0.048 +- 0.161 (in-sample avg dev_std = 0.165)
NEC for r=0.6 all KL = 0.068 +- 0.161 (in-sample avg dev_std = 0.165)
NEC for r=0.6 all L1 = 0.086 +- 0.162 (in-sample avg dev_std = 0.165)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.803
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.801
NEC for r=0.9 class 0.0 = 0.085 +- 0.121 (in-sample avg dev_std = 0.128)
NEC for r=0.9 class 1.0 = 0.039 +- 0.121 (in-sample avg dev_std = 0.128)
NEC for r=0.9 all KL = 0.045 +- 0.121 (in-sample avg dev_std = 0.128)
NEC for r=0.9 all L1 = 0.061 +- 0.131 (in-sample avg dev_std = 0.128)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.817
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.813
NEC for r=1.0 class 0.0 = 0.071 +- 0.105 (in-sample avg dev_std = 0.125)
NEC for r=1.0 class 1.0 = 0.032 +- 0.105 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all KL = 0.035 +- 0.105 (in-sample avg dev_std = 0.125)
NEC for r=1.0 all L1 = 0.051 +- 0.114 (in-sample avg dev_std = 0.125)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:48:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8774
ID Validation Loss: 0.4700
ID Test ACCURACY: 0.8732
ID Test Loss: 0.5072
OOD Validation ACCURACY: 0.8768
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.4641

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 0.9476
Train Loss: 0.0871
ID Validation ACCURACY: 0.8687
ID Validation Loss: 0.3256
ID Test ACCURACY: 0.8691
ID Test Loss: 0.3555
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.3854
OOD Test ACCURACY: 0.8311
OOD Test Loss: 0.8205

[0m[1;37mINFO[0m: [1mChartInfo 0.8732 0.8226 0.8691 0.8311 0.8687 0.8787[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:48:41 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.823
SUFF++ for r=0.6 class 0.0 = 0.802 +- 0.330 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 1.0 = 0.847 +- 0.330 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all KL = 0.691 +- 0.330 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all L1 = 0.829 +- 0.207 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.894
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0.0 = 0.946 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 class 1.0 = 0.963 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all KL = 0.962 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all L1 = 0.955 +- 0.135 (in-sample avg dev_std = 0.129)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.751
SUFF++ for r=0.3 class 0.0 = 0.854 +- 0.248 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 class 1.0 = 0.923 +- 0.248 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all KL = 0.84 +- 0.248 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all L1 = 0.89 +- 0.164 (in-sample avg dev_std = 0.333)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.805
SUFF++ for r=0.6 class 0.0 = 0.896 +- 0.189 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.6 class 1.0 = 0.949 +- 0.189 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.6 all KL = 0.911 +- 0.189 (in-sample avg dev_std = 0.239)
SUFF++ for r=0.6 all L1 = 0.923 +- 0.153 (in-sample avg dev_std = 0.239)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.84
SUFF++ for r=0.9 class 0.0 = 0.969 +- 0.085 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 1.0 = 0.98 +- 0.085 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all KL = 0.98 +- 0.085 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all L1 = 0.974 +- 0.088 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.863
NEC for r=0.6 class 0.0 = 0.112 +- 0.244 (in-sample avg dev_std = 0.229)
NEC for r=0.6 class 1.0 = 0.08 +- 0.244 (in-sample avg dev_std = 0.229)
NEC for r=0.6 all KL = 0.109 +- 0.244 (in-sample avg dev_std = 0.229)
NEC for r=0.6 all L1 = 0.093 +- 0.199 (in-sample avg dev_std = 0.229)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.868
NEC for r=0.9 class 0.0 = 0.047 +- 0.140 (in-sample avg dev_std = 0.108)
NEC for r=0.9 class 1.0 = 0.036 +- 0.140 (in-sample avg dev_std = 0.108)
NEC for r=0.9 all KL = 0.034 +- 0.140 (in-sample avg dev_std = 0.108)
NEC for r=0.9 all L1 = 0.041 +- 0.128 (in-sample avg dev_std = 0.108)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.888
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.868
NEC for r=1.0 class 0.0 = 0.047 +- 0.140 (in-sample avg dev_std = 0.108)
NEC for r=1.0 class 1.0 = 0.036 +- 0.140 (in-sample avg dev_std = 0.108)
NEC for r=1.0 all KL = 0.034 +- 0.140 (in-sample avg dev_std = 0.108)
NEC for r=1.0 all L1 = 0.041 +- 0.128 (in-sample avg dev_std = 0.108)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.767
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.768
NEC for r=0.3 class 0.0 = 0.121 +- 0.180 (in-sample avg dev_std = 0.192)
NEC for r=0.3 class 1.0 = 0.047 +- 0.180 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all KL = 0.074 +- 0.180 (in-sample avg dev_std = 0.192)
NEC for r=0.3 all L1 = 0.083 +- 0.171 (in-sample avg dev_std = 0.192)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.816
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.804
NEC for r=0.6 class 0.0 = 0.081 +- 0.150 (in-sample avg dev_std = 0.160)
NEC for r=0.6 class 1.0 = 0.043 +- 0.150 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all KL = 0.053 +- 0.150 (in-sample avg dev_std = 0.160)
NEC for r=0.6 all L1 = 0.061 +- 0.145 (in-sample avg dev_std = 0.160)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.834
NEC for r=0.9 class 0.0 = 0.071 +- 0.141 (in-sample avg dev_std = 0.155)
NEC for r=0.9 class 1.0 = 0.038 +- 0.141 (in-sample avg dev_std = 0.155)
NEC for r=0.9 all KL = 0.047 +- 0.141 (in-sample avg dev_std = 0.155)
NEC for r=0.9 all L1 = 0.054 +- 0.137 (in-sample avg dev_std = 0.155)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.849
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.843
NEC for r=1.0 class 0.0 = 0.061 +- 0.126 (in-sample avg dev_std = 0.127)
NEC for r=1.0 class 1.0 = 0.035 +- 0.126 (in-sample avg dev_std = 0.127)
NEC for r=1.0 all KL = 0.039 +- 0.126 (in-sample avg dev_std = 0.127)
NEC for r=1.0 all L1 = 0.048 +- 0.132 (in-sample avg dev_std = 0.127)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.717, 0.929, 1.0], 'all_L1': [0.848, 0.927, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.699, 0.963, 1.0], 'all_L1': [0.833, 0.95, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.699, 0.962, 1.0], 'all_L1': [0.827, 0.949, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.949, 1.0], 'all_L1': [0.808, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.691, 0.962, 1.0], 'all_L1': [0.829, 0.955, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.097, 0.052, 0.052], 'all_L1': [0.088, 0.053, 0.053]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.029, 0.029], 'all_L1': [0.087, 0.038, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.032, 0.032], 'all_L1': [0.088, 0.044, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.075, 0.044, 0.044], 'all_L1': [0.08, 0.048, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.109, 0.034, 0.034], 'all_L1': [0.093, 0.041, 0.041]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.825, 0.89, 0.972, 1.0], 'all_L1': [0.868, 0.906, 0.969, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.863, 0.927, 0.981, 1.0], 'all_L1': [0.891, 0.926, 0.972, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.585, 0.718, 0.93, 1.0], 'all_L1': [0.715, 0.807, 0.92, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.83, 0.89, 0.972, 1.0], 'all_L1': [0.864, 0.896, 0.962, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.84, 0.911, 0.98, 1.0], 'all_L1': [0.89, 0.923, 0.974, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.09, 0.069, 0.048, 0.044], 'all_L1': [0.102, 0.077, 0.057, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.064, 0.049, 0.037, 0.034], 'all_L1': [0.085, 0.068, 0.054, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.112, 0.049, 0.036], 'all_L1': [0.219, 0.127, 0.072, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.098, 0.068, 0.045, 0.035], 'all_L1': [0.112, 0.086, 0.061, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.053, 0.047, 0.039], 'all_L1': [0.083, 0.061, 0.054, 0.048]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.829 +- 0.013, 0.945 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.696 +- 0.014, 0.953 +- 0.013, 1.000 +- 0.000
suff++_acc_int  =  0.821 +- 0.004, 0.866 +- 0.008
nec class all_L1  =  0.087 +- 0.004, 0.045 +- 0.005, 0.045 +- 0.005
nec class all_KL  =  0.093 +- 0.011, 0.038 +- 0.009, 0.038 +- 0.009
nec_acc_int  =  0.857 +- 0.005, 0.867 +- 0.004, 0.867 +- 0.004

Eval split test
suff++ class all_L1  =  0.846 +- 0.066, 0.892 +- 0.044, 0.959 +- 0.020, 1.000 +- 0.000
suff++ class all_KL  =  0.789 +- 0.103, 0.867 +- 0.076, 0.967 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.737 +- 0.017, 0.795 +- 0.016, 0.830 +- 0.016
nec class all_L1  =  0.120 +- 0.051, 0.084 +- 0.023, 0.060 +- 0.007, 0.053 +- 0.004
nec class all_KL  =  0.112 +- 0.063, 0.070 +- 0.022, 0.045 +- 0.004, 0.038 +- 0.004
nec_acc_int  =  0.770 +- 0.023, 0.804 +- 0.020, 0.829 +- 0.017, 0.837 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.458 +- 0.008, 0.495 +- 0.003, 0.522 +- 0.003
Faith. Armon (L1)= 		  =  0.158 +- 0.007, 0.085 +- 0.010, 0.086 +- 0.010
Faith. GMean (L1)= 	  =  0.269 +- 0.008, 0.205 +- 0.011, 0.211 +- 0.012
Faith. Aritm (KL)= 		  =  0.394 +- 0.011, 0.496 +- 0.003, 0.519 +- 0.004
Faith. Armon (KL)= 		  =  0.164 +- 0.017, 0.073 +- 0.016, 0.073 +- 0.016
Faith. GMean (KL)= 	  =  0.254 +- 0.017, 0.190 +- 0.020, 0.194 +- 0.021

Eval split test
Faith. Aritm (L1)= 		  =  0.483 +- 0.008, 0.488 +- 0.011, 0.510 +- 0.007, 0.526 +- 0.002
Faith. Armon (L1)= 		  =  0.205 +- 0.068, 0.152 +- 0.037, 0.112 +- 0.012, 0.100 +- 0.008
Faith. GMean (L1)= 	  =  0.310 +- 0.045, 0.270 +- 0.028, 0.239 +- 0.011, 0.229 +- 0.009
Faith. Aritm (KL)= 		  =  0.450 +- 0.020, 0.469 +- 0.027, 0.506 +- 0.008, 0.519 +- 0.002
Faith. Armon (KL)= 		  =  0.186 +- 0.077, 0.128 +- 0.036, 0.086 +- 0.008, 0.072 +- 0.007
Faith. GMean (KL)= 	  =  0.283 +- 0.047, 0.242 +- 0.025, 0.209 +- 0.009, 0.194 +- 0.009
Computed for split load_split = id



Completed in  0:08:16.575287  for LECIvGIN GOODSST2/length



DONE LECI GOODSST2/length Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:50:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:50:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9098
ID Validation Loss: 0.5994
ID Test ACCURACY: 0.9096
ID Test Loss: 0.6930
OOD Validation ACCURACY: 0.8675
OOD Validation Loss: 1.1293
OOD Test ACCURACY: 0.8129
OOD Test Loss: 2.2198

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9079
ID Validation Loss: 0.6101
ID Test ACCURACY: 0.9115
ID Test Loss: 0.6973
OOD Validation ACCURACY: 0.8696
OOD Validation Loss: 1.1780
OOD Test ACCURACY: 0.8069
OOD Test Loss: 2.5255

[0m[1;37mINFO[0m: [1mChartInfo 0.9096 0.8129 0.9115 0.8069 0.9079 0.8696[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:50:36 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.829
SUFF++ for r=0.6 class 0.0 = 0.816 +- 0.358 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 class 1.0 = 0.852 +- 0.358 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 all KL = 0.678 +- 0.358 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.6 all L1 = 0.837 +- 0.211 (in-sample avg dev_std = 0.457)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.878
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.871
SUFF++ for r=0.9 class 0.0 = 0.925 +- 0.190 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 class 1.0 = 0.954 +- 0.190 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all KL = 0.938 +- 0.190 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all L1 = 0.941 +- 0.164 (in-sample avg dev_std = 0.180)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.688
SUFF++ for r=0.3 class 0.0 = 0.649 +- 0.302 (in-sample avg dev_std = 0.687)
SUFF++ for r=0.3 class 1.0 = 0.659 +- 0.302 (in-sample avg dev_std = 0.687)
SUFF++ for r=0.3 all KL = 0.393 +- 0.302 (in-sample avg dev_std = 0.687)
SUFF++ for r=0.3 all L1 = 0.654 +- 0.194 (in-sample avg dev_std = 0.687)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.763
SUFF++ for r=0.6 class 0.0 = 0.728 +- 0.375 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.375 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 all KL = 0.569 +- 0.375 (in-sample avg dev_std = 0.543)
SUFF++ for r=0.6 all L1 = 0.788 +- 0.203 (in-sample avg dev_std = 0.543)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.815
SUFF++ for r=0.9 class 0.0 = 0.901 +- 0.230 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 class 1.0 = 0.945 +- 0.230 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all KL = 0.891 +- 0.230 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all L1 = 0.924 +- 0.155 (in-sample avg dev_std = 0.253)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.871
NEC for r=0.6 class 0.0 = 0.117 +- 0.279 (in-sample avg dev_std = 0.229)
NEC for r=0.6 class 1.0 = 0.08 +- 0.279 (in-sample avg dev_std = 0.229)
NEC for r=0.6 all KL = 0.121 +- 0.279 (in-sample avg dev_std = 0.229)
NEC for r=0.6 all L1 = 0.095 +- 0.218 (in-sample avg dev_std = 0.229)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.881
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.875
NEC for r=0.9 class 0.0 = 0.069 +- 0.157 (in-sample avg dev_std = 0.162)
NEC for r=0.9 class 1.0 = 0.033 +- 0.157 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all KL = 0.05 +- 0.157 (in-sample avg dev_std = 0.162)
NEC for r=0.9 all L1 = 0.048 +- 0.134 (in-sample avg dev_std = 0.162)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.881
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.874
NEC for r=1.0 class 0.0 = 0.065 +- 0.137 (in-sample avg dev_std = 0.133)
NEC for r=1.0 class 1.0 = 0.032 +- 0.137 (in-sample avg dev_std = 0.133)
NEC for r=1.0 all KL = 0.041 +- 0.137 (in-sample avg dev_std = 0.133)
NEC for r=1.0 all L1 = 0.046 +- 0.127 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.793
NEC for r=0.3 class 0.0 = 0.181 +- 0.315 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1.0 = 0.186 +- 0.315 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.223 +- 0.315 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.184 +- 0.253 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.825
NEC for r=0.6 class 0.0 = 0.113 +- 0.243 (in-sample avg dev_std = 0.245)
NEC for r=0.6 class 1.0 = 0.08 +- 0.243 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all KL = 0.119 +- 0.243 (in-sample avg dev_std = 0.245)
NEC for r=0.6 all L1 = 0.096 +- 0.189 (in-sample avg dev_std = 0.245)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.825
NEC for r=0.9 class 0.0 = 0.075 +- 0.162 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 1.0 = 0.039 +- 0.162 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all KL = 0.059 +- 0.162 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all L1 = 0.056 +- 0.139 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.827
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.825
NEC for r=1.0 class 0.0 = 0.061 +- 0.139 (in-sample avg dev_std = 0.145)
NEC for r=1.0 class 1.0 = 0.037 +- 0.139 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all KL = 0.045 +- 0.139 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all L1 = 0.049 +- 0.130 (in-sample avg dev_std = 0.145)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:52:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9115
ID Validation Loss: 0.6738
ID Test ACCURACY: 0.9111
ID Test Loss: 0.7432
OOD Validation ACCURACY: 0.8660
OOD Validation Loss: 0.8649
OOD Test ACCURACY: 0.7935
OOD Test Loss: 1.2003

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9089
ID Validation Loss: 0.6142
ID Test ACCURACY: 0.9083
ID Test Loss: 0.6686
OOD Validation ACCURACY: 0.8733
OOD Validation Loss: 0.7668
OOD Test ACCURACY: 0.8158
OOD Test Loss: 0.9574

[0m[1;37mINFO[0m: [1mChartInfo 0.9111 0.7935 0.9083 0.8158 0.9089 0.8733[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:52:23 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.774 +- 0.359 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 class 1.0 = 0.935 +- 0.359 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all KL = 0.761 +- 0.359 (in-sample avg dev_std = 0.404)
SUFF++ for r=0.6 all L1 = 0.868 +- 0.225 (in-sample avg dev_std = 0.404)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.867
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.874
SUFF++ for r=0.9 class 0.0 = 0.959 +- 0.136 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 class 1.0 = 0.969 +- 0.136 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 all KL = 0.964 +- 0.136 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 all L1 = 0.965 +- 0.123 (in-sample avg dev_std = 0.122)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.627
SUFF++ for r=0.3 class 0.0 = 0.721 +- 0.358 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 class 1.0 = 0.978 +- 0.358 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all KL = 0.771 +- 0.358 (in-sample avg dev_std = 0.425)
SUFF++ for r=0.3 all L1 = 0.854 +- 0.239 (in-sample avg dev_std = 0.425)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.707
SUFF++ for r=0.6 class 0.0 = 0.771 +- 0.310 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 class 1.0 = 0.97 +- 0.310 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all KL = 0.796 +- 0.310 (in-sample avg dev_std = 0.366)
SUFF++ for r=0.6 all L1 = 0.874 +- 0.201 (in-sample avg dev_std = 0.366)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.793
SUFF++ for r=0.9 class 0.0 = 0.893 +- 0.141 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.141 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.939 +- 0.141 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.932 +- 0.147 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.849
NEC for r=0.6 class 0.0 = 0.126 +- 0.260 (in-sample avg dev_std = 0.209)
NEC for r=0.6 class 1.0 = 0.047 +- 0.260 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all KL = 0.098 +- 0.260 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all L1 = 0.08 +- 0.207 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.864
NEC for r=0.9 class 0.0 = 0.057 +- 0.171 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.04 +- 0.171 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.049 +- 0.171 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.047 +- 0.150 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.867
NEC for r=1.0 class 0.0 = 0.06 +- 0.175 (in-sample avg dev_std = 0.147)
NEC for r=1.0 class 1.0 = 0.036 +- 0.175 (in-sample avg dev_std = 0.147)
NEC for r=1.0 all KL = 0.049 +- 0.175 (in-sample avg dev_std = 0.147)
NEC for r=1.0 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.147)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.678
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.678
NEC for r=0.3 class 0.0 = 0.18 +- 0.270 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 1.0 = 0.016 +- 0.270 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all KL = 0.124 +- 0.270 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all L1 = 0.096 +- 0.208 (in-sample avg dev_std = 0.274)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.744
NEC for r=0.6 class 0.0 = 0.143 +- 0.208 (in-sample avg dev_std = 0.218)
NEC for r=0.6 class 1.0 = 0.022 +- 0.208 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all KL = 0.089 +- 0.208 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all L1 = 0.081 +- 0.178 (in-sample avg dev_std = 0.218)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.805
NEC for r=0.9 class 0.0 = 0.103 +- 0.152 (in-sample avg dev_std = 0.169)
NEC for r=0.9 class 1.0 = 0.034 +- 0.152 (in-sample avg dev_std = 0.169)
NEC for r=0.9 all KL = 0.058 +- 0.152 (in-sample avg dev_std = 0.169)
NEC for r=0.9 all L1 = 0.068 +- 0.154 (in-sample avg dev_std = 0.169)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.815
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.809
NEC for r=1.0 class 0.0 = 0.091 +- 0.131 (in-sample avg dev_std = 0.151)
NEC for r=1.0 class 1.0 = 0.028 +- 0.131 (in-sample avg dev_std = 0.151)
NEC for r=1.0 all KL = 0.046 +- 0.131 (in-sample avg dev_std = 0.151)
NEC for r=1.0 all L1 = 0.058 +- 0.139 (in-sample avg dev_std = 0.151)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:54:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9121
ID Validation Loss: 0.7349
ID Test ACCURACY: 0.9059
ID Test Loss: 0.8421
OOD Validation ACCURACY: 0.8625
OOD Validation Loss: 1.2946
OOD Test ACCURACY: 0.7649
OOD Test Loss: 3.9741

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9095
ID Validation Loss: 0.7942
ID Test ACCURACY: 0.9038
ID Test Loss: 0.9148
OOD Validation ACCURACY: 0.8708
OOD Validation Loss: 1.3357
OOD Test ACCURACY: 0.8070
OOD Test Loss: 2.7294

[0m[1;37mINFO[0m: [1mChartInfo 0.9059 0.7649 0.9038 0.8070 0.9095 0.8708[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:54:09 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF++ for r=0.6 class 0.0 = 0.842 +- 0.370 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 1.0 = 0.869 +- 0.370 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all KL = 0.691 +- 0.370 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all L1 = 0.858 +- 0.194 (in-sample avg dev_std = 0.438)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0.0 = 0.954 +- 0.139 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 class 1.0 = 0.965 +- 0.139 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all KL = 0.962 +- 0.139 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all L1 = 0.96 +- 0.129 (in-sample avg dev_std = 0.146)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.79
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.72
SUFF++ for r=0.3 class 0.0 = 0.668 +- 0.337 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 class 1.0 = 0.735 +- 0.337 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 all KL = 0.412 +- 0.337 (in-sample avg dev_std = 0.628)
SUFF++ for r=0.3 all L1 = 0.703 +- 0.213 (in-sample avg dev_std = 0.628)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.758
SUFF++ for r=0.6 class 0.0 = 0.7 +- 0.376 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 class 1.0 = 0.908 +- 0.376 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all KL = 0.629 +- 0.376 (in-sample avg dev_std = 0.503)
SUFF++ for r=0.6 all L1 = 0.807 +- 0.216 (in-sample avg dev_std = 0.503)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.786
SUFF++ for r=0.9 class 0.0 = 0.89 +- 0.186 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 class 1.0 = 0.98 +- 0.186 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all KL = 0.914 +- 0.186 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.9 all L1 = 0.936 +- 0.141 (in-sample avg dev_std = 0.241)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.86
NEC for r=0.6 class 0.0 = 0.094 +- 0.228 (in-sample avg dev_std = 0.195)
NEC for r=0.6 class 1.0 = 0.057 +- 0.228 (in-sample avg dev_std = 0.195)
NEC for r=0.6 all KL = 0.086 +- 0.228 (in-sample avg dev_std = 0.195)
NEC for r=0.6 all L1 = 0.073 +- 0.189 (in-sample avg dev_std = 0.195)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.86
NEC for r=0.9 class 0.0 = 0.062 +- 0.160 (in-sample avg dev_std = 0.156)
NEC for r=0.9 class 1.0 = 0.034 +- 0.160 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all KL = 0.047 +- 0.160 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all L1 = 0.046 +- 0.142 (in-sample avg dev_std = 0.156)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.874
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.861
NEC for r=1.0 class 0.0 = 0.064 +- 0.163 (in-sample avg dev_std = 0.149)
NEC for r=1.0 class 1.0 = 0.035 +- 0.163 (in-sample avg dev_std = 0.149)
NEC for r=1.0 all KL = 0.047 +- 0.163 (in-sample avg dev_std = 0.149)
NEC for r=1.0 all L1 = 0.047 +- 0.147 (in-sample avg dev_std = 0.149)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.79
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.777
NEC for r=0.3 class 0.0 = 0.23 +- 0.341 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 1.0 = 0.133 +- 0.341 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all KL = 0.242 +- 0.341 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all L1 = 0.18 +- 0.255 (in-sample avg dev_std = 0.365)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.809
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.799
NEC for r=0.6 class 0.0 = 0.154 +- 0.242 (in-sample avg dev_std = 0.259)
NEC for r=0.6 class 1.0 = 0.052 +- 0.242 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all KL = 0.12 +- 0.242 (in-sample avg dev_std = 0.259)
NEC for r=0.6 all L1 = 0.101 +- 0.198 (in-sample avg dev_std = 0.259)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.801
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.796
NEC for r=0.9 class 0.0 = 0.092 +- 0.160 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 1.0 = 0.021 +- 0.160 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all KL = 0.056 +- 0.160 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all L1 = 0.055 +- 0.147 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.794
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.792
NEC for r=1.0 class 0.0 = 0.083 +- 0.134 (in-sample avg dev_std = 0.149)
NEC for r=1.0 class 1.0 = 0.014 +- 0.134 (in-sample avg dev_std = 0.149)
NEC for r=1.0 all KL = 0.044 +- 0.134 (in-sample avg dev_std = 0.149)
NEC for r=1.0 all L1 = 0.048 +- 0.132 (in-sample avg dev_std = 0.149)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:55:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9108
ID Validation Loss: 0.7269
ID Test ACCURACY: 0.9055
ID Test Loss: 0.8660
OOD Validation ACCURACY: 0.8605
OOD Validation Loss: 1.1494
OOD Test ACCURACY: 0.7804
OOD Test Loss: 2.8232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0086
ID Validation ACCURACY: 0.9017
ID Validation Loss: 0.4666
ID Test ACCURACY: 0.9027
ID Test Loss: 0.5212
OOD Validation ACCURACY: 0.8661
OOD Validation Loss: 0.7265
OOD Test ACCURACY: 0.7994
OOD Test Loss: 2.2898

[0m[1;37mINFO[0m: [1mChartInfo 0.9055 0.7804 0.9027 0.7994 0.9017 0.8661[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:55:56 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF++ for r=0.6 class 0.0 = 0.782 +- 0.404 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 1.0 = 0.856 +- 0.404 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all KL = 0.615 +- 0.404 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all L1 = 0.825 +- 0.214 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.889
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.878
SUFF++ for r=0.9 class 0.0 = 0.951 +- 0.142 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 1.0 = 0.979 +- 0.142 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all KL = 0.964 +- 0.142 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all L1 = 0.967 +- 0.115 (in-sample avg dev_std = 0.125)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.734
SUFF++ for r=0.3 class 0.0 = 0.656 +- 0.378 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.3 class 1.0 = 0.789 +- 0.378 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.3 all KL = 0.407 +- 0.378 (in-sample avg dev_std = 0.648)
SUFF++ for r=0.3 all L1 = 0.725 +- 0.213 (in-sample avg dev_std = 0.648)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.806
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.772
SUFF++ for r=0.6 class 0.0 = 0.76 +- 0.368 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 1.0 = 0.889 +- 0.368 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all KL = 0.652 +- 0.368 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all L1 = 0.827 +- 0.212 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.799
SUFF++ for r=0.9 class 0.0 = 0.875 +- 0.237 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 class 1.0 = 0.962 +- 0.237 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all KL = 0.885 +- 0.237 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.9 all L1 = 0.92 +- 0.166 (in-sample avg dev_std = 0.260)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.87
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.862
NEC for r=0.6 class 0.0 = 0.147 +- 0.267 (in-sample avg dev_std = 0.227)
NEC for r=0.6 class 1.0 = 0.043 +- 0.267 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all KL = 0.117 +- 0.267 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all L1 = 0.087 +- 0.204 (in-sample avg dev_std = 0.227)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.888
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.875
NEC for r=0.9 class 0.0 = 0.049 +- 0.160 (in-sample avg dev_std = 0.134)
NEC for r=0.9 class 1.0 = 0.03 +- 0.160 (in-sample avg dev_std = 0.134)
NEC for r=0.9 all KL = 0.042 +- 0.160 (in-sample avg dev_std = 0.134)
NEC for r=0.9 all L1 = 0.038 +- 0.131 (in-sample avg dev_std = 0.134)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.895
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.876
NEC for r=1.0 class 0.0 = 0.058 +- 0.167 (in-sample avg dev_std = 0.132)
NEC for r=1.0 class 1.0 = 0.027 +- 0.167 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all KL = 0.043 +- 0.167 (in-sample avg dev_std = 0.132)
NEC for r=1.0 all L1 = 0.04 +- 0.142 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.802
NEC for r=0.3 class 0.0 = 0.162 +- 0.298 (in-sample avg dev_std = 0.311)
NEC for r=0.3 class 1.0 = 0.088 +- 0.298 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.173 +- 0.298 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.124 +- 0.221 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.806
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.798
NEC for r=0.6 class 0.0 = 0.16 +- 0.270 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 1.0 = 0.06 +- 0.270 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all KL = 0.143 +- 0.270 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all L1 = 0.108 +- 0.210 (in-sample avg dev_std = 0.283)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.793
NEC for r=0.9 class 0.0 = 0.108 +- 0.212 (in-sample avg dev_std = 0.222)
NEC for r=0.9 class 1.0 = 0.038 +- 0.212 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all KL = 0.088 +- 0.212 (in-sample avg dev_std = 0.222)
NEC for r=0.9 all L1 = 0.072 +- 0.168 (in-sample avg dev_std = 0.222)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.8
NEC for r=1.0 class 0.0 = 0.06 +- 0.138 (in-sample avg dev_std = 0.138)
NEC for r=1.0 class 1.0 = 0.03 +- 0.138 (in-sample avg dev_std = 0.138)
NEC for r=1.0 all KL = 0.041 +- 0.138 (in-sample avg dev_std = 0.138)
NEC for r=1.0 all L1 = 0.044 +- 0.130 (in-sample avg dev_std = 0.138)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:57:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0005
ID Validation ACCURACY: 0.9096
ID Validation Loss: 0.6435
ID Test ACCURACY: 0.9093
ID Test Loss: 0.7341
OOD Validation ACCURACY: 0.8668
OOD Validation Loss: 1.5301
OOD Test ACCURACY: 0.8228
OOD Test Loss: 5.7470

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0051
ID Validation ACCURACY: 0.9010
ID Validation Loss: 0.4985
ID Test ACCURACY: 0.8989
ID Test Loss: 0.5491
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 0.9197
OOD Test ACCURACY: 0.8206
OOD Test Loss: 2.0459

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.8228 0.8989 0.8206 0.9010 0.8689[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:57:36 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.813
SUFF++ for r=0.6 class 0.0 = 0.825 +- 0.348 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 class 1.0 = 0.874 +- 0.348 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all KL = 0.689 +- 0.348 (in-sample avg dev_std = 0.441)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.197 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.867
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.867
SUFF++ for r=0.9 class 0.0 = 0.933 +- 0.106 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.971 +- 0.106 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.969 +- 0.106 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.134 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.74
SUFF++ for r=0.3 class 0.0 = 0.684 +- 0.390 (in-sample avg dev_std = 0.606)
SUFF++ for r=0.3 class 1.0 = 0.817 +- 0.390 (in-sample avg dev_std = 0.606)
SUFF++ for r=0.3 all KL = 0.458 +- 0.390 (in-sample avg dev_std = 0.606)
SUFF++ for r=0.3 all L1 = 0.753 +- 0.224 (in-sample avg dev_std = 0.606)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.835
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.794
SUFF++ for r=0.6 class 0.0 = 0.809 +- 0.421 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 1.0 = 0.864 +- 0.421 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 all KL = 0.635 +- 0.421 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 all L1 = 0.837 +- 0.214 (in-sample avg dev_std = 0.492)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0.0 = 0.933 +- 0.245 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 1.0 = 0.942 +- 0.245 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all KL = 0.899 +- 0.245 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.161 (in-sample avg dev_std = 0.248)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.847
NEC for r=0.6 class 0.0 = 0.149 +- 0.282 (in-sample avg dev_std = 0.248)
NEC for r=0.6 class 1.0 = 0.058 +- 0.282 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all KL = 0.121 +- 0.282 (in-sample avg dev_std = 0.248)
NEC for r=0.6 all L1 = 0.096 +- 0.217 (in-sample avg dev_std = 0.248)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.867
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.869
NEC for r=0.9 class 0.0 = 0.068 +- 0.146 (in-sample avg dev_std = 0.146)
NEC for r=0.9 class 1.0 = 0.031 +- 0.146 (in-sample avg dev_std = 0.146)
NEC for r=0.9 all KL = 0.041 +- 0.146 (in-sample avg dev_std = 0.146)
NEC for r=0.9 all L1 = 0.046 +- 0.144 (in-sample avg dev_std = 0.146)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.869
NEC for r=1.0 class 0.0 = 0.068 +- 0.153 (in-sample avg dev_std = 0.148)
NEC for r=1.0 class 1.0 = 0.027 +- 0.153 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all KL = 0.04 +- 0.153 (in-sample avg dev_std = 0.148)
NEC for r=1.0 all L1 = 0.044 +- 0.141 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.808
NEC for r=0.3 class 0.0 = 0.176 +- 0.313 (in-sample avg dev_std = 0.329)
NEC for r=0.3 class 1.0 = 0.068 +- 0.313 (in-sample avg dev_std = 0.329)
NEC for r=0.3 all KL = 0.175 +- 0.313 (in-sample avg dev_std = 0.329)
NEC for r=0.3 all L1 = 0.12 +- 0.221 (in-sample avg dev_std = 0.329)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.835
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.828
NEC for r=0.6 class 0.0 = 0.124 +- 0.297 (in-sample avg dev_std = 0.297)
NEC for r=0.6 class 1.0 = 0.066 +- 0.297 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all KL = 0.146 +- 0.297 (in-sample avg dev_std = 0.297)
NEC for r=0.6 all L1 = 0.094 +- 0.202 (in-sample avg dev_std = 0.297)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.842
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.841
NEC for r=0.9 class 0.0 = 0.075 +- 0.235 (in-sample avg dev_std = 0.215)
NEC for r=0.9 class 1.0 = 0.048 +- 0.235 (in-sample avg dev_std = 0.215)
NEC for r=0.9 all KL = 0.092 +- 0.235 (in-sample avg dev_std = 0.215)
NEC for r=0.9 all L1 = 0.061 +- 0.163 (in-sample avg dev_std = 0.215)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.853
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.846
NEC for r=1.0 class 0.0 = 0.066 +- 0.206 (in-sample avg dev_std = 0.185)
NEC for r=1.0 class 1.0 = 0.043 +- 0.206 (in-sample avg dev_std = 0.185)
NEC for r=1.0 all KL = 0.072 +- 0.206 (in-sample avg dev_std = 0.185)
NEC for r=1.0 all L1 = 0.054 +- 0.155 (in-sample avg dev_std = 0.185)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.678, 0.938, 1.0], 'all_L1': [0.837, 0.941, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.964, 1.0], 'all_L1': [0.868, 0.965, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.691, 0.962, 1.0], 'all_L1': [0.858, 0.96, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.615, 0.964, 1.0], 'all_L1': [0.825, 0.967, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.689, 0.969, 1.0], 'all_L1': [0.853, 0.954, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.121, 0.05, 0.041], 'all_L1': [0.095, 0.048, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.098, 0.049, 0.049], 'all_L1': [0.08, 0.047, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.047, 0.047], 'all_L1': [0.073, 0.046, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.117, 0.042, 0.043], 'all_L1': [0.087, 0.038, 0.04]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.041, 0.04], 'all_L1': [0.096, 0.046, 0.044]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.393, 0.569, 0.891, 1.0], 'all_L1': [0.654, 0.788, 0.924, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.771, 0.796, 0.939, 1.0], 'all_L1': [0.854, 0.874, 0.932, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.412, 0.629, 0.914, 1.0], 'all_L1': [0.703, 0.807, 0.936, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.652, 0.885, 1.0], 'all_L1': [0.725, 0.827, 0.92, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.635, 0.899, 1.0], 'all_L1': [0.753, 0.837, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.223, 0.119, 0.059, 0.045], 'all_L1': [0.184, 0.096, 0.056, 0.049]}), defaultdict(<class 'list'>, {'all_KL': [0.124, 0.089, 0.058, 0.046], 'all_L1': [0.096, 0.081, 0.068, 0.058]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.12, 0.056, 0.044], 'all_L1': [0.18, 0.101, 0.055, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.173, 0.143, 0.088, 0.041], 'all_L1': [0.124, 0.108, 0.072, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.146, 0.092, 0.072], 'all_L1': [0.12, 0.094, 0.061, 0.054]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.848 +- 0.015, 0.957 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.687 +- 0.046, 0.959 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.817 +- 0.006, 0.870 +- 0.006
nec class all_L1  =  0.086 +- 0.009, 0.045 +- 0.004, 0.045 +- 0.002
nec class all_KL  =  0.109 +- 0.014, 0.046 +- 0.004, 0.044 +- 0.003
nec_acc_int  =  0.858 +- 0.009, 0.869 +- 0.006, 0.869 +- 0.005

Eval split test
suff++ class all_L1  =  0.738 +- 0.067, 0.827 +- 0.029, 0.930 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.488 +- 0.143, 0.656 +- 0.075, 0.906 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.702 +- 0.042, 0.759 +- 0.029, 0.806 +- 0.018
nec class all_L1  =  0.141 +- 0.035, 0.096 +- 0.009, 0.062 +- 0.007, 0.051 +- 0.005
nec class all_KL  =  0.187 +- 0.042, 0.123 +- 0.021, 0.071 +- 0.016, 0.050 +- 0.011
nec_acc_int  =  0.771 +- 0.048, 0.799 +- 0.030, 0.812 +- 0.018, 0.814 +- 0.019


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.467 +- 0.007, 0.501 +- 0.004, 0.522 +- 0.001
Faith. Armon (L1)= 		  =  0.156 +- 0.014, 0.086 +- 0.007, 0.085 +- 0.005
Faith. GMean (L1)= 	  =  0.270 +- 0.013, 0.207 +- 0.008, 0.211 +- 0.006
Faith. Aritm (KL)= 		  =  0.398 +- 0.021, 0.503 +- 0.004, 0.522 +- 0.002
Faith. Armon (KL)= 		  =  0.187 +- 0.021, 0.087 +- 0.007, 0.084 +- 0.006
Faith. GMean (KL)= 	  =  0.272 +- 0.016, 0.209 +- 0.008, 0.210 +- 0.008

Eval split test
Faith. Aritm (L1)= 		  =  0.439 +- 0.020, 0.461 +- 0.012, 0.496 +- 0.004, 0.525 +- 0.002
Faith. Armon (L1)= 		  =  0.233 +- 0.046, 0.172 +- 0.014, 0.117 +- 0.012, 0.096 +- 0.009
Faith. GMean (L1)= 	  =  0.318 +- 0.028, 0.281 +- 0.011, 0.241 +- 0.012, 0.225 +- 0.011
Faith. Aritm (KL)= 		  =  0.338 +- 0.056, 0.390 +- 0.032, 0.488 +- 0.008, 0.525 +- 0.006
Faith. Armon (KL)= 		  =  0.260 +- 0.032, 0.206 +- 0.028, 0.130 +- 0.027, 0.094 +- 0.020
Faith. GMean (KL)= 	  =  0.294 +- 0.018, 0.282 +- 0.019, 0.251 +- 0.027, 0.221 +- 0.024
Computed for split load_split = id



Completed in  0:08:44.178528  for GSATvGIN GOODSST2/length



DONE GSAT GOODSST2/length anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Jul 29 23:59:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/29/2024 11:59:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8668
ID Validation Loss: 0.6795
ID Test ACCURACY: 0.8585
ID Test Loss: 0.7626
OOD Validation ACCURACY: 0.8639
OOD Validation Loss: 1.2196
OOD Test ACCURACY: 0.8177
OOD Test Loss: 2.1393

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0753
ID Validation ACCURACY: 0.8617
ID Validation Loss: 0.5547
ID Test ACCURACY: 0.8610
ID Test Loss: 0.6206
OOD Validation ACCURACY: 0.8646
OOD Validation Loss: 0.8965
OOD Test ACCURACY: 0.8102
OOD Test Loss: 1.6225

[0m[1;37mINFO[0m: [1mChartInfo 0.8585 0.8177 0.8610 0.8102 0.8617 0.8646[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/29/2024 11:59:38 PM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.828
SUFF++ for r=0.6 class 0.0 = 0.836 +- 0.377 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 class 1.0 = 0.85 +- 0.377 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 all KL = 0.654 +- 0.377 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.6 all L1 = 0.844 +- 0.191 (in-sample avg dev_std = 0.492)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.849
SUFF++ for r=0.9 class 0.0 = 0.944 +- 0.205 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 class 1.0 = 0.945 +- 0.205 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all KL = 0.927 +- 0.205 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.149 (in-sample avg dev_std = 0.221)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.76
SUFF++ for r=0.3 class 0.0 = 0.765 +- 0.399 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 class 1.0 = 0.815 +- 0.399 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 all KL = 0.526 +- 0.399 (in-sample avg dev_std = 0.587)
SUFF++ for r=0.3 all L1 = 0.791 +- 0.210 (in-sample avg dev_std = 0.587)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF++ for r=0.6 class 0.0 = 0.865 +- 0.334 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 1.0 = 0.904 +- 0.334 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all KL = 0.772 +- 0.334 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all L1 = 0.885 +- 0.189 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.829
SUFF++ for r=0.9 class 0.0 = 0.918 +- 0.236 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 class 1.0 = 0.958 +- 0.236 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all KL = 0.897 +- 0.236 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.142 (in-sample avg dev_std = 0.247)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.856
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.856
NEC for r=0.6 class 0.0 = 0.081 +- 0.245 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 1.0 = 0.07 +- 0.245 (in-sample avg dev_std = 0.235)
NEC for r=0.6 all KL = 0.098 +- 0.245 (in-sample avg dev_std = 0.235)
NEC for r=0.6 all L1 = 0.075 +- 0.184 (in-sample avg dev_std = 0.235)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.867
NEC for r=0.9 class 0.0 = 0.059 +- 0.194 (in-sample avg dev_std = 0.188)
NEC for r=0.9 class 1.0 = 0.043 +- 0.194 (in-sample avg dev_std = 0.188)
NEC for r=0.9 all KL = 0.065 +- 0.194 (in-sample avg dev_std = 0.188)
NEC for r=0.9 all L1 = 0.05 +- 0.147 (in-sample avg dev_std = 0.188)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.863
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.867
NEC for r=1.0 class 0.0 = 0.059 +- 0.194 (in-sample avg dev_std = 0.188)
NEC for r=1.0 class 1.0 = 0.043 +- 0.194 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all KL = 0.065 +- 0.194 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all L1 = 0.05 +- 0.147 (in-sample avg dev_std = 0.188)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.826
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.825
NEC for r=0.3 class 0.0 = 0.14 +- 0.340 (in-sample avg dev_std = 0.323)
NEC for r=0.3 class 1.0 = 0.1 +- 0.340 (in-sample avg dev_std = 0.323)
NEC for r=0.3 all KL = 0.19 +- 0.340 (in-sample avg dev_std = 0.323)
NEC for r=0.3 all L1 = 0.119 +- 0.234 (in-sample avg dev_std = 0.323)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.83
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.83
NEC for r=0.6 class 0.0 = 0.097 +- 0.266 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1.0 = 0.072 +- 0.266 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.126 +- 0.266 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.084 +- 0.192 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.831
NEC for r=0.9 class 0.0 = 0.076 +- 0.236 (in-sample avg dev_std = 0.234)
NEC for r=0.9 class 1.0 = 0.057 +- 0.236 (in-sample avg dev_std = 0.234)
NEC for r=0.9 all KL = 0.098 +- 0.236 (in-sample avg dev_std = 0.234)
NEC for r=0.9 all L1 = 0.066 +- 0.166 (in-sample avg dev_std = 0.234)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.837
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.836
NEC for r=1.0 class 0.0 = 0.078 +- 0.223 (in-sample avg dev_std = 0.221)
NEC for r=1.0 class 1.0 = 0.05 +- 0.223 (in-sample avg dev_std = 0.221)
NEC for r=1.0 all KL = 0.09 +- 0.223 (in-sample avg dev_std = 0.221)
NEC for r=1.0 all L1 = 0.063 +- 0.162 (in-sample avg dev_std = 0.221)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:01:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8664
ID Validation Loss: 0.6872
ID Test ACCURACY: 0.8595
ID Test Loss: 0.6834
OOD Validation ACCURACY: 0.8625
OOD Validation Loss: 1.0882
OOD Test ACCURACY: 0.8130
OOD Test Loss: 2.2533

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0780
ID Validation ACCURACY: 0.8653
ID Validation Loss: 0.5490
ID Test ACCURACY: 0.8580
ID Test Loss: 0.5533
OOD Validation ACCURACY: 0.8664
OOD Validation Loss: 0.7991
OOD Test ACCURACY: 0.8176
OOD Test Loss: 1.4198

[0m[1;37mINFO[0m: [1mChartInfo 0.8595 0.8130 0.8580 0.8176 0.8653 0.8664[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:01:20 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.832
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.821
SUFF++ for r=0.6 class 0.0 = 0.79 +- 0.356 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 class 1.0 = 0.879 +- 0.356 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all KL = 0.69 +- 0.356 (in-sample avg dev_std = 0.452)
SUFF++ for r=0.6 all L1 = 0.842 +- 0.204 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.849
SUFF++ for r=0.9 class 0.0 = 0.907 +- 0.201 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 class 1.0 = 0.951 +- 0.201 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 all KL = 0.925 +- 0.201 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.174 (in-sample avg dev_std = 0.210)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.793
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.717
SUFF++ for r=0.3 class 0.0 = 0.633 +- 0.384 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 class 1.0 = 0.837 +- 0.384 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all KL = 0.505 +- 0.384 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.3 all L1 = 0.738 +- 0.231 (in-sample avg dev_std = 0.614)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.795
SUFF++ for r=0.6 class 0.0 = 0.796 +- 0.327 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1.0 = 0.924 +- 0.327 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.751 +- 0.327 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.862 +- 0.199 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.835
SUFF++ for r=0.9 class 0.0 = 0.906 +- 0.208 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 class 1.0 = 0.958 +- 0.208 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all KL = 0.91 +- 0.208 (in-sample avg dev_std = 0.223)
SUFF++ for r=0.9 all L1 = 0.933 +- 0.155 (in-sample avg dev_std = 0.223)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.832
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.846
NEC for r=0.6 class 0.0 = 0.131 +- 0.242 (in-sample avg dev_std = 0.213)
NEC for r=0.6 class 1.0 = 0.058 +- 0.242 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all KL = 0.104 +- 0.242 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all L1 = 0.088 +- 0.202 (in-sample avg dev_std = 0.213)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.852
NEC for r=0.9 class 0.0 = 0.083 +- 0.204 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 1.0 = 0.056 +- 0.204 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all KL = 0.076 +- 0.204 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all L1 = 0.067 +- 0.174 (in-sample avg dev_std = 0.197)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.849
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.852
NEC for r=1.0 class 0.0 = 0.083 +- 0.204 (in-sample avg dev_std = 0.197)
NEC for r=1.0 class 1.0 = 0.056 +- 0.204 (in-sample avg dev_std = 0.197)
NEC for r=1.0 all KL = 0.076 +- 0.204 (in-sample avg dev_std = 0.197)
NEC for r=1.0 all L1 = 0.067 +- 0.174 (in-sample avg dev_std = 0.197)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.793
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.781
NEC for r=0.3 class 0.0 = 0.24 +- 0.318 (in-sample avg dev_std = 0.351)
NEC for r=0.3 class 1.0 = 0.07 +- 0.318 (in-sample avg dev_std = 0.351)
NEC for r=0.3 all KL = 0.197 +- 0.318 (in-sample avg dev_std = 0.351)
NEC for r=0.3 all L1 = 0.152 +- 0.243 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.826
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.82
NEC for r=0.6 class 0.0 = 0.142 +- 0.260 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 1.0 = 0.058 +- 0.260 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all KL = 0.13 +- 0.260 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all L1 = 0.099 +- 0.196 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.833
NEC for r=0.9 class 0.0 = 0.102 +- 0.204 (in-sample avg dev_std = 0.216)
NEC for r=0.9 class 1.0 = 0.041 +- 0.204 (in-sample avg dev_std = 0.216)
NEC for r=0.9 all KL = 0.085 +- 0.204 (in-sample avg dev_std = 0.216)
NEC for r=0.9 all L1 = 0.071 +- 0.166 (in-sample avg dev_std = 0.216)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.841
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.834
NEC for r=1.0 class 0.0 = 0.103 +- 0.214 (in-sample avg dev_std = 0.224)
NEC for r=1.0 class 1.0 = 0.04 +- 0.214 (in-sample avg dev_std = 0.224)
NEC for r=1.0 all KL = 0.087 +- 0.214 (in-sample avg dev_std = 0.224)
NEC for r=1.0 all L1 = 0.071 +- 0.170 (in-sample avg dev_std = 0.224)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:03:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.9474
Train Loss: 0.0825
ID Validation ACCURACY: 0.8674
ID Validation Loss: 0.5079
ID Test ACCURACY: 0.8615
ID Test Loss: 0.5334
OOD Validation ACCURACY: 0.8593
OOD Validation Loss: 0.8360
OOD Test ACCURACY: 0.8109
OOD Test Loss: 1.6606

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 164...
[0m[1;37mINFO[0m: [1mCheckpoint 164: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0756
ID Validation ACCURACY: 0.8659
ID Validation Loss: 0.5915
ID Test ACCURACY: 0.8595
ID Test Loss: 0.6510
OOD Validation ACCURACY: 0.8656
OOD Validation Loss: 1.0792
OOD Test ACCURACY: 0.8119
OOD Test Loss: 3.0260

[0m[1;37mINFO[0m: [1mChartInfo 0.8615 0.8109 0.8595 0.8119 0.8659 0.8656[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:03:07 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.81
SUFF++ for r=0.6 class 0.0 = 0.818 +- 0.305 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 class 1.0 = 0.868 +- 0.305 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all KL = 0.708 +- 0.305 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.6 all L1 = 0.847 +- 0.179 (in-sample avg dev_std = 0.445)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.857
SUFF++ for r=0.9 class 0.0 = 0.941 +- 0.149 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1.0 = 0.951 +- 0.149 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.953 +- 0.149 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.155 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.75
SUFF++ for r=0.3 class 0.0 = 0.722 +- 0.349 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 class 1.0 = 0.793 +- 0.349 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 all KL = 0.55 +- 0.349 (in-sample avg dev_std = 0.591)
SUFF++ for r=0.3 all L1 = 0.759 +- 0.209 (in-sample avg dev_std = 0.591)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.798
SUFF++ for r=0.6 class 0.0 = 0.812 +- 0.326 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 class 1.0 = 0.89 +- 0.326 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all KL = 0.74 +- 0.326 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.6 all L1 = 0.852 +- 0.193 (in-sample avg dev_std = 0.421)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.827
SUFF++ for r=0.9 class 0.0 = 0.913 +- 0.189 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.189 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all KL = 0.917 +- 0.189 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all L1 = 0.933 +- 0.141 (in-sample avg dev_std = 0.203)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.839
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.86
NEC for r=0.6 class 0.0 = 0.09 +- 0.177 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 1.0 = 0.048 +- 0.177 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all KL = 0.06 +- 0.177 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all L1 = 0.066 +- 0.170 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.849
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.87
NEC for r=0.9 class 0.0 = 0.066 +- 0.138 (in-sample avg dev_std = 0.105)
NEC for r=0.9 class 1.0 = 0.035 +- 0.138 (in-sample avg dev_std = 0.105)
NEC for r=0.9 all KL = 0.041 +- 0.138 (in-sample avg dev_std = 0.105)
NEC for r=0.9 all L1 = 0.048 +- 0.145 (in-sample avg dev_std = 0.105)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.849
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.87
NEC for r=1.0 class 0.0 = 0.066 +- 0.138 (in-sample avg dev_std = 0.105)
NEC for r=1.0 class 1.0 = 0.035 +- 0.138 (in-sample avg dev_std = 0.105)
NEC for r=1.0 all KL = 0.041 +- 0.138 (in-sample avg dev_std = 0.105)
NEC for r=1.0 all L1 = 0.048 +- 0.145 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.817
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.811
NEC for r=0.3 class 0.0 = 0.154 +- 0.275 (in-sample avg dev_std = 0.284)
NEC for r=0.3 class 1.0 = 0.085 +- 0.275 (in-sample avg dev_std = 0.284)
NEC for r=0.3 all KL = 0.149 +- 0.275 (in-sample avg dev_std = 0.284)
NEC for r=0.3 all L1 = 0.118 +- 0.210 (in-sample avg dev_std = 0.284)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.822
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.821
NEC for r=0.6 class 0.0 = 0.105 +- 0.218 (in-sample avg dev_std = 0.233)
NEC for r=0.6 class 1.0 = 0.069 +- 0.218 (in-sample avg dev_std = 0.233)
NEC for r=0.6 all KL = 0.104 +- 0.218 (in-sample avg dev_std = 0.233)
NEC for r=0.6 all L1 = 0.086 +- 0.177 (in-sample avg dev_std = 0.233)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.826
NEC for r=0.9 class 0.0 = 0.091 +- 0.179 (in-sample avg dev_std = 0.188)
NEC for r=0.9 class 1.0 = 0.054 +- 0.179 (in-sample avg dev_std = 0.188)
NEC for r=0.9 all KL = 0.075 +- 0.179 (in-sample avg dev_std = 0.188)
NEC for r=0.9 all L1 = 0.072 +- 0.160 (in-sample avg dev_std = 0.188)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.835
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.825
NEC for r=1.0 class 0.0 = 0.088 +- 0.175 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 1.0 = 0.054 +- 0.175 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all KL = 0.071 +- 0.175 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all L1 = 0.071 +- 0.160 (in-sample avg dev_std = 0.183)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:04:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8661
ID Validation Loss: 0.6809
ID Test ACCURACY: 0.8640
ID Test Loss: 0.7290
OOD Validation ACCURACY: 0.8622
OOD Validation Loss: 1.2070
OOD Test ACCURACY: 0.7806
OOD Test Loss: 3.1882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0753
ID Validation ACCURACY: 0.8642
ID Validation Loss: 0.6710
ID Test ACCURACY: 0.8615
ID Test Loss: 0.7259
OOD Validation ACCURACY: 0.8643
OOD Validation Loss: 1.0045
OOD Test ACCURACY: 0.8009
OOD Test Loss: 2.1963

[0m[1;37mINFO[0m: [1mChartInfo 0.8640 0.7806 0.8615 0.8009 0.8642 0.8643[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:04:55 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.837
SUFF++ for r=0.6 class 0.0 = 0.829 +- 0.352 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 class 1.0 = 0.897 +- 0.352 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all KL = 0.751 +- 0.352 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.6 all L1 = 0.869 +- 0.216 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.85
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.859
SUFF++ for r=0.9 class 0.0 = 0.927 +- 0.187 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.187 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all KL = 0.931 +- 0.187 (in-sample avg dev_std = 0.172)
SUFF++ for r=0.9 all L1 = 0.933 +- 0.171 (in-sample avg dev_std = 0.172)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.764
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.702
SUFF++ for r=0.3 class 0.0 = 0.705 +- 0.415 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 class 1.0 = 0.955 +- 0.415 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 all KL = 0.678 +- 0.415 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.3 all L1 = 0.834 +- 0.232 (in-sample avg dev_std = 0.524)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.776
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.736
SUFF++ for r=0.6 class 0.0 = 0.785 +- 0.354 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1.0 = 0.965 +- 0.354 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.763 +- 0.354 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.878 +- 0.194 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.775
SUFF++ for r=0.9 class 0.0 = 0.902 +- 0.194 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 1.0 = 0.98 +- 0.194 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 all KL = 0.923 +- 0.194 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 all L1 = 0.942 +- 0.139 (in-sample avg dev_std = 0.206)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.846
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.855
NEC for r=0.6 class 0.0 = 0.097 +- 0.247 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1.0 = 0.062 +- 0.247 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.097 +- 0.247 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.077 +- 0.192 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.866
NEC for r=0.9 class 0.0 = 0.066 +- 0.194 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1.0 = 0.059 +- 0.194 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.069 +- 0.194 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.062 +- 0.168 (in-sample avg dev_std = 0.163)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.856
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.866
NEC for r=1.0 class 0.0 = 0.066 +- 0.194 (in-sample avg dev_std = 0.163)
NEC for r=1.0 class 1.0 = 0.059 +- 0.194 (in-sample avg dev_std = 0.163)
NEC for r=1.0 all KL = 0.069 +- 0.194 (in-sample avg dev_std = 0.163)
NEC for r=1.0 all L1 = 0.062 +- 0.168 (in-sample avg dev_std = 0.163)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.764
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.763
NEC for r=0.3 class 0.0 = 0.116 +- 0.257 (in-sample avg dev_std = 0.265)
NEC for r=0.3 class 1.0 = 0.019 +- 0.257 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.104 +- 0.257 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.066 +- 0.170 (in-sample avg dev_std = 0.265)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.776
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.777
NEC for r=0.6 class 0.0 = 0.117 +- 0.230 (in-sample avg dev_std = 0.232)
NEC for r=0.6 class 1.0 = 0.022 +- 0.230 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all KL = 0.091 +- 0.230 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all L1 = 0.068 +- 0.169 (in-sample avg dev_std = 0.232)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.786
NEC for r=0.9 class 0.0 = 0.106 +- 0.197 (in-sample avg dev_std = 0.202)
NEC for r=0.9 class 1.0 = 0.025 +- 0.197 (in-sample avg dev_std = 0.202)
NEC for r=0.9 all KL = 0.075 +- 0.197 (in-sample avg dev_std = 0.202)
NEC for r=0.9 all L1 = 0.064 +- 0.161 (in-sample avg dev_std = 0.202)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.776
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.782
NEC for r=1.0 class 0.0 = 0.108 +- 0.197 (in-sample avg dev_std = 0.196)
NEC for r=1.0 class 1.0 = 0.023 +- 0.197 (in-sample avg dev_std = 0.196)
NEC for r=1.0 all KL = 0.075 +- 0.197 (in-sample avg dev_std = 0.196)
NEC for r=1.0 all L1 = 0.064 +- 0.159 (in-sample avg dev_std = 0.196)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:06:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9478
Train Loss: 0.0820
ID Validation ACCURACY: 0.8638
ID Validation Loss: 0.4873
ID Test ACCURACY: 0.8589
ID Test Loss: 0.4954
OOD Validation ACCURACY: 0.8348
OOD Validation Loss: 1.1686
OOD Test ACCURACY: 0.7194
OOD Test Loss: 3.3320

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9417
Train Loss: 0.1160
ID Validation ACCURACY: 0.8512
ID Validation Loss: 0.3743
ID Test ACCURACY: 0.8527
ID Test Loss: 0.3794
OOD Validation ACCURACY: 0.8658
OOD Validation Loss: 0.5015
OOD Test ACCURACY: 0.8214
OOD Test Loss: 0.9176

[0m[1;37mINFO[0m: [1mChartInfo 0.8589 0.7194 0.8527 0.8214 0.8512 0.8658[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:06:36 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.853
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF++ for r=0.6 class 0.0 = 0.776 +- 0.299 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 1.0 = 0.855 +- 0.299 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all KL = 0.695 +- 0.299 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all L1 = 0.822 +- 0.193 (in-sample avg dev_std = 0.478)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.85
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.847
SUFF++ for r=0.9 class 0.0 = 0.907 +- 0.192 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.192 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 all KL = 0.924 +- 0.192 (in-sample avg dev_std = 0.192)
SUFF++ for r=0.9 all L1 = 0.921 +- 0.162 (in-sample avg dev_std = 0.192)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.741
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.697
SUFF++ for r=0.3 class 0.0 = 0.726 +- 0.341 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 1.0 = 0.957 +- 0.341 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all KL = 0.742 +- 0.341 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all L1 = 0.845 +- 0.217 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.703
SUFF++ for r=0.6 class 0.0 = 0.779 +- 0.278 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 class 1.0 = 0.976 +- 0.278 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 all KL = 0.82 +- 0.278 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.189 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.723
SUFF++ for r=0.9 class 0.0 = 0.886 +- 0.142 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1.0 = 0.986 +- 0.142 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.942 +- 0.142 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.937 +- 0.133 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.853
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.853
NEC for r=0.6 class 0.0 = 0.11 +- 0.208 (in-sample avg dev_std = 0.212)
NEC for r=0.6 class 1.0 = 0.058 +- 0.208 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all KL = 0.082 +- 0.208 (in-sample avg dev_std = 0.212)
NEC for r=0.6 all L1 = 0.08 +- 0.169 (in-sample avg dev_std = 0.212)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.863
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.856
NEC for r=0.9 class 0.0 = 0.092 +- 0.184 (in-sample avg dev_std = 0.171)
NEC for r=0.9 class 1.0 = 0.058 +- 0.184 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all KL = 0.066 +- 0.184 (in-sample avg dev_std = 0.171)
NEC for r=0.9 all L1 = 0.072 +- 0.161 (in-sample avg dev_std = 0.171)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.863
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.856
NEC for r=1.0 class 0.0 = 0.092 +- 0.184 (in-sample avg dev_std = 0.171)
NEC for r=1.0 class 1.0 = 0.058 +- 0.184 (in-sample avg dev_std = 0.171)
NEC for r=1.0 all KL = 0.066 +- 0.184 (in-sample avg dev_std = 0.171)
NEC for r=1.0 all L1 = 0.072 +- 0.161 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.741
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.757
NEC for r=0.3 class 0.0 = 0.168 +- 0.263 (in-sample avg dev_std = 0.262)
NEC for r=0.3 class 1.0 = 0.028 +- 0.263 (in-sample avg dev_std = 0.262)
NEC for r=0.3 all KL = 0.127 +- 0.263 (in-sample avg dev_std = 0.262)
NEC for r=0.3 all L1 = 0.096 +- 0.197 (in-sample avg dev_std = 0.262)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.738
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.749
NEC for r=0.6 class 0.0 = 0.14 +- 0.206 (in-sample avg dev_std = 0.213)
NEC for r=0.6 class 1.0 = 0.019 +- 0.206 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all KL = 0.087 +- 0.206 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all L1 = 0.078 +- 0.170 (in-sample avg dev_std = 0.213)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.737
NEC for r=0.9 class 0.0 = 0.13 +- 0.162 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 1.0 = 0.016 +- 0.162 (in-sample avg dev_std = 0.187)
NEC for r=0.9 all KL = 0.066 +- 0.162 (in-sample avg dev_std = 0.187)
NEC for r=0.9 all L1 = 0.071 +- 0.151 (in-sample avg dev_std = 0.187)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.728
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.734
NEC for r=1.0 class 0.0 = 0.127 +- 0.159 (in-sample avg dev_std = 0.173)
NEC for r=1.0 class 1.0 = 0.015 +- 0.159 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all KL = 0.064 +- 0.159 (in-sample avg dev_std = 0.173)
NEC for r=1.0 all L1 = 0.069 +- 0.147 (in-sample avg dev_std = 0.173)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.654, 0.927, 1.0], 'all_L1': [0.844, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.69, 0.925, 1.0], 'all_L1': [0.842, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.953, 1.0], 'all_L1': [0.847, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.751, 0.931, 1.0], 'all_L1': [0.869, 0.933, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.695, 0.924, 1.0], 'all_L1': [0.822, 0.921, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.098, 0.065, 0.065], 'all_L1': [0.075, 0.05, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.076, 0.076], 'all_L1': [0.088, 0.067, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.041, 0.041], 'all_L1': [0.066, 0.048, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.097, 0.069, 0.069], 'all_L1': [0.077, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.066, 0.066], 'all_L1': [0.08, 0.072, 0.072]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.526, 0.772, 0.897, 1.0], 'all_L1': [0.791, 0.885, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.751, 0.91, 1.0], 'all_L1': [0.738, 0.862, 0.933, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.74, 0.917, 1.0], 'all_L1': [0.759, 0.852, 0.933, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.678, 0.763, 0.923, 1.0], 'all_L1': [0.834, 0.878, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.82, 0.942, 1.0], 'all_L1': [0.845, 0.881, 0.937, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.19, 0.126, 0.098, 0.09], 'all_L1': [0.119, 0.084, 0.066, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.197, 0.13, 0.085, 0.087], 'all_L1': [0.152, 0.099, 0.071, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.149, 0.104, 0.075, 0.071], 'all_L1': [0.118, 0.086, 0.072, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.104, 0.091, 0.075, 0.075], 'all_L1': [0.066, 0.068, 0.064, 0.064]}), defaultdict(<class 'list'>, {'all_KL': [0.127, 0.087, 0.066, 0.064], 'all_L1': [0.096, 0.078, 0.071, 0.069]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.845 +- 0.015, 0.935 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.700 +- 0.031, 0.932 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.822 +- 0.010, 0.852 +- 0.005
nec class all_L1  =  0.077 +- 0.007, 0.060 +- 0.009, 0.060 +- 0.009
nec class all_KL  =  0.088 +- 0.016, 0.063 +- 0.012, 0.063 +- 0.012
nec_acc_int  =  0.854 +- 0.005, 0.862 +- 0.007, 0.862 +- 0.007

Eval split test
suff++ class all_L1  =  0.793 +- 0.041, 0.872 +- 0.013, 0.937 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.600 +- 0.093, 0.769 +- 0.028, 0.918 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.725 +- 0.025, 0.769 +- 0.042, 0.798 +- 0.043
nec class all_L1  =  0.110 +- 0.028, 0.083 +- 0.010, 0.069 +- 0.003, 0.068 +- 0.003
nec class all_KL  =  0.153 +- 0.036, 0.108 +- 0.018, 0.080 +- 0.011, 0.077 +- 0.010
nec_acc_int  =  0.787 +- 0.027, 0.799 +- 0.031, 0.803 +- 0.037, 0.802 +- 0.039


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.461 +- 0.008, 0.498 +- 0.001, 0.530 +- 0.005
Faith. Armon (L1)= 		  =  0.141 +- 0.012, 0.112 +- 0.017, 0.113 +- 0.017
Faith. GMean (L1)= 	  =  0.255 +- 0.012, 0.236 +- 0.018, 0.244 +- 0.019
Faith. Aritm (KL)= 		  =  0.394 +- 0.017, 0.498 +- 0.002, 0.532 +- 0.006
Faith. Armon (KL)= 		  =  0.156 +- 0.025, 0.118 +- 0.021, 0.119 +- 0.021
Faith. GMean (KL)= 	  =  0.247 +- 0.023, 0.242 +- 0.023, 0.251 +- 0.025

Eval split test
Faith. Aritm (L1)= 		  =  0.452 +- 0.011, 0.477 +- 0.006, 0.503 +- 0.001, 0.534 +- 0.002
Faith. Armon (L1)= 		  =  0.192 +- 0.043, 0.151 +- 0.017, 0.128 +- 0.006, 0.127 +- 0.006
Faith. GMean (L1)= 	  =  0.292 +- 0.033, 0.268 +- 0.016, 0.254 +- 0.005, 0.260 +- 0.007
Faith. Aritm (KL)= 		  =  0.377 +- 0.033, 0.438 +- 0.012, 0.499 +- 0.003, 0.539 +- 0.005
Faith. Armon (KL)= 		  =  0.239 +- 0.039, 0.188 +- 0.027, 0.147 +- 0.018, 0.144 +- 0.017
Faith. GMean (KL)= 	  =  0.298 +- 0.020, 0.286 +- 0.021, 0.270 +- 0.016, 0.278 +- 0.018
Computed for split load_split = id



Completed in  0:08:49.067893  for GSATvGIN GOODSST2/length



DONE GSAT GOODSST2/length Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:08:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:08:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9483
Train Loss: 0.0785
ID Validation ACCURACY: 0.8663
ID Validation Loss: 0.4982
ID Test ACCURACY: 0.8619
ID Test Loss: 0.5453
OOD Validation ACCURACY: 0.8592
OOD Validation Loss: 0.8266
OOD Test ACCURACY: 0.8139
OOD Test Loss: 1.8476

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8634
ID Validation Loss: 0.7332
ID Test ACCURACY: 0.8647
ID Test Loss: 0.8127
OOD Validation ACCURACY: 0.8675
OOD Validation Loss: 1.4025
OOD Test ACCURACY: 0.8163
OOD Test Loss: 2.6317

[0m[1;37mINFO[0m: [1mChartInfo 0.8619 0.8139 0.8647 0.8163 0.8634 0.8675[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:08:44 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.825
SUFF++ for r=0.6 class 0.0 = 0.916 +- 0.261 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 1.0 = 0.859 +- 0.261 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all KL = 0.82 +- 0.261 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all L1 = 0.883 +- 0.171 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.883
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.868
SUFF++ for r=0.9 class 0.0 = 0.9 +- 0.193 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.9 class 1.0 = 0.935 +- 0.193 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.9 all KL = 0.926 +- 0.193 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.181 (in-sample avg dev_std = 0.176)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.771
SUFF++ for r=0.3 class 0.0 = 0.801 +- 0.351 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 1.0 = 0.78 +- 0.351 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all KL = 0.581 +- 0.351 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all L1 = 0.79 +- 0.199 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.844
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.815
SUFF++ for r=0.6 class 0.0 = 0.874 +- 0.270 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 class 1.0 = 0.881 +- 0.270 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all KL = 0.805 +- 0.270 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all L1 = 0.878 +- 0.183 (in-sample avg dev_std = 0.337)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.834
SUFF++ for r=0.9 class 0.0 = 0.93 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 all KL = 0.962 +- 0.095 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.112 (in-sample avg dev_std = 0.134)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.852
NEC for r=0.6 class 0.0 = 0.093 +- 0.208 (in-sample avg dev_std = 0.183)
NEC for r=0.6 class 1.0 = 0.088 +- 0.208 (in-sample avg dev_std = 0.183)
NEC for r=0.6 all KL = 0.09 +- 0.208 (in-sample avg dev_std = 0.183)
NEC for r=0.6 all L1 = 0.09 +- 0.182 (in-sample avg dev_std = 0.183)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.874
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.866
NEC for r=0.9 class 0.0 = 0.078 +- 0.167 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1.0 = 0.063 +- 0.167 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.059 +- 0.167 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.069 +- 0.162 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.874
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.866
NEC for r=1.0 class 0.0 = 0.078 +- 0.172 (in-sample avg dev_std = 0.141)
NEC for r=1.0 class 1.0 = 0.062 +- 0.172 (in-sample avg dev_std = 0.141)
NEC for r=1.0 all KL = 0.061 +- 0.172 (in-sample avg dev_std = 0.141)
NEC for r=1.0 all L1 = 0.068 +- 0.162 (in-sample avg dev_std = 0.141)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.831
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.823
NEC for r=0.3 class 0.0 = 0.09 +- 0.237 (in-sample avg dev_std = 0.234)
NEC for r=0.3 class 1.0 = 0.111 +- 0.237 (in-sample avg dev_std = 0.234)
NEC for r=0.3 all KL = 0.114 +- 0.237 (in-sample avg dev_std = 0.234)
NEC for r=0.3 all L1 = 0.101 +- 0.197 (in-sample avg dev_std = 0.234)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.844
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.835
NEC for r=0.6 class 0.0 = 0.087 +- 0.193 (in-sample avg dev_std = 0.203)
NEC for r=0.6 class 1.0 = 0.081 +- 0.193 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all KL = 0.086 +- 0.193 (in-sample avg dev_std = 0.203)
NEC for r=0.6 all L1 = 0.084 +- 0.175 (in-sample avg dev_std = 0.203)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.839
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.834
NEC for r=0.9 class 0.0 = 0.095 +- 0.146 (in-sample avg dev_std = 0.166)
NEC for r=0.9 class 1.0 = 0.059 +- 0.146 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.166)
NEC for r=0.9 all L1 = 0.076 +- 0.153 (in-sample avg dev_std = 0.166)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.83
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0.0 = 0.09 +- 0.127 (in-sample avg dev_std = 0.150)
NEC for r=1.0 class 1.0 = 0.053 +- 0.127 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all KL = 0.052 +- 0.127 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all L1 = 0.071 +- 0.143 (in-sample avg dev_std = 0.150)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:10:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:10:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:10:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8666
ID Validation Loss: 0.7198
ID Test ACCURACY: 0.8661
ID Test Loss: 0.7353
OOD Validation ACCURACY: 0.8657
OOD Validation Loss: 1.2970
OOD Test ACCURACY: 0.8057
OOD Test Loss: 3.2971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8646
ID Validation Loss: 0.7026
ID Test ACCURACY: 0.8653
ID Test Loss: 0.7423
OOD Validation ACCURACY: 0.8663
OOD Validation Loss: 1.1192
OOD Test ACCURACY: 0.8097
OOD Test Loss: 1.8830

[0m[1;37mINFO[0m: [1mChartInfo 0.8661 0.8057 0.8653 0.8097 0.8646 0.8663[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:10:27 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.808
SUFF++ for r=0.6 class 0.0 = 0.785 +- 0.396 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 class 1.0 = 0.834 +- 0.396 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 all KL = 0.602 +- 0.396 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 all L1 = 0.814 +- 0.220 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.878
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.847
SUFF++ for r=0.9 class 0.0 = 0.89 +- 0.227 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 class 1.0 = 0.959 +- 0.227 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all KL = 0.917 +- 0.227 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all L1 = 0.929 +- 0.195 (in-sample avg dev_std = 0.180)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.762
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.694
SUFF++ for r=0.3 class 0.0 = 0.632 +- 0.405 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 class 1.0 = 0.893 +- 0.405 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 all KL = 0.561 +- 0.405 (in-sample avg dev_std = 0.565)
SUFF++ for r=0.3 all L1 = 0.767 +- 0.249 (in-sample avg dev_std = 0.565)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.786
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.758
SUFF++ for r=0.6 class 0.0 = 0.745 +- 0.366 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 class 1.0 = 0.912 +- 0.366 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all KL = 0.684 +- 0.366 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.6 all L1 = 0.831 +- 0.222 (in-sample avg dev_std = 0.460)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.8
SUFF++ for r=0.9 class 0.0 = 0.904 +- 0.221 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 1.0 = 0.943 +- 0.221 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all KL = 0.901 +- 0.221 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all L1 = 0.924 +- 0.170 (in-sample avg dev_std = 0.245)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.835
NEC for r=0.6 class 0.0 = 0.121 +- 0.263 (in-sample avg dev_std = 0.230)
NEC for r=0.6 class 1.0 = 0.06 +- 0.263 (in-sample avg dev_std = 0.230)
NEC for r=0.6 all KL = 0.107 +- 0.263 (in-sample avg dev_std = 0.230)
NEC for r=0.6 all L1 = 0.085 +- 0.207 (in-sample avg dev_std = 0.230)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.87
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.85
NEC for r=0.9 class 0.0 = 0.082 +- 0.203 (in-sample avg dev_std = 0.164)
NEC for r=0.9 class 1.0 = 0.039 +- 0.203 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all KL = 0.065 +- 0.203 (in-sample avg dev_std = 0.164)
NEC for r=0.9 all L1 = 0.057 +- 0.172 (in-sample avg dev_std = 0.164)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0.0 = 0.083 +- 0.201 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.04 +- 0.201 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.064 +- 0.201 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.058 +- 0.172 (in-sample avg dev_std = 0.159)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.762
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.765
NEC for r=0.3 class 0.0 = 0.205 +- 0.321 (in-sample avg dev_std = 0.347)
NEC for r=0.3 class 1.0 = 0.071 +- 0.321 (in-sample avg dev_std = 0.347)
NEC for r=0.3 all KL = 0.191 +- 0.321 (in-sample avg dev_std = 0.347)
NEC for r=0.3 all L1 = 0.136 +- 0.236 (in-sample avg dev_std = 0.347)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.786
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.79
NEC for r=0.6 class 0.0 = 0.131 +- 0.259 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 1.0 = 0.062 +- 0.259 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all KL = 0.124 +- 0.259 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all L1 = 0.096 +- 0.200 (in-sample avg dev_std = 0.269)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.795
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.805
NEC for r=0.9 class 0.0 = 0.09 +- 0.222 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 1.0 = 0.056 +- 0.222 (in-sample avg dev_std = 0.223)
NEC for r=0.9 all KL = 0.087 +- 0.222 (in-sample avg dev_std = 0.223)
NEC for r=0.9 all L1 = 0.072 +- 0.177 (in-sample avg dev_std = 0.223)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.798
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.808
NEC for r=1.0 class 0.0 = 0.09 +- 0.197 (in-sample avg dev_std = 0.204)
NEC for r=1.0 class 1.0 = 0.049 +- 0.197 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all KL = 0.076 +- 0.197 (in-sample avg dev_std = 0.204)
NEC for r=1.0 all L1 = 0.069 +- 0.166 (in-sample avg dev_std = 0.204)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:12:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0776
ID Validation ACCURACY: 0.8676
ID Validation Loss: 0.4668
ID Test ACCURACY: 0.8576
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.8627
OOD Validation Loss: 0.7594
OOD Test ACCURACY: 0.8171
OOD Test Loss: 1.6397

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8663
ID Validation Loss: 0.6478
ID Test ACCURACY: 0.8623
ID Test Loss: 0.6873
OOD Validation ACCURACY: 0.8644
OOD Validation Loss: 1.0848
OOD Test ACCURACY: 0.8121
OOD Test Loss: 2.2200

[0m[1;37mINFO[0m: [1mChartInfo 0.8576 0.8171 0.8623 0.8121 0.8663 0.8644[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:12:11 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.843
SUFF++ for r=0.6 class 0.0 = 0.886 +- 0.277 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 class 1.0 = 0.836 +- 0.277 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all KL = 0.765 +- 0.277 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.6 all L1 = 0.857 +- 0.178 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.878
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.873
SUFF++ for r=0.9 class 0.0 = 0.917 +- 0.167 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 class 1.0 = 0.942 +- 0.167 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all KL = 0.94 +- 0.167 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.167 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.836
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.76
SUFF++ for r=0.3 class 0.0 = 0.794 +- 0.349 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 class 1.0 = 0.734 +- 0.349 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all KL = 0.536 +- 0.349 (in-sample avg dev_std = 0.586)
SUFF++ for r=0.3 all L1 = 0.763 +- 0.202 (in-sample avg dev_std = 0.586)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.814
SUFF++ for r=0.6 class 0.0 = 0.872 +- 0.290 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1.0 = 0.868 +- 0.290 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.78 +- 0.290 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.87 +- 0.185 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.841
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.833
SUFF++ for r=0.9 class 0.0 = 0.922 +- 0.151 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 1.0 = 0.952 +- 0.151 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all KL = 0.94 +- 0.151 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.142 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.866
NEC for r=0.6 class 0.0 = 0.059 +- 0.166 (in-sample avg dev_std = 0.172)
NEC for r=0.6 class 1.0 = 0.085 +- 0.166 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all KL = 0.063 +- 0.166 (in-sample avg dev_std = 0.172)
NEC for r=0.6 all L1 = 0.074 +- 0.162 (in-sample avg dev_std = 0.172)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.881
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.079 +- 0.152 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 1.0 = 0.048 +- 0.152 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all KL = 0.049 +- 0.152 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all L1 = 0.061 +- 0.154 (in-sample avg dev_std = 0.127)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.881
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.88
NEC for r=1.0 class 0.0 = 0.076 +- 0.151 (in-sample avg dev_std = 0.128)
NEC for r=1.0 class 1.0 = 0.05 +- 0.151 (in-sample avg dev_std = 0.128)
NEC for r=1.0 all KL = 0.049 +- 0.151 (in-sample avg dev_std = 0.128)
NEC for r=1.0 all L1 = 0.061 +- 0.154 (in-sample avg dev_std = 0.128)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.836
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.828
NEC for r=0.3 class 0.0 = 0.097 +- 0.253 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 1.0 = 0.11 +- 0.253 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all KL = 0.131 +- 0.253 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all L1 = 0.104 +- 0.197 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.836
NEC for r=0.6 class 0.0 = 0.08 +- 0.185 (in-sample avg dev_std = 0.205)
NEC for r=0.6 class 1.0 = 0.082 +- 0.185 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all KL = 0.081 +- 0.185 (in-sample avg dev_std = 0.205)
NEC for r=0.6 all L1 = 0.081 +- 0.176 (in-sample avg dev_std = 0.205)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.841
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.835
NEC for r=0.9 class 0.0 = 0.08 +- 0.168 (in-sample avg dev_std = 0.185)
NEC for r=0.9 class 1.0 = 0.059 +- 0.168 (in-sample avg dev_std = 0.185)
NEC for r=0.9 all KL = 0.068 +- 0.168 (in-sample avg dev_std = 0.185)
NEC for r=0.9 all L1 = 0.069 +- 0.155 (in-sample avg dev_std = 0.185)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.842
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.836
NEC for r=1.0 class 0.0 = 0.082 +- 0.167 (in-sample avg dev_std = 0.183)
NEC for r=1.0 class 1.0 = 0.054 +- 0.167 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all KL = 0.066 +- 0.167 (in-sample avg dev_std = 0.183)
NEC for r=1.0 all L1 = 0.068 +- 0.155 (in-sample avg dev_std = 0.183)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:13:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8672
ID Validation Loss: 0.7011
ID Test ACCURACY: 0.8636
ID Test Loss: 0.7609
OOD Validation ACCURACY: 0.8638
OOD Validation Loss: 0.9780
OOD Test ACCURACY: 0.8075
OOD Test Loss: 1.7145

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9467
Train Loss: 0.0847
ID Validation ACCURACY: 0.8581
ID Validation Loss: 0.4491
ID Test ACCURACY: 0.8553
ID Test Loss: 0.4751
OOD Validation ACCURACY: 0.8657
OOD Validation Loss: 0.6157
OOD Test ACCURACY: 0.8197
OOD Test Loss: 0.9783

[0m[1;37mINFO[0m: [1mChartInfo 0.8636 0.8075 0.8553 0.8197 0.8581 0.8657[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:13:54 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.803
SUFF++ for r=0.6 class 0.0 = 0.827 +- 0.375 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 class 1.0 = 0.81 +- 0.375 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all KL = 0.601 +- 0.375 (in-sample avg dev_std = 0.524)
SUFF++ for r=0.6 all L1 = 0.817 +- 0.195 (in-sample avg dev_std = 0.524)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.869
SUFF++ for r=0.9 class 0.0 = 0.931 +- 0.194 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1.0 = 0.95 +- 0.194 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.94 +- 0.194 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.941 +- 0.173 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.739
SUFF++ for r=0.3 class 0.0 = 0.748 +- 0.362 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.3 class 1.0 = 0.717 +- 0.362 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.3 all KL = 0.453 +- 0.362 (in-sample avg dev_std = 0.632)
SUFF++ for r=0.3 all L1 = 0.732 +- 0.218 (in-sample avg dev_std = 0.632)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.829
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.789
SUFF++ for r=0.6 class 0.0 = 0.811 +- 0.324 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 class 1.0 = 0.898 +- 0.324 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all KL = 0.726 +- 0.324 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.6 all L1 = 0.856 +- 0.195 (in-sample avg dev_std = 0.411)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0.0 = 0.916 +- 0.146 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 class 1.0 = 0.964 +- 0.146 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all KL = 0.945 +- 0.146 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.9 all L1 = 0.941 +- 0.139 (in-sample avg dev_std = 0.180)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.868
NEC for r=0.6 class 0.0 = 0.08 +- 0.272 (in-sample avg dev_std = 0.256)
NEC for r=0.6 class 1.0 = 0.093 +- 0.272 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all KL = 0.121 +- 0.272 (in-sample avg dev_std = 0.256)
NEC for r=0.6 all L1 = 0.088 +- 0.197 (in-sample avg dev_std = 0.256)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.867
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.866
NEC for r=0.9 class 0.0 = 0.057 +- 0.173 (in-sample avg dev_std = 0.127)
NEC for r=0.9 class 1.0 = 0.045 +- 0.173 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all KL = 0.049 +- 0.173 (in-sample avg dev_std = 0.127)
NEC for r=0.9 all L1 = 0.05 +- 0.162 (in-sample avg dev_std = 0.127)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.87
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.866
NEC for r=1.0 class 0.0 = 0.058 +- 0.174 (in-sample avg dev_std = 0.127)
NEC for r=1.0 class 1.0 = 0.045 +- 0.174 (in-sample avg dev_std = 0.127)
NEC for r=1.0 all KL = 0.049 +- 0.174 (in-sample avg dev_std = 0.127)
NEC for r=1.0 all L1 = 0.05 +- 0.162 (in-sample avg dev_std = 0.127)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.815
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.802
NEC for r=0.3 class 0.0 = 0.177 +- 0.346 (in-sample avg dev_std = 0.360)
NEC for r=0.3 class 1.0 = 0.141 +- 0.346 (in-sample avg dev_std = 0.360)
NEC for r=0.3 all KL = 0.233 +- 0.346 (in-sample avg dev_std = 0.360)
NEC for r=0.3 all L1 = 0.159 +- 0.252 (in-sample avg dev_std = 0.360)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.829
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.822
NEC for r=0.6 class 0.0 = 0.116 +- 0.231 (in-sample avg dev_std = 0.244)
NEC for r=0.6 class 1.0 = 0.064 +- 0.231 (in-sample avg dev_std = 0.244)
NEC for r=0.6 all KL = 0.111 +- 0.231 (in-sample avg dev_std = 0.244)
NEC for r=0.6 all L1 = 0.089 +- 0.187 (in-sample avg dev_std = 0.244)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.82
NEC for r=0.9 class 0.0 = 0.09 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 class 1.0 = 0.039 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all KL = 0.06 +- 0.152 (in-sample avg dev_std = 0.175)
NEC for r=0.9 all L1 = 0.063 +- 0.146 (in-sample avg dev_std = 0.175)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.819
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.822
NEC for r=1.0 class 0.0 = 0.081 +- 0.143 (in-sample avg dev_std = 0.155)
NEC for r=1.0 class 1.0 = 0.041 +- 0.143 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all KL = 0.052 +- 0.143 (in-sample avg dev_std = 0.155)
NEC for r=1.0 all L1 = 0.06 +- 0.143 (in-sample avg dev_std = 0.155)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:15:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8653
ID Validation Loss: 0.6688
ID Test ACCURACY: 0.8600
ID Test Loss: 0.7266
OOD Validation ACCURACY: 0.8625
OOD Validation Loss: 1.4265
OOD Test ACCURACY: 0.8075
OOD Test Loss: 3.7715

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9455
Train Loss: 0.0846
ID Validation ACCURACY: 0.8591
ID Validation Loss: 0.5493
ID Test ACCURACY: 0.8563
ID Test Loss: 0.6261
OOD Validation ACCURACY: 0.8648
OOD Validation Loss: 0.9625
OOD Test ACCURACY: 0.7947
OOD Test Loss: 2.3396

[0m[1;37mINFO[0m: [1mChartInfo 0.8600 0.8075 0.8563 0.7947 0.8591 0.8648[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 07/30/2024 12:15:38 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODSST2(17490)
Data example from test: Data(x=[15, 768], edge_index=[2, 28], y=[1, 1], idx=[1], sentence_tokens=[15], length=[1], domain_id=[1])
Label distribution from test: (tensor([0., 1.]), tensor([8463, 9027]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.834
SUFF++ for r=0.6 class 0.0 = 0.894 +- 0.344 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 class 1.0 = 0.838 +- 0.344 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 all KL = 0.725 +- 0.344 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.6 all L1 = 0.862 +- 0.194 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.872
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 180
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.851
SUFF++ for r=0.9 class 0.0 = 0.922 +- 0.227 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 class 1.0 = 0.939 +- 0.227 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 all KL = 0.922 +- 0.227 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.189 (in-sample avg dev_std = 0.169)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.737
SUFF++ for r=0.3 class 0.0 = 0.724 +- 0.410 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 class 1.0 = 0.85 +- 0.410 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all KL = 0.545 +- 0.410 (in-sample avg dev_std = 0.582)
SUFF++ for r=0.3 all L1 = 0.789 +- 0.220 (in-sample avg dev_std = 0.582)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.783
SUFF++ for r=0.6 class 0.0 = 0.816 +- 0.378 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 class 1.0 = 0.91 +- 0.378 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all KL = 0.714 +- 0.378 (in-sample avg dev_std = 0.423)
SUFF++ for r=0.6 all L1 = 0.865 +- 0.202 (in-sample avg dev_std = 0.423)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0.0 = 0.915 +- 0.213 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 class 1.0 = 0.964 +- 0.213 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all KL = 0.915 +- 0.213 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.9 all L1 = 0.94 +- 0.146 (in-sample avg dev_std = 0.228)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.867
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 285
Effective ratio: 0.647 +- 0.269
Model Accuracy over intervened graphs for r=0.6 =  0.867
NEC for r=0.6 class 0.0 = 0.058 +- 0.230 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 1.0 = 0.087 +- 0.230 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all KL = 0.09 +- 0.230 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all L1 = 0.075 +- 0.184 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.877
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 285
Effective ratio: 0.862 +- 0.317
Model Accuracy over intervened graphs for r=0.9 =  0.864
NEC for r=0.9 class 0.0 = 0.065 +- 0.187 (in-sample avg dev_std = 0.156)
NEC for r=0.9 class 1.0 = 0.041 +- 0.187 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all KL = 0.055 +- 0.187 (in-sample avg dev_std = 0.156)
NEC for r=0.9 all L1 = 0.051 +- 0.158 (in-sample avg dev_std = 0.156)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.877
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 285
Effective ratio: 0.882 +- 0.322
Model Accuracy over intervened graphs for r=1.0 =  0.864
NEC for r=1.0 class 0.0 = 0.064 +- 0.185 (in-sample avg dev_std = 0.154)
NEC for r=1.0 class 1.0 = 0.04 +- 0.185 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all KL = 0.054 +- 0.185 (in-sample avg dev_std = 0.154)
NEC for r=1.0 all L1 = 0.05 +- 0.157 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.794
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.311 +- 0.008
Model Accuracy over intervened graphs for r=0.3 =  0.801
NEC for r=0.3 class 0.0 = 0.152 +- 0.352 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 1.0 = 0.112 +- 0.352 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all KL = 0.204 +- 0.352 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all L1 = 0.131 +- 0.243 (in-sample avg dev_std = 0.337)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.815
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.610 +- 0.008
Model Accuracy over intervened graphs for r=0.6 =  0.815
NEC for r=0.6 class 0.0 = 0.109 +- 0.272 (in-sample avg dev_std = 0.272)
NEC for r=0.6 class 1.0 = 0.067 +- 0.272 (in-sample avg dev_std = 0.272)
NEC for r=0.6 all KL = 0.128 +- 0.272 (in-sample avg dev_std = 0.272)
NEC for r=0.6 all L1 = 0.087 +- 0.195 (in-sample avg dev_std = 0.272)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.910 +- 0.008
Model Accuracy over intervened graphs for r=0.9 =  0.821
NEC for r=0.9 class 0.0 = 0.098 +- 0.243 (in-sample avg dev_std = 0.233)
NEC for r=0.9 class 1.0 = 0.051 +- 0.243 (in-sample avg dev_std = 0.233)
NEC for r=0.9 all KL = 0.104 +- 0.243 (in-sample avg dev_std = 0.233)
NEC for r=0.9 all L1 = 0.074 +- 0.175 (in-sample avg dev_std = 0.233)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.83
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.823
NEC for r=1.0 class 0.0 = 0.09 +- 0.231 (in-sample avg dev_std = 0.225)
NEC for r=1.0 class 1.0 = 0.052 +- 0.231 (in-sample avg dev_std = 0.225)
NEC for r=1.0 all KL = 0.093 +- 0.231 (in-sample avg dev_std = 0.225)
NEC for r=1.0 all L1 = 0.07 +- 0.175 (in-sample avg dev_std = 0.225)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.82, 0.926, 1.0], 'all_L1': [0.883, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.602, 0.917, 1.0], 'all_L1': [0.814, 0.929, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.94, 1.0], 'all_L1': [0.857, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.601, 0.94, 1.0], 'all_L1': [0.817, 0.941, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.725, 0.922, 1.0], 'all_L1': [0.862, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.09, 0.059, 0.061], 'all_L1': [0.09, 0.069, 0.068]}), defaultdict(<class 'list'>, {'all_KL': [0.107, 0.065, 0.064], 'all_L1': [0.085, 0.057, 0.058]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.049, 0.049], 'all_L1': [0.074, 0.061, 0.061]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.049, 0.049], 'all_L1': [0.088, 0.05, 0.05]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.055, 0.054], 'all_L1': [0.075, 0.051, 0.05]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.581, 0.805, 0.962, 1.0], 'all_L1': [0.79, 0.878, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.684, 0.901, 1.0], 'all_L1': [0.767, 0.831, 0.924, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.536, 0.78, 0.94, 1.0], 'all_L1': [0.763, 0.87, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.453, 0.726, 0.945, 1.0], 'all_L1': [0.732, 0.856, 0.941, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.545, 0.714, 0.915, 1.0], 'all_L1': [0.789, 0.865, 0.94, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.114, 0.086, 0.061, 0.052], 'all_L1': [0.101, 0.084, 0.076, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.124, 0.087, 0.076], 'all_L1': [0.136, 0.096, 0.072, 0.069]}), defaultdict(<class 'list'>, {'all_KL': [0.131, 0.081, 0.068, 0.066], 'all_L1': [0.104, 0.081, 0.069, 0.068]}), defaultdict(<class 'list'>, {'all_KL': [0.233, 0.111, 0.06, 0.052], 'all_L1': [0.159, 0.089, 0.063, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.204, 0.128, 0.104, 0.093], 'all_L1': [0.131, 0.087, 0.074, 0.07]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.847 +- 0.027, 0.930 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.703 +- 0.088, 0.929 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.823 +- 0.015, 0.862 +- 0.011
nec class all_L1  =  0.082 +- 0.007, 0.058 +- 0.007, 0.057 +- 0.007
nec class all_KL  =  0.094 +- 0.019, 0.055 +- 0.006, 0.055 +- 0.006
nec_acc_int  =  0.857 +- 0.013, 0.865 +- 0.010, 0.865 +- 0.010

Eval split test
suff++ class all_L1  =  0.768 +- 0.021, 0.860 +- 0.016, 0.938 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.535 +- 0.044, 0.742 +- 0.044, 0.933 +- 0.022, 1.000 +- 0.000
suff++_acc_int  =  0.740 +- 0.026, 0.792 +- 0.021, 0.820 +- 0.013
nec class all_L1  =  0.126 +- 0.022, 0.087 +- 0.005, 0.071 +- 0.005, 0.068 +- 0.004
nec class all_KL  =  0.175 +- 0.045, 0.106 +- 0.019, 0.076 +- 0.017, 0.068 +- 0.016
nec_acc_int  =  0.804 +- 0.022, 0.820 +- 0.017, 0.823 +- 0.011, 0.824 +- 0.010


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.465 +- 0.013, 0.494 +- 0.002, 0.529 +- 0.003
Faith. Armon (L1)= 		  =  0.150 +- 0.011, 0.108 +- 0.012, 0.108 +- 0.012
Faith. GMean (L1)= 	  =  0.264 +- 0.011, 0.231 +- 0.013, 0.239 +- 0.014
Faith. Aritm (KL)= 		  =  0.398 +- 0.037, 0.492 +- 0.002, 0.528 +- 0.003
Faith. Armon (KL)= 		  =  0.164 +- 0.028, 0.104 +- 0.011, 0.105 +- 0.011
Faith. GMean (KL)= 	  =  0.254 +- 0.019, 0.226 +- 0.011, 0.235 +- 0.013

Eval split test
Faith. Aritm (L1)= 		  =  0.447 +- 0.009, 0.474 +- 0.006, 0.504 +- 0.004, 0.534 +- 0.002
Faith. Armon (L1)= 		  =  0.216 +- 0.031, 0.159 +- 0.008, 0.132 +- 0.008, 0.127 +- 0.007
Faith. GMean (L1)= 	  =  0.310 +- 0.024, 0.274 +- 0.006, 0.258 +- 0.008, 0.260 +- 0.008
Faith. Aritm (KL)= 		  =  0.355 +- 0.017, 0.424 +- 0.014, 0.504 +- 0.006, 0.534 +- 0.008
Faith. Armon (KL)= 		  =  0.258 +- 0.048, 0.184 +- 0.028, 0.140 +- 0.029, 0.127 +- 0.027
Faith. GMean (KL)= 	  =  0.302 +- 0.033, 0.278 +- 0.019, 0.264 +- 0.026, 0.259 +- 0.029
Computed for split load_split = id



Completed in  0:08:40.551212  for GSATvGIN GOODSST2/length



DONE GSAT GOODSST2/length Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:17:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:17:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9973
Train Loss: 0.0144
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.3711
ID Test ACCURACY: 0.9004
ID Test Loss: 0.3799
OOD Validation ACCURACY: 0.8129
OOD Validation Loss: 0.8676
OOD Test ACCURACY: 0.2194
OOD Test Loss: 19.2538

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.9687
Train Loss: 0.0998
ID Validation ACCURACY: 0.8989
ID Validation Loss: 0.3196
ID Test ACCURACY: 0.8967
ID Test Loss: 0.3308
OOD Validation ACCURACY: 0.8863
OOD Validation Loss: 0.3868
OOD Test ACCURACY: 0.6399
OOD Test Loss: 1.9603

[0m[1;37mINFO[0m: [1mChartInfo 0.9004 0.2194 0.8967 0.6399 0.8989 0.8863[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
SUFF++ for r=0.3 class 0 = 0.599 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 1 = 0.57 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 2 = 0.594 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 3 = 0.602 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 4 = 0.587 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 5 = 0.572 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 6 = 0.593 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 7 = 0.577 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 8 = 0.59 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 class 9 = 0.575 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 all KL = 0.72 +- 0.143 (in-sample avg dev_std = 0.277)
SUFF++ for r=0.3 all L1 = 0.586 +- 0.103 (in-sample avg dev_std = 0.277)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.319
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.213
SUFF++ for r=0.6 class 0 = 0.434 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 1 = 0.485 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 2 = 0.414 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 3 = 0.406 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 4 = 0.424 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 5 = 0.427 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 6 = 0.411 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 7 = 0.434 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 8 = 0.391 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 9 = 0.405 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all KL = 0.401 +- 0.223 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all L1 = 0.424 +- 0.140 (in-sample avg dev_std = 0.336)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.783
SUFF++ for r=0.9 class 0 = 0.928 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 1 = 0.994 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 2 = 0.818 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 3 = 0.758 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 4 = 0.791 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 5 = 0.756 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 6 = 0.854 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 7 = 0.838 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 8 = 0.834 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 class 9 = 0.812 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 all KL = 0.845 +- 0.241 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.9 all L1 = 0.841 +- 0.205 (in-sample avg dev_std = 0.267)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.131
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.601 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 1 = 0.557 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 2 = 0.612 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 3 = 0.587 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 4 = 0.597 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 5 = 0.593 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 6 = 0.618 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 7 = 0.595 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 8 = 0.566 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 9 = 0.57 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 all KL = 0.723 +- 0.153 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 all L1 = 0.589 +- 0.110 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.286
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.194
SUFF++ for r=0.6 class 0 = 0.437 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 1 = 0.454 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 2 = 0.434 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 3 = 0.401 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 4 = 0.417 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 5 = 0.401 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 6 = 0.424 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 7 = 0.429 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 8 = 0.391 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 class 9 = 0.434 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 all KL = 0.403 +- 0.215 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.6 all L1 = 0.423 +- 0.146 (in-sample avg dev_std = 0.327)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.78
SUFF++ for r=0.9 class 0 = 0.926 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 1 = 0.973 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 2 = 0.777 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 3 = 0.738 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 4 = 0.745 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 5 = 0.828 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 6 = 0.844 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 7 = 0.836 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 8 = 0.814 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 class 9 = 0.768 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all KL = 0.834 +- 0.234 (in-sample avg dev_std = 0.257)
SUFF++ for r=0.9 all L1 = 0.827 +- 0.206 (in-sample avg dev_std = 0.257)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.127
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.628 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 1 = 0.583 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 2 = 0.627 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 3 = 0.616 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 4 = 0.613 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 5 = 0.618 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 6 = 0.598 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 7 = 0.597 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 8 = 0.592 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 9 = 0.584 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all KL = 0.723 +- 0.166 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all L1 = 0.606 +- 0.126 (in-sample avg dev_std = 0.282)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.178
SUFF++ for r=0.6 class 0 = 0.414 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.504 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.38 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 3 = 0.416 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 4 = 0.381 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 5 = 0.377 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 6 = 0.402 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 7 = 0.427 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 8 = 0.409 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 9 = 0.353 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.333 +- 0.220 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.408 +- 0.151 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.251
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.284
SUFF++ for r=0.9 class 0 = 0.67 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 1 = 0.994 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 2 = 0.762 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 3 = 0.773 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 4 = 0.79 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 5 = 0.767 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 6 = 0.789 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 7 = 0.799 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 8 = 0.79 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 9 = 0.78 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 all KL = 0.793 +- 0.270 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 all L1 = 0.794 +- 0.234 (in-sample avg dev_std = 0.302)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.127
NEC for r=0.3 class 0 = 0.326 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 1 = 0.34 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 2 = 0.339 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 3 = 0.303 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 4 = 0.319 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 5 = 0.346 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 6 = 0.317 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 7 = 0.335 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 8 = 0.337 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 class 9 = 0.33 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all KL = 0.162 +- 0.130 (in-sample avg dev_std = 0.146)
NEC for r=0.3 all L1 = 0.329 +- 0.117 (in-sample avg dev_std = 0.146)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.319
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.265
NEC for r=0.6 class 0 = 0.505 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 1 = 0.3 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 2 = 0.482 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 3 = 0.506 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 4 = 0.48 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 5 = 0.487 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 6 = 0.527 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 7 = 0.468 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 8 = 0.522 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 class 9 = 0.521 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 all KL = 0.426 +- 0.222 (in-sample avg dev_std = 0.288)
NEC for r=0.6 all L1 = 0.477 +- 0.155 (in-sample avg dev_std = 0.288)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.824
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.67
NEC for r=0.9 class 0 = 0.277 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 1 = 0.022 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 2 = 0.34 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 3 = 0.51 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 4 = 0.389 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 5 = 0.461 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 6 = 0.373 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 7 = 0.383 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 8 = 0.392 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 class 9 = 0.42 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all KL = 0.502 +- 0.334 (in-sample avg dev_std = 0.432)
NEC for r=0.9 all L1 = 0.352 +- 0.266 (in-sample avg dev_std = 0.432)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.959
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.865
NEC for r=1.0 class 0 = 0.116 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 1 = 0.009 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 2 = 0.233 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 3 = 0.26 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 4 = 0.222 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 5 = 0.291 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 6 = 0.248 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 7 = 0.163 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 8 = 0.217 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 class 9 = 0.286 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all KL = 0.344 +- 0.342 (in-sample avg dev_std = 0.371)
NEC for r=1.0 all L1 = 0.2 +- 0.232 (in-sample avg dev_std = 0.371)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.131
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.125
NEC for r=0.3 class 0 = 0.331 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 1 = 0.331 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 2 = 0.309 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 3 = 0.328 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 4 = 0.306 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 5 = 0.333 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 6 = 0.306 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 7 = 0.327 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 8 = 0.335 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 class 9 = 0.347 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all KL = 0.16 +- 0.134 (in-sample avg dev_std = 0.144)
NEC for r=0.3 all L1 = 0.325 +- 0.116 (in-sample avg dev_std = 0.144)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.286
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.228
NEC for r=0.6 class 0 = 0.48 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 1 = 0.38 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 2 = 0.48 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 3 = 0.512 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 4 = 0.492 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 5 = 0.52 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 6 = 0.513 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 7 = 0.485 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 8 = 0.533 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 class 9 = 0.518 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all KL = 0.442 +- 0.218 (in-sample avg dev_std = 0.298)
NEC for r=0.6 all L1 = 0.489 +- 0.148 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.682
NEC for r=0.9 class 0 = 0.245 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 1 = 0.056 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 2 = 0.384 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 3 = 0.516 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 4 = 0.416 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 5 = 0.432 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 6 = 0.379 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 7 = 0.38 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 8 = 0.384 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 class 9 = 0.413 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all KL = 0.499 +- 0.326 (in-sample avg dev_std = 0.434)
NEC for r=0.9 all L1 = 0.356 +- 0.263 (in-sample avg dev_std = 0.434)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.957
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.862
NEC for r=1.0 class 0 = 0.122 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 1 = 0.012 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 2 = 0.251 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 3 = 0.303 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 4 = 0.229 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 5 = 0.212 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 6 = 0.226 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 7 = 0.181 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 8 = 0.215 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 9 = 0.311 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all KL = 0.35 +- 0.342 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all L1 = 0.203 +- 0.231 (in-sample avg dev_std = 0.378)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.127
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.124
NEC for r=0.3 class 0 = 0.297 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1 = 0.339 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 2 = 0.296 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 3 = 0.326 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 4 = 0.324 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 5 = 0.309 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 6 = 0.34 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 7 = 0.329 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 8 = 0.346 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 9 = 0.329 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.165 +- 0.142 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.323 +- 0.127 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.239
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.22
NEC for r=0.6 class 0 = 0.413 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 1 = 0.2 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 2 = 0.457 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 3 = 0.452 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 4 = 0.474 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 5 = 0.44 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 6 = 0.452 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 7 = 0.453 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 8 = 0.449 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 class 9 = 0.474 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 all KL = 0.377 +- 0.214 (in-sample avg dev_std = 0.300)
NEC for r=0.6 all L1 = 0.424 +- 0.174 (in-sample avg dev_std = 0.300)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.251
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.268
NEC for r=0.9 class 0 = 0.571 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 1 = 0.016 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 2 = 0.49 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 3 = 0.453 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 4 = 0.418 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 5 = 0.508 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 6 = 0.439 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 7 = 0.409 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 8 = 0.404 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 class 9 = 0.368 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 all KL = 0.511 +- 0.396 (in-sample avg dev_std = 0.335)
NEC for r=0.9 all L1 = 0.403 +- 0.327 (in-sample avg dev_std = 0.335)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.203
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.255
NEC for r=1.0 class 0 = 0.481 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 1 = 0.036 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 2 = 0.439 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 3 = 0.364 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 4 = 0.316 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 5 = 0.407 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 6 = 0.291 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 7 = 0.271 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 8 = 0.284 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 9 = 0.269 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all KL = 0.444 +- 0.429 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all L1 = 0.313 +- 0.334 (in-sample avg dev_std = 0.331)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:34:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:34:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9936
Train Loss: 0.0282
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3626
ID Test ACCURACY: 0.8979
ID Test Loss: 0.3687
OOD Validation ACCURACY: 0.8104
OOD Validation Loss: 0.8374
OOD Test ACCURACY: 0.1843
OOD Test Loss: 20.7846

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9705
Train Loss: 0.0954
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.3536
ID Test ACCURACY: 0.8901
ID Test Loss: 0.3469
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.3745
OOD Test ACCURACY: 0.6829
OOD Test Loss: 1.2031

[0m[1;37mINFO[0m: [1mChartInfo 0.8979 0.1843 0.8901 0.6829 0.8883 0.8867[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.454 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 1 = 0.501 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 2 = 0.463 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 3 = 0.465 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 4 = 0.469 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 5 = 0.464 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 6 = 0.478 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 7 = 0.463 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 8 = 0.479 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 9 = 0.469 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 all KL = 0.545 +- 0.181 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 all L1 = 0.471 +- 0.096 (in-sample avg dev_std = 0.475)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.294
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.194
SUFF++ for r=0.6 class 0 = 0.413 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 1 = 0.42 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 2 = 0.429 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 3 = 0.463 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 4 = 0.485 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 5 = 0.449 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 6 = 0.439 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 7 = 0.445 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 8 = 0.474 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 class 9 = 0.459 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 all KL = 0.469 +- 0.218 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.6 all L1 = 0.447 +- 0.137 (in-sample avg dev_std = 0.305)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.774
SUFF++ for r=0.9 class 0 = 0.978 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 1 = 0.953 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 2 = 0.81 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 3 = 0.786 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 4 = 0.815 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 5 = 0.7 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 6 = 0.831 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 7 = 0.784 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 8 = 0.826 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 class 9 = 0.769 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all KL = 0.851 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.9 all L1 = 0.828 +- 0.201 (in-sample avg dev_std = 0.243)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.457 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 1 = 0.475 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 2 = 0.451 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 3 = 0.455 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 4 = 0.462 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 5 = 0.457 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 6 = 0.482 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 7 = 0.455 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 8 = 0.467 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 class 9 = 0.466 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 all KL = 0.526 +- 0.181 (in-sample avg dev_std = 0.489)
SUFF++ for r=0.3 all L1 = 0.463 +- 0.092 (in-sample avg dev_std = 0.489)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.256
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.164
SUFF++ for r=0.6 class 0 = 0.416 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 1 = 0.406 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 2 = 0.457 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 3 = 0.444 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 4 = 0.439 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 5 = 0.448 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 6 = 0.465 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 7 = 0.454 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 8 = 0.45 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 class 9 = 0.452 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all KL = 0.471 +- 0.214 (in-sample avg dev_std = 0.303)
SUFF++ for r=0.6 all L1 = 0.443 +- 0.132 (in-sample avg dev_std = 0.303)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.816
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.766
SUFF++ for r=0.9 class 0 = 0.941 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 1 = 0.926 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 2 = 0.811 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 3 = 0.754 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 4 = 0.808 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 5 = 0.787 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 6 = 0.852 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 7 = 0.812 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 8 = 0.849 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 class 9 = 0.749 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 all KL = 0.858 +- 0.195 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.194 (in-sample avg dev_std = 0.227)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.459 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 1 = 0.452 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 2 = 0.467 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 3 = 0.454 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 4 = 0.474 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 5 = 0.459 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 6 = 0.461 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 7 = 0.464 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 8 = 0.457 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 9 = 0.459 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 all KL = 0.566 +- 0.174 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 all L1 = 0.46 +- 0.102 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.18
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.178
SUFF++ for r=0.6 class 0 = 0.606 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 1 = 0.589 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 2 = 0.594 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 3 = 0.574 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 4 = 0.593 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 5 = 0.563 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 6 = 0.511 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 7 = 0.534 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 8 = 0.475 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 class 9 = 0.538 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 all KL = 0.547 +- 0.262 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.6 all L1 = 0.558 +- 0.214 (in-sample avg dev_std = 0.273)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.224
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.236
SUFF++ for r=0.9 class 0 = 0.79 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 1 = 0.789 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 2 = 0.791 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 3 = 0.764 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 4 = 0.806 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 5 = 0.761 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 6 = 0.76 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 7 = 0.781 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 8 = 0.733 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 class 9 = 0.759 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 all KL = 0.819 +- 0.233 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.9 all L1 = 0.774 +- 0.191 (in-sample avg dev_std = 0.289)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
NEC for r=0.3 class 0 = 0.384 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 1 = 0.357 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 2 = 0.382 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 3 = 0.39 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 4 = 0.366 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 5 = 0.376 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 6 = 0.39 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 7 = 0.351 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 8 = 0.396 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 9 = 0.368 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all KL = 0.227 +- 0.164 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all L1 = 0.376 +- 0.142 (in-sample avg dev_std = 0.204)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.294
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.239
NEC for r=0.6 class 0 = 0.498 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 1 = 0.448 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 2 = 0.44 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 3 = 0.463 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 4 = 0.449 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 5 = 0.439 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 6 = 0.459 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 7 = 0.479 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 8 = 0.449 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 class 9 = 0.479 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 all KL = 0.368 +- 0.192 (in-sample avg dev_std = 0.296)
NEC for r=0.6 all L1 = 0.461 +- 0.133 (in-sample avg dev_std = 0.296)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.689
NEC for r=0.9 class 0 = 0.158 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 1 = 0.102 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 2 = 0.365 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 3 = 0.439 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 4 = 0.305 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 5 = 0.564 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 6 = 0.391 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 7 = 0.432 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 8 = 0.383 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 9 = 0.435 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all KL = 0.466 +- 0.304 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all L1 = 0.352 +- 0.245 (in-sample avg dev_std = 0.397)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.95
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.851
NEC for r=1.0 class 0 = 0.056 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 1 = 0.037 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 2 = 0.246 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 3 = 0.257 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 4 = 0.19 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 5 = 0.364 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 6 = 0.275 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 7 = 0.229 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 8 = 0.221 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 9 = 0.326 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all KL = 0.339 +- 0.322 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all L1 = 0.215 +- 0.230 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.378 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 1 = 0.391 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 2 = 0.368 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 3 = 0.353 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 4 = 0.352 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 5 = 0.392 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 6 = 0.356 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 7 = 0.354 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 8 = 0.352 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 class 9 = 0.381 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all KL = 0.218 +- 0.158 (in-sample avg dev_std = 0.211)
NEC for r=0.3 all L1 = 0.368 +- 0.143 (in-sample avg dev_std = 0.211)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.256
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.195
NEC for r=0.6 class 0 = 0.498 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 1 = 0.498 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 2 = 0.44 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 3 = 0.481 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 4 = 0.482 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 5 = 0.468 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 6 = 0.476 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 7 = 0.46 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 8 = 0.463 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 class 9 = 0.485 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all KL = 0.383 +- 0.191 (in-sample avg dev_std = 0.299)
NEC for r=0.6 all L1 = 0.476 +- 0.125 (in-sample avg dev_std = 0.299)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.816
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.678
NEC for r=0.9 class 0 = 0.18 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 1 = 0.147 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 2 = 0.376 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 3 = 0.451 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 4 = 0.359 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 5 = 0.499 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 6 = 0.375 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 7 = 0.414 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 8 = 0.367 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 9 = 0.433 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all KL = 0.475 +- 0.299 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all L1 = 0.357 +- 0.240 (in-sample avg dev_std = 0.407)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.951
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.857
NEC for r=1.0 class 0 = 0.054 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 1 = 0.058 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 2 = 0.274 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 3 = 0.297 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 4 = 0.219 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 5 = 0.303 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 6 = 0.236 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 7 = 0.232 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 8 = 0.225 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 9 = 0.315 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 all KL = 0.347 +- 0.315 (in-sample avg dev_std = 0.366)
NEC for r=1.0 all L1 = 0.219 +- 0.227 (in-sample avg dev_std = 0.366)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.114
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
NEC for r=0.3 class 0 = 0.427 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 1 = 0.493 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 2 = 0.433 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 3 = 0.425 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 4 = 0.437 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 5 = 0.426 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 6 = 0.443 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 7 = 0.434 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 8 = 0.427 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 class 9 = 0.457 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 all KL = 0.297 +- 0.181 (in-sample avg dev_std = 0.227)
NEC for r=0.3 all L1 = 0.441 +- 0.136 (in-sample avg dev_std = 0.227)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.18
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.195
NEC for r=0.6 class 0 = 0.356 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1 = 0.357 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 2 = 0.376 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 3 = 0.401 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 4 = 0.38 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 5 = 0.413 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 6 = 0.415 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 7 = 0.442 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 8 = 0.444 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 9 = 0.404 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.374 +- 0.223 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.398 +- 0.189 (in-sample avg dev_std = 0.319)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.224
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.222
NEC for r=0.9 class 0 = 0.31 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 1 = 0.411 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 2 = 0.382 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 3 = 0.411 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 4 = 0.384 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 5 = 0.429 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 6 = 0.427 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 7 = 0.395 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 8 = 0.534 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 class 9 = 0.46 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 all KL = 0.439 +- 0.314 (in-sample avg dev_std = 0.332)
NEC for r=0.9 all L1 = 0.413 +- 0.259 (in-sample avg dev_std = 0.332)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.176
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.218
NEC for r=1.0 class 0 = 0.414 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 1 = 0.438 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 2 = 0.482 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 3 = 0.531 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 4 = 0.522 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 5 = 0.493 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 6 = 0.52 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 7 = 0.539 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 8 = 0.588 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 9 = 0.551 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 all KL = 0.615 +- 0.346 (in-sample avg dev_std = 0.358)
NEC for r=1.0 all L1 = 0.507 +- 0.277 (in-sample avg dev_std = 0.358)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 00:52:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 12:52:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9969
Train Loss: 0.0175
ID Validation ACCURACY: 0.8983
ID Validation Loss: 0.3772
ID Test ACCURACY: 0.8996
ID Test Loss: 0.3773
OOD Validation ACCURACY: 0.6556
OOD Validation Loss: 1.9834
OOD Test ACCURACY: 0.2234
OOD Test Loss: 34.5511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.9576
Train Loss: 0.1270
ID Validation ACCURACY: 0.8917
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.8914
ID Test Loss: 0.3444
OOD Validation ACCURACY: 0.8607
OOD Validation Loss: 0.4442
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9599

[0m[1;37mINFO[0m: [1mChartInfo 0.8996 0.2234 0.8914 0.7160 0.8917 0.8607[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.127
SUFF++ for r=0.3 class 0 = 0.596 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 1 = 0.517 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 2 = 0.569 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 3 = 0.582 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 4 = 0.566 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 5 = 0.582 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 6 = 0.587 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 7 = 0.54 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 8 = 0.583 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 9 = 0.576 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all KL = 0.73 +- 0.149 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all L1 = 0.569 +- 0.108 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.317
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.279
SUFF++ for r=0.6 class 0 = 0.464 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 1 = 0.598 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 2 = 0.47 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 3 = 0.48 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 4 = 0.486 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 5 = 0.499 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 6 = 0.455 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 7 = 0.462 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 8 = 0.486 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 class 9 = 0.452 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 all KL = 0.53 +- 0.226 (in-sample avg dev_std = 0.262)
SUFF++ for r=0.6 all L1 = 0.486 +- 0.147 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.782
SUFF++ for r=0.9 class 0 = 0.979 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 1 = 0.966 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 2 = 0.824 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 3 = 0.676 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 4 = 0.84 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 5 = 0.7 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 6 = 0.8 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 7 = 0.818 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 8 = 0.871 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 class 9 = 0.79 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all KL = 0.838 +- 0.232 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.208 (in-sample avg dev_std = 0.254)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.151
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.122
SUFF++ for r=0.3 class 0 = 0.585 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 1 = 0.523 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 2 = 0.57 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 3 = 0.601 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 4 = 0.583 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 5 = 0.577 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 6 = 0.591 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 7 = 0.568 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 8 = 0.55 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 9 = 0.56 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all KL = 0.731 +- 0.145 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all L1 = 0.57 +- 0.103 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.299
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.243
SUFF++ for r=0.6 class 0 = 0.487 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 1 = 0.562 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 2 = 0.506 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 3 = 0.49 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 4 = 0.5 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 5 = 0.485 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 6 = 0.469 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 7 = 0.488 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 8 = 0.494 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 class 9 = 0.484 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 all KL = 0.544 +- 0.224 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.6 all L1 = 0.498 +- 0.149 (in-sample avg dev_std = 0.255)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.775
SUFF++ for r=0.9 class 0 = 0.963 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 1 = 0.935 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 2 = 0.815 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 3 = 0.733 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 4 = 0.804 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 5 = 0.78 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 6 = 0.821 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 7 = 0.85 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 8 = 0.869 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 class 9 = 0.732 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all KL = 0.844 +- 0.220 (in-sample avg dev_std = 0.245)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.200 (in-sample avg dev_std = 0.245)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.605 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 1 = 0.487 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 2 = 0.574 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 3 = 0.572 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 4 = 0.532 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 5 = 0.574 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 6 = 0.559 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 7 = 0.554 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 8 = 0.55 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 9 = 0.509 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all KL = 0.676 +- 0.194 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all L1 = 0.551 +- 0.137 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.145
SUFF++ for r=0.6 class 0 = 0.448 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 1 = 0.426 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 2 = 0.446 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 3 = 0.463 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 4 = 0.448 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 5 = 0.456 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 6 = 0.437 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 7 = 0.442 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 8 = 0.457 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 class 9 = 0.439 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all KL = 0.404 +- 0.245 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.6 all L1 = 0.446 +- 0.144 (in-sample avg dev_std = 0.396)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.19
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.183
SUFF++ for r=0.9 class 0 = 0.853 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 1 = 0.866 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 2 = 0.843 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 3 = 0.855 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 4 = 0.816 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 5 = 0.802 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 6 = 0.819 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 7 = 0.739 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 8 = 0.809 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 class 9 = 0.797 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all KL = 0.825 +- 0.273 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.9 all L1 = 0.821 +- 0.209 (in-sample avg dev_std = 0.284)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.132
NEC for r=0.3 class 0 = 0.397 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 1 = 0.408 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 2 = 0.424 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 3 = 0.41 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 4 = 0.393 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 5 = 0.401 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 6 = 0.406 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 7 = 0.401 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 8 = 0.42 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 class 9 = 0.399 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all KL = 0.24 +- 0.137 (in-sample avg dev_std = 0.209)
NEC for r=0.3 all L1 = 0.406 +- 0.108 (in-sample avg dev_std = 0.209)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.317
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.292
NEC for r=0.6 class 0 = 0.437 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 1 = 0.26 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 2 = 0.435 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 3 = 0.457 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 4 = 0.452 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 5 = 0.439 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 6 = 0.51 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 7 = 0.474 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 8 = 0.448 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 class 9 = 0.495 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 all KL = 0.36 +- 0.218 (in-sample avg dev_std = 0.281)
NEC for r=0.6 all L1 = 0.438 +- 0.163 (in-sample avg dev_std = 0.281)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.107 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 1 = 0.119 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 2 = 0.349 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 3 = 0.59 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 4 = 0.331 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 5 = 0.564 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 6 = 0.421 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 7 = 0.371 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 8 = 0.384 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 class 9 = 0.429 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 all KL = 0.501 +- 0.328 (in-sample avg dev_std = 0.408)
NEC for r=0.9 all L1 = 0.362 +- 0.266 (in-sample avg dev_std = 0.408)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.959
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.846
NEC for r=1.0 class 0 = 0.044 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 1 = 0.02 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 2 = 0.227 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 3 = 0.396 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 4 = 0.159 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 5 = 0.376 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 6 = 0.305 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 7 = 0.18 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 8 = 0.16 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 class 9 = 0.337 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all KL = 0.358 +- 0.347 (in-sample avg dev_std = 0.380)
NEC for r=1.0 all L1 = 0.216 +- 0.246 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.151
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.139
NEC for r=0.3 class 0 = 0.407 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 1 = 0.418 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 2 = 0.407 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 3 = 0.388 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 4 = 0.408 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 5 = 0.405 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 6 = 0.405 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 7 = 0.42 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 8 = 0.407 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 class 9 = 0.416 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 all KL = 0.241 +- 0.144 (in-sample avg dev_std = 0.210)
NEC for r=0.3 all L1 = 0.408 +- 0.110 (in-sample avg dev_std = 0.210)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.299
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.265
NEC for r=0.6 class 0 = 0.409 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 1 = 0.334 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 2 = 0.448 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 3 = 0.462 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 4 = 0.471 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 5 = 0.486 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 6 = 0.464 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 7 = 0.473 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 8 = 0.456 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 class 9 = 0.45 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all KL = 0.361 +- 0.205 (in-sample avg dev_std = 0.275)
NEC for r=0.6 all L1 = 0.443 +- 0.153 (in-sample avg dev_std = 0.275)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0 = 0.103 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.159 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.36 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 3 = 0.587 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 4 = 0.35 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 5 = 0.535 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 6 = 0.451 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 7 = 0.337 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 8 = 0.331 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 9 = 0.461 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.51 +- 0.331 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.364 +- 0.263 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.956
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.847
NEC for r=1.0 class 0 = 0.053 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 1 = 0.04 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 2 = 0.23 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 3 = 0.404 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 4 = 0.19 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 5 = 0.329 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 6 = 0.271 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 7 = 0.189 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 8 = 0.194 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 class 9 = 0.37 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all KL = 0.378 +- 0.352 (in-sample avg dev_std = 0.387)
NEC for r=1.0 all L1 = 0.224 +- 0.244 (in-sample avg dev_std = 0.387)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.118
NEC for r=0.3 class 0 = 0.347 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 1 = 0.416 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 2 = 0.383 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 3 = 0.393 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 4 = 0.431 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 5 = 0.38 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 6 = 0.437 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 7 = 0.408 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 8 = 0.416 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 class 9 = 0.416 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 all KL = 0.254 +- 0.166 (in-sample avg dev_std = 0.224)
NEC for r=0.3 all L1 = 0.402 +- 0.134 (in-sample avg dev_std = 0.224)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.144
NEC for r=0.6 class 0 = 0.387 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 1 = 0.374 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 2 = 0.4 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 3 = 0.387 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 4 = 0.437 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 5 = 0.434 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 6 = 0.459 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 7 = 0.447 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 8 = 0.45 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 class 9 = 0.451 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all KL = 0.339 +- 0.210 (in-sample avg dev_std = 0.282)
NEC for r=0.6 all L1 = 0.422 +- 0.169 (in-sample avg dev_std = 0.282)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.19
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.168
NEC for r=0.9 class 0 = 0.219 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 1 = 0.341 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 2 = 0.249 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 3 = 0.321 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 4 = 0.288 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 5 = 0.378 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 6 = 0.327 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 7 = 0.425 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 8 = 0.316 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 9 = 0.405 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all KL = 0.38 +- 0.371 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all L1 = 0.326 +- 0.299 (in-sample avg dev_std = 0.256)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.204
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.192
NEC for r=1.0 class 0 = 0.544 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 1 = 0.125 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 2 = 0.425 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 3 = 0.441 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 4 = 0.534 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 5 = 0.431 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 6 = 0.431 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 7 = 0.523 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 8 = 0.402 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 class 9 = 0.488 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 all KL = 0.515 +- 0.416 (in-sample avg dev_std = 0.261)
NEC for r=1.0 all L1 = 0.43 +- 0.341 (in-sample avg dev_std = 0.261)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 01:10:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:10:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9948
Train Loss: 0.0239
ID Validation ACCURACY: 0.9039
ID Validation Loss: 0.3607
ID Test ACCURACY: 0.8994
ID Test Loss: 0.3693
OOD Validation ACCURACY: 0.8719
OOD Validation Loss: 0.4937
OOD Test ACCURACY: 0.5734
OOD Test Loss: 1.9596

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.9614
Train Loss: 0.1157
ID Validation ACCURACY: 0.8914
ID Validation Loss: 0.3430
ID Test ACCURACY: 0.8853
ID Test Loss: 0.3519
OOD Validation ACCURACY: 0.8899
OOD Validation Loss: 0.3549
OOD Test ACCURACY: 0.6547
OOD Test Loss: 1.2699

[0m[1;37mINFO[0m: [1mChartInfo 0.8994 0.5734 0.8853 0.6547 0.8914 0.8899[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.131
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
SUFF++ for r=0.3 class 0 = 0.636 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 1 = 0.547 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 2 = 0.608 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 3 = 0.613 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 4 = 0.587 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 5 = 0.593 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 6 = 0.599 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 7 = 0.592 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 8 = 0.599 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 class 9 = 0.591 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all KL = 0.75 +- 0.150 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.3 all L1 = 0.596 +- 0.114 (in-sample avg dev_std = 0.246)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.322
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.254
SUFF++ for r=0.6 class 0 = 0.616 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 1 = 0.566 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 2 = 0.504 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 3 = 0.51 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 4 = 0.518 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 5 = 0.543 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 6 = 0.494 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 7 = 0.49 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 8 = 0.493 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 class 9 = 0.475 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 all KL = 0.586 +- 0.227 (in-sample avg dev_std = 0.227)
SUFF++ for r=0.6 all L1 = 0.521 +- 0.160 (in-sample avg dev_std = 0.227)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.785
SUFF++ for r=0.9 class 0 = 0.974 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 1 = 0.965 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 2 = 0.811 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 3 = 0.769 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 4 = 0.81 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 5 = 0.728 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 6 = 0.789 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 7 = 0.853 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 8 = 0.79 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 class 9 = 0.797 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all KL = 0.848 +- 0.223 (in-sample avg dev_std = 0.251)
SUFF++ for r=0.9 all L1 = 0.832 +- 0.196 (in-sample avg dev_std = 0.251)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.66 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 1 = 0.526 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 2 = 0.606 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 3 = 0.629 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 4 = 0.608 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 5 = 0.608 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 6 = 0.605 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 7 = 0.608 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 8 = 0.587 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 9 = 0.597 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all KL = 0.755 +- 0.157 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all L1 = 0.602 +- 0.117 (in-sample avg dev_std = 0.238)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.236
SUFF++ for r=0.6 class 0 = 0.639 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 1 = 0.524 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 2 = 0.541 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 3 = 0.528 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 4 = 0.465 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 5 = 0.527 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 6 = 0.498 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 7 = 0.541 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 8 = 0.501 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 9 = 0.51 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 all KL = 0.594 +- 0.217 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 all L1 = 0.527 +- 0.162 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.789
SUFF++ for r=0.9 class 0 = 0.947 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 1 = 0.924 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 2 = 0.769 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 3 = 0.787 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 4 = 0.8 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 5 = 0.785 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 6 = 0.793 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 7 = 0.812 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 8 = 0.826 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 class 9 = 0.743 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all KL = 0.84 +- 0.210 (in-sample avg dev_std = 0.236)
SUFF++ for r=0.9 all L1 = 0.82 +- 0.202 (in-sample avg dev_std = 0.236)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.151
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.128
SUFF++ for r=0.3 class 0 = 0.596 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 1 = 0.495 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 2 = 0.59 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 3 = 0.584 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 4 = 0.57 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 5 = 0.592 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 6 = 0.567 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 7 = 0.564 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 8 = 0.554 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 class 9 = 0.544 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 all KL = 0.701 +- 0.197 (in-sample avg dev_std = 0.275)
SUFF++ for r=0.3 all L1 = 0.565 +- 0.128 (in-sample avg dev_std = 0.275)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.235
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.208
SUFF++ for r=0.6 class 0 = 0.529 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 1 = 0.599 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 2 = 0.52 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 3 = 0.524 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 4 = 0.495 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 5 = 0.523 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 6 = 0.46 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 7 = 0.559 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 8 = 0.538 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 class 9 = 0.48 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 all KL = 0.579 +- 0.228 (in-sample avg dev_std = 0.234)
SUFF++ for r=0.6 all L1 = 0.524 +- 0.163 (in-sample avg dev_std = 0.234)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.476
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.45
SUFF++ for r=0.9 class 0 = 0.713 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 1 = 0.839 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 2 = 0.761 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 3 = 0.712 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 4 = 0.767 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 5 = 0.734 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 6 = 0.721 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 7 = 0.833 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 8 = 0.672 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 class 9 = 0.685 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all KL = 0.812 +- 0.196 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.9 all L1 = 0.745 +- 0.193 (in-sample avg dev_std = 0.266)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.131
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.128
NEC for r=0.3 class 0 = 0.323 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 1 = 0.378 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 2 = 0.347 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 3 = 0.354 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 4 = 0.369 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 5 = 0.367 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 6 = 0.364 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 7 = 0.356 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 8 = 0.388 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 class 9 = 0.376 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all KL = 0.193 +- 0.132 (in-sample avg dev_std = 0.187)
NEC for r=0.3 all L1 = 0.362 +- 0.120 (in-sample avg dev_std = 0.187)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.322
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.287
NEC for r=0.6 class 0 = 0.328 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 1 = 0.334 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 2 = 0.406 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 3 = 0.435 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 4 = 0.449 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 5 = 0.415 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 6 = 0.465 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 7 = 0.455 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 8 = 0.458 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 9 = 0.46 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all KL = 0.321 +- 0.198 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all L1 = 0.419 +- 0.155 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.827
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.681
NEC for r=0.9 class 0 = 0.135 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 1 = 0.106 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 2 = 0.386 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 3 = 0.459 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 4 = 0.387 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 5 = 0.503 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 6 = 0.436 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 7 = 0.351 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 8 = 0.43 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 class 9 = 0.456 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 all KL = 0.488 +- 0.310 (in-sample avg dev_std = 0.394)
NEC for r=0.9 all L1 = 0.359 +- 0.251 (in-sample avg dev_std = 0.394)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.947
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.852
NEC for r=1.0 class 0 = 0.064 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 1 = 0.026 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 2 = 0.226 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 3 = 0.312 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 4 = 0.192 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 5 = 0.295 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 6 = 0.305 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 7 = 0.214 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 8 = 0.25 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 class 9 = 0.323 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all KL = 0.362 +- 0.325 (in-sample avg dev_std = 0.374)
NEC for r=1.0 all L1 = 0.217 +- 0.233 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
NEC for r=0.3 class 0 = 0.306 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 1 = 0.401 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 2 = 0.365 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 3 = 0.34 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 4 = 0.355 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 5 = 0.364 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 6 = 0.366 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 7 = 0.364 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 8 = 0.376 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 class 9 = 0.372 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 all KL = 0.191 +- 0.132 (in-sample avg dev_std = 0.186)
NEC for r=0.3 all L1 = 0.362 +- 0.119 (in-sample avg dev_std = 0.186)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.29
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.255
NEC for r=0.6 class 0 = 0.316 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 1 = 0.389 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 2 = 0.412 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 3 = 0.42 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 4 = 0.47 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 5 = 0.418 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 6 = 0.478 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 7 = 0.421 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 8 = 0.434 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 class 9 = 0.452 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 all KL = 0.324 +- 0.197 (in-sample avg dev_std = 0.260)
NEC for r=0.6 all L1 = 0.421 +- 0.149 (in-sample avg dev_std = 0.260)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.836
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.685
NEC for r=0.9 class 0 = 0.15 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 1 = 0.153 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 2 = 0.352 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 3 = 0.437 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 4 = 0.379 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 5 = 0.443 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 6 = 0.434 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 7 = 0.369 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 8 = 0.394 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 9 = 0.475 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 all KL = 0.482 +- 0.302 (in-sample avg dev_std = 0.402)
NEC for r=0.9 all L1 = 0.356 +- 0.249 (in-sample avg dev_std = 0.402)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.955
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0 = 0.074 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 1 = 0.028 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 2 = 0.253 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 3 = 0.317 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 4 = 0.193 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 5 = 0.259 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 6 = 0.264 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 7 = 0.222 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 8 = 0.242 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 class 9 = 0.362 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all KL = 0.355 +- 0.337 (in-sample avg dev_std = 0.378)
NEC for r=1.0 all L1 = 0.219 +- 0.238 (in-sample avg dev_std = 0.378)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.151
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.135
NEC for r=0.3 class 0 = 0.344 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 1 = 0.409 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 2 = 0.371 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 3 = 0.394 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 4 = 0.392 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 5 = 0.384 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 6 = 0.421 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 7 = 0.391 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 8 = 0.406 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 class 9 = 0.403 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all KL = 0.224 +- 0.155 (in-sample avg dev_std = 0.204)
NEC for r=0.3 all L1 = 0.391 +- 0.115 (in-sample avg dev_std = 0.204)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.235
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.216
NEC for r=0.6 class 0 = 0.431 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.308 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.425 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 3 = 0.42 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 4 = 0.475 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 5 = 0.433 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 6 = 0.455 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 7 = 0.427 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 8 = 0.445 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 9 = 0.469 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.333 +- 0.201 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.427 +- 0.157 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.476
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.376
NEC for r=0.9 class 0 = 0.516 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 1 = 0.302 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 2 = 0.383 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 3 = 0.531 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 4 = 0.393 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 5 = 0.494 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 6 = 0.55 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 7 = 0.345 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 8 = 0.563 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 9 = 0.527 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all KL = 0.487 +- 0.282 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all L1 = 0.458 +- 0.224 (in-sample avg dev_std = 0.349)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.569
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.484
NEC for r=1.0 class 0 = 0.526 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 1 = 0.243 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 2 = 0.405 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 3 = 0.519 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 4 = 0.378 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 5 = 0.426 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 6 = 0.549 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 7 = 0.313 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 8 = 0.591 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 class 9 = 0.516 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 all KL = 0.501 +- 0.302 (in-sample avg dev_std = 0.364)
NEC for r=1.0 all L1 = 0.444 +- 0.251 (in-sample avg dev_std = 0.364)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 01:27:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:27:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9900
Train Loss: 0.0382
ID Validation ACCURACY: 0.9037
ID Validation Loss: 0.3520
ID Test ACCURACY: 0.8939
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8174
OOD Validation Loss: 0.6925
OOD Test ACCURACY: 0.2504
OOD Test Loss: 5.2588

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.9243
Train Loss: 0.2256
ID Validation ACCURACY: 0.8811
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8820
ID Test Loss: 0.3644
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3793
OOD Test ACCURACY: 0.6897
OOD Test Loss: 1.0648

[0m[1;37mINFO[0m: [1mChartInfo 0.8939 0.2504 0.8820 0.6897 0.8811 0.8760[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.494 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 1 = 0.5 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 2 = 0.523 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 3 = 0.488 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 4 = 0.492 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 5 = 0.497 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 6 = 0.526 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 7 = 0.507 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 8 = 0.506 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 class 9 = 0.513 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 all KL = 0.572 +- 0.163 (in-sample avg dev_std = 0.357)
SUFF++ for r=0.3 all L1 = 0.505 +- 0.098 (in-sample avg dev_std = 0.357)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.27
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.194
SUFF++ for r=0.6 class 0 = 0.386 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 1 = 0.471 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 2 = 0.338 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 3 = 0.363 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 4 = 0.381 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 5 = 0.372 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 6 = 0.414 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 7 = 0.391 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 8 = 0.382 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 class 9 = 0.361 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all KL = 0.313 +- 0.220 (in-sample avg dev_std = 0.473)
SUFF++ for r=0.6 all L1 = 0.387 +- 0.146 (in-sample avg dev_std = 0.473)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.768
SUFF++ for r=0.9 class 0 = 0.913 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 1 = 0.973 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 2 = 0.742 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 3 = 0.797 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 4 = 0.854 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 5 = 0.716 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 6 = 0.807 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 7 = 0.812 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 8 = 0.876 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 class 9 = 0.781 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all KL = 0.846 +- 0.233 (in-sample avg dev_std = 0.261)
SUFF++ for r=0.9 all L1 = 0.83 +- 0.204 (in-sample avg dev_std = 0.261)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.511 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 1 = 0.481 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 2 = 0.492 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 3 = 0.531 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 4 = 0.52 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 5 = 0.504 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 6 = 0.504 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 7 = 0.495 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 8 = 0.517 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 9 = 0.512 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all KL = 0.569 +- 0.169 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all L1 = 0.506 +- 0.100 (in-sample avg dev_std = 0.362)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.269
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.173
SUFF++ for r=0.6 class 0 = 0.382 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 1 = 0.421 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 2 = 0.364 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 3 = 0.357 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 4 = 0.374 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 5 = 0.368 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 6 = 0.418 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 7 = 0.392 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 8 = 0.352 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 9 = 0.387 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all KL = 0.309 +- 0.217 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all L1 = 0.382 +- 0.139 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.769
SUFF++ for r=0.9 class 0 = 0.912 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1 = 0.942 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 2 = 0.765 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 3 = 0.76 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 4 = 0.846 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 5 = 0.768 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 6 = 0.823 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 7 = 0.821 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 8 = 0.85 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 9 = 0.768 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.852 +- 0.210 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.828 +- 0.198 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.443 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 1 = 0.412 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 2 = 0.448 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 3 = 0.432 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 4 = 0.437 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 5 = 0.446 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 6 = 0.452 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 7 = 0.413 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 8 = 0.438 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 9 = 0.437 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 all KL = 0.467 +- 0.160 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 all L1 = 0.436 +- 0.084 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.139
SUFF++ for r=0.6 class 0 = 0.49 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 1 = 0.438 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 2 = 0.493 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 3 = 0.484 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 4 = 0.469 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 5 = 0.459 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 6 = 0.436 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 7 = 0.493 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 8 = 0.442 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 class 9 = 0.439 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 all KL = 0.438 +- 0.222 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.6 all L1 = 0.465 +- 0.164 (in-sample avg dev_std = 0.325)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.225
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.221
SUFF++ for r=0.9 class 0 = 0.738 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 1 = 0.722 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 2 = 0.722 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 3 = 0.743 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 4 = 0.717 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 5 = 0.723 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 6 = 0.705 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 7 = 0.817 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 8 = 0.69 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 class 9 = 0.732 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all KL = 0.798 +- 0.207 (in-sample avg dev_std = 0.313)
SUFF++ for r=0.9 all L1 = 0.731 +- 0.182 (in-sample avg dev_std = 0.313)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.409 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 1 = 0.408 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 2 = 0.394 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 3 = 0.411 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 4 = 0.393 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 5 = 0.365 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 6 = 0.41 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 7 = 0.381 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 8 = 0.41 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 class 9 = 0.417 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 all KL = 0.238 +- 0.146 (in-sample avg dev_std = 0.190)
NEC for r=0.3 all L1 = 0.4 +- 0.119 (in-sample avg dev_std = 0.190)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.27
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.241
NEC for r=0.6 class 0 = 0.484 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 1 = 0.333 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 2 = 0.477 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 3 = 0.485 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 4 = 0.492 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 5 = 0.449 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 6 = 0.459 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 7 = 0.522 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 8 = 0.439 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 class 9 = 0.522 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 all KL = 0.432 +- 0.222 (in-sample avg dev_std = 0.335)
NEC for r=0.6 all L1 = 0.465 +- 0.166 (in-sample avg dev_std = 0.335)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.81
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.656
NEC for r=0.9 class 0 = 0.299 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 1 = 0.064 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 2 = 0.473 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 3 = 0.43 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 4 = 0.278 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 5 = 0.52 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 6 = 0.396 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 7 = 0.406 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 8 = 0.291 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 9 = 0.447 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 all KL = 0.481 +- 0.318 (in-sample avg dev_std = 0.418)
NEC for r=0.9 all L1 = 0.355 +- 0.254 (in-sample avg dev_std = 0.418)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.95
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0 = 0.135 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 1 = 0.016 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 2 = 0.316 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 3 = 0.259 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 4 = 0.16 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 5 = 0.425 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 6 = 0.253 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 7 = 0.2 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 8 = 0.18 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 class 9 = 0.34 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 all KL = 0.346 +- 0.336 (in-sample avg dev_std = 0.373)
NEC for r=1.0 all L1 = 0.223 +- 0.241 (in-sample avg dev_std = 0.373)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.405 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 1 = 0.42 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 2 = 0.393 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 3 = 0.378 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 4 = 0.379 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 5 = 0.382 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 6 = 0.394 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 7 = 0.408 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 8 = 0.385 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 class 9 = 0.391 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all KL = 0.231 +- 0.143 (in-sample avg dev_std = 0.185)
NEC for r=0.3 all L1 = 0.394 +- 0.122 (in-sample avg dev_std = 0.185)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.269
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.229
NEC for r=0.6 class 0 = 0.452 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 1 = 0.377 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 2 = 0.474 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 3 = 0.435 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 4 = 0.519 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 5 = 0.487 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 6 = 0.509 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 7 = 0.491 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 8 = 0.454 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 class 9 = 0.519 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all KL = 0.433 +- 0.229 (in-sample avg dev_std = 0.333)
NEC for r=0.6 all L1 = 0.47 +- 0.172 (in-sample avg dev_std = 0.333)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.822
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.663
NEC for r=0.9 class 0 = 0.276 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 1 = 0.112 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 2 = 0.466 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 3 = 0.448 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 4 = 0.293 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 5 = 0.537 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 6 = 0.384 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 7 = 0.381 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 8 = 0.312 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 class 9 = 0.447 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all KL = 0.488 +- 0.317 (in-sample avg dev_std = 0.421)
NEC for r=0.9 all L1 = 0.361 +- 0.251 (in-sample avg dev_std = 0.421)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.942
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.84
NEC for r=1.0 class 0 = 0.116 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 1 = 0.033 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 2 = 0.358 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 3 = 0.326 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 4 = 0.156 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 5 = 0.324 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 6 = 0.262 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 7 = 0.208 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 8 = 0.176 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 class 9 = 0.352 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 all KL = 0.357 +- 0.330 (in-sample avg dev_std = 0.379)
NEC for r=1.0 all L1 = 0.227 +- 0.235 (in-sample avg dev_std = 0.379)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
NEC for r=0.3 class 0 = 0.445 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 1 = 0.458 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 2 = 0.435 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 3 = 0.459 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 4 = 0.452 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 5 = 0.467 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 6 = 0.453 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 7 = 0.456 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 8 = 0.436 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 class 9 = 0.444 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all KL = 0.283 +- 0.141 (in-sample avg dev_std = 0.202)
NEC for r=0.3 all L1 = 0.45 +- 0.106 (in-sample avg dev_std = 0.202)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.147
NEC for r=0.6 class 0 = 0.473 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 1 = 0.39 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 2 = 0.479 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 3 = 0.456 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 4 = 0.475 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 5 = 0.508 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 6 = 0.496 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 7 = 0.46 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 8 = 0.527 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 class 9 = 0.473 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 all KL = 0.408 +- 0.202 (in-sample avg dev_std = 0.324)
NEC for r=0.6 all L1 = 0.472 +- 0.158 (in-sample avg dev_std = 0.324)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.225
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.211
NEC for r=0.9 class 0 = 0.464 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 1 = 0.422 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 2 = 0.465 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 3 = 0.462 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 4 = 0.455 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 5 = 0.451 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 6 = 0.477 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 7 = 0.342 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 8 = 0.52 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 class 9 = 0.421 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 all KL = 0.449 +- 0.275 (in-sample avg dev_std = 0.338)
NEC for r=0.9 all L1 = 0.448 +- 0.227 (in-sample avg dev_std = 0.338)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.251
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.233
NEC for r=1.0 class 0 = 0.419 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 1 = 0.531 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 2 = 0.437 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 3 = 0.459 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 4 = 0.454 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 5 = 0.488 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 6 = 0.505 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 7 = 0.36 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 8 = 0.541 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 9 = 0.5 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all KL = 0.521 +- 0.301 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all L1 = 0.469 +- 0.244 (in-sample avg dev_std = 0.331)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.72, 0.401, 0.845, 1.0], 'all_L1': [0.586, 0.424, 0.841, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.545, 0.469, 0.851, 1.0], 'all_L1': [0.471, 0.447, 0.828, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.73, 0.53, 0.838, 1.0], 'all_L1': [0.569, 0.486, 0.829, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.75, 0.586, 0.848, 1.0], 'all_L1': [0.596, 0.521, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.313, 0.846, 1.0], 'all_L1': [0.505, 0.387, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.162, 0.426, 0.502, 0.344], 'all_L1': [0.329, 0.477, 0.352, 0.2]}), defaultdict(<class 'list'>, {'all_KL': [0.227, 0.368, 0.466, 0.339], 'all_L1': [0.376, 0.461, 0.352, 0.215]}), defaultdict(<class 'list'>, {'all_KL': [0.24, 0.36, 0.501, 0.358], 'all_L1': [0.406, 0.438, 0.362, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.321, 0.488, 0.362], 'all_L1': [0.362, 0.419, 0.359, 0.217]}), defaultdict(<class 'list'>, {'all_KL': [0.238, 0.432, 0.481, 0.346], 'all_L1': [0.4, 0.465, 0.355, 0.223]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.723, 0.403, 0.834, 1.0], 'all_L1': [0.589, 0.423, 0.827, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.526, 0.471, 0.858, 1.0], 'all_L1': [0.463, 0.443, 0.83, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.731, 0.544, 0.844, 1.0], 'all_L1': [0.57, 0.498, 0.832, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.755, 0.594, 0.84, 1.0], 'all_L1': [0.602, 0.527, 0.82, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.309, 0.852, 1.0], 'all_L1': [0.506, 0.382, 0.828, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.16, 0.442, 0.499, 0.35], 'all_L1': [0.325, 0.489, 0.356, 0.203]}), defaultdict(<class 'list'>, {'all_KL': [0.218, 0.383, 0.475, 0.347], 'all_L1': [0.368, 0.476, 0.357, 0.219]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.361, 0.51, 0.378], 'all_L1': [0.408, 0.443, 0.364, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.191, 0.324, 0.482, 0.355], 'all_L1': [0.362, 0.421, 0.356, 0.219]}), defaultdict(<class 'list'>, {'all_KL': [0.231, 0.433, 0.488, 0.357], 'all_L1': [0.394, 0.47, 0.361, 0.227]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.723, 0.333, 0.793, 1.0], 'all_L1': [0.606, 0.408, 0.794, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.566, 0.547, 0.819, 1.0], 'all_L1': [0.46, 0.558, 0.774, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.404, 0.825, 1.0], 'all_L1': [0.551, 0.446, 0.821, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.701, 0.579, 0.812, 1.0], 'all_L1': [0.565, 0.524, 0.745, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.467, 0.438, 0.798, 1.0], 'all_L1': [0.436, 0.465, 0.731, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.165, 0.377, 0.511, 0.444], 'all_L1': [0.323, 0.424, 0.403, 0.313]}), defaultdict(<class 'list'>, {'all_KL': [0.297, 0.374, 0.439, 0.615], 'all_L1': [0.441, 0.398, 0.413, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.254, 0.339, 0.38, 0.515], 'all_L1': [0.402, 0.422, 0.326, 0.43]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.333, 0.487, 0.501], 'all_L1': [0.391, 0.427, 0.458, 0.444]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.408, 0.449, 0.521], 'all_L1': [0.45, 0.472, 0.448, 0.469]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.545 +- 0.049, 0.453 +- 0.047, 0.832 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.663 +- 0.087, 0.460 +- 0.096, 0.846 +- 0.004, 1.000 +- 0.000
suff++_acc_int  =  0.115 +- 0.010, 0.227 +- 0.034, 0.778 +- 0.007
nec class all_L1  =  0.375 +- 0.028, 0.452 +- 0.021, 0.356 +- 0.004, 0.214 +- 0.008
nec class all_KL  =  0.212 +- 0.030, 0.381 +- 0.042, 0.488 +- 0.013, 0.350 +- 0.009
nec_acc_int  =  0.120 +- 0.012, 0.265 +- 0.022, 0.672 +- 0.012, 0.851 +- 0.008

Eval split id_test
suff++ class all_L1  =  0.546 +- 0.053, 0.455 +- 0.052, 0.827 +- 0.004, 1.000 +- 0.000
suff++ class all_KL  =  0.661 +- 0.094, 0.464 +- 0.101, 0.846 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.112 +- 0.006, 0.202 +- 0.032, 0.776 +- 0.008
nec class all_L1  =  0.371 +- 0.029, 0.460 +- 0.025, 0.359 +- 0.003, 0.218 +- 0.008
nec class all_KL  =  0.208 +- 0.029, 0.389 +- 0.044, 0.491 +- 0.012, 0.357 +- 0.011
nec_acc_int  =  0.117 +- 0.015, 0.234 +- 0.024, 0.672 +- 0.012, 0.851 +- 0.008

Eval split test
suff++ class all_L1  =  0.524 +- 0.065, 0.480 +- 0.054, 0.773 +- 0.033, 1.000 +- 0.000
suff++ class all_KL  =  0.627 +- 0.096, 0.460 +- 0.091, 0.809 +- 0.012, 1.000 +- 0.000
suff++_acc_int  =  0.111 +- 0.010, 0.170 +- 0.025, 0.275 +- 0.093
nec class all_L1  =  0.401 +- 0.045, 0.429 +- 0.024, 0.410 +- 0.047, 0.433 +- 0.065
nec class all_KL  =  0.245 +- 0.047, 0.366 +- 0.027, 0.453 +- 0.045, 0.519 +- 0.055
nec_acc_int  =  0.119 +- 0.011, 0.184 +- 0.033, 0.249 +- 0.071, 0.277 +- 0.106


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.460 +- 0.022, 0.453 +- 0.015, 0.594 +- 0.002, 0.607 +- 0.004
Faith. Armon (L1)= 		  =  0.442 +- 0.020, 0.450 +- 0.015, 0.499 +- 0.004, 0.353 +- 0.010
Faith. GMean (L1)= 	  =  0.451 +- 0.021, 0.451 +- 0.015, 0.544 +- 0.003, 0.463 +- 0.008
Faith. Aritm (KL)= 		  =  0.438 +- 0.038, 0.421 +- 0.028, 0.667 +- 0.005, 0.675 +- 0.004
Faith. Armon (KL)= 		  =  0.318 +- 0.032, 0.406 +- 0.023, 0.618 +- 0.010, 0.518 +- 0.010
Faith. GMean (KL)= 	  =  0.372 +- 0.027, 0.413 +- 0.025, 0.642 +- 0.008, 0.591 +- 0.007

Eval split id_test
Faith. Aritm (L1)= 		  =  0.459 +- 0.026, 0.457 +- 0.017, 0.593 +- 0.003, 0.609 +- 0.004
Faith. Armon (L1)= 		  =  0.440 +- 0.024, 0.454 +- 0.017, 0.501 +- 0.004, 0.358 +- 0.011
Faith. GMean (L1)= 	  =  0.449 +- 0.024, 0.456 +- 0.017, 0.545 +- 0.003, 0.467 +- 0.009
Faith. Aritm (KL)= 		  =  0.435 +- 0.043, 0.426 +- 0.031, 0.668 +- 0.005, 0.679 +- 0.005
Faith. Armon (KL)= 		  =  0.313 +- 0.033, 0.412 +- 0.026, 0.621 +- 0.009, 0.527 +- 0.012
Faith. GMean (KL)= 	  =  0.368 +- 0.030, 0.419 +- 0.028, 0.644 +- 0.007, 0.598 +- 0.009

Eval split test
Faith. Aritm (L1)= 		  =  0.463 +- 0.014, 0.454 +- 0.025, 0.591 +- 0.010, 0.716 +- 0.033
Faith. Armon (L1)= 		  =  0.448 +- 0.016, 0.451 +- 0.022, 0.533 +- 0.035, 0.601 +- 0.067
Faith. GMean (L1)= 	  =  0.455 +- 0.013, 0.453 +- 0.023, 0.561 +- 0.023, 0.656 +- 0.052
Faith. Aritm (KL)= 		  =  0.436 +- 0.033, 0.413 +- 0.043, 0.631 +- 0.018, 0.760 +- 0.028
Faith. Armon (KL)= 		  =  0.344 +- 0.041, 0.402 +- 0.035, 0.579 +- 0.035, 0.682 +- 0.047
Faith. GMean (KL)= 	  =  0.386 +- 0.027, 0.408 +- 0.039, 0.605 +- 0.027, 0.720 +- 0.038
Computed for split load_split = id



Completed in  1:27:44.713947  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 01:45:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 01:45:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0203
ID Validation ACCURACY: 0.9014
ID Validation Loss: 0.3598
ID Test ACCURACY: 0.9006
ID Test Loss: 0.3758
OOD Validation ACCURACY: 0.7387
OOD Validation Loss: 1.3849
OOD Test ACCURACY: 0.1806
OOD Test Loss: 32.6934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9764
Train Loss: 0.0764
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3491
ID Test ACCURACY: 0.8901
ID Test Loss: 0.3702
OOD Validation ACCURACY: 0.8813
OOD Validation Loss: 0.3951
OOD Test ACCURACY: 0.6997
OOD Test Loss: 1.1981

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.1806 0.8901 0.6997 0.8979 0.8813[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
SUFF++ for r=0.3 class 0 = 0.784 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 1 = 0.723 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 2 = 0.745 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 3 = 0.766 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 4 = 0.739 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 5 = 0.772 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 6 = 0.738 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 7 = 0.771 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 8 = 0.743 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 class 9 = 0.734 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all KL = 0.783 +- 0.210 (in-sample avg dev_std = 0.254)
SUFF++ for r=0.3 all L1 = 0.751 +- 0.108 (in-sample avg dev_std = 0.254)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.101
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.1
SUFF++ for r=0.6 class 0 = 0.733 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 1 = 0.662 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 2 = 0.708 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 3 = 0.7 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 4 = 0.692 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 5 = 0.695 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 6 = 0.698 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 7 = 0.664 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 8 = 0.697 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 class 9 = 0.682 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 all KL = 0.851 +- 0.153 (in-sample avg dev_std = 0.135)
SUFF++ for r=0.6 all L1 = 0.692 +- 0.156 (in-sample avg dev_std = 0.135)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.123
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.123
SUFF++ for r=0.9 class 0 = 0.822 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 1 = 0.811 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 2 = 0.818 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 3 = 0.803 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 4 = 0.829 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 5 = 0.797 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 6 = 0.817 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 7 = 0.808 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 8 = 0.814 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 9 = 0.802 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all KL = 0.927 +- 0.096 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all L1 = 0.812 +- 0.115 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.776 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 1 = 0.733 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 2 = 0.772 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 3 = 0.773 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 4 = 0.749 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 5 = 0.769 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 6 = 0.75 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 7 = 0.752 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 8 = 0.755 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 class 9 = 0.73 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all KL = 0.803 +- 0.197 (in-sample avg dev_std = 0.238)
SUFF++ for r=0.3 all L1 = 0.755 +- 0.110 (in-sample avg dev_std = 0.238)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
SUFF++ for r=0.6 class 0 = 0.722 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 1 = 0.656 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 2 = 0.717 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 3 = 0.706 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 4 = 0.722 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 5 = 0.724 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 6 = 0.674 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 7 = 0.672 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 8 = 0.705 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 class 9 = 0.688 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 all KL = 0.855 +- 0.152 (in-sample avg dev_std = 0.130)
SUFF++ for r=0.6 all L1 = 0.697 +- 0.161 (in-sample avg dev_std = 0.130)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.097
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.111
SUFF++ for r=0.9 class 0 = 0.805 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 1 = 0.819 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 2 = 0.82 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 3 = 0.815 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 4 = 0.805 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 5 = 0.813 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 6 = 0.817 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 7 = 0.805 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 8 = 0.836 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 class 9 = 0.812 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all KL = 0.93 +- 0.083 (in-sample avg dev_std = 0.188)
SUFF++ for r=0.9 all L1 = 0.815 +- 0.113 (in-sample avg dev_std = 0.188)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.095
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
SUFF++ for r=0.3 class 0 = 0.784 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 1 = 0.677 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 2 = 0.753 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 3 = 0.738 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 4 = 0.72 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 5 = 0.724 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 6 = 0.736 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 7 = 0.741 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 8 = 0.756 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 class 9 = 0.746 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 all KL = 0.778 +- 0.197 (in-sample avg dev_std = 0.280)
SUFF++ for r=0.3 all L1 = 0.737 +- 0.118 (in-sample avg dev_std = 0.280)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.114
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.098
SUFF++ for r=0.6 class 0 = 0.762 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 1 = 0.57 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 2 = 0.736 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 3 = 0.718 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 4 = 0.689 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 5 = 0.706 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 6 = 0.711 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 7 = 0.701 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 8 = 0.691 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 class 9 = 0.676 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 all KL = 0.854 +- 0.147 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.6 all L1 = 0.695 +- 0.156 (in-sample avg dev_std = 0.129)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.12
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.121
SUFF++ for r=0.9 class 0 = 0.811 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 1 = 0.835 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 2 = 0.837 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 3 = 0.828 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 4 = 0.815 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 5 = 0.813 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 6 = 0.797 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 7 = 0.84 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 8 = 0.787 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 class 9 = 0.816 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all KL = 0.932 +- 0.083 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.9 all L1 = 0.818 +- 0.112 (in-sample avg dev_std = 0.177)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.143 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 1 = 0.172 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 2 = 0.166 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 3 = 0.153 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 4 = 0.181 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 5 = 0.159 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 6 = 0.175 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 7 = 0.161 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 8 = 0.154 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 class 9 = 0.169 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 all KL = 0.046 +- 0.039 (in-sample avg dev_std = 0.090)
NEC for r=0.3 all L1 = 0.163 +- 0.067 (in-sample avg dev_std = 0.090)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.101
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
NEC for r=0.6 class 0 = 0.244 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 1 = 0.278 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 2 = 0.239 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 3 = 0.267 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 4 = 0.249 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 5 = 0.259 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 6 = 0.272 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 7 = 0.27 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 8 = 0.255 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 9 = 0.274 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 all KL = 0.105 +- 0.098 (in-sample avg dev_std = 0.141)
NEC for r=0.6 all L1 = 0.261 +- 0.124 (in-sample avg dev_std = 0.141)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.123
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.114
NEC for r=0.9 class 0 = 0.334 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 1 = 0.322 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 2 = 0.33 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 3 = 0.344 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 4 = 0.312 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 5 = 0.345 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 6 = 0.325 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 7 = 0.33 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 8 = 0.323 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 class 9 = 0.316 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 all KL = 0.176 +- 0.121 (in-sample avg dev_std = 0.227)
NEC for r=0.9 all L1 = 0.328 +- 0.125 (in-sample avg dev_std = 0.227)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.131
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.126
NEC for r=1.0 class 0 = 0.355 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 1 = 0.317 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 2 = 0.35 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 3 = 0.358 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 4 = 0.329 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 5 = 0.339 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 6 = 0.37 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 7 = 0.354 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 8 = 0.346 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 9 = 0.358 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all KL = 0.207 +- 0.137 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all L1 = 0.348 +- 0.134 (in-sample avg dev_std = 0.242)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.146 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 1 = 0.184 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 2 = 0.152 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 3 = 0.154 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 4 = 0.174 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 5 = 0.169 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 6 = 0.158 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 7 = 0.163 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 8 = 0.157 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 class 9 = 0.161 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 all KL = 0.046 +- 0.042 (in-sample avg dev_std = 0.093)
NEC for r=0.3 all L1 = 0.162 +- 0.067 (in-sample avg dev_std = 0.093)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
NEC for r=0.6 class 0 = 0.265 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 1 = 0.284 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 2 = 0.253 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 3 = 0.241 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 4 = 0.238 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 5 = 0.228 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 6 = 0.269 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 7 = 0.283 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 8 = 0.251 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 class 9 = 0.261 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all KL = 0.105 +- 0.105 (in-sample avg dev_std = 0.149)
NEC for r=0.6 all L1 = 0.258 +- 0.129 (in-sample avg dev_std = 0.149)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.097
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.1
NEC for r=0.9 class 0 = 0.353 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 1 = 0.322 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 2 = 0.344 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 3 = 0.34 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 4 = 0.329 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 5 = 0.33 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 6 = 0.33 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 7 = 0.344 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 8 = 0.285 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 class 9 = 0.336 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 all KL = 0.18 +- 0.125 (in-sample avg dev_std = 0.229)
NEC for r=0.9 all L1 = 0.331 +- 0.129 (in-sample avg dev_std = 0.229)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.119
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.105
NEC for r=1.0 class 0 = 0.363 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 1 = 0.316 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 2 = 0.374 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 3 = 0.331 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 4 = 0.375 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 5 = 0.354 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 6 = 0.346 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 7 = 0.37 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 8 = 0.324 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 class 9 = 0.353 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 all KL = 0.213 +- 0.144 (in-sample avg dev_std = 0.254)
NEC for r=1.0 all L1 = 0.35 +- 0.138 (in-sample avg dev_std = 0.254)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.095
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
NEC for r=0.3 class 0 = 0.141 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 1 = 0.177 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 2 = 0.147 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 3 = 0.145 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 4 = 0.177 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 5 = 0.174 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 6 = 0.144 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 7 = 0.159 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 8 = 0.151 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 class 9 = 0.16 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 all KL = 0.042 +- 0.036 (in-sample avg dev_std = 0.083)
NEC for r=0.3 all L1 = 0.157 +- 0.068 (in-sample avg dev_std = 0.083)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.114
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
NEC for r=0.6 class 0 = 0.221 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 1 = 0.349 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 2 = 0.232 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 3 = 0.261 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 4 = 0.281 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 5 = 0.26 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 6 = 0.266 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 7 = 0.262 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 8 = 0.266 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 class 9 = 0.296 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all KL = 0.11 +- 0.099 (in-sample avg dev_std = 0.153)
NEC for r=0.6 all L1 = 0.27 +- 0.125 (in-sample avg dev_std = 0.153)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.12
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.119
NEC for r=0.9 class 0 = 0.363 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 1 = 0.255 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 2 = 0.358 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 3 = 0.316 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 4 = 0.334 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 5 = 0.342 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 6 = 0.349 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 7 = 0.335 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 8 = 0.371 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 class 9 = 0.349 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 all KL = 0.19 +- 0.125 (in-sample avg dev_std = 0.223)
NEC for r=0.9 all L1 = 0.336 +- 0.127 (in-sample avg dev_std = 0.223)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.132
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.133
NEC for r=1.0 class 0 = 0.337 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 1 = 0.264 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 2 = 0.333 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 3 = 0.321 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 4 = 0.329 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 5 = 0.337 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 6 = 0.348 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 7 = 0.348 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 8 = 0.351 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 class 9 = 0.344 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all KL = 0.198 +- 0.141 (in-sample avg dev_std = 0.242)
NEC for r=1.0 all L1 = 0.33 +- 0.143 (in-sample avg dev_std = 0.242)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 02:03:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:03:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9871
Train Loss: 0.0493
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.3510
ID Test ACCURACY: 0.8979
ID Test Loss: 0.3523
OOD Validation ACCURACY: 0.8323
OOD Validation Loss: 0.5930
OOD Test ACCURACY: 0.3886
OOD Test Loss: 3.1866

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9559
Train Loss: 0.1312
ID Validation ACCURACY: 0.8850
ID Validation Loss: 0.3660
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3583
OOD Validation ACCURACY: 0.8541
OOD Validation Loss: 0.4597
OOD Test ACCURACY: 0.6029
OOD Test Loss: 1.5918

[0m[1;37mINFO[0m: [1mChartInfo 0.8979 0.3886 0.8910 0.6029 0.8850 0.8541[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
SUFF++ for r=0.3 class 0 = 0.592 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 1 = 0.648 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 2 = 0.633 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 3 = 0.664 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 4 = 0.683 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 5 = 0.674 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 6 = 0.661 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 7 = 0.692 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 8 = 0.652 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 class 9 = 0.664 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 all KL = 0.734 +- 0.244 (in-sample avg dev_std = 0.361)
SUFF++ for r=0.3 all L1 = 0.656 +- 0.141 (in-sample avg dev_std = 0.361)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.098
SUFF++ for r=0.6 class 0 = 0.5 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 1 = 0.638 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 2 = 0.529 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 3 = 0.591 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 4 = 0.631 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 5 = 0.581 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 6 = 0.588 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 7 = 0.593 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 8 = 0.552 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 9 = 0.632 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all KL = 0.679 +- 0.253 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all L1 = 0.584 +- 0.149 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.119
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.101
SUFF++ for r=0.9 class 0 = 0.518 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 1 = 0.731 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 2 = 0.552 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 3 = 0.61 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 4 = 0.661 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 5 = 0.615 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 6 = 0.611 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 7 = 0.636 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 8 = 0.575 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 class 9 = 0.691 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all KL = 0.731 +- 0.234 (in-sample avg dev_std = 0.248)
SUFF++ for r=0.9 all L1 = 0.621 +- 0.181 (in-sample avg dev_std = 0.248)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.618 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 1 = 0.663 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 2 = 0.665 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 3 = 0.669 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 4 = 0.686 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 5 = 0.671 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 6 = 0.659 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 7 = 0.693 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 8 = 0.665 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 class 9 = 0.669 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 all KL = 0.764 +- 0.219 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.3 all L1 = 0.666 +- 0.136 (in-sample avg dev_std = 0.322)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.088
SUFF++ for r=0.6 class 0 = 0.511 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 1 = 0.63 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 2 = 0.561 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 3 = 0.567 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 4 = 0.615 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 5 = 0.571 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 6 = 0.592 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 7 = 0.639 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 8 = 0.563 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 9 = 0.645 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all KL = 0.683 +- 0.262 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all L1 = 0.591 +- 0.156 (in-sample avg dev_std = 0.338)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.096
SUFF++ for r=0.9 class 0 = 0.577 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 1 = 0.708 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 2 = 0.574 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 3 = 0.576 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 4 = 0.648 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 5 = 0.592 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 6 = 0.613 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 7 = 0.673 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 8 = 0.575 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 class 9 = 0.687 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all KL = 0.731 +- 0.244 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.9 all L1 = 0.624 +- 0.185 (in-sample avg dev_std = 0.230)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.637 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 1 = 0.535 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 2 = 0.632 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 3 = 0.629 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 4 = 0.6 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 5 = 0.582 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 6 = 0.618 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 7 = 0.616 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 8 = 0.607 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 class 9 = 0.559 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 all KL = 0.678 +- 0.250 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.3 all L1 = 0.601 +- 0.155 (in-sample avg dev_std = 0.388)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
SUFF++ for r=0.6 class 0 = 0.658 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 1 = 0.538 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 2 = 0.677 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 3 = 0.68 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 4 = 0.615 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 5 = 0.63 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 6 = 0.596 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 7 = 0.635 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 8 = 0.628 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 class 9 = 0.568 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all KL = 0.739 +- 0.270 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.6 all L1 = 0.622 +- 0.181 (in-sample avg dev_std = 0.263)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.136
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.115
SUFF++ for r=0.9 class 0 = 0.737 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 1 = 0.558 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 2 = 0.765 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 3 = 0.717 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 4 = 0.713 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 5 = 0.702 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 6 = 0.652 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 7 = 0.691 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 8 = 0.692 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 class 9 = 0.615 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all KL = 0.763 +- 0.277 (in-sample avg dev_std = 0.276)
SUFF++ for r=0.9 all L1 = 0.683 +- 0.205 (in-sample avg dev_std = 0.276)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.252 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 1 = 0.227 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 2 = 0.237 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 3 = 0.206 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 4 = 0.208 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 5 = 0.209 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 6 = 0.242 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 7 = 0.204 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 8 = 0.235 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 class 9 = 0.236 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all KL = 0.095 +- 0.179 (in-sample avg dev_std = 0.147)
NEC for r=0.3 all L1 = 0.225 +- 0.141 (in-sample avg dev_std = 0.147)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
NEC for r=0.6 class 0 = 0.402 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 1 = 0.294 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 2 = 0.396 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 3 = 0.34 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 4 = 0.321 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 5 = 0.355 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 6 = 0.38 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 7 = 0.336 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 8 = 0.364 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 9 = 0.356 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all KL = 0.207 +- 0.217 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all L1 = 0.353 +- 0.153 (in-sample avg dev_std = 0.190)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.119
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.101
NEC for r=0.9 class 0 = 0.413 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 1 = 0.355 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 2 = 0.435 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 3 = 0.414 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 4 = 0.413 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 5 = 0.405 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 6 = 0.427 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 7 = 0.409 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 8 = 0.447 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 9 = 0.416 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all KL = 0.271 +- 0.211 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all L1 = 0.413 +- 0.140 (in-sample avg dev_std = 0.197)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.13
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.114
NEC for r=1.0 class 0 = 0.42 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1 = 0.409 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 2 = 0.466 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 3 = 0.413 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 4 = 0.443 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 5 = 0.439 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 6 = 0.46 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 7 = 0.445 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 8 = 0.469 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 9 = 0.457 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.311 +- 0.224 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.441 +- 0.144 (in-sample avg dev_std = 0.205)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
NEC for r=0.3 class 0 = 0.273 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.239 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.231 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 3 = 0.225 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 4 = 0.24 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 5 = 0.215 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 6 = 0.235 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 7 = 0.216 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 8 = 0.237 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 9 = 0.231 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.106 +- 0.194 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.234 +- 0.147 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.095
NEC for r=0.6 class 0 = 0.404 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 1 = 0.317 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 2 = 0.381 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 3 = 0.375 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 4 = 0.362 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 5 = 0.37 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 6 = 0.353 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 7 = 0.316 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 8 = 0.366 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 9 = 0.348 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all KL = 0.217 +- 0.231 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all L1 = 0.358 +- 0.160 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.1
NEC for r=0.9 class 0 = 0.38 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 1 = 0.383 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 2 = 0.469 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 3 = 0.441 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 4 = 0.412 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 5 = 0.437 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 6 = 0.429 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 7 = 0.401 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 8 = 0.448 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 9 = 0.419 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all KL = 0.29 +- 0.229 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all L1 = 0.421 +- 0.153 (in-sample avg dev_std = 0.197)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.125
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.112
NEC for r=1.0 class 0 = 0.395 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 1 = 0.415 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 2 = 0.472 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 3 = 0.452 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 4 = 0.44 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 5 = 0.444 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 6 = 0.457 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 7 = 0.433 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 8 = 0.473 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 class 9 = 0.436 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 all KL = 0.317 +- 0.233 (in-sample avg dev_std = 0.201)
NEC for r=1.0 all L1 = 0.441 +- 0.151 (in-sample avg dev_std = 0.201)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
NEC for r=0.3 class 0 = 0.215 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 1 = 0.336 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 2 = 0.183 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 3 = 0.243 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 4 = 0.247 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 5 = 0.272 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 6 = 0.24 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 7 = 0.228 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 8 = 0.235 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 class 9 = 0.305 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all KL = 0.167 +- 0.289 (in-sample avg dev_std = 0.231)
NEC for r=0.3 all L1 = 0.25 +- 0.198 (in-sample avg dev_std = 0.231)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
NEC for r=0.6 class 0 = 0.327 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 1 = 0.489 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 2 = 0.307 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 3 = 0.33 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 4 = 0.369 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 5 = 0.387 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 6 = 0.388 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 7 = 0.377 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 8 = 0.343 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 9 = 0.44 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all KL = 0.277 +- 0.313 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all L1 = 0.376 +- 0.207 (in-sample avg dev_std = 0.266)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.136
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 0 = 0.383 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 1 = 0.568 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 2 = 0.367 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 3 = 0.395 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 4 = 0.4 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 5 = 0.44 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 6 = 0.469 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 7 = 0.395 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 8 = 0.417 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 9 = 0.495 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all KL = 0.355 +- 0.322 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all L1 = 0.434 +- 0.208 (in-sample avg dev_std = 0.252)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.149
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.133
NEC for r=1.0 class 0 = 0.376 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 1 = 0.568 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 2 = 0.369 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 3 = 0.406 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 4 = 0.411 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 5 = 0.452 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 6 = 0.461 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 7 = 0.424 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 8 = 0.425 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 class 9 = 0.507 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all KL = 0.372 +- 0.318 (in-sample avg dev_std = 0.257)
NEC for r=1.0 all L1 = 0.44 +- 0.206 (in-sample avg dev_std = 0.257)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 02:22:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:22:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0312
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3395
ID Test ACCURACY: 0.8974
ID Test Loss: 0.3686
OOD Validation ACCURACY: 0.8296
OOD Validation Loss: 0.6959
OOD Test ACCURACY: 0.2200
OOD Test Loss: 25.5397

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9525
Train Loss: 0.1461
ID Validation ACCURACY: 0.8914
ID Validation Loss: 0.3247
ID Test ACCURACY: 0.8917
ID Test Loss: 0.3396
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.3573
OOD Test ACCURACY: 0.6063
OOD Test Loss: 1.4400

[0m[1;37mINFO[0m: [1mChartInfo 0.8974 0.2200 0.8917 0.6063 0.8914 0.8847[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
SUFF++ for r=0.3 class 0 = 0.706 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 1 = 0.661 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 2 = 0.666 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 3 = 0.674 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 4 = 0.673 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 5 = 0.692 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 6 = 0.674 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 7 = 0.696 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 8 = 0.677 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 class 9 = 0.686 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all KL = 0.826 +- 0.122 (in-sample avg dev_std = 0.259)
SUFF++ for r=0.3 all L1 = 0.68 +- 0.097 (in-sample avg dev_std = 0.259)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.099
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
SUFF++ for r=0.6 class 0 = 0.711 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 1 = 0.678 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 2 = 0.71 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 3 = 0.721 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 4 = 0.695 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 5 = 0.724 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 6 = 0.715 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 7 = 0.7 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 8 = 0.731 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 class 9 = 0.703 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 all KL = 0.886 +- 0.093 (in-sample avg dev_std = 0.101)
SUFF++ for r=0.6 all L1 = 0.708 +- 0.105 (in-sample avg dev_std = 0.101)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.136
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.122
SUFF++ for r=0.9 class 0 = 0.822 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 1 = 0.773 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 2 = 0.814 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 3 = 0.791 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 4 = 0.796 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 5 = 0.802 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 6 = 0.782 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 7 = 0.801 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 8 = 0.795 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 9 = 0.802 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all KL = 0.922 +- 0.093 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all L1 = 0.797 +- 0.102 (in-sample avg dev_std = 0.194)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
SUFF++ for r=0.3 class 0 = 0.691 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 1 = 0.673 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 2 = 0.685 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 3 = 0.682 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 4 = 0.662 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 5 = 0.681 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 6 = 0.684 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 7 = 0.698 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 8 = 0.684 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 class 9 = 0.664 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all KL = 0.829 +- 0.109 (in-sample avg dev_std = 0.247)
SUFF++ for r=0.3 all L1 = 0.681 +- 0.094 (in-sample avg dev_std = 0.247)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.115
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.104
SUFF++ for r=0.6 class 0 = 0.742 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 1 = 0.677 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 2 = 0.707 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 3 = 0.733 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 4 = 0.699 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 5 = 0.718 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 6 = 0.717 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 7 = 0.708 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 8 = 0.732 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 class 9 = 0.698 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 all KL = 0.89 +- 0.092 (in-sample avg dev_std = 0.100)
SUFF++ for r=0.6 all L1 = 0.712 +- 0.104 (in-sample avg dev_std = 0.100)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.1
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.106
SUFF++ for r=0.9 class 0 = 0.81 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 1 = 0.789 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 2 = 0.793 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 3 = 0.823 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 4 = 0.793 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 5 = 0.797 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 6 = 0.774 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 7 = 0.796 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 8 = 0.795 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 9 = 0.783 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all KL = 0.924 +- 0.084 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all L1 = 0.795 +- 0.106 (in-sample avg dev_std = 0.184)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
SUFF++ for r=0.3 class 0 = 0.716 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 1 = 0.698 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 2 = 0.721 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 3 = 0.716 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 4 = 0.727 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 5 = 0.713 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 6 = 0.725 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 7 = 0.713 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 8 = 0.696 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 class 9 = 0.719 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 all KL = 0.852 +- 0.116 (in-sample avg dev_std = 0.241)
SUFF++ for r=0.3 all L1 = 0.714 +- 0.101 (in-sample avg dev_std = 0.241)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.099
SUFF++ for r=0.6 class 0 = 0.745 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 1 = 0.681 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 2 = 0.703 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 3 = 0.728 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 4 = 0.687 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 5 = 0.706 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 6 = 0.711 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 7 = 0.705 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 8 = 0.715 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 class 9 = 0.703 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 all KL = 0.884 +- 0.101 (in-sample avg dev_std = 0.103)
SUFF++ for r=0.6 all L1 = 0.708 +- 0.119 (in-sample avg dev_std = 0.103)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.105
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.104
SUFF++ for r=0.9 class 0 = 0.802 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 1 = 0.81 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 2 = 0.831 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 3 = 0.8 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 4 = 0.826 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 5 = 0.819 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 6 = 0.812 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 7 = 0.833 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 8 = 0.793 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 9 = 0.829 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all KL = 0.937 +- 0.073 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all L1 = 0.815 +- 0.093 (in-sample avg dev_std = 0.171)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.251 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 1 = 0.251 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 2 = 0.257 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 3 = 0.266 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 4 = 0.278 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 5 = 0.264 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 6 = 0.275 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 7 = 0.263 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 8 = 0.251 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 9 = 0.256 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.087 +- 0.057 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.261 +- 0.078 (in-sample avg dev_std = 0.162)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.099
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
NEC for r=0.6 class 0 = 0.26 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 1 = 0.266 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 2 = 0.244 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 3 = 0.263 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 4 = 0.252 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 5 = 0.259 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 6 = 0.246 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 7 = 0.265 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 8 = 0.254 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 class 9 = 0.261 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 all KL = 0.083 +- 0.052 (in-sample avg dev_std = 0.135)
NEC for r=0.6 all L1 = 0.257 +- 0.072 (in-sample avg dev_std = 0.135)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.136
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 0 = 0.316 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 1 = 0.339 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 2 = 0.326 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 3 = 0.344 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 4 = 0.329 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 5 = 0.338 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 6 = 0.363 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 7 = 0.324 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 8 = 0.349 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 class 9 = 0.353 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 all KL = 0.166 +- 0.105 (in-sample avg dev_std = 0.187)
NEC for r=0.9 all L1 = 0.338 +- 0.090 (in-sample avg dev_std = 0.187)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.147
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.141
NEC for r=1.0 class 0 = 0.303 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 1 = 0.368 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 2 = 0.348 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 3 = 0.345 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 4 = 0.357 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 5 = 0.33 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 6 = 0.35 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 7 = 0.341 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 8 = 0.359 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 class 9 = 0.371 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all KL = 0.19 +- 0.119 (in-sample avg dev_std = 0.210)
NEC for r=1.0 all L1 = 0.347 +- 0.104 (in-sample avg dev_std = 0.210)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.246 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.274 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.245 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 3 = 0.255 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 4 = 0.27 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 5 = 0.268 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 6 = 0.261 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 7 = 0.258 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 8 = 0.26 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 9 = 0.252 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.085 +- 0.059 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.259 +- 0.080 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.115
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.106
NEC for r=0.6 class 0 = 0.239 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 1 = 0.267 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 2 = 0.26 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 3 = 0.237 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 4 = 0.258 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 5 = 0.253 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 6 = 0.253 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 7 = 0.259 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 8 = 0.236 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 9 = 0.256 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all KL = 0.082 +- 0.054 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all L1 = 0.252 +- 0.070 (in-sample avg dev_std = 0.137)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.1
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.104
NEC for r=0.9 class 0 = 0.327 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 1 = 0.327 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 2 = 0.332 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 3 = 0.325 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 4 = 0.346 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 5 = 0.322 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 6 = 0.34 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 7 = 0.329 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 8 = 0.356 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 9 = 0.343 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all KL = 0.164 +- 0.103 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all L1 = 0.335 +- 0.092 (in-sample avg dev_std = 0.189)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.105
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.113
NEC for r=1.0 class 0 = 0.312 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1 = 0.345 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 2 = 0.334 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 3 = 0.351 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 4 = 0.358 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 5 = 0.341 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 6 = 0.354 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 7 = 0.332 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 8 = 0.377 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 9 = 0.356 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.187 +- 0.114 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.346 +- 0.103 (in-sample avg dev_std = 0.205)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.209 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 1 = 0.219 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 2 = 0.2 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 3 = 0.202 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 4 = 0.205 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 5 = 0.217 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 6 = 0.199 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 7 = 0.204 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 8 = 0.217 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 class 9 = 0.204 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all KL = 0.058 +- 0.047 (in-sample avg dev_std = 0.127)
NEC for r=0.3 all L1 = 0.208 +- 0.073 (in-sample avg dev_std = 0.127)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.097
NEC for r=0.6 class 0 = 0.23 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 1 = 0.269 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 2 = 0.247 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 3 = 0.243 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 4 = 0.266 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 5 = 0.257 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 6 = 0.265 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 7 = 0.257 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 8 = 0.246 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 class 9 = 0.236 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 all KL = 0.084 +- 0.062 (in-sample avg dev_std = 0.134)
NEC for r=0.6 all L1 = 0.252 +- 0.086 (in-sample avg dev_std = 0.134)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.105
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.099
NEC for r=0.9 class 0 = 0.341 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 1 = 0.265 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 2 = 0.32 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 3 = 0.321 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 4 = 0.294 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 5 = 0.315 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 6 = 0.334 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 7 = 0.307 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 8 = 0.318 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 9 = 0.307 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all KL = 0.145 +- 0.106 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all L1 = 0.312 +- 0.101 (in-sample avg dev_std = 0.189)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.111
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.104
NEC for r=1.0 class 0 = 0.326 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 1 = 0.278 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 2 = 0.319 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 3 = 0.332 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 4 = 0.271 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 5 = 0.306 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 6 = 0.322 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 7 = 0.277 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 8 = 0.336 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 9 = 0.308 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all KL = 0.156 +- 0.120 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all L1 = 0.307 +- 0.111 (in-sample avg dev_std = 0.195)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 02:39:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:39:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9963
Train Loss: 0.0186
ID Validation ACCURACY: 0.9024
ID Validation Loss: 0.3689
ID Test ACCURACY: 0.8943
ID Test Loss: 0.3879
OOD Validation ACCURACY: 0.7684
OOD Validation Loss: 1.1007
OOD Test ACCURACY: 0.2260
OOD Test Loss: 9.0623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9678
Train Loss: 0.0984
ID Validation ACCURACY: 0.8944
ID Validation Loss: 0.3490
ID Test ACCURACY: 0.8911
ID Test Loss: 0.3528
OOD Validation ACCURACY: 0.8507
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4251
OOD Test Loss: 4.1270

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.2260 0.8911 0.4251 0.8944 0.8507[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.611 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 1 = 0.608 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 2 = 0.586 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 3 = 0.6 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 4 = 0.626 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 5 = 0.587 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 6 = 0.606 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 7 = 0.628 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 8 = 0.59 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 class 9 = 0.597 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 all KL = 0.703 +- 0.192 (in-sample avg dev_std = 0.406)
SUFF++ for r=0.3 all L1 = 0.604 +- 0.110 (in-sample avg dev_std = 0.406)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.111
SUFF++ for r=0.6 class 0 = 0.719 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 1 = 0.647 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 2 = 0.694 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 3 = 0.718 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 4 = 0.701 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 5 = 0.698 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 6 = 0.69 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 7 = 0.692 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 8 = 0.701 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 9 = 0.66 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 all KL = 0.837 +- 0.171 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 all L1 = 0.692 +- 0.157 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.138
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.129
SUFF++ for r=0.9 class 0 = 0.822 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 1 = 0.752 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 2 = 0.798 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 3 = 0.809 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 4 = 0.807 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 5 = 0.811 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 6 = 0.793 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 7 = 0.8 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 8 = 0.769 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 class 9 = 0.777 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 all KL = 0.908 +- 0.113 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.119 (in-sample avg dev_std = 0.206)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.099
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.611 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 1 = 0.626 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 2 = 0.604 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 3 = 0.607 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 4 = 0.592 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 5 = 0.598 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 6 = 0.621 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 7 = 0.614 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 8 = 0.605 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 class 9 = 0.589 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 all KL = 0.724 +- 0.179 (in-sample avg dev_std = 0.391)
SUFF++ for r=0.3 all L1 = 0.607 +- 0.116 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.106
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.104
SUFF++ for r=0.6 class 0 = 0.73 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 1 = 0.653 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 2 = 0.724 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 3 = 0.728 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 4 = 0.703 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 5 = 0.72 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 6 = 0.719 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 7 = 0.736 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 8 = 0.69 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 9 = 0.707 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 all KL = 0.854 +- 0.154 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 all L1 = 0.71 +- 0.150 (in-sample avg dev_std = 0.155)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.129
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.134
SUFF++ for r=0.9 class 0 = 0.813 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 1 = 0.786 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 2 = 0.817 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 3 = 0.793 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 4 = 0.795 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 5 = 0.796 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 6 = 0.783 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 7 = 0.803 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 8 = 0.802 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 class 9 = 0.801 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all KL = 0.915 +- 0.098 (in-sample avg dev_std = 0.194)
SUFF++ for r=0.9 all L1 = 0.799 +- 0.121 (in-sample avg dev_std = 0.194)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.597 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1 = 0.612 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 2 = 0.604 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 3 = 0.586 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 4 = 0.634 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 5 = 0.6 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 6 = 0.631 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 7 = 0.612 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 8 = 0.622 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 9 = 0.627 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.722 +- 0.165 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.612 +- 0.130 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.102
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.1
SUFF++ for r=0.6 class 0 = 0.772 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 1 = 0.727 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 2 = 0.776 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 3 = 0.772 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 4 = 0.726 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 5 = 0.781 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 6 = 0.71 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 7 = 0.742 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 8 = 0.709 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 class 9 = 0.691 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 all KL = 0.872 +- 0.148 (in-sample avg dev_std = 0.126)
SUFF++ for r=0.6 all L1 = 0.741 +- 0.166 (in-sample avg dev_std = 0.126)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.1
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.111
SUFF++ for r=0.9 class 0 = 0.849 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 1 = 0.827 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 2 = 0.84 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 3 = 0.835 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 4 = 0.801 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 5 = 0.815 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 6 = 0.783 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 7 = 0.823 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 8 = 0.784 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 class 9 = 0.799 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all KL = 0.923 +- 0.094 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.9 all L1 = 0.816 +- 0.117 (in-sample avg dev_std = 0.178)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.225 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.216 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.232 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 3 = 0.237 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 4 = 0.228 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 5 = 0.246 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 6 = 0.253 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 7 = 0.228 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 8 = 0.208 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 9 = 0.244 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.082 +- 0.071 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.231 +- 0.089 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.114
NEC for r=0.6 class 0 = 0.241 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 1 = 0.328 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 2 = 0.253 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 3 = 0.247 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 4 = 0.264 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 5 = 0.243 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 6 = 0.258 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 7 = 0.249 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 8 = 0.253 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 class 9 = 0.285 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all KL = 0.118 +- 0.113 (in-sample avg dev_std = 0.174)
NEC for r=0.6 all L1 = 0.263 +- 0.120 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.138
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.126
NEC for r=0.9 class 0 = 0.309 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 1 = 0.382 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 2 = 0.345 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 3 = 0.341 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 4 = 0.33 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 5 = 0.32 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 6 = 0.357 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 7 = 0.325 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 8 = 0.365 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 class 9 = 0.358 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 all KL = 0.198 +- 0.134 (in-sample avg dev_std = 0.213)
NEC for r=0.9 all L1 = 0.344 +- 0.135 (in-sample avg dev_std = 0.213)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.159
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.143
NEC for r=1.0 class 0 = 0.336 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 1 = 0.429 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 2 = 0.38 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 3 = 0.346 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 4 = 0.363 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 5 = 0.368 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 6 = 0.377 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 7 = 0.335 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 8 = 0.38 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 class 9 = 0.388 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 all KL = 0.225 +- 0.139 (in-sample avg dev_std = 0.222)
NEC for r=1.0 all L1 = 0.37 +- 0.137 (in-sample avg dev_std = 0.222)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.099
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
NEC for r=0.3 class 0 = 0.238 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 1 = 0.225 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 2 = 0.218 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 3 = 0.226 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 4 = 0.23 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 5 = 0.238 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 6 = 0.216 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 7 = 0.228 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 8 = 0.22 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 class 9 = 0.228 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all KL = 0.078 +- 0.067 (in-sample avg dev_std = 0.161)
NEC for r=0.3 all L1 = 0.227 +- 0.083 (in-sample avg dev_std = 0.161)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.106
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.103
NEC for r=0.6 class 0 = 0.25 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 1 = 0.299 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 2 = 0.238 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 3 = 0.222 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 4 = 0.271 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 5 = 0.257 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 6 = 0.28 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 7 = 0.223 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 8 = 0.267 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 9 = 0.263 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all KL = 0.118 +- 0.128 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all L1 = 0.257 +- 0.121 (in-sample avg dev_std = 0.175)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.129
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 0 = 0.322 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 1 = 0.35 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 2 = 0.297 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 3 = 0.339 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 4 = 0.345 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 5 = 0.324 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 6 = 0.326 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 7 = 0.328 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 8 = 0.332 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 class 9 = 0.319 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 all KL = 0.186 +- 0.130 (in-sample avg dev_std = 0.212)
NEC for r=0.9 all L1 = 0.329 +- 0.136 (in-sample avg dev_std = 0.212)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.123
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.123
NEC for r=1.0 class 0 = 0.338 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 1 = 0.394 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 2 = 0.32 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 3 = 0.36 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 4 = 0.364 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 5 = 0.341 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 6 = 0.349 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 7 = 0.336 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 8 = 0.37 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 class 9 = 0.341 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 all KL = 0.209 +- 0.138 (in-sample avg dev_std = 0.215)
NEC for r=1.0 all L1 = 0.352 +- 0.137 (in-sample avg dev_std = 0.215)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.089
NEC for r=0.3 class 0 = 0.242 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 1 = 0.246 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 2 = 0.234 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 3 = 0.235 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 4 = 0.24 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 5 = 0.232 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 6 = 0.222 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 7 = 0.243 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 8 = 0.246 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 class 9 = 0.245 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all KL = 0.088 +- 0.065 (in-sample avg dev_std = 0.171)
NEC for r=0.3 all L1 = 0.239 +- 0.086 (in-sample avg dev_std = 0.171)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.102
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
NEC for r=0.6 class 0 = 0.194 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 1 = 0.229 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 2 = 0.21 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 3 = 0.213 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 4 = 0.25 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 5 = 0.207 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 6 = 0.251 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 7 = 0.224 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 8 = 0.26 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 class 9 = 0.28 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 all KL = 0.103 +- 0.102 (in-sample avg dev_std = 0.168)
NEC for r=0.6 all L1 = 0.231 +- 0.127 (in-sample avg dev_std = 0.168)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.1
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.102
NEC for r=0.9 class 0 = 0.261 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 1 = 0.274 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 2 = 0.292 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 3 = 0.288 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 4 = 0.325 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 5 = 0.296 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 6 = 0.341 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 7 = 0.318 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 8 = 0.343 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 class 9 = 0.323 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all KL = 0.168 +- 0.124 (in-sample avg dev_std = 0.189)
NEC for r=0.9 all L1 = 0.306 +- 0.140 (in-sample avg dev_std = 0.189)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.12
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.102
NEC for r=1.0 class 0 = 0.318 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 1 = 0.301 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 2 = 0.358 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 3 = 0.35 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 4 = 0.37 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 5 = 0.334 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 6 = 0.381 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 7 = 0.34 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 8 = 0.399 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 class 9 = 0.355 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 all KL = 0.214 +- 0.153 (in-sample avg dev_std = 0.216)
NEC for r=1.0 all L1 = 0.35 +- 0.153 (in-sample avg dev_std = 0.216)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 02:57:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 02:57:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9887
Train Loss: 0.0440
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3320
ID Test ACCURACY: 0.8973
ID Test Loss: 0.3462
OOD Validation ACCURACY: 0.8349
OOD Validation Loss: 0.6000
OOD Test ACCURACY: 0.1817
OOD Test Loss: 8.6120

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ACCURACY: 0.9903
Train Loss: 0.0361
ID Validation ACCURACY: 0.8993
ID Validation Loss: 0.3593
ID Test ACCURACY: 0.8969
ID Test Loss: 0.3503
OOD Validation ACCURACY: 0.8654
OOD Validation Loss: 0.5113
OOD Test ACCURACY: 0.2991
OOD Test Loss: 11.3961

[0m[1;37mINFO[0m: [1mChartInfo 0.8973 0.1817 0.8969 0.2991 0.8993 0.8654[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.695 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 1 = 0.647 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 2 = 0.709 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 3 = 0.691 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 4 = 0.665 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 5 = 0.699 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 6 = 0.671 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 7 = 0.694 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 8 = 0.676 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 class 9 = 0.654 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 all KL = 0.843 +- 0.114 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.3 all L1 = 0.68 +- 0.088 (in-sample avg dev_std = 0.218)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
SUFF++ for r=0.6 class 0 = 0.651 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 1 = 0.597 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 2 = 0.656 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 3 = 0.663 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 4 = 0.609 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 5 = 0.625 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 6 = 0.615 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 7 = 0.635 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 8 = 0.654 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 class 9 = 0.61 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 all KL = 0.788 +- 0.156 (in-sample avg dev_std = 0.224)
SUFF++ for r=0.6 all L1 = 0.632 +- 0.119 (in-sample avg dev_std = 0.224)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.198
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.183
SUFF++ for r=0.9 class 0 = 0.66 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 1 = 0.659 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 2 = 0.589 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 3 = 0.6 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 4 = 0.596 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 5 = 0.614 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 6 = 0.611 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 7 = 0.618 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 8 = 0.526 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 class 9 = 0.624 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 all KL = 0.686 +- 0.225 (in-sample avg dev_std = 0.342)
SUFF++ for r=0.9 all L1 = 0.61 +- 0.166 (in-sample avg dev_std = 0.342)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.709 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 1 = 0.652 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 2 = 0.701 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 3 = 0.71 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 4 = 0.684 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 5 = 0.698 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 6 = 0.681 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 7 = 0.687 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 8 = 0.682 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 class 9 = 0.662 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 all KL = 0.847 +- 0.112 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.3 all L1 = 0.686 +- 0.090 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.12
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
SUFF++ for r=0.6 class 0 = 0.646 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 1 = 0.589 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 2 = 0.654 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 3 = 0.664 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 4 = 0.647 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 5 = 0.658 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 6 = 0.64 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 7 = 0.639 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 8 = 0.64 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 class 9 = 0.598 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 all KL = 0.793 +- 0.157 (in-sample avg dev_std = 0.219)
SUFF++ for r=0.6 all L1 = 0.637 +- 0.117 (in-sample avg dev_std = 0.219)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.161
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.162
SUFF++ for r=0.9 class 0 = 0.642 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 1 = 0.671 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 2 = 0.576 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 3 = 0.589 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 4 = 0.608 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 5 = 0.583 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 6 = 0.585 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 7 = 0.599 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 8 = 0.577 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 9 = 0.648 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all KL = 0.683 +- 0.219 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all L1 = 0.609 +- 0.169 (in-sample avg dev_std = 0.335)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.091
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
SUFF++ for r=0.3 class 0 = 0.722 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 1 = 0.684 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 2 = 0.717 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 3 = 0.705 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 4 = 0.689 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 5 = 0.702 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 6 = 0.707 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 7 = 0.705 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 8 = 0.691 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 class 9 = 0.686 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 all KL = 0.874 +- 0.079 (in-sample avg dev_std = 0.181)
SUFF++ for r=0.3 all L1 = 0.701 +- 0.075 (in-sample avg dev_std = 0.181)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.127
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.115
SUFF++ for r=0.6 class 0 = 0.702 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 1 = 0.636 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 2 = 0.677 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 3 = 0.664 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 4 = 0.651 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 5 = 0.677 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 6 = 0.666 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 7 = 0.676 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 8 = 0.656 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 9 = 0.633 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 all KL = 0.836 +- 0.133 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 all L1 = 0.664 +- 0.114 (in-sample avg dev_std = 0.180)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.165
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.165
SUFF++ for r=0.9 class 0 = 0.61 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 1 = 0.708 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 2 = 0.597 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 3 = 0.586 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 4 = 0.595 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 5 = 0.575 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 6 = 0.599 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 7 = 0.641 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 8 = 0.581 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 class 9 = 0.605 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 all KL = 0.711 +- 0.203 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.9 all L1 = 0.611 +- 0.162 (in-sample avg dev_std = 0.302)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.096
NEC for r=0.3 class 0 = 0.273 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 1 = 0.287 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 2 = 0.257 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 3 = 0.267 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 4 = 0.279 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 5 = 0.255 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 6 = 0.267 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 7 = 0.278 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 8 = 0.267 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 class 9 = 0.271 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all KL = 0.091 +- 0.077 (in-sample avg dev_std = 0.114)
NEC for r=0.3 all L1 = 0.271 +- 0.090 (in-sample avg dev_std = 0.114)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.116
NEC for r=0.6 class 0 = 0.413 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 1 = 0.405 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 2 = 0.405 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 3 = 0.391 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 4 = 0.42 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 5 = 0.39 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 6 = 0.421 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 7 = 0.407 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 8 = 0.392 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 class 9 = 0.416 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 all KL = 0.268 +- 0.197 (in-sample avg dev_std = 0.197)
NEC for r=0.6 all L1 = 0.406 +- 0.145 (in-sample avg dev_std = 0.197)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.198
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.183
NEC for r=0.9 class 0 = 0.417 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 1 = 0.424 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 2 = 0.478 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 3 = 0.474 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 4 = 0.494 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 5 = 0.477 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 6 = 0.511 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 7 = 0.49 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 8 = 0.514 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 class 9 = 0.501 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all KL = 0.428 +- 0.266 (in-sample avg dev_std = 0.299)
NEC for r=0.9 all L1 = 0.477 +- 0.185 (in-sample avg dev_std = 0.299)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.222
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.203
NEC for r=1.0 class 0 = 0.4 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 1 = 0.357 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 2 = 0.483 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 3 = 0.514 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 4 = 0.524 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 5 = 0.49 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 6 = 0.517 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 7 = 0.498 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 8 = 0.525 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 class 9 = 0.515 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 all KL = 0.443 +- 0.265 (in-sample avg dev_std = 0.315)
NEC for r=1.0 all L1 = 0.48 +- 0.188 (in-sample avg dev_std = 0.315)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
NEC for r=0.3 class 0 = 0.274 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 1 = 0.275 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 2 = 0.268 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 3 = 0.251 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 4 = 0.262 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 5 = 0.253 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 6 = 0.281 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 7 = 0.266 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 8 = 0.272 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 class 9 = 0.268 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 all KL = 0.088 +- 0.078 (in-sample avg dev_std = 0.115)
NEC for r=0.3 all L1 = 0.267 +- 0.089 (in-sample avg dev_std = 0.115)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.12
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.114
NEC for r=0.6 class 0 = 0.419 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 1 = 0.415 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 2 = 0.385 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 3 = 0.383 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 4 = 0.362 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 5 = 0.386 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 6 = 0.387 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 7 = 0.385 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 8 = 0.411 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 class 9 = 0.394 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all KL = 0.254 +- 0.198 (in-sample avg dev_std = 0.190)
NEC for r=0.6 all L1 = 0.393 +- 0.143 (in-sample avg dev_std = 0.190)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.161
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.166
NEC for r=0.9 class 0 = 0.451 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 1 = 0.46 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 2 = 0.479 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 3 = 0.481 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 4 = 0.45 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 5 = 0.49 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 6 = 0.511 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 7 = 0.456 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 8 = 0.515 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 9 = 0.484 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all KL = 0.428 +- 0.268 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all L1 = 0.477 +- 0.186 (in-sample avg dev_std = 0.298)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.185
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.189
NEC for r=1.0 class 0 = 0.449 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 1 = 0.412 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 2 = 0.499 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 3 = 0.527 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 4 = 0.485 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 5 = 0.49 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 6 = 0.55 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 7 = 0.501 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 8 = 0.516 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 9 = 0.52 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 all KL = 0.466 +- 0.273 (in-sample avg dev_std = 0.318)
NEC for r=1.0 all L1 = 0.494 +- 0.195 (in-sample avg dev_std = 0.318)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.091
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.248 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 1 = 0.281 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 2 = 0.252 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 3 = 0.26 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 4 = 0.278 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 5 = 0.261 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 6 = 0.272 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 7 = 0.27 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 8 = 0.273 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 class 9 = 0.261 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 all KL = 0.086 +- 0.066 (in-sample avg dev_std = 0.113)
NEC for r=0.3 all L1 = 0.266 +- 0.087 (in-sample avg dev_std = 0.113)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.127
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.106
NEC for r=0.6 class 0 = 0.384 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 1 = 0.376 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 2 = 0.365 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 3 = 0.375 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 4 = 0.404 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 5 = 0.377 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 6 = 0.401 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 7 = 0.367 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 8 = 0.396 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 9 = 0.402 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.217 +- 0.165 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.384 +- 0.130 (in-sample avg dev_std = 0.166)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.165
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.17
NEC for r=0.9 class 0 = 0.435 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 1 = 0.367 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 2 = 0.468 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 3 = 0.481 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 4 = 0.464 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 5 = 0.449 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 6 = 0.464 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 7 = 0.444 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 8 = 0.471 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 class 9 = 0.463 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 all KL = 0.363 +- 0.228 (in-sample avg dev_std = 0.281)
NEC for r=0.9 all L1 = 0.45 +- 0.168 (in-sample avg dev_std = 0.281)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.18
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.175
NEC for r=1.0 class 0 = 0.429 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 1 = 0.312 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 2 = 0.469 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 3 = 0.476 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 4 = 0.483 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 5 = 0.428 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 6 = 0.475 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 7 = 0.414 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 8 = 0.46 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 9 = 0.451 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all KL = 0.376 +- 0.242 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all L1 = 0.438 +- 0.191 (in-sample avg dev_std = 0.292)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.783, 0.851, 0.927, 1.0], 'all_L1': [0.751, 0.692, 0.812, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.734, 0.679, 0.731, 1.0], 'all_L1': [0.656, 0.584, 0.621, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.826, 0.886, 0.922, 1.0], 'all_L1': [0.68, 0.708, 0.797, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.703, 0.837, 0.908, 1.0], 'all_L1': [0.604, 0.692, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.843, 0.788, 0.686, 1.0], 'all_L1': [0.68, 0.632, 0.61, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.046, 0.105, 0.176, 0.207], 'all_L1': [0.163, 0.261, 0.328, 0.348]}), defaultdict(<class 'list'>, {'all_KL': [0.095, 0.207, 0.271, 0.311], 'all_L1': [0.225, 0.353, 0.413, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.083, 0.166, 0.19], 'all_L1': [0.261, 0.257, 0.338, 0.347]}), defaultdict(<class 'list'>, {'all_KL': [0.082, 0.118, 0.198, 0.225], 'all_L1': [0.231, 0.263, 0.344, 0.37]}), defaultdict(<class 'list'>, {'all_KL': [0.091, 0.268, 0.428, 0.443], 'all_L1': [0.271, 0.406, 0.477, 0.48]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.803, 0.855, 0.93, 1.0], 'all_L1': [0.755, 0.697, 0.815, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.683, 0.731, 1.0], 'all_L1': [0.666, 0.591, 0.624, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.829, 0.89, 0.924, 1.0], 'all_L1': [0.681, 0.712, 0.795, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.724, 0.854, 0.915, 1.0], 'all_L1': [0.607, 0.71, 0.799, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.847, 0.793, 0.683, 1.0], 'all_L1': [0.686, 0.637, 0.609, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.046, 0.105, 0.18, 0.213], 'all_L1': [0.162, 0.258, 0.331, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.106, 0.217, 0.29, 0.317], 'all_L1': [0.234, 0.358, 0.421, 0.441]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.082, 0.164, 0.187], 'all_L1': [0.259, 0.252, 0.335, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.118, 0.186, 0.209], 'all_L1': [0.227, 0.257, 0.329, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.254, 0.428, 0.466], 'all_L1': [0.267, 0.393, 0.477, 0.494]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.778, 0.854, 0.932, 1.0], 'all_L1': [0.737, 0.695, 0.818, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.678, 0.739, 0.763, 1.0], 'all_L1': [0.601, 0.622, 0.683, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.852, 0.884, 0.937, 1.0], 'all_L1': [0.714, 0.708, 0.815, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.722, 0.872, 0.923, 1.0], 'all_L1': [0.612, 0.741, 0.816, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.874, 0.836, 0.711, 1.0], 'all_L1': [0.701, 0.664, 0.611, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.042, 0.11, 0.19, 0.198], 'all_L1': [0.157, 0.27, 0.336, 0.33]}), defaultdict(<class 'list'>, {'all_KL': [0.167, 0.277, 0.355, 0.372], 'all_L1': [0.25, 0.376, 0.434, 0.44]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.084, 0.145, 0.156], 'all_L1': [0.208, 0.252, 0.312, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.103, 0.168, 0.214], 'all_L1': [0.239, 0.231, 0.306, 0.35]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.217, 0.363, 0.376], 'all_L1': [0.266, 0.384, 0.45, 0.438]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.674 +- 0.047, 0.662 +- 0.047, 0.727 +- 0.091, 1.000 +- 0.000
suff++ class all_KL  =  0.778 +- 0.053, 0.808 +- 0.072, 0.835 +- 0.104, 1.000 +- 0.000
suff++_acc_int  =  0.102 +- 0.008, 0.107 +- 0.009, 0.131 +- 0.027
nec class all_L1  =  0.230 +- 0.038, 0.308 +- 0.061, 0.380 +- 0.057, 0.397 +- 0.054
nec class all_KL  =  0.080 +- 0.018, 0.156 +- 0.070, 0.248 +- 0.097, 0.275 +- 0.094
nec_acc_int  =  0.099 +- 0.005, 0.108 +- 0.006, 0.130 +- 0.028, 0.145 +- 0.031

Eval split id_test
suff++ class all_L1  =  0.679 +- 0.047, 0.669 +- 0.048, 0.728 +- 0.092, 1.000 +- 0.000
suff++ class all_KL  =  0.793 +- 0.045, 0.815 +- 0.073, 0.837 +- 0.107, 1.000 +- 0.000
suff++_acc_int  =  0.100 +- 0.006, 0.104 +- 0.010, 0.122 +- 0.024
nec class all_L1  =  0.230 +- 0.037, 0.304 +- 0.060, 0.379 +- 0.060, 0.397 +- 0.060
nec class all_KL  =  0.081 +- 0.020, 0.155 +- 0.068, 0.250 +- 0.100, 0.278 +- 0.104
nec_acc_int  =  0.099 +- 0.003, 0.105 +- 0.006, 0.119 +- 0.025, 0.128 +- 0.031

Eval split test
suff++ class all_L1  =  0.673 +- 0.056, 0.686 +- 0.040, 0.749 +- 0.086, 1.000 +- 0.000
suff++ class all_KL  =  0.781 +- 0.075, 0.837 +- 0.052, 0.853 +- 0.096, 1.000 +- 0.000
suff++_acc_int  =  0.099 +- 0.005, 0.105 +- 0.007, 0.123 +- 0.021
nec class all_L1  =  0.224 +- 0.038, 0.303 +- 0.064, 0.368 +- 0.062, 0.373 +- 0.056
nec class all_KL  =  0.088 +- 0.043, 0.158 +- 0.075, 0.244 +- 0.095, 0.263 +- 0.092
nec_acc_int  =  0.099 +- 0.009, 0.103 +- 0.004, 0.123 +- 0.025, 0.130 +- 0.027


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.452 +- 0.021, 0.485 +- 0.018, 0.553 +- 0.021, 0.699 +- 0.027
Faith. Armon (L1)= 		  =  0.340 +- 0.042, 0.414 +- 0.046, 0.491 +- 0.024, 0.566 +- 0.054
Faith. GMean (L1)= 	  =  0.392 +- 0.030, 0.448 +- 0.031, 0.521 +- 0.011, 0.629 +- 0.042
Faith. Aritm (KL)= 		  =  0.429 +- 0.028, 0.482 +- 0.027, 0.541 +- 0.021, 0.638 +- 0.047
Faith. Armon (KL)= 		  =  0.145 +- 0.030, 0.253 +- 0.092, 0.365 +- 0.090, 0.424 +- 0.109
Faith. GMean (KL)= 	  =  0.248 +- 0.031, 0.344 +- 0.067, 0.441 +- 0.054, 0.518 +- 0.085

Eval split id_test
Faith. Aritm (L1)= 		  =  0.454 +- 0.021, 0.486 +- 0.015, 0.554 +- 0.018, 0.698 +- 0.030
Faith. Armon (L1)= 		  =  0.341 +- 0.042, 0.412 +- 0.046, 0.489 +- 0.026, 0.565 +- 0.060
Faith. GMean (L1)= 	  =  0.393 +- 0.029, 0.447 +- 0.030, 0.520 +- 0.010, 0.628 +- 0.047
Faith. Aritm (KL)= 		  =  0.437 +- 0.024, 0.485 +- 0.023, 0.543 +- 0.017, 0.639 +- 0.052
Faith. Armon (KL)= 		  =  0.146 +- 0.033, 0.252 +- 0.090, 0.366 +- 0.093, 0.426 +- 0.120
Faith. GMean (KL)= 	  =  0.251 +- 0.033, 0.344 +- 0.064, 0.442 +- 0.054, 0.519 +- 0.093

Eval split test
Faith. Aritm (L1)= 		  =  0.449 +- 0.022, 0.494 +- 0.016, 0.558 +- 0.015, 0.686 +- 0.028
Faith. Armon (L1)= 		  =  0.333 +- 0.042, 0.414 +- 0.054, 0.484 +- 0.035, 0.541 +- 0.059
Faith. GMean (L1)= 	  =  0.385 +- 0.029, 0.452 +- 0.036, 0.519 +- 0.016, 0.609 +- 0.045
Faith. Aritm (KL)= 		  =  0.434 +- 0.029, 0.498 +- 0.017, 0.549 +- 0.010, 0.632 +- 0.046
Faith. Armon (KL)= 		  =  0.154 +- 0.064, 0.256 +- 0.099, 0.363 +- 0.100, 0.408 +- 0.114
Faith. GMean (KL)= 	  =  0.253 +- 0.052, 0.351 +- 0.073, 0.442 +- 0.061, 0.505 +- 0.090
Computed for split load_split = id



Completed in  1:30:59.440881  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 03:17:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:06 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:06 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:17:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9917
Train Loss: 0.0342
ID Validation ACCURACY: 0.9030
ID Validation Loss: 0.3554
ID Test ACCURACY: 0.8977
ID Test Loss: 0.3566
OOD Validation ACCURACY: 0.6509
OOD Validation Loss: 1.9396
OOD Test ACCURACY: 0.1920
OOD Test Loss: 25.9760

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9463
Train Loss: 0.1598
ID Validation ACCURACY: 0.8917
ID Validation Loss: 0.3385
ID Test ACCURACY: 0.8883
ID Test Loss: 0.3449
OOD Validation ACCURACY: 0.8716
OOD Validation Loss: 0.4236
OOD Test ACCURACY: 0.6193
OOD Test Loss: 1.4332

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.1920 0.8883 0.6193 0.8917 0.8716[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.733 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 1 = 0.674 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 2 = 0.767 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 3 = 0.764 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 4 = 0.703 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 5 = 0.725 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 6 = 0.731 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 7 = 0.699 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 8 = 0.725 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 class 9 = 0.702 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 all KL = 0.855 +- 0.148 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.3 all L1 = 0.722 +- 0.159 (in-sample avg dev_std = 0.164)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
SUFF++ for r=0.6 class 0 = 0.512 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 1 = 0.547 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 2 = 0.449 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 3 = 0.478 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 4 = 0.434 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 5 = 0.475 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 6 = 0.451 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 7 = 0.511 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 8 = 0.432 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 class 9 = 0.467 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 all KL = 0.526 +- 0.226 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.6 all L1 = 0.477 +- 0.149 (in-sample avg dev_std = 0.344)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.382
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.347
SUFF++ for r=0.9 class 0 = 0.732 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 1 = 0.678 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 2 = 0.703 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 3 = 0.71 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 4 = 0.647 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 5 = 0.677 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 6 = 0.678 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 7 = 0.675 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 8 = 0.72 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 9 = 0.631 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all KL = 0.766 +- 0.203 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all L1 = 0.686 +- 0.174 (in-sample avg dev_std = 0.304)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.106
SUFF++ for r=0.3 class 0 = 0.736 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 1 = 0.658 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 2 = 0.731 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 3 = 0.741 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 4 = 0.705 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 5 = 0.733 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 6 = 0.746 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 7 = 0.753 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 8 = 0.754 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 class 9 = 0.734 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 all KL = 0.857 +- 0.149 (in-sample avg dev_std = 0.170)
SUFF++ for r=0.3 all L1 = 0.728 +- 0.165 (in-sample avg dev_std = 0.170)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
SUFF++ for r=0.6 class 0 = 0.497 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 1 = 0.519 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 2 = 0.472 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 3 = 0.463 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 4 = 0.432 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 5 = 0.455 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 6 = 0.448 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 7 = 0.461 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 8 = 0.445 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 class 9 = 0.446 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 all KL = 0.514 +- 0.219 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.6 all L1 = 0.465 +- 0.136 (in-sample avg dev_std = 0.365)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.398
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.339
SUFF++ for r=0.9 class 0 = 0.743 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 1 = 0.708 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 2 = 0.709 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 3 = 0.737 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 4 = 0.65 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 5 = 0.693 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 6 = 0.657 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 7 = 0.691 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 8 = 0.706 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 class 9 = 0.688 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all KL = 0.784 +- 0.194 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.9 all L1 = 0.698 +- 0.171 (in-sample avg dev_std = 0.294)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.1
SUFF++ for r=0.3 class 0 = 0.84 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 1 = 0.733 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 2 = 0.83 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 3 = 0.813 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 4 = 0.782 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 5 = 0.834 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 6 = 0.801 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 7 = 0.798 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 8 = 0.807 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 class 9 = 0.748 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 all KL = 0.883 +- 0.125 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.3 all L1 = 0.798 +- 0.143 (in-sample avg dev_std = 0.155)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.101
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.095
SUFF++ for r=0.6 class 0 = 0.559 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 1 = 0.562 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 2 = 0.522 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 3 = 0.514 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 4 = 0.535 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 5 = 0.518 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 6 = 0.541 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 7 = 0.557 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 8 = 0.55 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 class 9 = 0.52 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 all KL = 0.603 +- 0.252 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.6 all L1 = 0.538 +- 0.180 (in-sample avg dev_std = 0.260)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.114
SUFF++ for r=0.9 class 0 = 0.778 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 1 = 0.798 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 2 = 0.769 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 3 = 0.793 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 4 = 0.785 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 5 = 0.782 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 6 = 0.758 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 7 = 0.805 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 8 = 0.783 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 class 9 = 0.786 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all KL = 0.856 +- 0.194 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.9 all L1 = 0.784 +- 0.175 (in-sample avg dev_std = 0.269)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.109
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
NEC for r=0.3 class 0 = 0.282 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 1 = 0.313 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 2 = 0.227 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 3 = 0.245 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 4 = 0.291 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 5 = 0.271 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 6 = 0.261 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 7 = 0.274 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 8 = 0.262 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 class 9 = 0.285 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all KL = 0.133 +- 0.133 (in-sample avg dev_std = 0.131)
NEC for r=0.3 all L1 = 0.271 +- 0.160 (in-sample avg dev_std = 0.131)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.134
NEC for r=0.6 class 0 = 0.381 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 1 = 0.397 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 2 = 0.39 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 3 = 0.404 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 4 = 0.411 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 5 = 0.386 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 6 = 0.432 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 7 = 0.372 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 8 = 0.432 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 class 9 = 0.435 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 all KL = 0.274 +- 0.159 (in-sample avg dev_std = 0.243)
NEC for r=0.6 all L1 = 0.403 +- 0.130 (in-sample avg dev_std = 0.243)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.382
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.256
NEC for r=0.9 class 0 = 0.565 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 1 = 0.513 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 2 = 0.478 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 3 = 0.48 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 4 = 0.532 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 5 = 0.523 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 6 = 0.547 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 7 = 0.524 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 8 = 0.505 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 class 9 = 0.607 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 all KL = 0.548 +- 0.250 (in-sample avg dev_std = 0.373)
NEC for r=0.9 all L1 = 0.526 +- 0.173 (in-sample avg dev_std = 0.373)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.586
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.422
NEC for r=1.0 class 0 = 0.473 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 1 = 0.448 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 2 = 0.443 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 3 = 0.498 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 4 = 0.552 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 5 = 0.561 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 6 = 0.527 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 7 = 0.512 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 8 = 0.475 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 class 9 = 0.533 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 all KL = 0.594 +- 0.252 (in-sample avg dev_std = 0.424)
NEC for r=1.0 all L1 = 0.5 +- 0.201 (in-sample avg dev_std = 0.424)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.257 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 1 = 0.329 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 2 = 0.255 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 3 = 0.251 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 4 = 0.295 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 5 = 0.276 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 6 = 0.257 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 7 = 0.246 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 8 = 0.234 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 class 9 = 0.258 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 all KL = 0.134 +- 0.141 (in-sample avg dev_std = 0.140)
NEC for r=0.3 all L1 = 0.267 +- 0.164 (in-sample avg dev_std = 0.140)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
NEC for r=0.6 class 0 = 0.382 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 1 = 0.422 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 2 = 0.38 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 3 = 0.403 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 4 = 0.394 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 5 = 0.389 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 6 = 0.437 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 7 = 0.396 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 8 = 0.431 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 class 9 = 0.421 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all KL = 0.271 +- 0.157 (in-sample avg dev_std = 0.251)
NEC for r=0.6 all L1 = 0.406 +- 0.125 (in-sample avg dev_std = 0.251)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.398
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.235
NEC for r=0.9 class 0 = 0.551 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 1 = 0.516 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 2 = 0.504 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 3 = 0.466 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 4 = 0.565 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 5 = 0.506 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 6 = 0.56 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 7 = 0.525 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 8 = 0.506 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 9 = 0.578 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 all KL = 0.544 +- 0.237 (in-sample avg dev_std = 0.375)
NEC for r=0.9 all L1 = 0.527 +- 0.165 (in-sample avg dev_std = 0.375)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.613
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.413
NEC for r=1.0 class 0 = 0.478 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 1 = 0.528 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 2 = 0.506 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 3 = 0.509 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 4 = 0.585 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 5 = 0.573 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 6 = 0.579 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 7 = 0.492 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 8 = 0.487 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 class 9 = 0.52 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 all KL = 0.621 +- 0.244 (in-sample avg dev_std = 0.434)
NEC for r=1.0 all L1 = 0.525 +- 0.192 (in-sample avg dev_std = 0.434)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.1
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
NEC for r=0.3 class 0 = 0.132 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 1 = 0.242 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 2 = 0.136 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 3 = 0.154 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 4 = 0.191 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 5 = 0.152 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 6 = 0.181 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 7 = 0.168 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 8 = 0.185 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 class 9 = 0.245 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 all KL = 0.094 +- 0.127 (in-sample avg dev_std = 0.117)
NEC for r=0.3 all L1 = 0.179 +- 0.158 (in-sample avg dev_std = 0.117)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.101
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
NEC for r=0.6 class 0 = 0.385 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 1 = 0.366 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 2 = 0.381 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 3 = 0.391 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 4 = 0.411 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 5 = 0.404 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 6 = 0.432 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 7 = 0.389 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 8 = 0.38 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 9 = 0.414 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all KL = 0.287 +- 0.187 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all L1 = 0.394 +- 0.133 (in-sample avg dev_std = 0.265)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.119
NEC for r=0.9 class 0 = 0.41 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 1 = 0.299 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 2 = 0.375 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 3 = 0.357 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 4 = 0.31 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 5 = 0.376 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 6 = 0.377 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 7 = 0.325 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 8 = 0.386 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 class 9 = 0.344 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 all KL = 0.313 +- 0.246 (in-sample avg dev_std = 0.305)
NEC for r=0.9 all L1 = 0.356 +- 0.210 (in-sample avg dev_std = 0.305)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.16
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.115
NEC for r=1.0 class 0 = 0.493 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 1 = 0.548 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 2 = 0.41 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 3 = 0.4 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 4 = 0.488 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 5 = 0.383 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 6 = 0.474 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 7 = 0.429 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 8 = 0.396 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 9 = 0.524 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 all KL = 0.453 +- 0.317 (in-sample avg dev_std = 0.311)
NEC for r=1.0 all L1 = 0.456 +- 0.254 (in-sample avg dev_std = 0.311)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 03:34:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:37 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:37 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:34:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 159...
[0m[1;37mINFO[0m: [1mCheckpoint 159: 
-----------------------------------
Train ACCURACY: 0.9907
Train Loss: 0.0376
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3687
ID Test ACCURACY: 0.8977
ID Test Loss: 0.3586
OOD Validation ACCURACY: 0.7436
OOD Validation Loss: 1.1650
OOD Test ACCURACY: 0.2021
OOD Test Loss: 31.2864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.9402
Train Loss: 0.1782
ID Validation ACCURACY: 0.8876
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.8846
ID Test Loss: 0.3529
OOD Validation ACCURACY: 0.8666
OOD Validation Loss: 0.4136
OOD Test ACCURACY: 0.6017
OOD Test Loss: 1.3544

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.2021 0.8846 0.6017 0.8876 0.8666[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.634 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 1 = 0.632 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 2 = 0.618 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 3 = 0.636 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 4 = 0.639 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 5 = 0.65 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 6 = 0.629 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 7 = 0.656 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 8 = 0.638 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 class 9 = 0.611 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 all KL = 0.71 +- 0.193 (in-sample avg dev_std = 0.310)
SUFF++ for r=0.3 all L1 = 0.634 +- 0.133 (in-sample avg dev_std = 0.310)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.123
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.131
SUFF++ for r=0.6 class 0 = 0.459 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 1 = 0.426 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 2 = 0.423 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 3 = 0.463 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 4 = 0.427 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 5 = 0.405 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 6 = 0.437 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 7 = 0.457 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 8 = 0.413 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 class 9 = 0.419 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all KL = 0.445 +- 0.238 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.6 all L1 = 0.434 +- 0.152 (in-sample avg dev_std = 0.385)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.403
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.358
SUFF++ for r=0.9 class 0 = 0.853 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 1 = 0.687 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 2 = 0.707 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 3 = 0.728 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 4 = 0.662 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 5 = 0.652 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 6 = 0.714 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 7 = 0.656 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 8 = 0.745 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 class 9 = 0.689 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 all KL = 0.784 +- 0.212 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.9 all L1 = 0.71 +- 0.193 (in-sample avg dev_std = 0.290)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.634 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 1 = 0.614 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 2 = 0.635 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 3 = 0.637 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 4 = 0.658 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 5 = 0.63 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 6 = 0.634 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 7 = 0.626 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 8 = 0.628 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 class 9 = 0.631 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 all KL = 0.708 +- 0.188 (in-sample avg dev_std = 0.302)
SUFF++ for r=0.3 all L1 = 0.632 +- 0.130 (in-sample avg dev_std = 0.302)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.124
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.117
SUFF++ for r=0.6 class 0 = 0.431 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 1 = 0.466 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 2 = 0.449 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 3 = 0.415 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 4 = 0.445 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 5 = 0.429 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 6 = 0.443 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 7 = 0.443 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 8 = 0.409 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 class 9 = 0.419 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all KL = 0.447 +- 0.241 (in-sample avg dev_std = 0.394)
SUFF++ for r=0.6 all L1 = 0.436 +- 0.151 (in-sample avg dev_std = 0.394)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.39
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.356
SUFF++ for r=0.9 class 0 = 0.818 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 1 = 0.713 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 2 = 0.681 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 3 = 0.716 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 4 = 0.677 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 5 = 0.65 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 6 = 0.734 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 7 = 0.671 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 8 = 0.719 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 class 9 = 0.677 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all KL = 0.775 +- 0.222 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.9 all L1 = 0.705 +- 0.196 (in-sample avg dev_std = 0.296)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.71 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 1 = 0.67 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 2 = 0.708 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 3 = 0.707 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 4 = 0.68 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 5 = 0.692 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 6 = 0.661 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 7 = 0.687 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 8 = 0.695 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 class 9 = 0.652 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 all KL = 0.754 +- 0.152 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.3 all L1 = 0.687 +- 0.112 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.132
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.117
SUFF++ for r=0.6 class 0 = 0.539 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 1 = 0.503 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 2 = 0.51 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 3 = 0.551 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 4 = 0.498 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 5 = 0.549 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 6 = 0.51 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 7 = 0.542 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 8 = 0.517 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 9 = 0.479 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 all KL = 0.594 +- 0.224 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 all L1 = 0.519 +- 0.166 (in-sample avg dev_std = 0.271)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.159
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.152
SUFF++ for r=0.9 class 0 = 0.772 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.826 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.835 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 3 = 0.801 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 4 = 0.793 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 5 = 0.817 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 6 = 0.789 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 7 = 0.807 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 8 = 0.803 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 9 = 0.825 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.856 +- 0.191 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.807 +- 0.183 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.252 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 1 = 0.249 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 2 = 0.246 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 3 = 0.264 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 4 = 0.263 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 5 = 0.266 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 6 = 0.265 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 7 = 0.263 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 8 = 0.278 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 class 9 = 0.31 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all KL = 0.153 +- 0.168 (in-sample avg dev_std = 0.157)
NEC for r=0.3 all L1 = 0.265 +- 0.161 (in-sample avg dev_std = 0.157)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.123
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.128
NEC for r=0.6 class 0 = 0.428 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 1 = 0.485 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 2 = 0.435 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 3 = 0.418 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 4 = 0.453 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 5 = 0.454 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 6 = 0.447 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 7 = 0.433 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 8 = 0.417 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 class 9 = 0.472 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all KL = 0.347 +- 0.201 (in-sample avg dev_std = 0.309)
NEC for r=0.6 all L1 = 0.444 +- 0.149 (in-sample avg dev_std = 0.309)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.403
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.288
NEC for r=0.9 class 0 = 0.398 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.497 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.521 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.54 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.576 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.574 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.516 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.541 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.539 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.571 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.59 +- 0.241 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.526 +- 0.188 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.428
NEC for r=1.0 class 0 = 0.248 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 1 = 0.447 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 2 = 0.492 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 3 = 0.523 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 4 = 0.539 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 5 = 0.608 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 6 = 0.497 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 7 = 0.555 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 8 = 0.425 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 class 9 = 0.549 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 all KL = 0.598 +- 0.273 (in-sample avg dev_std = 0.438)
NEC for r=1.0 all L1 = 0.486 +- 0.225 (in-sample avg dev_std = 0.438)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.275 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 1 = 0.285 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 2 = 0.244 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 3 = 0.235 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 4 = 0.264 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 5 = 0.273 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 6 = 0.285 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 7 = 0.231 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 8 = 0.253 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 9 = 0.251 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.15 +- 0.171 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.26 +- 0.156 (in-sample avg dev_std = 0.162)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.124
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 0 = 0.448 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1 = 0.446 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 2 = 0.454 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 3 = 0.429 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 4 = 0.426 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 5 = 0.453 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 6 = 0.432 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 7 = 0.425 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 8 = 0.458 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 9 = 0.438 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.342 +- 0.188 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.441 +- 0.139 (in-sample avg dev_std = 0.304)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.39
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.27
NEC for r=0.9 class 0 = 0.419 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 1 = 0.489 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 2 = 0.528 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 3 = 0.533 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 4 = 0.559 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 5 = 0.593 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 6 = 0.534 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 7 = 0.549 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 8 = 0.529 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 9 = 0.546 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 all KL = 0.593 +- 0.240 (in-sample avg dev_std = 0.430)
NEC for r=0.9 all L1 = 0.527 +- 0.185 (in-sample avg dev_std = 0.430)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.6
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.408
NEC for r=1.0 class 0 = 0.272 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 1 = 0.503 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 2 = 0.542 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 3 = 0.506 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 4 = 0.535 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 5 = 0.604 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 6 = 0.51 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 7 = 0.569 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 8 = 0.432 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 class 9 = 0.56 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all KL = 0.61 +- 0.263 (in-sample avg dev_std = 0.441)
NEC for r=1.0 all L1 = 0.504 +- 0.216 (in-sample avg dev_std = 0.441)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
NEC for r=0.3 class 0 = 0.137 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 1 = 0.179 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 2 = 0.157 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 3 = 0.157 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 4 = 0.194 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 5 = 0.147 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 6 = 0.2 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 7 = 0.186 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 8 = 0.181 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 class 9 = 0.236 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 all KL = 0.089 +- 0.124 (in-sample avg dev_std = 0.121)
NEC for r=0.3 all L1 = 0.177 +- 0.140 (in-sample avg dev_std = 0.121)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.132
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.398 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 1 = 0.427 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 2 = 0.399 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 3 = 0.407 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 4 = 0.436 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 5 = 0.403 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 6 = 0.43 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 7 = 0.394 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 8 = 0.437 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 class 9 = 0.489 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all KL = 0.312 +- 0.183 (in-sample avg dev_std = 0.283)
NEC for r=0.6 all L1 = 0.422 +- 0.141 (in-sample avg dev_std = 0.283)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.159
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.147
NEC for r=0.9 class 0 = 0.339 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 1 = 0.347 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 2 = 0.287 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 3 = 0.331 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 4 = 0.338 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 5 = 0.306 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 6 = 0.337 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 7 = 0.34 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 8 = 0.35 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 class 9 = 0.35 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 all KL = 0.335 +- 0.264 (in-sample avg dev_std = 0.325)
NEC for r=0.9 all L1 = 0.333 +- 0.234 (in-sample avg dev_std = 0.325)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.216
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.17
NEC for r=1.0 class 0 = 0.375 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 1 = 0.505 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 2 = 0.243 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 3 = 0.343 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 4 = 0.339 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 5 = 0.363 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 6 = 0.32 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 7 = 0.363 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 8 = 0.328 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 class 9 = 0.326 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 all KL = 0.351 +- 0.295 (in-sample avg dev_std = 0.298)
NEC for r=1.0 all L1 = 0.351 +- 0.256 (in-sample avg dev_std = 0.298)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 03:52:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:22 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:22 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:22 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:22 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 03:52:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9956
Train Loss: 0.0212
ID Validation ACCURACY: 0.8957
ID Validation Loss: 0.3928
ID Test ACCURACY: 0.8923
ID Test Loss: 0.4032
OOD Validation ACCURACY: 0.6483
OOD Validation Loss: 1.9650
OOD Test ACCURACY: 0.2164
OOD Test Loss: 24.3162

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.9503
Train Loss: 0.1451
ID Validation ACCURACY: 0.8864
ID Validation Loss: 0.3576
ID Test ACCURACY: 0.8821
ID Test Loss: 0.3685
OOD Validation ACCURACY: 0.8701
OOD Validation Loss: 0.4281
OOD Test ACCURACY: 0.4257
OOD Test Loss: 2.7698

[0m[1;37mINFO[0m: [1mChartInfo 0.8923 0.2164 0.8821 0.4257 0.8864 0.8701[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.751 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 1 = 0.686 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 2 = 0.714 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 3 = 0.719 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 4 = 0.689 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 5 = 0.741 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 6 = 0.704 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 7 = 0.728 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 8 = 0.731 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 class 9 = 0.705 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 all KL = 0.785 +- 0.156 (in-sample avg dev_std = 0.284)
SUFF++ for r=0.3 all L1 = 0.716 +- 0.115 (in-sample avg dev_std = 0.284)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.136
SUFF++ for r=0.6 class 0 = 0.475 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 1 = 0.512 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 2 = 0.472 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 3 = 0.441 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 4 = 0.463 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 5 = 0.484 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 6 = 0.498 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 7 = 0.474 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 8 = 0.472 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 class 9 = 0.435 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all KL = 0.465 +- 0.281 (in-sample avg dev_std = 0.346)
SUFF++ for r=0.6 all L1 = 0.473 +- 0.203 (in-sample avg dev_std = 0.346)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.409
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.355
SUFF++ for r=0.9 class 0 = 0.748 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 1 = 0.712 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 2 = 0.645 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 3 = 0.711 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 4 = 0.665 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 5 = 0.635 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 6 = 0.671 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 7 = 0.685 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 8 = 0.739 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 9 = 0.661 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all KL = 0.739 +- 0.242 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all L1 = 0.689 +- 0.211 (in-sample avg dev_std = 0.329)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
SUFF++ for r=0.3 class 0 = 0.746 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 1 = 0.692 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 2 = 0.733 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 3 = 0.745 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 4 = 0.738 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 5 = 0.72 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 6 = 0.698 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 7 = 0.711 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 8 = 0.733 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 9 = 0.705 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all KL = 0.793 +- 0.146 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all L1 = 0.721 +- 0.110 (in-sample avg dev_std = 0.272)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.124
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
SUFF++ for r=0.6 class 0 = 0.521 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 1 = 0.523 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 2 = 0.529 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 3 = 0.474 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 4 = 0.492 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 5 = 0.491 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 6 = 0.445 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 7 = 0.457 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 8 = 0.438 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 class 9 = 0.447 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all KL = 0.482 +- 0.279 (in-sample avg dev_std = 0.339)
SUFF++ for r=0.6 all L1 = 0.482 +- 0.202 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.409
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.364
SUFF++ for r=0.9 class 0 = 0.762 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 1 = 0.714 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 2 = 0.662 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 3 = 0.733 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 4 = 0.65 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 5 = 0.686 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 6 = 0.707 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 7 = 0.641 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 8 = 0.731 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 class 9 = 0.682 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all KL = 0.741 +- 0.243 (in-sample avg dev_std = 0.322)
SUFF++ for r=0.9 all L1 = 0.697 +- 0.205 (in-sample avg dev_std = 0.322)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.087
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.093
SUFF++ for r=0.3 class 0 = 0.655 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 1 = 0.598 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 2 = 0.657 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 3 = 0.677 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 4 = 0.641 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 5 = 0.656 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 6 = 0.667 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 7 = 0.65 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 8 = 0.674 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 class 9 = 0.659 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 all KL = 0.784 +- 0.147 (in-sample avg dev_std = 0.296)
SUFF++ for r=0.3 all L1 = 0.653 +- 0.119 (in-sample avg dev_std = 0.296)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.144
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.126
SUFF++ for r=0.6 class 0 = 0.467 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 1 = 0.642 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 2 = 0.484 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 3 = 0.499 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 4 = 0.562 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 5 = 0.415 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 6 = 0.521 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 7 = 0.532 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 8 = 0.508 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 9 = 0.557 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all KL = 0.543 +- 0.290 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all L1 = 0.521 +- 0.227 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.13
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.125
SUFF++ for r=0.9 class 0 = 0.772 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 1 = 0.704 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 2 = 0.782 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 3 = 0.775 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 4 = 0.769 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 5 = 0.735 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 6 = 0.71 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 7 = 0.702 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 8 = 0.751 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 9 = 0.765 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all KL = 0.805 +- 0.205 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all L1 = 0.746 +- 0.175 (in-sample avg dev_std = 0.305)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.094
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
NEC for r=0.3 class 0 = 0.158 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 1 = 0.233 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 2 = 0.179 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 3 = 0.216 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 4 = 0.187 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 5 = 0.198 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 6 = 0.198 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 7 = 0.173 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 8 = 0.183 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 9 = 0.173 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 all KL = 0.093 +- 0.124 (in-sample avg dev_std = 0.148)
NEC for r=0.3 all L1 = 0.19 +- 0.149 (in-sample avg dev_std = 0.148)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.131
NEC for r=0.6 class 0 = 0.448 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 1 = 0.422 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 2 = 0.468 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 3 = 0.498 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 4 = 0.445 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 5 = 0.458 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 6 = 0.452 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 7 = 0.449 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 8 = 0.485 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 class 9 = 0.524 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 all KL = 0.42 +- 0.229 (in-sample avg dev_std = 0.344)
NEC for r=0.6 all L1 = 0.464 +- 0.178 (in-sample avg dev_std = 0.344)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.409
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.284
NEC for r=0.9 class 0 = 0.542 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 1 = 0.486 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 2 = 0.553 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 3 = 0.506 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 4 = 0.56 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 5 = 0.554 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 6 = 0.553 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 7 = 0.554 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 8 = 0.438 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 class 9 = 0.531 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 all KL = 0.628 +- 0.256 (in-sample avg dev_std = 0.457)
NEC for r=0.9 all L1 = 0.527 +- 0.205 (in-sample avg dev_std = 0.457)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.59
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.418
NEC for r=1.0 class 0 = 0.454 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 1 = 0.387 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 2 = 0.551 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 3 = 0.496 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 4 = 0.511 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 5 = 0.543 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 6 = 0.562 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 7 = 0.574 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 8 = 0.414 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 class 9 = 0.521 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 all KL = 0.64 +- 0.277 (in-sample avg dev_std = 0.475)
NEC for r=1.0 all L1 = 0.5 +- 0.228 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
NEC for r=0.3 class 0 = 0.182 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 1 = 0.217 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 2 = 0.187 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 3 = 0.169 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 4 = 0.182 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 5 = 0.206 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 6 = 0.191 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 7 = 0.196 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 8 = 0.156 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 class 9 = 0.194 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 all KL = 0.088 +- 0.104 (in-sample avg dev_std = 0.148)
NEC for r=0.3 all L1 = 0.189 +- 0.141 (in-sample avg dev_std = 0.148)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.124
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
NEC for r=0.6 class 0 = 0.438 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 1 = 0.438 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 2 = 0.446 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 3 = 0.452 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 4 = 0.436 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 5 = 0.449 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 6 = 0.501 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 7 = 0.445 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 8 = 0.501 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 class 9 = 0.461 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all KL = 0.409 +- 0.218 (in-sample avg dev_std = 0.342)
NEC for r=0.6 all L1 = 0.457 +- 0.172 (in-sample avg dev_std = 0.342)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.409
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.27
NEC for r=0.9 class 0 = 0.57 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 1 = 0.475 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 2 = 0.549 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 3 = 0.493 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 4 = 0.588 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 5 = 0.557 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 6 = 0.527 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 7 = 0.601 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 8 = 0.443 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 9 = 0.553 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 all KL = 0.636 +- 0.256 (in-sample avg dev_std = 0.460)
NEC for r=0.9 all L1 = 0.534 +- 0.202 (in-sample avg dev_std = 0.460)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.591
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.41
NEC for r=1.0 class 0 = 0.447 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 1 = 0.397 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 2 = 0.583 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 3 = 0.521 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 4 = 0.539 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 5 = 0.54 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 6 = 0.56 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 7 = 0.57 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 8 = 0.376 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 class 9 = 0.546 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 all KL = 0.65 +- 0.270 (in-sample avg dev_std = 0.494)
NEC for r=1.0 all L1 = 0.506 +- 0.221 (in-sample avg dev_std = 0.494)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.087
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.09
NEC for r=0.3 class 0 = 0.305 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 1 = 0.354 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 2 = 0.314 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 3 = 0.283 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 4 = 0.345 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 5 = 0.288 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 6 = 0.344 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 7 = 0.316 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 8 = 0.314 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 class 9 = 0.316 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 all KL = 0.171 +- 0.136 (in-sample avg dev_std = 0.239)
NEC for r=0.3 all L1 = 0.318 +- 0.140 (in-sample avg dev_std = 0.239)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.144
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.129
NEC for r=0.6 class 0 = 0.456 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 1 = 0.252 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 2 = 0.44 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 3 = 0.428 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 4 = 0.391 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 5 = 0.499 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 6 = 0.421 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 7 = 0.381 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 8 = 0.405 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 class 9 = 0.358 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 all KL = 0.334 +- 0.208 (in-sample avg dev_std = 0.306)
NEC for r=0.6 all L1 = 0.401 +- 0.186 (in-sample avg dev_std = 0.306)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.13
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.124
NEC for r=0.9 class 0 = 0.387 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 1 = 0.422 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 2 = 0.356 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 3 = 0.383 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 4 = 0.406 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 5 = 0.426 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 6 = 0.448 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 7 = 0.468 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 8 = 0.425 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 class 9 = 0.381 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 all KL = 0.407 +- 0.267 (in-sample avg dev_std = 0.315)
NEC for r=0.9 all L1 = 0.41 +- 0.209 (in-sample avg dev_std = 0.315)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.161
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.128
NEC for r=1.0 class 0 = 0.36 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 1 = 0.505 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 2 = 0.315 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 3 = 0.359 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 4 = 0.346 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 5 = 0.377 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 6 = 0.381 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 7 = 0.404 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 8 = 0.4 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 9 = 0.368 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 all KL = 0.417 +- 0.312 (in-sample avg dev_std = 0.303)
NEC for r=1.0 all L1 = 0.382 +- 0.242 (in-sample avg dev_std = 0.303)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 04:10:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:07 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:07 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:07 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:10:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9893
Train Loss: 0.0383
ID Validation ACCURACY: 0.8997
ID Validation Loss: 0.3603
ID Test ACCURACY: 0.8993
ID Test Loss: 0.3692
OOD Validation ACCURACY: 0.7834
OOD Validation Loss: 0.9575
OOD Test ACCURACY: 0.1697
OOD Test Loss: 13.1371

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 80...
[0m[1;37mINFO[0m: [1mCheckpoint 80: 
-----------------------------------
Train ACCURACY: 0.9168
Train Loss: 0.2523
ID Validation ACCURACY: 0.8734
ID Validation Loss: 0.3772
ID Test ACCURACY: 0.8731
ID Test Loss: 0.3871
OOD Validation ACCURACY: 0.8750
OOD Validation Loss: 0.3865
OOD Test ACCURACY: 0.7521
OOD Test Loss: 0.7865

[0m[1;37mINFO[0m: [1mChartInfo 0.8993 0.1697 0.8731 0.7521 0.8734 0.8750[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.498 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 1 = 0.463 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 2 = 0.448 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 3 = 0.46 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 4 = 0.449 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 5 = 0.488 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 6 = 0.444 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 7 = 0.462 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 8 = 0.469 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 class 9 = 0.444 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 all KL = 0.494 +- 0.238 (in-sample avg dev_std = 0.457)
SUFF++ for r=0.3 all L1 = 0.463 +- 0.123 (in-sample avg dev_std = 0.457)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.16
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.155
SUFF++ for r=0.6 class 0 = 0.477 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 1 = 0.505 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 2 = 0.491 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 3 = 0.501 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 4 = 0.445 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 5 = 0.472 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 6 = 0.525 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 7 = 0.498 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 8 = 0.461 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 class 9 = 0.43 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 all KL = 0.514 +- 0.215 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.6 all L1 = 0.482 +- 0.153 (in-sample avg dev_std = 0.292)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.428
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.374
SUFF++ for r=0.9 class 0 = 0.728 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 1 = 0.84 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 2 = 0.729 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 3 = 0.712 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 4 = 0.625 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 5 = 0.637 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 6 = 0.665 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 7 = 0.696 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 8 = 0.687 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 class 9 = 0.672 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 all KL = 0.762 +- 0.232 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.9 all L1 = 0.703 +- 0.202 (in-sample avg dev_std = 0.300)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
SUFF++ for r=0.3 class 0 = 0.489 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 1 = 0.442 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 2 = 0.442 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 3 = 0.458 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 4 = 0.465 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 5 = 0.484 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 6 = 0.447 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 7 = 0.424 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 8 = 0.452 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 class 9 = 0.458 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all KL = 0.483 +- 0.236 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.3 all L1 = 0.455 +- 0.119 (in-sample avg dev_std = 0.466)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.141
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.125
SUFF++ for r=0.6 class 0 = 0.468 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 1 = 0.523 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 2 = 0.482 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 3 = 0.513 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 4 = 0.489 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 5 = 0.48 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 6 = 0.52 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 7 = 0.502 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 8 = 0.482 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 9 = 0.469 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all KL = 0.532 +- 0.220 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all L1 = 0.494 +- 0.157 (in-sample avg dev_std = 0.300)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.409
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.373
SUFF++ for r=0.9 class 0 = 0.72 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 1 = 0.803 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 2 = 0.668 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 3 = 0.696 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 4 = 0.65 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 5 = 0.701 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 6 = 0.668 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 7 = 0.666 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 8 = 0.717 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 9 = 0.644 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all KL = 0.763 +- 0.220 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all L1 = 0.695 +- 0.190 (in-sample avg dev_std = 0.306)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.097
SUFF++ for r=0.3 class 0 = 0.515 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 1 = 0.521 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 2 = 0.524 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 3 = 0.476 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 4 = 0.494 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 5 = 0.479 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 6 = 0.493 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 7 = 0.492 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 8 = 0.496 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 9 = 0.476 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all KL = 0.576 +- 0.225 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all L1 = 0.497 +- 0.123 (in-sample avg dev_std = 0.456)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.154
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.145
SUFF++ for r=0.6 class 0 = 0.583 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 1 = 0.501 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 2 = 0.526 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 3 = 0.54 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 4 = 0.502 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 5 = 0.556 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 6 = 0.494 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 7 = 0.571 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 8 = 0.538 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 class 9 = 0.481 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 all KL = 0.584 +- 0.241 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.6 all L1 = 0.529 +- 0.177 (in-sample avg dev_std = 0.271)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.145
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.147
SUFF++ for r=0.9 class 0 = 0.729 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 1 = 0.761 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 2 = 0.728 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 3 = 0.746 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 4 = 0.718 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 5 = 0.745 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 6 = 0.731 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 7 = 0.742 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 8 = 0.742 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 class 9 = 0.749 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all KL = 0.801 +- 0.212 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.9 all L1 = 0.739 +- 0.174 (in-sample avg dev_std = 0.301)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.111
NEC for r=0.3 class 0 = 0.432 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 1 = 0.424 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 2 = 0.425 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 3 = 0.436 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 4 = 0.43 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 5 = 0.422 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 6 = 0.418 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 7 = 0.431 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 8 = 0.423 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 class 9 = 0.466 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all KL = 0.29 +- 0.165 (in-sample avg dev_std = 0.248)
NEC for r=0.3 all L1 = 0.431 +- 0.118 (in-sample avg dev_std = 0.248)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.16
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.16
NEC for r=0.6 class 0 = 0.415 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 1 = 0.399 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 2 = 0.399 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 3 = 0.404 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 4 = 0.432 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 5 = 0.433 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 6 = 0.41 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 7 = 0.408 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 8 = 0.449 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 class 9 = 0.486 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all KL = 0.314 +- 0.209 (in-sample avg dev_std = 0.255)
NEC for r=0.6 all L1 = 0.422 +- 0.154 (in-sample avg dev_std = 0.255)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.428
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.309
NEC for r=0.9 class 0 = 0.563 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 1 = 0.286 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 2 = 0.489 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 3 = 0.532 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 4 = 0.555 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 5 = 0.57 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 6 = 0.548 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 7 = 0.514 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 8 = 0.53 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 class 9 = 0.605 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all KL = 0.573 +- 0.258 (in-sample avg dev_std = 0.407)
NEC for r=0.9 all L1 = 0.515 +- 0.199 (in-sample avg dev_std = 0.407)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.598
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.419
NEC for r=1.0 class 0 = 0.475 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 1 = 0.233 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 2 = 0.395 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 3 = 0.556 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 4 = 0.6 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 5 = 0.569 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 6 = 0.574 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 7 = 0.517 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 8 = 0.457 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 class 9 = 0.585 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all KL = 0.59 +- 0.290 (in-sample avg dev_std = 0.425)
NEC for r=1.0 all L1 = 0.491 +- 0.234 (in-sample avg dev_std = 0.425)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
NEC for r=0.3 class 0 = 0.428 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 1 = 0.437 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 2 = 0.437 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 3 = 0.397 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 4 = 0.429 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 5 = 0.432 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 6 = 0.451 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 7 = 0.426 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 8 = 0.413 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 class 9 = 0.438 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 all KL = 0.296 +- 0.178 (in-sample avg dev_std = 0.249)
NEC for r=0.3 all L1 = 0.429 +- 0.125 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.141
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.141
NEC for r=0.6 class 0 = 0.419 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 1 = 0.386 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 2 = 0.419 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 3 = 0.394 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 4 = 0.435 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 5 = 0.429 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 6 = 0.446 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 7 = 0.407 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 8 = 0.435 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 class 9 = 0.439 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all KL = 0.31 +- 0.209 (in-sample avg dev_std = 0.253)
NEC for r=0.6 all L1 = 0.42 +- 0.158 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.409
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.274
NEC for r=0.9 class 0 = 0.574 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 1 = 0.412 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 2 = 0.501 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 3 = 0.527 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 4 = 0.561 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 5 = 0.541 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 6 = 0.544 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 7 = 0.532 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 8 = 0.541 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 class 9 = 0.601 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all KL = 0.593 +- 0.250 (in-sample avg dev_std = 0.419)
NEC for r=0.9 all L1 = 0.531 +- 0.185 (in-sample avg dev_std = 0.419)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.592
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.414
NEC for r=1.0 class 0 = 0.487 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 1 = 0.267 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 2 = 0.432 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 3 = 0.56 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 4 = 0.578 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 5 = 0.591 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 6 = 0.559 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 7 = 0.541 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 8 = 0.483 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 9 = 0.574 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 all KL = 0.611 +- 0.277 (in-sample avg dev_std = 0.442)
NEC for r=1.0 all L1 = 0.503 +- 0.228 (in-sample avg dev_std = 0.442)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
NEC for r=0.3 class 0 = 0.35 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 1 = 0.355 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 2 = 0.352 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 3 = 0.365 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 4 = 0.403 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 5 = 0.37 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 6 = 0.385 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 7 = 0.376 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 8 = 0.38 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 class 9 = 0.397 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all KL = 0.214 +- 0.145 (in-sample avg dev_std = 0.216)
NEC for r=0.3 all L1 = 0.373 +- 0.114 (in-sample avg dev_std = 0.216)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.154
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.153
NEC for r=0.6 class 0 = 0.341 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 1 = 0.383 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 2 = 0.392 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 3 = 0.384 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 4 = 0.448 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 5 = 0.377 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 6 = 0.447 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 7 = 0.367 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 8 = 0.391 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 class 9 = 0.429 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 all KL = 0.277 +- 0.227 (in-sample avg dev_std = 0.235)
NEC for r=0.6 all L1 = 0.395 +- 0.174 (in-sample avg dev_std = 0.235)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.145
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.13
NEC for r=0.9 class 0 = 0.487 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 1 = 0.432 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 2 = 0.495 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 3 = 0.456 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 4 = 0.442 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 5 = 0.473 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 6 = 0.446 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 7 = 0.475 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 8 = 0.449 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 class 9 = 0.46 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 all KL = 0.492 +- 0.274 (in-sample avg dev_std = 0.327)
NEC for r=0.9 all L1 = 0.461 +- 0.207 (in-sample avg dev_std = 0.327)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.162
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.13
NEC for r=1.0 class 0 = 0.509 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 1 = 0.467 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 2 = 0.442 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 3 = 0.468 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 4 = 0.407 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 5 = 0.489 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 6 = 0.405 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 7 = 0.44 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 8 = 0.424 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 class 9 = 0.406 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 all KL = 0.486 +- 0.291 (in-sample avg dev_std = 0.327)
NEC for r=1.0 all L1 = 0.446 +- 0.234 (in-sample avg dev_std = 0.327)
model_dirname= repr_LECIvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 04:27:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:27:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 0.9958
Train Loss: 0.0199
ID Validation ACCURACY: 0.8977
ID Validation Loss: 0.3902
ID Test ACCURACY: 0.8907
ID Test Loss: 0.4054
OOD Validation ACCURACY: 0.7491
OOD Validation Loss: 1.0876
OOD Test ACCURACY: 0.2561
OOD Test Loss: 6.4448

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9602
Train Loss: 0.1199
ID Validation ACCURACY: 0.8884
ID Validation Loss: 0.3418
ID Test ACCURACY: 0.8874
ID Test Loss: 0.3492
OOD Validation ACCURACY: 0.8777
OOD Validation Loss: 0.3919
OOD Test ACCURACY: 0.7451
OOD Test Loss: 0.8314

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.2561 0.8874 0.7451 0.8884 0.8777[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
SUFF++ for r=0.3 class 0 = 0.521 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 1 = 0.529 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 2 = 0.499 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 3 = 0.475 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 4 = 0.49 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 5 = 0.523 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 6 = 0.489 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 7 = 0.481 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 8 = 0.492 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 class 9 = 0.483 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all KL = 0.528 +- 0.239 (in-sample avg dev_std = 0.467)
SUFF++ for r=0.3 all L1 = 0.498 +- 0.108 (in-sample avg dev_std = 0.467)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.148
SUFF++ for r=0.6 class 0 = 0.553 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 1 = 0.594 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 2 = 0.538 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 3 = 0.582 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 4 = 0.537 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 5 = 0.551 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 6 = 0.515 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 7 = 0.535 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 8 = 0.534 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 9 = 0.525 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all KL = 0.639 +- 0.214 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all L1 = 0.547 +- 0.169 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.464
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.421
SUFF++ for r=0.9 class 0 = 0.77 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 1 = 0.832 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 2 = 0.707 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 3 = 0.656 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 4 = 0.662 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 5 = 0.594 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 6 = 0.689 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 7 = 0.693 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 8 = 0.723 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 class 9 = 0.667 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all KL = 0.766 +- 0.222 (in-sample avg dev_std = 0.304)
SUFF++ for r=0.9 all L1 = 0.703 +- 0.195 (in-sample avg dev_std = 0.304)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.085
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.502 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 1 = 0.511 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 2 = 0.485 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 3 = 0.507 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 4 = 0.513 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 5 = 0.509 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 6 = 0.478 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 7 = 0.462 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 8 = 0.496 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 9 = 0.504 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all KL = 0.532 +- 0.235 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all L1 = 0.497 +- 0.108 (in-sample avg dev_std = 0.454)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.154
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.131
SUFF++ for r=0.6 class 0 = 0.552 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 1 = 0.565 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 2 = 0.573 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 3 = 0.581 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 4 = 0.572 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 5 = 0.526 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 6 = 0.542 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 7 = 0.56 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 8 = 0.533 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 class 9 = 0.518 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 all KL = 0.644 +- 0.214 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.6 all L1 = 0.553 +- 0.165 (in-sample avg dev_std = 0.220)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.415
SUFF++ for r=0.9 class 0 = 0.758 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 1 = 0.77 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 2 = 0.704 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 3 = 0.673 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 4 = 0.662 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 5 = 0.649 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 6 = 0.714 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 7 = 0.689 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 8 = 0.695 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 class 9 = 0.685 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all KL = 0.76 +- 0.224 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.9 all L1 = 0.701 +- 0.196 (in-sample avg dev_std = 0.306)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.499 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 1 = 0.493 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 2 = 0.513 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 3 = 0.501 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 4 = 0.511 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 5 = 0.496 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 6 = 0.504 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 7 = 0.488 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 8 = 0.504 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 class 9 = 0.509 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 all KL = 0.568 +- 0.234 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.3 all L1 = 0.502 +- 0.115 (in-sample avg dev_std = 0.433)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.128
SUFF++ for r=0.6 class 0 = 0.673 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 1 = 0.667 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 2 = 0.698 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 3 = 0.664 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 4 = 0.67 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 5 = 0.74 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 6 = 0.725 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 7 = 0.71 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 8 = 0.68 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 class 9 = 0.721 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 all KL = 0.724 +- 0.238 (in-sample avg dev_std = 0.233)
SUFF++ for r=0.6 all L1 = 0.694 +- 0.215 (in-sample avg dev_std = 0.233)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.211
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.2
SUFF++ for r=0.9 class 0 = 0.919 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1 = 0.798 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 2 = 0.871 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 3 = 0.833 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 4 = 0.777 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 5 = 0.873 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 6 = 0.749 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 7 = 0.797 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 8 = 0.729 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 9 = 0.721 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.874 +- 0.176 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.807 +- 0.189 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.398 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 1 = 0.4 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 2 = 0.375 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 3 = 0.421 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 4 = 0.382 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 5 = 0.414 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 6 = 0.39 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 7 = 0.407 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 8 = 0.381 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 9 = 0.437 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 all KL = 0.283 +- 0.199 (in-sample avg dev_std = 0.272)
NEC for r=0.3 all L1 = 0.4 +- 0.153 (in-sample avg dev_std = 0.272)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.162
NEC for r=0.6 class 0 = 0.39 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 1 = 0.369 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 2 = 0.384 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 3 = 0.37 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 4 = 0.387 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 5 = 0.381 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 6 = 0.42 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 7 = 0.396 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 8 = 0.402 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 class 9 = 0.435 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 all KL = 0.265 +- 0.159 (in-sample avg dev_std = 0.238)
NEC for r=0.6 all L1 = 0.393 +- 0.134 (in-sample avg dev_std = 0.238)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.464
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.351
NEC for r=0.9 class 0 = 0.504 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 1 = 0.29 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 2 = 0.474 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 3 = 0.596 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 4 = 0.527 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 5 = 0.568 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 6 = 0.536 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 7 = 0.559 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 8 = 0.554 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 class 9 = 0.562 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 all KL = 0.574 +- 0.251 (in-sample avg dev_std = 0.406)
NEC for r=0.9 all L1 = 0.514 +- 0.193 (in-sample avg dev_std = 0.406)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.613
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.468
NEC for r=1.0 class 0 = 0.402 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 1 = 0.217 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 2 = 0.462 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 3 = 0.562 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 4 = 0.464 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 5 = 0.597 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 6 = 0.476 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 7 = 0.515 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 8 = 0.509 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 class 9 = 0.562 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 all KL = 0.589 +- 0.286 (in-sample avg dev_std = 0.442)
NEC for r=1.0 all L1 = 0.472 +- 0.232 (in-sample avg dev_std = 0.442)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.085
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.414 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 1 = 0.415 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 2 = 0.418 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 3 = 0.361 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 4 = 0.423 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 5 = 0.421 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 6 = 0.401 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 7 = 0.406 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 8 = 0.347 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 class 9 = 0.39 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 all KL = 0.282 +- 0.193 (in-sample avg dev_std = 0.272)
NEC for r=0.3 all L1 = 0.4 +- 0.149 (in-sample avg dev_std = 0.272)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.154
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.145
NEC for r=0.6 class 0 = 0.402 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 1 = 0.38 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 2 = 0.371 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 3 = 0.38 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 4 = 0.371 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 5 = 0.373 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 6 = 0.411 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 7 = 0.384 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 8 = 0.417 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 9 = 0.411 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all KL = 0.261 +- 0.163 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all L1 = 0.39 +- 0.137 (in-sample avg dev_std = 0.236)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.441
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.339
NEC for r=0.9 class 0 = 0.512 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 1 = 0.402 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 2 = 0.472 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 3 = 0.564 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 4 = 0.526 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 5 = 0.59 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 6 = 0.554 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 7 = 0.557 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 8 = 0.532 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 9 = 0.526 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 all KL = 0.588 +- 0.248 (in-sample avg dev_std = 0.415)
NEC for r=0.9 all L1 = 0.522 +- 0.194 (in-sample avg dev_std = 0.415)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.613
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.439
NEC for r=1.0 class 0 = 0.444 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 1 = 0.271 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 2 = 0.491 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 3 = 0.586 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 4 = 0.497 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 5 = 0.607 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 6 = 0.536 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 7 = 0.505 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 8 = 0.512 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 class 9 = 0.547 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 all KL = 0.618 +- 0.274 (in-sample avg dev_std = 0.447)
NEC for r=1.0 all L1 = 0.496 +- 0.225 (in-sample avg dev_std = 0.447)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.432 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 1 = 0.413 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 2 = 0.403 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 3 = 0.4 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 4 = 0.448 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 5 = 0.408 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 6 = 0.426 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 7 = 0.428 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 8 = 0.441 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 9 = 0.428 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all KL = 0.295 +- 0.182 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all L1 = 0.422 +- 0.141 (in-sample avg dev_std = 0.274)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.312 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1 = 0.258 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 2 = 0.269 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 3 = 0.255 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 4 = 0.262 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 5 = 0.242 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 6 = 0.29 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 7 = 0.26 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 8 = 0.268 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 9 = 0.258 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.199 +- 0.175 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.268 +- 0.178 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.211
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.188
NEC for r=0.9 class 0 = 0.201 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 1 = 0.354 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 2 = 0.205 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 3 = 0.286 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 4 = 0.326 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 5 = 0.239 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 6 = 0.417 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 7 = 0.353 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 8 = 0.39 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 9 = 0.443 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 all KL = 0.293 +- 0.265 (in-sample avg dev_std = 0.287)
NEC for r=0.9 all L1 = 0.321 +- 0.247 (in-sample avg dev_std = 0.287)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.213
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.211
NEC for r=1.0 class 0 = 0.217 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 1 = 0.386 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 2 = 0.213 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 3 = 0.412 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 4 = 0.357 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 5 = 0.337 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 6 = 0.504 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 7 = 0.368 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 8 = 0.451 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 9 = 0.477 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 all KL = 0.352 +- 0.294 (in-sample avg dev_std = 0.289)
NEC for r=1.0 all L1 = 0.371 +- 0.261 (in-sample avg dev_std = 0.289)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.855, 0.526, 0.766, 1.0], 'all_L1': [0.722, 0.477, 0.686, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.71, 0.445, 0.784, 1.0], 'all_L1': [0.634, 0.434, 0.71, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.785, 0.465, 0.739, 1.0], 'all_L1': [0.716, 0.473, 0.689, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.514, 0.762, 1.0], 'all_L1': [0.463, 0.482, 0.703, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.528, 0.639, 0.766, 1.0], 'all_L1': [0.498, 0.547, 0.703, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.133, 0.274, 0.548, 0.594], 'all_L1': [0.271, 0.403, 0.526, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.153, 0.347, 0.59, 0.598], 'all_L1': [0.265, 0.444, 0.526, 0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.42, 0.628, 0.64], 'all_L1': [0.19, 0.464, 0.527, 0.5]}), defaultdict(<class 'list'>, {'all_KL': [0.29, 0.314, 0.573, 0.59], 'all_L1': [0.431, 0.422, 0.515, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.283, 0.265, 0.574, 0.589], 'all_L1': [0.4, 0.393, 0.514, 0.472]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.857, 0.514, 0.784, 1.0], 'all_L1': [0.728, 0.465, 0.698, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.447, 0.775, 1.0], 'all_L1': [0.632, 0.436, 0.705, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.482, 0.741, 1.0], 'all_L1': [0.721, 0.482, 0.697, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.483, 0.532, 0.763, 1.0], 'all_L1': [0.455, 0.494, 0.695, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.532, 0.644, 0.76, 1.0], 'all_L1': [0.497, 0.553, 0.701, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.134, 0.271, 0.544, 0.621], 'all_L1': [0.267, 0.406, 0.527, 0.525]}), defaultdict(<class 'list'>, {'all_KL': [0.15, 0.342, 0.593, 0.61], 'all_L1': [0.26, 0.441, 0.527, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.088, 0.409, 0.636, 0.65], 'all_L1': [0.189, 0.457, 0.534, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.296, 0.31, 0.593, 0.611], 'all_L1': [0.429, 0.42, 0.531, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.282, 0.261, 0.588, 0.618], 'all_L1': [0.4, 0.39, 0.522, 0.496]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.883, 0.603, 0.856, 1.0], 'all_L1': [0.798, 0.538, 0.784, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.594, 0.856, 1.0], 'all_L1': [0.687, 0.519, 0.807, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.784, 0.543, 0.805, 1.0], 'all_L1': [0.653, 0.521, 0.746, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.576, 0.584, 0.801, 1.0], 'all_L1': [0.497, 0.529, 0.739, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.568, 0.724, 0.874, 1.0], 'all_L1': [0.502, 0.694, 0.807, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.094, 0.287, 0.313, 0.453], 'all_L1': [0.179, 0.394, 0.356, 0.456]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.312, 0.335, 0.351], 'all_L1': [0.177, 0.422, 0.333, 0.351]}), defaultdict(<class 'list'>, {'all_KL': [0.171, 0.334, 0.407, 0.417], 'all_L1': [0.318, 0.401, 0.41, 0.382]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.277, 0.492, 0.486], 'all_L1': [0.373, 0.395, 0.461, 0.446]}), defaultdict(<class 'list'>, {'all_KL': [0.295, 0.199, 0.293, 0.352], 'all_L1': [0.422, 0.268, 0.321, 0.371]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.607 +- 0.108, 0.483 +- 0.036, 0.698 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.674 +- 0.141, 0.518 +- 0.068, 0.763 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.105 +- 0.007, 0.138 +- 0.012, 0.371 +- 0.026
nec class all_L1  =  0.311 +- 0.090, 0.425 +- 0.026, 0.522 +- 0.006, 0.490 +- 0.010
nec class all_KL  =  0.190 +- 0.081, 0.324 +- 0.056, 0.583 +- 0.026, 0.602 +- 0.019
nec_acc_int  =  0.107 +- 0.005, 0.143 +- 0.015, 0.298 +- 0.031, 0.431 +- 0.019

Eval split id_test
suff++ class all_L1  =  0.607 +- 0.113, 0.486 +- 0.039, 0.699 +- 0.003, 1.000 +- 0.000
suff++ class all_KL  =  0.675 +- 0.145, 0.524 +- 0.067, 0.765 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.105 +- 0.005, 0.116 +- 0.011, 0.369 +- 0.025
nec class all_L1  =  0.309 +- 0.091, 0.423 +- 0.024, 0.528 +- 0.004, 0.507 +- 0.010
nec class all_KL  =  0.190 +- 0.083, 0.319 +- 0.054, 0.591 +- 0.029, 0.622 +- 0.015
nec_acc_int  =  0.106 +- 0.006, 0.126 +- 0.014, 0.277 +- 0.034, 0.417 +- 0.011

Eval split test
suff++ class all_L1  =  0.627 +- 0.115, 0.560 +- 0.067, 0.777 +- 0.029, 1.000 +- 0.000
suff++ class all_KL  =  0.713 +- 0.123, 0.610 +- 0.061, 0.838 +- 0.030, 1.000 +- 0.000
suff++_acc_int  =  0.100 +- 0.005, 0.122 +- 0.016, 0.147 +- 0.030
nec class all_L1  =  0.294 +- 0.100, 0.376 +- 0.055, 0.376 +- 0.052, 0.401 +- 0.042
nec class all_KL  =  0.173 +- 0.077, 0.282 +- 0.046, 0.368 +- 0.073, 0.412 +- 0.054
nec_acc_int  =  0.101 +- 0.005, 0.126 +- 0.016, 0.142 +- 0.025, 0.151 +- 0.035


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.459 +- 0.019, 0.454 +- 0.013, 0.610 +- 0.004, 0.745 +- 0.005
Faith. Armon (L1)= 		  =  0.392 +- 0.054, 0.450 +- 0.012, 0.597 +- 0.004, 0.657 +- 0.009
Faith. GMean (L1)= 	  =  0.423 +- 0.030, 0.452 +- 0.012, 0.603 +- 0.004, 0.700 +- 0.007
Faith. Aritm (KL)= 		  =  0.432 +- 0.035, 0.421 +- 0.023, 0.673 +- 0.011, 0.801 +- 0.010
Faith. Armon (KL)= 		  =  0.276 +- 0.079, 0.391 +- 0.027, 0.660 +- 0.014, 0.752 +- 0.015
Faith. GMean (KL)= 	  =  0.340 +- 0.042, 0.406 +- 0.021, 0.667 +- 0.013, 0.776 +- 0.012

Eval split id_test
Faith. Aritm (L1)= 		  =  0.458 +- 0.020, 0.454 +- 0.015, 0.614 +- 0.002, 0.753 +- 0.005
Faith. Armon (L1)= 		  =  0.389 +- 0.053, 0.451 +- 0.013, 0.602 +- 0.002, 0.673 +- 0.008
Faith. GMean (L1)= 	  =  0.421 +- 0.030, 0.452 +- 0.014, 0.608 +- 0.002, 0.712 +- 0.007
Faith. Aritm (KL)= 		  =  0.432 +- 0.036, 0.421 +- 0.025, 0.678 +- 0.008, 0.811 +- 0.007
Faith. Armon (KL)= 		  =  0.275 +- 0.082, 0.390 +- 0.029, 0.666 +- 0.014, 0.767 +- 0.011
Faith. GMean (KL)= 	  =  0.339 +- 0.044, 0.405 +- 0.023, 0.672 +- 0.011, 0.789 +- 0.009

Eval split test
Faith. Aritm (L1)= 		  =  0.461 +- 0.024, 0.468 +- 0.007, 0.576 +- 0.013, 0.701 +- 0.021
Faith. Armon (L1)= 		  =  0.377 +- 0.075, 0.443 +- 0.028, 0.503 +- 0.040, 0.571 +- 0.042
Faith. GMean (L1)= 	  =  0.415 +- 0.044, 0.455 +- 0.012, 0.538 +- 0.027, 0.633 +- 0.033
Faith. Aritm (KL)= 		  =  0.443 +- 0.035, 0.446 +- 0.011, 0.603 +- 0.023, 0.706 +- 0.027
Faith. Armon (KL)= 		  =  0.262 +- 0.087, 0.380 +- 0.037, 0.506 +- 0.062, 0.581 +- 0.054
Faith. GMean (KL)= 	  =  0.335 +- 0.054, 0.411 +- 0.018, 0.552 +- 0.044, 0.640 +- 0.042
Computed for split load_split = id



Completed in  1:28:37.768414  for LECIvGIN GOODCMNIST/color



DONE LECI GOODCMNIST/color Top0.8

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 04:46:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 04:46:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 0.9575
Train Loss: 0.1218
ID Validation ACCURACY: 0.8969
ID Validation Loss: 0.3476
ID Test ACCURACY: 0.8924
ID Test Loss: 0.3616
OOD Validation ACCURACY: 0.7954
OOD Validation Loss: 0.8088
OOD Test ACCURACY: 0.3006
OOD Test Loss: 4.0128

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9471
Train Loss: 0.1535
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3529
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3678
OOD Validation ACCURACY: 0.8127
OOD Validation Loss: 0.6868
OOD Test ACCURACY: 0.3353
OOD Test Loss: 3.5650

[0m[1;37mINFO[0m: [1mChartInfo 0.8924 0.3006 0.8907 0.3353 0.8889 0.8127[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.377 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 1 = 0.482 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 2 = 0.456 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 3 = 0.45 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 4 = 0.387 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 5 = 0.445 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 6 = 0.432 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 7 = 0.39 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 8 = 0.441 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 class 9 = 0.406 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all KL = 0.339 +- 0.256 (in-sample avg dev_std = 0.509)
SUFF++ for r=0.3 all L1 = 0.427 +- 0.127 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.129
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
SUFF++ for r=0.6 class 0 = 0.327 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 1 = 0.447 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 2 = 0.414 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 3 = 0.37 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 4 = 0.394 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 5 = 0.371 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 6 = 0.367 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 7 = 0.376 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 8 = 0.364 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 class 9 = 0.365 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all KL = 0.24 +- 0.227 (in-sample avg dev_std = 0.529)
SUFF++ for r=0.6 all L1 = 0.38 +- 0.129 (in-sample avg dev_std = 0.529)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.376
SUFF++ for r=0.9 class 0 = 0.272 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 1 = 0.308 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 2 = 0.461 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 3 = 0.298 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 4 = 0.478 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 5 = 0.304 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 6 = 0.334 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 7 = 0.593 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 8 = 0.311 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 class 9 = 0.361 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 all KL = 0.169 +- 0.199 (in-sample avg dev_std = 0.631)
SUFF++ for r=0.9 all L1 = 0.374 +- 0.161 (in-sample avg dev_std = 0.631)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
SUFF++ for r=0.3 class 0 = 0.362 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 1 = 0.478 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 2 = 0.461 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 3 = 0.464 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 4 = 0.383 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 5 = 0.435 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 6 = 0.426 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 7 = 0.408 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 8 = 0.456 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 class 9 = 0.376 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all KL = 0.339 +- 0.244 (in-sample avg dev_std = 0.519)
SUFF++ for r=0.3 all L1 = 0.426 +- 0.117 (in-sample avg dev_std = 0.519)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.136
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
SUFF++ for r=0.6 class 0 = 0.34 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 1 = 0.432 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 2 = 0.366 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 3 = 0.385 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 4 = 0.398 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 5 = 0.367 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 6 = 0.338 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 7 = 0.391 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 8 = 0.348 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 class 9 = 0.392 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 all KL = 0.247 +- 0.225 (in-sample avg dev_std = 0.522)
SUFF++ for r=0.6 all L1 = 0.377 +- 0.123 (in-sample avg dev_std = 0.522)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.785
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.369
SUFF++ for r=0.9 class 0 = 0.272 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 1 = 0.292 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 2 = 0.478 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 3 = 0.306 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 4 = 0.481 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 5 = 0.309 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 6 = 0.309 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 7 = 0.593 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 8 = 0.309 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 class 9 = 0.341 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 all KL = 0.169 +- 0.207 (in-sample avg dev_std = 0.633)
SUFF++ for r=0.9 all L1 = 0.369 +- 0.162 (in-sample avg dev_std = 0.633)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.138
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.422 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 1 = 0.335 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 2 = 0.394 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 3 = 0.401 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 4 = 0.397 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 5 = 0.419 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 6 = 0.41 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 7 = 0.413 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 8 = 0.426 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 9 = 0.396 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all KL = 0.12 +- 0.113 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all L1 = 0.4 +- 0.138 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.125
SUFF++ for r=0.6 class 0 = 0.596 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 1 = 0.465 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 2 = 0.558 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 3 = 0.553 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 4 = 0.461 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 5 = 0.56 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 6 = 0.513 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 7 = 0.515 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 8 = 0.477 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 class 9 = 0.432 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 all KL = 0.344 +- 0.238 (in-sample avg dev_std = 0.533)
SUFF++ for r=0.6 all L1 = 0.513 +- 0.193 (in-sample avg dev_std = 0.533)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.189
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.157
SUFF++ for r=0.9 class 0 = 0.377 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 1 = 0.384 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 2 = 0.509 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 3 = 0.407 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 4 = 0.418 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 5 = 0.473 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 6 = 0.421 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 7 = 0.439 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 8 = 0.424 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 class 9 = 0.342 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 all KL = 0.34 +- 0.306 (in-sample avg dev_std = 0.372)
SUFF++ for r=0.9 all L1 = 0.419 +- 0.238 (in-sample avg dev_std = 0.372)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.128
NEC for r=0.3 class 0 = 0.52 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 1 = 0.227 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 2 = 0.605 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 3 = 0.569 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 4 = 0.555 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 5 = 0.564 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 6 = 0.45 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 7 = 0.477 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 8 = 0.521 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 9 = 0.52 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all KL = 0.498 +- 0.289 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all L1 = 0.497 +- 0.223 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.129
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 0 = 0.56 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 1 = 0.269 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 2 = 0.492 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 3 = 0.578 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 4 = 0.5 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 5 = 0.591 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 6 = 0.552 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 7 = 0.523 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 8 = 0.601 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 class 9 = 0.533 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all KL = 0.562 +- 0.288 (in-sample avg dev_std = 0.389)
NEC for r=0.6 all L1 = 0.516 +- 0.219 (in-sample avg dev_std = 0.389)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.616
NEC for r=0.9 class 0 = 0.466 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.366 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.333 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 3 = 0.527 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 4 = 0.327 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 5 = 0.576 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 6 = 0.509 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 7 = 0.33 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 8 = 0.433 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 9 = 0.601 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.563 +- 0.301 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.442 +- 0.244 (in-sample avg dev_std = 0.445)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0 = 0.074 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 1 = 0.034 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 2 = 0.26 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 3 = 0.261 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 4 = 0.149 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 5 = 0.363 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 6 = 0.275 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 7 = 0.2 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 8 = 0.248 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 class 9 = 0.418 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 all KL = 0.313 +- 0.307 (in-sample avg dev_std = 0.337)
NEC for r=1.0 all L1 = 0.223 +- 0.238 (in-sample avg dev_std = 0.337)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.543 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 1 = 0.199 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 2 = 0.579 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 3 = 0.548 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 4 = 0.548 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 5 = 0.534 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 6 = 0.491 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 7 = 0.429 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 8 = 0.511 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 9 = 0.47 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all KL = 0.48 +- 0.281 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all L1 = 0.479 +- 0.223 (in-sample avg dev_std = 0.365)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.136
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
NEC for r=0.6 class 0 = 0.558 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.3 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.554 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 3 = 0.589 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 4 = 0.573 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 5 = 0.598 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 6 = 0.568 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 7 = 0.488 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 8 = 0.596 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 9 = 0.534 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.578 +- 0.283 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.531 +- 0.213 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.785
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.617
NEC for r=0.9 class 0 = 0.433 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 1 = 0.388 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 2 = 0.335 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 3 = 0.515 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 4 = 0.318 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 5 = 0.588 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 6 = 0.503 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 7 = 0.304 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 8 = 0.424 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 9 = 0.597 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all KL = 0.561 +- 0.301 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all L1 = 0.438 +- 0.243 (in-sample avg dev_std = 0.443)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.84
NEC for r=1.0 class 0 = 0.095 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 1 = 0.056 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 2 = 0.336 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 3 = 0.27 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 4 = 0.154 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 5 = 0.327 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 6 = 0.235 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 7 = 0.196 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 8 = 0.224 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 class 9 = 0.385 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 all KL = 0.316 +- 0.308 (in-sample avg dev_std = 0.343)
NEC for r=1.0 all L1 = 0.224 +- 0.237 (in-sample avg dev_std = 0.343)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.138
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.134
NEC for r=0.3 class 0 = 0.494 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 1 = 0.54 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 2 = 0.526 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 3 = 0.495 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 4 = 0.525 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 5 = 0.47 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 6 = 0.527 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 7 = 0.493 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 8 = 0.481 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 class 9 = 0.405 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all KL = 0.512 +- 0.301 (in-sample avg dev_std = 0.365)
NEC for r=0.3 all L1 = 0.496 +- 0.219 (in-sample avg dev_std = 0.365)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.134
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
NEC for r=0.6 class 0 = 0.294 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 1 = 0.449 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 2 = 0.318 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 3 = 0.334 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 4 = 0.377 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 5 = 0.338 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 6 = 0.472 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 7 = 0.341 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 8 = 0.389 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 class 9 = 0.427 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 all KL = 0.411 +- 0.316 (in-sample avg dev_std = 0.377)
NEC for r=0.6 all L1 = 0.374 +- 0.264 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.189
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.21
NEC for r=0.9 class 0 = 0.637 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 1 = 0.529 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 2 = 0.515 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 3 = 0.578 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 4 = 0.584 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 5 = 0.551 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 6 = 0.565 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 7 = 0.556 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 8 = 0.599 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 class 9 = 0.662 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all KL = 0.643 +- 0.314 (in-sample avg dev_std = 0.349)
NEC for r=0.9 all L1 = 0.577 +- 0.249 (in-sample avg dev_std = 0.349)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.303
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.328
NEC for r=1.0 class 0 = 0.622 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 1 = 0.537 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 2 = 0.523 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 3 = 0.614 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 4 = 0.656 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 5 = 0.598 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 6 = 0.692 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 7 = 0.603 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 8 = 0.656 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 9 = 0.692 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 all KL = 0.681 +- 0.295 (in-sample avg dev_std = 0.330)
NEC for r=1.0 all L1 = 0.618 +- 0.220 (in-sample avg dev_std = 0.330)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 05:08:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 05:08:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ACCURACY: 0.9570
Train Loss: 0.1262
ID Validation ACCURACY: 0.8999
ID Validation Loss: 0.3381
ID Test ACCURACY: 0.8894
ID Test Loss: 0.3605
OOD Validation ACCURACY: 0.7470
OOD Validation Loss: 1.1307
OOD Test ACCURACY: 0.2541
OOD Test Loss: 11.0283

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ACCURACY: 0.9195
Train Loss: 0.2354
ID Validation ACCURACY: 0.8791
ID Validation Loss: 0.3877
ID Test ACCURACY: 0.8836
ID Test Loss: 0.3937
OOD Validation ACCURACY: 0.8013
OOD Validation Loss: 0.6603
OOD Test ACCURACY: 0.3191
OOD Test Loss: 3.5159

[0m[1;37mINFO[0m: [1mChartInfo 0.8894 0.2541 0.8836 0.3191 0.8791 0.8013[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
SUFF++ for r=0.3 class 0 = 0.487 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 1 = 0.571 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 2 = 0.555 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 3 = 0.539 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 4 = 0.53 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 5 = 0.551 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 6 = 0.524 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 7 = 0.606 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 8 = 0.532 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 9 = 0.535 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 all KL = 0.569 +- 0.229 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 all L1 = 0.544 +- 0.179 (in-sample avg dev_std = 0.377)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.144
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.133
SUFF++ for r=0.6 class 0 = 0.361 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1 = 0.426 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 2 = 0.441 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 3 = 0.421 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 4 = 0.404 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 5 = 0.4 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 6 = 0.405 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 7 = 0.431 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 8 = 0.41 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 9 = 0.4 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.355 +- 0.201 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.411 +- 0.119 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.376
SUFF++ for r=0.9 class 0 = 0.287 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 1 = 0.367 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 2 = 0.447 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 3 = 0.3 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 4 = 0.281 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 5 = 0.365 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 6 = 0.353 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 7 = 0.647 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 8 = 0.298 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 class 9 = 0.304 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 all KL = 0.148 +- 0.215 (in-sample avg dev_std = 0.634)
SUFF++ for r=0.9 all L1 = 0.368 +- 0.179 (in-sample avg dev_std = 0.634)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.528 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1 = 0.626 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 2 = 0.544 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 3 = 0.532 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 4 = 0.556 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 5 = 0.562 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 6 = 0.527 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 7 = 0.583 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 8 = 0.533 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 9 = 0.535 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.577 +- 0.233 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.554 +- 0.175 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.128
SUFF++ for r=0.6 class 0 = 0.381 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.434 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.46 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 3 = 0.427 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 4 = 0.407 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 5 = 0.415 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 6 = 0.419 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 7 = 0.46 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 8 = 0.409 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 9 = 0.414 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.38 +- 0.209 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.423 +- 0.127 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.377
SUFF++ for r=0.9 class 0 = 0.287 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 1 = 0.322 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 2 = 0.452 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 3 = 0.305 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 4 = 0.289 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 5 = 0.385 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 6 = 0.327 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 7 = 0.652 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 8 = 0.28 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 class 9 = 0.311 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 all KL = 0.153 +- 0.214 (in-sample avg dev_std = 0.629)
SUFF++ for r=0.9 all L1 = 0.363 +- 0.173 (in-sample avg dev_std = 0.629)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.493 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 1 = 0.369 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 2 = 0.487 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 3 = 0.481 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 4 = 0.445 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 5 = 0.496 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 6 = 0.458 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 7 = 0.501 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 8 = 0.481 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 class 9 = 0.481 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 all KL = 0.372 +- 0.266 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.3 all L1 = 0.468 +- 0.165 (in-sample avg dev_std = 0.513)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.101
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.121
SUFF++ for r=0.6 class 0 = 0.492 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 1 = 0.48 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 2 = 0.499 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 3 = 0.473 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 4 = 0.443 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 5 = 0.473 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 6 = 0.402 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 7 = 0.458 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 8 = 0.405 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 class 9 = 0.446 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all KL = 0.333 +- 0.315 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.6 all L1 = 0.458 +- 0.259 (in-sample avg dev_std = 0.462)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.186
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.15
SUFF++ for r=0.9 class 0 = 0.307 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 1 = 0.485 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 2 = 0.444 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 3 = 0.441 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 4 = 0.345 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 5 = 0.411 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 6 = 0.355 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 7 = 0.349 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 8 = 0.379 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 class 9 = 0.326 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 all KL = 0.234 +- 0.291 (in-sample avg dev_std = 0.536)
SUFF++ for r=0.9 all L1 = 0.386 +- 0.201 (in-sample avg dev_std = 0.536)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
NEC for r=0.3 class 0 = 0.515 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 1 = 0.337 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 2 = 0.494 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 3 = 0.476 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 4 = 0.477 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 5 = 0.495 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 6 = 0.49 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 7 = 0.401 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 8 = 0.515 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 class 9 = 0.459 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all KL = 0.437 +- 0.280 (in-sample avg dev_std = 0.373)
NEC for r=0.3 all L1 = 0.463 +- 0.232 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.144
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
NEC for r=0.6 class 0 = 0.59 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 1 = 0.454 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 2 = 0.506 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 3 = 0.525 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 4 = 0.496 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 5 = 0.529 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 6 = 0.519 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 7 = 0.512 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 8 = 0.559 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 class 9 = 0.491 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all KL = 0.507 +- 0.241 (in-sample avg dev_std = 0.363)
NEC for r=0.6 all L1 = 0.517 +- 0.172 (in-sample avg dev_std = 0.363)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.775
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.637
NEC for r=0.9 class 0 = 0.519 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 1 = 0.465 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 2 = 0.379 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 3 = 0.507 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 4 = 0.48 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 5 = 0.426 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 6 = 0.47 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 7 = 0.299 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 8 = 0.404 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 class 9 = 0.56 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 all KL = 0.588 +- 0.285 (in-sample avg dev_std = 0.463)
NEC for r=0.9 all L1 = 0.45 +- 0.230 (in-sample avg dev_std = 0.463)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.843
NEC for r=1.0 class 0 = 0.103 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 1 = 0.039 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 2 = 0.315 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 3 = 0.308 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 4 = 0.162 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 5 = 0.284 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 6 = 0.262 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 7 = 0.197 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 8 = 0.221 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 9 = 0.344 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all KL = 0.299 +- 0.307 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all L1 = 0.22 +- 0.234 (in-sample avg dev_std = 0.325)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.105
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
NEC for r=0.3 class 0 = 0.51 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 1 = 0.262 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 2 = 0.475 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 3 = 0.514 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 4 = 0.486 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 5 = 0.491 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 6 = 0.507 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 7 = 0.416 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 8 = 0.503 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 class 9 = 0.459 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all KL = 0.435 +- 0.286 (in-sample avg dev_std = 0.379)
NEC for r=0.3 all L1 = 0.458 +- 0.233 (in-sample avg dev_std = 0.379)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
NEC for r=0.6 class 0 = 0.575 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 1 = 0.47 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 2 = 0.479 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 3 = 0.507 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 4 = 0.508 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 5 = 0.526 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 6 = 0.515 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 7 = 0.498 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 8 = 0.541 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 9 = 0.565 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 all KL = 0.503 +- 0.233 (in-sample avg dev_std = 0.357)
NEC for r=0.6 all L1 = 0.517 +- 0.165 (in-sample avg dev_std = 0.357)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.633
NEC for r=0.9 class 0 = 0.467 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 1 = 0.476 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 2 = 0.418 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 3 = 0.51 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 4 = 0.494 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 5 = 0.368 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 6 = 0.484 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 7 = 0.3 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 8 = 0.418 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 class 9 = 0.569 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 all KL = 0.574 +- 0.280 (in-sample avg dev_std = 0.455)
NEC for r=0.9 all L1 = 0.45 +- 0.231 (in-sample avg dev_std = 0.455)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0 = 0.103 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 1 = 0.043 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 2 = 0.36 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 3 = 0.316 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 4 = 0.176 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 5 = 0.24 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 6 = 0.25 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 7 = 0.199 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 8 = 0.227 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 class 9 = 0.355 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 all KL = 0.301 +- 0.296 (in-sample avg dev_std = 0.333)
NEC for r=1.0 all L1 = 0.224 +- 0.234 (in-sample avg dev_std = 0.333)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.098
NEC for r=0.3 class 0 = 0.459 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 1 = 0.589 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 2 = 0.471 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 3 = 0.465 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 4 = 0.518 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 5 = 0.453 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 6 = 0.449 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 7 = 0.451 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 8 = 0.466 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 9 = 0.513 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all KL = 0.536 +- 0.346 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all L1 = 0.485 +- 0.257 (in-sample avg dev_std = 0.408)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.101
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.164
NEC for r=0.6 class 0 = 0.561 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 1 = 0.785 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 2 = 0.459 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 3 = 0.529 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 4 = 0.665 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 5 = 0.5 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 6 = 0.617 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 7 = 0.584 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 8 = 0.572 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 class 9 = 0.698 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 all KL = 0.683 +- 0.345 (in-sample avg dev_std = 0.357)
NEC for r=0.6 all L1 = 0.598 +- 0.274 (in-sample avg dev_std = 0.357)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.186
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.217
NEC for r=0.9 class 0 = 0.631 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 1 = 0.385 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 2 = 0.516 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 3 = 0.493 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 4 = 0.603 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 5 = 0.533 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 6 = 0.584 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 7 = 0.544 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 8 = 0.548 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 class 9 = 0.496 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 all KL = 0.627 +- 0.349 (in-sample avg dev_std = 0.430)
NEC for r=0.9 all L1 = 0.531 +- 0.268 (in-sample avg dev_std = 0.430)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.259
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.282
NEC for r=1.0 class 0 = 0.358 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 1 = 0.296 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 2 = 0.498 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 3 = 0.463 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 4 = 0.443 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 5 = 0.427 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 6 = 0.466 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 7 = 0.406 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 8 = 0.424 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 class 9 = 0.341 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all KL = 0.489 +- 0.370 (in-sample avg dev_std = 0.362)
NEC for r=1.0 all L1 = 0.411 +- 0.299 (in-sample avg dev_std = 0.362)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 05:30:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 05:30:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 164...
[0m[1;37mINFO[0m: [1mCheckpoint 164: 
-----------------------------------
Train ACCURACY: 0.9481
Train Loss: 0.1509
ID Validation ACCURACY: 0.8956
ID Validation Loss: 0.3421
ID Test ACCURACY: 0.8903
ID Test Loss: 0.3459
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.6507
OOD Test ACCURACY: 0.3644
OOD Test Loss: 3.1956

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 165...
[0m[1;37mINFO[0m: [1mCheckpoint 165: 
-----------------------------------
Train ACCURACY: 0.9344
Train Loss: 0.1868
ID Validation ACCURACY: 0.8841
ID Validation Loss: 0.3788
ID Test ACCURACY: 0.8824
ID Test Loss: 0.3874
OOD Validation ACCURACY: 0.8207
OOD Validation Loss: 0.6023
OOD Test ACCURACY: 0.3040
OOD Test Loss: 6.3061

[0m[1;37mINFO[0m: [1mChartInfo 0.8903 0.3644 0.8824 0.3040 0.8841 0.8207[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.483 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 1 = 0.466 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 2 = 0.639 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 3 = 0.662 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 4 = 0.553 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 5 = 0.682 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 6 = 0.663 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 7 = 0.619 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 8 = 0.641 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 9 = 0.599 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 all KL = 0.628 +- 0.259 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 all L1 = 0.598 +- 0.177 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.126
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.117
SUFF++ for r=0.6 class 0 = 0.401 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 1 = 0.341 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 2 = 0.702 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 3 = 0.676 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 4 = 0.525 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 5 = 0.661 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 6 = 0.568 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 7 = 0.667 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 8 = 0.524 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 class 9 = 0.558 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 all KL = 0.596 +- 0.301 (in-sample avg dev_std = 0.293)
SUFF++ for r=0.6 all L1 = 0.561 +- 0.255 (in-sample avg dev_std = 0.293)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.353
SUFF++ for r=0.9 class 0 = 0.272 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 1 = 0.246 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 2 = 0.336 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 3 = 0.288 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 4 = 0.291 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 5 = 0.286 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 6 = 0.351 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 7 = 0.738 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 8 = 0.331 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 class 9 = 0.367 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 all KL = 0.169 +- 0.258 (in-sample avg dev_std = 0.647)
SUFF++ for r=0.9 all L1 = 0.354 +- 0.191 (in-sample avg dev_std = 0.647)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.456 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 1 = 0.497 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 2 = 0.655 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 3 = 0.681 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 4 = 0.585 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 5 = 0.67 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 6 = 0.653 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 7 = 0.622 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 8 = 0.602 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 class 9 = 0.619 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 all KL = 0.644 +- 0.245 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.3 all L1 = 0.603 +- 0.173 (in-sample avg dev_std = 0.387)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.123
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.111
SUFF++ for r=0.6 class 0 = 0.429 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 1 = 0.322 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 2 = 0.712 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 3 = 0.672 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 4 = 0.581 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 5 = 0.624 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 6 = 0.541 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 7 = 0.671 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 8 = 0.539 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 class 9 = 0.63 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all KL = 0.605 +- 0.298 (in-sample avg dev_std = 0.300)
SUFF++ for r=0.6 all L1 = 0.569 +- 0.247 (in-sample avg dev_std = 0.300)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.368
SUFF++ for r=0.9 class 0 = 0.275 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 1 = 0.278 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 2 = 0.317 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 3 = 0.281 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 4 = 0.309 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 5 = 0.303 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 6 = 0.348 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 7 = 0.762 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 8 = 0.325 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 class 9 = 0.362 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 all KL = 0.175 +- 0.262 (in-sample avg dev_std = 0.667)
SUFF++ for r=0.9 all L1 = 0.358 +- 0.186 (in-sample avg dev_std = 0.667)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
SUFF++ for r=0.3 class 0 = 0.535 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 1 = 0.448 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 2 = 0.505 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 3 = 0.523 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 4 = 0.531 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 5 = 0.57 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 6 = 0.496 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 7 = 0.532 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 8 = 0.538 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 class 9 = 0.52 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 all KL = 0.611 +- 0.239 (in-sample avg dev_std = 0.381)
SUFF++ for r=0.3 all L1 = 0.518 +- 0.148 (in-sample avg dev_std = 0.381)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
SUFF++ for r=0.6 class 0 = 0.504 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 1 = 0.282 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 2 = 0.415 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 3 = 0.383 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 4 = 0.36 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 5 = 0.379 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 6 = 0.388 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 7 = 0.373 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 8 = 0.361 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 class 9 = 0.304 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all KL = 0.284 +- 0.240 (in-sample avg dev_std = 0.548)
SUFF++ for r=0.6 all L1 = 0.375 +- 0.161 (in-sample avg dev_std = 0.548)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.196
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.185
SUFF++ for r=0.9 class 0 = 0.311 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 1 = 0.521 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 2 = 0.423 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 3 = 0.379 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 4 = 0.355 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 5 = 0.38 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 6 = 0.379 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 7 = 0.396 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 8 = 0.332 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 class 9 = 0.329 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 all KL = 0.212 +- 0.192 (in-sample avg dev_std = 0.463)
SUFF++ for r=0.9 all L1 = 0.382 +- 0.168 (in-sample avg dev_std = 0.463)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.104
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.463 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 1 = 0.391 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 2 = 0.337 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 3 = 0.425 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 4 = 0.432 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 5 = 0.295 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 6 = 0.386 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 7 = 0.362 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 8 = 0.453 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 class 9 = 0.355 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all KL = 0.39 +- 0.306 (in-sample avg dev_std = 0.404)
NEC for r=0.3 all L1 = 0.391 +- 0.208 (in-sample avg dev_std = 0.404)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.126
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.124
NEC for r=0.6 class 0 = 0.511 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 1 = 0.602 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 2 = 0.292 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 3 = 0.295 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 4 = 0.422 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 5 = 0.323 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 6 = 0.431 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 7 = 0.31 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 8 = 0.442 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 9 = 0.414 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all KL = 0.35 +- 0.283 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all L1 = 0.406 +- 0.245 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.615
NEC for r=0.9 class 0 = 0.521 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 1 = 0.285 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 2 = 0.383 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 3 = 0.537 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 4 = 0.493 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 5 = 0.579 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 6 = 0.483 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 7 = 0.275 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 8 = 0.319 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 class 9 = 0.578 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all KL = 0.536 +- 0.286 (in-sample avg dev_std = 0.420)
NEC for r=0.9 all L1 = 0.439 +- 0.238 (in-sample avg dev_std = 0.420)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.829
NEC for r=1.0 class 0 = 0.154 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 1 = 0.031 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 2 = 0.244 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 3 = 0.395 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 4 = 0.196 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 5 = 0.403 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 6 = 0.277 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 7 = 0.173 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 8 = 0.194 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 class 9 = 0.364 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 all KL = 0.31 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=1.0 all L1 = 0.238 +- 0.236 (in-sample avg dev_std = 0.330)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.127
NEC for r=0.3 class 0 = 0.415 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 1 = 0.357 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 2 = 0.342 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 3 = 0.371 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 4 = 0.412 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 5 = 0.347 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 6 = 0.358 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 7 = 0.401 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 8 = 0.48 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 9 = 0.363 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all KL = 0.376 +- 0.307 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all L1 = 0.384 +- 0.213 (in-sample avg dev_std = 0.399)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.123
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.11
NEC for r=0.6 class 0 = 0.466 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 1 = 0.589 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 2 = 0.27 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 3 = 0.331 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 4 = 0.384 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 5 = 0.341 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 6 = 0.431 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 7 = 0.31 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 8 = 0.411 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 9 = 0.354 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all KL = 0.331 +- 0.265 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all L1 = 0.392 +- 0.234 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.62
NEC for r=0.9 class 0 = 0.475 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 1 = 0.303 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 2 = 0.374 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 3 = 0.548 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 4 = 0.495 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 5 = 0.538 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 6 = 0.498 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 7 = 0.25 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 8 = 0.33 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 class 9 = 0.585 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 all KL = 0.53 +- 0.296 (in-sample avg dev_std = 0.418)
NEC for r=0.9 all L1 = 0.435 +- 0.239 (in-sample avg dev_std = 0.418)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.83
NEC for r=1.0 class 0 = 0.141 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 1 = 0.066 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 2 = 0.287 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 3 = 0.4 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 4 = 0.195 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 5 = 0.354 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 6 = 0.274 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 7 = 0.174 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 8 = 0.167 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 9 = 0.357 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 all KL = 0.307 +- 0.294 (in-sample avg dev_std = 0.329)
NEC for r=1.0 all L1 = 0.238 +- 0.237 (in-sample avg dev_std = 0.329)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.096
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.083
NEC for r=0.3 class 0 = 0.432 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 1 = 0.481 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 2 = 0.455 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 3 = 0.4 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 4 = 0.411 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 5 = 0.43 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 6 = 0.431 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 7 = 0.358 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 8 = 0.382 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 class 9 = 0.37 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 all KL = 0.315 +- 0.252 (in-sample avg dev_std = 0.271)
NEC for r=0.3 all L1 = 0.416 +- 0.180 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.171
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.162
NEC for r=0.6 class 0 = 0.478 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 1 = 0.605 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 2 = 0.537 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 3 = 0.505 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 4 = 0.497 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 5 = 0.473 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 6 = 0.5 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 7 = 0.458 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 8 = 0.433 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 class 9 = 0.496 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all KL = 0.492 +- 0.290 (in-sample avg dev_std = 0.339)
NEC for r=0.6 all L1 = 0.5 +- 0.212 (in-sample avg dev_std = 0.339)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.196
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.249
NEC for r=0.9 class 0 = 0.659 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 1 = 0.41 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 2 = 0.522 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 3 = 0.567 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 4 = 0.529 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 5 = 0.554 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 6 = 0.56 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 7 = 0.501 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 8 = 0.591 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 class 9 = 0.563 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 all KL = 0.606 +- 0.279 (in-sample avg dev_std = 0.367)
NEC for r=0.9 all L1 = 0.544 +- 0.219 (in-sample avg dev_std = 0.367)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.349
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.379
NEC for r=1.0 class 0 = 0.466 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 1 = 0.448 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 2 = 0.549 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 3 = 0.554 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 4 = 0.596 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 5 = 0.597 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 6 = 0.666 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 7 = 0.597 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 8 = 0.614 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 class 9 = 0.633 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all KL = 0.628 +- 0.298 (in-sample avg dev_std = 0.331)
NEC for r=1.0 all L1 = 0.569 +- 0.223 (in-sample avg dev_std = 0.331)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 05:52:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:35 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 05:52:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.9560
Train Loss: 0.1306
ID Validation ACCURACY: 0.8980
ID Validation Loss: 0.3490
ID Test ACCURACY: 0.8904
ID Test Loss: 0.3783
OOD Validation ACCURACY: 0.7471
OOD Validation Loss: 0.9370
OOD Test ACCURACY: 0.3376
OOD Test Loss: 3.7431

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8994
Train Loss: 0.2971
ID Validation ACCURACY: 0.8651
ID Validation Loss: 0.4315
ID Test ACCURACY: 0.8620
ID Test Loss: 0.4423
OOD Validation ACCURACY: 0.8087
OOD Validation Loss: 0.6658
OOD Test ACCURACY: 0.3541
OOD Test Loss: 3.9028

[0m[1;37mINFO[0m: [1mChartInfo 0.8904 0.3376 0.8620 0.3541 0.8651 0.8087[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
SUFF++ for r=0.3 class 0 = 0.377 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 1 = 0.419 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 2 = 0.338 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 3 = 0.376 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 4 = 0.373 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 5 = 0.352 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 6 = 0.386 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 7 = 0.406 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 8 = 0.342 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 class 9 = 0.345 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all KL = 0.334 +- 0.231 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.3 all L1 = 0.373 +- 0.145 (in-sample avg dev_std = 0.496)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.13
SUFF++ for r=0.6 class 0 = 0.468 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 1 = 0.324 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 2 = 0.366 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 3 = 0.366 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 4 = 0.423 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 5 = 0.358 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 6 = 0.327 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 7 = 0.428 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 8 = 0.336 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 class 9 = 0.353 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all KL = 0.291 +- 0.190 (in-sample avg dev_std = 0.430)
SUFF++ for r=0.6 all L1 = 0.375 +- 0.143 (in-sample avg dev_std = 0.430)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.357
SUFF++ for r=0.9 class 0 = 0.252 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 1 = 0.318 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 2 = 0.546 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 3 = 0.322 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 4 = 0.316 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 5 = 0.342 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 6 = 0.357 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 7 = 0.376 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 8 = 0.32 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 class 9 = 0.377 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 all KL = 0.142 +- 0.164 (in-sample avg dev_std = 0.614)
SUFF++ for r=0.9 all L1 = 0.353 +- 0.146 (in-sample avg dev_std = 0.614)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.122
SUFF++ for r=0.3 class 0 = 0.376 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 1 = 0.434 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 2 = 0.318 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 3 = 0.381 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 4 = 0.385 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 5 = 0.428 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 6 = 0.349 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 7 = 0.368 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 8 = 0.35 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 class 9 = 0.36 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 all KL = 0.336 +- 0.238 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.3 all L1 = 0.376 +- 0.152 (in-sample avg dev_std = 0.491)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.149
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.135
SUFF++ for r=0.6 class 0 = 0.455 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1 = 0.309 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 2 = 0.366 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 3 = 0.361 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 4 = 0.399 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 5 = 0.331 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 6 = 0.339 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 7 = 0.428 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 8 = 0.325 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 9 = 0.352 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.275 +- 0.186 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.366 +- 0.138 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.767
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.372
SUFF++ for r=0.9 class 0 = 0.266 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 1 = 0.308 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 2 = 0.536 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 3 = 0.316 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 4 = 0.322 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 5 = 0.346 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 6 = 0.355 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 7 = 0.399 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 8 = 0.314 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 class 9 = 0.347 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 all KL = 0.14 +- 0.161 (in-sample avg dev_std = 0.630)
SUFF++ for r=0.9 all L1 = 0.35 +- 0.139 (in-sample avg dev_std = 0.630)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.407 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 1 = 0.335 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 2 = 0.427 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 3 = 0.392 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 4 = 0.396 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 5 = 0.4 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 6 = 0.358 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 7 = 0.414 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 8 = 0.368 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 class 9 = 0.352 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all KL = 0.255 +- 0.220 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.3 all L1 = 0.385 +- 0.116 (in-sample avg dev_std = 0.440)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.134
SUFF++ for r=0.6 class 0 = 0.754 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1 = 0.316 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 2 = 0.753 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 3 = 0.709 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 4 = 0.589 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 5 = 0.722 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 6 = 0.68 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 7 = 0.694 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 8 = 0.634 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 9 = 0.483 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.522 +- 0.359 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.63 +- 0.292 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.225
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.19
SUFF++ for r=0.9 class 0 = 0.292 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 1 = 0.445 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 2 = 0.385 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 3 = 0.337 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 4 = 0.32 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 5 = 0.318 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 6 = 0.322 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 7 = 0.333 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 8 = 0.293 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 class 9 = 0.316 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 all KL = 0.218 +- 0.243 (in-sample avg dev_std = 0.487)
SUFF++ for r=0.9 all L1 = 0.338 +- 0.182 (in-sample avg dev_std = 0.487)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.129
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
NEC for r=0.3 class 0 = 0.617 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 1 = 0.528 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 2 = 0.655 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 3 = 0.628 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 4 = 0.615 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 5 = 0.599 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 6 = 0.627 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 7 = 0.606 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 8 = 0.653 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 class 9 = 0.588 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all KL = 0.646 +- 0.248 (in-sample avg dev_std = 0.443)
NEC for r=0.3 all L1 = 0.611 +- 0.161 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.128
NEC for r=0.6 class 0 = 0.557 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 1 = 0.571 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 2 = 0.591 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 3 = 0.592 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 4 = 0.57 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 5 = 0.633 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 6 = 0.62 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 7 = 0.567 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 8 = 0.648 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 class 9 = 0.613 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 all KL = 0.654 +- 0.214 (in-sample avg dev_std = 0.410)
NEC for r=0.6 all L1 = 0.595 +- 0.152 (in-sample avg dev_std = 0.410)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.762
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.628
NEC for r=0.9 class 0 = 0.607 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 1 = 0.305 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 2 = 0.337 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 3 = 0.466 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 4 = 0.473 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 5 = 0.474 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 6 = 0.54 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 7 = 0.397 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 8 = 0.351 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 class 9 = 0.574 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 all KL = 0.554 +- 0.287 (in-sample avg dev_std = 0.440)
NEC for r=0.9 all L1 = 0.449 +- 0.236 (in-sample avg dev_std = 0.440)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0 = 0.119 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 1 = 0.053 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 2 = 0.229 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 3 = 0.296 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 4 = 0.223 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 5 = 0.314 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 6 = 0.28 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 7 = 0.202 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 8 = 0.223 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 9 = 0.341 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all KL = 0.301 +- 0.300 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all L1 = 0.224 +- 0.234 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.593 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 1 = 0.518 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 2 = 0.679 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 3 = 0.652 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 4 = 0.627 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 5 = 0.594 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 6 = 0.624 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 7 = 0.618 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 8 = 0.64 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 9 = 0.608 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all KL = 0.655 +- 0.255 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all L1 = 0.614 +- 0.161 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.149
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.138
NEC for r=0.6 class 0 = 0.528 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 1 = 0.587 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 2 = 0.585 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 3 = 0.603 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 4 = 0.61 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 5 = 0.615 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 6 = 0.574 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 7 = 0.56 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 8 = 0.634 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 class 9 = 0.577 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 all KL = 0.65 +- 0.214 (in-sample avg dev_std = 0.409)
NEC for r=0.6 all L1 = 0.587 +- 0.155 (in-sample avg dev_std = 0.409)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.767
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.624
NEC for r=0.9 class 0 = 0.592 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 1 = 0.384 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 2 = 0.37 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 3 = 0.447 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 4 = 0.469 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 5 = 0.468 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 6 = 0.554 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 7 = 0.346 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 8 = 0.362 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 class 9 = 0.583 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all KL = 0.565 +- 0.275 (in-sample avg dev_std = 0.445)
NEC for r=0.9 all L1 = 0.455 +- 0.229 (in-sample avg dev_std = 0.445)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.845
NEC for r=1.0 class 0 = 0.129 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 1 = 0.074 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 2 = 0.313 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 3 = 0.302 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 4 = 0.215 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 5 = 0.305 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 6 = 0.262 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 7 = 0.162 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 8 = 0.207 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 class 9 = 0.331 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all KL = 0.306 +- 0.292 (in-sample avg dev_std = 0.341)
NEC for r=1.0 all L1 = 0.227 +- 0.230 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.121
NEC for r=0.3 class 0 = 0.52 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 1 = 0.598 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 2 = 0.497 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 3 = 0.537 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 4 = 0.538 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 5 = 0.502 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 6 = 0.541 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 7 = 0.547 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 8 = 0.544 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 class 9 = 0.59 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all KL = 0.567 +- 0.272 (in-sample avg dev_std = 0.371)
NEC for r=0.3 all L1 = 0.542 +- 0.164 (in-sample avg dev_std = 0.371)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.138
NEC for r=0.6 class 0 = 0.263 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 1 = 0.749 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 2 = 0.236 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 3 = 0.284 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 4 = 0.461 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 5 = 0.255 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 6 = 0.352 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 7 = 0.298 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 8 = 0.405 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 9 = 0.591 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 all KL = 0.472 +- 0.390 (in-sample avg dev_std = 0.247)
NEC for r=0.6 all L1 = 0.393 +- 0.328 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.225
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.25
NEC for r=0.9 class 0 = 0.613 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 1 = 0.461 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 2 = 0.617 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 3 = 0.654 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 4 = 0.704 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 5 = 0.666 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 6 = 0.699 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 7 = 0.663 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 8 = 0.698 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 class 9 = 0.737 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 all KL = 0.725 +- 0.294 (in-sample avg dev_std = 0.317)
NEC for r=0.9 all L1 = 0.648 +- 0.228 (in-sample avg dev_std = 0.317)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.314
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.362
NEC for r=1.0 class 0 = 0.615 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 1 = 0.427 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 2 = 0.618 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 3 = 0.618 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 4 = 0.681 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 5 = 0.593 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 6 = 0.692 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 7 = 0.623 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 8 = 0.702 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 class 9 = 0.703 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 all KL = 0.694 +- 0.284 (in-sample avg dev_std = 0.332)
NEC for r=1.0 all L1 = 0.625 +- 0.220 (in-sample avg dev_std = 0.332)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscoresannealavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 06:14:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: anneal
[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 06:14:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ACCURACY: 0.9600
Train Loss: 0.1158
ID Validation ACCURACY: 0.8977
ID Validation Loss: 0.3490
ID Test ACCURACY: 0.8894
ID Test Loss: 0.3533
OOD Validation ACCURACY: 0.7770
OOD Validation Loss: 0.8954
OOD Test ACCURACY: 0.2434
OOD Test Loss: 10.5612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 161...
[0m[1;37mINFO[0m: [1mCheckpoint 161: 
-----------------------------------
Train ACCURACY: 0.9438
Train Loss: 0.1631
ID Validation ACCURACY: 0.8856
ID Validation Loss: 0.3599
ID Test ACCURACY: 0.8901
ID Test Loss: 0.3700
OOD Validation ACCURACY: 0.8203
OOD Validation Loss: 0.6504
OOD Test ACCURACY: 0.3961
OOD Test Loss: 3.0575

[0m[1;37mINFO[0m: [1mChartInfo 0.8894 0.2434 0.8901 0.3961 0.8856 0.8203[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.127
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
SUFF++ for r=0.3 class 0 = 0.545 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 1 = 0.685 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 2 = 0.537 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 3 = 0.558 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 4 = 0.611 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 5 = 0.627 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 6 = 0.599 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 7 = 0.748 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 8 = 0.454 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 class 9 = 0.602 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all KL = 0.51 +- 0.275 (in-sample avg dev_std = 0.414)
SUFF++ for r=0.3 all L1 = 0.599 +- 0.231 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.131
SUFF++ for r=0.6 class 0 = 0.39 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 1 = 0.51 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 2 = 0.514 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 3 = 0.437 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 4 = 0.446 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 5 = 0.455 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 6 = 0.482 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 7 = 0.562 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 8 = 0.371 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 9 = 0.389 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all KL = 0.315 +- 0.239 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all L1 = 0.458 +- 0.188 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.369
SUFF++ for r=0.9 class 0 = 0.271 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 1 = 0.28 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 2 = 0.481 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 3 = 0.344 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 4 = 0.401 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 5 = 0.264 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 6 = 0.309 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 7 = 0.593 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 8 = 0.312 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 class 9 = 0.335 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 all KL = 0.161 +- 0.202 (in-sample avg dev_std = 0.600)
SUFF++ for r=0.9 all L1 = 0.362 +- 0.166 (in-sample avg dev_std = 0.600)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
SUFF++ for r=0.3 class 0 = 0.618 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 1 = 0.661 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 2 = 0.584 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 3 = 0.528 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 4 = 0.619 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 5 = 0.656 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 6 = 0.629 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 7 = 0.769 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 8 = 0.51 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 class 9 = 0.649 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 all KL = 0.536 +- 0.287 (in-sample avg dev_std = 0.395)
SUFF++ for r=0.3 all L1 = 0.624 +- 0.239 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
SUFF++ for r=0.6 class 0 = 0.392 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 1 = 0.501 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 2 = 0.521 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 3 = 0.496 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 4 = 0.43 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 5 = 0.415 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 6 = 0.445 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 7 = 0.568 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 8 = 0.368 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 class 9 = 0.437 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all KL = 0.307 +- 0.236 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.6 all L1 = 0.459 +- 0.192 (in-sample avg dev_std = 0.507)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.345
SUFF++ for r=0.9 class 0 = 0.266 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 1 = 0.276 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 2 = 0.466 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 3 = 0.327 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 4 = 0.399 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 5 = 0.286 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 6 = 0.297 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 7 = 0.588 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 8 = 0.301 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 class 9 = 0.337 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 all KL = 0.16 +- 0.207 (in-sample avg dev_std = 0.589)
SUFF++ for r=0.9 all L1 = 0.355 +- 0.168 (in-sample avg dev_std = 0.589)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.14
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.558 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 1 = 0.37 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 2 = 0.578 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 3 = 0.537 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 4 = 0.579 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 5 = 0.592 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 6 = 0.519 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 7 = 0.571 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 8 = 0.556 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 class 9 = 0.524 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all KL = 0.416 +- 0.306 (in-sample avg dev_std = 0.415)
SUFF++ for r=0.3 all L1 = 0.536 +- 0.246 (in-sample avg dev_std = 0.415)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.136
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
SUFF++ for r=0.6 class 0 = 0.414 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 1 = 0.453 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 2 = 0.38 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 3 = 0.36 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 4 = 0.429 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 5 = 0.384 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 6 = 0.455 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 7 = 0.428 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 8 = 0.401 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 class 9 = 0.443 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 all KL = 0.27 +- 0.277 (in-sample avg dev_std = 0.493)
SUFF++ for r=0.6 all L1 = 0.415 +- 0.225 (in-sample avg dev_std = 0.493)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.164
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.147
SUFF++ for r=0.9 class 0 = 0.373 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 1 = 0.641 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 2 = 0.387 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 3 = 0.4 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 4 = 0.356 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 5 = 0.399 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 6 = 0.376 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 7 = 0.373 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 8 = 0.334 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 class 9 = 0.381 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 all KL = 0.24 +- 0.268 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.9 all L1 = 0.405 +- 0.229 (in-sample avg dev_std = 0.497)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.127
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.511 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 1 = 0.298 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 2 = 0.509 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 3 = 0.511 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 4 = 0.405 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 5 = 0.447 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 6 = 0.405 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 7 = 0.258 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 8 = 0.568 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 9 = 0.369 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all KL = 0.513 +- 0.325 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all L1 = 0.426 +- 0.260 (in-sample avg dev_std = 0.394)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
NEC for r=0.6 class 0 = 0.576 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 1 = 0.394 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 2 = 0.421 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 3 = 0.454 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 4 = 0.525 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 5 = 0.505 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 6 = 0.453 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 7 = 0.333 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 8 = 0.526 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 9 = 0.566 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 all KL = 0.524 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 all L1 = 0.471 +- 0.235 (in-sample avg dev_std = 0.412)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.623
NEC for r=0.9 class 0 = 0.495 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 1 = 0.42 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 2 = 0.384 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 3 = 0.469 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 4 = 0.394 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 5 = 0.629 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 6 = 0.533 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 7 = 0.329 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 8 = 0.403 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 class 9 = 0.534 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all KL = 0.58 +- 0.284 (in-sample avg dev_std = 0.450)
NEC for r=0.9 all L1 = 0.454 +- 0.228 (in-sample avg dev_std = 0.450)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.85
NEC for r=1.0 class 0 = 0.113 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 1 = 0.017 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 2 = 0.21 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 3 = 0.277 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 4 = 0.185 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 5 = 0.356 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 6 = 0.277 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 7 = 0.195 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 8 = 0.217 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 class 9 = 0.347 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 all KL = 0.292 +- 0.286 (in-sample avg dev_std = 0.324)
NEC for r=1.0 all L1 = 0.214 +- 0.225 (in-sample avg dev_std = 0.324)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
NEC for r=0.3 class 0 = 0.503 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 1 = 0.323 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 2 = 0.466 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 3 = 0.517 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 4 = 0.408 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 5 = 0.422 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 6 = 0.388 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 7 = 0.28 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 8 = 0.518 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 class 9 = 0.362 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all KL = 0.506 +- 0.334 (in-sample avg dev_std = 0.397)
NEC for r=0.3 all L1 = 0.416 +- 0.263 (in-sample avg dev_std = 0.397)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.131
NEC for r=0.6 class 0 = 0.503 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 1 = 0.413 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 2 = 0.404 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 3 = 0.416 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 4 = 0.509 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 5 = 0.497 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 6 = 0.463 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 7 = 0.315 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 8 = 0.546 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 class 9 = 0.505 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 all KL = 0.508 +- 0.294 (in-sample avg dev_std = 0.412)
NEC for r=0.6 all L1 = 0.455 +- 0.235 (in-sample avg dev_std = 0.412)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.78
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.613
NEC for r=0.9 class 0 = 0.461 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 1 = 0.418 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 2 = 0.412 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 3 = 0.454 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 4 = 0.419 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 5 = 0.6 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 6 = 0.523 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 7 = 0.358 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 8 = 0.404 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 class 9 = 0.558 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all KL = 0.579 +- 0.287 (in-sample avg dev_std = 0.435)
NEC for r=0.9 all L1 = 0.458 +- 0.234 (in-sample avg dev_std = 0.435)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.853
NEC for r=1.0 class 0 = 0.11 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 1 = 0.041 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 2 = 0.272 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 3 = 0.301 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 4 = 0.182 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 5 = 0.327 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 6 = 0.259 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 7 = 0.198 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 8 = 0.214 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 class 9 = 0.315 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all KL = 0.297 +- 0.287 (in-sample avg dev_std = 0.325)
NEC for r=1.0 all L1 = 0.219 +- 0.226 (in-sample avg dev_std = 0.325)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.14
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
NEC for r=0.3 class 0 = 0.45 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1 = 0.611 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 2 = 0.394 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 3 = 0.433 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 4 = 0.38 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 5 = 0.381 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 6 = 0.401 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 7 = 0.392 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 8 = 0.394 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 9 = 0.455 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.467 +- 0.347 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.432 +- 0.281 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.136
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.155
NEC for r=0.6 class 0 = 0.531 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 1 = 0.681 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 2 = 0.554 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 3 = 0.532 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 4 = 0.549 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 5 = 0.457 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 6 = 0.501 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 7 = 0.473 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 8 = 0.488 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 class 9 = 0.563 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 all KL = 0.6 +- 0.354 (in-sample avg dev_std = 0.364)
NEC for r=0.6 all L1 = 0.536 +- 0.277 (in-sample avg dev_std = 0.364)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.164
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.199
NEC for r=0.9 class 0 = 0.577 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 1 = 0.484 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 2 = 0.585 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 3 = 0.562 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 4 = 0.669 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 5 = 0.605 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 6 = 0.615 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 7 = 0.612 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 8 = 0.681 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 9 = 0.699 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 all KL = 0.725 +- 0.305 (in-sample avg dev_std = 0.412)
NEC for r=0.9 all L1 = 0.607 +- 0.252 (in-sample avg dev_std = 0.412)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.254
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.269
NEC for r=1.0 class 0 = 0.483 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 1 = 0.46 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 2 = 0.569 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 3 = 0.473 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 4 = 0.709 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 5 = 0.61 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 6 = 0.592 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 7 = 0.619 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 8 = 0.587 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 class 9 = 0.672 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 all KL = 0.652 +- 0.342 (in-sample avg dev_std = 0.318)
NEC for r=1.0 all L1 = 0.575 +- 0.280 (in-sample avg dev_std = 0.318)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.339, 0.24, 0.169, 1.0], 'all_L1': [0.427, 0.38, 0.374, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.569, 0.355, 0.148, 1.0], 'all_L1': [0.544, 0.411, 0.368, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.628, 0.596, 0.169, 1.0], 'all_L1': [0.598, 0.561, 0.354, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.334, 0.291, 0.142, 1.0], 'all_L1': [0.373, 0.375, 0.353, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.315, 0.161, 1.0], 'all_L1': [0.599, 0.458, 0.362, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.498, 0.562, 0.563, 0.313], 'all_L1': [0.497, 0.516, 0.442, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.507, 0.588, 0.299], 'all_L1': [0.463, 0.517, 0.45, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.39, 0.35, 0.536, 0.31], 'all_L1': [0.391, 0.406, 0.439, 0.238]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.654, 0.554, 0.301], 'all_L1': [0.611, 0.595, 0.449, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.524, 0.58, 0.292], 'all_L1': [0.426, 0.471, 0.454, 0.214]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.339, 0.247, 0.169, 1.0], 'all_L1': [0.426, 0.377, 0.369, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.577, 0.38, 0.153, 1.0], 'all_L1': [0.554, 0.423, 0.363, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.644, 0.605, 0.175, 1.0], 'all_L1': [0.603, 0.569, 0.358, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.336, 0.275, 0.14, 1.0], 'all_L1': [0.376, 0.366, 0.35, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.536, 0.307, 0.16, 1.0], 'all_L1': [0.624, 0.459, 0.355, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.48, 0.578, 0.561, 0.316], 'all_L1': [0.479, 0.531, 0.438, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.435, 0.503, 0.574, 0.301], 'all_L1': [0.458, 0.517, 0.45, 0.224]}), defaultdict(<class 'list'>, {'all_KL': [0.376, 0.331, 0.53, 0.307], 'all_L1': [0.384, 0.392, 0.435, 0.238]}), defaultdict(<class 'list'>, {'all_KL': [0.655, 0.65, 0.565, 0.306], 'all_L1': [0.614, 0.587, 0.455, 0.227]}), defaultdict(<class 'list'>, {'all_KL': [0.506, 0.508, 0.579, 0.297], 'all_L1': [0.416, 0.455, 0.458, 0.219]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.12, 0.344, 0.34, 1.0], 'all_L1': [0.4, 0.513, 0.419, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.372, 0.333, 0.234, 1.0], 'all_L1': [0.468, 0.458, 0.386, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.611, 0.284, 0.212, 1.0], 'all_L1': [0.518, 0.375, 0.382, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.255, 0.522, 0.218, 1.0], 'all_L1': [0.385, 0.63, 0.338, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.27, 0.24, 1.0], 'all_L1': [0.536, 0.415, 0.405, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.512, 0.411, 0.643, 0.681], 'all_L1': [0.496, 0.374, 0.577, 0.618]}), defaultdict(<class 'list'>, {'all_KL': [0.536, 0.683, 0.627, 0.489], 'all_L1': [0.485, 0.598, 0.531, 0.411]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.492, 0.606, 0.628], 'all_L1': [0.416, 0.5, 0.544, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.472, 0.725, 0.694], 'all_L1': [0.542, 0.393, 0.648, 0.625]}), defaultdict(<class 'list'>, {'all_KL': [0.467, 0.6, 0.725, 0.652], 'all_L1': [0.432, 0.536, 0.607, 0.575]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.508 +- 0.092, 0.437 +- 0.069, 0.362 +- 0.008, 1.000 +- 0.000
suff++ class all_KL  =  0.476 +- 0.120, 0.359 +- 0.124, 0.158 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.114 +- 0.005, 0.123 +- 0.011, 0.366 +- 0.010
nec class all_L1  =  0.478 +- 0.076, 0.501 +- 0.062, 0.447 +- 0.005, 0.224 +- 0.008
nec class all_KL  =  0.497 +- 0.087, 0.519 +- 0.099, 0.564 +- 0.019, 0.303 +- 0.008
nec_acc_int  =  0.120 +- 0.007, 0.124 +- 0.005, 0.624 +- 0.008, 0.841 +- 0.007

Eval split id_test
suff++ class all_L1  =  0.517 +- 0.098, 0.439 +- 0.073, 0.359 +- 0.007, 1.000 +- 0.000
suff++ class all_KL  =  0.486 +- 0.126, 0.363 +- 0.129, 0.159 +- 0.012, 1.000 +- 0.000
suff++_acc_int  =  0.113 +- 0.006, 0.123 +- 0.010, 0.366 +- 0.011
nec class all_L1  =  0.470 +- 0.079, 0.496 +- 0.067, 0.447 +- 0.009, 0.226 +- 0.006
nec class all_KL  =  0.490 +- 0.093, 0.514 +- 0.106, 0.562 +- 0.017, 0.305 +- 0.006
nec_acc_int  =  0.113 +- 0.012, 0.124 +- 0.009, 0.622 +- 0.007, 0.842 +- 0.007

Eval split test
suff++ class all_L1  =  0.461 +- 0.061, 0.478 +- 0.089, 0.386 +- 0.027, 1.000 +- 0.000
suff++ class all_KL  =  0.355 +- 0.164, 0.351 +- 0.090, 0.249 +- 0.047, 1.000 +- 0.000
suff++_acc_int  =  0.108 +- 0.007, 0.129 +- 0.005, 0.166 +- 0.018
nec class all_L1  =  0.474 +- 0.046, 0.480 +- 0.085, 0.581 +- 0.043, 0.560 +- 0.078
nec class all_KL  =  0.479 +- 0.088, 0.532 +- 0.097, 0.665 +- 0.050, 0.629 +- 0.074
nec_acc_int  =  0.111 +- 0.018, 0.148 +- 0.016, 0.225 +- 0.021, 0.324 +- 0.043


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.493 +- 0.017, 0.469 +- 0.014, 0.405 +- 0.005, 0.612 +- 0.004
Faith. Armon (L1)= 		  =  0.479 +- 0.017, 0.458 +- 0.011, 0.400 +- 0.005, 0.366 +- 0.011
Faith. GMean (L1)= 	  =  0.486 +- 0.016, 0.464 +- 0.012, 0.402 +- 0.005, 0.473 +- 0.008
Faith. Aritm (KL)= 		  =  0.486 +- 0.035, 0.439 +- 0.029, 0.361 +- 0.009, 0.652 +- 0.004
Faith. Armon (KL)= 		  =  0.466 +- 0.039, 0.398 +- 0.035, 0.246 +- 0.013, 0.465 +- 0.009
Faith. GMean (KL)= 	  =  0.476 +- 0.036, 0.418 +- 0.030, 0.298 +- 0.010, 0.550 +- 0.007

Eval split id_test
Faith. Aritm (L1)= 		  =  0.493 +- 0.023, 0.468 +- 0.010, 0.403 +- 0.004, 0.613 +- 0.003
Faith. Armon (L1)= 		  =  0.477 +- 0.020, 0.456 +- 0.009, 0.398 +- 0.003, 0.369 +- 0.008
Faith. GMean (L1)= 	  =  0.485 +- 0.020, 0.462 +- 0.009, 0.401 +- 0.003, 0.476 +- 0.007
Faith. Aritm (KL)= 		  =  0.488 +- 0.040, 0.438 +- 0.025, 0.361 +- 0.007, 0.653 +- 0.003
Faith. Armon (KL)= 		  =  0.467 +- 0.043, 0.395 +- 0.032, 0.248 +- 0.014, 0.468 +- 0.008
Faith. GMean (KL)= 	  =  0.477 +- 0.040, 0.416 +- 0.026, 0.299 +- 0.010, 0.553 +- 0.006

Eval split test
Faith. Aritm (L1)= 		  =  0.468 +- 0.012, 0.479 +- 0.036, 0.484 +- 0.019, 0.780 +- 0.039
Faith. Armon (L1)= 		  =  0.462 +- 0.014, 0.466 +- 0.034, 0.462 +- 0.019, 0.714 +- 0.068
Faith. GMean (L1)= 	  =  0.465 +- 0.013, 0.473 +- 0.035, 0.473 +- 0.018, 0.746 +- 0.054
Faith. Aritm (KL)= 		  =  0.417 +- 0.054, 0.441 +- 0.054, 0.457 +- 0.032, 0.814 +- 0.037
Faith. Armon (KL)= 		  =  0.368 +- 0.093, 0.410 +- 0.053, 0.359 +- 0.045, 0.769 +- 0.059
Faith. GMean (KL)= 	  =  0.391 +- 0.075, 0.425 +- 0.052, 0.405 +- 0.037, 0.792 +- 0.048
Computed for split load_split = id



Completed in  1:51:19.781779  for GSATvGIN GOODCMNIST/color



DONE GSAT GOODCMNIST/color anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 06:37:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:44 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 06:37:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 0.9605
Train Loss: 0.1156
ID Validation ACCURACY: 0.8974
ID Validation Loss: 0.3527
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3716
OOD Validation ACCURACY: 0.7814
OOD Validation Loss: 0.8893
OOD Test ACCURACY: 0.3167
OOD Test Loss: 5.4701

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9435
Train Loss: 0.1595
ID Validation ACCURACY: 0.8917
ID Validation Loss: 0.3561
ID Test ACCURACY: 0.8850
ID Test Loss: 0.3762
OOD Validation ACCURACY: 0.8176
OOD Validation Loss: 0.6707
OOD Test ACCURACY: 0.3639
OOD Test Loss: 3.8637

[0m[1;37mINFO[0m: [1mChartInfo 0.8920 0.3167 0.8850 0.3639 0.8917 0.8176[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.332 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 1 = 0.403 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 2 = 0.344 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 3 = 0.354 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 4 = 0.378 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 5 = 0.373 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 6 = 0.396 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 7 = 0.395 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 8 = 0.376 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 class 9 = 0.407 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all KL = 0.265 +- 0.225 (in-sample avg dev_std = 0.542)
SUFF++ for r=0.3 all L1 = 0.376 +- 0.122 (in-sample avg dev_std = 0.542)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.114
SUFF++ for r=0.6 class 0 = 0.405 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 1 = 0.437 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 2 = 0.411 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 3 = 0.4 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 4 = 0.372 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 5 = 0.386 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 6 = 0.387 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 7 = 0.407 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 8 = 0.385 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 class 9 = 0.443 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 all KL = 0.315 +- 0.232 (in-sample avg dev_std = 0.500)
SUFF++ for r=0.6 all L1 = 0.404 +- 0.117 (in-sample avg dev_std = 0.500)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.126
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.106
SUFF++ for r=0.9 class 0 = 0.52 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 1 = 0.376 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 2 = 0.503 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 3 = 0.456 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 4 = 0.463 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 5 = 0.439 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 6 = 0.443 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 7 = 0.447 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 8 = 0.453 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 9 = 0.479 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 all KL = 0.331 +- 0.230 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 all L1 = 0.457 +- 0.176 (in-sample avg dev_std = 0.439)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.132
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.329 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 1 = 0.413 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 2 = 0.35 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 3 = 0.373 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 4 = 0.378 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 5 = 0.401 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 6 = 0.401 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 7 = 0.399 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 8 = 0.384 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 class 9 = 0.409 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 all KL = 0.281 +- 0.229 (in-sample avg dev_std = 0.540)
SUFF++ for r=0.3 all L1 = 0.385 +- 0.126 (in-sample avg dev_std = 0.540)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.111
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
SUFF++ for r=0.6 class 0 = 0.422 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 1 = 0.461 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 2 = 0.405 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 3 = 0.412 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 4 = 0.371 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 5 = 0.377 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 6 = 0.387 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 7 = 0.41 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 8 = 0.38 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 class 9 = 0.416 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all KL = 0.333 +- 0.238 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.6 all L1 = 0.405 +- 0.125 (in-sample avg dev_std = 0.484)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.114
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.101
SUFF++ for r=0.9 class 0 = 0.526 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 1 = 0.38 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 2 = 0.512 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 3 = 0.447 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 4 = 0.427 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 5 = 0.487 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 6 = 0.459 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 7 = 0.421 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 8 = 0.47 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 class 9 = 0.418 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 all KL = 0.324 +- 0.232 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.9 all L1 = 0.453 +- 0.176 (in-sample avg dev_std = 0.446)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
SUFF++ for r=0.3 class 0 = 0.365 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 1 = 0.364 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 2 = 0.358 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 3 = 0.363 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 4 = 0.313 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 5 = 0.393 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 6 = 0.364 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 7 = 0.395 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 8 = 0.312 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 9 = 0.352 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all KL = 0.275 +- 0.219 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all L1 = 0.358 +- 0.120 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.102
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.124
SUFF++ for r=0.6 class 0 = 0.413 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.3 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.366 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 3 = 0.351 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 4 = 0.319 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 5 = 0.361 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 6 = 0.338 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 7 = 0.329 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 8 = 0.343 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 9 = 0.339 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.261 +- 0.214 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.346 +- 0.127 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.16
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.137
SUFF++ for r=0.9 class 0 = 0.558 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 1 = 0.417 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 2 = 0.514 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 3 = 0.542 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 4 = 0.402 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 5 = 0.569 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 6 = 0.388 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 7 = 0.426 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 8 = 0.466 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 class 9 = 0.425 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 all KL = 0.408 +- 0.301 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.9 all L1 = 0.47 +- 0.249 (in-sample avg dev_std = 0.363)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.124
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.131
NEC for r=0.3 class 0 = 0.651 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 1 = 0.479 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 2 = 0.687 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 3 = 0.67 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 4 = 0.605 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 5 = 0.697 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 6 = 0.603 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 7 = 0.549 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 8 = 0.631 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 class 9 = 0.548 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 all KL = 0.701 +- 0.303 (in-sample avg dev_std = 0.489)
NEC for r=0.3 all L1 = 0.61 +- 0.171 (in-sample avg dev_std = 0.489)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.121
NEC for r=0.6 class 0 = 0.445 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 1 = 0.462 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 2 = 0.516 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 3 = 0.538 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 4 = 0.581 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 5 = 0.565 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 6 = 0.565 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 7 = 0.531 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 8 = 0.538 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 class 9 = 0.474 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all KL = 0.58 +- 0.281 (in-sample avg dev_std = 0.447)
NEC for r=0.6 all L1 = 0.52 +- 0.197 (in-sample avg dev_std = 0.447)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.126
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.115
NEC for r=0.9 class 0 = 0.314 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 1 = 0.578 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 2 = 0.38 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 3 = 0.49 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 4 = 0.454 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 5 = 0.515 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 6 = 0.471 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 7 = 0.49 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 8 = 0.464 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 9 = 0.425 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all KL = 0.521 +- 0.264 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all L1 = 0.459 +- 0.215 (in-sample avg dev_std = 0.413)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.12
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.118
NEC for r=1.0 class 0 = 0.299 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 1 = 0.603 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 2 = 0.324 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 3 = 0.456 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 4 = 0.426 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 5 = 0.499 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 6 = 0.424 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 7 = 0.474 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 8 = 0.438 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 class 9 = 0.401 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 all KL = 0.504 +- 0.271 (in-sample avg dev_std = 0.409)
NEC for r=1.0 all L1 = 0.436 +- 0.226 (in-sample avg dev_std = 0.409)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.132
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.13
NEC for r=0.3 class 0 = 0.652 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 1 = 0.471 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 2 = 0.699 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 3 = 0.685 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 4 = 0.608 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 5 = 0.646 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 6 = 0.638 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 7 = 0.589 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 8 = 0.644 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 class 9 = 0.561 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all KL = 0.705 +- 0.307 (in-sample avg dev_std = 0.494)
NEC for r=0.3 all L1 = 0.616 +- 0.168 (in-sample avg dev_std = 0.494)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.111
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
NEC for r=0.6 class 0 = 0.518 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 1 = 0.451 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 2 = 0.512 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 3 = 0.54 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 4 = 0.561 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 5 = 0.559 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 6 = 0.548 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 7 = 0.506 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 8 = 0.547 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 class 9 = 0.502 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 all KL = 0.584 +- 0.275 (in-sample avg dev_std = 0.442)
NEC for r=0.6 all L1 = 0.523 +- 0.195 (in-sample avg dev_std = 0.442)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.114
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.109
NEC for r=0.9 class 0 = 0.341 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 1 = 0.519 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 2 = 0.354 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 3 = 0.45 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 4 = 0.517 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 5 = 0.421 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 6 = 0.488 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 7 = 0.455 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 8 = 0.472 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 9 = 0.503 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 all KL = 0.519 +- 0.271 (in-sample avg dev_std = 0.410)
NEC for r=0.9 all L1 = 0.454 +- 0.219 (in-sample avg dev_std = 0.410)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.108
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.108
NEC for r=1.0 class 0 = 0.299 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 1 = 0.563 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 2 = 0.34 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 3 = 0.429 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 4 = 0.474 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 5 = 0.368 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 6 = 0.446 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 7 = 0.426 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 8 = 0.458 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 class 9 = 0.461 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 all KL = 0.501 +- 0.273 (in-sample avg dev_std = 0.408)
NEC for r=1.0 all L1 = 0.43 +- 0.221 (in-sample avg dev_std = 0.408)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
NEC for r=0.3 class 0 = 0.584 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 1 = 0.55 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 2 = 0.567 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 3 = 0.587 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 4 = 0.574 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 5 = 0.587 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 6 = 0.577 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 7 = 0.585 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 8 = 0.592 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 class 9 = 0.544 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all KL = 0.613 +- 0.256 (in-sample avg dev_std = 0.423)
NEC for r=0.3 all L1 = 0.575 +- 0.156 (in-sample avg dev_std = 0.423)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.102
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.115
NEC for r=0.6 class 0 = 0.564 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 1 = 0.562 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 2 = 0.59 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 3 = 0.579 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 4 = 0.613 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 5 = 0.56 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 6 = 0.586 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 7 = 0.524 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 8 = 0.632 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 class 9 = 0.612 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 all KL = 0.661 +- 0.252 (in-sample avg dev_std = 0.435)
NEC for r=0.6 all L1 = 0.582 +- 0.167 (in-sample avg dev_std = 0.435)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.16
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.13
NEC for r=0.9 class 0 = 0.447 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 1 = 0.56 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 2 = 0.478 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 3 = 0.46 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 4 = 0.592 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 5 = 0.486 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 6 = 0.612 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 7 = 0.564 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 8 = 0.545 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 9 = 0.584 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all KL = 0.613 +- 0.273 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all L1 = 0.532 +- 0.209 (in-sample avg dev_std = 0.436)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.16
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.139
NEC for r=1.0 class 0 = 0.386 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 1 = 0.517 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 2 = 0.404 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 3 = 0.41 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 4 = 0.589 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 5 = 0.432 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 6 = 0.591 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 7 = 0.572 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 8 = 0.492 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 class 9 = 0.55 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 all KL = 0.585 +- 0.285 (in-sample avg dev_std = 0.439)
NEC for r=1.0 all L1 = 0.493 +- 0.221 (in-sample avg dev_std = 0.439)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 06:59:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:39 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 06:59:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9587
Train Loss: 0.1208
ID Validation ACCURACY: 0.8981
ID Validation Loss: 0.3445
ID Test ACCURACY: 0.8943
ID Test Loss: 0.3504
OOD Validation ACCURACY: 0.7307
OOD Validation Loss: 1.2617
OOD Test ACCURACY: 0.1936
OOD Test Loss: 31.8212

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9245
Train Loss: 0.2209
ID Validation ACCURACY: 0.8821
ID Validation Loss: 0.3641
ID Test ACCURACY: 0.8807
ID Test Loss: 0.3714
OOD Validation ACCURACY: 0.7910
OOD Validation Loss: 0.6779
OOD Test ACCURACY: 0.3180
OOD Test Loss: 4.2292

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.1936 0.8807 0.3180 0.8821 0.7910[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.131
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.113
SUFF++ for r=0.3 class 0 = 0.475 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 1 = 0.48 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 2 = 0.395 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 3 = 0.432 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 4 = 0.473 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 5 = 0.473 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 6 = 0.487 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 7 = 0.576 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 8 = 0.474 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 class 9 = 0.513 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all KL = 0.421 +- 0.307 (in-sample avg dev_std = 0.497)
SUFF++ for r=0.3 all L1 = 0.478 +- 0.206 (in-sample avg dev_std = 0.497)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.116
SUFF++ for r=0.6 class 0 = 0.417 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 1 = 0.624 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 2 = 0.386 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 3 = 0.462 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 4 = 0.501 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 5 = 0.455 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 6 = 0.507 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 7 = 0.645 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 8 = 0.432 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 class 9 = 0.497 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all KL = 0.459 +- 0.306 (in-sample avg dev_std = 0.436)
SUFF++ for r=0.6 all L1 = 0.496 +- 0.232 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.145
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.128
SUFF++ for r=0.9 class 0 = 0.368 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 1 = 0.682 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 2 = 0.345 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 3 = 0.422 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 4 = 0.431 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 5 = 0.392 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 6 = 0.399 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 7 = 0.565 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 8 = 0.346 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 class 9 = 0.448 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 all KL = 0.398 +- 0.290 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.9 all L1 = 0.445 +- 0.212 (in-sample avg dev_std = 0.439)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.132
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
SUFF++ for r=0.3 class 0 = 0.444 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 1 = 0.466 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 2 = 0.385 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 3 = 0.411 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 4 = 0.502 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 5 = 0.471 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 6 = 0.506 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 7 = 0.555 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 8 = 0.465 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 class 9 = 0.533 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all KL = 0.421 +- 0.290 (in-sample avg dev_std = 0.518)
SUFF++ for r=0.3 all L1 = 0.474 +- 0.192 (in-sample avg dev_std = 0.518)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.139
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.12
SUFF++ for r=0.6 class 0 = 0.42 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 1 = 0.628 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 2 = 0.385 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 3 = 0.409 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 4 = 0.519 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 5 = 0.468 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 6 = 0.431 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 7 = 0.596 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 8 = 0.434 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 class 9 = 0.531 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all KL = 0.441 +- 0.304 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.6 all L1 = 0.486 +- 0.225 (in-sample avg dev_std = 0.450)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.14
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.123
SUFF++ for r=0.9 class 0 = 0.409 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 1 = 0.67 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 2 = 0.336 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 3 = 0.396 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 4 = 0.449 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 5 = 0.403 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 6 = 0.388 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 7 = 0.54 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 8 = 0.362 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 class 9 = 0.42 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 all KL = 0.4 +- 0.281 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.9 all L1 = 0.443 +- 0.210 (in-sample avg dev_std = 0.411)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.09
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.646 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 1 = 0.286 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 2 = 0.558 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 3 = 0.512 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 4 = 0.426 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 5 = 0.529 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 6 = 0.493 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 7 = 0.483 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 8 = 0.46 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 class 9 = 0.404 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all KL = 0.459 +- 0.318 (in-sample avg dev_std = 0.383)
SUFF++ for r=0.3 all L1 = 0.478 +- 0.215 (in-sample avg dev_std = 0.383)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.098
SUFF++ for r=0.6 class 0 = 0.535 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 1 = 0.547 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 2 = 0.458 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 3 = 0.48 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 4 = 0.415 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 5 = 0.498 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 6 = 0.511 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 7 = 0.47 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 8 = 0.509 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 9 = 0.436 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all KL = 0.411 +- 0.338 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all L1 = 0.487 +- 0.258 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.12
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.111
SUFF++ for r=0.9 class 0 = 0.536 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 1 = 0.921 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 2 = 0.506 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 3 = 0.606 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 4 = 0.667 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 5 = 0.529 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 6 = 0.645 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 7 = 0.618 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 8 = 0.568 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 class 9 = 0.775 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 all KL = 0.525 +- 0.402 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.9 all L1 = 0.64 +- 0.307 (in-sample avg dev_std = 0.418)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.131
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.124
NEC for r=0.3 class 0 = 0.611 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 1 = 0.47 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 2 = 0.593 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 3 = 0.555 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 4 = 0.5 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 5 = 0.587 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 6 = 0.458 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 7 = 0.432 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 8 = 0.512 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 class 9 = 0.5 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all KL = 0.591 +- 0.341 (in-sample avg dev_std = 0.472)
NEC for r=0.3 all L1 = 0.52 +- 0.226 (in-sample avg dev_std = 0.472)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.15
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.127
NEC for r=0.6 class 0 = 0.615 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1 = 0.361 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 2 = 0.588 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 3 = 0.538 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 4 = 0.468 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 5 = 0.561 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 6 = 0.501 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 7 = 0.4 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 8 = 0.589 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 9 = 0.498 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.564 +- 0.302 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.509 +- 0.221 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.145
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.131
NEC for r=0.9 class 0 = 0.574 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 1 = 0.259 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 2 = 0.561 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 3 = 0.54 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 4 = 0.509 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 5 = 0.552 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 6 = 0.496 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 7 = 0.446 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 8 = 0.537 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 class 9 = 0.474 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all KL = 0.507 +- 0.264 (in-sample avg dev_std = 0.426)
NEC for r=0.9 all L1 = 0.491 +- 0.202 (in-sample avg dev_std = 0.426)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.149
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.131
NEC for r=1.0 class 0 = 0.56 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 1 = 0.26 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 2 = 0.515 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 3 = 0.53 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 4 = 0.531 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 5 = 0.54 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 6 = 0.5 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 7 = 0.458 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 8 = 0.537 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 class 9 = 0.468 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 all KL = 0.498 +- 0.259 (in-sample avg dev_std = 0.419)
NEC for r=1.0 all L1 = 0.486 +- 0.194 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.132
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
NEC for r=0.3 class 0 = 0.6 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 1 = 0.484 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 2 = 0.63 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 3 = 0.6 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 4 = 0.459 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 5 = 0.55 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 6 = 0.536 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 7 = 0.473 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 8 = 0.487 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 9 = 0.414 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all KL = 0.597 +- 0.336 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all L1 = 0.522 +- 0.224 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.139
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
NEC for r=0.6 class 0 = 0.59 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 1 = 0.303 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 2 = 0.57 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 3 = 0.544 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 4 = 0.46 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 5 = 0.567 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 6 = 0.461 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 7 = 0.454 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 8 = 0.552 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 class 9 = 0.463 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all KL = 0.548 +- 0.307 (in-sample avg dev_std = 0.459)
NEC for r=0.6 all L1 = 0.492 +- 0.224 (in-sample avg dev_std = 0.459)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.14
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.128
NEC for r=0.9 class 0 = 0.553 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 1 = 0.246 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 2 = 0.53 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 3 = 0.479 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 4 = 0.507 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 5 = 0.541 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 6 = 0.539 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 7 = 0.442 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 8 = 0.535 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 class 9 = 0.523 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 all KL = 0.491 +- 0.256 (in-sample avg dev_std = 0.415)
NEC for r=0.9 all L1 = 0.484 +- 0.195 (in-sample avg dev_std = 0.415)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.155
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.135
NEC for r=1.0 class 0 = 0.572 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 1 = 0.252 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 2 = 0.515 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 3 = 0.486 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 4 = 0.519 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 5 = 0.521 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 6 = 0.539 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 7 = 0.451 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 8 = 0.533 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 class 9 = 0.527 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 all KL = 0.484 +- 0.252 (in-sample avg dev_std = 0.405)
NEC for r=1.0 all L1 = 0.486 +- 0.194 (in-sample avg dev_std = 0.405)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.09
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.343 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 1 = 0.739 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 2 = 0.407 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 3 = 0.47 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 4 = 0.604 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 5 = 0.461 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 6 = 0.497 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 7 = 0.522 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 8 = 0.553 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 class 9 = 0.66 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 all KL = 0.538 +- 0.356 (in-sample avg dev_std = 0.270)
NEC for r=0.3 all L1 = 0.527 +- 0.251 (in-sample avg dev_std = 0.270)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.105
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
NEC for r=0.6 class 0 = 0.464 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 1 = 0.68 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 2 = 0.568 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 3 = 0.553 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 4 = 0.694 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 5 = 0.531 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 6 = 0.601 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 7 = 0.607 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 8 = 0.588 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 class 9 = 0.673 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all KL = 0.667 +- 0.348 (in-sample avg dev_std = 0.313)
NEC for r=0.6 all L1 = 0.597 +- 0.268 (in-sample avg dev_std = 0.313)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.12
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.109
NEC for r=0.9 class 0 = 0.575 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 1 = 0.207 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 2 = 0.656 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 3 = 0.664 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 4 = 0.696 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 5 = 0.634 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 6 = 0.622 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 7 = 0.677 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 8 = 0.643 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 class 9 = 0.587 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 all KL = 0.711 +- 0.355 (in-sample avg dev_std = 0.388)
NEC for r=0.9 all L1 = 0.591 +- 0.293 (in-sample avg dev_std = 0.388)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.123
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.111
NEC for r=1.0 class 0 = 0.587 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 1 = 0.224 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 2 = 0.663 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 3 = 0.638 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 4 = 0.626 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 5 = 0.615 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 6 = 0.608 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 7 = 0.653 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 8 = 0.618 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 class 9 = 0.497 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 all KL = 0.684 +- 0.372 (in-sample avg dev_std = 0.402)
NEC for r=1.0 all L1 = 0.569 +- 0.304 (in-sample avg dev_std = 0.402)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 07:21:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 07:21:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 195...
[0m[1;37mINFO[0m: [1mCheckpoint 195: 
-----------------------------------
Train ACCURACY: 0.9509
Train Loss: 0.1438
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.3670
ID Test ACCURACY: 0.8821
ID Test Loss: 0.3952
OOD Validation ACCURACY: 0.7579
OOD Validation Loss: 0.8676
OOD Test ACCURACY: 0.2823
OOD Test Loss: 3.7586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9318
Train Loss: 0.2030
ID Validation ACCURACY: 0.8879
ID Validation Loss: 0.3736
ID Test ACCURACY: 0.8803
ID Test Loss: 0.3915
OOD Validation ACCURACY: 0.7891
OOD Validation Loss: 0.7283
OOD Test ACCURACY: 0.2533
OOD Test Loss: 5.1195

[0m[1;37mINFO[0m: [1mChartInfo 0.8821 0.2823 0.8803 0.2533 0.8879 0.7891[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.429 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 1 = 0.352 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 2 = 0.391 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 3 = 0.4 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 4 = 0.407 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 5 = 0.383 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 6 = 0.406 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 7 = 0.451 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 8 = 0.422 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 class 9 = 0.411 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all KL = 0.275 +- 0.247 (in-sample avg dev_std = 0.552)
SUFF++ for r=0.3 all L1 = 0.405 +- 0.153 (in-sample avg dev_std = 0.552)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.105
SUFF++ for r=0.6 class 0 = 0.333 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 1 = 0.287 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 2 = 0.39 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 3 = 0.43 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 4 = 0.453 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 5 = 0.399 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 6 = 0.451 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 7 = 0.506 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 8 = 0.41 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 class 9 = 0.426 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 all KL = 0.282 +- 0.268 (in-sample avg dev_std = 0.555)
SUFF++ for r=0.6 all L1 = 0.408 +- 0.182 (in-sample avg dev_std = 0.555)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.108
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.105
SUFF++ for r=0.9 class 0 = 0.424 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 1 = 0.268 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 2 = 0.449 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 3 = 0.446 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 4 = 0.445 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 5 = 0.462 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 6 = 0.53 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 7 = 0.485 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 8 = 0.443 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 9 = 0.449 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 all KL = 0.37 +- 0.276 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 all L1 = 0.438 +- 0.197 (in-sample avg dev_std = 0.475)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.396 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 1 = 0.35 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 2 = 0.367 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 3 = 0.422 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 4 = 0.379 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 5 = 0.444 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 6 = 0.406 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 7 = 0.434 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 8 = 0.419 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 class 9 = 0.44 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all KL = 0.269 +- 0.242 (in-sample avg dev_std = 0.558)
SUFF++ for r=0.3 all L1 = 0.405 +- 0.154 (in-sample avg dev_std = 0.558)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.127
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.111
SUFF++ for r=0.6 class 0 = 0.315 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 1 = 0.302 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 2 = 0.402 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 3 = 0.371 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 4 = 0.458 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 5 = 0.412 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 6 = 0.449 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 7 = 0.451 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 8 = 0.426 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 class 9 = 0.443 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 all KL = 0.271 +- 0.257 (in-sample avg dev_std = 0.563)
SUFF++ for r=0.6 all L1 = 0.402 +- 0.175 (in-sample avg dev_std = 0.563)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.114
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.102
SUFF++ for r=0.9 class 0 = 0.416 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 1 = 0.265 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 2 = 0.469 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 3 = 0.458 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 4 = 0.485 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 5 = 0.45 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 6 = 0.42 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 7 = 0.511 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 8 = 0.422 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 class 9 = 0.46 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 all KL = 0.364 +- 0.280 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.9 all L1 = 0.433 +- 0.195 (in-sample avg dev_std = 0.482)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.134
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
SUFF++ for r=0.3 class 0 = 0.436 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 1 = 0.286 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 2 = 0.384 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 3 = 0.37 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 4 = 0.316 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 5 = 0.339 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 6 = 0.318 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 7 = 0.314 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 8 = 0.301 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 class 9 = 0.304 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all KL = 0.22 +- 0.256 (in-sample avg dev_std = 0.510)
SUFF++ for r=0.3 all L1 = 0.337 +- 0.151 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.098
SUFF++ for r=0.6 class 0 = 0.5 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 1 = 0.388 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 2 = 0.411 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 3 = 0.372 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 4 = 0.385 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 5 = 0.409 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 6 = 0.413 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 7 = 0.439 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 8 = 0.316 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 9 = 0.355 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all KL = 0.325 +- 0.305 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all L1 = 0.399 +- 0.215 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.132
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.097
SUFF++ for r=0.9 class 0 = 0.459 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 1 = 0.493 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 2 = 0.426 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 3 = 0.426 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 4 = 0.455 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 5 = 0.383 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 6 = 0.48 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 7 = 0.458 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 8 = 0.397 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 class 9 = 0.414 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 all KL = 0.397 +- 0.303 (in-sample avg dev_std = 0.371)
SUFF++ for r=0.9 all L1 = 0.44 +- 0.213 (in-sample avg dev_std = 0.371)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.12
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.128
NEC for r=0.3 class 0 = 0.617 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 1 = 0.544 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 2 = 0.645 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 3 = 0.594 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 4 = 0.573 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 5 = 0.66 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 6 = 0.611 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 7 = 0.555 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 8 = 0.64 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 class 9 = 0.562 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all KL = 0.708 +- 0.282 (in-sample avg dev_std = 0.498)
NEC for r=0.3 all L1 = 0.598 +- 0.183 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
NEC for r=0.6 class 0 = 0.639 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 1 = 0.449 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 2 = 0.595 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 3 = 0.564 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 4 = 0.478 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 5 = 0.627 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 6 = 0.475 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 7 = 0.534 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 8 = 0.576 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 class 9 = 0.547 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all KL = 0.668 +- 0.295 (in-sample avg dev_std = 0.545)
NEC for r=0.6 all L1 = 0.546 +- 0.213 (in-sample avg dev_std = 0.545)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.108
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.116
NEC for r=0.9 class 0 = 0.553 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 1 = 0.559 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 2 = 0.52 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 3 = 0.49 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 4 = 0.478 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 5 = 0.483 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 6 = 0.425 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 7 = 0.497 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 8 = 0.543 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 class 9 = 0.516 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all KL = 0.571 +- 0.281 (in-sample avg dev_std = 0.487)
NEC for r=0.9 all L1 = 0.508 +- 0.213 (in-sample avg dev_std = 0.487)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.108
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.117
NEC for r=1.0 class 0 = 0.554 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 1 = 0.563 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 2 = 0.518 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 3 = 0.499 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 4 = 0.498 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 5 = 0.485 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 6 = 0.46 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 7 = 0.474 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 8 = 0.555 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 class 9 = 0.499 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 all KL = 0.557 +- 0.272 (in-sample avg dev_std = 0.459)
NEC for r=1.0 all L1 = 0.511 +- 0.206 (in-sample avg dev_std = 0.459)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.115
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.118
NEC for r=0.3 class 0 = 0.58 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 1 = 0.555 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 2 = 0.651 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 3 = 0.64 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 4 = 0.581 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 5 = 0.66 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 6 = 0.596 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 7 = 0.586 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 8 = 0.635 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 class 9 = 0.553 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 all KL = 0.73 +- 0.280 (in-sample avg dev_std = 0.510)
NEC for r=0.3 all L1 = 0.603 +- 0.184 (in-sample avg dev_std = 0.510)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.127
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 0 = 0.66 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 1 = 0.476 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 2 = 0.605 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 3 = 0.633 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 4 = 0.529 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 5 = 0.596 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 6 = 0.514 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 7 = 0.53 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 8 = 0.589 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 class 9 = 0.557 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 all KL = 0.697 +- 0.278 (in-sample avg dev_std = 0.566)
NEC for r=0.6 all L1 = 0.567 +- 0.207 (in-sample avg dev_std = 0.566)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.114
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.116
NEC for r=0.9 class 0 = 0.573 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 1 = 0.571 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 2 = 0.481 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 3 = 0.549 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 4 = 0.499 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 5 = 0.519 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 6 = 0.458 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 7 = 0.473 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 8 = 0.505 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 9 = 0.451 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 all KL = 0.566 +- 0.281 (in-sample avg dev_std = 0.486)
NEC for r=0.9 all L1 = 0.509 +- 0.208 (in-sample avg dev_std = 0.486)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.108
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.116
NEC for r=1.0 class 0 = 0.548 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 1 = 0.591 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 2 = 0.474 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 3 = 0.54 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 4 = 0.494 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 5 = 0.507 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 6 = 0.445 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 7 = 0.446 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 8 = 0.499 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 class 9 = 0.477 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 all KL = 0.542 +- 0.270 (in-sample avg dev_std = 0.460)
NEC for r=1.0 all L1 = 0.503 +- 0.196 (in-sample avg dev_std = 0.460)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.134
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
NEC for r=0.3 class 0 = 0.557 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 1 = 0.684 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 2 = 0.594 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 3 = 0.589 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 4 = 0.604 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 5 = 0.637 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 6 = 0.657 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 7 = 0.612 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 8 = 0.633 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 class 9 = 0.612 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all KL = 0.698 +- 0.284 (in-sample avg dev_std = 0.399)
NEC for r=0.3 all L1 = 0.618 +- 0.193 (in-sample avg dev_std = 0.399)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.112
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.108
NEC for r=0.6 class 0 = 0.5 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 1 = 0.442 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 2 = 0.58 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 3 = 0.55 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 4 = 0.44 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 5 = 0.485 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 6 = 0.482 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 7 = 0.469 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 8 = 0.567 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 class 9 = 0.473 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 all KL = 0.565 +- 0.298 (in-sample avg dev_std = 0.441)
NEC for r=0.6 all L1 = 0.499 +- 0.216 (in-sample avg dev_std = 0.441)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.132
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.119
NEC for r=0.9 class 0 = 0.526 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 1 = 0.416 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 2 = 0.536 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 3 = 0.539 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 4 = 0.51 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 5 = 0.58 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 6 = 0.523 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 7 = 0.521 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 8 = 0.552 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 9 = 0.51 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 all KL = 0.57 +- 0.298 (in-sample avg dev_std = 0.412)
NEC for r=0.9 all L1 = 0.52 +- 0.211 (in-sample avg dev_std = 0.412)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.149
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.119
NEC for r=1.0 class 0 = 0.511 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 1 = 0.415 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 2 = 0.557 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 3 = 0.559 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 4 = 0.516 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 5 = 0.539 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 6 = 0.523 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 7 = 0.557 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 8 = 0.562 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 class 9 = 0.53 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 all KL = 0.566 +- 0.291 (in-sample avg dev_std = 0.418)
NEC for r=1.0 all L1 = 0.526 +- 0.197 (in-sample avg dev_std = 0.418)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 07:43:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 07:43:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9604
Train Loss: 0.1153
ID Validation ACCURACY: 0.9010
ID Validation Loss: 0.3481
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3480
OOD Validation ACCURACY: 0.7856
OOD Validation Loss: 0.8622
OOD Test ACCURACY: 0.2849
OOD Test Loss: 5.4890

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9430
Train Loss: 0.1652
ID Validation ACCURACY: 0.8920
ID Validation Loss: 0.3531
ID Test ACCURACY: 0.8894
ID Test Loss: 0.3600
OOD Validation ACCURACY: 0.8167
OOD Validation Loss: 0.6598
OOD Test ACCURACY: 0.2980
OOD Test Loss: 4.4548

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.2849 0.8894 0.2980 0.8920 0.8167[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.513 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 1 = 0.447 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 2 = 0.445 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 3 = 0.471 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 4 = 0.533 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 5 = 0.481 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 6 = 0.498 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 7 = 0.548 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 8 = 0.501 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 class 9 = 0.533 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 all KL = 0.509 +- 0.300 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.3 all L1 = 0.496 +- 0.163 (in-sample avg dev_std = 0.429)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.108
SUFF++ for r=0.6 class 0 = 0.465 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 1 = 0.464 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 2 = 0.457 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 3 = 0.463 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 4 = 0.505 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 5 = 0.488 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 6 = 0.487 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 7 = 0.545 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 8 = 0.506 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 class 9 = 0.497 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all KL = 0.519 +- 0.267 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.6 all L1 = 0.488 +- 0.144 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.124
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.107
SUFF++ for r=0.9 class 0 = 0.404 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 1 = 0.406 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 2 = 0.446 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 3 = 0.451 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 4 = 0.459 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 5 = 0.487 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 6 = 0.432 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 7 = 0.495 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 8 = 0.434 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 class 9 = 0.471 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 all KL = 0.457 +- 0.254 (in-sample avg dev_std = 0.408)
SUFF++ for r=0.9 all L1 = 0.448 +- 0.149 (in-sample avg dev_std = 0.408)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
SUFF++ for r=0.3 class 0 = 0.529 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 1 = 0.506 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 2 = 0.448 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 3 = 0.43 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 4 = 0.505 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 5 = 0.472 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 6 = 0.48 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 7 = 0.555 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 8 = 0.492 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 class 9 = 0.506 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all KL = 0.512 +- 0.294 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.3 all L1 = 0.493 +- 0.161 (in-sample avg dev_std = 0.438)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.106
SUFF++ for r=0.6 class 0 = 0.489 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 1 = 0.524 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 2 = 0.445 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 3 = 0.454 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 4 = 0.489 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 5 = 0.514 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 6 = 0.474 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 7 = 0.52 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 8 = 0.491 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 class 9 = 0.512 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all KL = 0.524 +- 0.263 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.6 all L1 = 0.492 +- 0.144 (in-sample avg dev_std = 0.448)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.111
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.102
SUFF++ for r=0.9 class 0 = 0.422 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 1 = 0.434 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 2 = 0.456 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 3 = 0.437 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 4 = 0.472 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 5 = 0.502 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 6 = 0.437 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 7 = 0.468 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 8 = 0.455 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 class 9 = 0.488 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 all KL = 0.451 +- 0.257 (in-sample avg dev_std = 0.428)
SUFF++ for r=0.9 all L1 = 0.457 +- 0.152 (in-sample avg dev_std = 0.428)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.103
SUFF++ for r=0.3 class 0 = 0.469 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 1 = 0.533 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 2 = 0.5 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 3 = 0.471 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 4 = 0.532 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 5 = 0.477 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 6 = 0.547 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 7 = 0.518 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 8 = 0.496 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 9 = 0.57 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 all KL = 0.518 +- 0.284 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 all L1 = 0.511 +- 0.146 (in-sample avg dev_std = 0.444)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.083
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.104
SUFF++ for r=0.6 class 0 = 0.45 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.491 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.466 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 3 = 0.452 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 4 = 0.449 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 5 = 0.448 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 6 = 0.473 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 7 = 0.474 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 8 = 0.438 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 9 = 0.42 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.493 +- 0.231 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.457 +- 0.140 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.111
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.112
SUFF++ for r=0.9 class 0 = 0.361 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 1 = 0.289 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 2 = 0.409 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 3 = 0.369 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 4 = 0.336 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 5 = 0.409 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 6 = 0.362 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 7 = 0.402 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 8 = 0.38 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 class 9 = 0.346 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 all KL = 0.329 +- 0.261 (in-sample avg dev_std = 0.379)
SUFF++ for r=0.9 all L1 = 0.365 +- 0.164 (in-sample avg dev_std = 0.379)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.13
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.541 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.539 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.554 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 3 = 0.559 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 4 = 0.497 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 5 = 0.573 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 6 = 0.481 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 7 = 0.452 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 8 = 0.524 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 9 = 0.487 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.565 +- 0.330 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.52 +- 0.193 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 0 = 0.542 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 1 = 0.458 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 2 = 0.52 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 3 = 0.507 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 4 = 0.53 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 5 = 0.527 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 6 = 0.502 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 7 = 0.457 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 8 = 0.521 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 class 9 = 0.46 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 all KL = 0.499 +- 0.280 (in-sample avg dev_std = 0.434)
NEC for r=0.6 all L1 = 0.501 +- 0.168 (in-sample avg dev_std = 0.434)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.124
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.122
NEC for r=0.9 class 0 = 0.495 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 1 = 0.407 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 2 = 0.422 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 3 = 0.453 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 4 = 0.482 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 5 = 0.435 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 6 = 0.47 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 7 = 0.421 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 8 = 0.531 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 class 9 = 0.492 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all KL = 0.419 +- 0.240 (in-sample avg dev_std = 0.379)
NEC for r=0.9 all L1 = 0.46 +- 0.188 (in-sample avg dev_std = 0.379)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.121
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.117
NEC for r=1.0 class 0 = 0.493 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 1 = 0.388 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 2 = 0.438 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 3 = 0.463 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 4 = 0.483 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 5 = 0.381 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 6 = 0.459 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 7 = 0.4 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 8 = 0.524 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 class 9 = 0.484 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 all KL = 0.415 +- 0.246 (in-sample avg dev_std = 0.365)
NEC for r=1.0 all L1 = 0.451 +- 0.198 (in-sample avg dev_std = 0.365)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.117
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.127
NEC for r=0.3 class 0 = 0.553 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 1 = 0.483 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 2 = 0.582 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 3 = 0.567 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 4 = 0.5 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 5 = 0.562 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 6 = 0.522 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 7 = 0.453 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 8 = 0.538 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 9 = 0.448 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all KL = 0.565 +- 0.327 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all L1 = 0.519 +- 0.190 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.097
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
NEC for r=0.6 class 0 = 0.49 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 1 = 0.406 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 2 = 0.553 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 3 = 0.604 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 4 = 0.488 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 5 = 0.501 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 6 = 0.49 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 7 = 0.446 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 8 = 0.559 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 class 9 = 0.497 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 all KL = 0.502 +- 0.280 (in-sample avg dev_std = 0.436)
NEC for r=0.6 all L1 = 0.502 +- 0.178 (in-sample avg dev_std = 0.436)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.111
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.117
NEC for r=0.9 class 0 = 0.433 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 1 = 0.379 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 2 = 0.428 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 3 = 0.479 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 4 = 0.493 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 5 = 0.39 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 6 = 0.478 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 7 = 0.429 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 8 = 0.507 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 class 9 = 0.468 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 all KL = 0.414 +- 0.235 (in-sample avg dev_std = 0.385)
NEC for r=0.9 all L1 = 0.447 +- 0.183 (in-sample avg dev_std = 0.385)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.12
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.11
NEC for r=1.0 class 0 = 0.472 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 1 = 0.395 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 2 = 0.448 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 3 = 0.468 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 4 = 0.497 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 5 = 0.386 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 6 = 0.488 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 7 = 0.416 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 8 = 0.51 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 class 9 = 0.414 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 all KL = 0.42 +- 0.251 (in-sample avg dev_std = 0.366)
NEC for r=1.0 all L1 = 0.448 +- 0.197 (in-sample avg dev_std = 0.366)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.097
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.475 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 1 = 0.33 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 2 = 0.474 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 3 = 0.453 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 4 = 0.373 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 5 = 0.475 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 6 = 0.388 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 7 = 0.411 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 8 = 0.427 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 class 9 = 0.365 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all KL = 0.32 +- 0.263 (in-sample avg dev_std = 0.343)
NEC for r=0.3 all L1 = 0.416 +- 0.176 (in-sample avg dev_std = 0.343)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.083
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.085
NEC for r=0.6 class 0 = 0.512 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 1 = 0.408 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 2 = 0.471 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 3 = 0.484 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 4 = 0.413 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 5 = 0.494 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 6 = 0.424 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 7 = 0.406 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 8 = 0.449 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 class 9 = 0.354 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 all KL = 0.357 +- 0.242 (in-sample avg dev_std = 0.355)
NEC for r=0.6 all L1 = 0.441 +- 0.176 (in-sample avg dev_std = 0.355)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.111
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.123
NEC for r=0.9 class 0 = 0.526 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 1 = 0.459 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 2 = 0.575 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 3 = 0.531 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 4 = 0.551 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 5 = 0.515 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 6 = 0.493 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 7 = 0.533 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 8 = 0.505 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 class 9 = 0.504 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 all KL = 0.52 +- 0.284 (in-sample avg dev_std = 0.386)
NEC for r=0.9 all L1 = 0.519 +- 0.203 (in-sample avg dev_std = 0.386)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.116
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.125
NEC for r=1.0 class 0 = 0.54 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 1 = 0.484 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 2 = 0.579 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 3 = 0.523 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 4 = 0.557 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 5 = 0.528 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 6 = 0.503 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 7 = 0.542 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 8 = 0.508 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 class 9 = 0.548 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 all KL = 0.561 +- 0.302 (in-sample avg dev_std = 0.386)
NEC for r=1.0 all L1 = 0.531 +- 0.224 (in-sample avg dev_std = 0.386)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.4avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 08:06:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 08:06:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 0.9571
Train Loss: 0.1210
ID Validation ACCURACY: 0.9014
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.8894
ID Test Loss: 0.3633
OOD Validation ACCURACY: 0.7746
OOD Validation Loss: 0.9250
OOD Test ACCURACY: 0.3347
OOD Test Loss: 4.4225

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.9275
Train Loss: 0.2080
ID Validation ACCURACY: 0.8890
ID Validation Loss: 0.3399
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3670
OOD Validation ACCURACY: 0.8033
OOD Validation Loss: 0.7097
OOD Test ACCURACY: 0.2956
OOD Test Loss: 3.7907

[0m[1;37mINFO[0m: [1mChartInfo 0.8894 0.3347 0.8787 0.2956 0.8890 0.8033[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.598 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1 = 0.604 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 2 = 0.572 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 3 = 0.686 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 4 = 0.659 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 5 = 0.691 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 6 = 0.683 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 7 = 0.68 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 8 = 0.695 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 9 = 0.69 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.588 +- 0.259 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.654 +- 0.171 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.108
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.11
SUFF++ for r=0.6 class 0 = 0.525 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 1 = 0.662 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 2 = 0.644 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 3 = 0.689 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 4 = 0.649 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 5 = 0.625 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 6 = 0.679 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 7 = 0.697 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 8 = 0.627 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 class 9 = 0.671 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 all KL = 0.621 +- 0.234 (in-sample avg dev_std = 0.328)
SUFF++ for r=0.6 all L1 = 0.648 +- 0.173 (in-sample avg dev_std = 0.328)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.109
SUFF++ for r=0.9 class 0 = 0.584 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 1 = 0.565 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 2 = 0.657 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 3 = 0.705 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 4 = 0.673 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 5 = 0.634 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 6 = 0.693 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 7 = 0.715 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 8 = 0.635 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 class 9 = 0.629 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 all KL = 0.611 +- 0.234 (in-sample avg dev_std = 0.319)
SUFF++ for r=0.9 all L1 = 0.649 +- 0.182 (in-sample avg dev_std = 0.319)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
SUFF++ for r=0.3 class 0 = 0.632 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 1 = 0.621 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 2 = 0.648 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 3 = 0.634 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 4 = 0.663 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 5 = 0.722 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 6 = 0.681 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 7 = 0.707 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 8 = 0.664 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 class 9 = 0.666 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 all KL = 0.589 +- 0.260 (in-sample avg dev_std = 0.393)
SUFF++ for r=0.3 all L1 = 0.663 +- 0.171 (in-sample avg dev_std = 0.393)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.106
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.108
SUFF++ for r=0.6 class 0 = 0.589 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 1 = 0.676 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 2 = 0.641 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 3 = 0.627 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 4 = 0.697 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 5 = 0.701 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 6 = 0.673 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 7 = 0.715 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 8 = 0.65 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 class 9 = 0.663 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 all KL = 0.638 +- 0.225 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.6 all L1 = 0.664 +- 0.158 (in-sample avg dev_std = 0.329)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.111
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.114
SUFF++ for r=0.9 class 0 = 0.592 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 1 = 0.582 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 2 = 0.693 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 3 = 0.651 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 4 = 0.682 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 5 = 0.677 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 6 = 0.69 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 7 = 0.726 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 8 = 0.668 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 class 9 = 0.629 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all KL = 0.614 +- 0.238 (in-sample avg dev_std = 0.335)
SUFF++ for r=0.9 all L1 = 0.658 +- 0.176 (in-sample avg dev_std = 0.335)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.683 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 1 = 0.499 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 2 = 0.727 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 3 = 0.678 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 4 = 0.687 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 5 = 0.699 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 6 = 0.6 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 7 = 0.696 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 8 = 0.657 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 class 9 = 0.609 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 all KL = 0.67 +- 0.252 (in-sample avg dev_std = 0.334)
SUFF++ for r=0.3 all L1 = 0.652 +- 0.179 (in-sample avg dev_std = 0.334)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.106
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.102
SUFF++ for r=0.6 class 0 = 0.685 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 1 = 0.61 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 2 = 0.706 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 3 = 0.707 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 4 = 0.73 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 5 = 0.744 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 6 = 0.718 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 7 = 0.725 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 8 = 0.72 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 class 9 = 0.71 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all KL = 0.65 +- 0.222 (in-sample avg dev_std = 0.338)
SUFF++ for r=0.6 all L1 = 0.704 +- 0.158 (in-sample avg dev_std = 0.338)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.102
SUFF++ for r=0.9 class 0 = 0.586 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 1 = 0.539 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 2 = 0.614 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 3 = 0.642 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 4 = 0.706 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 5 = 0.676 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 6 = 0.669 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 7 = 0.678 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 8 = 0.705 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 9 = 0.712 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all KL = 0.569 +- 0.250 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all L1 = 0.65 +- 0.202 (in-sample avg dev_std = 0.308)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.108
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.358 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 1 = 0.302 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 2 = 0.38 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 3 = 0.28 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 4 = 0.266 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 5 = 0.282 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 6 = 0.257 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 7 = 0.265 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 8 = 0.276 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 class 9 = 0.281 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all KL = 0.315 +- 0.291 (in-sample avg dev_std = 0.350)
NEC for r=0.3 all L1 = 0.295 +- 0.202 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.108
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
NEC for r=0.6 class 0 = 0.436 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 1 = 0.274 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 2 = 0.37 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 3 = 0.274 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 4 = 0.299 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 5 = 0.361 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 6 = 0.269 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 7 = 0.272 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 8 = 0.361 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 class 9 = 0.318 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all KL = 0.339 +- 0.270 (in-sample avg dev_std = 0.356)
NEC for r=0.6 all L1 = 0.322 +- 0.202 (in-sample avg dev_std = 0.356)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.112
NEC for r=0.9 class 0 = 0.472 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 1 = 0.244 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 2 = 0.332 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 3 = 0.222 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 4 = 0.229 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 5 = 0.283 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 6 = 0.234 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 7 = 0.167 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 8 = 0.298 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 class 9 = 0.239 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all KL = 0.264 +- 0.231 (in-sample avg dev_std = 0.298)
NEC for r=0.9 all L1 = 0.271 +- 0.198 (in-sample avg dev_std = 0.298)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.112
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.114
NEC for r=1.0 class 0 = 0.487 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 1 = 0.212 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 2 = 0.337 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 3 = 0.252 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 4 = 0.249 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 5 = 0.294 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 6 = 0.268 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 7 = 0.168 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 8 = 0.319 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 class 9 = 0.259 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 all KL = 0.278 +- 0.234 (in-sample avg dev_std = 0.305)
NEC for r=1.0 all L1 = 0.282 +- 0.203 (in-sample avg dev_std = 0.305)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.121
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.33 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 1 = 0.295 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 2 = 0.362 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 3 = 0.33 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 4 = 0.268 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 5 = 0.261 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 6 = 0.27 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 7 = 0.242 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 8 = 0.28 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 class 9 = 0.279 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all KL = 0.313 +- 0.293 (in-sample avg dev_std = 0.344)
NEC for r=0.3 all L1 = 0.291 +- 0.207 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.106
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.107
NEC for r=0.6 class 0 = 0.433 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 1 = 0.221 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 2 = 0.342 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 3 = 0.371 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 4 = 0.304 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 5 = 0.31 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 6 = 0.311 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 7 = 0.275 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 8 = 0.332 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 class 9 = 0.355 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all KL = 0.344 +- 0.270 (in-sample avg dev_std = 0.370)
NEC for r=0.6 all L1 = 0.323 +- 0.194 (in-sample avg dev_std = 0.370)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.111
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.11
NEC for r=0.9 class 0 = 0.441 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 1 = 0.235 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 2 = 0.262 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 3 = 0.265 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 4 = 0.228 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 5 = 0.254 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 6 = 0.254 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 7 = 0.214 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 8 = 0.27 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 class 9 = 0.243 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 all KL = 0.266 +- 0.225 (in-sample avg dev_std = 0.304)
NEC for r=0.9 all L1 = 0.265 +- 0.186 (in-sample avg dev_std = 0.304)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.117
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.11
NEC for r=1.0 class 0 = 0.435 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 1 = 0.194 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 2 = 0.251 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 3 = 0.279 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 4 = 0.245 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 5 = 0.267 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 6 = 0.297 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 7 = 0.206 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 8 = 0.29 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 class 9 = 0.255 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 all KL = 0.269 +- 0.221 (in-sample avg dev_std = 0.303)
NEC for r=1.0 all L1 = 0.27 +- 0.188 (in-sample avg dev_std = 0.303)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.116
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.104
NEC for r=0.3 class 0 = 0.277 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 1 = 0.37 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 2 = 0.196 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 3 = 0.227 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 4 = 0.245 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 5 = 0.24 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 6 = 0.321 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 7 = 0.241 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 8 = 0.256 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 class 9 = 0.27 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all KL = 0.199 +- 0.220 (in-sample avg dev_std = 0.193)
NEC for r=0.3 all L1 = 0.265 +- 0.216 (in-sample avg dev_std = 0.193)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.106
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.103
NEC for r=0.6 class 0 = 0.27 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 1 = 0.297 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 2 = 0.204 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 3 = 0.171 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 4 = 0.086 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 5 = 0.152 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 6 = 0.153 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 7 = 0.142 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 8 = 0.13 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 class 9 = 0.184 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all KL = 0.171 +- 0.201 (in-sample avg dev_std = 0.225)
NEC for r=0.6 all L1 = 0.181 +- 0.182 (in-sample avg dev_std = 0.225)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.115
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.117
NEC for r=0.9 class 0 = 0.374 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 1 = 0.367 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 2 = 0.362 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 3 = 0.298 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 4 = 0.153 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 5 = 0.261 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 6 = 0.206 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 7 = 0.192 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 8 = 0.169 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 class 9 = 0.147 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 all KL = 0.268 +- 0.266 (in-sample avg dev_std = 0.287)
NEC for r=0.9 all L1 = 0.256 +- 0.229 (in-sample avg dev_std = 0.287)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.11
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.113
NEC for r=1.0 class 0 = 0.387 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 1 = 0.386 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 2 = 0.383 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 3 = 0.335 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 4 = 0.196 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 5 = 0.304 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 6 = 0.264 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 7 = 0.21 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 8 = 0.208 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 class 9 = 0.184 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 all KL = 0.303 +- 0.273 (in-sample avg dev_std = 0.328)
NEC for r=1.0 all L1 = 0.288 +- 0.230 (in-sample avg dev_std = 0.328)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.265, 0.315, 0.331, 1.0], 'all_L1': [0.376, 0.404, 0.457, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.459, 0.398, 1.0], 'all_L1': [0.478, 0.496, 0.445, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.275, 0.282, 0.37, 1.0], 'all_L1': [0.405, 0.408, 0.438, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.509, 0.519, 0.457, 1.0], 'all_L1': [0.496, 0.488, 0.448, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.588, 0.621, 0.611, 1.0], 'all_L1': [0.654, 0.648, 0.649, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.701, 0.58, 0.521, 0.504], 'all_L1': [0.61, 0.52, 0.459, 0.436]}), defaultdict(<class 'list'>, {'all_KL': [0.591, 0.564, 0.507, 0.498], 'all_L1': [0.52, 0.509, 0.491, 0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.668, 0.571, 0.557], 'all_L1': [0.598, 0.546, 0.508, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.499, 0.419, 0.415], 'all_L1': [0.52, 0.501, 0.46, 0.451]}), defaultdict(<class 'list'>, {'all_KL': [0.315, 0.339, 0.264, 0.278], 'all_L1': [0.295, 0.322, 0.271, 0.282]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.281, 0.333, 0.324, 1.0], 'all_L1': [0.385, 0.405, 0.453, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.441, 0.4, 1.0], 'all_L1': [0.474, 0.486, 0.443, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.269, 0.271, 0.364, 1.0], 'all_L1': [0.405, 0.402, 0.433, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.524, 0.451, 1.0], 'all_L1': [0.493, 0.492, 0.457, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.638, 0.614, 1.0], 'all_L1': [0.663, 0.664, 0.658, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.705, 0.584, 0.519, 0.501], 'all_L1': [0.616, 0.523, 0.454, 0.43]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.548, 0.491, 0.484], 'all_L1': [0.522, 0.492, 0.484, 0.486]}), defaultdict(<class 'list'>, {'all_KL': [0.73, 0.697, 0.566, 0.542], 'all_L1': [0.603, 0.567, 0.509, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.565, 0.502, 0.414, 0.42], 'all_L1': [0.519, 0.502, 0.447, 0.448]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.344, 0.266, 0.269], 'all_L1': [0.291, 0.323, 0.265, 0.27]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.275, 0.261, 0.408, 1.0], 'all_L1': [0.358, 0.346, 0.47, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.459, 0.411, 0.525, 1.0], 'all_L1': [0.478, 0.487, 0.64, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.22, 0.325, 0.397, 1.0], 'all_L1': [0.337, 0.399, 0.44, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.493, 0.329, 1.0], 'all_L1': [0.511, 0.457, 0.365, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.65, 0.569, 1.0], 'all_L1': [0.652, 0.704, 0.65, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.613, 0.661, 0.613, 0.585], 'all_L1': [0.575, 0.582, 0.532, 0.493]}), defaultdict(<class 'list'>, {'all_KL': [0.538, 0.667, 0.711, 0.684], 'all_L1': [0.527, 0.597, 0.591, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.698, 0.565, 0.57, 0.566], 'all_L1': [0.618, 0.499, 0.52, 0.526]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.357, 0.52, 0.561], 'all_L1': [0.416, 0.441, 0.519, 0.531]}), defaultdict(<class 'list'>, {'all_KL': [0.199, 0.171, 0.268, 0.303], 'all_L1': [0.265, 0.181, 0.256, 0.288]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.482 +- 0.097, 0.489 +- 0.088, 0.487 +- 0.081, 1.000 +- 0.000
suff++ class all_KL  =  0.412 +- 0.127, 0.439 +- 0.126, 0.433 +- 0.098, 1.000 +- 0.000
suff++_acc_int  =  0.109 +- 0.003, 0.111 +- 0.004, 0.111 +- 0.009
nec class all_L1  =  0.509 +- 0.113, 0.480 +- 0.080, 0.438 +- 0.085, 0.433 +- 0.080
nec class all_KL  =  0.576 +- 0.142, 0.530 +- 0.110, 0.456 +- 0.108, 0.450 +- 0.097
nec_acc_int  =  0.123 +- 0.008, 0.119 +- 0.005, 0.119 +- 0.007, 0.120 +- 0.006

Eval split id_test
suff++ class all_L1  =  0.484 +- 0.098, 0.490 +- 0.095, 0.489 +- 0.085, 1.000 +- 0.000
suff++ class all_KL  =  0.414 +- 0.126, 0.441 +- 0.131, 0.431 +- 0.101, 1.000 +- 0.000
suff++_acc_int  =  0.111 +- 0.007, 0.110 +- 0.005, 0.108 +- 0.009
nec class all_L1  =  0.510 +- 0.117, 0.481 +- 0.083, 0.432 +- 0.086, 0.427 +- 0.083
nec class all_KL  =  0.582 +- 0.148, 0.535 +- 0.115, 0.451 +- 0.105, 0.443 +- 0.096
nec_acc_int  =  0.119 +- 0.009, 0.113 +- 0.005, 0.116 +- 0.007, 0.115 +- 0.010

Eval split test
suff++ class all_L1  =  0.467 +- 0.114, 0.479 +- 0.123, 0.513 +- 0.113, 1.000 +- 0.000
suff++ class all_KL  =  0.428 +- 0.164, 0.428 +- 0.136, 0.446 +- 0.088, 1.000 +- 0.000
suff++_acc_int  =  0.109 +- 0.006, 0.105 +- 0.010, 0.112 +- 0.014
nec class all_L1  =  0.480 +- 0.127, 0.460 +- 0.151, 0.484 +- 0.117, 0.481 +- 0.100
nec class all_KL  =  0.474 +- 0.186, 0.484 +- 0.193, 0.536 +- 0.148, 0.540 +- 0.127
nec_acc_int  =  0.109 +- 0.007, 0.103 +- 0.010, 0.119 +- 0.007, 0.122 +- 0.010


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.495 +- 0.011, 0.484 +- 0.014, 0.463 +- 0.007, 0.717 +- 0.040
Faith. Armon (L1)= 		  =  0.472 +- 0.036, 0.470 +- 0.026, 0.446 +- 0.033, 0.600 +- 0.084
Faith. GMean (L1)= 	  =  0.483 +- 0.024, 0.477 +- 0.019, 0.454 +- 0.018, 0.655 +- 0.065
Faith. Aritm (KL)= 		  =  0.494 +- 0.028, 0.485 +- 0.024, 0.445 +- 0.015, 0.725 +- 0.049
Faith. Armon (KL)= 		  =  0.444 +- 0.059, 0.452 +- 0.048, 0.421 +- 0.031, 0.614 +- 0.099
Faith. GMean (KL)= 	  =  0.468 +- 0.043, 0.468 +- 0.035, 0.433 +- 0.021, 0.667 +- 0.077

Eval split id_test
Faith. Aritm (L1)= 		  =  0.497 +- 0.010, 0.486 +- 0.012, 0.460 +- 0.007, 0.714 +- 0.041
Faith. Armon (L1)= 		  =  0.473 +- 0.036, 0.469 +- 0.022, 0.443 +- 0.033, 0.594 +- 0.088
Faith. GMean (L1)= 	  =  0.485 +- 0.024, 0.477 +- 0.014, 0.451 +- 0.018, 0.650 +- 0.068
Faith. Aritm (KL)= 		  =  0.498 +- 0.028, 0.488 +- 0.018, 0.441 +- 0.014, 0.722 +- 0.048
Faith. Armon (KL)= 		  =  0.447 +- 0.058, 0.453 +- 0.044, 0.417 +- 0.028, 0.608 +- 0.099
Faith. GMean (KL)= 	  =  0.471 +- 0.041, 0.470 +- 0.030, 0.429 +- 0.019, 0.661 +- 0.077

Eval split test
Faith. Aritm (L1)= 		  =  0.474 +- 0.016, 0.469 +- 0.037, 0.498 +- 0.062, 0.741 +- 0.050
Faith. Armon (L1)= 		  =  0.443 +- 0.040, 0.430 +- 0.080, 0.477 +- 0.082, 0.643 +- 0.100
Faith. GMean (L1)= 	  =  0.458 +- 0.027, 0.448 +- 0.058, 0.487 +- 0.072, 0.689 +- 0.078
Faith. Aritm (KL)= 		  =  0.451 +- 0.027, 0.456 +- 0.045, 0.491 +- 0.072, 0.770 +- 0.063
Faith. Armon (KL)= 		  =  0.382 +- 0.065, 0.396 +- 0.077, 0.466 +- 0.082, 0.691 +- 0.118
Faith. GMean (KL)= 	  =  0.414 +- 0.044, 0.424 +- 0.060, 0.478 +- 0.077, 0.729 +- 0.094
Computed for split load_split = id



Completed in  1:50:53.914847  for GSATvGIN GOODCMNIST/color



DONE GSAT GOODCMNIST/color Top0.4

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 08:28:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 08:28:59 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:28:59 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:28:59 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:28:59 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 08:29:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 0.9562
Train Loss: 0.1267
ID Validation ACCURACY: 0.8936
ID Validation Loss: 0.3518
ID Test ACCURACY: 0.8887
ID Test Loss: 0.3622
OOD Validation ACCURACY: 0.7731
OOD Validation Loss: 0.8388
OOD Test ACCURACY: 0.3224
OOD Test Loss: 4.2699

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9407
Train Loss: 0.1697
ID Validation ACCURACY: 0.8834
ID Validation Loss: 0.3716
ID Test ACCURACY: 0.8824
ID Test Loss: 0.3898
OOD Validation ACCURACY: 0.8101
OOD Validation Loss: 0.6824
OOD Test ACCURACY: 0.4854
OOD Test Loss: 2.2642

[0m[1;37mINFO[0m: [1mChartInfo 0.8887 0.3224 0.8824 0.4854 0.8834 0.8101[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.102
SUFF++ for r=0.3 class 0 = 0.374 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 1 = 0.6 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 2 = 0.468 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 3 = 0.511 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 4 = 0.587 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 5 = 0.57 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 6 = 0.577 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 7 = 0.597 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 8 = 0.526 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 class 9 = 0.55 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all KL = 0.437 +- 0.342 (in-sample avg dev_std = 0.461)
SUFF++ for r=0.3 all L1 = 0.536 +- 0.261 (in-sample avg dev_std = 0.461)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.126
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
SUFF++ for r=0.6 class 0 = 0.291 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 1 = 0.364 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 2 = 0.333 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 3 = 0.339 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 4 = 0.331 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 5 = 0.343 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 6 = 0.337 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 7 = 0.341 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 8 = 0.317 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 class 9 = 0.321 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 all KL = 0.237 +- 0.183 (in-sample avg dev_std = 0.547)
SUFF++ for r=0.6 all L1 = 0.332 +- 0.094 (in-sample avg dev_std = 0.547)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.235
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.15
SUFF++ for r=0.9 class 0 = 0.275 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 1 = 0.479 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 2 = 0.34 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 3 = 0.29 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 4 = 0.334 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 5 = 0.299 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 6 = 0.304 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 7 = 0.371 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 8 = 0.285 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 class 9 = 0.318 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 all KL = 0.204 +- 0.196 (in-sample avg dev_std = 0.496)
SUFF++ for r=0.9 all L1 = 0.332 +- 0.135 (in-sample avg dev_std = 0.496)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.36 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 1 = 0.594 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 2 = 0.448 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 3 = 0.479 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 4 = 0.628 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 5 = 0.6 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 6 = 0.596 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 7 = 0.544 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 8 = 0.535 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 class 9 = 0.587 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 all KL = 0.436 +- 0.341 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.3 all L1 = 0.539 +- 0.262 (in-sample avg dev_std = 0.462)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.302 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 1 = 0.368 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 2 = 0.308 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 3 = 0.34 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 4 = 0.335 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 5 = 0.366 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 6 = 0.326 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 7 = 0.33 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 8 = 0.336 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 class 9 = 0.341 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all KL = 0.239 +- 0.182 (in-sample avg dev_std = 0.539)
SUFF++ for r=0.6 all L1 = 0.336 +- 0.099 (in-sample avg dev_std = 0.539)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.24
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.152
SUFF++ for r=0.9 class 0 = 0.247 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 1 = 0.469 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 2 = 0.351 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 3 = 0.303 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 4 = 0.337 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 5 = 0.291 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 6 = 0.282 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 7 = 0.389 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 8 = 0.283 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 class 9 = 0.319 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 all KL = 0.211 +- 0.198 (in-sample avg dev_std = 0.474)
SUFF++ for r=0.9 all L1 = 0.33 +- 0.132 (in-sample avg dev_std = 0.474)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.094
SUFF++ for r=0.3 class 0 = 0.646 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 1 = 0.584 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 2 = 0.591 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 3 = 0.526 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 4 = 0.557 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 5 = 0.563 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 6 = 0.542 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 7 = 0.666 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 8 = 0.529 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 class 9 = 0.555 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 all KL = 0.568 +- 0.322 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.3 all L1 = 0.576 +- 0.283 (in-sample avg dev_std = 0.287)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
SUFF++ for r=0.6 class 0 = 0.335 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 1 = 0.485 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 2 = 0.343 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 3 = 0.333 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 4 = 0.313 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 5 = 0.333 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 6 = 0.342 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 7 = 0.318 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 8 = 0.302 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 class 9 = 0.31 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 all KL = 0.278 +- 0.233 (in-sample avg dev_std = 0.532)
SUFF++ for r=0.6 all L1 = 0.343 +- 0.145 (in-sample avg dev_std = 0.532)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.135
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.125
SUFF++ for r=0.9 class 0 = 0.324 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 1 = 0.255 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 2 = 0.461 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 3 = 0.401 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 4 = 0.412 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 5 = 0.428 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 6 = 0.384 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 7 = 0.369 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 8 = 0.383 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 class 9 = 0.317 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 all KL = 0.194 +- 0.190 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.9 all L1 = 0.372 +- 0.174 (in-sample avg dev_std = 0.478)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.111
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.122
NEC for r=0.3 class 0 = 0.652 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 1 = 0.399 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 2 = 0.627 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 3 = 0.593 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 4 = 0.508 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 5 = 0.579 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 6 = 0.505 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 7 = 0.497 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 8 = 0.578 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 class 9 = 0.489 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 all KL = 0.672 +- 0.332 (in-sample avg dev_std = 0.505)
NEC for r=0.3 all L1 = 0.541 +- 0.239 (in-sample avg dev_std = 0.505)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.126
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.132
NEC for r=0.6 class 0 = 0.638 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 1 = 0.334 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 2 = 0.537 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 3 = 0.573 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 4 = 0.525 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 5 = 0.525 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 6 = 0.568 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 7 = 0.538 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 8 = 0.589 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 class 9 = 0.588 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all KL = 0.575 +- 0.258 (in-sample avg dev_std = 0.416)
NEC for r=0.6 all L1 = 0.539 +- 0.180 (in-sample avg dev_std = 0.416)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.235
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.189
NEC for r=0.9 class 0 = 0.664 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 1 = 0.444 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 2 = 0.449 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 3 = 0.578 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 4 = 0.472 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 5 = 0.568 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 6 = 0.584 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 7 = 0.55 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 8 = 0.6 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 class 9 = 0.587 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 all KL = 0.605 +- 0.238 (in-sample avg dev_std = 0.384)
NEC for r=0.9 all L1 = 0.548 +- 0.178 (in-sample avg dev_std = 0.384)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.385
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.301
NEC for r=1.0 class 0 = 0.663 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 1 = 0.559 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 2 = 0.372 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 3 = 0.583 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 4 = 0.561 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 5 = 0.551 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 6 = 0.617 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 7 = 0.509 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 8 = 0.6 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 class 9 = 0.623 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 all KL = 0.622 +- 0.237 (in-sample avg dev_std = 0.396)
NEC for r=1.0 all L1 = 0.562 +- 0.177 (in-sample avg dev_std = 0.396)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.112
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.116
NEC for r=0.3 class 0 = 0.627 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 1 = 0.362 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 2 = 0.61 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 3 = 0.621 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 4 = 0.484 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 5 = 0.568 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 6 = 0.482 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 7 = 0.494 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 8 = 0.568 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 class 9 = 0.531 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 all KL = 0.652 +- 0.341 (in-sample avg dev_std = 0.493)
NEC for r=0.3 all L1 = 0.531 +- 0.244 (in-sample avg dev_std = 0.493)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.142
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.124
NEC for r=0.6 class 0 = 0.608 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 1 = 0.322 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 2 = 0.553 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 3 = 0.578 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 4 = 0.562 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 5 = 0.56 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 6 = 0.558 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 7 = 0.576 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 8 = 0.57 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 class 9 = 0.549 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 all KL = 0.577 +- 0.267 (in-sample avg dev_std = 0.418)
NEC for r=0.6 all L1 = 0.54 +- 0.187 (in-sample avg dev_std = 0.418)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.24
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.184
NEC for r=0.9 class 0 = 0.649 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 1 = 0.425 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 2 = 0.449 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 3 = 0.599 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 4 = 0.499 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 5 = 0.564 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 6 = 0.596 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 7 = 0.534 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 8 = 0.604 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 class 9 = 0.583 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 all KL = 0.601 +- 0.238 (in-sample avg dev_std = 0.377)
NEC for r=0.9 all L1 = 0.548 +- 0.175 (in-sample avg dev_std = 0.377)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.407
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.299
NEC for r=1.0 class 0 = 0.645 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 1 = 0.565 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 2 = 0.386 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 3 = 0.568 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 4 = 0.572 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 5 = 0.596 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 6 = 0.635 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 7 = 0.477 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 8 = 0.597 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 class 9 = 0.617 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 all KL = 0.623 +- 0.239 (in-sample avg dev_std = 0.398)
NEC for r=1.0 all L1 = 0.565 +- 0.180 (in-sample avg dev_std = 0.398)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.088
NEC for r=0.3 class 0 = 0.375 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 1 = 0.434 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 2 = 0.394 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 3 = 0.457 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 4 = 0.434 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 5 = 0.436 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 6 = 0.459 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 7 = 0.343 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 8 = 0.446 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 class 9 = 0.435 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 all KL = 0.433 +- 0.311 (in-sample avg dev_std = 0.322)
NEC for r=0.3 all L1 = 0.421 +- 0.258 (in-sample avg dev_std = 0.322)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.121
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.135
NEC for r=0.6 class 0 = 0.528 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 1 = 0.466 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 2 = 0.471 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 3 = 0.509 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 4 = 0.542 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 5 = 0.523 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 6 = 0.549 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 7 = 0.56 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 8 = 0.533 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 class 9 = 0.555 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all KL = 0.53 +- 0.260 (in-sample avg dev_std = 0.407)
NEC for r=0.6 all L1 = 0.522 +- 0.187 (in-sample avg dev_std = 0.407)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.135
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.134
NEC for r=0.9 class 0 = 0.605 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 1 = 0.7 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 2 = 0.398 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 3 = 0.461 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 4 = 0.492 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 5 = 0.474 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 6 = 0.514 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 7 = 0.543 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 8 = 0.508 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 class 9 = 0.626 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 all KL = 0.62 +- 0.284 (in-sample avg dev_std = 0.369)
NEC for r=0.9 all L1 = 0.534 +- 0.233 (in-sample avg dev_std = 0.369)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.142
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.141
NEC for r=1.0 class 0 = 0.657 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 1 = 0.691 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 2 = 0.419 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 3 = 0.511 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 4 = 0.565 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 5 = 0.519 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 6 = 0.593 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 7 = 0.597 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 8 = 0.531 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 class 9 = 0.661 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 all KL = 0.686 +- 0.288 (in-sample avg dev_std = 0.368)
NEC for r=1.0 all L1 = 0.575 +- 0.232 (in-sample avg dev_std = 0.368)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 08:51:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:20 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:20 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:20 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 08:51:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9647
Train Loss: 0.1034
ID Validation ACCURACY: 0.9006
ID Validation Loss: 0.3269
ID Test ACCURACY: 0.8990
ID Test Loss: 0.3447
OOD Validation ACCURACY: 0.7940
OOD Validation Loss: 0.8175
OOD Test ACCURACY: 0.2679
OOD Test Loss: 6.7545

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1390
ID Validation ACCURACY: 0.8956
ID Validation Loss: 0.3527
ID Test ACCURACY: 0.8936
ID Test Loss: 0.3644
OOD Validation ACCURACY: 0.8140
OOD Validation Loss: 0.6695
OOD Test ACCURACY: 0.2480
OOD Test Loss: 13.2968

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.2679 0.8936 0.2480 0.8956 0.8140[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.153
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.131
SUFF++ for r=0.3 class 0 = 0.442 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 1 = 0.593 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 2 = 0.465 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 3 = 0.543 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 4 = 0.592 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 5 = 0.515 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 6 = 0.589 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 7 = 0.67 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 8 = 0.501 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 class 9 = 0.577 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 all KL = 0.494 +- 0.288 (in-sample avg dev_std = 0.444)
SUFF++ for r=0.3 all L1 = 0.55 +- 0.232 (in-sample avg dev_std = 0.444)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.138
SUFF++ for r=0.6 class 0 = 0.299 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 1 = 0.549 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 2 = 0.419 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 3 = 0.442 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 4 = 0.504 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 5 = 0.473 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 6 = 0.476 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 7 = 0.559 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 8 = 0.361 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 9 = 0.414 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all KL = 0.373 +- 0.237 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all L1 = 0.451 +- 0.173 (in-sample avg dev_std = 0.478)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.373
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.241
SUFF++ for r=0.9 class 0 = 0.239 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 1 = 0.436 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 2 = 0.294 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 3 = 0.257 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 4 = 0.306 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 5 = 0.279 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 6 = 0.342 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 7 = 0.472 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 8 = 0.267 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 class 9 = 0.313 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 all KL = 0.177 +- 0.188 (in-sample avg dev_std = 0.462)
SUFF++ for r=0.9 all L1 = 0.324 +- 0.162 (in-sample avg dev_std = 0.462)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.135
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.124
SUFF++ for r=0.3 class 0 = 0.459 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 1 = 0.608 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 2 = 0.508 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 3 = 0.498 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 4 = 0.629 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 5 = 0.577 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 6 = 0.542 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 7 = 0.672 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 8 = 0.471 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 class 9 = 0.623 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 all KL = 0.5 +- 0.281 (in-sample avg dev_std = 0.442)
SUFF++ for r=0.3 all L1 = 0.56 +- 0.228 (in-sample avg dev_std = 0.442)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.118
SUFF++ for r=0.6 class 0 = 0.321 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 1 = 0.54 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 2 = 0.422 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 3 = 0.41 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 4 = 0.477 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 5 = 0.457 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 6 = 0.492 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 7 = 0.538 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 8 = 0.378 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 9 = 0.493 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 all KL = 0.373 +- 0.244 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 all L1 = 0.455 +- 0.179 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.381
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.235
SUFF++ for r=0.9 class 0 = 0.252 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 1 = 0.421 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 2 = 0.276 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 3 = 0.261 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 4 = 0.3 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 5 = 0.283 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 6 = 0.314 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 7 = 0.509 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 8 = 0.297 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 class 9 = 0.33 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 all KL = 0.182 +- 0.183 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.9 all L1 = 0.328 +- 0.152 (in-sample avg dev_std = 0.475)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.107
SUFF++ for r=0.3 class 0 = 0.529 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 1 = 0.379 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 2 = 0.509 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 3 = 0.582 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 4 = 0.478 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 5 = 0.509 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 6 = 0.524 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 7 = 0.502 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 8 = 0.541 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 class 9 = 0.435 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 all KL = 0.465 +- 0.276 (in-sample avg dev_std = 0.363)
SUFF++ for r=0.3 all L1 = 0.498 +- 0.220 (in-sample avg dev_std = 0.363)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.141
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.112
SUFF++ for r=0.6 class 0 = 0.435 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 1 = 0.294 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 2 = 0.402 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 3 = 0.427 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 4 = 0.366 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 5 = 0.438 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 6 = 0.393 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 7 = 0.448 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 8 = 0.428 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 class 9 = 0.361 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all KL = 0.291 +- 0.233 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.6 all L1 = 0.398 +- 0.159 (in-sample avg dev_std = 0.476)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.14
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.13
SUFF++ for r=0.9 class 0 = 0.365 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 1 = 0.273 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 2 = 0.43 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 3 = 0.435 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 4 = 0.382 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 5 = 0.384 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 6 = 0.404 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 7 = 0.42 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 8 = 0.398 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 class 9 = 0.32 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 all KL = 0.195 +- 0.218 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.9 all L1 = 0.38 +- 0.182 (in-sample avg dev_std = 0.537)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.153
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.123
NEC for r=0.3 class 0 = 0.583 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 1 = 0.347 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 2 = 0.586 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 3 = 0.54 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 4 = 0.49 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 5 = 0.502 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 6 = 0.464 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 7 = 0.351 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 8 = 0.602 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 class 9 = 0.528 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all KL = 0.55 +- 0.322 (in-sample avg dev_std = 0.448)
NEC for r=0.3 all L1 = 0.496 +- 0.255 (in-sample avg dev_std = 0.448)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.145
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.157
NEC for r=0.6 class 0 = 0.685 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 1 = 0.214 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 2 = 0.535 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 3 = 0.586 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 4 = 0.517 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 5 = 0.539 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 6 = 0.515 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 7 = 0.451 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 8 = 0.583 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 class 9 = 0.551 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 all KL = 0.549 +- 0.295 (in-sample avg dev_std = 0.391)
NEC for r=0.6 all L1 = 0.513 +- 0.232 (in-sample avg dev_std = 0.391)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.373
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.307
NEC for r=0.9 class 0 = 0.64 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 1 = 0.503 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 2 = 0.542 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 3 = 0.636 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 4 = 0.597 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 5 = 0.63 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 6 = 0.596 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 7 = 0.447 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 8 = 0.578 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 class 9 = 0.573 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all KL = 0.657 +- 0.244 (in-sample avg dev_std = 0.436)
NEC for r=0.9 all L1 = 0.571 +- 0.187 (in-sample avg dev_std = 0.436)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.55
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.466
NEC for r=1.0 class 0 = 0.58 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 1 = 0.615 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 2 = 0.506 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 3 = 0.625 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 4 = 0.588 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 5 = 0.599 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 6 = 0.616 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 7 = 0.365 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 8 = 0.408 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 class 9 = 0.577 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 all KL = 0.634 +- 0.254 (in-sample avg dev_std = 0.428)
NEC for r=1.0 all L1 = 0.546 +- 0.205 (in-sample avg dev_std = 0.428)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.135
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.117
NEC for r=0.3 class 0 = 0.549 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 1 = 0.33 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 2 = 0.59 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 3 = 0.532 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 4 = 0.446 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 5 = 0.504 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 6 = 0.47 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 7 = 0.378 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 8 = 0.597 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 class 9 = 0.411 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 all KL = 0.535 +- 0.321 (in-sample avg dev_std = 0.455)
NEC for r=0.3 all L1 = 0.477 +- 0.251 (in-sample avg dev_std = 0.455)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.146
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.149
NEC for r=0.6 class 0 = 0.606 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.253 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.527 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 3 = 0.573 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 4 = 0.525 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 5 = 0.567 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 6 = 0.531 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 7 = 0.463 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 8 = 0.579 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 9 = 0.546 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.543 +- 0.288 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.511 +- 0.229 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.381
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.294
NEC for r=0.9 class 0 = 0.648 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 1 = 0.551 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 2 = 0.574 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 3 = 0.621 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 4 = 0.618 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 5 = 0.625 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 6 = 0.596 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 7 = 0.43 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 8 = 0.572 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 class 9 = 0.585 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all KL = 0.654 +- 0.246 (in-sample avg dev_std = 0.425)
NEC for r=0.9 all L1 = 0.58 +- 0.187 (in-sample avg dev_std = 0.425)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.562
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.453
NEC for r=1.0 class 0 = 0.592 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 1 = 0.652 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 2 = 0.531 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 3 = 0.619 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 4 = 0.596 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 5 = 0.611 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 6 = 0.59 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 7 = 0.363 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 8 = 0.431 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 class 9 = 0.588 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 all KL = 0.641 +- 0.255 (in-sample avg dev_std = 0.432)
NEC for r=1.0 all L1 = 0.557 +- 0.197 (in-sample avg dev_std = 0.432)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.101
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
NEC for r=0.3 class 0 = 0.455 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 1 = 0.455 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 2 = 0.465 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 3 = 0.444 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 4 = 0.481 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 5 = 0.431 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 6 = 0.433 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 7 = 0.467 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 8 = 0.395 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 class 9 = 0.477 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all KL = 0.444 +- 0.296 (in-sample avg dev_std = 0.337)
NEC for r=0.3 all L1 = 0.451 +- 0.237 (in-sample avg dev_std = 0.337)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.141
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.138
NEC for r=0.6 class 0 = 0.413 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 1 = 0.725 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 2 = 0.429 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 3 = 0.468 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 4 = 0.518 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 5 = 0.461 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 6 = 0.499 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 7 = 0.472 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 8 = 0.451 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 class 9 = 0.563 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all KL = 0.509 +- 0.323 (in-sample avg dev_std = 0.330)
NEC for r=0.6 all L1 = 0.502 +- 0.242 (in-sample avg dev_std = 0.330)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.14
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.128
NEC for r=0.9 class 0 = 0.56 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 1 = 0.779 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 2 = 0.406 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 3 = 0.438 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 4 = 0.551 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 5 = 0.499 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 6 = 0.515 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 7 = 0.464 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 8 = 0.439 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 class 9 = 0.661 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 all KL = 0.615 +- 0.362 (in-sample avg dev_std = 0.313)
NEC for r=0.9 all L1 = 0.533 +- 0.301 (in-sample avg dev_std = 0.313)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.151
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.141
NEC for r=1.0 class 0 = 0.66 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 1 = 0.776 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 2 = 0.442 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 3 = 0.467 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 4 = 0.618 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 5 = 0.524 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 6 = 0.525 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 7 = 0.528 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 8 = 0.493 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 class 9 = 0.654 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 all KL = 0.672 +- 0.349 (in-sample avg dev_std = 0.311)
NEC for r=1.0 all L1 = 0.571 +- 0.295 (in-sample avg dev_std = 0.311)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 09:13:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 09:13:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9535
Train Loss: 0.1365
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3275
ID Test ACCURACY: 0.8934
ID Test Loss: 0.3509
OOD Validation ACCURACY: 0.7967
OOD Validation Loss: 0.7240
OOD Test ACCURACY: 0.3600
OOD Test Loss: 3.9303

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9558
Train Loss: 0.1305
ID Validation ACCURACY: 0.8937
ID Validation Loss: 0.3375
ID Test ACCURACY: 0.8907
ID Test Loss: 0.3501
OOD Validation ACCURACY: 0.8079
OOD Validation Loss: 0.7107
OOD Test ACCURACY: 0.3777
OOD Test Loss: 4.1570

[0m[1;37mINFO[0m: [1mChartInfo 0.8934 0.3600 0.8907 0.3777 0.8937 0.8079[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.14
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.128
SUFF++ for r=0.3 class 0 = 0.426 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 1 = 0.449 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 2 = 0.486 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 3 = 0.488 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 4 = 0.524 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 5 = 0.472 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 6 = 0.491 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 7 = 0.576 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 8 = 0.489 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 class 9 = 0.518 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 all KL = 0.533 +- 0.264 (in-sample avg dev_std = 0.421)
SUFF++ for r=0.3 all L1 = 0.492 +- 0.164 (in-sample avg dev_std = 0.421)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.136
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.471 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 1 = 0.346 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 2 = 0.439 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 3 = 0.45 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 4 = 0.447 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 5 = 0.422 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 6 = 0.428 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 7 = 0.442 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 8 = 0.432 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 class 9 = 0.441 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all KL = 0.383 +- 0.236 (in-sample avg dev_std = 0.470)
SUFF++ for r=0.6 all L1 = 0.431 +- 0.123 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.274
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.175
SUFF++ for r=0.9 class 0 = 0.286 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 1 = 0.272 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 2 = 0.416 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 3 = 0.319 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 4 = 0.333 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 5 = 0.313 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 6 = 0.287 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 7 = 0.371 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 8 = 0.286 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 class 9 = 0.321 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 all KL = 0.187 +- 0.189 (in-sample avg dev_std = 0.492)
SUFF++ for r=0.9 all L1 = 0.321 +- 0.121 (in-sample avg dev_std = 0.492)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.136
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.119
SUFF++ for r=0.3 class 0 = 0.442 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 1 = 0.483 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 2 = 0.454 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 3 = 0.469 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 4 = 0.527 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 5 = 0.534 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 6 = 0.498 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 7 = 0.553 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 8 = 0.496 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 class 9 = 0.542 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 all KL = 0.546 +- 0.256 (in-sample avg dev_std = 0.418)
SUFF++ for r=0.3 all L1 = 0.5 +- 0.159 (in-sample avg dev_std = 0.418)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.13
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.109
SUFF++ for r=0.6 class 0 = 0.479 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 1 = 0.349 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 2 = 0.437 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 3 = 0.475 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 4 = 0.455 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 5 = 0.445 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 6 = 0.454 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 7 = 0.474 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 8 = 0.426 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 class 9 = 0.442 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all KL = 0.405 +- 0.237 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.6 all L1 = 0.442 +- 0.123 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.244
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.161
SUFF++ for r=0.9 class 0 = 0.287 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 1 = 0.26 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 2 = 0.372 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 3 = 0.297 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 4 = 0.311 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 5 = 0.324 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 6 = 0.275 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 7 = 0.348 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 8 = 0.295 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 class 9 = 0.311 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 all KL = 0.176 +- 0.182 (in-sample avg dev_std = 0.491)
SUFF++ for r=0.9 all L1 = 0.307 +- 0.119 (in-sample avg dev_std = 0.491)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.171
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.126
SUFF++ for r=0.3 class 0 = 0.485 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 1 = 0.388 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 2 = 0.528 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 3 = 0.512 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 4 = 0.5 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 5 = 0.549 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 6 = 0.435 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 7 = 0.521 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 8 = 0.485 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 class 9 = 0.421 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 all KL = 0.507 +- 0.266 (in-sample avg dev_std = 0.331)
SUFF++ for r=0.3 all L1 = 0.481 +- 0.188 (in-sample avg dev_std = 0.331)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.15
SUFF++ for r=0.6 class 0 = 0.398 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 1 = 0.352 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 2 = 0.424 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 3 = 0.37 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 4 = 0.367 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 5 = 0.378 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 6 = 0.382 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 7 = 0.363 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 8 = 0.365 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 class 9 = 0.365 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 all KL = 0.289 +- 0.216 (in-sample avg dev_std = 0.513)
SUFF++ for r=0.6 all L1 = 0.376 +- 0.128 (in-sample avg dev_std = 0.513)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.224
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.164
SUFF++ for r=0.9 class 0 = 0.308 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 1 = 0.452 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 2 = 0.493 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 3 = 0.412 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 4 = 0.541 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 5 = 0.469 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 6 = 0.466 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 7 = 0.444 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 8 = 0.438 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 9 = 0.47 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 all KL = 0.234 +- 0.234 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 all L1 = 0.449 +- 0.223 (in-sample avg dev_std = 0.460)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.14
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.131
NEC for r=0.3 class 0 = 0.576 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 1 = 0.452 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 2 = 0.544 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 3 = 0.542 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 4 = 0.454 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 5 = 0.567 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 6 = 0.507 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 7 = 0.451 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 8 = 0.524 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 class 9 = 0.447 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all KL = 0.475 +- 0.273 (in-sample avg dev_std = 0.400)
NEC for r=0.3 all L1 = 0.505 +- 0.180 (in-sample avg dev_std = 0.400)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.136
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.13
NEC for r=0.6 class 0 = 0.415 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 1 = 0.553 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 2 = 0.384 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 3 = 0.434 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 4 = 0.492 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 5 = 0.466 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 6 = 0.466 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 7 = 0.464 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 8 = 0.4 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 class 9 = 0.457 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 all KL = 0.453 +- 0.259 (in-sample avg dev_std = 0.376)
NEC for r=0.6 all L1 = 0.454 +- 0.195 (in-sample avg dev_std = 0.376)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.274
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.207
NEC for r=0.9 class 0 = 0.592 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 1 = 0.656 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 2 = 0.36 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 3 = 0.523 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 4 = 0.576 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 5 = 0.567 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 6 = 0.594 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 7 = 0.518 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 8 = 0.568 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 class 9 = 0.587 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 all KL = 0.608 +- 0.251 (in-sample avg dev_std = 0.398)
NEC for r=0.9 all L1 = 0.553 +- 0.185 (in-sample avg dev_std = 0.398)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.446
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.347
NEC for r=1.0 class 0 = 0.683 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 1 = 0.598 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 2 = 0.374 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 3 = 0.607 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 4 = 0.626 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 5 = 0.602 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 6 = 0.624 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 7 = 0.544 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 8 = 0.484 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 class 9 = 0.599 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 all KL = 0.635 +- 0.235 (in-sample avg dev_std = 0.414)
NEC for r=1.0 all L1 = 0.573 +- 0.175 (in-sample avg dev_std = 0.414)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.136
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.122
NEC for r=0.3 class 0 = 0.556 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 1 = 0.406 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 2 = 0.544 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 3 = 0.539 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 4 = 0.477 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 5 = 0.519 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 6 = 0.472 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 7 = 0.426 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 8 = 0.531 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 class 9 = 0.475 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all KL = 0.454 +- 0.272 (in-sample avg dev_std = 0.395)
NEC for r=0.3 all L1 = 0.492 +- 0.183 (in-sample avg dev_std = 0.395)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.13
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.124
NEC for r=0.6 class 0 = 0.401 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 1 = 0.571 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 2 = 0.359 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 3 = 0.42 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 4 = 0.483 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 5 = 0.452 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 6 = 0.459 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 7 = 0.445 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 8 = 0.417 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 class 9 = 0.446 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 all KL = 0.431 +- 0.247 (in-sample avg dev_std = 0.368)
NEC for r=0.6 all L1 = 0.448 +- 0.191 (in-sample avg dev_std = 0.368)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.244
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.199
NEC for r=0.9 class 0 = 0.57 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 1 = 0.637 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 2 = 0.369 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 3 = 0.509 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 4 = 0.619 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 5 = 0.576 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 6 = 0.591 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 7 = 0.512 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 8 = 0.56 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 class 9 = 0.595 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all KL = 0.608 +- 0.248 (in-sample avg dev_std = 0.397)
NEC for r=0.9 all L1 = 0.555 +- 0.182 (in-sample avg dev_std = 0.397)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.463
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.343
NEC for r=1.0 class 0 = 0.674 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 1 = 0.554 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 2 = 0.361 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 3 = 0.587 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 4 = 0.617 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 5 = 0.544 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 6 = 0.617 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 7 = 0.553 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 8 = 0.502 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 class 9 = 0.61 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 all KL = 0.628 +- 0.242 (in-sample avg dev_std = 0.407)
NEC for r=1.0 all L1 = 0.561 +- 0.189 (in-sample avg dev_std = 0.407)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.171
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.124
NEC for r=0.3 class 0 = 0.495 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 1 = 0.586 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 2 = 0.454 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 3 = 0.468 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 4 = 0.491 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 5 = 0.452 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 6 = 0.501 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 7 = 0.438 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 8 = 0.505 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 class 9 = 0.512 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 all KL = 0.437 +- 0.272 (in-sample avg dev_std = 0.298)
NEC for r=0.3 all L1 = 0.491 +- 0.193 (in-sample avg dev_std = 0.298)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.153
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.144
NEC for r=0.6 class 0 = 0.531 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 1 = 0.51 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 2 = 0.506 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 3 = 0.531 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 4 = 0.467 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 5 = 0.484 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 6 = 0.476 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 7 = 0.521 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 8 = 0.472 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 class 9 = 0.483 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all KL = 0.508 +- 0.279 (in-sample avg dev_std = 0.406)
NEC for r=0.6 all L1 = 0.499 +- 0.204 (in-sample avg dev_std = 0.406)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.224
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.185
NEC for r=0.9 class 0 = 0.647 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 1 = 0.362 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 2 = 0.429 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 3 = 0.464 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 4 = 0.385 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 5 = 0.429 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 6 = 0.414 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 7 = 0.438 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 8 = 0.492 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 9 = 0.429 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all KL = 0.558 +- 0.320 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all L1 = 0.449 +- 0.263 (in-sample avg dev_std = 0.383)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.229
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.198
NEC for r=1.0 class 0 = 0.68 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 1 = 0.33 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 2 = 0.431 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 3 = 0.511 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 4 = 0.443 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 5 = 0.53 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 6 = 0.475 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 7 = 0.432 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 8 = 0.535 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 class 9 = 0.47 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 all KL = 0.599 +- 0.322 (in-sample avg dev_std = 0.375)
NEC for r=1.0 all L1 = 0.482 +- 0.264 (in-sample avg dev_std = 0.375)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 09:36:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:10 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:10 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:10 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:10 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 09:36:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9596
Train Loss: 0.1152
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.3468
ID Test ACCURACY: 0.8917
ID Test Loss: 0.3635
OOD Validation ACCURACY: 0.7677
OOD Validation Loss: 0.9997
OOD Test ACCURACY: 0.2817
OOD Test Loss: 8.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.2061
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.3800
ID Test ACCURACY: 0.8751
ID Test Loss: 0.3820
OOD Validation ACCURACY: 0.7924
OOD Validation Loss: 0.6931
OOD Test ACCURACY: 0.3419
OOD Test Loss: 4.0133

[0m[1;37mINFO[0m: [1mChartInfo 0.8917 0.2817 0.8751 0.3419 0.8797 0.7924[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
SUFF++ for r=0.3 class 0 = 0.516 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 1 = 0.744 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 2 = 0.531 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 3 = 0.6 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 4 = 0.58 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 5 = 0.613 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 6 = 0.554 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 7 = 0.575 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 8 = 0.614 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 class 9 = 0.633 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 all KL = 0.554 +- 0.266 (in-sample avg dev_std = 0.382)
SUFF++ for r=0.3 all L1 = 0.597 +- 0.207 (in-sample avg dev_std = 0.382)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.117
SUFF++ for r=0.6 class 0 = 0.396 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 1 = 0.454 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 2 = 0.361 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 3 = 0.461 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 4 = 0.351 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 5 = 0.364 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 6 = 0.382 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 7 = 0.383 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 8 = 0.393 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 class 9 = 0.394 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all KL = 0.342 +- 0.224 (in-sample avg dev_std = 0.451)
SUFF++ for r=0.6 all L1 = 0.396 +- 0.153 (in-sample avg dev_std = 0.451)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.295
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.213
SUFF++ for r=0.9 class 0 = 0.248 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 1 = 0.26 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 2 = 0.356 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 3 = 0.331 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 4 = 0.296 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 5 = 0.28 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 6 = 0.271 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 7 = 0.343 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 8 = 0.287 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 class 9 = 0.267 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 all KL = 0.156 +- 0.163 (in-sample avg dev_std = 0.460)
SUFF++ for r=0.9 all L1 = 0.295 +- 0.119 (in-sample avg dev_std = 0.460)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.11
SUFF++ for r=0.3 class 0 = 0.555 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 1 = 0.743 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 2 = 0.476 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 3 = 0.589 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 4 = 0.602 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 5 = 0.61 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 6 = 0.607 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 7 = 0.554 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 8 = 0.624 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 class 9 = 0.621 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all KL = 0.563 +- 0.256 (in-sample avg dev_std = 0.385)
SUFF++ for r=0.3 all L1 = 0.601 +- 0.197 (in-sample avg dev_std = 0.385)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.14
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.113
SUFF++ for r=0.6 class 0 = 0.378 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 1 = 0.452 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 2 = 0.394 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 3 = 0.437 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 4 = 0.373 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 5 = 0.388 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 6 = 0.413 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 7 = 0.414 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 8 = 0.38 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 class 9 = 0.399 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all KL = 0.365 +- 0.236 (in-sample avg dev_std = 0.432)
SUFF++ for r=0.6 all L1 = 0.404 +- 0.161 (in-sample avg dev_std = 0.432)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.29
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.212
SUFF++ for r=0.9 class 0 = 0.238 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 1 = 0.273 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 2 = 0.385 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 3 = 0.296 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 4 = 0.297 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 5 = 0.274 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 6 = 0.26 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 7 = 0.332 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 8 = 0.277 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 class 9 = 0.284 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 all KL = 0.157 +- 0.151 (in-sample avg dev_std = 0.445)
SUFF++ for r=0.9 all L1 = 0.292 +- 0.111 (in-sample avg dev_std = 0.445)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.068
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.101
SUFF++ for r=0.3 class 0 = 0.483 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 1 = 0.288 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 2 = 0.48 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 3 = 0.429 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 4 = 0.386 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 5 = 0.437 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 6 = 0.424 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 7 = 0.463 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 8 = 0.418 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 class 9 = 0.351 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all KL = 0.377 +- 0.290 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.3 all L1 = 0.415 +- 0.174 (in-sample avg dev_std = 0.477)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.114
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.122
SUFF++ for r=0.6 class 0 = 0.417 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 1 = 0.315 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 2 = 0.452 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 3 = 0.393 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 4 = 0.351 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 5 = 0.425 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 6 = 0.357 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 7 = 0.357 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 8 = 0.375 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 9 = 0.323 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all KL = 0.233 +- 0.245 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all L1 = 0.376 +- 0.149 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.134
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.124
SUFF++ for r=0.9 class 0 = 0.507 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 1 = 0.321 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 2 = 0.611 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 3 = 0.597 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 4 = 0.472 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 5 = 0.543 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 6 = 0.553 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 7 = 0.551 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 8 = 0.535 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 class 9 = 0.42 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 all KL = 0.377 +- 0.326 (in-sample avg dev_std = 0.365)
SUFF++ for r=0.9 all L1 = 0.509 +- 0.279 (in-sample avg dev_std = 0.365)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.119
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.105
NEC for r=0.3 class 0 = 0.537 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 1 = 0.2 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 2 = 0.513 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 3 = 0.45 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 4 = 0.426 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 5 = 0.451 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 6 = 0.47 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 7 = 0.419 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 8 = 0.434 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 9 = 0.356 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 all KL = 0.484 +- 0.322 (in-sample avg dev_std = 0.407)
NEC for r=0.3 all L1 = 0.423 +- 0.239 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.117
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.127
NEC for r=0.6 class 0 = 0.59 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 1 = 0.389 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 2 = 0.589 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 3 = 0.536 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 4 = 0.637 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 5 = 0.614 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 6 = 0.601 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 7 = 0.563 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 8 = 0.581 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 class 9 = 0.577 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 all KL = 0.596 +- 0.250 (in-sample avg dev_std = 0.415)
NEC for r=0.6 all L1 = 0.564 +- 0.171 (in-sample avg dev_std = 0.415)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.295
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.243
NEC for r=0.9 class 0 = 0.684 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 1 = 0.572 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 2 = 0.507 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 3 = 0.597 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 4 = 0.586 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 5 = 0.636 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 6 = 0.647 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 7 = 0.575 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 8 = 0.626 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 class 9 = 0.63 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 all KL = 0.703 +- 0.230 (in-sample avg dev_std = 0.446)
NEC for r=0.9 all L1 = 0.604 +- 0.164 (in-sample avg dev_std = 0.446)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.475
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.399
NEC for r=1.0 class 0 = 0.679 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 1 = 0.642 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 2 = 0.457 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 3 = 0.63 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 4 = 0.564 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 5 = 0.621 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 6 = 0.62 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 7 = 0.549 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 8 = 0.541 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 class 9 = 0.652 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 all KL = 0.692 +- 0.226 (in-sample avg dev_std = 0.462)
NEC for r=1.0 all L1 = 0.595 +- 0.170 (in-sample avg dev_std = 0.462)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.126
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.108
NEC for r=0.3 class 0 = 0.507 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 1 = 0.176 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 2 = 0.532 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 3 = 0.488 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 4 = 0.399 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 5 = 0.474 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 6 = 0.42 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 7 = 0.44 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 8 = 0.403 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 9 = 0.362 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all KL = 0.471 +- 0.317 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all L1 = 0.415 +- 0.235 (in-sample avg dev_std = 0.413)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.14
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.127
NEC for r=0.6 class 0 = 0.625 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 1 = 0.413 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 2 = 0.585 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 3 = 0.553 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 4 = 0.594 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 5 = 0.613 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 6 = 0.558 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 7 = 0.587 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 8 = 0.582 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 9 = 0.57 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 all KL = 0.596 +- 0.255 (in-sample avg dev_std = 0.414)
NEC for r=0.6 all L1 = 0.565 +- 0.171 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.29
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.243
NEC for r=0.9 class 0 = 0.678 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 1 = 0.638 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 2 = 0.56 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 3 = 0.596 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 4 = 0.597 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 5 = 0.636 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 6 = 0.644 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 7 = 0.572 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 8 = 0.623 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 class 9 = 0.621 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 all KL = 0.715 +- 0.217 (in-sample avg dev_std = 0.452)
NEC for r=0.9 all L1 = 0.616 +- 0.156 (in-sample avg dev_std = 0.452)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.491
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.388
NEC for r=1.0 class 0 = 0.661 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 1 = 0.648 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 2 = 0.476 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 3 = 0.586 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 4 = 0.576 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 5 = 0.647 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 6 = 0.585 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 7 = 0.535 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 8 = 0.576 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 class 9 = 0.623 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 all KL = 0.7 +- 0.230 (in-sample avg dev_std = 0.463)
NEC for r=1.0 all L1 = 0.591 +- 0.176 (in-sample avg dev_std = 0.463)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.068
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.095
NEC for r=0.3 class 0 = 0.54 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 1 = 0.649 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 2 = 0.522 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 3 = 0.548 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 4 = 0.613 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 5 = 0.544 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 6 = 0.532 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 7 = 0.549 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 8 = 0.549 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 class 9 = 0.604 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 all KL = 0.611 +- 0.311 (in-sample avg dev_std = 0.406)
NEC for r=0.3 all L1 = 0.566 +- 0.213 (in-sample avg dev_std = 0.406)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.114
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.13
NEC for r=0.6 class 0 = 0.435 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 1 = 0.693 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 2 = 0.466 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 3 = 0.519 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 4 = 0.566 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 5 = 0.438 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 6 = 0.625 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 7 = 0.544 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 8 = 0.561 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 class 9 = 0.626 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 all KL = 0.632 +- 0.337 (in-sample avg dev_std = 0.403)
NEC for r=0.6 all L1 = 0.549 +- 0.233 (in-sample avg dev_std = 0.403)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.134
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.156
NEC for r=0.9 class 0 = 0.472 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 1 = 0.599 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 2 = 0.38 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 3 = 0.389 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 4 = 0.491 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 5 = 0.422 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 6 = 0.416 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 7 = 0.399 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 8 = 0.43 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 class 9 = 0.559 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 all KL = 0.547 +- 0.354 (in-sample avg dev_std = 0.291)
NEC for r=0.9 all L1 = 0.457 +- 0.303 (in-sample avg dev_std = 0.291)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.151
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.179
NEC for r=1.0 class 0 = 0.652 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 1 = 0.586 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 2 = 0.506 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 3 = 0.568 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 4 = 0.603 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 5 = 0.559 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 6 = 0.517 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 7 = 0.538 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 8 = 0.591 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 class 9 = 0.661 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 all KL = 0.689 +- 0.304 (in-sample avg dev_std = 0.334)
NEC for r=1.0 all L1 = 0.578 +- 0.262 (in-sample avg dev_std = 0.334)
model_dirname= repr_GSATvGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_explscorestopk0.8avgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jul 30 09:58:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:48 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: topK
[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 07/30/2024 09:58:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9620
Train Loss: 0.1115
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3470
ID Test ACCURACY: 0.8971
ID Test Loss: 0.3504
OOD Validation ACCURACY: 0.7896
OOD Validation Loss: 0.8299
OOD Test ACCURACY: 0.3297
OOD Test Loss: 4.8190

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.9377
Train Loss: 0.1807
ID Validation ACCURACY: 0.8834
ID Validation Loss: 0.3683
ID Test ACCURACY: 0.8880
ID Test Loss: 0.3729
OOD Validation ACCURACY: 0.8081
OOD Validation Loss: 0.6497
OOD Test ACCURACY: 0.3289
OOD Test Loss: 5.5495

[0m[1;37mINFO[0m: [1mChartInfo 0.8971 0.3297 0.8880 0.3289 0.8834 0.8081[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from id_test: Data(x=[75, 3], edge_index=[2, 1351], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1351], node_perm=[75])
Label distribution from id_test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([657, 814, 676, 706, 676, 663, 688, 748, 702, 670]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
GOODCMNIST(7000)
Data example from test: Data(x=[75, 3], edge_index=[2, 1431], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1431], node_perm=[75])
Label distribution from test: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([716, 781, 751, 697, 673, 616, 676, 705, 705, 680]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.125
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.12
SUFF++ for r=0.3 class 0 = 0.402 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 1 = 0.519 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 2 = 0.461 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 3 = 0.5 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 4 = 0.539 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 5 = 0.495 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 6 = 0.528 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 7 = 0.584 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 8 = 0.464 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 class 9 = 0.507 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 all KL = 0.516 +- 0.289 (in-sample avg dev_std = 0.443)
SUFF++ for r=0.3 all L1 = 0.501 +- 0.157 (in-sample avg dev_std = 0.443)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.125
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.128
SUFF++ for r=0.6 class 0 = 0.331 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 1 = 0.491 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 2 = 0.443 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 3 = 0.476 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 4 = 0.382 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 5 = 0.436 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 6 = 0.375 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 7 = 0.463 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 8 = 0.391 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 class 9 = 0.386 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all KL = 0.399 +- 0.233 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.6 all L1 = 0.42 +- 0.139 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.279
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.181
SUFF++ for r=0.9 class 0 = 0.272 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 1 = 0.353 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 2 = 0.29 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 3 = 0.297 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 4 = 0.289 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 5 = 0.307 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 6 = 0.29 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 7 = 0.419 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 8 = 0.256 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 class 9 = 0.297 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 all KL = 0.187 +- 0.198 (in-sample avg dev_std = 0.448)
SUFF++ for r=0.9 all L1 = 0.309 +- 0.141 (in-sample avg dev_std = 0.448)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.115
SUFF++ for r=0.3 class 0 = 0.428 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 1 = 0.568 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 2 = 0.46 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 3 = 0.486 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 4 = 0.507 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 5 = 0.557 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 6 = 0.495 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 7 = 0.557 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 8 = 0.493 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 class 9 = 0.529 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all KL = 0.536 +- 0.280 (in-sample avg dev_std = 0.435)
SUFF++ for r=0.3 all L1 = 0.51 +- 0.155 (in-sample avg dev_std = 0.435)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.12
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.123
SUFF++ for r=0.6 class 0 = 0.368 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 1 = 0.485 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 2 = 0.424 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 3 = 0.454 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 4 = 0.369 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 5 = 0.47 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 6 = 0.389 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 7 = 0.447 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 8 = 0.389 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 class 9 = 0.415 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all KL = 0.405 +- 0.245 (in-sample avg dev_std = 0.427)
SUFF++ for r=0.6 all L1 = 0.423 +- 0.146 (in-sample avg dev_std = 0.427)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.27
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.174
SUFF++ for r=0.9 class 0 = 0.248 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 1 = 0.341 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 2 = 0.297 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 3 = 0.275 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 4 = 0.31 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 5 = 0.281 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 6 = 0.284 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 7 = 0.398 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 8 = 0.266 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 class 9 = 0.283 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 all KL = 0.181 +- 0.196 (in-sample avg dev_std = 0.433)
SUFF++ for r=0.9 all L1 = 0.3 +- 0.138 (in-sample avg dev_std = 0.433)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.136
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.112
SUFF++ for r=0.3 class 0 = 0.469 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 1 = 0.331 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 2 = 0.49 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 3 = 0.477 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 4 = 0.455 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 5 = 0.494 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 6 = 0.512 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 7 = 0.529 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 8 = 0.497 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 class 9 = 0.431 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all KL = 0.501 +- 0.306 (in-sample avg dev_std = 0.364)
SUFF++ for r=0.3 all L1 = 0.467 +- 0.178 (in-sample avg dev_std = 0.364)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.13
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.127
SUFF++ for r=0.6 class 0 = 0.414 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 1 = 0.362 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 2 = 0.408 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 3 = 0.366 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 4 = 0.346 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 5 = 0.366 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 6 = 0.398 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 7 = 0.351 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 8 = 0.366 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 class 9 = 0.377 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 all KL = 0.22 +- 0.221 (in-sample avg dev_std = 0.590)
SUFF++ for r=0.6 all L1 = 0.376 +- 0.156 (in-sample avg dev_std = 0.590)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.172
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.135
SUFF++ for r=0.9 class 0 = 0.475 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 1 = 0.366 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 2 = 0.675 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 3 = 0.581 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 4 = 0.56 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 5 = 0.596 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 6 = 0.555 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 7 = 0.6 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 8 = 0.504 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 class 9 = 0.456 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 all KL = 0.356 +- 0.331 (in-sample avg dev_std = 0.450)
SUFF++ for r=0.9 all L1 = 0.535 +- 0.279 (in-sample avg dev_std = 0.450)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.125
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.12
NEC for r=0.3 class 0 = 0.625 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 1 = 0.425 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 2 = 0.623 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 3 = 0.582 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 4 = 0.511 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 5 = 0.563 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 6 = 0.5 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 7 = 0.473 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 8 = 0.593 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 class 9 = 0.501 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all KL = 0.563 +- 0.330 (in-sample avg dev_std = 0.434)
NEC for r=0.3 all L1 = 0.538 +- 0.205 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.125
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.126
NEC for r=0.6 class 0 = 0.617 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 1 = 0.437 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 2 = 0.568 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 3 = 0.511 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 4 = 0.593 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 5 = 0.588 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 6 = 0.56 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 7 = 0.479 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 8 = 0.575 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 class 9 = 0.596 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all KL = 0.545 +- 0.259 (in-sample avg dev_std = 0.383)
NEC for r=0.6 all L1 = 0.549 +- 0.175 (in-sample avg dev_std = 0.383)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.279
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.22
NEC for r=0.9 class 0 = 0.651 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 1 = 0.59 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 2 = 0.567 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 3 = 0.636 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 4 = 0.645 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 5 = 0.612 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 6 = 0.644 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 7 = 0.507 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 8 = 0.623 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 class 9 = 0.626 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 all KL = 0.687 +- 0.221 (in-sample avg dev_std = 0.410)
NEC for r=0.9 all L1 = 0.608 +- 0.156 (in-sample avg dev_std = 0.410)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.465
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.356
NEC for r=1.0 class 0 = 0.653 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 1 = 0.667 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 2 = 0.505 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 3 = 0.604 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 4 = 0.656 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 5 = 0.583 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 6 = 0.624 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 7 = 0.482 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 8 = 0.521 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 class 9 = 0.616 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all KL = 0.679 +- 0.236 (in-sample avg dev_std = 0.426)
NEC for r=1.0 all L1 = 0.59 +- 0.180 (in-sample avg dev_std = 0.426)



--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.106
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.109
NEC for r=0.3 class 0 = 0.598 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 1 = 0.395 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 2 = 0.584 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 3 = 0.63 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 4 = 0.535 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 5 = 0.584 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 6 = 0.55 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 7 = 0.48 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 8 = 0.562 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 class 9 = 0.48 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all KL = 0.555 +- 0.326 (in-sample avg dev_std = 0.428)
NEC for r=0.3 all L1 = 0.537 +- 0.196 (in-sample avg dev_std = 0.428)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.12
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.119
NEC for r=0.6 class 0 = 0.605 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 1 = 0.403 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 2 = 0.544 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 3 = 0.532 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 4 = 0.619 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 5 = 0.563 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 6 = 0.574 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 7 = 0.507 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 8 = 0.573 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 class 9 = 0.566 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 all KL = 0.55 +- 0.258 (in-sample avg dev_std = 0.394)
NEC for r=0.6 all L1 = 0.545 +- 0.176 (in-sample avg dev_std = 0.394)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.27
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.212
NEC for r=0.9 class 0 = 0.662 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 1 = 0.63 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 2 = 0.616 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 3 = 0.666 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 4 = 0.625 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 5 = 0.639 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 6 = 0.63 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 7 = 0.519 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 8 = 0.606 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 class 9 = 0.593 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 all KL = 0.694 +- 0.227 (in-sample avg dev_std = 0.412)
NEC for r=0.9 all L1 = 0.618 +- 0.157 (in-sample avg dev_std = 0.412)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.468
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.343
NEC for r=1.0 class 0 = 0.661 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 1 = 0.623 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 2 = 0.521 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 3 = 0.622 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 4 = 0.621 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 5 = 0.587 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 6 = 0.652 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 7 = 0.434 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 8 = 0.496 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 class 9 = 0.644 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 all KL = 0.682 +- 0.235 (in-sample avg dev_std = 0.435)
NEC for r=1.0 all L1 = 0.585 +- 0.182 (in-sample avg dev_std = 0.435)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.136
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.300 +- 0.000
Model Accuracy over intervened graphs for r=0.3 =  0.099
NEC for r=0.3 class 0 = 0.541 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 1 = 0.702 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 2 = 0.518 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 3 = 0.526 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 4 = 0.551 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 5 = 0.523 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 6 = 0.52 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 7 = 0.493 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 8 = 0.529 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 class 9 = 0.563 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all KL = 0.55 +- 0.295 (in-sample avg dev_std = 0.332)
NEC for r=0.3 all L1 = 0.549 +- 0.185 (in-sample avg dev_std = 0.332)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.13
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.600 +- 0.000
Model Accuracy over intervened graphs for r=0.6 =  0.147
NEC for r=0.6 class 0 = 0.439 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 1 = 0.686 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 2 = 0.394 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 3 = 0.469 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 4 = 0.528 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 5 = 0.446 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 6 = 0.56 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 7 = 0.454 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 8 = 0.467 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 class 9 = 0.557 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all KL = 0.551 +- 0.327 (in-sample avg dev_std = 0.378)
NEC for r=0.6 all L1 = 0.501 +- 0.253 (in-sample avg dev_std = 0.378)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.172
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.900 +- 0.000
Model Accuracy over intervened graphs for r=0.9 =  0.144
NEC for r=0.9 class 0 = 0.471 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 1 = 0.648 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 2 = 0.266 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 3 = 0.358 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 4 = 0.386 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 5 = 0.342 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 6 = 0.39 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 7 = 0.361 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 8 = 0.436 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 class 9 = 0.519 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 all KL = 0.492 +- 0.392 (in-sample avg dev_std = 0.277)
NEC for r=0.9 all L1 = 0.42 +- 0.335 (in-sample avg dev_std = 0.277)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.18
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.168
NEC for r=1.0 class 0 = 0.585 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 1 = 0.586 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 2 = 0.374 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 3 = 0.444 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 4 = 0.412 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 5 = 0.443 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 6 = 0.468 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 7 = 0.425 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 8 = 0.541 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 class 9 = 0.571 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 all KL = 0.588 +- 0.374 (in-sample avg dev_std = 0.336)
NEC for r=1.0 all L1 = 0.486 +- 0.316 (in-sample avg dev_std = 0.336)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.437, 0.237, 0.204, 1.0], 'all_L1': [0.536, 0.332, 0.332, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.494, 0.373, 0.177, 1.0], 'all_L1': [0.55, 0.451, 0.324, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.533, 0.383, 0.187, 1.0], 'all_L1': [0.492, 0.431, 0.321, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.342, 0.156, 1.0], 'all_L1': [0.597, 0.396, 0.295, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.399, 0.187, 1.0], 'all_L1': [0.501, 0.42, 0.309, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.672, 0.575, 0.605, 0.622], 'all_L1': [0.541, 0.539, 0.548, 0.562]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.549, 0.657, 0.634], 'all_L1': [0.496, 0.513, 0.571, 0.546]}), defaultdict(<class 'list'>, {'all_KL': [0.475, 0.453, 0.608, 0.635], 'all_L1': [0.505, 0.454, 0.553, 0.573]}), defaultdict(<class 'list'>, {'all_KL': [0.484, 0.596, 0.703, 0.692], 'all_L1': [0.423, 0.564, 0.604, 0.595]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.545, 0.687, 0.679], 'all_L1': [0.538, 0.549, 0.608, 0.59]})]

Eval split id_test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.436, 0.239, 0.211, 1.0], 'all_L1': [0.539, 0.336, 0.33, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.5, 0.373, 0.182, 1.0], 'all_L1': [0.56, 0.455, 0.328, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.405, 0.176, 1.0], 'all_L1': [0.5, 0.442, 0.307, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.365, 0.157, 1.0], 'all_L1': [0.601, 0.404, 0.292, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.536, 0.405, 0.181, 1.0], 'all_L1': [0.51, 0.423, 0.3, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.652, 0.577, 0.601, 0.623], 'all_L1': [0.531, 0.54, 0.548, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.535, 0.543, 0.654, 0.641], 'all_L1': [0.477, 0.511, 0.58, 0.557]}), defaultdict(<class 'list'>, {'all_KL': [0.454, 0.431, 0.608, 0.628], 'all_L1': [0.492, 0.448, 0.555, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.471, 0.596, 0.715, 0.7], 'all_L1': [0.415, 0.565, 0.616, 0.591]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.55, 0.694, 0.682], 'all_L1': [0.537, 0.545, 0.618, 0.585]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.568, 0.278, 0.194, 1.0], 'all_L1': [0.576, 0.343, 0.372, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.465, 0.291, 0.195, 1.0], 'all_L1': [0.498, 0.398, 0.38, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.507, 0.289, 0.234, 1.0], 'all_L1': [0.481, 0.376, 0.449, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.377, 0.233, 0.377, 1.0], 'all_L1': [0.415, 0.376, 0.509, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.501, 0.22, 0.356, 1.0], 'all_L1': [0.467, 0.376, 0.535, 1.0], 0: [1.0], 1: [1.0], 2: [1.0], 3: [1.0], 4: [1.0], 5: [1.0], 6: [1.0], 7: [1.0], 8: [1.0], 9: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.433, 0.53, 0.62, 0.686], 'all_L1': [0.421, 0.522, 0.534, 0.575]}), defaultdict(<class 'list'>, {'all_KL': [0.444, 0.509, 0.615, 0.672], 'all_L1': [0.451, 0.502, 0.533, 0.571]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.508, 0.558, 0.599], 'all_L1': [0.491, 0.499, 0.449, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.611, 0.632, 0.547, 0.689], 'all_L1': [0.566, 0.549, 0.457, 0.578]}), defaultdict(<class 'list'>, {'all_KL': [0.55, 0.551, 0.492, 0.588], 'all_L1': [0.549, 0.501, 0.42, 0.486]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.535 +- 0.038, 0.406 +- 0.041, 0.316 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.507 +- 0.040, 0.347 +- 0.058, 0.182 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.118 +- 0.011, 0.124 +- 0.009, 0.192 +- 0.031
nec class all_L1  =  0.501 +- 0.043, 0.524 +- 0.039, 0.577 +- 0.025, 0.573 +- 0.018
nec class all_KL  =  0.549 +- 0.071, 0.544 +- 0.049, 0.652 +- 0.040, 0.652 +- 0.028
nec_acc_int  =  0.120 +- 0.008, 0.134 +- 0.011, 0.233 +- 0.041, 0.374 +- 0.056

Eval split id_test
suff++ class all_L1  =  0.542 +- 0.036, 0.412 +- 0.042, 0.311 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.516 +- 0.045, 0.357 +- 0.061, 0.181 +- 0.017, 1.000 +- 0.000
suff++_acc_int  =  0.116 +- 0.005, 0.117 +- 0.005, 0.187 +- 0.031
nec class all_L1  =  0.490 +- 0.044, 0.522 +- 0.041, 0.583 +- 0.029, 0.572 +- 0.014
nec class all_KL  =  0.533 +- 0.070, 0.539 +- 0.057, 0.654 +- 0.045, 0.655 +- 0.031
nec_acc_int  =  0.115 +- 0.005, 0.129 +- 0.010, 0.226 +- 0.039, 0.365 +- 0.052

Eval split test
suff++ class all_L1  =  0.487 +- 0.052, 0.374 +- 0.018, 0.449 +- 0.066, 1.000 +- 0.000
suff++ class all_KL  =  0.484 +- 0.063, 0.262 +- 0.030, 0.271 +- 0.079, 1.000 +- 0.000
suff++_acc_int  =  0.108 +- 0.011, 0.125 +- 0.014, 0.136 +- 0.015
nec class all_L1  =  0.496 +- 0.055, 0.515 +- 0.019, 0.479 +- 0.046, 0.538 +- 0.044
nec class all_KL  =  0.495 +- 0.073, 0.546 +- 0.046, 0.566 +- 0.047, 0.647 +- 0.044
nec_acc_int  =  0.101 +- 0.012, 0.139 +- 0.006, 0.149 +- 0.020, 0.165 +- 0.022


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.518 +- 0.013, 0.465 +- 0.021, 0.446 +- 0.008, 0.787 +- 0.009
Faith. Armon (L1)= 		  =  0.515 +- 0.016, 0.455 +- 0.026, 0.408 +- 0.006, 0.729 +- 0.015
Faith. GMean (L1)= 	  =  0.516 +- 0.014, 0.460 +- 0.023, 0.427 +- 0.005, 0.757 +- 0.012
Faith. Aritm (KL)= 		  =  0.528 +- 0.017, 0.445 +- 0.028, 0.417 +- 0.015, 0.826 +- 0.014
Faith. Armon (KL)= 		  =  0.522 +- 0.012, 0.418 +- 0.044, 0.284 +- 0.017, 0.789 +- 0.020
Faith. GMean (KL)= 	  =  0.525 +- 0.014, 0.431 +- 0.035, 0.344 +- 0.010, 0.808 +- 0.017

Eval split id_test
Faith. Aritm (L1)= 		  =  0.516 +- 0.013, 0.467 +- 0.021, 0.447 +- 0.011, 0.786 +- 0.007
Faith. Armon (L1)= 		  =  0.512 +- 0.016, 0.458 +- 0.025, 0.405 +- 0.009, 0.727 +- 0.011
Faith. GMean (L1)= 	  =  0.514 +- 0.015, 0.462 +- 0.023, 0.426 +- 0.008, 0.756 +- 0.009
Faith. Aritm (KL)= 		  =  0.525 +- 0.017, 0.448 +- 0.030, 0.418 +- 0.017, 0.827 +- 0.015
Faith. Armon (KL)= 		  =  0.519 +- 0.016, 0.423 +- 0.046, 0.283 +- 0.018, 0.791 +- 0.022
Faith. GMean (KL)= 	  =  0.522 +- 0.016, 0.436 +- 0.037, 0.344 +- 0.011, 0.809 +- 0.019

Eval split test
Faith. Aritm (L1)= 		  =  0.491 +- 0.011, 0.444 +- 0.011, 0.464 +- 0.014, 0.769 +- 0.022
Faith. Armon (L1)= 		  =  0.486 +- 0.011, 0.433 +- 0.012, 0.457 +- 0.017, 0.699 +- 0.038
Faith. GMean (L1)= 	  =  0.489 +- 0.011, 0.438 +- 0.011, 0.460 +- 0.015, 0.733 +- 0.031
Faith. Aritm (KL)= 		  =  0.489 +- 0.024, 0.404 +- 0.015, 0.419 +- 0.023, 0.823 +- 0.022
Faith. Armon (KL)= 		  =  0.481 +- 0.025, 0.352 +- 0.021, 0.356 +- 0.062, 0.785 +- 0.033
Faith. GMean (KL)= 	  =  0.485 +- 0.024, 0.377 +- 0.014, 0.385 +- 0.043, 0.804 +- 0.028
Computed for split load_split = id



Completed in  1:52:37.165650  for GSATvGIN GOODCMNIST/color



DONE GSAT GOODCMNIST/color Top0.8
DONE all :)
