I'm the stability of the DET :))
The PID of this script is: 4188600 running on GPU-0
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:51:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:51:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.659670
Plausibility completed in  0:00:32.484575
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6355, device='cuda:0')  +-  tensor(0.2839, device='cuda:0') (0.092)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6680, device='cuda:0')  +-  tensor(0.1689, device='cuda:0') (0.095)
Original Stability MCC for r=0.3 = 0.985 +- 0.058
Intervened Stability MCC for r=0.3 = 0.540 +- 0.393
Original Stability F1 for r=0.3 = 0.990 +- 0.039
Intervened Stability F1 for r=0.3 = 0.718 +- 0.230
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.128373
Plausibility completed in  0:00:29.961254
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6251, device='cuda:0')  +-  tensor(0.2997, device='cuda:0') (0.061)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8965, device='cuda:0')  +-  tensor(0.1115, device='cuda:0') (0.044)
Original Stability MCC for r=0.6 = 0.985 +- 0.066
Intervened Stability MCC for r=0.6 = 0.462 +- 0.409
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.845 +- 0.115
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:53:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:53:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:08.029036
Plausibility completed in  0:00:29.880626
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6596, device='cuda:0')  +-  tensor(0.3059, device='cuda:0') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6811, device='cuda:0')  +-  tensor(0.1691, device='cuda:0') (0.091)
Original Stability MCC for r=0.3 = 0.989 +- 0.043
Intervened Stability MCC for r=0.3 = 0.493 +- 0.416
Original Stability F1 for r=0.3 = 0.993 +- 0.030
Intervened Stability F1 for r=0.3 = 0.684 +- 0.252
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.165393
Plausibility completed in  0:00:29.057045
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6375, device='cuda:0')  +-  tensor(0.3023, device='cuda:0') (0.073)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8993, device='cuda:0')  +-  tensor(0.1200, device='cuda:0') (0.038)
Original Stability MCC for r=0.6 = 0.991 +- 0.040
Intervened Stability MCC for r=0.6 = 0.605 +- 0.429
Original Stability F1 for r=0.6 = 0.997 +- 0.015
Intervened Stability F1 for r=0.6 = 0.875 +- 0.136
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:55:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:55:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.307861
Plausibility completed in  0:00:26.557931
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6043, device='cuda:0')  +-  tensor(0.2824, device='cuda:0') (0.086)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6274, device='cuda:0')  +-  tensor(0.1579, device='cuda:0') (0.091)
Original Stability MCC for r=0.3 = 0.993 +- 0.035
Intervened Stability MCC for r=0.3 = 0.399 +- 0.423
Original Stability F1 for r=0.3 = 0.995 +- 0.024
Intervened Stability F1 for r=0.3 = 0.638 +- 0.240
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.311478
Plausibility completed in  0:00:26.413954
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5854, device='cuda:0')  +-  tensor(0.2858, device='cuda:0') (0.079)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8481, device='cuda:0')  +-  tensor(0.1242, device='cuda:0') (0.058)
Original Stability MCC for r=0.6 = 0.989 +- 0.053
Intervened Stability MCC for r=0.6 = 0.225 +- 0.379
Original Stability F1 for r=0.6 = 0.996 +- 0.019
Intervened Stability F1 for r=0.6 = 0.790 +- 0.112
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:56:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:56:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.243407
Plausibility completed in  0:00:26.699684
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6648, device='cuda:0')  +-  tensor(0.2587, device='cuda:0') (0.143)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6782, device='cuda:0')  +-  tensor(0.1656, device='cuda:0') (0.144)
Original Stability MCC for r=0.3 = 0.980 +- 0.078
Intervened Stability MCC for r=0.3 = 0.489 +- 0.379
Original Stability F1 for r=0.3 = 0.986 +- 0.052
Intervened Stability F1 for r=0.3 = 0.681 +- 0.228
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.020201
Plausibility completed in  0:00:26.061103
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:0')  +-  tensor(0.1946, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6797, device='cuda:0')  +-  tensor(0.2947, device='cuda:0') (0.098)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:0')  +-  tensor(0.1946, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8752, device='cuda:0')  +-  tensor(0.1666, device='cuda:0') (0.065)
Original Stability MCC for r=0.6 = 0.987 +- 0.051
Intervened Stability MCC for r=0.6 = 0.311 +- 0.437
Original Stability F1 for r=0.6 = 0.995 +- 0.019
Intervened Stability F1 for r=0.6 = 0.809 +- 0.122
Num considered samples: 2966
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:58:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:02 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:58:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.295258
Plausibility completed in  0:00:26.572594
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6456, device='cuda:0')  +-  tensor(0.2673, device='cuda:0') (0.110)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6818, device='cuda:0')  +-  tensor(0.1418, device='cuda:0') (0.117)
Original Stability MCC for r=0.3 = 0.986 +- 0.059
Intervened Stability MCC for r=0.3 = 0.546 +- 0.359
Original Stability F1 for r=0.3 = 0.990 +- 0.041
Intervened Stability F1 for r=0.3 = 0.719 +- 0.210
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.094658
Plausibility completed in  0:00:26.517761
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6338, device='cuda:0')  +-  tensor(0.2780, device='cuda:0') (0.093)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8702, device='cuda:0')  +-  tensor(0.1079, device='cuda:0') (0.069)
Original Stability MCC for r=0.6 = 0.985 +- 0.062
Intervened Stability MCC for r=0.6 = 0.359 +- 0.403
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.814 +- 0.116
Num considered samples: 3000

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76367326 0.76345528] +- [0.07432533 0.07391123] (mean across ratios: 0.76 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.64197813 0.63228687] +- [0.02149831 0.03010412] (mean across ratios: 0.64 +- 0.02)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81151148 0.98362483] +- [0.05535978 0.00662554] (mean across ratios: 0.90 +- 0.03)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.66728393 0.87786299] +- [0.02057323 0.01874079] (mean across ratios: 0.77 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99085419 0.99533089] +- [0.00284857 0.00081608] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.68821458 0.82672588] +- [0.02958592 0.03001719] (mean across ratios: 0.76 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98657508 0.98728988] +- [0.00424718 0.00231902] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.49373311 0.39234366] +- [0.05263207 0.13100245] (mean across ratios: 0.44 +- 0.07)

Overall time of execution:  0:07:48.027267
DONE LECI GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 14:59:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 02:59:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.269588
Plausibility completed in  0:00:30.032429
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6314, device='cuda:0')  +-  tensor(0.3085, device='cuda:0') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6549, device='cuda:0')  +-  tensor(0.1779, device='cuda:0') (0.078)
Original Stability MCC for r=0.3 = 0.985 +- 0.058
Intervened Stability MCC for r=0.3 = 0.436 +- 0.443
Original Stability F1 for r=0.3 = 0.990 +- 0.039
Intervened Stability F1 for r=0.3 = 0.679 +- 0.240
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.234919
Plausibility completed in  0:00:29.767692
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5802, device='cuda:0')  +-  tensor(0.3186, device='cuda:0') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9002, device='cuda:0')  +-  tensor(0.1109, device='cuda:0') (0.029)
Original Stability MCC for r=0.6 = 0.985 +- 0.067
Intervened Stability MCC for r=0.6 = 0.321 +- 0.406
Original Stability F1 for r=0.6 = 0.995 +- 0.023
Intervened Stability F1 for r=0.6 = 0.890 +- 0.117
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:01:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:01:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.670859
Plausibility completed in  0:00:31.409870
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6182, device='cuda:0')  +-  tensor(0.3177, device='cuda:0') (0.070)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6304, device='cuda:0')  +-  tensor(0.1659, device='cuda:0') (0.084)
Original Stability MCC for r=0.3 = 0.989 +- 0.044
Intervened Stability MCC for r=0.3 = 0.365 +- 0.464
Original Stability F1 for r=0.3 = 0.993 +- 0.030
Intervened Stability F1 for r=0.3 = 0.633 +- 0.265
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.273079
Plausibility completed in  0:00:30.790806
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5915, device='cuda:0')  +-  tensor(0.3192, device='cuda:0') (0.056)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8993, device='cuda:0')  +-  tensor(0.1123, device='cuda:0') (0.037)
Original Stability MCC for r=0.6 = 0.990 +- 0.041
Intervened Stability MCC for r=0.6 = 0.375 +- 0.448
Original Stability F1 for r=0.6 = 0.996 +- 0.016
Intervened Stability F1 for r=0.6 = 0.888 +- 0.122
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:03:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:03:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:08.100018
Plausibility completed in  0:00:30.372423
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6141, device='cuda:0')  +-  tensor(0.3118, device='cuda:0') (0.066)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6114, device='cuda:0')  +-  tensor(0.1848, device='cuda:0') (0.069)
Original Stability MCC for r=0.3 = 0.992 +- 0.036
Intervened Stability MCC for r=0.3 = 0.304 +- 0.445
Original Stability F1 for r=0.3 = 0.995 +- 0.025
Intervened Stability F1 for r=0.3 = 0.602 +- 0.248
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.281946
Plausibility completed in  0:00:30.635060
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6081, device='cuda:0')  +-  tensor(0.3215, device='cuda:0') (0.050)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8715, device='cuda:0')  +-  tensor(0.1223, device='cuda:0') (0.040)
Original Stability MCC for r=0.6 = 0.988 +- 0.056
Intervened Stability MCC for r=0.6 = 0.112 +- 0.292
Original Stability F1 for r=0.6 = 0.996 +- 0.020
Intervened Stability F1 for r=0.6 = 0.845 +- 0.114
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:04:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:04:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.127615
Plausibility completed in  0:00:29.540726
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6123, device='cuda:0')  +-  tensor(0.3059, device='cuda:0') (0.114)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6177, device='cuda:0')  +-  tensor(0.1716, device='cuda:0') (0.115)
Original Stability MCC for r=0.3 = 0.980 +- 0.074
Intervened Stability MCC for r=0.3 = 0.389 +- 0.427
Original Stability F1 for r=0.3 = 0.987 +- 0.050
Intervened Stability F1 for r=0.3 = 0.641 +- 0.245
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.778636
Plausibility completed in  0:00:29.008283
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:0')  +-  tensor(0.1946, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6293, device='cuda:0')  +-  tensor(0.3225, device='cuda:0') (0.083)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9038, device='cuda:0')  +-  tensor(0.1946, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8670, device='cuda:0')  +-  tensor(0.1731, device='cuda:0') (0.055)
Original Stability MCC for r=0.6 = 0.987 +- 0.054
Intervened Stability MCC for r=0.6 = 0.074 +- 0.316
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.846 +- 0.127
Num considered samples: 2966
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:06:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:06:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:09.797352
Plausibility completed in  0:00:29.136918
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6175, device='cuda:0')  +-  tensor(0.2895, device='cuda:0') (0.099)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6338, device='cuda:0')  +-  tensor(0.1514, device='cuda:0') (0.098)
Original Stability MCC for r=0.3 = 0.985 +- 0.063
Intervened Stability MCC for r=0.3 = 0.416 +- 0.434
Original Stability F1 for r=0.3 = 0.990 +- 0.043
Intervened Stability F1 for r=0.3 = 0.671 +- 0.220
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.808875
Plausibility completed in  0:00:29.264998
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6109, device='cuda:0')  +-  tensor(0.3040, device='cuda:0') (0.064)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8775, device='cuda:0')  +-  tensor(0.1199, device='cuda:0') (0.048)
Original Stability MCC for r=0.6 = 0.985 +- 0.062
Intervened Stability MCC for r=0.6 = 0.123 +- 0.297
Original Stability F1 for r=0.6 = 0.995 +- 0.023
Intervened Stability F1 for r=0.6 = 0.847 +- 0.115
Num considered samples: 3000

\FINISHED GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.7636732  0.76345522] +- [0.07432535 0.07391126] (mean across ratios: 0.76 +- 0.05)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.61871994 0.6039852 ] +- [0.0066953  0.01690649] (mean across ratios: 0.61 +- 0.01)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.81151148 0.98362483] +- [0.05535978 0.00662554] (mean across ratios: 0.90 +- 0.03)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62963967 0.88310348] +- [0.01505422 0.01400415] (mean across ratios: 0.76 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99085273 0.99519488] +- [0.00274816 0.00060001] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.64516438 0.86307576] +- [0.02784163 0.02118033] (mean across ratios: 0.75 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98659699 0.98690064] +- [0.0040536  0.00179681] (mean across ratios: 0.99 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.38194683 0.20118846] +- [0.04566809 0.12249107] (mean across ratios: 0.29 +- 0.07)

Overall time of execution:  0:08:23.770207
DONE LECI GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:08:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:08:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.798653
Plausibility completed in  0:00:30.864656
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3766, device='cuda:0')  +-  tensor(0.2189, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3863, device='cuda:0')  +-  tensor(0.0664, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.034
Intervened Stability MCC for r=0.3 = 0.032 +- 0.233
Original Stability F1 for r=0.3 = 0.998 +- 0.022
Intervened Stability F1 for r=0.3 = 0.362 +- 0.155
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.161787
Plausibility completed in  0:00:26.215120
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3759, device='cuda:0')  +-  tensor(0.2173, device='cuda:0') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7148, device='cuda:0')  +-  tensor(0.0709, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.029
Intervened Stability MCC for r=0.6 = 0.133 +- 0.328
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.733 +- 0.118
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:09:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:09:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.341015
Plausibility completed in  0:00:26.460657
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3727, device='cuda:0')  +-  tensor(0.2157, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3783, device='cuda:0')  +-  tensor(0.0587, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.042
Intervened Stability MCC for r=0.3 = 0.028 +- 0.246
Original Stability F1 for r=0.3 = 0.997 +- 0.027
Intervened Stability F1 for r=0.3 = 0.355 +- 0.160
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.147415
Plausibility completed in  0:00:26.322708
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3714, device='cuda:0')  +-  tensor(0.2141, device='cuda:0') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7138, device='cuda:0')  +-  tensor(0.0697, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.028
Intervened Stability MCC for r=0.6 = 0.127 +- 0.305
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.734 +- 0.105
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:11:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:11:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.134189
Plausibility completed in  0:00:26.462126
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3705, device='cuda:0')  +-  tensor(0.2160, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3796, device='cuda:0')  +-  tensor(0.0615, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.030
Intervened Stability MCC for r=0.3 = 0.031 +- 0.252
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.355 +- 0.166
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.349182
Plausibility completed in  0:00:26.158459
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3695, device='cuda:0')  +-  tensor(0.2148, device='cuda:0') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7110, device='cuda:0')  +-  tensor(0.0691, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.121 +- 0.321
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.727 +- 0.117
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:12:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:12:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.288805
Plausibility completed in  0:00:26.487961
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3703, device='cuda:0')  +-  tensor(0.2142, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3783, device='cuda:0')  +-  tensor(0.0590, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.032
Intervened Stability MCC for r=0.3 = 0.027 +- 0.230
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.356 +- 0.156
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.229013
Plausibility completed in  0:00:30.248998
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3701, device='cuda:0')  +-  tensor(0.2139, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7155, device='cuda:0')  +-  tensor(0.0717, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.027
Intervened Stability MCC for r=0.6 = 0.082 +- 0.304
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.725 +- 0.114
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:14:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:14:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.841773
Plausibility completed in  0:00:28.989746
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3736, device='cuda:0')  +-  tensor(0.2166, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3783, device='cuda:0')  +-  tensor(0.0591, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.993 +- 0.053
Intervened Stability MCC for r=0.3 = 0.033 +- 0.251
Original Stability F1 for r=0.3 = 0.995 +- 0.035
Intervened Stability F1 for r=0.3 = 0.357 +- 0.163
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.491009
Plausibility completed in  0:00:29.073315
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3724, device='cuda:0')  +-  tensor(0.2151, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7118, device='cuda:0')  +-  tensor(0.0672, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.166 +- 0.319
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.740 +- 0.114
Num considered samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386574 0.32386567] +- [0.00206968 0.00206975] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.37273142 0.37187652] +- [0.00231377 0.0022632 ] (mean across ratios: 0.37 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38016931 0.71337115] +- [0.00309275 0.00171637] (mean across ratios: 0.55 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99707961 0.99884169] +- [0.00095926 0.0002689 ] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.35687019 0.7318027 ] +- [0.00247844 0.00534723] (mean across ratios: 0.54 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99562191 0.99688663] +- [0.00144209 0.00073167] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.03019463 0.12582584] +- [0.00238801 0.02675785] (mean across ratios: 0.08 +- 0.01)

Overall time of execution:  0:07:32.654890
DONE GSAT GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:16:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:16:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.787143
Plausibility completed in  0:00:27.998035
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4338, device='cuda:0')  +-  tensor(0.2689, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4410, device='cuda:0')  +-  tensor(0.1003, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 0.995 +- 0.042
Intervened Stability MCC for r=0.3 = 0.094 +- 0.266
Original Stability F1 for r=0.3 = 0.997 +- 0.027
Intervened Stability F1 for r=0.3 = 0.465 +- 0.192
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.712717
Plausibility completed in  0:00:27.948830
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4248, device='cuda:0')  +-  tensor(0.2571, device='cuda:0') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8028, device='cuda:0')  +-  tensor(0.1152, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.025
Intervened Stability MCC for r=0.6 = -0.010 +- 0.178
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.799 +- 0.131
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:17:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:17:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:08.334139
Plausibility completed in  0:00:28.626715
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4300, device='cuda:0')  +-  tensor(0.2666, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4315, device='cuda:0')  +-  tensor(0.0895, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.029
Intervened Stability MCC for r=0.3 = 0.075 +- 0.239
Original Stability F1 for r=0.3 = 0.998 +- 0.019
Intervened Stability F1 for r=0.3 = 0.456 +- 0.169
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.953713
Plausibility completed in  0:00:30.629624
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4128, device='cuda:0')  +-  tensor(0.2453, device='cuda:0') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7896, device='cuda:0')  +-  tensor(0.1006, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.029
Intervened Stability MCC for r=0.6 = 0.018 +- 0.225
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.789 +- 0.119
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:19:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:19:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:09.292297
Plausibility completed in  0:00:29.816846
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4276, device='cuda:0')  +-  tensor(0.2664, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4327, device='cuda:0')  +-  tensor(0.0921, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.026
Intervened Stability MCC for r=0.3 = 0.056 +- 0.248
Original Stability F1 for r=0.3 = 0.998 +- 0.018
Intervened Stability F1 for r=0.3 = 0.446 +- 0.168
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.031620
Plausibility completed in  0:00:29.462752
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4175, device='cuda:0')  +-  tensor(0.2546, device='cuda:0') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7949, device='cuda:0')  +-  tensor(0.1056, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.024
Intervened Stability MCC for r=0.6 = 0.004 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.795 +- 0.132
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:21:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:21:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.015982
Plausibility completed in  0:00:28.936279
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4263, device='cuda:0')  +-  tensor(0.2646, device='cuda:0') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4311, device='cuda:0')  +-  tensor(0.0893, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.030
Intervened Stability MCC for r=0.3 = 0.048 +- 0.230
Original Stability F1 for r=0.3 = 0.998 +- 0.020
Intervened Stability F1 for r=0.3 = 0.446 +- 0.157
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.548969
Plausibility completed in  0:00:28.572859
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4168, device='cuda:0')  +-  tensor(0.2525, device='cuda:0') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8022, device='cuda:0')  +-  tensor(0.1150, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.023
Intervened Stability MCC for r=0.6 = -0.005 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.794 +- 0.137
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:22:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 03:22:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.649343
Plausibility completed in  0:00:26.094484
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4305, device='cuda:0')  +-  tensor(0.2668, device='cuda:0') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4311, device='cuda:0')  +-  tensor(0.0892, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.045
Intervened Stability MCC for r=0.3 = 0.081 +- 0.243
Original Stability F1 for r=0.3 = 0.996 +- 0.030
Intervened Stability F1 for r=0.3 = 0.459 +- 0.168
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.901661
Plausibility completed in  0:00:26.099872
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4229, device='cuda:0')  +-  tensor(0.2567, device='cuda:0') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8018, device='cuda:0')  +-  tensor(0.1134, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.024
Intervened Stability MCC for r=0.6 = 0.012 +- 0.204
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.799 +- 0.130
Num considered samples: 3000

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32386587 0.32386574] +- [0.00206954 0.00206968] (mean across ratios: 0.32 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42964913 0.41894864] +- [0.0025753  0.00436164] (mean across ratios: 0.42 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33397881 0.63404307] +- [0.0018042  0.00155564] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43348467 0.79824406] +- [0.00378479 0.00520654] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99743159 0.99886763] +- [0.00071688 0.00019382] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.45450359 0.79515858] +- [0.0073213  0.00354178] (mean across ratios: 0.62 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99616164 0.99694147] +- [0.00109636 0.00050153] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.07081858 0.00383594] +- [0.01678277 0.01050571] (mean across ratios: 0.04 +- 0.01)

Overall time of execution:  0:08:02.164520
DONE GSAT GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:24:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:24:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.129175
Plausibility completed in  0:00:25.984370
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2865, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5067, device='cuda:0')  +-  tensor(0.2754, device='cuda:0') (0.089)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2865, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5349, device='cuda:0')  +-  tensor(0.1108, device='cuda:0') (0.102)
Original Stability MCC for r=0.3 = 0.894 +- 0.196
Intervened Stability MCC for r=0.3 = 0.376 +- 0.414
Original Stability F1 for r=0.3 = 0.931 +- 0.123
Intervened Stability F1 for r=0.3 = 0.616 +- 0.247
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.815633
Plausibility completed in  0:00:25.470678
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2892, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4737, device='cuda:0')  +-  tensor(0.2578, device='cuda:0') (0.067)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2892, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8630, device='cuda:0')  +-  tensor(0.1613, device='cuda:0') (0.043)
Original Stability MCC for r=0.6 = 0.967 +- 0.078
Intervened Stability MCC for r=0.6 = 0.532 +- 0.387
Original Stability F1 for r=0.6 = 0.988 +- 0.029
Intervened Stability F1 for r=0.6 = 0.863 +- 0.110
Num considered samples: 2944
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:25:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:25:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.089304
Plausibility completed in  0:00:26.264275
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5077, device='cuda:0')  +-  tensor(0.2761, device='cuda:0') (0.060)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6521, device='cuda:0')  +-  tensor(0.1342, device='cuda:0') (0.073)
Original Stability MCC for r=0.3 = 0.975 +- 0.073
Intervened Stability MCC for r=0.3 = 0.621 +- 0.319
Original Stability F1 for r=0.3 = 0.983 +- 0.050
Intervened Stability F1 for r=0.3 = 0.766 +- 0.182
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:05.884222
Plausibility completed in  0:00:26.212083
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5009, device='cuda:0')  +-  tensor(0.2696, device='cuda:0') (0.034)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9340, device='cuda:0')  +-  tensor(0.0863, device='cuda:0') (0.028)
Original Stability MCC for r=0.6 = 0.972 +- 0.102
Intervened Stability MCC for r=0.6 = 0.588 +- 0.370
Original Stability F1 for r=0.6 = 0.990 +- 0.035
Intervened Stability F1 for r=0.6 = 0.891 +- 0.098
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:27:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:27:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.152074
Plausibility completed in  0:00:27.615675
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5960, device='cuda:0')  +-  tensor(0.2722, device='cuda:0') (0.117)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6932, device='cuda:0')  +-  tensor(0.1375, device='cuda:0') (0.123)
Original Stability MCC for r=0.3 = 0.946 +- 0.153
Intervened Stability MCC for r=0.3 = 0.524 +- 0.397
Original Stability F1 for r=0.3 = 0.965 +- 0.098
Intervened Stability F1 for r=0.3 = 0.711 +- 0.224
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.171370
Plausibility completed in  0:00:29.600932
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5707, device='cuda:0')  +-  tensor(0.2720, device='cuda:0') (0.091)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9097, device='cuda:0')  +-  tensor(0.0990, device='cuda:0') (0.052)
Original Stability MCC for r=0.6 = 0.986 +- 0.055
Intervened Stability MCC for r=0.6 = 0.546 +- 0.362
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.871 +- 0.100
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:28:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:28:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.917049
Plausibility completed in  0:00:29.266184
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5089, device='cuda:0')  +-  tensor(0.2959, device='cuda:0') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5756, device='cuda:0')  +-  tensor(0.1305, device='cuda:0') (0.069)
Original Stability MCC for r=0.3 = 0.965 +- 0.097
Intervened Stability MCC for r=0.3 = 0.539 +- 0.374
Original Stability F1 for r=0.3 = 0.977 +- 0.063
Intervened Stability F1 for r=0.3 = 0.716 +- 0.214
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.654130
Plausibility completed in  0:00:28.174168
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4991, device='cuda:0')  +-  tensor(0.2878, device='cuda:0') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9109, device='cuda:0')  +-  tensor(0.0919, device='cuda:0') (0.039)
Original Stability MCC for r=0.6 = 0.974 +- 0.081
Intervened Stability MCC for r=0.6 = 0.596 +- 0.368
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.886 +- 0.099
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:30:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:30:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.476


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:08.509523
Plausibility completed in  0:00:31.827749
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:0')  +-  tensor(0.2612, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3316, device='cuda:0')  +-  tensor(0.1657, device='cuda:0') (0.091)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:0')  +-  tensor(0.2612, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5520, device='cuda:0')  +-  tensor(0.1408, device='cuda:0') (0.093)
Original Stability MCC for r=0.3 = 0.940 +- 0.140
Intervened Stability MCC for r=0.3 = 0.445 +- 0.391
Original Stability F1 for r=0.3 = 0.959 +- 0.094
Intervened Stability F1 for r=0.3 = 0.656 +- 0.226
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.519021
Plausibility completed in  0:00:27.153295
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:0')  +-  tensor(0.2636, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3098, device='cuda:0')  +-  tensor(0.1801, device='cuda:0') (0.068)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:0')  +-  tensor(0.2636, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8665, device='cuda:0')  +-  tensor(0.1590, device='cuda:0') (0.049)
Original Stability MCC for r=0.6 = 0.980 +- 0.064
Intervened Stability MCC for r=0.6 = 0.510 +- 0.427
Original Stability F1 for r=0.6 = 0.992 +- 0.024
Intervened Stability F1 for r=0.6 = 0.860 +- 0.114
Num considered samples: 2944

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56387447 0.56376567] +- [0.09189798 0.09200944] (mean across ratios: 0.56 +- 0.07)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.49018679 0.47081727] +- [0.08635107 0.08672565] (mean across ratios: 0.48 +- 0.06)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.67785172 0.96908491] +- [0.09343448 0.01478114] (mean across ratios: 0.82 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60152249 0.89680125] +- [0.06087495 0.02761379] (mean across ratios: 0.75 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96307091 0.99104034] +- [0.01793469 0.0024112 ] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69289788 0.8744794 ] +- [0.05189284 0.01215918] (mean across ratios: 0.78 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.94405996 0.97554502] +- [0.02788589 0.00662173] (mean across ratios: 0.96 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.50085074 0.55440664] +- [0.08383646 0.03296693] (mean across ratios: 0.53 +- 0.05)

Overall time of execution:  0:07:29.273413
DONE CIGA GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:32:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:32:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.889103
Plausibility completed in  0:00:30.572832
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2865, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5314, device='cuda:0')  +-  tensor(0.3270, device='cuda:0') (0.066)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2865, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5175, device='cuda:0')  +-  tensor(0.1207, device='cuda:0') (0.073)
Original Stability MCC for r=0.3 = 0.894 +- 0.196
Intervened Stability MCC for r=0.3 = 0.175 +- 0.443
Original Stability F1 for r=0.3 = 0.931 +- 0.122
Intervened Stability F1 for r=0.3 = 0.532 +- 0.252
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.717974
Plausibility completed in  0:00:30.745342
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2892, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4910, device='cuda:0')  +-  tensor(0.2975, device='cuda:0') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2892, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8685, device='cuda:0')  +-  tensor(0.1583, device='cuda:0') (0.038)
Original Stability MCC for r=0.6 = 0.964 +- 0.083
Intervened Stability MCC for r=0.6 = 0.223 +- 0.350
Original Stability F1 for r=0.6 = 0.987 +- 0.030
Intervened Stability F1 for r=0.6 = 0.862 +- 0.099
Num considered samples: 2944
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:33:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:33:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.452298
Plausibility completed in  0:00:28.349701
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5289, device='cuda:0')  +-  tensor(0.3037, device='cuda:0') (0.054)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6389, device='cuda:0')  +-  tensor(0.1608, device='cuda:0') (0.064)
Original Stability MCC for r=0.3 = 0.976 +- 0.072
Intervened Stability MCC for r=0.3 = 0.454 +- 0.406
Original Stability F1 for r=0.3 = 0.984 +- 0.049
Intervened Stability F1 for r=0.3 = 0.695 +- 0.196
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.692849
Plausibility completed in  0:00:29.759649
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4982, device='cuda:0')  +-  tensor(0.2781, device='cuda:0') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9133, device='cuda:0')  +-  tensor(0.1038, device='cuda:0') (0.027)
Original Stability MCC for r=0.6 = 0.974 +- 0.094
Intervened Stability MCC for r=0.6 = 0.321 +- 0.436
Original Stability F1 for r=0.6 = 0.991 +- 0.032
Intervened Stability F1 for r=0.6 = 0.889 +- 0.108
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:35:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:35:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:07.186762
Plausibility completed in  0:00:33.167389
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5834, device='cuda:0')  +-  tensor(0.3183, device='cuda:0') (0.089)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6423, device='cuda:0')  +-  tensor(0.1542, device='cuda:0') (0.098)
Original Stability MCC for r=0.3 = 0.945 +- 0.154
Intervened Stability MCC for r=0.3 = 0.342 +- 0.459
Original Stability F1 for r=0.3 = 0.964 +- 0.098
Intervened Stability F1 for r=0.3 = 0.630 +- 0.243
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:07.940372
Plausibility completed in  0:00:31.609324
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5434, device='cuda:0')  +-  tensor(0.3147, device='cuda:0') (0.053)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8944, device='cuda:0')  +-  tensor(0.1099, device='cuda:0') (0.042)
Original Stability MCC for r=0.6 = 0.985 +- 0.057
Intervened Stability MCC for r=0.6 = 0.291 +- 0.400
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.871 +- 0.107
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:37:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:37:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.231024
Plausibility completed in  0:00:26.763267
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5464, device='cuda:0')  +-  tensor(0.3278, device='cuda:0') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5759, device='cuda:0')  +-  tensor(0.1523, device='cuda:0') (0.060)
Original Stability MCC for r=0.3 = 0.965 +- 0.097
Intervened Stability MCC for r=0.3 = 0.337 +- 0.448
Original Stability F1 for r=0.3 = 0.977 +- 0.062
Intervened Stability F1 for r=0.3 = 0.630 +- 0.220
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.093773
Plausibility completed in  0:00:26.402350
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5298, device='cuda:0')  +-  tensor(0.3241, device='cuda:0') (0.038)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9061, device='cuda:0')  +-  tensor(0.1031, device='cuda:0') (0.032)
Original Stability MCC for r=0.6 = 0.973 +- 0.086
Intervened Stability MCC for r=0.6 = 0.304 +- 0.422
Original Stability F1 for r=0.6 = 0.990 +- 0.031
Intervened Stability F1 for r=0.6 = 0.884 +- 0.104
Num considered samples: 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:38:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 03:38:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:06.199324
Plausibility completed in  0:00:26.734385
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:0')  +-  tensor(0.2612, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3238, device='cuda:0')  +-  tensor(0.2088, device='cuda:0') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:0')  +-  tensor(0.2612, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5482, device='cuda:0')  +-  tensor(0.1556, device='cuda:0') (0.072)
Original Stability MCC for r=0.3 = 0.942 +- 0.139
Intervened Stability MCC for r=0.3 = 0.290 +- 0.394
Original Stability F1 for r=0.3 = 0.961 +- 0.094
Intervened Stability F1 for r=0.3 = 0.597 +- 0.205
Num considered samples: 3000


ratio=0.6


Interventions completed in  0:00:06.159121
Plausibility completed in  0:00:26.059287
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:0')  +-  tensor(0.2636, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2844, device='cuda:0')  +-  tensor(0.2044, device='cuda:0') (0.048)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4706, device='cuda:0')  +-  tensor(0.2636, device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8634, device='cuda:0')  +-  tensor(0.1609, device='cuda:0') (0.034)
Original Stability MCC for r=0.6 = 0.980 +- 0.061
Intervened Stability MCC for r=0.6 = 0.298 +- 0.456
Original Stability F1 for r=0.6 = 0.992 +- 0.023
Intervened Stability F1 for r=0.6 = 0.861 +- 0.106
Num considered samples: 2944

\FINISHED GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56387447 0.56376567] +- [0.09189798 0.09200944] (mean across ratios: 0.56 +- 0.07)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50278949 0.4693392 ] +- [0.09157744 0.09450494] (mean across ratios: 0.49 +- 0.07)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.67785172 0.96908485] +- [0.09343448 0.01478117] (mean across ratios: 0.82 +- 0.05)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.58455814 0.88916247] +- [0.04933737 0.01992644] (mean across ratios: 0.74 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96331229 0.99086933] +- [0.01807521 0.00259146] (mean across ratios: 0.98 +- 0.01)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.61664515 0.87319492] +- [0.05310153 0.01158065] (mean across ratios: 0.74 +- 0.03)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.94440262 0.97517952] +- [0.02816923 0.00705178] (mean across ratios: 0.96 +- 0.01)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.31950866 0.28753853] +- [0.09020204 0.03390847] (mean across ratios: 0.30 +- 0.05)

Overall time of execution:  0:07:47.482296
DONE CIGA GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:40:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:40:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0132
ID Validation ACCURACY: 0.8966
ID Validation Loss: 0.3887
ID Test ACCURACY: 0.8907
ID Test Loss: 0.4205
OOD Validation ACCURACY: 0.8411
OOD Validation Loss: 0.6435
OOD Test ACCURACY: 0.6240
OOD Test Loss: 1.7705

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9873
Train Loss: 0.0485
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3611
ID Test ACCURACY: 0.8913
ID Test Loss: 0.3604
OOD Validation ACCURACY: 0.8866
OOD Validation Loss: 0.3823
OOD Test ACCURACY: 0.7620
OOD Test Loss: 0.8839

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.6240 0.8913 0.7620 0.8889 0.8866[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.546701
Plausibility completed in  0:02:12.741953
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:0')  +-  tensor(0.0082, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.439774
Plausibility completed in  0:01:56.204881
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:0')  +-  tensor(0.0099, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 15:59:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 03:59:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0228
ID Validation ACCURACY: 0.8981
ID Validation Loss: 0.3829
ID Test ACCURACY: 0.8943
ID Test Loss: 0.3885
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.5298
OOD Test ACCURACY: 0.4854
OOD Test Loss: 2.6066

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9603
Train Loss: 0.1231
ID Validation ACCURACY: 0.8851
ID Validation Loss: 0.3467
ID Test ACCURACY: 0.8873
ID Test Loss: 0.3649
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.4010
OOD Test ACCURACY: 0.6567
OOD Test Loss: 1.3853

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4854 0.8873 0.6567 0.8851 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.447034
Plausibility completed in  0:02:21.294940
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5527, device='cuda:0')  +-  tensor(0.0115, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.796 +- 0.114
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.907 +- 0.052
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.655067
Plausibility completed in  0:01:55.913087
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8787, device='cuda:0')  +-  tensor(0.0323, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.467 +- 0.269
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.926 +- 0.042
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:15:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:15:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 152...
[0m[1;37mINFO[0m: [1mCheckpoint 152: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0190
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.3837
ID Test ACCURACY: 0.8937
ID Test Loss: 0.3798
OOD Validation ACCURACY: 0.8484
OOD Validation Loss: 0.5888
OOD Test ACCURACY: 0.4769
OOD Test Loss: 2.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9775
Train Loss: 0.0765
ID Validation ACCURACY: 0.8880
ID Validation Loss: 0.3645
ID Test ACCURACY: 0.8894
ID Test Loss: 0.3649
OOD Validation ACCURACY: 0.8856
OOD Validation Loss: 0.3894
OOD Test ACCURACY: 0.7121
OOD Test Loss: 1.1932

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4769 0.8894 0.7121 0.8880 0.8856[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:19.531327
Plausibility completed in  0:02:15.411008
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4427, device='cuda:0')  +-  tensor(0.1034, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.641 +- 0.381
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.796 +- 0.213
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.864902
Plausibility completed in  0:01:56.323365
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7740, device='cuda:0')  +-  tensor(0.1152, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.517 +- 0.309
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.880 +- 0.082
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:30:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:30:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9960
Train Loss: 0.0210
ID Validation ACCURACY: 0.8937
ID Validation Loss: 0.3933
ID Test ACCURACY: 0.8893
ID Test Loss: 0.3974
OOD Validation ACCURACY: 0.8071
OOD Validation Loss: 0.8507
OOD Test ACCURACY: 0.2887
OOD Test Loss: 6.3824

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.2050
ID Validation ACCURACY: 0.8727
ID Validation Loss: 0.3914
ID Test ACCURACY: 0.8746
ID Test Loss: 0.3866
OOD Validation ACCURACY: 0.8749
OOD Validation Loss: 0.3989
OOD Test ACCURACY: 0.7819
OOD Test Loss: 0.7293

[0m[1;37mINFO[0m: [1mChartInfo 0.8893 0.2887 0.8746 0.7819 0.8727 0.8749[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.292336
Plausibility completed in  0:02:18.497768
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5660, device='cuda:0')  +-  tensor(0.0082, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.715115
Plausibility completed in  0:01:55.384591
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9318, device='cuda:0')  +-  tensor(0.0099, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.992 +- 0.012
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.999 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 16:45:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 04:45:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.9969
Train Loss: 0.0182
ID Validation ACCURACY: 0.8953
ID Validation Loss: 0.3890
ID Test ACCURACY: 0.8900
ID Test Loss: 0.3942
OOD Validation ACCURACY: 0.8010
OOD Validation Loss: 0.8657
OOD Test ACCURACY: 0.4243
OOD Test Loss: 3.9165

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 80...
[0m[1;37mINFO[0m: [1mCheckpoint 80: 
-----------------------------------
Train ACCURACY: 0.9430
Train Loss: 0.1711
ID Validation ACCURACY: 0.8791
ID Validation Loss: 0.3738
ID Test ACCURACY: 0.8861
ID Test Loss: 0.3631
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.8004
OOD Test Loss: 0.6347

[0m[1;37mINFO[0m: [1mChartInfo 0.8900 0.4243 0.8861 0.8004 0.8791 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.926152
Plausibility completed in  0:02:22.140686
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3454, device='cuda:0')  +-  tensor(0.0369, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.629 +- 0.196
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.756 +- 0.127
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.066799
Plausibility completed in  0:01:56.854716
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6771, device='cuda:0')  +-  tensor(0.0387, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.551 +- 0.236
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.853 +- 0.079
Num considered samples: 7000

\FINISHED GOODCMNIST - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30034529 0.6003966 ] +- [9.91051575e-07 4.76837158e-08] (mean across ratios: 0.45 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.49454904 0.83869885] +- [0.08778289 0.09924553] (mean across ratios: 0.67 +- 0.07)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999917 0.99999934] +- [6.46373830e-07 3.28637332e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.89157387 0.93165381] +- [0.10083497 0.06001069] (mean across ratios: 0.91 +- 0.06)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999936 0.9999994 ] +- [9.28302876e-07 8.39558452e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.81228976 0.70377133] +- [0.16258822 0.23660112] (mean across ratios: 0.76 +- 0.14)

Overall time of execution:  1:21:10.439495
DONE LECI GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:01:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:01:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9980
Train Loss: 0.0132
ID Validation ACCURACY: 0.8966
ID Validation Loss: 0.3887
ID Test ACCURACY: 0.8907
ID Test Loss: 0.4205
OOD Validation ACCURACY: 0.8411
OOD Validation Loss: 0.6435
OOD Test ACCURACY: 0.6240
OOD Test Loss: 1.7705

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.9873
Train Loss: 0.0485
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3611
ID Test ACCURACY: 0.8913
ID Test Loss: 0.3604
OOD Validation ACCURACY: 0.8866
OOD Validation Loss: 0.3823
OOD Test ACCURACY: 0.7620
OOD Test Loss: 0.8839

[0m[1;37mINFO[0m: [1mChartInfo 0.8907 0.6240 0.8913 0.7620 0.8889 0.8866[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:19.065626
Plausibility completed in  0:02:17.767771
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:0')  +-  tensor(0.0116, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.811294
Plausibility completed in  0:01:57.089995
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:0')  +-  tensor(0.0002, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:21:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:21:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0228
ID Validation ACCURACY: 0.8981
ID Validation Loss: 0.3829
ID Test ACCURACY: 0.8943
ID Test Loss: 0.3885
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.5298
OOD Test ACCURACY: 0.4854
OOD Test Loss: 2.6066

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9603
Train Loss: 0.1231
ID Validation ACCURACY: 0.8851
ID Validation Loss: 0.3467
ID Test ACCURACY: 0.8873
ID Test Loss: 0.3649
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.4010
OOD Test ACCURACY: 0.6567
OOD Test Loss: 1.3853

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4854 0.8873 0.6567 0.8851 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:22.396484
Plausibility completed in  0:02:19.703464
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6221, device='cuda:0')  +-  tensor(0.0148, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.766 +- 0.140
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.909 +- 0.056
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:19.315514
Plausibility completed in  0:02:03.599424
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9776, device='cuda:0')  +-  tensor(0.0227, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.133 +- 0.178
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.966 +- 0.032
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:36:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:36:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 152...
[0m[1;37mINFO[0m: [1mCheckpoint 152: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0190
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.3837
ID Test ACCURACY: 0.8937
ID Test Loss: 0.3798
OOD Validation ACCURACY: 0.8484
OOD Validation Loss: 0.5888
OOD Test ACCURACY: 0.4769
OOD Test Loss: 2.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 108...
[0m[1;37mINFO[0m: [1mCheckpoint 108: 
-----------------------------------
Train ACCURACY: 0.9775
Train Loss: 0.0765
ID Validation ACCURACY: 0.8880
ID Validation Loss: 0.3645
ID Test ACCURACY: 0.8894
ID Test Loss: 0.3649
OOD Validation ACCURACY: 0.8856
OOD Validation Loss: 0.3894
OOD Test ACCURACY: 0.7121
OOD Test Loss: 1.1932

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4769 0.8894 0.7121 0.8880 0.8856[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:20.117199
Plausibility completed in  0:02:18.558098
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4981, device='cuda:0')  +-  tensor(0.1158, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.500 +- 0.348
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.744 +- 0.174
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.323139
Plausibility completed in  0:02:09.806912
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8593, device='cuda:0')  +-  tensor(0.1138, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.043 +- 0.141
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.834 +- 0.073
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 17:52:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:23 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 05:52:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9960
Train Loss: 0.0210
ID Validation ACCURACY: 0.8937
ID Validation Loss: 0.3933
ID Test ACCURACY: 0.8893
ID Test Loss: 0.3974
OOD Validation ACCURACY: 0.8071
OOD Validation Loss: 0.8507
OOD Test ACCURACY: 0.2887
OOD Test Loss: 6.3824

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.2050
ID Validation ACCURACY: 0.8727
ID Validation Loss: 0.3914
ID Test ACCURACY: 0.8746
ID Test Loss: 0.3866
OOD Validation ACCURACY: 0.8749
OOD Validation Loss: 0.3989
OOD Test ACCURACY: 0.7819
OOD Test Loss: 0.7293

[0m[1;37mINFO[0m: [1mChartInfo 0.8893 0.2887 0.8746 0.7819 0.8727 0.8749[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:21.725663
Plausibility completed in  0:02:17.790099
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6370, device='cuda:0')  +-  tensor(0.0116, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.998 +- 0.002
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.999 +- 0.001
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:20.294325
Plausibility completed in  0:02:04.684074
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:0')  +-  tensor(0.0002, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.001 +- 0.028
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 1.000 +- 0.001
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:07:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:07:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.9969
Train Loss: 0.0182
ID Validation ACCURACY: 0.8953
ID Validation Loss: 0.3890
ID Test ACCURACY: 0.8900
ID Test Loss: 0.3942
OOD Validation ACCURACY: 0.8010
OOD Validation Loss: 0.8657
OOD Test ACCURACY: 0.4243
OOD Test Loss: 3.9165

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 80...
[0m[1;37mINFO[0m: [1mCheckpoint 80: 
-----------------------------------
Train ACCURACY: 0.9430
Train Loss: 0.1711
ID Validation ACCURACY: 0.8791
ID Validation Loss: 0.3738
ID Test ACCURACY: 0.8861
ID Test Loss: 0.3631
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.8004
OOD Test Loss: 0.6347

[0m[1;37mINFO[0m: [1mChartInfo 0.8900 0.4243 0.8861 0.8004 0.8791 0.8796[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:20.299914
Plausibility completed in  0:02:20.187340
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3888, device='cuda:0')  +-  tensor(0.0413, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.419 +- 0.231
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.642 +- 0.143
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:19.085902
Plausibility completed in  0:02:07.407960
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7615, device='cuda:0')  +-  tensor(0.0396, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.332 +- 0.262
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.838 +- 0.069
Num considered samples: 7000

\FINISHED GOODCMNIST - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30034524 0.6003966 ] +- [9.39487193e-07 4.76837158e-08] (mean across ratios: 0.45 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.5566119  0.91969044] +- [0.09879507 0.09476253] (mean across ratios: 0.74 +- 0.07)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999905 0.99999932] +- [1.07288361e-06 3.92848421e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.85874437 0.92749757] +- [0.14292832 0.07567067] (mean across ratios: 0.89 +- 0.08)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999925 0.99999927] +- [1.50203705e-06 9.90513710e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.73610963 0.10177368] +- [0.24264144 0.12472992] (mean across ratios: 0.42 +- 0.14)

Overall time of execution:  1:21:29.286617
DONE LECI GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:23:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:30 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:30 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:30 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:30 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 06:23:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9710
Train Loss: 0.0888
ID Validation ACCURACY: 0.8913
ID Validation Loss: 0.3578
ID Test ACCURACY: 0.8891
ID Test Loss: 0.3689
OOD Validation ACCURACY: 0.7710
OOD Validation Loss: 0.8283
OOD Test ACCURACY: 0.2787
OOD Test Loss: 5.7327

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9678
Train Loss: 0.0980
ID Validation ACCURACY: 0.8826
ID Validation Loss: 0.3955
ID Test ACCURACY: 0.8830
ID Test Loss: 0.3916
OOD Validation ACCURACY: 0.7823
OOD Validation Loss: 0.8443
OOD Test ACCURACY: 0.3099
OOD Test Loss: 7.0050

[0m[1;37mINFO[0m: [1mChartInfo 0.8891 0.2787 0.8830 0.3099 0.8826 0.7823[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:17.271724
Plausibility completed in  0:02:28.789075
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:0')  +-  tensor(0.0083, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.501 +- 0.184
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.667 +- 0.122
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.352794
Plausibility completed in  0:02:21.838810
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6860, device='cuda:0')  +-  tensor(0.0100, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.396 +- 0.193
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.798 +- 0.064
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:43:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 06:43:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.9697
Train Loss: 0.0910
ID Validation ACCURACY: 0.8901
ID Validation Loss: 0.3680
ID Test ACCURACY: 0.8897
ID Test Loss: 0.3824
OOD Validation ACCURACY: 0.7509
OOD Validation Loss: 1.0322
OOD Test ACCURACY: 0.2683
OOD Test Loss: 5.3981

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9635
Train Loss: 0.1083
ID Validation ACCURACY: 0.8834
ID Validation Loss: 0.3827
ID Test ACCURACY: 0.8824
ID Test Loss: 0.3845
OOD Validation ACCURACY: 0.7814
OOD Validation Loss: 0.9042
OOD Test ACCURACY: 0.3949
OOD Test Loss: 2.9563

[0m[1;37mINFO[0m: [1mChartInfo 0.8897 0.2683 0.8824 0.3949 0.8834 0.7814[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.612985
Plausibility completed in  0:02:26.962276
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3576, device='cuda:0')  +-  tensor(0.0082, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.525 +- 0.177
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.683 +- 0.118
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:19.643019
Plausibility completed in  0:02:17.207031
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6872, device='cuda:0')  +-  tensor(0.0100, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.397 +- 0.188
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.799 +- 0.063
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 18:59:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:28 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 06:59:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9624
Train Loss: 0.1081
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3704
ID Test ACCURACY: 0.8846
ID Test Loss: 0.3894
OOD Validation ACCURACY: 0.7016
OOD Validation Loss: 1.3742
OOD Test ACCURACY: 0.3063
OOD Test Loss: 4.9057

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9646
Train Loss: 0.1029
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.3984
ID Test ACCURACY: 0.8826
ID Test Loss: 0.4026
OOD Validation ACCURACY: 0.7703
OOD Validation Loss: 0.9501
OOD Test ACCURACY: 0.2739
OOD Test Loss: 7.1712

[0m[1;37mINFO[0m: [1mChartInfo 0.8846 0.3063 0.8826 0.2739 0.8820 0.7703[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:20.052119
Plausibility completed in  0:02:24.538226
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3565, device='cuda:0')  +-  tensor(0.0083, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.499 +- 0.183
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.666 +- 0.122
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.267069
Plausibility completed in  0:02:06.503786
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6860, device='cuda:0')  +-  tensor(0.0095, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.388 +- 0.187
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.796 +- 0.062
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:15:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 07:15:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9730
Train Loss: 0.0837
ID Validation ACCURACY: 0.8894
ID Validation Loss: 0.3769
ID Test ACCURACY: 0.8864
ID Test Loss: 0.3922
OOD Validation ACCURACY: 0.6770
OOD Validation Loss: 1.7135
OOD Test ACCURACY: 0.2230
OOD Test Loss: 8.2497

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9545
Train Loss: 0.1347
ID Validation ACCURACY: 0.8867
ID Validation Loss: 0.3741
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3766
OOD Validation ACCURACY: 0.7774
OOD Validation Loss: 0.7987
OOD Test ACCURACY: 0.3824
OOD Test Loss: 2.9937

[0m[1;37mINFO[0m: [1mChartInfo 0.8864 0.2230 0.8890 0.3824 0.8867 0.7774[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:20.975058
Plausibility completed in  0:02:24.252280
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3568, device='cuda:0')  +-  tensor(0.0091, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.468 +- 0.183
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.645 +- 0.122
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.184656
Plausibility completed in  0:02:06.609852
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6871, device='cuda:0')  +-  tensor(0.0111, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.372 +- 0.190
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.790 +- 0.064
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:30:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 07:30:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9739
Train Loss: 0.0800
ID Validation ACCURACY: 0.8936
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.8870
ID Test Loss: 0.3904
OOD Validation ACCURACY: 0.8023
OOD Validation Loss: 0.7265
OOD Test ACCURACY: 0.2739
OOD Test Loss: 4.8281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9201
Train Loss: 0.2337
ID Validation ACCURACY: 0.8701
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4148
OOD Validation ACCURACY: 0.8056
OOD Validation Loss: 0.6300
OOD Test ACCURACY: 0.4093
OOD Test Loss: 2.5019

[0m[1;37mINFO[0m: [1mChartInfo 0.8870 0.2739 0.8727 0.4093 0.8701 0.8056[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:18.203008
Plausibility completed in  0:02:14.577221
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3556, device='cuda:0')  +-  tensor(0.0084, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.493 +- 0.178
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.662 +- 0.118
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:15.209464
Plausibility completed in  0:02:07.391039
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6852, device='cuda:0')  +-  tensor(0.0096, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.374 +- 0.182
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.791 +- 0.061
Num considered samples: 7000

\FINISHED GOODCMNIST - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33504108 0.64627208] +- [0.00153903 0.00237087] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.35640423 0.68630391] +- [0.00079655 0.00072674] (mean across ratios: 0.52 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999897 0.99999937] +- [7.29420592e-07 1.75201159e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.66477716 0.79481673] +- [0.01226544 0.00358137] (mean across ratios: 0.73 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999914 0.9999995 ] +- [1.04101863e-06 4.08802705e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.49707244 0.38543958] +- [0.01840592 0.01069125] (mean across ratios: 0.44 +- 0.01)

Overall time of execution:  1:23:03.284407
DONE GSAT GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 19:46:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:43 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 07:46:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9710
Train Loss: 0.0888
ID Validation ACCURACY: 0.8913
ID Validation Loss: 0.3578
ID Test ACCURACY: 0.8891
ID Test Loss: 0.3689
OOD Validation ACCURACY: 0.7710
OOD Validation Loss: 0.8283
OOD Test ACCURACY: 0.2787
OOD Test Loss: 5.7327

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 0.9678
Train Loss: 0.0980
ID Validation ACCURACY: 0.8826
ID Validation Loss: 0.3955
ID Test ACCURACY: 0.8830
ID Test Loss: 0.3916
OOD Validation ACCURACY: 0.7823
OOD Validation Loss: 0.8443
OOD Test ACCURACY: 0.3099
OOD Test Loss: 7.0050

[0m[1;37mINFO[0m: [1mChartInfo 0.8891 0.2787 0.8830 0.3099 0.8826 0.7823[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.176613
Plausibility completed in  0:02:01.275170
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3877, device='cuda:0')  +-  tensor(0.0107, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.207 +- 0.209
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.505 +- 0.131
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.101645
Plausibility completed in  0:02:07.746916
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7561, device='cuda:0')  +-  tensor(0.0134, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.130 +- 0.176
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.782 +- 0.046
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:06:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 08:06:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.9697
Train Loss: 0.0910
ID Validation ACCURACY: 0.8901
ID Validation Loss: 0.3680
ID Test ACCURACY: 0.8897
ID Test Loss: 0.3824
OOD Validation ACCURACY: 0.7509
OOD Validation Loss: 1.0322
OOD Test ACCURACY: 0.2683
OOD Test Loss: 5.3981

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 0.9635
Train Loss: 0.1083
ID Validation ACCURACY: 0.8834
ID Validation Loss: 0.3827
ID Test ACCURACY: 0.8824
ID Test Loss: 0.3845
OOD Validation ACCURACY: 0.7814
OOD Validation Loss: 0.9042
OOD Test ACCURACY: 0.3949
OOD Test Loss: 2.9563

[0m[1;37mINFO[0m: [1mChartInfo 0.8897 0.2683 0.8824 0.3949 0.8834 0.7814[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.866930
Plausibility completed in  0:02:00.616894
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3883, device='cuda:0')  +-  tensor(0.0114, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.225 +- 0.210
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.516 +- 0.132
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.401413
Plausibility completed in  0:02:09.911333
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7556, device='cuda:0')  +-  tensor(0.0141, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.117 +- 0.185
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.779 +- 0.049
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:22:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:32 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 08:22:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9624
Train Loss: 0.1081
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3704
ID Test ACCURACY: 0.8846
ID Test Loss: 0.3894
OOD Validation ACCURACY: 0.7016
OOD Validation Loss: 1.3742
OOD Test ACCURACY: 0.3063
OOD Test Loss: 4.9057

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9646
Train Loss: 0.1029
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.3984
ID Test ACCURACY: 0.8826
ID Test Loss: 0.4026
OOD Validation ACCURACY: 0.7703
OOD Validation Loss: 0.9501
OOD Test ACCURACY: 0.2739
OOD Test Loss: 7.1712

[0m[1;37mINFO[0m: [1mChartInfo 0.8846 0.3063 0.8826 0.2739 0.8820 0.7703[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.722747
Plausibility completed in  0:02:00.392453
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3869, device='cuda:0')  +-  tensor(0.0105, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.195 +- 0.210
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.497 +- 0.131
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.067597
Plausibility completed in  0:02:21.040093
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7546, device='cuda:0')  +-  tensor(0.0124, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.095 +- 0.163
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.774 +- 0.042
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:38:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 08:38:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9730
Train Loss: 0.0837
ID Validation ACCURACY: 0.8894
ID Validation Loss: 0.3769
ID Test ACCURACY: 0.8864
ID Test Loss: 0.3922
OOD Validation ACCURACY: 0.6770
OOD Validation Loss: 1.7135
OOD Test ACCURACY: 0.2230
OOD Test Loss: 8.2497

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9545
Train Loss: 0.1347
ID Validation ACCURACY: 0.8867
ID Validation Loss: 0.3741
ID Test ACCURACY: 0.8890
ID Test Loss: 0.3766
OOD Validation ACCURACY: 0.7774
OOD Validation Loss: 0.7987
OOD Test ACCURACY: 0.3824
OOD Test Loss: 2.9937

[0m[1;37mINFO[0m: [1mChartInfo 0.8864 0.2230 0.8890 0.3824 0.8867 0.7774[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.753596
Plausibility completed in  0:02:03.389786
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3864, device='cuda:0')  +-  tensor(0.0119, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.161 +- 0.210
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.476 +- 0.132
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.535737
Plausibility completed in  0:02:20.276304
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7550, device='cuda:0')  +-  tensor(0.0140, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.100 +- 0.170
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.775 +- 0.045
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 20:53:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:36 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/20/2024 08:53:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9739
Train Loss: 0.0800
ID Validation ACCURACY: 0.8936
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.8870
ID Test Loss: 0.3904
OOD Validation ACCURACY: 0.8023
OOD Validation Loss: 0.7265
OOD Test ACCURACY: 0.2739
OOD Test Loss: 4.8281

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9201
Train Loss: 0.2337
ID Validation ACCURACY: 0.8701
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.8727
ID Test Loss: 0.4148
OOD Validation ACCURACY: 0.8056
OOD Validation Loss: 0.6300
OOD Test ACCURACY: 0.4093
OOD Test Loss: 2.5019

[0m[1;37mINFO[0m: [1mChartInfo 0.8870 0.2739 0.8727 0.4093 0.8701 0.8056[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.168518
Plausibility completed in  0:02:00.147989
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3864, device='cuda:0')  +-  tensor(0.0102, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.191 +- 0.206
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.495 +- 0.129
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.209457
Plausibility completed in  0:02:11.945412
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7540, device='cuda:0')  +-  tensor(0.0123, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.085 +- 0.160
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.771 +- 0.042
Num considered samples: 7000

\FINISHED GOODCMNIST - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33504108 0.64627196] +- [0.00153918 0.00237088] (mean across ratios: 0.49 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38712983 0.75505795] +- [0.00077261 0.00074154] (mean across ratios: 0.57 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999912 0.99999913] +- [4.74446982e-07 1.16800773e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.49760518 0.77593144] +- [0.01322761 0.00399147] (mean across ratios: 0.64 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999933 0.99999895] +- [6.98570505e-07 2.65491694e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.19577415 0.10534489] +- [0.02118962 0.01624237] (mean across ratios: 0.15 +- 0.01)

Overall time of execution:  1:22:04.662960
DONE GSAT GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:09:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 09:09:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.2997
Train Loss: 3.3387
ID Validation ACCURACY: 0.2909
ID Validation Loss: 3.4073
ID Test ACCURACY: 0.2920
ID Test Loss: 3.3954
OOD Validation ACCURACY: 0.2336
OOD Validation Loss: 5.2601
OOD Test ACCURACY: 0.1400
OOD Test Loss: 6.1619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.2997
Train Loss: 3.3387
ID Validation ACCURACY: 0.2909
ID Validation Loss: 3.4073
ID Test ACCURACY: 0.2920
ID Test Loss: 3.3954
OOD Validation ACCURACY: 0.2336
OOD Validation Loss: 5.2601
OOD Test ACCURACY: 0.1400
OOD Test Loss: 6.1619

[0m[1;37mINFO[0m: [1mChartInfo 0.2920 0.1400 0.2920 0.1400 0.2909 0.2336[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.620838
Plausibility completed in  0:01:42.660799
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5868, device='cuda:0')  +-  tensor(0.0854, device='cuda:0') (0.017)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.877 +- 0.056
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.918 +- 0.037
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.395359
Plausibility completed in  0:02:00.266908
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8892, device='cuda:0')  +-  tensor(0.0703, device='cuda:0') (0.016)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.726 +- 0.118
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.909 +- 0.039
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:26:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 09:26:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.6581
Train Loss: 0.9910
ID Validation ACCURACY: 0.6360
ID Validation Loss: 1.0899
ID Test ACCURACY: 0.6253
ID Test Loss: 1.1128
OOD Validation ACCURACY: 0.4889
OOD Validation Loss: 1.6348
OOD Test ACCURACY: 0.2900
OOD Test Loss: 2.5498

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.5949
Train Loss: 1.2307
ID Validation ACCURACY: 0.5809
ID Validation Loss: 1.3357
ID Test ACCURACY: 0.5690
ID Test Loss: 1.3701
OOD Validation ACCURACY: 0.5664
OOD Validation Loss: 1.3707
OOD Test ACCURACY: 0.3381
OOD Test Loss: 2.4209

[0m[1;37mINFO[0m: [1mChartInfo 0.6253 0.2900 0.5690 0.3381 0.5809 0.5664[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.438897
Plausibility completed in  0:01:41.968269
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4016, device='cuda:0')  +-  tensor(0.0091, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.588 +- 0.091
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.726 +- 0.060
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.697688
Plausibility completed in  0:01:40.917951
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7489, device='cuda:0')  +-  tensor(0.0183, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.568 +- 0.107
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.856 +- 0.036
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:40:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 09:40:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.6698
Train Loss: 0.9467
ID Validation ACCURACY: 0.6491
ID Validation Loss: 1.0314
ID Test ACCURACY: 0.6391
ID Test Loss: 1.0585
OOD Validation ACCURACY: 0.5524
OOD Validation Loss: 1.4077
OOD Test ACCURACY: 0.3830
OOD Test Loss: 2.2401

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.6334
Train Loss: 1.1120
ID Validation ACCURACY: 0.6076
ID Validation Loss: 1.2323
ID Test ACCURACY: 0.6007
ID Test Loss: 1.2595
OOD Validation ACCURACY: 0.5951
OOD Validation Loss: 1.2541
OOD Test ACCURACY: 0.3426
OOD Test Loss: 2.3810

[0m[1;37mINFO[0m: [1mChartInfo 0.6391 0.3830 0.6007 0.3426 0.6076 0.5951[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.254209
Plausibility completed in  0:01:52.467399
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3917, device='cuda:0')  +-  tensor(0.0077, device='cuda:0') (0.002)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.635 +- 0.110
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.757 +- 0.073
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:16.839741
Plausibility completed in  0:01:41.245449
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7264, device='cuda:0')  +-  tensor(0.0104, device='cuda:0') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.525 +- 0.099
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.841 +- 0.033
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 21:53:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 09:54:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.5377
Train Loss: 1.5075
ID Validation ACCURACY: 0.5361
ID Validation Loss: 1.5713
ID Test ACCURACY: 0.5206
ID Test Loss: 1.6479
OOD Validation ACCURACY: 0.4199
OOD Validation Loss: 2.4982
OOD Test ACCURACY: 0.3477
OOD Test Loss: 3.0782

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 52...
[0m[1;37mINFO[0m: [1mCheckpoint 52: 
-----------------------------------
Train ACCURACY: 0.4893
Train Loss: 1.5757
ID Validation ACCURACY: 0.4821
ID Validation Loss: 1.6006
ID Test ACCURACY: 0.4747
ID Test Loss: 1.6438
OOD Validation ACCURACY: 0.4277
OOD Validation Loss: 1.9595
OOD Test ACCURACY: 0.3373
OOD Test Loss: 2.5935

[0m[1;37mINFO[0m: [1mChartInfo 0.5206 0.3477 0.4747 0.3373 0.4821 0.4277[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.340843
Plausibility completed in  0:01:41.904529
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4138, device='cuda:0')  +-  tensor(0.0152, device='cuda:0') (0.004)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.766 +- 0.075
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.844 +- 0.050
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.442782
Plausibility completed in  0:01:45.993690
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7173, device='cuda:0')  +-  tensor(0.0099, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.471 +- 0.099
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.823 +- 0.032
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:07:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 10:07:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 78...
[0m[1;37mINFO[0m: [1mCheckpoint 78: 
-----------------------------------
Train ACCURACY: 0.5967
Train Loss: 1.3782
ID Validation ACCURACY: 0.5773
ID Validation Loss: 1.5029
ID Test ACCURACY: 0.5697
ID Test Loss: 1.5503
OOD Validation ACCURACY: 0.4626
OOD Validation Loss: 2.5270
OOD Test ACCURACY: 0.3526
OOD Test Loss: 8.1775

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5321
Train Loss: 1.5191
ID Validation ACCURACY: 0.5236
ID Validation Loss: 1.5860
ID Test ACCURACY: 0.5176
ID Test Loss: 1.6001
OOD Validation ACCURACY: 0.4831
OOD Validation Loss: 1.8222
OOD Test ACCURACY: 0.3497
OOD Test Loss: 9.4069

[0m[1;37mINFO[0m: [1mChartInfo 0.5697 0.3526 0.5176 0.3497 0.5236 0.4831[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:21.739727
Plausibility completed in  0:01:41.913583
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3993, device='cuda:0')  +-  tensor(0.0087, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.746 +- 0.072
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.831 +- 0.048
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.621883
Plausibility completed in  0:01:40.942064
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7149, device='cuda:0')  +-  tensor(0.0067, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.571 +- 0.095
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.857 +- 0.031
Num considered samples: 7000

\FINISHED GOODCMNIST - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.44717814 0.73949319] +- [0.13973068 0.12566336] (mean across ratios: 0.59 +- 0.09)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43864526 0.75934241] +- [0.0744301  0.06602681] (mean across ratios: 0.60 +- 0.05)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999901 0.99999923] +- [5.35248383e-07 3.19872090e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.81510381 0.85712883] +- [0.06795036 0.02849897] (mean across ratios: 0.84 +- 0.04)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999919 0.99999914] +- [7.43124360e-07 7.60140351e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.72251648 0.57190218] +- [0.10196867 0.08510036] (mean across ratios: 0.65 +- 0.07)

Overall time of execution:  1:12:28.211182
DONE CIGA GOODCMNIST/color 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:21:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 10:21:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.2997
Train Loss: 3.3387
ID Validation ACCURACY: 0.2909
ID Validation Loss: 3.4073
ID Test ACCURACY: 0.2920
ID Test Loss: 3.3954
OOD Validation ACCURACY: 0.2336
OOD Validation Loss: 5.2601
OOD Test ACCURACY: 0.1400
OOD Test Loss: 6.1619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.2997
Train Loss: 3.3387
ID Validation ACCURACY: 0.2909
ID Validation Loss: 3.4073
ID Test ACCURACY: 0.2920
ID Test Loss: 3.3954
OOD Validation ACCURACY: 0.2336
OOD Validation Loss: 5.2601
OOD Test ACCURACY: 0.1400
OOD Test Loss: 6.1619

[0m[1;37mINFO[0m: [1mChartInfo 0.2920 0.1400 0.2920 0.1400 0.2909 0.2336[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:21.679594
Plausibility completed in  0:01:50.767085
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4730, device='cuda:0')  +-  tensor(0.0570, device='cuda:0') (0.016)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.722 +- 0.126
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.827 +- 0.078
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.032738
Plausibility completed in  0:01:38.340857
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7807, device='cuda:0')  +-  tensor(0.0267, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.198 +- 0.179
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.801 +- 0.040
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:38:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 10:38:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.6581
Train Loss: 0.9910
ID Validation ACCURACY: 0.6360
ID Validation Loss: 1.0899
ID Test ACCURACY: 0.6253
ID Test Loss: 1.1128
OOD Validation ACCURACY: 0.4889
OOD Validation Loss: 1.6348
OOD Test ACCURACY: 0.2900
OOD Test Loss: 2.5498

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.5949
Train Loss: 1.2307
ID Validation ACCURACY: 0.5809
ID Validation Loss: 1.3357
ID Test ACCURACY: 0.5690
ID Test Loss: 1.3701
OOD Validation ACCURACY: 0.5664
OOD Validation Loss: 1.3707
OOD Test ACCURACY: 0.3381
OOD Test Loss: 2.4209

[0m[1;37mINFO[0m: [1mChartInfo 0.6253 0.2900 0.5690 0.3381 0.5809 0.5664[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.935953
Plausibility completed in  0:01:38.752401
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4392, device='cuda:0')  +-  tensor(0.0193, device='cuda:0') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.343 +- 0.123
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.589 +- 0.077
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.461556
Plausibility completed in  0:01:49.366790
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8234, device='cuda:0')  +-  tensor(0.0297, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.447 +- 0.172
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.860 +- 0.047
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 22:51:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 10:51:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.6698
Train Loss: 0.9467
ID Validation ACCURACY: 0.6491
ID Validation Loss: 1.0314
ID Test ACCURACY: 0.6391
ID Test Loss: 1.0585
OOD Validation ACCURACY: 0.5524
OOD Validation Loss: 1.4077
OOD Test ACCURACY: 0.3830
OOD Test Loss: 2.2401

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 73...
[0m[1;37mINFO[0m: [1mCheckpoint 73: 
-----------------------------------
Train ACCURACY: 0.6334
Train Loss: 1.1120
ID Validation ACCURACY: 0.6076
ID Validation Loss: 1.2323
ID Test ACCURACY: 0.6007
ID Test Loss: 1.2595
OOD Validation ACCURACY: 0.5951
OOD Validation Loss: 1.2541
OOD Test ACCURACY: 0.3426
OOD Test Loss: 2.3810

[0m[1;37mINFO[0m: [1mChartInfo 0.6391 0.3830 0.6007 0.3426 0.6076 0.5951[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.019598
Plausibility completed in  0:01:38.511010
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4268, device='cuda:0')  +-  tensor(0.0120, device='cuda:0') (0.003)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.370 +- 0.148
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.607 +- 0.091
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.269272
Plausibility completed in  0:01:37.535708
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7985, device='cuda:0')  +-  tensor(0.0205, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.333 +- 0.153
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.832 +- 0.042
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:05:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 11:05:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.5377
Train Loss: 1.5075
ID Validation ACCURACY: 0.5361
ID Validation Loss: 1.5713
ID Test ACCURACY: 0.5206
ID Test Loss: 1.6479
OOD Validation ACCURACY: 0.4199
OOD Validation Loss: 2.4982
OOD Test ACCURACY: 0.3477
OOD Test Loss: 3.0782

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 52...
[0m[1;37mINFO[0m: [1mCheckpoint 52: 
-----------------------------------
Train ACCURACY: 0.4893
Train Loss: 1.5757
ID Validation ACCURACY: 0.4821
ID Validation Loss: 1.6006
ID Test ACCURACY: 0.4747
ID Test Loss: 1.6438
OOD Validation ACCURACY: 0.4277
OOD Validation Loss: 1.9595
OOD Test ACCURACY: 0.3373
OOD Test Loss: 2.5935

[0m[1;37mINFO[0m: [1mChartInfo 0.5206 0.3477 0.4747 0.3373 0.4821 0.4277[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:14.910891
Plausibility completed in  0:01:44.025943
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4158, device='cuda:0')  +-  tensor(0.0116, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.421 +- 0.124
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.638 +- 0.076
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:17.457018
Plausibility completed in  0:01:44.131064
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7554, device='cuda:0')  +-  tensor(0.0075, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.029 +- 0.102
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.758 +- 0.023
Num considered samples: 7000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_5l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:18:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mLoading dataset with permuted nodes
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/20/2024 11:18:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 78...
[0m[1;37mINFO[0m: [1mCheckpoint 78: 
-----------------------------------
Train ACCURACY: 0.5967
Train Loss: 1.3782
ID Validation ACCURACY: 0.5773
ID Validation Loss: 1.5029
ID Test ACCURACY: 0.5697
ID Test Loss: 1.5503
OOD Validation ACCURACY: 0.4626
OOD Validation Loss: 2.5270
OOD Test ACCURACY: 0.3526
OOD Test Loss: 8.1775

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.5321
Train Loss: 1.5191
ID Validation ACCURACY: 0.5236
ID Validation Loss: 1.5860
ID Test ACCURACY: 0.5176
ID Test Loss: 1.6001
OOD Validation ACCURACY: 0.4831
OOD Validation Loss: 1.8222
OOD Test ACCURACY: 0.3497
OOD Test Loss: 9.4069

[0m[1;37mINFO[0m: [1mChartInfo 0.5697 0.3526 0.5176 0.3497 0.5236 0.4831[0mGOODCMNIST(7000)
Data example from id_val: Data(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
Label distribution from id_val: (tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([704, 788, 715, 765, 668, 583, 676, 769, 678, 654]))
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:15.022622
Plausibility completed in  0:01:38.289109
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4169, device='cuda:0')  +-  tensor(0.0084, device='cuda:0') (0.005)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.448 +- 0.110
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.655 +- 0.068
Num considered samples: 7000


ratio=0.6


Interventions completed in  0:00:14.226032
Plausibility completed in  0:01:38.192057
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7620, device='cuda:0')  +-  tensor(0.0069, device='cuda:0') (0.003)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.108 +- 0.113
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.777 +- 0.025
Num considered samples: 7000

\FINISHED GOODCMNIST - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.44717826 0.73949318] +- [0.13973084 0.12566352] (mean across ratios: 0.59 +- 0.09)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43434984 0.78400692] +- [0.02107242 0.02479259] (mean across ratios: 0.61 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999872 0.99999933] +- [5.35248383e-07 3.31650442e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.66325108 0.80558484] +- [0.08484057 0.03695364] (mean across ratios: 0.73 +- 0.05)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999877 0.99999938] +- [7.55452133e-07 8.43442581e-07] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.46045285 0.22286484] +- [0.13568983 0.15070629] (mean across ratios: 0.34 +- 0.10)

Overall time of execution:  1:10:38.903904
DONE CIGA GOODCMNIST/color 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:32:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:32:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:33:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:33:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:33:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:34:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1420
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2255
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2246
OOD Validation ROC-AUC: 0.6374
OOD Validation Loss: 0.4787
OOD Test ROC-AUC: 0.6853
OOD Test Loss: 0.5698

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9140
Train Loss: 0.2226
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2385
ID Test ROC-AUC: 0.9039
ID Test Loss: 0.2385
OOD Validation ROC-AUC: 0.6822
OOD Validation Loss: 0.3129
OOD Test ROC-AUC: 0.7143
OOD Test Loss: 0.4523

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6853 0.9039 0.7143 0.9010 0.6822[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:34:23 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:27.075819
Plausibility completed in  0:01:48.159628
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3496, device='cuda:0')  +-  tensor(0.0200, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.863 +- 0.132
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.911 +- 0.084
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.837339
Plausibility completed in  0:01:56.064750
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6811, device='cuda:0')  +-  tensor(0.0305, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.001
Intervened Stability MCC for r=0.6 = 0.809 +- 0.154
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.940 +- 0.046
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:40:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:40:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:41:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:41:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:41:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:41:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1412
ID Validation ROC-AUC: 0.9211
ID Validation Loss: 0.2263
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2237
OOD Validation ROC-AUC: 0.6449
OOD Validation Loss: 0.4664
OOD Test ROC-AUC: 0.6906
OOD Test Loss: 0.5564

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9194
Train Loss: 0.2142
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2357
ID Test ROC-AUC: 0.9053
ID Test Loss: 0.2328
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.3224
OOD Test ROC-AUC: 0.7183
OOD Test Loss: 0.4429

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6906 0.9053 0.7183 0.9010 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:42:08 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.231013
Plausibility completed in  0:01:48.030905
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3497, device='cuda:0')  +-  tensor(0.0202, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.846 +- 0.133
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.900 +- 0.085
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.947039
Plausibility completed in  0:01:52.063554
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6814, device='cuda:0')  +-  tensor(0.0306, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.001
Intervened Stability MCC for r=0.6 = 0.769 +- 0.169
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.928 +- 0.050
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:48:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:48:14 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:48:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:00 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ROC-AUC: 0.9700
Train Loss: 0.1384
ID Validation ROC-AUC: 0.9239
ID Validation Loss: 0.2236
ID Test ROC-AUC: 0.9258
ID Test Loss: 0.2238
OOD Validation ROC-AUC: 0.6361
OOD Validation Loss: 0.4564
OOD Test ROC-AUC: 0.6863
OOD Test Loss: 0.5633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9076
Train Loss: 0.2268
ID Validation ROC-AUC: 0.8921
ID Validation Loss: 0.2443
ID Test ROC-AUC: 0.8980
ID Test Loss: 0.2413
OOD Validation ROC-AUC: 0.6868
OOD Validation Loss: 0.3111
OOD Test ROC-AUC: 0.7174
OOD Test Loss: 0.4442

[0m[1;37mINFO[0m: [1mChartInfo 0.9258 0.6863 0.8980 0.7174 0.8921 0.6868[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:49:42 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.047908
Plausibility completed in  0:01:47.472530
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3493, device='cuda:0')  +-  tensor(0.0202, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.001
Intervened Stability MCC for r=0.3 = 0.828 +- 0.146
Original Stability F1 for r=0.3 = 1.000 +- 0.001
Intervened Stability F1 for r=0.3 = 0.889 +- 0.094
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.804965
Plausibility completed in  0:01:47.071686
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6811, device='cuda:0')  +-  tensor(0.0308, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.736 +- 0.181
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.917 +- 0.053
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Sep 20 23:55:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/20/2024 11:55:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/20/2024 11:56:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/20/2024 11:56:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/20/2024 11:56:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/20/2024 11:56:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ROC-AUC: 0.9701
Train Loss: 0.1379
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9249
ID Test Loss: 0.2294
OOD Validation ROC-AUC: 0.6427
OOD Validation Loss: 0.4806
OOD Test ROC-AUC: 0.6915
OOD Test Loss: 0.5778

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ROC-AUC: 0.9368
Train Loss: 0.1927
ID Validation ROC-AUC: 0.9098
ID Validation Loss: 0.2281
ID Test ROC-AUC: 0.9159
ID Test Loss: 0.2220
OOD Validation ROC-AUC: 0.6858
OOD Validation Loss: 0.3482
OOD Test ROC-AUC: 0.7149
OOD Test Loss: 0.4585

[0m[1;37mINFO[0m: [1mChartInfo 0.9249 0.6915 0.9159 0.7149 0.9098 0.6858[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/20/2024 11:57:17 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.097226
Plausibility completed in  0:01:47.955279
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3532, device='cuda:0')  +-  tensor(0.0205, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.001
Intervened Stability MCC for r=0.3 = 0.876 +- 0.125
Original Stability F1 for r=0.3 = 1.000 +- 0.001
Intervened Stability F1 for r=0.3 = 0.919 +- 0.080
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.834962
Plausibility completed in  0:01:46.713228
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6835, device='cuda:0')  +-  tensor(0.0307, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.851 +- 0.143
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.953 +- 0.042
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:03:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:03:29 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:03:59 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:09 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:19 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:34 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9611
Train Loss: 0.1567
ID Validation ROC-AUC: 0.9233
ID Validation Loss: 0.2180
ID Test ROC-AUC: 0.9240
ID Test Loss: 0.2206
OOD Validation ROC-AUC: 0.6334
OOD Validation Loss: 0.4667
OOD Test ROC-AUC: 0.6879
OOD Test Loss: 0.5492

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9251
Train Loss: 0.2093
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.2367
ID Test ROC-AUC: 0.9102
ID Test Loss: 0.2300
OOD Validation ROC-AUC: 0.6806
OOD Validation Loss: 0.3241
OOD Test ROC-AUC: 0.7074
OOD Test Loss: 0.4616

[0m[1;37mINFO[0m: [1mChartInfo 0.9240 0.6879 0.9102 0.7074 0.9033 0.6806[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:04:50 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:26.111329
Plausibility completed in  0:01:47.660845
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3491, device='cuda:0')  +-  tensor(0.0205, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.810 +- 0.153
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.876 +- 0.098
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.740612
Plausibility completed in  0:01:45.924095
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6810, device='cuda:0')  +-  tensor(0.0309, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.753 +- 0.169
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.922 +- 0.050
Num considered samples: 11314

\FINISHED LBAPcore - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30944436 0.60900544] +- [0.00149496 0.00131393] (mean across ratios: 0.46 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.35019694 0.68163317] +- [0.00153508 0.00092983] (mean across ratios: 0.52 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999636 0.99999783] +- [3.89378491e-06 2.00243221e-06] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.89909128 0.93202479] +- [0.01536277 0.01304351] (mean across ratios: 0.92 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999541 0.99999585] +- [5.75905494e-06 5.08209209e-06] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.8446523  0.78377053] +- [0.02362624 0.04142529] (mean across ratios: 0.81 +- 0.02)

Overall time of execution:  0:38:10.189908
DONE LECI LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:11:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:11:05 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:11:35 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:11:45 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:11:55 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:10 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:12:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1420
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2255
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2246
OOD Validation ROC-AUC: 0.6374
OOD Validation Loss: 0.4787
OOD Test ROC-AUC: 0.6853
OOD Test Loss: 0.5698

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9140
Train Loss: 0.2226
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2385
ID Test ROC-AUC: 0.9039
ID Test Loss: 0.2385
OOD Validation ROC-AUC: 0.6822
OOD Validation Loss: 0.3129
OOD Test ROC-AUC: 0.7143
OOD Test Loss: 0.4523

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6853 0.9039 0.7143 0.9010 0.6822[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:12:26 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.821655
Plausibility completed in  0:01:45.709004
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4078, device='cuda:0')  +-  tensor(0.0501, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.767 +- 0.169
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.864 +- 0.094
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.870590
Plausibility completed in  0:01:45.032334
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7909, device='cuda:0')  +-  tensor(0.0701, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.684 +- 0.259
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.940 +- 0.044
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:18:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:18:26 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:18:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:06 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:31 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:19:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1412
ID Validation ROC-AUC: 0.9211
ID Validation Loss: 0.2263
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2237
OOD Validation ROC-AUC: 0.6449
OOD Validation Loss: 0.4664
OOD Test ROC-AUC: 0.6906
OOD Test Loss: 0.5564

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9194
Train Loss: 0.2142
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2357
ID Test ROC-AUC: 0.9053
ID Test Loss: 0.2328
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.3224
OOD Test ROC-AUC: 0.7183
OOD Test Loss: 0.4429

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6906 0.9053 0.7183 0.9010 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:19:47 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:27.905091
Plausibility completed in  0:01:56.631389
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4079, device='cuda:0')  +-  tensor(0.0501, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.740 +- 0.172
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.847 +- 0.097
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.837797
Plausibility completed in  0:01:45.238429
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7912, device='cuda:0')  +-  tensor(0.0701, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.001
Intervened Stability MCC for r=0.6 = 0.607 +- 0.271
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.924 +- 0.050
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:25:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:25:57 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:26:26 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:26:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:26:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:01 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:27:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ROC-AUC: 0.9700
Train Loss: 0.1384
ID Validation ROC-AUC: 0.9239
ID Validation Loss: 0.2236
ID Test ROC-AUC: 0.9258
ID Test Loss: 0.2238
OOD Validation ROC-AUC: 0.6361
OOD Validation Loss: 0.4564
OOD Test ROC-AUC: 0.6863
OOD Test Loss: 0.5633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9076
Train Loss: 0.2268
ID Validation ROC-AUC: 0.8921
ID Validation Loss: 0.2443
ID Test ROC-AUC: 0.8980
ID Test Loss: 0.2413
OOD Validation ROC-AUC: 0.6868
OOD Validation Loss: 0.3111
OOD Test ROC-AUC: 0.7174
OOD Test Loss: 0.4442

[0m[1;37mINFO[0m: [1mChartInfo 0.9258 0.6863 0.8980 0.7174 0.8921 0.6868[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:27:17 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.988321
Plausibility completed in  0:01:45.064788
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4074, device='cuda:0')  +-  tensor(0.0503, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.002
Intervened Stability MCC for r=0.3 = 0.707 +- 0.185
Original Stability F1 for r=0.3 = 1.000 +- 0.001
Intervened Stability F1 for r=0.3 = 0.829 +- 0.104
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.681286
Plausibility completed in  0:01:44.845317
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7909, device='cuda:0')  +-  tensor(0.0701, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.561 +- 0.273
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.913 +- 0.053
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:33:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:33:12 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:33:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:33:51 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:01 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:17 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:32 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:34:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ROC-AUC: 0.9701
Train Loss: 0.1379
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9249
ID Test Loss: 0.2294
OOD Validation ROC-AUC: 0.6427
OOD Validation Loss: 0.4806
OOD Test ROC-AUC: 0.6915
OOD Test Loss: 0.5778

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ROC-AUC: 0.9368
Train Loss: 0.1927
ID Validation ROC-AUC: 0.9098
ID Validation Loss: 0.2281
ID Test ROC-AUC: 0.9159
ID Test Loss: 0.2220
OOD Validation ROC-AUC: 0.6858
OOD Validation Loss: 0.3482
OOD Test ROC-AUC: 0.7149
OOD Test Loss: 0.4585

[0m[1;37mINFO[0m: [1mChartInfo 0.9249 0.6915 0.9159 0.7149 0.9098 0.6858[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:34:32 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.868635
Plausibility completed in  0:01:45.312494
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4116, device='cuda:0')  +-  tensor(0.0503, device='cuda:0') (0.001)
Original Stability MCC for r=0.3 = 1.000 +- 0.001
Intervened Stability MCC for r=0.3 = 0.783 +- 0.163
Original Stability F1 for r=0.3 = 1.000 +- 0.001
Intervened Stability F1 for r=0.3 = 0.873 +- 0.091
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.128450
Plausibility completed in  0:01:45.002856
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7923, device='cuda:0')  +-  tensor(0.0696, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.728 +- 0.257
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.042
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:40:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:40:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:09 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:20 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9611
Train Loss: 0.1567
ID Validation ROC-AUC: 0.9233
ID Validation Loss: 0.2180
ID Test ROC-AUC: 0.9240
ID Test Loss: 0.2206
OOD Validation ROC-AUC: 0.6334
OOD Validation Loss: 0.4667
OOD Test ROC-AUC: 0.6879
OOD Test Loss: 0.5492

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9251
Train Loss: 0.2093
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.2367
ID Test ROC-AUC: 0.9102
ID Test Loss: 0.2300
OOD Validation ROC-AUC: 0.6806
OOD Validation Loss: 0.3241
OOD Test ROC-AUC: 0.7074
OOD Test Loss: 0.4616

[0m[1;37mINFO[0m: [1mChartInfo 0.9240 0.6879 0.9102 0.7074 0.9033 0.6806[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:41:50 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.374509
Plausibility completed in  0:01:45.736659
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4073, device='cuda:0')  +-  tensor(0.0507, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.691 +- 0.190
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.818 +- 0.108
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.930994
Plausibility completed in  0:01:53.223051
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7908, device='cuda:0')  +-  tensor(0.0701, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.620 +- 0.266
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.926 +- 0.048
Num considered samples: 11314

\FINISHED LBAPcore - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.30944434 0.60900538] +- [0.00149492 0.0013139 ] (mean across ratios: 0.46 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.40841138 0.79123887] +- [0.00159214 0.00056626] (mean across ratios: 0.60 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999591 0.99999868] +- [4.55756930e-06 1.57356262e-06] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.84608327 0.93061955] +- [0.02059315 0.01282949] (mean across ratios: 0.89 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99999483 0.99999796] +- [6.66702931e-06 4.07695770e-06] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.73758887 0.64022784] +- [0.03464324 0.05902079] (mean across ratios: 0.69 +- 0.03)

Overall time of execution:  0:36:52.515874
DONE LECI LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:48:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:48:14 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:48:45 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:48:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:21 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 12:49:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9575
Train Loss: 0.1735
ID Validation ROC-AUC: 0.9126
ID Validation Loss: 0.2431
ID Test ROC-AUC: 0.9180
ID Test Loss: 0.2370
OOD Validation ROC-AUC: 0.6443
OOD Validation Loss: 0.5116
OOD Test ROC-AUC: 0.6826
OOD Test Loss: 0.6087

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ROC-AUC: 0.9308
Train Loss: 0.2188
ID Validation ROC-AUC: 0.9073
ID Validation Loss: 0.2593
ID Test ROC-AUC: 0.9108
ID Test Loss: 0.2562
OOD Validation ROC-AUC: 0.6898
OOD Validation Loss: 0.3322
OOD Test ROC-AUC: 0.7117
OOD Test Loss: 0.5314

[0m[1;37mINFO[0m: [1mChartInfo 0.9180 0.6826 0.9108 0.7117 0.9073 0.6898[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:49:37 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.981980
Plausibility completed in  0:01:47.259905
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3546, device='cuda:0')  +-  tensor(0.0253, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.009
Intervened Stability MCC for r=0.3 = 0.208 +- 0.214
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.479 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.052130
Plausibility completed in  0:01:45.124379
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6848, device='cuda:0')  +-  tensor(0.0338, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = 0.175 +- 0.213
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.734 +- 0.073
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 00:55:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 12:55:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:03 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:13 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:23 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 12:56:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9581
Train Loss: 0.1675
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2388
ID Test ROC-AUC: 0.9181
ID Test Loss: 0.2360
OOD Validation ROC-AUC: 0.6422
OOD Validation Loss: 0.5090
OOD Test ROC-AUC: 0.6891
OOD Test Loss: 0.6078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9226
Train Loss: 0.2146
ID Validation ROC-AUC: 0.8997
ID Validation Loss: 0.2460
ID Test ROC-AUC: 0.9051
ID Test Loss: 0.2424
OOD Validation ROC-AUC: 0.6819
OOD Validation Loss: 0.3340
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4973

[0m[1;37mINFO[0m: [1mChartInfo 0.9181 0.6891 0.9051 0.6983 0.8997 0.6819[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 12:56:55 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.916523
Plausibility completed in  0:01:45.441309
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3545, device='cuda:0')  +-  tensor(0.0252, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.199 +- 0.215
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.473 +- 0.145
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.985056
Plausibility completed in  0:01:44.497770
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6850, device='cuda:0')  +-  tensor(0.0342, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.999 +- 0.012
Intervened Stability MCC for r=0.6 = 0.179 +- 0.217
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.735 +- 0.075
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:02:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:02:49 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:03:19 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:03:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:03:39 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:03:54 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9565
Train Loss: 0.1673
ID Validation ROC-AUC: 0.9166
ID Validation Loss: 0.2335
ID Test ROC-AUC: 0.9184
ID Test Loss: 0.2312
OOD Validation ROC-AUC: 0.6443
OOD Validation Loss: 0.4868
OOD Test ROC-AUC: 0.6885
OOD Test Loss: 0.5753

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.8916
Train Loss: 0.2426
ID Validation ROC-AUC: 0.8768
ID Validation Loss: 0.2559
ID Test ROC-AUC: 0.8832
ID Test Loss: 0.2531
OOD Validation ROC-AUC: 0.6829
OOD Validation Loss: 0.2941
OOD Test ROC-AUC: 0.6934
OOD Test Loss: 0.4478

[0m[1;37mINFO[0m: [1mChartInfo 0.9184 0.6885 0.8832 0.6934 0.8768 0.6829[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:04:10 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.819792
Plausibility completed in  0:01:45.123827
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3545, device='cuda:0')  +-  tensor(0.0248, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.211 +- 0.213
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.481 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.959693
Plausibility completed in  0:01:45.026420
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6848, device='cuda:0')  +-  tensor(0.0332, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.012
Intervened Stability MCC for r=0.6 = 0.186 +- 0.214
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.737 +- 0.074
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:10:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:10:01 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:10:31 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:10:41 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:10:52 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:11:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ROC-AUC: 0.9582
Train Loss: 0.1732
ID Validation ROC-AUC: 0.9167
ID Validation Loss: 0.2422
ID Test ROC-AUC: 0.9192
ID Test Loss: 0.2373
OOD Validation ROC-AUC: 0.6602
OOD Validation Loss: 0.5268
OOD Test ROC-AUC: 0.6848
OOD Test Loss: 0.6351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.8939
Train Loss: 0.2644
ID Validation ROC-AUC: 0.8796
ID Validation Loss: 0.2781
ID Test ROC-AUC: 0.8853
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6941
OOD Validation Loss: 0.3916
OOD Test ROC-AUC: 0.6881
OOD Test Loss: 0.4866

[0m[1;37mINFO[0m: [1mChartInfo 0.9192 0.6848 0.8853 0.6881 0.8796 0.6941[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:11:24 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.898658
Plausibility completed in  0:01:45.443573
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3547, device='cuda:0')  +-  tensor(0.0255, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.204 +- 0.214
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.477 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.488878
Plausibility completed in  0:01:44.770762
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6844, device='cuda:0')  +-  tensor(0.0337, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.009
Intervened Stability MCC for r=0.6 = 0.174 +- 0.214
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.734 +- 0.073
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:17:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:17:36 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:16 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:26 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:18:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ROC-AUC: 0.9582
Train Loss: 0.1714
ID Validation ROC-AUC: 0.9187
ID Validation Loss: 0.2342
ID Test ROC-AUC: 0.9179
ID Test Loss: 0.2354
OOD Validation ROC-AUC: 0.6444
OOD Validation Loss: 0.5164
OOD Test ROC-AUC: 0.6886
OOD Test Loss: 0.5929

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9287
Train Loss: 0.2120
ID Validation ROC-AUC: 0.9078
ID Validation Loss: 0.2413
ID Test ROC-AUC: 0.9121
ID Test Loss: 0.2387
OOD Validation ROC-AUC: 0.6847
OOD Validation Loss: 0.3180
OOD Test ROC-AUC: 0.7131
OOD Test Loss: 0.4739

[0m[1;37mINFO[0m: [1mChartInfo 0.9179 0.6886 0.9121 0.7131 0.9078 0.6847[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:18:58 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.051811
Plausibility completed in  0:01:45.156590
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3547, device='cuda:0')  +-  tensor(0.0259, device='cuda:0') (0.006)
Original Stability MCC for r=0.3 = 1.000 +- 0.009
Intervened Stability MCC for r=0.3 = 0.203 +- 0.213
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.476 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.078752
Plausibility completed in  0:01:44.771233
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6850, device='cuda:0')  +-  tensor(0.0339, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.177 +- 0.213
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.735 +- 0.074
Num considered samples: 11314

\FINISHED LBAPcore - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.34985521 0.65001651] +- [0.00045281 0.00089327] (mean across ratios: 0.50 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.35459334 0.68480996] +- [9.57234291e-05 2.22300260e-04] (mean across ratios: 0.52 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99972019 0.99978505] +- [3.81986000e-05 3.02559987e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.47730232 0.73517703] +- [0.00267758 0.0011771 ] (mean across ratios: 0.61 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99959276 0.99942417] +- [5.62333431e-05 8.56470870e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.20485012 0.17812999] +- [0.00415741 0.00404371] (mean across ratios: 0.19 +- 0.00)

Overall time of execution:  0:36:40.095252
DONE GSAT LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:25:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:25:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:25:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:25:47 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:25:57 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:12 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:26:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9575
Train Loss: 0.1735
ID Validation ROC-AUC: 0.9126
ID Validation Loss: 0.2431
ID Test ROC-AUC: 0.9180
ID Test Loss: 0.2370
OOD Validation ROC-AUC: 0.6443
OOD Validation Loss: 0.5116
OOD Test ROC-AUC: 0.6826
OOD Test Loss: 0.6087

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ROC-AUC: 0.9308
Train Loss: 0.2188
ID Validation ROC-AUC: 0.9073
ID Validation Loss: 0.2593
ID Test ROC-AUC: 0.9108
ID Test Loss: 0.2562
OOD Validation ROC-AUC: 0.6898
OOD Validation Loss: 0.3322
OOD Test ROC-AUC: 0.7117
OOD Test Loss: 0.5314

[0m[1;37mINFO[0m: [1mChartInfo 0.9180 0.6826 0.9108 0.7117 0.9073 0.6898[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:26:28 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.883676
Plausibility completed in  0:01:46.493565
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4124, device='cuda:0')  +-  tensor(0.0532, device='cuda:0') (0.008)
Original Stability MCC for r=0.3 = 1.000 +- 0.010
Intervened Stability MCC for r=0.3 = 0.174 +- 0.226
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.506 +- 0.142
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.286690
Plausibility completed in  0:01:44.972778
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7926, device='cuda:0')  +-  tensor(0.0707, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.008
Intervened Stability MCC for r=0.6 = 0.115 +- 0.235
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.814 +- 0.079
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:32:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:23 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:32:53 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:13 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9581
Train Loss: 0.1675
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2388
ID Test ROC-AUC: 0.9181
ID Test Loss: 0.2360
OOD Validation ROC-AUC: 0.6422
OOD Validation Loss: 0.5090
OOD Test ROC-AUC: 0.6891
OOD Test Loss: 0.6078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9226
Train Loss: 0.2146
ID Validation ROC-AUC: 0.8997
ID Validation Loss: 0.2460
ID Test ROC-AUC: 0.9051
ID Test Loss: 0.2424
OOD Validation ROC-AUC: 0.6819
OOD Validation Loss: 0.3340
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4973

[0m[1;37mINFO[0m: [1mChartInfo 0.9181 0.6891 0.9051 0.6983 0.8997 0.6819[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:33:44 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.302190
Plausibility completed in  0:01:56.983978
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4127, device='cuda:0')  +-  tensor(0.0539, device='cuda:0') (0.008)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.167 +- 0.230
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.501 +- 0.144
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:25.328264
Plausibility completed in  0:01:45.089799
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7929, device='cuda:0')  +-  tensor(0.0706, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = 0.124 +- 0.240
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.815 +- 0.080
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:39:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:39:50 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:40:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:40:30 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:40:40 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:40:56 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9565
Train Loss: 0.1673
ID Validation ROC-AUC: 0.9166
ID Validation Loss: 0.2335
ID Test ROC-AUC: 0.9184
ID Test Loss: 0.2312
OOD Validation ROC-AUC: 0.6443
OOD Validation Loss: 0.4868
OOD Test ROC-AUC: 0.6885
OOD Test Loss: 0.5753

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.8916
Train Loss: 0.2426
ID Validation ROC-AUC: 0.8768
ID Validation Loss: 0.2559
ID Test ROC-AUC: 0.8832
ID Test Loss: 0.2531
OOD Validation ROC-AUC: 0.6829
OOD Validation Loss: 0.2941
OOD Test ROC-AUC: 0.6934
OOD Test Loss: 0.4478

[0m[1;37mINFO[0m: [1mChartInfo 0.9184 0.6885 0.8832 0.6934 0.8768 0.6829[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:41:11 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.272154
Plausibility completed in  0:01:45.647680
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4126, device='cuda:0')  +-  tensor(0.0531, device='cuda:0') (0.007)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.184 +- 0.226
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.511 +- 0.142
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.291783
Plausibility completed in  0:01:44.909362
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7928, device='cuda:0')  +-  tensor(0.0704, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.131 +- 0.237
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.817 +- 0.079
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:47:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:47:01 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:47:31 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:47:40 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:47:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:06 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:48:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ROC-AUC: 0.9582
Train Loss: 0.1732
ID Validation ROC-AUC: 0.9167
ID Validation Loss: 0.2422
ID Test ROC-AUC: 0.9192
ID Test Loss: 0.2373
OOD Validation ROC-AUC: 0.6602
OOD Validation Loss: 0.5268
OOD Test ROC-AUC: 0.6848
OOD Test Loss: 0.6351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.8939
Train Loss: 0.2644
ID Validation ROC-AUC: 0.8796
ID Validation Loss: 0.2781
ID Test ROC-AUC: 0.8853
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6941
OOD Validation Loss: 0.3916
OOD Test ROC-AUC: 0.6881
OOD Test Loss: 0.4866

[0m[1;37mINFO[0m: [1mChartInfo 0.9192 0.6848 0.8853 0.6881 0.8796 0.6941[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:48:21 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.315085
Plausibility completed in  0:01:45.066781
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4126, device='cuda:0')  +-  tensor(0.0537, device='cuda:0') (0.007)
Original Stability MCC for r=0.3 = 1.000 +- 0.011
Intervened Stability MCC for r=0.3 = 0.171 +- 0.228
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.504 +- 0.143
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.711126
Plausibility completed in  0:01:44.861423
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7923, device='cuda:0')  +-  tensor(0.0706, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = 0.114 +- 0.233
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.814 +- 0.078
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 01:54:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 01:54:16 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 01:54:45 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 01:54:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:20 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ROC-AUC: 0.9582
Train Loss: 0.1714
ID Validation ROC-AUC: 0.9187
ID Validation Loss: 0.2342
ID Test ROC-AUC: 0.9179
ID Test Loss: 0.2354
OOD Validation ROC-AUC: 0.6444
OOD Validation Loss: 0.5164
OOD Test ROC-AUC: 0.6886
OOD Test Loss: 0.5929

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9287
Train Loss: 0.2120
ID Validation ROC-AUC: 0.9078
ID Validation Loss: 0.2413
ID Test ROC-AUC: 0.9121
ID Test Loss: 0.2387
OOD Validation ROC-AUC: 0.6847
OOD Validation Loss: 0.3180
OOD Test ROC-AUC: 0.7131
OOD Test Loss: 0.4739

[0m[1;37mINFO[0m: [1mChartInfo 0.9179 0.6886 0.9121 0.7131 0.9078 0.6847[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 01:55:35 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.403535
Plausibility completed in  0:01:46.719293
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4129, device='cuda:0')  +-  tensor(0.0540, device='cuda:0') (0.008)
Original Stability MCC for r=0.3 = 1.000 +- 0.007
Intervened Stability MCC for r=0.3 = 0.176 +- 0.227
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.507 +- 0.142
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.463327
Plausibility completed in  0:01:45.439329
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7930, device='cuda:0')  +-  tensor(0.0705, device='cuda:0') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.011
Intervened Stability MCC for r=0.6 = 0.123 +- 0.234
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.816 +- 0.079
Num considered samples: 11314

\FINISHED LBAPcore - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.34985519 0.6500165 ] +- [0.00045283 0.00089328] (mean across ratios: 0.50 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.41262136 0.79271882] +- [0.00015379 0.00024176] (mean across ratios: 0.60 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99970057 0.99980427] +- [3.82988039e-05 2.10016321e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.50572584 0.81527002] +- [0.003294   0.00125504] (mean across ratios: 0.66 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99956254 0.99947369] +- [5.57465593e-05 5.83480094e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.17436864 0.12125046] +- [0.00562868 0.00623049] (mean across ratios: 0.15 +- 0.00)

Overall time of execution:  0:36:27.437921
DONE GSAT LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 02:01:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 02:01:48 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 02:02:29 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 02:02:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 02:02:58 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:14 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:29 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 02:03:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ROC-AUC: 0.9644
Train Loss: 0.3162
ID Validation ROC-AUC: 0.9159
ID Validation Loss: 0.4976
ID Test ROC-AUC: 0.9149
ID Test Loss: 0.5133
OOD Validation ROC-AUC: 0.6062
OOD Validation Loss: 0.7427
OOD Test ROC-AUC: 0.6845
OOD Test Loss: 1.0938

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ROC-AUC: 0.9089
Train Loss: 0.3173
ID Validation ROC-AUC: 0.8910
ID Validation Loss: 0.3404
ID Test ROC-AUC: 0.8888
ID Test Loss: 0.3479
OOD Validation ROC-AUC: 0.6543
OOD Validation Loss: 0.3422
OOD Test ROC-AUC: 0.6990
OOD Test Loss: 0.5882

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.6845 0.8888 0.6990 0.8910 0.6543[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:03:31 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.488934
Plausibility completed in  0:09:16.016238
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5324, device='cuda:0')  +-  tensor(0.0508, device='cuda:0') (0.030)
Original Stability MCC for r=0.3 = 0.998 +- 0.014
Intervened Stability MCC for r=0.3 = 0.738 +- 0.178
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.830 +- 0.114
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.292695
Plausibility completed in  0:09:14.252775
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8586, device='cuda:0')  +-  tensor(0.0333, device='cuda:0') (0.021)
Original Stability MCC for r=0.6 = 0.998 +- 0.019
Intervened Stability MCC for r=0.6 = 0.656 +- 0.200
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.892 +- 0.059
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 02:25:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 02:25:42 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 02:26:23 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 02:26:37 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 02:26:48 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:03 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ROC-AUC: 0.9658
Train Loss: 0.1509
ID Validation ROC-AUC: 0.9099
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.9129
ID Test Loss: 0.2578
OOD Validation ROC-AUC: 0.6398
OOD Validation Loss: 0.4377
OOD Test ROC-AUC: 0.6781
OOD Test Loss: 0.5882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.9221
Train Loss: 0.2152
ID Validation ROC-AUC: 0.8909
ID Validation Loss: 0.2509
ID Test ROC-AUC: 0.8972
ID Test Loss: 0.2480
OOD Validation ROC-AUC: 0.6624
OOD Validation Loss: 0.3222
OOD Test ROC-AUC: 0.7061
OOD Test Loss: 0.4680

[0m[1;37mINFO[0m: [1mChartInfo 0.9129 0.6781 0.8972 0.7061 0.8909 0.6624[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:27:19 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.944598
Plausibility completed in  0:09:16.297168
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4992, device='cuda:0')  +-  tensor(0.0361, device='cuda:0') (0.023)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.749 +- 0.177
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.837 +- 0.113
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.221020
Plausibility completed in  0:09:19.619291
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8240, device='cuda:0')  +-  tensor(0.0282, device='cuda:0') (0.018)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.706 +- 0.189
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.907 +- 0.057
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 02:49:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 02:49:40 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 02:50:18 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 02:50:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 02:50:39 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 02:50:54 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 02:51:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.9373
Train Loss: 0.1953
ID Validation ROC-AUC: 0.9097
ID Validation Loss: 0.2289
ID Test ROC-AUC: 0.9081
ID Test Loss: 0.2333
OOD Validation ROC-AUC: 0.6243
OOD Validation Loss: 0.3584
OOD Test ROC-AUC: 0.6758
OOD Test Loss: 0.4758

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ROC-AUC: 0.9088
Train Loss: 0.2311
ID Validation ROC-AUC: 0.8849
ID Validation Loss: 0.2505
ID Test ROC-AUC: 0.8879
ID Test Loss: 0.2510
OOD Validation ROC-AUC: 0.6619
OOD Validation Loss: 0.3260
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4346

[0m[1;37mINFO[0m: [1mChartInfo 0.9081 0.6758 0.8879 0.6983 0.8849 0.6619[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 02:51:10 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.534394
Plausibility completed in  0:09:15.601579
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4331, device='cuda:0')  +-  tensor(0.0255, device='cuda:0') (0.011)
Original Stability MCC for r=0.3 = 0.998 +- 0.020
Intervened Stability MCC for r=0.3 = 0.753 +- 0.170
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.839 +- 0.109
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.592505
Plausibility completed in  0:09:28.368492
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7579, device='cuda:0')  +-  tensor(0.0254, device='cuda:0') (0.011)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.730 +- 0.184
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.915 +- 0.055
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:13:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 03:13:40 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 03:14:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 03:14:20 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 03:14:30 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 03:14:45 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ROC-AUC: 0.9662
Train Loss: 0.1724
ID Validation ROC-AUC: 0.9138
ID Validation Loss: 0.3123
ID Test ROC-AUC: 0.9111
ID Test Loss: 0.3263
OOD Validation ROC-AUC: 0.5895
OOD Validation Loss: 0.6025
OOD Test ROC-AUC: 0.6681
OOD Test Loss: 0.7747

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9269
Train Loss: 0.2093
ID Validation ROC-AUC: 0.8991
ID Validation Loss: 0.2421
ID Test ROC-AUC: 0.9021
ID Test Loss: 0.2424
OOD Validation ROC-AUC: 0.6642
OOD Validation Loss: 0.3339
OOD Test ROC-AUC: 0.6850
OOD Test Loss: 0.4826

[0m[1;37mINFO[0m: [1mChartInfo 0.9111 0.6681 0.9021 0.6850 0.8991 0.6642[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 03:15:00 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.290567
Plausibility completed in  0:09:15.226887
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5114, device='cuda:0')  +-  tensor(0.0373, device='cuda:0') (0.020)
Original Stability MCC for r=0.3 = 0.999 +- 0.015
Intervened Stability MCC for r=0.3 = 0.803 +- 0.165
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.872 +- 0.106
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.196740
Plausibility completed in  0:09:31.081897
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8294, device='cuda:0')  +-  tensor(0.0277, device='cuda:0') (0.016)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.761 +- 0.184
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.925 +- 0.055
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 03:37:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 03:37:30 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:09 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:19 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.9661
Train Loss: 0.1473
ID Validation ROC-AUC: 0.9133
ID Validation Loss: 0.2363
ID Test ROC-AUC: 0.9109
ID Test Loss: 0.2418
OOD Validation ROC-AUC: 0.6302
OOD Validation Loss: 0.4522
OOD Test ROC-AUC: 0.6797
OOD Test Loss: 0.5703

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ROC-AUC: 0.9108
Train Loss: 0.2361
ID Validation ROC-AUC: 0.8892
ID Validation Loss: 0.2523
ID Test ROC-AUC: 0.8864
ID Test Loss: 0.2555
OOD Validation ROC-AUC: 0.6513
OOD Validation Loss: 0.3289
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.4218

[0m[1;37mINFO[0m: [1mChartInfo 0.9109 0.6797 0.8864 0.7073 0.8892 0.6513[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 03:38:50 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.335795
Plausibility completed in  0:09:15.768854
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4827, device='cuda:0')  +-  tensor(0.0349, device='cuda:0') (0.027)
Original Stability MCC for r=0.3 = 0.998 +- 0.021
Intervened Stability MCC for r=0.3 = 0.658 +- 0.206
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.778 +- 0.131
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.674612
Plausibility completed in  0:09:15.951477
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8070, device='cuda:0')  +-  tensor(0.0290, device='cuda:0') (0.018)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.585 +- 0.209
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.869 +- 0.062
Num considered samples: 11314

\FINISHED LBAPcore - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.43452927 0.75586538] +- [0.02314855 0.03032493] (mean across ratios: 0.60 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.49177241 0.81538846] +- [0.03349751 0.0332004 ] (mean across ratios: 0.65 +- 0.02)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9986972  0.99919974] +- [2.58249967e-04 9.32488057e-05] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.83139514 0.90151448] +- [0.03035857 0.0194638 ] (mean across ratios: 0.87 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99809675 0.99790406] +- [0.0003801  0.00024479] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.74024396 0.68748474] +- [0.0468685  0.06156287] (mean across ratios: 0.71 +- 0.04)

Overall time of execution:  1:59:22.634903
DONE CIGA LBAPcore/assay 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:01:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:18 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:48 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 04:01:59 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:02:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ROC-AUC: 0.9644
Train Loss: 0.3162
ID Validation ROC-AUC: 0.9159
ID Validation Loss: 0.4976
ID Test ROC-AUC: 0.9149
ID Test Loss: 0.5133
OOD Validation ROC-AUC: 0.6062
OOD Validation Loss: 0.7427
OOD Test ROC-AUC: 0.6845
OOD Test Loss: 1.0938

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ROC-AUC: 0.9089
Train Loss: 0.3173
ID Validation ROC-AUC: 0.8910
ID Validation Loss: 0.3404
ID Test ROC-AUC: 0.8888
ID Test Loss: 0.3479
OOD Validation ROC-AUC: 0.6543
OOD Validation Loss: 0.3422
OOD Test ROC-AUC: 0.6990
OOD Test Loss: 0.5882

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.6845 0.8888 0.6990 0.8910 0.6543[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 04:02:41 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:25.099458
Plausibility completed in  0:08:29.359349
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6361, device='cuda:0')  +-  tensor(0.0823, device='cuda:0') (0.051)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.583 +- 0.215
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.755 +- 0.122
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:24.698348
Plausibility completed in  0:08:26.112153
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9285, device='cuda:0')  +-  tensor(0.0369, device='cuda:0') (0.021)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.456 +- 0.280
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.893 +- 0.057
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:23:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 04:23:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 04:23:50 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:00 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ROC-AUC: 0.9658
Train Loss: 0.1509
ID Validation ROC-AUC: 0.9099
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.9129
ID Test Loss: 0.2578
OOD Validation ROC-AUC: 0.6398
OOD Validation Loss: 0.4377
OOD Test ROC-AUC: 0.6781
OOD Test Loss: 0.5882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.9221
Train Loss: 0.2152
ID Validation ROC-AUC: 0.8909
ID Validation Loss: 0.2509
ID Test ROC-AUC: 0.8972
ID Test Loss: 0.2480
OOD Validation ROC-AUC: 0.6624
OOD Validation Loss: 0.3222
OOD Test ROC-AUC: 0.7061
OOD Test Loss: 0.4680

[0m[1;37mINFO[0m: [1mChartInfo 0.9129 0.6781 0.8972 0.7061 0.8909 0.6624[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 04:24:41 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.840312
Plausibility completed in  0:08:22.701646
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5684, device='cuda:0')  +-  tensor(0.0585, device='cuda:0') (0.033)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.607 +- 0.219
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.770 +- 0.123
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.947714
Plausibility completed in  0:08:18.193928
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8939, device='cuda:0')  +-  tensor(0.0413, device='cuda:0') (0.018)
Original Stability MCC for r=0.6 = 0.998 +- 0.019
Intervened Stability MCC for r=0.6 = 0.506 +- 0.288
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.904 +- 0.055
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 04:44:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 04:44:47 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 04:45:17 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 04:45:27 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 04:45:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 04:45:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.9373
Train Loss: 0.1953
ID Validation ROC-AUC: 0.9097
ID Validation Loss: 0.2289
ID Test ROC-AUC: 0.9081
ID Test Loss: 0.2333
OOD Validation ROC-AUC: 0.6243
OOD Validation Loss: 0.3584
OOD Test ROC-AUC: 0.6758
OOD Test Loss: 0.4758

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ROC-AUC: 0.9088
Train Loss: 0.2311
ID Validation ROC-AUC: 0.8849
ID Validation Loss: 0.2505
ID Test ROC-AUC: 0.8879
ID Test Loss: 0.2510
OOD Validation ROC-AUC: 0.6619
OOD Validation Loss: 0.3260
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4346

[0m[1;37mINFO[0m: [1mChartInfo 0.9081 0.6758 0.8879 0.6983 0.8849 0.6619[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 04:46:07 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:24.082029
Plausibility completed in  0:08:20.686787
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4838, device='cuda:0')  +-  tensor(0.0469, device='cuda:0') (0.015)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.614 +- 0.214
Original Stability F1 for r=0.3 = 0.998 +- 0.013
Intervened Stability F1 for r=0.3 = 0.774 +- 0.120
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:23.426358
Plausibility completed in  0:08:17.439084
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8397, device='cuda:0')  +-  tensor(0.0514, device='cuda:0') (0.011)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.538 +- 0.287
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.911 +- 0.053
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:06:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:06:01 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:06:30 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:06:39 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:06:49 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:04 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ROC-AUC: 0.9662
Train Loss: 0.1724
ID Validation ROC-AUC: 0.9138
ID Validation Loss: 0.3123
ID Test ROC-AUC: 0.9111
ID Test Loss: 0.3263
OOD Validation ROC-AUC: 0.5895
OOD Validation Loss: 0.6025
OOD Test ROC-AUC: 0.6681
OOD Test Loss: 0.7747

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9269
Train Loss: 0.2093
ID Validation ROC-AUC: 0.8991
ID Validation Loss: 0.2421
ID Test ROC-AUC: 0.9021
ID Test Loss: 0.2424
OOD Validation ROC-AUC: 0.6642
OOD Validation Loss: 0.3339
OOD Test ROC-AUC: 0.6850
OOD Test Loss: 0.4826

[0m[1;37mINFO[0m: [1mChartInfo 0.9111 0.6681 0.9021 0.6850 0.8991 0.6642[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:07:19 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.594139
Plausibility completed in  0:08:19.509850
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5735, device='cuda:0')  +-  tensor(0.0557, device='cuda:0') (0.030)
Original Stability MCC for r=0.3 = 0.999 +- 0.014
Intervened Stability MCC for r=0.3 = 0.684 +- 0.212
Original Stability F1 for r=0.3 = 0.999 +- 0.009
Intervened Stability F1 for r=0.3 = 0.815 +- 0.118
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.865844
Plausibility completed in  0:08:14.920850
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8929, device='cuda:0')  +-  tensor(0.0391, device='cuda:0') (0.017)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.546 +- 0.294
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.914 +- 0.053
Num considered samples: 11314
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:27:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/21/2024 05:27:14 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/21/2024 05:27:44 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/21/2024 05:27:54 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:04 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:19 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.9661
Train Loss: 0.1473
ID Validation ROC-AUC: 0.9133
ID Validation Loss: 0.2363
ID Test ROC-AUC: 0.9109
ID Test Loss: 0.2418
OOD Validation ROC-AUC: 0.6302
OOD Validation Loss: 0.4522
OOD Test ROC-AUC: 0.6797
OOD Test Loss: 0.5703

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ROC-AUC: 0.9108
Train Loss: 0.2361
ID Validation ROC-AUC: 0.8892
ID Validation Loss: 0.2523
ID Test ROC-AUC: 0.8864
ID Test Loss: 0.2555
OOD Validation ROC-AUC: 0.6513
OOD Validation Loss: 0.3289
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.4218

[0m[1;37mINFO[0m: [1mChartInfo 0.9109 0.6797 0.8864 0.7073 0.8892 0.6513[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/21/2024 05:28:34 AM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:23.683093
Plausibility completed in  0:08:18.485497
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5577, device='cuda:0')  +-  tensor(0.0651, device='cuda:0') (0.042)
Original Stability MCC for r=0.3 = 0.998 +- 0.021
Intervened Stability MCC for r=0.3 = 0.465 +- 0.235
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.686 +- 0.133
Num considered samples: 11314


ratio=0.6


Interventions completed in  0:00:22.890742
Plausibility completed in  0:08:14.903711
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8886, device='cuda:0')  +-  tensor(0.0451, device='cuda:0') (0.019)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.380 +- 0.276
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.877 +- 0.059
Num considered samples: 11314

\FINISHED LBAPcore - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.43452922 0.75586541] +- [0.02314853 0.0303249 ] (mean across ratios: 0.60 +- 0.02)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.56389086 0.88870823] +- [0.04853524 0.02837342] (mean across ratios: 0.73 +- 0.03)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99867316 0.99924008] +- [0.00026639 0.00011733] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.75994704 0.89967302] +- [0.04220101 0.01354679] (mean across ratios: 0.83 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99806192 0.99800745] +- [0.00039082 0.00030859] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.59059404 0.48530811] +- [0.07128921 0.06137502] (mean across ratios: 0.54 +- 0.05)

Overall time of execution:  1:47:05.949139
DONE CIGA LBAPcore/assay 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:48:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:48:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 157...
[0m[1;37mINFO[0m: [1mCheckpoint 157: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0018
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.3380
ID Test ACCURACY: 0.9172
ID Test Loss: 0.3753
OOD Validation ACCURACY: 0.8775
OOD Validation Loss: 0.3681
OOD Test ACCURACY: 0.8031
OOD Test Loss: 0.5385

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0067
ID Validation ACCURACY: 0.9136
ID Validation Loss: 0.3073
ID Test ACCURACY: 0.9130
ID Test Loss: 0.3474
OOD Validation ACCURACY: 0.8809
OOD Validation Loss: 0.3430
OOD Test ACCURACY: 0.8340
OOD Test Loss: 0.4255

[0m[1;37mINFO[0m: [1mChartInfo 0.9172 0.8031 0.9130 0.8340 0.9136 0.8809[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:48:49 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.433163
Plausibility completed in  0:00:15.958851
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1532, device='cuda:0')  +-  tensor(0.3065, device='cuda:0') (0.034)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.553 +- 0.630
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.803 +- 0.277
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.329647
Plausibility completed in  0:00:15.710914
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1958, device='cuda:0')  +-  tensor(0.3811, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.313 +- 0.552
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.930 +- 0.126
Num considered samples: 1889
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:49:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0038
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.3551
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4267
OOD Validation ACCURACY: 0.8753
OOD Validation Loss: 0.3988
OOD Test ACCURACY: 0.7891
OOD Test Loss: 0.6170

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.9191
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.9140
ID Test Loss: 0.4797
OOD Validation ACCURACY: 0.8836
OOD Validation Loss: 0.4121
OOD Test ACCURACY: 0.8148
OOD Test Loss: 0.5531

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.7891 0.9140 0.8148 0.9191 0.8836[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:49:39 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.160513
Plausibility completed in  0:00:15.901548
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2021, device='cuda:0')  +-  tensor(0.3494, device='cuda:0') (0.051)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.576 +- 0.600
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.812 +- 0.262
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.313212
Plausibility completed in  0:00:15.479078
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2270, device='cuda:0')  +-  tensor(0.3974, device='cuda:0') (0.018)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.354 +- 0.554
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.939 +- 0.120
Num considered samples: 1892
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:50:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 164...
[0m[1;37mINFO[0m: [1mCheckpoint 164: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0007
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4352
ID Test ACCURACY: 0.9164
ID Test Loss: 0.4480
OOD Validation ACCURACY: 0.8825
OOD Validation Loss: 0.4191
OOD Test ACCURACY: 0.8136
OOD Test Loss: 0.5985

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0007
ID Validation ACCURACY: 0.9161
ID Validation Loss: 0.4185
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4294
OOD Validation ACCURACY: 0.8842
OOD Validation Loss: 0.3814
OOD Test ACCURACY: 0.8224
OOD Test Loss: 0.5053

[0m[1;37mINFO[0m: [1mChartInfo 0.9164 0.8136 0.9178 0.8224 0.9161 0.8842[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:50:28 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.148005
Plausibility completed in  0:00:15.829319
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1999, device='cuda:0')  +-  tensor(0.3223, device='cuda:0') (0.050)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.571 +- 0.611
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.806 +- 0.274
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.293444
Plausibility completed in  0:00:15.512629
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2750, device='cuda:0')  +-  tensor(0.4226, device='cuda:0') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.343 +- 0.554
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.937 +- 0.121
Num considered samples: 1894
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:51:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9987
Train Loss: 0.0071
ID Validation ACCURACY: 0.9149
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9098
ID Test Loss: 0.3559
OOD Validation ACCURACY: 0.8657
OOD Validation Loss: 0.3762
OOD Test ACCURACY: 0.7989
OOD Test Loss: 0.5418

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0052
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.3513
ID Test ACCURACY: 0.9119
ID Test Loss: 0.3779
OOD Validation ACCURACY: 0.8795
OOD Validation Loss: 0.3487
OOD Test ACCURACY: 0.8314
OOD Test Loss: 0.4254

[0m[1;37mINFO[0m: [1mChartInfo 0.9098 0.7989 0.9119 0.8314 0.9110 0.8795[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:51:17 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.353203
Plausibility completed in  0:00:15.846734
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2420, device='cuda:0')  +-  tensor(0.3528, device='cuda:0') (0.041)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.626 +- 0.583
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.830 +- 0.262
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.087768
Plausibility completed in  0:00:15.733371
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3140, device='cuda:0')  +-  tensor(0.4440, device='cuda:0') (0.013)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.369 +- 0.556
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.942 +- 0.119
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:52:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:52:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9153
ID Validation Loss: 0.4322
ID Test ACCURACY: 0.9144
ID Test Loss: 0.5002
OOD Validation ACCURACY: 0.8788
OOD Validation Loss: 0.4087
OOD Test ACCURACY: 0.8256
OOD Test Loss: 0.4929

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9997
Train Loss: 0.0030
ID Validation ACCURACY: 0.9117
ID Validation Loss: 0.3966
ID Test ACCURACY: 0.9117
ID Test Loss: 0.4474
OOD Validation ACCURACY: 0.8814
OOD Validation Loss: 0.3906
OOD Test ACCURACY: 0.8333
OOD Test Loss: 0.4454

[0m[1;37mINFO[0m: [1mChartInfo 0.9144 0.8256 0.9117 0.8333 0.9117 0.8814[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:52:07 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.345599
Plausibility completed in  0:00:15.651114
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1146, device='cuda:0')  +-  tensor(0.2661, device='cuda:0') (0.025)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.638 +- 0.568
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.835 +- 0.253
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.282223
Plausibility completed in  0:00:15.737501
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1537, device='cuda:0')  +-  tensor(0.3457, device='cuda:0') (0.011)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.357 +- 0.555
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.939 +- 0.120
Num considered samples: 1895

\FINISHED GOODSST2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.48423714 0.63995867] +- [0.1354644  0.16132735] (mean across ratios: 0.56 +- 0.11)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.18234252 0.23307804] +- [0.04403766 0.05660791] (mean across ratios: 0.21 +- 0.04)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999936] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.81729677 0.93743343] +- [0.01293299 0.00383697] (mean across ratios: 0.88 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.59269083 0.34720656] +- [0.03297382 0.01910108] (mean across ratios: 0.47 +- 0.02)

Overall time of execution:  0:04:09.741291
DONE LECI GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:53:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:53:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 157...
[0m[1;37mINFO[0m: [1mCheckpoint 157: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0018
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.3380
ID Test ACCURACY: 0.9172
ID Test Loss: 0.3753
OOD Validation ACCURACY: 0.8775
OOD Validation Loss: 0.3681
OOD Test ACCURACY: 0.8031
OOD Test Loss: 0.5385

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0067
ID Validation ACCURACY: 0.9136
ID Validation Loss: 0.3073
ID Test ACCURACY: 0.9130
ID Test Loss: 0.3474
OOD Validation ACCURACY: 0.8809
OOD Validation Loss: 0.3430
OOD Test ACCURACY: 0.8340
OOD Test Loss: 0.4255

[0m[1;37mINFO[0m: [1mChartInfo 0.9172 0.8031 0.9130 0.8340 0.9136 0.8809[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:53:16 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.483010
Plausibility completed in  0:00:16.204032
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1532, device='cuda:0')  +-  tensor(0.3065, device='cuda:0') (0.034)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.553 +- 0.630
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.803 +- 0.277
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.372667
Plausibility completed in  0:00:15.978230
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1958, device='cuda:0')  +-  tensor(0.3811, device='cuda:0') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.313 +- 0.552
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.930 +- 0.126
Num considered samples: 1889
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:54:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0038
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.3551
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4267
OOD Validation ACCURACY: 0.8753
OOD Validation Loss: 0.3988
OOD Test ACCURACY: 0.7891
OOD Test Loss: 0.6170

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.9191
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.9140
ID Test Loss: 0.4797
OOD Validation ACCURACY: 0.8836
OOD Validation Loss: 0.4121
OOD Test ACCURACY: 0.8148
OOD Test Loss: 0.5531

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.7891 0.9140 0.8148 0.9191 0.8836[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:54:07 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.157133
Plausibility completed in  0:00:16.222682
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2021, device='cuda:0')  +-  tensor(0.3494, device='cuda:0') (0.051)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.576 +- 0.600
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.812 +- 0.262
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.344025
Plausibility completed in  0:00:15.787670
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2270, device='cuda:0')  +-  tensor(0.3974, device='cuda:0') (0.018)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.354 +- 0.554
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.939 +- 0.120
Num considered samples: 1892
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:54:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:54:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 164...
[0m[1;37mINFO[0m: [1mCheckpoint 164: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0007
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4352
ID Test ACCURACY: 0.9164
ID Test Loss: 0.4480
OOD Validation ACCURACY: 0.8825
OOD Validation Loss: 0.4191
OOD Test ACCURACY: 0.8136
OOD Test Loss: 0.5985

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0007
ID Validation ACCURACY: 0.9161
ID Validation Loss: 0.4185
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4294
OOD Validation ACCURACY: 0.8842
OOD Validation Loss: 0.3814
OOD Test ACCURACY: 0.8224
OOD Test Loss: 0.5053

[0m[1;37mINFO[0m: [1mChartInfo 0.9164 0.8136 0.9178 0.8224 0.9161 0.8842[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:54:57 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.204217
Plausibility completed in  0:00:16.172837
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1999, device='cuda:0')  +-  tensor(0.3223, device='cuda:0') (0.050)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.571 +- 0.611
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.806 +- 0.274
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.355268
Plausibility completed in  0:00:15.835338
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2750, device='cuda:0')  +-  tensor(0.4226, device='cuda:0') (0.019)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.343 +- 0.554
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.937 +- 0.121
Num considered samples: 1894
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:55:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9987
Train Loss: 0.0071
ID Validation ACCURACY: 0.9149
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9098
ID Test Loss: 0.3559
OOD Validation ACCURACY: 0.8657
OOD Validation Loss: 0.3762
OOD Test ACCURACY: 0.7989
OOD Test Loss: 0.5418

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0052
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.3513
ID Test ACCURACY: 0.9119
ID Test Loss: 0.3779
OOD Validation ACCURACY: 0.8795
OOD Validation Loss: 0.3487
OOD Test ACCURACY: 0.8314
OOD Test Loss: 0.4254

[0m[1;37mINFO[0m: [1mChartInfo 0.9098 0.7989 0.9119 0.8314 0.9110 0.8795[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:55:47 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.395606
Plausibility completed in  0:00:16.157913
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2420, device='cuda:0')  +-  tensor(0.3528, device='cuda:0') (0.041)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.626 +- 0.583
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.830 +- 0.262
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.141262
Plausibility completed in  0:00:16.086179
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3140, device='cuda:0')  +-  tensor(0.4440, device='cuda:0') (0.013)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.369 +- 0.556
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.942 +- 0.119
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:56:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:56:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9153
ID Validation Loss: 0.4322
ID Test ACCURACY: 0.9144
ID Test Loss: 0.5002
OOD Validation ACCURACY: 0.8788
OOD Validation Loss: 0.4087
OOD Test ACCURACY: 0.8256
OOD Test Loss: 0.4929

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9997
Train Loss: 0.0030
ID Validation ACCURACY: 0.9117
ID Validation Loss: 0.3966
ID Test ACCURACY: 0.9117
ID Test Loss: 0.4474
OOD Validation ACCURACY: 0.8814
OOD Validation Loss: 0.3906
OOD Test ACCURACY: 0.8333
OOD Test Loss: 0.4454

[0m[1;37mINFO[0m: [1mChartInfo 0.9144 0.8256 0.9117 0.8333 0.9117 0.8814[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:56:38 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.406843
Plausibility completed in  0:00:15.990845
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1146, device='cuda:0')  +-  tensor(0.2661, device='cuda:0') (0.025)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.638 +- 0.568
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.835 +- 0.253
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.355973
Plausibility completed in  0:00:16.096460
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1537, device='cuda:0')  +-  tensor(0.3457, device='cuda:0') (0.011)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.357 +- 0.555
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.939 +- 0.120
Num considered samples: 1895

\FINISHED GOODSST2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.48423714 0.63995867] +- [0.1354644  0.16132735] (mean across ratios: 0.56 +- 0.11)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.18234252 0.23307804] +- [0.04403766 0.05660791] (mean across ratios: 0.21 +- 0.04)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999936] +- [0.00000000e+00 2.38418579e-08] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.81729677 0.93743343] +- [0.01293299 0.00383697] (mean across ratios: 0.88 +- 0.01)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.59269083 0.34720656] +- [0.03297382 0.01910108] (mean across ratios: 0.47 +- 0.02)

Overall time of execution:  0:04:15.773130
DONE LECI GOODSST2/length 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:57:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 05:57:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9108
ID Validation Loss: 0.6777
ID Test ACCURACY: 0.9070
ID Test Loss: 0.7678
OOD Validation ACCURACY: 0.8696
OOD Validation Loss: 0.8953
OOD Test ACCURACY: 0.8189
OOD Test Loss: 1.1731

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.6426
ID Test ACCURACY: 0.9093
ID Test Loss: 0.7163
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.8695
OOD Test ACCURACY: 0.8171
OOD Test Loss: 1.1992

[0m[1;37mINFO[0m: [1mChartInfo 0.9070 0.8189 0.9093 0.8171 0.9085 0.8700[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:57:49 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.613927
Plausibility completed in  0:00:16.424829
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.186 +- 0.551
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.586 +- 0.298
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.238021
Plausibility completed in  0:00:16.098682
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.086 +- 0.406
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.877 +- 0.145
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:58:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:58:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 05:58:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.6509
ID Test ACCURACY: 0.9106
ID Test Loss: 0.7601
OOD Validation ACCURACY: 0.8655
OOD Validation Loss: 0.9153
OOD Test ACCURACY: 0.8004
OOD Test Loss: 1.3538

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9081
ID Validation Loss: 0.6904
ID Test ACCURACY: 0.9102
ID Test Loss: 0.8084
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 1.0019
OOD Test ACCURACY: 0.8170
OOD Test Loss: 1.3197

[0m[1;37mINFO[0m: [1mChartInfo 0.9106 0.8004 0.9102 0.8170 0.9081 0.8689[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:58:41 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.453364
Plausibility completed in  0:00:16.278072
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.171 +- 0.574
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.583 +- 0.305
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.429813
Plausibility completed in  0:00:15.843966
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.093 +- 0.419
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.876 +- 0.150
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 05:59:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0003
ID Validation ACCURACY: 0.9083
ID Validation Loss: 0.6573
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7687
OOD Validation ACCURACY: 0.8624
OOD Validation Loss: 0.9332
OOD Test ACCURACY: 0.7946
OOD Test Loss: 1.4098

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9986
Train Loss: 0.0061
ID Validation ACCURACY: 0.9002
ID Validation Loss: 0.5441
ID Test ACCURACY: 0.9019
ID Test Loss: 0.6312
OOD Validation ACCURACY: 0.8690
OOD Validation Loss: 0.7354
OOD Test ACCURACY: 0.8188
OOD Test Loss: 0.9821

[0m[1;37mINFO[0m: [1mChartInfo 0.9010 0.7946 0.9019 0.8188 0.9002 0.8690[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 05:59:32 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.289604
Plausibility completed in  0:00:16.200131
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.168 +- 0.557
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.588 +- 0.299
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.427998
Plausibility completed in  0:00:15.852170
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.086 +- 0.411
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.877 +- 0.147
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:00:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9123
ID Validation Loss: 0.7334
ID Test ACCURACY: 0.9047
ID Test Loss: 0.8153
OOD Validation ACCURACY: 0.8584
OOD Validation Loss: 1.0858
OOD Test ACCURACY: 0.8021
OOD Test Loss: 1.6001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9091
ID Validation Loss: 0.7365
ID Test ACCURACY: 0.9076
ID Test Loss: 0.8317
OOD Validation ACCURACY: 0.8656
OOD Validation Loss: 1.0826
OOD Test ACCURACY: 0.8208
OOD Test Loss: 1.3300

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8021 0.9076 0.8208 0.9091 0.8656[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:00:23 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.289984
Plausibility completed in  0:00:16.118053
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.133 +- 0.556
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.572 +- 0.303
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.403531
Plausibility completed in  0:00:16.085985
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.055 +- 0.398
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.868 +- 0.153
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:01:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0002
ID Validation ACCURACY: 0.9125
ID Validation Loss: 0.6781
ID Test ACCURACY: 0.9078
ID Test Loss: 0.7621
OOD Validation ACCURACY: 0.8649
OOD Validation Loss: 0.8836
OOD Test ACCURACY: 0.8196
OOD Test Loss: 1.0439

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9983
Train Loss: 0.0070
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.4896
ID Test ACCURACY: 0.9053
ID Test Loss: 0.5898
OOD Validation ACCURACY: 0.8681
OOD Validation Loss: 0.7049
OOD Test ACCURACY: 0.8276
OOD Test Loss: 0.8462

[0m[1;37mINFO[0m: [1mChartInfo 0.9078 0.8196 0.9053 0.8276 0.9044 0.8681[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:01:14 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.321602
Plausibility completed in  0:00:16.208785
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.136 +- 0.560
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.573 +- 0.298
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.431746
Plausibility completed in  0:00:15.908837
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4171, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.097 +- 0.413
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.880 +- 0.143
Num considered samples: 1895

\FINISHED GOODSST2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33895155 0.63041391] +- [6.12651855e-05 7.42181528e-05] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.19028081 0.30717356] +- [4.02763805e-06 3.39157238e-06] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999934] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.58042935 0.87571372] +- [0.00659362 0.00383657] (mean across ratios: 0.73 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15900165 0.0830333 ] +- [0.02086601 0.01482196] (mean across ratios: 0.12 +- 0.01)

Overall time of execution:  0:04:18.539954
DONE GSAT GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:02:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:02:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9108
ID Validation Loss: 0.6777
ID Test ACCURACY: 0.9070
ID Test Loss: 0.7678
OOD Validation ACCURACY: 0.8696
OOD Validation Loss: 0.8953
OOD Test ACCURACY: 0.8189
OOD Test Loss: 1.1731

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9085
ID Validation Loss: 0.6426
ID Test ACCURACY: 0.9093
ID Test Loss: 0.7163
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.8695
OOD Test ACCURACY: 0.8171
OOD Test Loss: 1.1992

[0m[1;37mINFO[0m: [1mChartInfo 0.9070 0.8189 0.9093 0.8171 0.9085 0.8700[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:02:25 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.526417
Plausibility completed in  0:00:16.342624
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.186 +- 0.551
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.586 +- 0.298
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.186332
Plausibility completed in  0:00:16.154832
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.086 +- 0.406
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.877 +- 0.145
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:03:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9106
ID Validation Loss: 0.6509
ID Test ACCURACY: 0.9106
ID Test Loss: 0.7601
OOD Validation ACCURACY: 0.8655
OOD Validation Loss: 0.9153
OOD Test ACCURACY: 0.8004
OOD Test Loss: 1.3538

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9081
ID Validation Loss: 0.6904
ID Test ACCURACY: 0.9102
ID Test Loss: 0.8084
OOD Validation ACCURACY: 0.8689
OOD Validation Loss: 1.0019
OOD Test ACCURACY: 0.8170
OOD Test Loss: 1.3197

[0m[1;37mINFO[0m: [1mChartInfo 0.9106 0.8004 0.9102 0.8170 0.9081 0.8689[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:03:16 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.399379
Plausibility completed in  0:00:16.314640
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.171 +- 0.574
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.583 +- 0.305
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.377868
Plausibility completed in  0:00:15.896410
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.093 +- 0.419
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.876 +- 0.150
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:04:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0003
ID Validation ACCURACY: 0.9083
ID Validation Loss: 0.6573
ID Test ACCURACY: 0.9010
ID Test Loss: 0.7687
OOD Validation ACCURACY: 0.8624
OOD Validation Loss: 0.9332
OOD Test ACCURACY: 0.7946
OOD Test Loss: 1.4098

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9986
Train Loss: 0.0061
ID Validation ACCURACY: 0.9002
ID Validation Loss: 0.5441
ID Test ACCURACY: 0.9019
ID Test Loss: 0.6312
OOD Validation ACCURACY: 0.8690
OOD Validation Loss: 0.7354
OOD Test ACCURACY: 0.8188
OOD Test Loss: 0.9821

[0m[1;37mINFO[0m: [1mChartInfo 0.9010 0.7946 0.9019 0.8188 0.9002 0.8690[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:04:07 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.212079
Plausibility completed in  0:00:16.242010
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.168 +- 0.557
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.588 +- 0.299
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.367501
Plausibility completed in  0:00:15.926231
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.086 +- 0.411
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.877 +- 0.147
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:04:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9123
ID Validation Loss: 0.7334
ID Test ACCURACY: 0.9047
ID Test Loss: 0.8153
OOD Validation ACCURACY: 0.8584
OOD Validation Loss: 1.0858
OOD Test ACCURACY: 0.8021
OOD Test Loss: 1.6001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9091
ID Validation Loss: 0.7365
ID Test ACCURACY: 0.9076
ID Test Loss: 0.8317
OOD Validation ACCURACY: 0.8656
OOD Validation Loss: 1.0826
OOD Test ACCURACY: 0.8208
OOD Test Loss: 1.3300

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8021 0.9076 0.8208 0.9091 0.8656[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:04:57 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.237440
Plausibility completed in  0:00:16.267072
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.133 +- 0.556
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.572 +- 0.303
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.373748
Plausibility completed in  0:00:16.176880
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4170, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.055 +- 0.398
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.868 +- 0.153
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:05:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:05:47 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/21/2024 06:05:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 179...
[0m[1;37mINFO[0m: [1mCheckpoint 179: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0002
ID Validation ACCURACY: 0.9125
ID Validation Loss: 0.6781
ID Test ACCURACY: 0.9078
ID Test Loss: 0.7621
OOD Validation ACCURACY: 0.8649
OOD Validation Loss: 0.8836
OOD Test ACCURACY: 0.8196
OOD Test Loss: 1.0439

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9983
Train Loss: 0.0070
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.4896
ID Test ACCURACY: 0.9053
ID Test Loss: 0.5898
OOD Validation ACCURACY: 0.8681
OOD Validation Loss: 0.7049
OOD Test ACCURACY: 0.8276
OOD Test Loss: 0.8462

[0m[1;37mINFO[0m: [1mChartInfo 0.9078 0.8196 0.9053 0.8276 0.9044 0.8681[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:05:48 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.255465
Plausibility completed in  0:00:16.262221
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1903, device='cuda:0')  +-  tensor(0.2636, device='cuda:0') (0.000)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.136 +- 0.560
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.573 +- 0.298
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.382871
Plausibility completed in  0:00:15.939047
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3072, device='cuda:0')  +-  tensor(0.4171, device='cuda:0') (0.000)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.097 +- 0.413
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.880 +- 0.143
Num considered samples: 1895

\FINISHED GOODSST2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33895155 0.63041391] +- [6.12651855e-05 7.42181528e-05] (mean across ratios: 0.48 +- 0.00)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.19028082 0.30717356] +- [4.01893572e-06 3.39157238e-06] (mean across ratios: 0.25 +- 0.00)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99999934] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.58042935 0.87571372] +- [0.00659362 0.00383657] (mean across ratios: 0.73 +- 0.00)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[1. 1.] +- [0. 0.] (mean across ratios: 1.00 +- 0.00)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15900165 0.0830333 ] +- [0.02086601 0.01482196] (mean across ratios: 0.12 +- 0.01)

Overall time of execution:  0:04:15.536497
DONE GSAT GOODSST2/length 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:06:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:06:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0753
ID Validation ACCURACY: 0.8595
ID Validation Loss: 0.7797
ID Test ACCURACY: 0.8602
ID Test Loss: 0.8691
OOD Validation ACCURACY: 0.8551
OOD Validation Loss: 1.0470
OOD Test ACCURACY: 0.8144
OOD Test Loss: 1.2121

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9463
Train Loss: 0.0867
ID Validation ACCURACY: 0.8510
ID Validation Loss: 0.5780
ID Test ACCURACY: 0.8459
ID Test Loss: 0.6869
OOD Validation ACCURACY: 0.8562
OOD Validation Loss: 0.6896
OOD Test ACCURACY: 0.8071
OOD Test Loss: 0.8209

[0m[1;37mINFO[0m: [1mChartInfo 0.8602 0.8144 0.8459 0.8071 0.8510 0.8562[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:06:58 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.569308
Plausibility completed in  0:00:15.996068
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2503, device='cuda:0')  +-  tensor(0.3667, device='cuda:0') (0.032)
Original Stability MCC for r=0.3 = 0.794 +- 0.444
Intervened Stability MCC for r=0.3 = 0.642 +- 0.555
Original Stability F1 for r=0.3 = 0.886 +- 0.241
Intervened Stability F1 for r=0.3 = 0.840 +- 0.247
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.428150
Plausibility completed in  0:00:15.601104
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:0')  +-  tensor(0.4438, device='cuda:0') (0.009)
Original Stability MCC for r=0.6 = 0.860 +- 0.363
Intervened Stability MCC for r=0.6 = 0.413 +- 0.536
Original Stability F1 for r=0.6 = 0.962 +- 0.102
Intervened Stability F1 for r=0.6 = 0.958 +- 0.097
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:07:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:07:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8589
ID Validation Loss: 1.0551
ID Test ACCURACY: 0.8568
ID Test Loss: 1.1414
OOD Validation ACCURACY: 0.8585
OOD Validation Loss: 1.4193
OOD Test ACCURACY: 0.8148
OOD Test Loss: 1.5478

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8589
ID Validation Loss: 1.0551
ID Test ACCURACY: 0.8568
ID Test Loss: 1.1414
OOD Validation ACCURACY: 0.8585
OOD Validation Loss: 1.4193
OOD Test ACCURACY: 0.8148
OOD Test Loss: 1.5478

[0m[1;37mINFO[0m: [1mChartInfo 0.8568 0.8148 0.8568 0.8148 0.8589 0.8585[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:07:49 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.437830
Plausibility completed in  0:00:15.917200
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2604, device='cuda:0')  +-  tensor(0.3692, device='cuda:0') (0.026)
Original Stability MCC for r=0.3 = 0.896 +- 0.314
Intervened Stability MCC for r=0.3 = 0.731 +- 0.498
Original Stability F1 for r=0.3 = 0.943 +- 0.172
Intervened Stability F1 for r=0.3 = 0.878 +- 0.223
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.398220
Plausibility completed in  0:00:15.914186
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3309, device='cuda:0')  +-  tensor(0.4483, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.947 +- 0.222
Intervened Stability MCC for r=0.6 = 0.459 +- 0.538
Original Stability F1 for r=0.6 = 0.986 +- 0.060
Intervened Stability F1 for r=0.6 = 0.965 +- 0.093
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:08:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9486
Train Loss: 0.0789
ID Validation ACCURACY: 0.8576
ID Validation Loss: 0.6405
ID Test ACCURACY: 0.8581
ID Test Loss: 0.6827
OOD Validation ACCURACY: 0.8483
OOD Validation Loss: 0.8788
OOD Test ACCURACY: 0.7888
OOD Test Loss: 1.2864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.9444
Train Loss: 0.0955
ID Validation ACCURACY: 0.8453
ID Validation Loss: 0.4763
ID Test ACCURACY: 0.8466
ID Test Loss: 0.5186
OOD Validation ACCURACY: 0.8569
OOD Validation Loss: 0.5734
OOD Test ACCURACY: 0.7985
OOD Test Loss: 0.8428

[0m[1;37mINFO[0m: [1mChartInfo 0.8581 0.7888 0.8466 0.7985 0.8453 0.8569[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:08:39 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.434458
Plausibility completed in  0:00:15.779688
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2362, device='cuda:0')  +-  tensor(0.3378, device='cuda:0') (0.017)
Original Stability MCC for r=0.3 = 0.998 +- 0.046
Intervened Stability MCC for r=0.3 = 0.724 +- 0.509
Original Stability F1 for r=0.3 = 0.999 +- 0.026
Intervened Stability F1 for r=0.3 = 0.872 +- 0.231
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.395264
Plausibility completed in  0:00:15.900872
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3234, device='cuda:0')  +-  tensor(0.4390, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.444 +- 0.548
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.959 +- 0.103
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:09:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8555
ID Validation Loss: 1.0889
ID Test ACCURACY: 0.8591
ID Test Loss: 1.1779
OOD Validation ACCURACY: 0.8291
OOD Validation Loss: 1.8486
OOD Test ACCURACY: 0.7282
OOD Test Loss: 3.5316

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9418
Train Loss: 0.0951
ID Validation ACCURACY: 0.8398
ID Validation Loss: 0.7123
ID Test ACCURACY: 0.8421
ID Test Loss: 0.8161
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.8140
OOD Test ACCURACY: 0.8226
OOD Test Loss: 0.9192

[0m[1;37mINFO[0m: [1mChartInfo 0.8591 0.7282 0.8421 0.8226 0.8398 0.8581[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:09:29 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.274766
Plausibility completed in  0:00:16.163185
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2226, device='cuda:0')  +-  tensor(0.3329, device='cuda:0') (0.026)
Original Stability MCC for r=0.3 = 0.557 +- 0.581
Intervened Stability MCC for r=0.3 = 0.506 +- 0.614
Original Stability F1 for r=0.3 = 0.759 +- 0.315
Intervened Stability F1 for r=0.3 = 0.784 +- 0.272
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.190683
Plausibility completed in  0:00:15.877205
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3040, device='cuda:0')  +-  tensor(0.4313, device='cuda:0') (0.009)
Original Stability MCC for r=0.6 = 0.670 +- 0.508
Intervened Stability MCC for r=0.6 = 0.358 +- 0.518
Original Stability F1 for r=0.6 = 0.914 +- 0.138
Intervened Stability F1 for r=0.6 = 0.953 +- 0.094
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:10:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.9380
ID Test ACCURACY: 0.8612
ID Test Loss: 1.0013
OOD Validation ACCURACY: 0.8654
OOD Validation Loss: 1.0363
OOD Test ACCURACY: 0.8221
OOD Test Loss: 1.1633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.9380
ID Test ACCURACY: 0.8612
ID Test Loss: 1.0013
OOD Validation ACCURACY: 0.8654
OOD Validation Loss: 1.0363
OOD Test ACCURACY: 0.8221
OOD Test Loss: 1.1633

[0m[1;37mINFO[0m: [1mChartInfo 0.8612 0.8221 0.8612 0.8221 0.8600 0.8654[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:10:19 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.453146
Plausibility completed in  0:00:15.937689
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2389, device='cuda:0')  +-  tensor(0.3319, device='cuda:0') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.716 +- 0.518
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.866 +- 0.240
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.293485
Plausibility completed in  0:00:15.871151
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3269, device='cuda:0')  +-  tensor(0.4411, device='cuda:0') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.433 +- 0.549
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.957 +- 0.104
Num considered samples: 1895

\FINISHED GOODSST2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.5436461  0.75238438] +- [0.05623202 0.05915697] (mean across ratios: 0.65 +- 0.04)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.24170945 0.32119072] +- [0.01284833 0.00924996] (mean across ratios: 0.28 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.91725879 0.97225832] +- [0.08970439 0.03239817] (mean across ratios: 0.94 +- 0.05)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.84812667 0.95835308] +- [0.03453246 0.00381462] (mean across ratios: 0.90 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.84897668 0.89528898] +- [0.16443108 0.12393913] (mean across ratios: 0.87 +- 0.10)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.66379135 0.42130865] +- [0.0849849  0.03512956] (mean across ratios: 0.54 +- 0.05)

Overall time of execution:  0:04:15.462443
DONE CIGA GOODSST2/length 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:11:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:11:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0753
ID Validation ACCURACY: 0.8595
ID Validation Loss: 0.7797
ID Test ACCURACY: 0.8602
ID Test Loss: 0.8691
OOD Validation ACCURACY: 0.8551
OOD Validation Loss: 1.0470
OOD Test ACCURACY: 0.8144
OOD Test Loss: 1.2121

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9463
Train Loss: 0.0867
ID Validation ACCURACY: 0.8510
ID Validation Loss: 0.5780
ID Test ACCURACY: 0.8459
ID Test Loss: 0.6869
OOD Validation ACCURACY: 0.8562
OOD Validation Loss: 0.6896
OOD Test ACCURACY: 0.8071
OOD Test Loss: 0.8209

[0m[1;37mINFO[0m: [1mChartInfo 0.8602 0.8144 0.8459 0.8071 0.8510 0.8562[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:11:31 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.512684
Plausibility completed in  0:00:15.966150
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2503, device='cuda:0')  +-  tensor(0.3667, device='cuda:0') (0.032)
Original Stability MCC for r=0.3 = 0.794 +- 0.444
Intervened Stability MCC for r=0.3 = 0.642 +- 0.555
Original Stability F1 for r=0.3 = 0.886 +- 0.241
Intervened Stability F1 for r=0.3 = 0.840 +- 0.247
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.376553
Plausibility completed in  0:00:15.566812
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:0')  +-  tensor(0.4438, device='cuda:0') (0.009)
Original Stability MCC for r=0.6 = 0.860 +- 0.363
Intervened Stability MCC for r=0.6 = 0.413 +- 0.536
Original Stability F1 for r=0.6 = 0.962 +- 0.102
Intervened Stability F1 for r=0.6 = 0.958 +- 0.097
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:12:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8589
ID Validation Loss: 1.0551
ID Test ACCURACY: 0.8568
ID Test Loss: 1.1414
OOD Validation ACCURACY: 0.8585
OOD Validation Loss: 1.4193
OOD Test ACCURACY: 0.8148
OOD Test Loss: 1.5478

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8589
ID Validation Loss: 1.0551
ID Test ACCURACY: 0.8568
ID Test Loss: 1.1414
OOD Validation ACCURACY: 0.8585
OOD Validation Loss: 1.4193
OOD Test ACCURACY: 0.8148
OOD Test Loss: 1.5478

[0m[1;37mINFO[0m: [1mChartInfo 0.8568 0.8148 0.8568 0.8148 0.8589 0.8585[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:12:22 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.213267
Plausibility completed in  0:00:16.031086
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2604, device='cuda:0')  +-  tensor(0.3692, device='cuda:0') (0.026)
Original Stability MCC for r=0.3 = 0.896 +- 0.314
Intervened Stability MCC for r=0.3 = 0.731 +- 0.498
Original Stability F1 for r=0.3 = 0.943 +- 0.172
Intervened Stability F1 for r=0.3 = 0.878 +- 0.223
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.375239
Plausibility completed in  0:00:15.799029
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3309, device='cuda:0')  +-  tensor(0.4483, device='cuda:0') (0.006)
Original Stability MCC for r=0.6 = 0.947 +- 0.222
Intervened Stability MCC for r=0.6 = 0.459 +- 0.538
Original Stability F1 for r=0.6 = 0.986 +- 0.060
Intervened Stability F1 for r=0.6 = 0.965 +- 0.093
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:13:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ACCURACY: 0.9486
Train Loss: 0.0789
ID Validation ACCURACY: 0.8576
ID Validation Loss: 0.6405
ID Test ACCURACY: 0.8581
ID Test Loss: 0.6827
OOD Validation ACCURACY: 0.8483
OOD Validation Loss: 0.8788
OOD Test ACCURACY: 0.7888
OOD Test Loss: 1.2864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.9444
Train Loss: 0.0955
ID Validation ACCURACY: 0.8453
ID Validation Loss: 0.4763
ID Test ACCURACY: 0.8466
ID Test Loss: 0.5186
OOD Validation ACCURACY: 0.8569
OOD Validation Loss: 0.5734
OOD Test ACCURACY: 0.7985
OOD Test Loss: 0.8428

[0m[1;37mINFO[0m: [1mChartInfo 0.8581 0.7888 0.8466 0.7985 0.8453 0.8569[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:13:11 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.192496
Plausibility completed in  0:00:15.953124
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2362, device='cuda:0')  +-  tensor(0.3378, device='cuda:0') (0.017)
Original Stability MCC for r=0.3 = 0.998 +- 0.046
Intervened Stability MCC for r=0.3 = 0.724 +- 0.509
Original Stability F1 for r=0.3 = 0.999 +- 0.026
Intervened Stability F1 for r=0.3 = 0.872 +- 0.231
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.335074
Plausibility completed in  0:00:15.854587
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3234, device='cuda:0')  +-  tensor(0.4390, device='cuda:0') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.444 +- 0.548
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.959 +- 0.103
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:14:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8555
ID Validation Loss: 1.0889
ID Test ACCURACY: 0.8591
ID Test Loss: 1.1779
OOD Validation ACCURACY: 0.8291
OOD Validation Loss: 1.8486
OOD Test ACCURACY: 0.7282
OOD Test Loss: 3.5316

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9418
Train Loss: 0.0951
ID Validation ACCURACY: 0.8398
ID Validation Loss: 0.7123
ID Test ACCURACY: 0.8421
ID Test Loss: 0.8161
OOD Validation ACCURACY: 0.8581
OOD Validation Loss: 0.8140
OOD Test ACCURACY: 0.8226
OOD Test Loss: 0.9192

[0m[1;37mINFO[0m: [1mChartInfo 0.8591 0.7282 0.8421 0.8226 0.8398 0.8581[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:14:01 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.612562
Plausibility completed in  0:00:15.706686
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2226, device='cuda:0')  +-  tensor(0.3329, device='cuda:0') (0.026)
Original Stability MCC for r=0.3 = 0.557 +- 0.581
Intervened Stability MCC for r=0.3 = 0.506 +- 0.614
Original Stability F1 for r=0.3 = 0.759 +- 0.315
Intervened Stability F1 for r=0.3 = 0.784 +- 0.272
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.351131
Plausibility completed in  0:00:15.839851
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3040, device='cuda:0')  +-  tensor(0.4313, device='cuda:0') (0.009)
Original Stability MCC for r=0.6 = 0.670 +- 0.508
Intervened Stability MCC for r=0.6 = 0.358 +- 0.518
Original Stability F1 for r=0.6 = 0.914 +- 0.138
Intervened Stability F1 for r=0.6 = 0.953 +- 0.094
Num considered samples: 1895
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Sep 21 06:14:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.9380
ID Test ACCURACY: 0.8612
ID Test Loss: 1.0013
OOD Validation ACCURACY: 0.8654
OOD Validation Loss: 1.0363
OOD Test ACCURACY: 0.8221
OOD Test Loss: 1.1633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8600
ID Validation Loss: 0.9380
ID Test ACCURACY: 0.8612
ID Test Loss: 1.0013
OOD Validation ACCURACY: 0.8654
OOD Validation Loss: 1.0363
OOD Test ACCURACY: 0.8221
OOD Test Loss: 1.1633

[0m[1;37mINFO[0m: [1mChartInfo 0.8612 0.8221 0.8612 0.8221 0.8600 0.8654[0mGOODSST2(5301)
Data example from id_val: Data(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
Label distribution from id_val: (tensor([0., 1.]), tensor([2144, 3157]))
[1;34mDEBUG[0m: 09/21/2024 06:14:51 AM : [1mUnbalanced warning for GOODSST2 (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:03.418662
Plausibility completed in  0:00:15.676208
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2389, device='cuda:0')  +-  tensor(0.3319, device='cuda:0') (0.021)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.716 +- 0.518
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.866 +- 0.240
Num considered samples: 1895


ratio=0.6


Interventions completed in  0:00:03.333731
Plausibility completed in  0:00:15.846644
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3269, device='cuda:0')  +-  tensor(0.4411, device='cuda:0') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.433 +- 0.549
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.957 +- 0.104
Num considered samples: 1895

\FINISHED GOODSST2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0. 0.] +- [0. 0.] (mean across ratios: 0.00 +- 0.00)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.5436461  0.75238438] +- [0.05623202 0.05915697] (mean across ratios: 0.65 +- 0.04)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.24170946 0.32119072] +- [0.01284833 0.00924996] (mean across ratios: 0.28 +- 0.01)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.91725879 0.97225832] +- [0.08970439 0.03239817] (mean across ratios: 0.94 +- 0.05)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.84812667 0.95835308] +- [0.03453246 0.00381462] (mean across ratios: 0.90 +- 0.02)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.84897668 0.89528898] +- [0.16443108 0.12393913] (mean across ratios: 0.87 +- 0.10)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.66379135 0.42130865] +- [0.0849849  0.03512956] (mean across ratios: 0.54 +- 0.05)

Overall time of execution:  0:04:13.414487
DONE CIGA GOODSST2/length 0.10
DONE all :)
