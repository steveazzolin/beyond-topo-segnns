/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:41:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:41:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0197
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0103
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0197
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0103

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 34...
[0m[1;37mINFO[0m: [1mCheckpoint 34: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0197
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0103
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0197
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0103

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0145 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0197 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0103 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9880 	Val Loss: 0.0229 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9748 	Test Loss: 0.0546 	

Concept relevance scores for this run:
 [[0.06474544 1.        ]] 


Weight vector of global side channel:
W: [[-0.311771   0.2997052]] b:[-0.05736127]

Coeff rule on x1: x1 >= [-0.18398525]


#D#Running with seed = 2
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:41:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:41:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 52...
[0m[1;37mINFO[0m: [1mCheckpoint 52: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0112
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0157
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0076
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0157
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 52...
[0m[1;37mINFO[0m: [1mCheckpoint 52: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0112
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0157
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0076
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0157
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0076

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 0.9998 	Train Loss: 0.0112 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0157 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0076 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9922 	Val Loss: 0.0170 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9974 	Test Loss: 0.0201 	

Concept relevance scores for this run:
 [[0.91615784 1.        ]] 


Weight vector of global side channel:
W: [[-0.23506385  0.23996785]] b:[-0.02648605]

Coeff rule on x1: x1 >= [-0.11267597]


#D#Running with seed = 3
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:41:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:41:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0112
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0175
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0077
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0175
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0077

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0112
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0175
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0077
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0175
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0077

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0112 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0175 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0077 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9904 	Val Loss: 0.0163 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9994 	Test Loss: 0.0147 	

Concept relevance scores for this run:
 [[0.17890094 1.        ]] 


Weight vector of global side channel:
W: [[-0.21395196  0.20869754]] b:[0.07544933]

Coeff rule on x1: x1 >= [0.35264614]


#D#Running with seed = 4
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:41:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:41:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 55...
[0m[1;37mINFO[0m: [1mCheckpoint 55: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0133
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0161
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0101
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0161
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0101

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 55...
[0m[1;37mINFO[0m: [1mCheckpoint 55: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0133
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0161
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0101
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0161
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0101

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0133 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0161 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0101 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9990 	Val Loss: 0.0113 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9228 	Test Loss: 0.9950 	

Concept relevance scores for this run:
 [[0.0191636 1.       ]] 


Weight vector of global side channel:
W: [[-0.18486406  0.18834724]] b:[-0.37041318]

Coeff rule on x1: x1 >= [-2.0037057]


#D#Running with seed = 5
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:41:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:41:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0333
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0375
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0252
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0375
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0252

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0333
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0375
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0252
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0375
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0252

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0333 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0375 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0252 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9898 	Val Loss: 0.0321 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 1.0000 	Test Loss: 0.0351 	

Concept relevance scores for this run:
 [[0.5149379 1.       ]] 


Weight vector of global side channel:
W: [[-0.55891347  0.5530342 ]] b:[-0.42436162]

Coeff rule on x1: x1 >= [-0.7592617]


#D#Running with seed = 6
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
595 6
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 6,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 6,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:41:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:41:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0132
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0191
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0093
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0191
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0093

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0132
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0191
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0093
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0191
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0093

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0132 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0191 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0093 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9986 	Val Loss: 0.0121 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9946 	Test Loss: 0.0391 	

Concept relevance scores for this run:
 [[0.99911946 1.        ]] 


Weight vector of global side channel:
W: [[-0.38634837  0.38392055]] b:[0.21411563]

Coeff rule on x1: x1 >= [0.55420357]


#D#Running with seed = 7
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
692 7
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 7,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 7,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:42:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:42:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 40...
[0m[1;37mINFO[0m: [1mCheckpoint 40: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0116
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0175
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0076
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0175
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0076

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 40...
[0m[1;37mINFO[0m: [1mCheckpoint 40: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0116
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0175
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0076
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0175
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0076

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 0.9998 	Train Loss: 0.0116 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0175 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0076 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9876 	Val Loss: 0.0254 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9770 	Test Loss: 0.0542 	

Concept relevance scores for this run:
 [[0.9868306 1.       ]] 


Weight vector of global side channel:
W: [[-0.41077548  0.39754722]] b:[-0.20924947]

Coeff rule on x1: x1 >= [-0.5094011]


#D#Running with seed = 8
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
789 8
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 8,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 8,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:42:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:42:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0159
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0167
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0131
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0167
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0131

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0159
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0167
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0131
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0167
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0131

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0159 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0167 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0131 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9908 	Val Loss: 0.0196 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 1.0000 	Test Loss: 0.0170 	

Concept relevance scores for this run:
 [[0.9997744 1.       ]] 


Weight vector of global side channel:
W: [[-0.22768435  0.22991312]] b:[-0.3589766]

Coeff rule on x1: x1 >= [-1.5766416]


#D#Running with seed = 9
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
886 9
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 9,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 9,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:42:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:42:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9955
Train Loss: 0.0311
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0320
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0242
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0320
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0242

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9955
Train Loss: 0.0311
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0320
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0242
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0320
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0242

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 0.9955 	Train Loss: 0.0311 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0320 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 0.9960 	Id_test Loss: 0.0242 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9690 	Val Loss: 0.0597 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 0.9560 	Test Loss: 0.1114 	

Concept relevance scores for this run:
 [[0.02937645 1.        ]] 


Weight vector of global side channel:
W: [[-0.2107584   0.22603367]] b:[-0.38648045]

Coeff rule on x1: x1 >= [-1.8337606]


#D#Running with seed = 10
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_conceptnormnoneavgedgeattnmean
983 10
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BAColor/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 10,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept',
 'gpu_idx': 2,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 10,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Sep  5 21:42:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BAColor
[0mloading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min10_max100_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_BA_numgraphs5000_min150_max250_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/BAColor/basis/processed/data_ER_numgraphs5000_min10_max100_shiftER.pt
[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mDataset: {'train': BAColor(4000), 'id_val': BAColor(500), 'id_test': BAColor(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': BAColor(5000), 'test': BAColor(5000)}
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1m Data(x=[39, 2], edge_index=[2, 140], y=[1, 1])
[0mData(x=[72, 2], edge_index=[2, 256], y=[1, 1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/05/2024 09:42:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0137
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0166
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0107
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0107

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0137
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0166
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0107
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0107

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mtorch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([64, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 64, 2])
logits torch.Size([64, 1])
torch.Size([32, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 32, 2])
logits torch.Size([32, 1])
Train ACCURACY: 1.0000 	Train Loss: 0.0137 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0166 	
torch.Size([500, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 500, 2])
logits torch.Size([500, 1])
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0107 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Val ACCURACY: 0.9998 	Val Loss: 0.0119 	
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([512, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 512, 2])
logits torch.Size([512, 1])
torch.Size([392, 2])
torch.Size([1, 1, 2])
torch.Size([1, 2])
torch.Size([1, 392, 2])
logits torch.Size([392, 1])
Test ACCURACY: 1.0000 	Test Loss: 0.0156 	

Concept relevance scores for this run:
 [[0.02933192 1.        ]] 


Weight vector of global side channel:
W: [[-0.16977815  0.16913778]] b:[-0.27267247]

Coeff rule on x1: x1 >= [-1.6060516]


Final accuracies: 
TRAIN      = 1.000 +- 0.001
ID_VAL     = 1.000 +- 0.000
ID_TEST    = 1.000 +- 0.001
VAL        = 0.991 +- 0.008
TEST       = 0.982 +- 0.024


Final accuracies (model with id_val acc above {threshold}% - {sum(id_val_accs >= threshold)} runs): 
TRAIN      = 1.000 +- 0.001
ID_VAL     = 1.000 +- 0.000
ID_TEST    = 1.000 +- 0.001
VAL        = 0.991 +- 0.008
TEST       = 0.982 +- 0.024


Averaged channel relevance scores (model with id_val acc above 0.9% - 10 runs): 
[0.47383386 1.        ] +- [0.4323462 0.       ]


Final Test WIoUs (model with id_val acc above 0.9% - 10 runs):
TRAIN      = nan +- nan
ID_VAL     = nan +- nan
ID_TEST    = nan +- nan
VAL        = nan +- nan
TEST       = nan +- nan


Global side channel coefficient wrt x1 (model with id_val acc above 0.9% - 10 runs):
[-0.7678634] +- [0.8865996]


Final losses: 
TRAIN      = 0.0169 +- 0.0078
ID_VAL     = 0.0209 +- 0.0072
ID_TEST    = 0.0126 +- 0.0063
VAL        = 0.0228 +- 0.0138
TEST       = 0.1357 +- 0.2878
Diff id_val-test  = 0.1148 

Concept relevance scores:
 [[0.02933192 1.        ]] 

/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
