nohup: ignoring input
Time to evaluate models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:27:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BBBP
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mDataset: {'train': MoleculeFix(1631), 'id_val': MoleculeFix(204), 'id_test': MoleculeFix(204), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': MoleculeFix(204), 'test': MoleculeFix(204)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1m Data(x=[28, 9], edge_index=[2, 62], edge_attr=[62, 3], smiles='C4=C(N1C3(C(NC1)=O)CCN(CCCOC2=CC=C(C=C2)F)CC3)C=CC=C4', y=[1])
[0mData(x=[20, 9], edge_index=[2, 40], edge_attr=[40, 3], smiles='[Cl].CC(C)NCC(O)COc1cccc2ccccc12', y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:27:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ACCURACY: 0.8737
Train Loss: 0.3273
ID Validation ACCURACY: 0.7402
ID Validation Loss: 0.7440
ID Test ACCURACY: 0.6961
ID Test Loss: 0.7097
OOD Validation ACCURACY: 0.7402
OOD Validation Loss: 0.7440
OOD Test ACCURACY: 0.6961
OOD Test Loss: 0.7097

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 36...
[0m[1;37mINFO[0m: [1mCheckpoint 36: 
-----------------------------------
Train ACCURACY: 0.8737
Train Loss: 0.3273
ID Validation ACCURACY: 0.7402
ID Validation Loss: 0.7440
ID Test ACCURACY: 0.6961
ID Test Loss: 0.7097
OOD Validation ACCURACY: 0.7402
OOD Validation Loss: 0.7440
OOD Test ACCURACY: 0.6961
OOD Test Loss: 0.7097

[0m[1;37mINFO[0m: [1mChartInfo 0.6961 0.6961 0.6961 0.6961 0.7402 0.7402[0mTrain ACCURACY: 0.8737Train Loss: 0.3273
Id_val ACCURACY: 0.7402Id_val Loss: 0.7440
Id_test ACCURACY: 0.6961Id_test Loss: 0.7097
Val ACCURACY: 0.7402Val Loss: 0.7440
Test ACCURACY: 0.6961Test Loss: 0.7097


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BBBP/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BBBP
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mDataset: {'train': MoleculeFix(1631), 'id_val': MoleculeFix(204), 'id_test': MoleculeFix(204), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': MoleculeFix(204), 'test': MoleculeFix(204)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1m Data(x=[36, 9], edge_index=[2, 78], edge_attr=[78, 3], smiles='COCC(=O)O[C@]1(CCN(C)CCCc2[nH]c3ccccc3n2)CCc4cc(F)ccc4[C@@H]1C(C)C', y=[1])
[0mData(x=[20, 9], edge_index=[2, 40], edge_attr=[40, 3], smiles='[Cl].CC(C)NCC(O)COc1cccc2ccccc12', y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8921
Train Loss: 0.2822
ID Validation ACCURACY: 0.7598
ID Validation Loss: 0.5541
ID Test ACCURACY: 0.7157
ID Test Loss: 0.6134
OOD Validation ACCURACY: 0.7598
OOD Validation Loss: 0.5541
OOD Test ACCURACY: 0.7157
OOD Test Loss: 0.6134

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8921
Train Loss: 0.2822
ID Validation ACCURACY: 0.7598
ID Validation Loss: 0.5541
ID Test ACCURACY: 0.7157
ID Test Loss: 0.6134
OOD Validation ACCURACY: 0.7598
OOD Validation Loss: 0.5541
OOD Test ACCURACY: 0.7157
OOD Test Loss: 0.6134

[0m[1;37mINFO[0m: [1mChartInfo 0.7157 0.7157 0.7157 0.7157 0.7598 0.7598[0mTrain ACCURACY: 0.8921Train Loss: 0.2822
Id_val ACCURACY: 0.7598Id_val Loss: 0.5541
Id_test ACCURACY: 0.7157Id_test Loss: 0.6134
Val ACCURACY: 0.7598Val Loss: 0.5541
Test ACCURACY: 0.7157Test Loss: 0.6134


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BBBP/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BBBP
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:07 PM : [1mDataset: {'train': MoleculeFix(1631), 'id_val': MoleculeFix(204), 'id_test': MoleculeFix(204), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': MoleculeFix(204), 'test': MoleculeFix(204)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:07 PM : [1m Data(x=[33, 9], edge_index=[2, 68], edge_attr=[68, 3], smiles='O.COC1CN(CCCOc2ccc(F)cc2)CCC1NC(=O)c3cc(Cl)c(N)cc3OC', y=[1])
[0mData(x=[20, 9], edge_index=[2, 40], edge_attr=[40, 3], smiles='[Cl].CC(C)NCC(O)COc1cccc2ccccc12', y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8835
Train Loss: 0.2961
ID Validation ACCURACY: 0.7941
ID Validation Loss: 0.5025
ID Test ACCURACY: 0.7157
ID Test Loss: 0.6624
OOD Validation ACCURACY: 0.7941
OOD Validation Loss: 0.5025
OOD Test ACCURACY: 0.7157
OOD Test Loss: 0.6624

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8835
Train Loss: 0.2961
ID Validation ACCURACY: 0.7941
ID Validation Loss: 0.5025
ID Test ACCURACY: 0.7157
ID Test Loss: 0.6624
OOD Validation ACCURACY: 0.7941
OOD Validation Loss: 0.5025
OOD Test ACCURACY: 0.7157
OOD Test Loss: 0.6624

[0m[1;37mINFO[0m: [1mChartInfo 0.7157 0.7157 0.7157 0.7157 0.7941 0.7941[0mTrain ACCURACY: 0.8835Train Loss: 0.2961
Id_val ACCURACY: 0.7941Id_val Loss: 0.5025
Id_test ACCURACY: 0.7157Id_test Loss: 0.6624
Val ACCURACY: 0.7941Val Loss: 0.5025
Test ACCURACY: 0.7157Test Loss: 0.6624


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BBBP/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BBBP
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mDataset: {'train': MoleculeFix(1631), 'id_val': MoleculeFix(204), 'id_test': MoleculeFix(204), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': MoleculeFix(204), 'test': MoleculeFix(204)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1m Data(x=[26, 9], edge_index=[2, 60], edge_attr=[60, 3], smiles='[C@@H]25C(=C[C@@H](CN1CC(NC(C1)=O)=O)CN2C)C3=CC=CC4=C3C(=C[NH]4)C5', y=[1])
[0mData(x=[20, 9], edge_index=[2, 40], edge_attr=[40, 3], smiles='[Cl].CC(C)NCC(O)COc1cccc2ccccc12', y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 53...
[0m[1;37mINFO[0m: [1mCheckpoint 53: 
-----------------------------------
Train ACCURACY: 0.8381
Train Loss: 0.3843
ID Validation ACCURACY: 0.7598
ID Validation Loss: 0.5893
ID Test ACCURACY: 0.7059
ID Test Loss: 0.6043
OOD Validation ACCURACY: 0.7598
OOD Validation Loss: 0.5893
OOD Test ACCURACY: 0.7059
OOD Test Loss: 0.6043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 53...
[0m[1;37mINFO[0m: [1mCheckpoint 53: 
-----------------------------------
Train ACCURACY: 0.8381
Train Loss: 0.3843
ID Validation ACCURACY: 0.7598
ID Validation Loss: 0.5893
ID Test ACCURACY: 0.7059
ID Test Loss: 0.6043
OOD Validation ACCURACY: 0.7598
OOD Validation Loss: 0.5893
OOD Test ACCURACY: 0.7059
OOD Test Loss: 0.6043

[0m[1;37mINFO[0m: [1mChartInfo 0.7059 0.7059 0.7059 0.7059 0.7598 0.7598[0mTrain ACCURACY: 0.8381Train Loss: 0.3843
Id_val ACCURACY: 0.7598Id_val Loss: 0.5893
Id_test ACCURACY: 0.7059Id_test Loss: 0.6043
Val ACCURACY: 0.7598Val Loss: 0.5893
Test ACCURACY: 0.7059Test Loss: 0.6043


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/BBBP/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset BBBP
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mDataset: {'train': MoleculeFix(1631), 'id_val': MoleculeFix(204), 'id_test': MoleculeFix(204), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': MoleculeFix(204), 'test': MoleculeFix(204)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1m Data(x=[29, 9], edge_index=[2, 62], edge_attr=[62, 3], smiles='CN(C)Cc1ccc(CSCCNC2=C([N+]([O-])=O)C(Cc3ccccc3)=CN2)o1', y=[1])
[0mData(x=[20, 9], edge_index=[2, 40], edge_attr=[40, 3], smiles='[Cl].CC(C)NCC(O)COc1cccc2ccccc12', y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.8780
Train Loss: 0.3186
ID Validation ACCURACY: 0.7598
ID Validation Loss: 0.5171
ID Test ACCURACY: 0.7157
ID Test Loss: 0.5649
OOD Validation ACCURACY: 0.7598
OOD Validation Loss: 0.5171
OOD Test ACCURACY: 0.7157
OOD Test Loss: 0.5649

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.8780
Train Loss: 0.3186
ID Validation ACCURACY: 0.7598
ID Validation Loss: 0.5171
ID Test ACCURACY: 0.7157
ID Test Loss: 0.5649
OOD Validation ACCURACY: 0.7598
OOD Validation Loss: 0.5171
OOD Test ACCURACY: 0.7157
OOD Test Loss: 0.5649

[0m[1;37mINFO[0m: [1mChartInfo 0.7157 0.7157 0.7157 0.7157 0.7598 0.7598[0mTrain ACCURACY: 0.8780Train Loss: 0.3186
Id_val ACCURACY: 0.7598Id_val Loss: 0.5171
Id_test ACCURACY: 0.7157Id_test Loss: 0.5649
Val ACCURACY: 0.7598Val Loss: 0.5171
Test ACCURACY: 0.7157Test Loss: 0.5649


Final accuracies: 
TRAIN      = 0.873 +- 0.019
ID_VAL     = 0.763 +- 0.017
ID_TEST    = 0.710 +- 0.008
VAL        = 0.763 +- 0.017
TEST       = 0.710 +- 0.008

Final losses: 
TRAIN      = 0.3217 +- 0.0351
ID_VAL     = 0.5814 +- 0.0867
ID_TEST    = 0.6309 +- 0.0501
VAL        = 0.5814 +- 0.0867
TEST       = 0.6309 +- 0.0501
Diff id_val-test  = 0.0495 
DONE EVAL GSAT BBBP/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset MultiShapes
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mDataset: {'train': BAMultiShapesDataset(800), 'id_val': BAMultiShapesDataset(100), 'id_test': BAMultiShapesDataset(100), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': BAMultiShapesDataset(100), 'test': BAMultiShapesDataset(100)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1m Data(x=[40, 10], edge_index=[2, 96], y=[1])
[0mData(x=[40, 10], edge_index=[2, 78], y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ACCURACY: 0.8788
Train Loss: 0.2426
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0519
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0451
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0519
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0451

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ACCURACY: 0.8788
Train Loss: 0.2426
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0519
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0451
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0519
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0451

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTrain ACCURACY: 0.8788Train Loss: 0.2426
Id_val ACCURACY: 0.9900Id_val Loss: 0.0519
Id_test ACCURACY: 0.9900Id_test Loss: 0.0451
Val ACCURACY: 0.9900Val Loss: 0.0519
Test ACCURACY: 0.9900Test Loss: 0.0451


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/MultiShapes/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset MultiShapes
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mDataset: {'train': BAMultiShapesDataset(800), 'id_val': BAMultiShapesDataset(100), 'id_test': BAMultiShapesDataset(100), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': BAMultiShapesDataset(100), 'test': BAMultiShapesDataset(100)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1m Data(x=[40, 10], edge_index=[2, 92], y=[1])
[0mData(x=[40, 10], edge_index=[2, 78], y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1840
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0390
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0348
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0348

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1840
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0390
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0348
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0348

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9900 0.9900[0mTrain ACCURACY: 0.9313Train Loss: 0.1840
Id_val ACCURACY: 0.9900Id_val Loss: 0.0390
Id_test ACCURACY: 1.0000Id_test Loss: 0.0348
Val ACCURACY: 0.9900Val Loss: 0.0390
Test ACCURACY: 1.0000Test Loss: 0.0348


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/MultiShapes/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset MultiShapes
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mDataset: {'train': BAMultiShapesDataset(800), 'id_val': BAMultiShapesDataset(100), 'id_test': BAMultiShapesDataset(100), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': BAMultiShapesDataset(100), 'test': BAMultiShapesDataset(100)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1m Data(x=[40, 10], edge_index=[2, 86], y=[1])
[0mData(x=[40, 10], edge_index=[2, 78], y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9337
Train Loss: 0.1937
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0432
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0511
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0432
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9337
Train Loss: 0.1937
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0432
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0511
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0432
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0511

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 1.0000 1.0000[0mTrain ACCURACY: 0.9337Train Loss: 0.1937
Id_val ACCURACY: 1.0000Id_val Loss: 0.0432
Id_test ACCURACY: 0.9900Id_test Loss: 0.0511
Val ACCURACY: 1.0000Val Loss: 0.0432
Test ACCURACY: 0.9900Test Loss: 0.0511


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/MultiShapes/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset MultiShapes
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mDataset: {'train': BAMultiShapesDataset(800), 'id_val': BAMultiShapesDataset(100), 'id_test': BAMultiShapesDataset(100), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': BAMultiShapesDataset(100), 'test': BAMultiShapesDataset(100)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1m Data(x=[40, 10], edge_index=[2, 92], y=[1])
[0mData(x=[40, 10], edge_index=[2, 78], y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.2465
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0990
ID Test ACCURACY: 0.9800
ID Test Loss: 0.1049
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0990
OOD Test ACCURACY: 0.9800
OOD Test Loss: 0.1049

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.2465
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0990
ID Test ACCURACY: 0.9800
ID Test Loss: 0.1049
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0990
OOD Test ACCURACY: 0.9800
OOD Test Loss: 0.1049

[0m[1;37mINFO[0m: [1mChartInfo 0.9800 0.9800 0.9800 0.9800 1.0000 1.0000[0mTrain ACCURACY: 0.9087Train Loss: 0.2465
Id_val ACCURACY: 1.0000Id_val Loss: 0.0990
Id_test ACCURACY: 0.9800Id_test Loss: 0.1049
Val ACCURACY: 1.0000Val Loss: 0.0990
Test ACCURACY: 0.9800Test Loss: 0.1049


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/MultiShapes/basis/no_shift/GSAT.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 10 17:28:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset MultiShapes
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mDataset: {'train': BAMultiShapesDataset(800), 'id_val': BAMultiShapesDataset(100), 'id_test': BAMultiShapesDataset(100), 'metric': 'Accuracy', 'task': 'Multi-label classification', 'val': BAMultiShapesDataset(100), 'test': BAMultiShapesDataset(100)}
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1m Data(x=[40, 10], edge_index=[2, 78], y=[1])
[0mData(x=[40, 10], edge_index=[2, 78], y=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: hard
[1;34mDEBUG[0m: 05/10/2024 05:28:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 12...
[0m[1;37mINFO[0m: [1mCheckpoint 12: 
-----------------------------------
Train ACCURACY: 0.9425
Train Loss: 0.1799
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0842
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1215
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0842
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1215

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 12...
[0m[1;37mINFO[0m: [1mCheckpoint 12: 
-----------------------------------
Train ACCURACY: 0.9425
Train Loss: 0.1799
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0842
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1215
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0842
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1215

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTrain ACCURACY: 0.9425Train Loss: 0.1799
Id_val ACCURACY: 0.9700Id_val Loss: 0.0842
Id_test ACCURACY: 0.9600Id_test Loss: 0.1215
Val ACCURACY: 0.9700Val Loss: 0.0842
Test ACCURACY: 0.9600Test Loss: 0.1215


Final accuracies: 
TRAIN      = 0.919 +- 0.023
ID_VAL     = 0.990 +- 0.011
ID_TEST    = 0.984 +- 0.014
VAL        = 0.990 +- 0.011
TEST       = 0.984 +- 0.014

Final losses: 
TRAIN      = 0.2093 +- 0.0291
ID_VAL     = 0.0635 +- 0.0238
ID_TEST    = 0.0715 +- 0.0349
VAL        = 0.0635 +- 0.0238
TEST       = 0.0715 +- 0.0349
Diff id_val-test  = 0.0080 
DONE EVAL GSAT MultiShapes/basis
DONE all :)
