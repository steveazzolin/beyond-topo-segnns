nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 1688249

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:25:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.411250
Original XAI WIoU for r=0.3 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3108, device='cuda:1')  +-  tensor(0.1623, device='cuda:1') (0.053981781005859375)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:25:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.408472
Original XAI WIoU for r=0.3 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3799, device='cuda:1')  +-  tensor(0.1307, device='cuda:1') (0.06394309550523758)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:26:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.140



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.315303
Original XAI WIoU for r=0.3 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3453, device='cuda:1')  +-  tensor(0.2130, device='cuda:1') (0.08723428100347519)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:26:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:26:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.166



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.333135
Original XAI WIoU for r=0.3 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3584, device='cuda:1')  +-  tensor(0.1549, device='cuda:1') (0.0667540431022644)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:27:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.224429
Original XAI WIoU for r=0.3 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3233, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.11118689924478531)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.26772853] +- [0.026681]
(id) test WIOU_PERTURBED: 	[0.34353904] +- [0.02459566]
DONE CIGA GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:27:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.355061
Original XAI WIoU for r=0.3 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3802, device='cuda:1')  +-  tensor(0.2163, device='cuda:1') (0.0701722577214241)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:28:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.207491
Original XAI WIoU for r=0.3 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4708, device='cuda:1')  +-  tensor(0.1872, device='cuda:1') (0.09280609339475632)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:28:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.140



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.181431
Original XAI WIoU for r=0.3 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4351, device='cuda:1')  +-  tensor(0.2656, device='cuda:1') (0.11414150893688202)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:29:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.166



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.896721
Original XAI WIoU for r=0.3 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4685, device='cuda:1')  +-  tensor(0.2223, device='cuda:1') (0.10128531605005264)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:29:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.214427
Original XAI WIoU for r=0.3 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3317, device='cuda:1')  +-  tensor(0.1390, device='cuda:1') (0.14971879124641418)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.26772853] +- [0.026681]
(id) test WIOU_PERTURBED: 	[0.41724112] +- [0.05385432]
DONE CIGA GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:30:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.906



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.823000
Original XAI WIoU for r=0.3 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8302, device='cuda:1')  +-  tensor(0.1649, device='cuda:1') (0.06928016990423203)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:30:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:30:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.836



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.983672
Original XAI WIoU for r=0.3 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7479, device='cuda:1')  +-  tensor(0.2013, device='cuda:1') (0.11037370562553406)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:31:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.647210
Original XAI WIoU for r=0.3 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6378, device='cuda:1')  +-  tensor(0.1711, device='cuda:1') (0.10082198679447174)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:31:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.850



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.770147
Original XAI WIoU for r=0.3 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6398, device='cuda:1')  +-  tensor(0.2021, device='cuda:1') (0.1714533269405365)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:32:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.897



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.796968
Original XAI WIoU for r=0.3 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8098, device='cuda:1')  +-  tensor(0.1186, device='cuda:1') (0.12792463600635529)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.81706636] +- [0.08885075]
(id) test WIOU_PERTURBED: 	[0.73308194] +- [0.08161087]
DONE LECI GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:32:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.906



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.614274
Original XAI WIoU for r=0.3 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8312, device='cuda:1')  +-  tensor(0.1262, device='cuda:1') (0.118670754134655)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:33:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.836



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.483170
Original XAI WIoU for r=0.3 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7464, device='cuda:1')  +-  tensor(0.1022, device='cuda:1') (0.14703334867954254)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:33:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:33:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.476020
Original XAI WIoU for r=0.3 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6615, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (0.1285254955291748)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:34:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.850



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.785446
Original XAI WIoU for r=0.3 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6455, device='cuda:1')  +-  tensor(0.1838, device='cuda:1') (0.18348278105258942)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:34:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:34:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.897



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.635612
Original XAI WIoU for r=0.3 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7081, device='cuda:1')  +-  tensor(0.1052, device='cuda:1') (0.13981026411056519)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.81706636] +- [0.08885075]
(id) test WIOU_PERTURBED: 	[0.71852727] +- [0.06656756]
DONE LECI GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:35:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:35:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.113414
Original XAI WIoU for r=0.3 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2971, device='cuda:1')  +-  tensor(0.1214, device='cuda:1') (0.005456435959786177)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:36:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:36:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.498



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.989771
Original XAI WIoU for r=0.3 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2951, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.0038433296140283346)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:36:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:36:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.779574
Original XAI WIoU for r=0.3 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2944, device='cuda:1')  +-  tensor(0.1194, device='cuda:1') (0.0033184196799993515)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:37:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:37:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.370



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.778592
Original XAI WIoU for r=0.3 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2934, device='cuda:1')  +-  tensor(0.1184, device='cuda:1') (0.005337114445865154)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:37:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:37:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.769158
Original XAI WIoU for r=0.3 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2946, device='cuda:1')  +-  tensor(0.1205, device='cuda:1') (0.004361016675829887)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.26244532] +- [0.00308772]
(id) test WIOU_PERTURBED: 	[0.29492577] +- [0.00122595]
DONE GSAT GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:38:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:38:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.726076
Original XAI WIoU for r=0.3 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3392, device='cuda:1')  +-  tensor(0.1533, device='cuda:1') (0.006667913869023323)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:38:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:38:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.498



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.609924
Original XAI WIoU for r=0.3 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3356, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.0055843135342001915)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:39:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:39:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.774371
Original XAI WIoU for r=0.3 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3332, device='cuda:1')  +-  tensor(0.1483, device='cuda:1') (0.004872472491115332)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:39:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:39:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.370



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.726945
Original XAI WIoU for r=0.3 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3335, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.006449088919907808)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:40:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:40:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.543347
Original XAI WIoU for r=0.3 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3345, device='cuda:1')  +-  tensor(0.1504, device='cuda:1') (0.005713658407330513)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.26244532] +- [0.00308772]
(id) test WIOU_PERTURBED: 	[0.33520658] +- [0.00217589]
DONE GSAT GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:41:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.315879
Original XAI WIoU for r=0.3 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5383, device='cuda:1')  +-  tensor(0.2038, device='cuda:1') (0.08222629874944687)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:41:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:03 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.156



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.523354
Original XAI WIoU for r=0.3 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.10292831063270569)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:42:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:48 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:50 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:42:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.301380
Original XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6014, device='cuda:1')  +-  tensor(0.1914, device='cuda:1') (0.07134431600570679)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:43:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:19 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:43:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.327906
Original XAI WIoU for r=0.3 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6179, device='cuda:1')  +-  tensor(0.1940, device='cuda:1') (0.08003371953964233)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:44:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:04 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:44:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.164



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.330353
Original XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5364, device='cuda:1')  +-  tensor(0.2044, device='cuda:1') (0.08017910271883011)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) test SUFF_SIMPLE: 	[] +- []
(id) test WIOU_ORIGINAL: 	[0.4539116] +- [0.02255264]
(id) test WIOU_PERTURBED: 	[0.58213168] +- [0.03705646]
DONE CIGA GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:45:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:30 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.111702
Original XAI WIoU for r=0.3 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6481, device='cuda:1')  +-  tensor(0.2193, device='cuda:1') (0.10270324349403381)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:46:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:15 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:18 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:20 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.156



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.327065
Original XAI WIoU for r=0.3 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7358, device='cuda:1')  +-  tensor(0.2080, device='cuda:1') (0.11751139163970947)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:46:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:46 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:46:59 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:00 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:04 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.194819
Original XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7142, device='cuda:1')  +-  tensor(0.1908, device='cuda:1') (0.08653373271226883)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:47:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:47:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.117884
Original XAI WIoU for r=0.3 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7333, device='cuda:1')  +-  tensor(0.1883, device='cuda:1') (0.09602149575948715)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 12:48:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:12 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:24 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:26 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:28 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:48:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
stability_detector.sh: line 8: 1694360 Killed                  goodtg --config_path final_configs/${DATASET}/covariate/${MODEL}.yaml --seeds "1/2/3/4/5" --task stability_detector --metrics "suff_simple" --splits "${SPLITS}" --average_edge_attn mean --mitigation_sampling feat --gpu_idx 1 --mask --debias --expval_budget 5 --numsamples_budget 99999 --samplingtype deconfounded --nec_number_samples prop_G_dataset --nec_alpha_1 ${BUDGET}
