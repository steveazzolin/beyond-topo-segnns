nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 1787376

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:03:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:03:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.667
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.741
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.906
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.957
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.955



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.647674
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6355, device='cuda:1')  +-  tensor(0.2830, device='cuda:1') (0.09273471683263779)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.801296
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6231, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.06026221811771393)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.580579
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6407, device='cuda:1')  +-  tensor(0.2908, device='cuda:1') (0.016568968072533607)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.650359
Original XAI WIoU for r=0.3 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6412, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (0.09497696906328201)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.588787
Original XAI WIoU for r=0.6 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6282, device='cuda:1')  +-  tensor(0.2970, device='cuda:1') (0.062267087399959564)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.784346
Original XAI WIoU for r=0.9 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6453, device='cuda:1')  +-  tensor(0.2899, device='cuda:1') (0.017176253721117973)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.811705
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3357, device='cuda:1')  +-  tensor(0.0654, device='cuda:1') (0.08972472697496414)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.981675
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3902, device='cuda:1')  +-  tensor(0.0781, device='cuda:1') (0.10824576765298843)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.754323
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5295, device='cuda:1')  +-  tensor(0.1826, device='cuda:1') (0.03974170982837677)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.643284
Original XAI WIoU for r=0.3 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8227, device='cuda:1')  +-  tensor(0.1667, device='cuda:1') (0.07001695036888123)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.588152
Original XAI WIoU for r=0.6 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.8195, device='cuda:1')  +-  tensor(0.1731, device='cuda:1') (0.05875994637608528)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.590453
Original XAI WIoU for r=0.9 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.8468, device='cuda:1')  +-  tensor(0.1384, device='cuda:1') (0.007833287119865417)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:08:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:08:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.713
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.774
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.836
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.840
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.788



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.562296
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6586, device='cuda:1')  +-  tensor(0.3064, device='cuda:1') (0.07458142936229706)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.556952
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6377, device='cuda:1')  +-  tensor(0.3004, device='cuda:1') (0.07463023066520691)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.538902
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6703, device='cuda:1')  +-  tensor(0.2953, device='cuda:1') (0.012174364179372787)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.768830
Original XAI WIoU for r=0.3 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6654, device='cuda:1')  +-  tensor(0.3043, device='cuda:1') (0.07450434565544128)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.536384
Original XAI WIoU for r=0.6 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6440, device='cuda:1')  +-  tensor(0.2995, device='cuda:1') (0.07379138469696045)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.796063
Original XAI WIoU for r=0.9 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6799, device='cuda:1')  +-  tensor(0.2950, device='cuda:1') (0.011497083120048046)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.854832
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3509, device='cuda:1')  +-  tensor(0.0782, device='cuda:1') (0.11349143087863922)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.059757
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3836, device='cuda:1')  +-  tensor(0.0925, device='cuda:1') (0.11428672075271606)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.820754
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5879, device='cuda:1')  +-  tensor(0.2338, device='cuda:1') (0.05175507068634033)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.652493
Original XAI WIoU for r=0.3 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7510, device='cuda:1')  +-  tensor(0.2050, device='cuda:1') (0.10292983055114746)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.619476
Original XAI WIoU for r=0.6 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7689, device='cuda:1')  +-  tensor(0.2287, device='cuda:1') (0.0629490464925766)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.651654
Original XAI WIoU for r=0.9 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7489, device='cuda:1')  +-  tensor(0.2781, device='cuda:1') (9.196321926197015e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:13:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:13:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.687
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.700
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.745
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.513933
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6047, device='cuda:1')  +-  tensor(0.2818, device='cuda:1') (0.08515362441539764)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.558224
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5866, device='cuda:1')  +-  tensor(0.2872, device='cuda:1') (0.0788009762763977)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.551413
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5516, device='cuda:1')  +-  tensor(0.2619, device='cuda:1') (0.005912493448704481)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.774709
Original XAI WIoU for r=0.3 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6081, device='cuda:1')  +-  tensor(0.2783, device='cuda:1') (0.08820776641368866)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.535553
Original XAI WIoU for r=0.6 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5888, device='cuda:1')  +-  tensor(0.2846, device='cuda:1') (0.07885078340768814)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.785041
Original XAI WIoU for r=0.9 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5532, device='cuda:1')  +-  tensor(0.2610, device='cuda:1') (0.005304213147610426)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.736079
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3109, device='cuda:1')  +-  tensor(0.0642, device='cuda:1') (0.08295662701129913)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.928729
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.0708, device='cuda:1') (0.08251257240772247)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.719161
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3970, device='cuda:1')  +-  tensor(0.1467, device='cuda:1') (0.010395371355116367)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.542549
Original XAI WIoU for r=0.3 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6387, device='cuda:1')  +-  tensor(0.1795, device='cuda:1') (0.08907119929790497)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.516362
Original XAI WIoU for r=0.6 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6528, device='cuda:1')  +-  tensor(0.2158, device='cuda:1') (0.05579734221100807)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.559331
Original XAI WIoU for r=0.9 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6745, device='cuda:1')  +-  tensor(0.2750, device='cuda:1') (1.1961883039646182e-08)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:18:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:18:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.845
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.904
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.908
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.850
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.846
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.846



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.553559
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6665, device='cuda:1')  +-  tensor(0.2594, device='cuda:1') (0.14154626429080963)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.561470
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6883, device='cuda:1')  +-  tensor(0.2889, device='cuda:1') (0.09820393472909927)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.547488
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7681, device='cuda:1')  +-  tensor(0.3199, device='cuda:1') (0.015182075090706348)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.776885
Original XAI WIoU for r=0.3 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6672, device='cuda:1')  +-  tensor(0.2579, device='cuda:1') (0.1423317790031433)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.537369
Original XAI WIoU for r=0.6 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6930, device='cuda:1')  +-  tensor(0.2845, device='cuda:1') (0.097242072224617)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.776762
Original XAI WIoU for r=0.9 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7727, device='cuda:1')  +-  tensor(0.3171, device='cuda:1') (0.015188059769570827)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.732443
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4037, device='cuda:1')  +-  tensor(0.1465, device='cuda:1') (0.15047645568847656)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.955926
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3792, device='cuda:1')  +-  tensor(0.1497, device='cuda:1') (0.1259649693965912)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.737435
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3794, device='cuda:1')  +-  tensor(0.1877, device='cuda:1') (0.01973179168999195)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.549140
Original XAI WIoU for r=0.3 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6355, device='cuda:1')  +-  tensor(0.2012, device='cuda:1') (0.16559357941150665)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.544559
Original XAI WIoU for r=0.6 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5748, device='cuda:1')  +-  tensor(0.2338, device='cuda:1') (0.11819027364253998)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.564955
Original XAI WIoU for r=0.9 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6949, device='cuda:1')  +-  tensor(0.2762, device='cuda:1') (4.842507284052999e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:23:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:23:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.720
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.822



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.569022
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6459, device='cuda:1')  +-  tensor(0.2685, device='cuda:1') (0.11110436916351318)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.693451
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6372, device='cuda:1')  +-  tensor(0.2786, device='cuda:1') (0.09408372640609741)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.553366
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6682, device='cuda:1')  +-  tensor(0.3267, device='cuda:1') (0.008027293719351292)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.775235
Original XAI WIoU for r=0.3 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6487, device='cuda:1')  +-  tensor(0.2659, device='cuda:1') (0.1095544695854187)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.534455
Original XAI WIoU for r=0.6 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6398, device='cuda:1')  +-  tensor(0.2793, device='cuda:1') (0.09294872730970383)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.526820
Original XAI WIoU for r=0.9 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6686, device='cuda:1')  +-  tensor(0.3248, device='cuda:1') (0.007688269950449467)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.965947
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3493, device='cuda:1')  +-  tensor(0.1032, device='cuda:1') (0.09709491580724716)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.725418
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1078, device='cuda:1') (0.08043712377548218)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.970292
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3372, device='cuda:1')  +-  tensor(0.1408, device='cuda:1') (0.011318049393594265)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.544831
Original XAI WIoU for r=0.3 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8070, device='cuda:1')  +-  tensor(0.1233, device='cuda:1') (0.12265675514936447)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.304950
Original XAI WIoU for r=0.6 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7358, device='cuda:1')  +-  tensor(0.1634, device='cuda:1') (0.11084239929914474)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.574240
Original XAI WIoU for r=0.9 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9088, device='cuda:1')  +-  tensor(0.1369, device='cuda:1') (2.5184370144870627e-09)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.76367326 0.76367326 0.7636732 ] +- [0.07432533 0.07432533 0.07432535] (mean across ratios: 0.7636732379595438)
(id) id_val WIOU_PERTURBED: 	[0.64225417 0.63460356 0.65978762] +- [0.02154606 0.03264792 0.06926836] (mean across ratios: 0.6455484509468078)
(id) id_test WIOU_ORIGINAL: 	[0.76730324 0.76730324 0.76730324] +- [0.07490313 0.07490313 0.07490313] (mean across ratios: 0.7673032402992247)
(id) id_test WIOU_PERTURBED: 	[0.64610878 0.63879128 0.66393071] +- [0.02142466 0.03338955 0.07028241] (mean across ratios: 0.6496102571487427)
(id) val WIOU_ORIGINAL: 	[0.98065083 0.98065083 0.98065083] +- [0.02661738 0.02661738 0.02661738] (mean across ratios: 0.98065083026886)
(id) val WIOU_PERTURBED: 	[0.35010265 0.35916314 0.44620003] +- [0.03037761 0.03098921 0.09566667] (mean across ratios: 0.3851552744706472)
(id) test WIOU_ORIGINAL: 	[0.81706636 0.81706636 0.81706636] +- [0.08885075 0.08885075 0.08885075] (mean across ratios: 0.8170663595199587)
(id) test WIOU_PERTURBED: 	[0.73096355 0.71033511 0.774778  ] +- [0.08029372 0.08679881 0.08975189] (mean across ratios: 0.7386922200520832)
DONE LECI GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:28:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:28:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.667
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.741
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.906
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.957
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.955



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.611565
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6254, device='cuda:1')  +-  tensor(0.2943, device='cuda:1') (0.09126967191696167)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.773005
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5968, device='cuda:1')  +-  tensor(0.3120, device='cuda:1') (0.047882579267024994)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.548284
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6192, device='cuda:1')  +-  tensor(0.3006, device='cuda:1') (0.004467208404093981)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.610364
Original XAI WIoU for r=0.3 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6314, device='cuda:1')  +-  tensor(0.2931, device='cuda:1') (0.09134852141141891)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.552445
Original XAI WIoU for r=0.6 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5970, device='cuda:1')  +-  tensor(0.3085, device='cuda:1') (0.04839243367314339)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.766544
Original XAI WIoU for r=0.9 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6253, device='cuda:1')  +-  tensor(0.2994, device='cuda:1') (0.0038612179923802614)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.770920
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2821, device='cuda:1')  +-  tensor(0.0870, device='cuda:1') (0.06954695284366608)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.944230
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3124, device='cuda:1')  +-  tensor(0.0855, device='cuda:1') (0.08540727943181992)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.735544
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5055, device='cuda:1')  +-  tensor(0.1955, device='cuda:1') (1.5445877465936064e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.604843
Original XAI WIoU for r=0.3 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8120, device='cuda:1')  +-  tensor(0.1221, device='cuda:1') (0.12295499444007874)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.546917
Original XAI WIoU for r=0.6 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7950, device='cuda:1')  +-  tensor(0.1036, device='cuda:1') (0.13630248606204987)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.565544
Original XAI WIoU for r=0.9 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.8286, device='cuda:1')  +-  tensor(0.1366, device='cuda:1') (1.1117776033131577e-08)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:33:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:33:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.713
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.774
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.836
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.840
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.788



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.565307
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6275, device='cuda:1')  +-  tensor(0.3154, device='cuda:1') (0.06901422888040543)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.696009
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6030, device='cuda:1')  +-  tensor(0.3092, device='cuda:1') (0.06139266490936279)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.525642
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6593, device='cuda:1')  +-  tensor(0.3065, device='cuda:1') (0.005433944519609213)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.755365
Original XAI WIoU for r=0.3 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6334, device='cuda:1')  +-  tensor(0.3118, device='cuda:1') (0.07126426696777344)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.519773
Original XAI WIoU for r=0.6 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6073, device='cuda:1')  +-  tensor(0.3065, device='cuda:1') (0.06370243430137634)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.747456
Original XAI WIoU for r=0.9 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6718, device='cuda:1')  +-  tensor(0.3060, device='cuda:1') (0.004996075760573149)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.718079
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2966, device='cuda:1')  +-  tensor(0.0962, device='cuda:1') (0.08788654208183289)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.919107
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0952, device='cuda:1') (0.09003487229347229)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.711536
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5381, device='cuda:1')  +-  tensor(0.2524, device='cuda:1') (2.8460838130683896e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.537386
Original XAI WIoU for r=0.3 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7624, device='cuda:1')  +-  tensor(0.1099, device='cuda:1') (0.13629843294620514)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.510642
Original XAI WIoU for r=0.6 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.8107, device='cuda:1')  +-  tensor(0.1686, device='cuda:1') (0.06499277800321579)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.554564
Original XAI WIoU for r=0.9 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7489, device='cuda:1')  +-  tensor(0.2781, device='cuda:1') (9.196321926197015e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:38:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:38:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.687
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.700
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.745
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.557742
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6049, device='cuda:1')  +-  tensor(0.2994, device='cuda:1') (0.07686617225408554)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.553501
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5930, device='cuda:1')  +-  tensor(0.3008, device='cuda:1') (0.06763336062431335)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.558460
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5515, device='cuda:1')  +-  tensor(0.2631, device='cuda:1') (0.0023544307332485914)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.776659
Original XAI WIoU for r=0.3 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6098, device='cuda:1')  +-  tensor(0.2966, device='cuda:1') (0.07673142105340958)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.541734
Original XAI WIoU for r=0.6 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5950, device='cuda:1')  +-  tensor(0.2977, device='cuda:1') (0.06918951123952866)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.534822
Original XAI WIoU for r=0.9 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5524, device='cuda:1')  +-  tensor(0.2626, device='cuda:1') (0.0015716066118329763)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.945609
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2696, device='cuda:1')  +-  tensor(0.0809, device='cuda:1') (0.06473889946937561)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.726422
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3206, device='cuda:1')  +-  tensor(0.0958, device='cuda:1') (0.07788538932800293)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.980229
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4064, device='cuda:1')  +-  tensor(0.1625, device='cuda:1') (2.8710740451742822e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.552342
Original XAI WIoU for r=0.3 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6754, device='cuda:1')  +-  tensor(0.0945, device='cuda:1') (0.119597889482975)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.304734
Original XAI WIoU for r=0.6 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7610, device='cuda:1')  +-  tensor(0.1698, device='cuda:1') (0.05881667137145996)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.576505
Original XAI WIoU for r=0.9 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6745, device='cuda:1')  +-  tensor(0.2750, device='cuda:1') (1.1961883039646182e-08)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:43:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:43:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.845
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.904
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.908
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.850
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.846
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.846



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.555225
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6243, device='cuda:1')  +-  tensor(0.2880, device='cuda:1') (0.11870218068361282)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.554418
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6386, device='cuda:1')  +-  tensor(0.3057, device='cuda:1') (0.09034740924835205)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.795489
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7623, device='cuda:1')  +-  tensor(0.3266, device='cuda:1') (0.0061898925341665745)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.548077
Original XAI WIoU for r=0.3 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6268, device='cuda:1')  +-  tensor(0.2869, device='cuda:1') (0.1160334125161171)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.564633
Original XAI WIoU for r=0.6 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6402, device='cuda:1')  +-  tensor(0.3048, device='cuda:1') (0.09124822914600372)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.569069
Original XAI WIoU for r=0.9 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7664, device='cuda:1')  +-  tensor(0.3254, device='cuda:1') (0.005273838061839342)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.949313
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3008, device='cuda:1')  +-  tensor(0.1264, device='cuda:1') (0.1185636818408966)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.829435
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3419, device='cuda:1')  +-  tensor(0.1531, device='cuda:1') (0.12305351346731186)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.501958
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3729, device='cuda:1')  +-  tensor(0.1895, device='cuda:1') (4.305222400802222e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.521936
Original XAI WIoU for r=0.3 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6208, device='cuda:1')  +-  tensor(0.1953, device='cuda:1') (0.17123888432979584)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.519083
Original XAI WIoU for r=0.6 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5970, device='cuda:1')  +-  tensor(0.1882, device='cuda:1') (0.12971678376197815)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.781843
Original XAI WIoU for r=0.9 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6949, device='cuda:1')  +-  tensor(0.2762, device='cuda:1') (4.842507284052999e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:47:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:47:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.720
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.822



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.535791
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6182, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.1094677746295929)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.763290
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6164, device='cuda:1')  +-  tensor(0.2941, device='cuda:1') (0.0814860388636589)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.544523
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6609, device='cuda:1')  +-  tensor(0.3356, device='cuda:1') (0.003086445154622197)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.761533
Original XAI WIoU for r=0.3 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6216, device='cuda:1')  +-  tensor(0.2697, device='cuda:1') (0.11071868985891342)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.520280
Original XAI WIoU for r=0.6 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6213, device='cuda:1')  +-  tensor(0.2916, device='cuda:1') (0.08301839977502823)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.775072
Original XAI WIoU for r=0.9 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6611, device='cuda:1')  +-  tensor(0.3338, device='cuda:1') (0.002787120873108506)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.701086
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2811, device='cuda:1')  +-  tensor(0.0973, device='cuda:1') (0.0771632194519043)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.919980
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2750, device='cuda:1')  +-  tensor(0.1107, device='cuda:1') (0.06990095973014832)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.730031
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1442, device='cuda:1') (3.2164220176156277e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.536479
Original XAI WIoU for r=0.3 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6979, device='cuda:1')  +-  tensor(0.1169, device='cuda:1') (0.13592174649238586)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.521805
Original XAI WIoU for r=0.6 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6570, device='cuda:1')  +-  tensor(0.1596, device='cuda:1') (0.10087615996599197)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.576172
Original XAI WIoU for r=0.9 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9088, device='cuda:1')  +-  tensor(0.1369, device='cuda:1') (2.5184370144870627e-09)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.76367326 0.76367326 0.7636732 ] +- [0.07432533 0.07432533 0.07432535] (mean across ratios: 0.7636732379595438)
(id) id_val WIOU_PERTURBED: 	[0.62006891 0.60954548 0.65064429] +- [0.00820382 0.01653872 0.068521  ] (mean across ratios: 0.6267528931299845)
(id) id_test WIOU_ORIGINAL: 	[0.76730324 0.76730324 0.76730324] +- [0.07490313 0.07490313 0.07490313] (mean across ratios: 0.7673032402992247)
(id) id_test WIOU_PERTURBED: 	[0.62459854 0.61213391 0.65538684] +- [0.00843827 0.01683172 0.06948013] (mean across ratios: 0.6307064294815063)
(id) val WIOU_ORIGINAL: 	[0.98065076 0.98065083 0.98065076] +- [0.02661752 0.02661738 0.02661752] (mean across ratios: 0.980650782585144)
(id) val WIOU_PERTURBED: 	[0.28603032 0.31157386 0.42984248] +- [0.01132899 0.02167699 0.07991874] (mean across ratios: 0.3424822171529134)
(id) test WIOU_ORIGINAL: 	[0.81706636 0.81706636 0.81706636] +- [0.08885075 0.08885075 0.08885075] (mean across ratios: 0.8170663595199587)
(id) test WIOU_PERTURBED: 	[0.71369486 0.72412544 0.77114437] +- [0.06692757 0.0831328  0.08709049] (mean across ratios: 0.7363215565681457)
DONE LECI GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:53:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 07:53:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.600
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.599
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.626
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.607
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.409
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.358
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.232
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.250



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.259409
Original XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5062, device='cuda:1')  +-  tensor(0.2746, device='cuda:1') (0.0891212522983551)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.210832
Original XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4850, device='cuda:1')  +-  tensor(0.2516, device='cuda:1') (0.06618913263082504)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.174324
Original XAI WIoU for r=0.9 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4840, device='cuda:1')  +-  tensor(0.2566, device='cuda:1') (0.004684632644057274)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.253580
Original XAI WIoU for r=0.3 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5068, device='cuda:1')  +-  tensor(0.2735, device='cuda:1') (0.09108968079090118)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.197183
Original XAI WIoU for r=0.6 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4863, device='cuda:1')  +-  tensor(0.2474, device='cuda:1') (0.06713486462831497)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.184244
Original XAI WIoU for r=0.9 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4839, device='cuda:1')  +-  tensor(0.2533, device='cuda:1') (0.005012597423046827)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.285366
Original XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2251, device='cuda:1')  +-  tensor(0.0713, device='cuda:1') (0.04363134875893593)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.257444
Original XAI WIoU for r=0.6 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2163, device='cuda:1')  +-  tensor(0.0741, device='cuda:1') (0.03878754749894142)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.451830
Original XAI WIoU for r=0.9 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2434, device='cuda:1')  +-  tensor(0.1167, device='cuda:1') (0.007676770910620689)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.224048
Original XAI WIoU for r=0.3 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3233, device='cuda:1')  +-  tensor(0.1771, device='cuda:1') (0.06166302412748337)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.198052
Original XAI WIoU for r=0.6 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3064, device='cuda:1')  +-  tensor(0.1534, device='cuda:1') (0.04201798886060715)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.168427
Original XAI WIoU for r=0.9 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2553, device='cuda:1')  +-  tensor(0.1201, device='cuda:1') (0.001885684672743082)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 19:57:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 07:57:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.480
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.509
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.508
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.474
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.341
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.308
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.311



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.245676
Original XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5074, device='cuda:1')  +-  tensor(0.2762, device='cuda:1') (0.06054564192891121)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.196746
Original XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5010, device='cuda:1')  +-  tensor(0.2702, device='cuda:1') (0.03377798944711685)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.957681
Original XAI WIoU for r=0.9 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5241, device='cuda:1')  +-  tensor(0.2902, device='cuda:1') (0.009651904925704002)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.200212
Original XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5039, device='cuda:1')  +-  tensor(0.2721, device='cuda:1') (0.05885200947523117)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.201722
Original XAI WIoU for r=0.6 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4982, device='cuda:1')  +-  tensor(0.2653, device='cuda:1') (0.033454522490501404)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.179040
Original XAI WIoU for r=0.9 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5207, device='cuda:1')  +-  tensor(0.2844, device='cuda:1') (0.009482448920607567)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.267624
Original XAI WIoU for r=0.3 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2842, device='cuda:1')  +-  tensor(0.0683, device='cuda:1') (0.054565612226724625)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.254840
Original XAI WIoU for r=0.6 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2914, device='cuda:1')  +-  tensor(0.0774, device='cuda:1') (0.06073616445064545)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.240203
Original XAI WIoU for r=0.9 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4867, device='cuda:1')  +-  tensor(0.2210, device='cuda:1') (0.024687856435775757)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.204065
Original XAI WIoU for r=0.3 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3451, device='cuda:1')  +-  tensor(0.1131, device='cuda:1') (0.049905017018318176)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.178155
Original XAI WIoU for r=0.6 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3226, device='cuda:1')  +-  tensor(0.1103, device='cuda:1') (0.031090104952454567)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.193237
Original XAI WIoU for r=0.9 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3021, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.001993334386497736)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:02:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:02:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.691
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.909
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.907
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.906
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.140
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.218
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.231



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.193631
Original XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5934, device='cuda:1')  +-  tensor(0.2754, device='cuda:1') (0.11502613872289658)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.189608
Original XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5703, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.0889827236533165)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.172519
Original XAI WIoU for r=0.9 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6933, device='cuda:1')  +-  tensor(0.2934, device='cuda:1') (0.009100199677050114)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.184200
Original XAI WIoU for r=0.3 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5978, device='cuda:1')  +-  tensor(0.2713, device='cuda:1') (0.11565779149532318)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.413405
Original XAI WIoU for r=0.6 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5739, device='cuda:1')  +-  tensor(0.2699, device='cuda:1') (0.09130299836397171)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.175877
Original XAI WIoU for r=0.9 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7040, device='cuda:1')  +-  tensor(0.2862, device='cuda:1') (0.009892665781080723)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.245629
Original XAI WIoU for r=0.3 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4357, device='cuda:1')  +-  tensor(0.1346, device='cuda:1') (0.16174644231796265)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.228541
Original XAI WIoU for r=0.6 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4348, device='cuda:1')  +-  tensor(0.1613, device='cuda:1') (0.14863434433937073)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.254361
Original XAI WIoU for r=0.9 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7174, device='cuda:1')  +-  tensor(0.2762, device='cuda:1') (0.018269307911396027)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.175334
Original XAI WIoU for r=0.3 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3547, device='cuda:1')  +-  tensor(0.2119, device='cuda:1') (0.08303266018629074)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.176074
Original XAI WIoU for r=0.6 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3490, device='cuda:1')  +-  tensor(0.2123, device='cuda:1') (0.07464893162250519)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.166001
Original XAI WIoU for r=0.9 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2402, device='cuda:1')  +-  tensor(0.1255, device='cuda:1') (0.0026180699933320284)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:07:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:07:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.510
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.515
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.507
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.294
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.166
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.292
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.187014
Original XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5087, device='cuda:1')  +-  tensor(0.2961, device='cuda:1') (0.05720663443207741)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.195677
Original XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4974, device='cuda:1')  +-  tensor(0.2861, device='cuda:1') (0.05211668834090233)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.178834
Original XAI WIoU for r=0.9 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5161, device='cuda:1')  +-  tensor(0.2952, device='cuda:1') (0.008675329387187958)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.190544
Original XAI WIoU for r=0.3 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5068, device='cuda:1')  +-  tensor(0.2937, device='cuda:1') (0.055833667516708374)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.177531
Original XAI WIoU for r=0.6 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4938, device='cuda:1')  +-  tensor(0.2824, device='cuda:1') (0.05059272050857544)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.179972
Original XAI WIoU for r=0.9 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5137, device='cuda:1')  +-  tensor(0.2899, device='cuda:1') (0.008336956612765789)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.488136
Original XAI WIoU for r=0.3 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2701, device='cuda:1')  +-  tensor(0.0712, device='cuda:1') (0.05534042418003082)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.236694
Original XAI WIoU for r=0.6 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2787, device='cuda:1')  +-  tensor(0.0789, device='cuda:1') (0.059962522238492966)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.987441
Original XAI WIoU for r=0.9 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4522, device='cuda:1')  +-  tensor(0.2079, device='cuda:1') (0.02370498888194561)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.156904
Original XAI WIoU for r=0.3 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3219, device='cuda:1')  +-  tensor(0.1366, device='cuda:1') (0.056578461080789566)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.184742
Original XAI WIoU for r=0.6 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3028, device='cuda:1')  +-  tensor(0.1356, device='cuda:1') (0.041538055986166)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.160924
Original XAI WIoU for r=0.9 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2681, device='cuda:1')  +-  tensor(0.1175, device='cuda:1') (0.0019340567523613572)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:12:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:12:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.367
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.471
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.467
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.330
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.187
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.190294
Original XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3304, device='cuda:1')  +-  tensor(0.1651, device='cuda:1') (0.09110987931489944)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.423070
Original XAI WIoU for r=0.6 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3210, device='cuda:1')  +-  tensor(0.1777, device='cuda:1') (0.06863056123256683)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.179299
Original XAI WIoU for r=0.9 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4373, device='cuda:1')  +-  tensor(0.2744, device='cuda:1') (0.00676304753869772)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.401656
Original XAI WIoU for r=0.3 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3312, device='cuda:1')  +-  tensor(0.1646, device='cuda:1') (0.08949645608663559)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.173588
Original XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3203, device='cuda:1')  +-  tensor(0.1754, device='cuda:1') (0.06688525527715683)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.413259
Original XAI WIoU for r=0.9 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4345, device='cuda:1')  +-  tensor(0.2678, device='cuda:1') (0.0068264915607869625)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.241458
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2400, device='cuda:1')  +-  tensor(0.0638, device='cuda:1') (0.06402722746133804)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.260594
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2340, device='cuda:1')  +-  tensor(0.0721, device='cuda:1') (0.06838645040988922)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.249458
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3521, device='cuda:1')  +-  tensor(0.2380, device='cuda:1') (0.014724100939929485)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.407176
Original XAI WIoU for r=0.3 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2631, device='cuda:1')  +-  tensor(0.0972, device='cuda:1') (0.09799859672784805)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.166897
Original XAI WIoU for r=0.6 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2249, device='cuda:1')  +-  tensor(0.1281, device='cuda:1') (0.034273676574230194)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.934510
Original XAI WIoU for r=0.9 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2763, device='cuda:1')  +-  tensor(0.0814, device='cuda:1') (0.003071838989853859)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.56387447 0.56387447 0.56387447] +- [0.09189798 0.09189798 0.09189798] (mean across ratios: 0.5638744711875916)
(id) id_val WIOU_PERTURBED: 	[0.48920919 0.47492943 0.53096116] +- [0.08613526 0.08256224 0.08673098] (mean across ratios: 0.49836659630139674)
(id) id_test WIOU_ORIGINAL: 	[0.56484793 0.56484793 0.56484793] +- [0.09662339 0.09662339 0.09662339] (mean across ratios: 0.5648479282855987)
(id) id_test WIOU_PERTURBED: 	[0.4893204  0.47450502 0.5313601 ] +- [0.08670707 0.08334595 0.09150631] (mean across ratios: 0.49839517076810197)
(id) val WIOU_ORIGINAL: 	[0.44159026 0.44159026 0.44159026] +- [0.23328466 0.23328466 0.23328466] (mean across ratios: 0.4415902614593506)
(id) val WIOU_PERTURBED: 	[0.29101336 0.29106214 0.45036983] +- [0.07533704 0.07703109 0.1581783 ] (mean across ratios: 0.3441484451293945)
(id) test WIOU_ORIGINAL: 	[0.26772853 0.26772853 0.26772853] +- [0.026681 0.026681 0.026681] (mean across ratios: 0.26772852540016173)
(id) test WIOU_PERTURBED: 	[0.32161223 0.30114188 0.26838496] +- [0.03185639 0.04145546 0.020834  ] (mean across ratios: 0.2970463593800863)
DONE CIGA GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:17:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:17:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.600
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.599
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.626
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.607
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.409
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.358
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.232
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.250



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.301245
Original XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5144, device='cuda:1')  +-  tensor(0.3027, device='cuda:1') (0.0817803367972374)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.256672
Original XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4879, device='cuda:1')  +-  tensor(0.2688, device='cuda:1') (0.052724070847034454)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.235560
Original XAI WIoU for r=0.9 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4790, device='cuda:1')  +-  tensor(0.2578, device='cuda:1') (0.0014533017529174685)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.284202
Original XAI WIoU for r=0.3 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5136, device='cuda:1')  +-  tensor(0.3006, device='cuda:1') (0.0838954821228981)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.216773
Original XAI WIoU for r=0.6 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4878, device='cuda:1')  +-  tensor(0.2663, device='cuda:1') (0.053836528211832047)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.214574
Original XAI WIoU for r=0.9 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4792, device='cuda:1')  +-  tensor(0.2557, device='cuda:1') (0.0012559773167595267)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.331467
Original XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2337, device='cuda:1')  +-  tensor(0.0876, device='cuda:1') (0.0403168722987175)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.306364
Original XAI WIoU for r=0.6 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2303, device='cuda:1')  +-  tensor(0.0962, device='cuda:1') (0.03339291736483574)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.510833
Original XAI WIoU for r=0.9 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2452, device='cuda:1')  +-  tensor(0.1178, device='cuda:1') (2.128315523819424e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.270228
Original XAI WIoU for r=0.3 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4012, device='cuda:1')  +-  tensor(0.2330, device='cuda:1') (0.07274734228849411)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.261597
Original XAI WIoU for r=0.6 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3723, device='cuda:1')  +-  tensor(0.2054, device='cuda:1') (0.0567222498357296)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.233752
Original XAI WIoU for r=0.9 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2563, device='cuda:1')  +-  tensor(0.1198, device='cuda:1') (6.461304824512126e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:22:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:22:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.481
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.509
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.508
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.474
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.341
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.308
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.311



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.236917
Original XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5181, device='cuda:1')  +-  tensor(0.2962, device='cuda:1') (0.052478861063718796)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.215427
Original XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4982, device='cuda:1')  +-  tensor(0.2794, device='cuda:1') (0.03095594234764576)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.970345
Original XAI WIoU for r=0.9 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5256, device='cuda:1')  +-  tensor(0.2888, device='cuda:1') (0.0032965578138828278)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.215106
Original XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5153, device='cuda:1')  +-  tensor(0.2922, device='cuda:1') (0.05328010022640228)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.217140
Original XAI WIoU for r=0.6 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4956, device='cuda:1')  +-  tensor(0.2750, device='cuda:1') (0.031145362183451653)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.188491
Original XAI WIoU for r=0.9 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5222, device='cuda:1')  +-  tensor(0.2834, device='cuda:1') (0.0029020824003964663)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.271173
Original XAI WIoU for r=0.3 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2734, device='cuda:1')  +-  tensor(0.0831, device='cuda:1') (0.058564819395542145)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.265148
Original XAI WIoU for r=0.6 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2877, device='cuda:1')  +-  tensor(0.0812, device='cuda:1') (0.05723729357123375)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.268435
Original XAI WIoU for r=0.9 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4912, device='cuda:1')  +-  tensor(0.2171, device='cuda:1') (4.21498080882543e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.218590
Original XAI WIoU for r=0.3 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4289, device='cuda:1')  +-  tensor(0.1812, device='cuda:1') (0.07655256986618042)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.181258
Original XAI WIoU for r=0.6 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3481, device='cuda:1')  +-  tensor(0.1524, device='cuda:1') (0.03131277486681938)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.207338
Original XAI WIoU for r=0.9 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2960, device='cuda:1')  +-  tensor(0.1185, device='cuda:1') (1.7881736091851508e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:26:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:26:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.691
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.909
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.907
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.906
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.140
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.218
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.231



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.205012
Original XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5767, device='cuda:1')  +-  tensor(0.2965, device='cuda:1') (0.10587349534034729)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.211371
Original XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5478, device='cuda:1')  +-  tensor(0.2973, device='cuda:1') (0.06911793351173401)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.198152
Original XAI WIoU for r=0.9 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6926, device='cuda:1')  +-  tensor(0.2949, device='cuda:1') (0.0036857845261693)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.444112
Original XAI WIoU for r=0.3 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5793, device='cuda:1')  +-  tensor(0.2935, device='cuda:1') (0.10611800104379654)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.202383
Original XAI WIoU for r=0.6 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5477, device='cuda:1')  +-  tensor(0.2934, device='cuda:1') (0.0719817578792572)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.192118
Original XAI WIoU for r=0.9 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7025, device='cuda:1')  +-  tensor(0.2869, device='cuda:1') (0.003630418097600341)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.243281
Original XAI WIoU for r=0.3 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3260, device='cuda:1')  +-  tensor(0.1079, device='cuda:1') (0.11549198627471924)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.265586
Original XAI WIoU for r=0.6 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3461, device='cuda:1')  +-  tensor(0.1322, device='cuda:1') (0.10452008247375488)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.490371
Original XAI WIoU for r=0.9 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7145, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (1.498289670109898e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.192979
Original XAI WIoU for r=0.3 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4734, device='cuda:1')  +-  tensor(0.2868, device='cuda:1') (0.10666050016880035)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.216868
Original XAI WIoU for r=0.6 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4459, device='cuda:1')  +-  tensor(0.2804, device='cuda:1') (0.06511984020471573)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.207031
Original XAI WIoU for r=0.9 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2409, device='cuda:1')  +-  tensor(0.1252, device='cuda:1') (1.6812720105008339e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:31:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:31:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.510
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.515
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.507
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.294
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.166
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.292
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.223213
Original XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5245, device='cuda:1')  +-  tensor(0.3127, device='cuda:1') (0.057947587221860886)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.228964
Original XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5041, device='cuda:1')  +-  tensor(0.2972, device='cuda:1') (0.05399072542786598)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.208822
Original XAI WIoU for r=0.9 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5183, device='cuda:1')  +-  tensor(0.2934, device='cuda:1') (0.0033256104215979576)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.460888
Original XAI WIoU for r=0.3 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5213, device='cuda:1')  +-  tensor(0.3079, device='cuda:1') (0.05747346952557564)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.225206
Original XAI WIoU for r=0.6 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5016, device='cuda:1')  +-  tensor(0.2960, device='cuda:1') (0.05212824046611786)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.201652
Original XAI WIoU for r=0.9 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5157, device='cuda:1')  +-  tensor(0.2884, device='cuda:1') (0.00301849446259439)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.256611
Original XAI WIoU for r=0.3 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2729, device='cuda:1')  +-  tensor(0.0909, device='cuda:1') (0.061563968658447266)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.274557
Original XAI WIoU for r=0.6 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2879, device='cuda:1')  +-  tensor(0.0925, device='cuda:1') (0.06342983990907669)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.518011
Original XAI WIoU for r=0.9 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4565, device='cuda:1')  +-  tensor(0.2025, device='cuda:1') (5.581100914753279e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.214810
Original XAI WIoU for r=0.3 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4245, device='cuda:1')  +-  tensor(0.2184, device='cuda:1') (0.08238473534584045)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.246923
Original XAI WIoU for r=0.6 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3537, device='cuda:1')  +-  tensor(0.1965, device='cuda:1') (0.050349801778793335)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.226357
Original XAI WIoU for r=0.9 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2658, device='cuda:1')  +-  tensor(0.1192, device='cuda:1') (5.553334458952008e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:36:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 08:36:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.367
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.471
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.467
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.330
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.187
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.257937
Original XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3287, device='cuda:1')  +-  tensor(0.1985, device='cuda:1') (0.08414536714553833)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.243080
Original XAI WIoU for r=0.6 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2995, device='cuda:1')  +-  tensor(0.1861, device='cuda:1') (0.06281042098999023)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.492679
Original XAI WIoU for r=0.9 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.2753, device='cuda:1') (0.0013584611006081104)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.241290
Original XAI WIoU for r=0.3 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3319, device='cuda:1')  +-  tensor(0.1977, device='cuda:1') (0.08381347358226776)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.006422
Original XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3026, device='cuda:1')  +-  tensor(0.1822, device='cuda:1') (0.06020615994930267)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.259127
Original XAI WIoU for r=0.9 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4344, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.001260399934835732)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.286685
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2063, device='cuda:1')  +-  tensor(0.0688, device='cuda:1') (0.07170800864696503)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.290501
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1992, device='cuda:1')  +-  tensor(0.0899, device='cuda:1') (0.06963225454092026)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.063014
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3428, device='cuda:1')  +-  tensor(0.2430, device='cuda:1') (2.54342746863756e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.225365
Original XAI WIoU for r=0.3 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4048, device='cuda:1')  +-  tensor(0.3066, device='cuda:1') (0.07419108599424362)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.233120
Original XAI WIoU for r=0.6 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2141, device='cuda:1')  +-  tensor(0.1357, device='cuda:1') (0.025585487484931946)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.266571
Original XAI WIoU for r=0.9 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2779, device='cuda:1')  +-  tensor(0.0820, device='cuda:1') (2.92383051103684e-09)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.56387447 0.56387447 0.56387447] +- [0.09189798 0.09189798 0.09189798] (mean across ratios: 0.5638744711875916)
(id) id_val WIOU_PERTURBED: 	[0.49246473 0.46751177 0.53068609] +- [0.08495035 0.08647228 0.08680455] (mean across ratios: 0.4968875308831533)
(id) id_test WIOU_ORIGINAL: 	[0.56484793 0.56484793 0.56484793] +- [0.09662339 0.09662339 0.09662339] (mean across ratios: 0.5648479282855987)
(id) id_test WIOU_PERTURBED: 	[0.49229544 0.46704959 0.5308035 ] +- [0.08382694 0.08483583 0.09135895] (mean across ratios: 0.4967161774635315)
(id) val WIOU_ORIGINAL: 	[0.44159026 0.44159026 0.44159026] +- [0.23328466 0.23328466 0.23328466] (mean across ratios: 0.4415902614593506)
(id) val WIOU_PERTURBED: 	[0.26247912 0.27022032 0.45005701] +- [0.04061743 0.05101386 0.15819472] (mean across ratios: 0.32758548160394035)
(id) test WIOU_ORIGINAL: 	[0.26772853 0.26772853 0.26772853] +- [0.026681 0.026681 0.026681] (mean across ratios: 0.26772852540016173)
(id) test WIOU_PERTURBED: 	[0.42655485 0.34683386 0.26739293] +- [0.02576271 0.0749926  0.01873893] (mean across ratios: 0.34692721366882323)
DONE CIGA GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:41:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 08:41:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.574
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.273



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.642417
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3766, device='cuda:1')  +-  tensor(0.2189, device='cuda:1') (0.005665030796080828)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.535494
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3760, device='cuda:1')  +-  tensor(0.2173, device='cuda:1') (0.004336845129728317)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.552235
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3382, device='cuda:1')  +-  tensor(0.1670, device='cuda:1') (0.0003568118845578283)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.589927
Original XAI WIoU for r=0.3 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3757, device='cuda:1')  +-  tensor(0.2189, device='cuda:1') (0.005572238937020302)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.567667
Original XAI WIoU for r=0.6 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3750, device='cuda:1')  +-  tensor(0.2174, device='cuda:1') (0.004278401844203472)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.531985
Original XAI WIoU for r=0.9 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3374, device='cuda:1')  +-  tensor(0.1664, device='cuda:1') (0.0003370130725670606)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.841454
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1852, device='cuda:1')  +-  tensor(0.0564, device='cuda:1') (0.005617544520646334)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.782617
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1859, device='cuda:1')  +-  tensor(0.0568, device='cuda:1') (0.005439477041363716)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.832958
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1796, device='cuda:1')  +-  tensor(0.0525, device='cuda:1') (0.0006888663629069924)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.592729
Original XAI WIoU for r=0.3 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2967, device='cuda:1')  +-  tensor(0.1212, device='cuda:1') (0.005347910337150097)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.570721
Original XAI WIoU for r=0.6 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2983, device='cuda:1')  +-  tensor(0.1225, device='cuda:1') (0.004187501035630703)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.532673
Original XAI WIoU for r=0.9 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2814, device='cuda:1')  +-  tensor(0.1036, device='cuda:1') (0.0004904008819721639)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:46:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 08:46:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.547
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.498
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.332
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.269



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.608894
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3727, device='cuda:1')  +-  tensor(0.2156, device='cuda:1') (0.005184461362659931)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.546764
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3715, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.003713218728080392)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.568421
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3341, device='cuda:1')  +-  tensor(0.1648, device='cuda:1') (0.00037343052099458873)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.563161
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3719, device='cuda:1')  +-  tensor(0.2159, device='cuda:1') (0.004978714045137167)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.567119
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3708, device='cuda:1')  +-  tensor(0.2142, device='cuda:1') (0.0037059313617646694)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.560996
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1647, device='cuda:1') (0.0003649047575891018)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.895563
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1848, device='cuda:1')  +-  tensor(0.0553, device='cuda:1') (0.004211949184536934)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.577476
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1850, device='cuda:1')  +-  tensor(0.0559, device='cuda:1') (0.0042335563339293)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.818840
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1814, device='cuda:1')  +-  tensor(0.0510, device='cuda:1') (0.0005315777962096035)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.602595
Original XAI WIoU for r=0.3 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2951, device='cuda:1')  +-  tensor(0.1184, device='cuda:1') (0.003568271640688181)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.576893
Original XAI WIoU for r=0.6 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2956, device='cuda:1')  +-  tensor(0.1187, device='cuda:1') (0.0019193687476217747)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.600245
Original XAI WIoU for r=0.9 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2768, device='cuda:1')  +-  tensor(0.0981, device='cuda:1') (0.0004768618382513523)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:51:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 08:51:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.546
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.265



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.578672
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.2160, device='cuda:1') (0.004816038999706507)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.784132
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3695, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.0037944596260786057)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.569638
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3329, device='cuda:1')  +-  tensor(0.1649, device='cuda:1') (0.00040297614759765565)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.782795
Original XAI WIoU for r=0.3 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3695, device='cuda:1')  +-  tensor(0.2160, device='cuda:1') (0.004726033192127943)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.543181
Original XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3685, device='cuda:1')  +-  tensor(0.2149, device='cuda:1') (0.003672299673780799)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.325091
Original XAI WIoU for r=0.9 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3325, device='cuda:1')  +-  tensor(0.1646, device='cuda:1') (0.0003784993023145944)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.050424
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1839, device='cuda:1')  +-  tensor(0.0551, device='cuda:1') (0.0047209663316607475)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.807463
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1849, device='cuda:1')  +-  tensor(0.0554, device='cuda:1') (0.004516798071563244)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.809362
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1788, device='cuda:1')  +-  tensor(0.0505, device='cuda:1') (0.0007270209025591612)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.823670
Original XAI WIoU for r=0.3 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2942, device='cuda:1')  +-  tensor(0.1194, device='cuda:1') (0.0031423040200024843)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.567945
Original XAI WIoU for r=0.6 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2955, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.0018224755767732859)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.572733
Original XAI WIoU for r=0.9 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2768, device='cuda:1')  +-  tensor(0.1003, device='cuda:1') (0.0004456087772268802)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 20:56:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 08:56:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.370
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.293
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.545547
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3702, device='cuda:1')  +-  tensor(0.2140, device='cuda:1') (0.005487021524459124)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.548128
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3701, device='cuda:1')  +-  tensor(0.2140, device='cuda:1') (0.004709606524556875)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.542447
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3340, device='cuda:1')  +-  tensor(0.1649, device='cuda:1') (0.0003127711242996156)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.786909
Original XAI WIoU for r=0.3 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3693, device='cuda:1')  +-  tensor(0.2143, device='cuda:1') (0.0054089087061584)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.543982
Original XAI WIoU for r=0.6 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3692, device='cuda:1')  +-  tensor(0.2140, device='cuda:1') (0.004581996705383062)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.538014
Original XAI WIoU for r=0.9 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3336, device='cuda:1')  +-  tensor(0.1646, device='cuda:1') (0.0002940608246717602)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.786878
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1838, device='cuda:1')  +-  tensor(0.0552, device='cuda:1') (0.004718075506389141)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.805230
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1843, device='cuda:1')  +-  tensor(0.0553, device='cuda:1') (0.004514333792030811)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.020590
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1806, device='cuda:1')  +-  tensor(0.0499, device='cuda:1') (0.00068806076887995)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.529597
Original XAI WIoU for r=0.3 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2936, device='cuda:1')  +-  tensor(0.1192, device='cuda:1') (0.003667298937216401)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.539153
Original XAI WIoU for r=0.6 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2908, device='cuda:1')  +-  tensor(0.1160, device='cuda:1') (0.002170869382098317)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.545375
Original XAI WIoU for r=0.9 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2712, device='cuda:1')  +-  tensor(0.0987, device='cuda:1') (0.00042124048923142254)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:00:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 09:00:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.255



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.600339
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3737, device='cuda:1')  +-  tensor(0.2168, device='cuda:1') (0.005390816833823919)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.703675
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3723, device='cuda:1')  +-  tensor(0.2151, device='cuda:1') (0.004760135430842638)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.572356
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3367, device='cuda:1')  +-  tensor(0.1668, device='cuda:1') (0.00038494521868415177)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.545470
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3728, device='cuda:1')  +-  tensor(0.2168, device='cuda:1') (0.005356095731258392)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.296984
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3716, device='cuda:1')  +-  tensor(0.2153, device='cuda:1') (0.004634993616491556)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.556278
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1667, device='cuda:1') (0.00037595696630887687)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.803174
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.0555, device='cuda:1') (0.004628441296517849)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.782431
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1862, device='cuda:1')  +-  tensor(0.0558, device='cuda:1') (0.004456197842955589)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.823990
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1805, device='cuda:1')  +-  tensor(0.0503, device='cuda:1') (0.0005738964537158608)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.547274
Original XAI WIoU for r=0.3 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2947, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.0038233476225286722)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.568774
Original XAI WIoU for r=0.6 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2909, device='cuda:1')  +-  tensor(0.1166, device='cuda:1') (0.0018444013549014926)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.563938
Original XAI WIoU for r=0.9 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2704, device='cuda:1')  +-  tensor(0.0952, device='cuda:1') (0.00032148612081073225)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32386567 0.3238658  0.32386587] +- [0.00206975 0.00206961 0.00206954] (mean across ratios: 0.32386577924092613)
(id) id_val WIOU_PERTURBED: 	[0.37273659 0.37189828 0.33520068] +- [0.00233731 0.00227112 0.00195876] (mean across ratios: 0.3599451800187429)
(id) id_test WIOU_ORIGINAL: 	[0.32323692 0.32323699 0.32323719] +- [0.00206096 0.00206089 0.00206087] (mean across ratios: 0.3232370356718699)
(id) id_test WIOU_PERTURBED: 	[0.37185985 0.37102528 0.33482519] +- [0.0023609  0.00227144 0.0018758 ] (mean across ratios: 0.35923677484194433)
(id) val WIOU_ORIGINAL: 	[0.17075033 0.17075033 0.17075033] +- [0.00277182 0.00277182 0.00277182] (mean across ratios: 0.17075033187866215)
(id) val WIOU_PERTURBED: 	[0.18460597 0.18524428 0.18018139] +- [0.00067771 0.000699   0.00092269] (mean across ratios: 0.1833438803752263)
(id) test WIOU_ORIGINAL: 	[0.26244532 0.26244532 0.26244532] +- [0.00308772 0.00308772 0.00308772] (mean across ratios: 0.26244532465934756)
(id) test WIOU_PERTURBED: 	[0.29483492 0.29423398 0.27529461] +- [0.00103951 0.00292206 0.00405731] (mean across ratios: 0.2881211717923482)
DONE GSAT GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:06:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 09:06:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.574
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.273



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.670725
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4091, device='cuda:1')  +-  tensor(0.2564, device='cuda:1') (0.005678172223269939)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.605059
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4038, device='cuda:1')  +-  tensor(0.2465, device='cuda:1') (0.004373791161924601)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.643500
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3392, device='cuda:1')  +-  tensor(0.1661, device='cuda:1') (0.00014002910756971687)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.659964
Original XAI WIoU for r=0.3 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4082, device='cuda:1')  +-  tensor(0.2568, device='cuda:1') (0.005652074236422777)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.643770
Original XAI WIoU for r=0.6 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4024, device='cuda:1')  +-  tensor(0.2467, device='cuda:1') (0.004375950433313847)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.589496
Original XAI WIoU for r=0.9 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3385, device='cuda:1')  +-  tensor(0.1655, device='cuda:1') (0.00011965184967266396)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.107622
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2050, device='cuda:1')  +-  tensor(0.0715, device='cuda:1') (0.006912482436746359)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.860373
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2065, device='cuda:1')  +-  tensor(0.0706, device='cuda:1') (0.005565942265093327)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.870013
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1807, device='cuda:1')  +-  tensor(0.0516, device='cuda:1') (1.5493802907329268e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.654657
Original XAI WIoU for r=0.3 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3389, device='cuda:1')  +-  tensor(0.1535, device='cuda:1') (0.006356763653457165)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.631812
Original XAI WIoU for r=0.6 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3329, device='cuda:1')  +-  tensor(0.1478, device='cuda:1') (0.0047512538731098175)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.855739
Original XAI WIoU for r=0.9 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2835, device='cuda:1')  +-  tensor(0.1018, device='cuda:1') (4.570393841163423e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:11:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 09:11:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.547
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.498
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.332
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.269



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.592496
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4059, device='cuda:1')  +-  tensor(0.2548, device='cuda:1') (0.005288545973598957)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.796748
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3936, device='cuda:1')  +-  tensor(0.2354, device='cuda:1') (0.00398592883720994)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.575913
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3350, device='cuda:1')  +-  tensor(0.1639, device='cuda:1') (0.00013989993021823466)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.594109
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4049, device='cuda:1')  +-  tensor(0.2553, device='cuda:1') (0.005152679979801178)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.572741
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3936, device='cuda:1')  +-  tensor(0.2371, device='cuda:1') (0.003942165523767471)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.809118
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3349, device='cuda:1')  +-  tensor(0.1638, device='cuda:1') (0.00012725114356726408)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.803695
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2037, device='cuda:1')  +-  tensor(0.0699, device='cuda:1') (0.005623233504593372)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.560295
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2057, device='cuda:1')  +-  tensor(0.0707, device='cuda:1') (0.004734874702990055)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.835350
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1824, device='cuda:1')  +-  tensor(0.0502, device='cuda:1') (1.8603671936290311e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.584514
Original XAI WIoU for r=0.3 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3331, device='cuda:1')  +-  tensor(0.1464, device='cuda:1') (0.004614426754415035)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.568622
Original XAI WIoU for r=0.6 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3249, device='cuda:1')  +-  tensor(0.1376, device='cuda:1') (0.001943918876349926)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.606677
Original XAI WIoU for r=0.9 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2796, device='cuda:1')  +-  tensor(0.0957, device='cuda:1') (6.3863345722836584e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:15:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 09:15:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.546
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.265



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.581516
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4035, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.004808102268725634)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.547469
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.2453, device='cuda:1') (0.0034868107177317142)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.578407
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3340, device='cuda:1')  +-  tensor(0.1639, device='cuda:1') (0.00015871506184339523)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.570513
Original XAI WIoU for r=0.3 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4025, device='cuda:1')  +-  tensor(0.2551, device='cuda:1') (0.004758661147207022)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.574112
Original XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3969, device='cuda:1')  +-  tensor(0.2455, device='cuda:1') (0.0034888654481619596)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.341922
Original XAI WIoU for r=0.9 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3335, device='cuda:1')  +-  tensor(0.1636, device='cuda:1') (0.00014264375204220414)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.770824
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2029, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.005677442066371441)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.784816
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2051, device='cuda:1')  +-  tensor(0.0689, device='cuda:1') (0.004705027211457491)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.825645
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1796, device='cuda:1')  +-  tensor(0.0500, device='cuda:1') (1.3800035558730883e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.559155
Original XAI WIoU for r=0.3 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3332, device='cuda:1')  +-  tensor(0.1486, device='cuda:1') (0.004737641662359238)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.569200
Original XAI WIoU for r=0.6 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3328, device='cuda:1')  +-  tensor(0.1478, device='cuda:1') (0.002017110586166382)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.586959
Original XAI WIoU for r=0.9 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2795, device='cuda:1')  +-  tensor(0.0979, device='cuda:1') (5.608867592599154e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:20:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 09:20:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.370
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.293
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.837575
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4029, device='cuda:1')  +-  tensor(0.2535, device='cuda:1') (0.0058608041144907475)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.586667
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3970, device='cuda:1')  +-  tensor(0.2436, device='cuda:1') (0.004305937327444553)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.595301
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3350, device='cuda:1')  +-  tensor(0.1640, device='cuda:1') (0.00014427377027459443)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.821625
Original XAI WIoU for r=0.3 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4019, device='cuda:1')  +-  tensor(0.2541, device='cuda:1') (0.005744949448853731)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.603110
Original XAI WIoU for r=0.6 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3960, device='cuda:1')  +-  tensor(0.2438, device='cuda:1') (0.00411537941545248)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.605311
Original XAI WIoU for r=0.9 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3346, device='cuda:1')  +-  tensor(0.1638, device='cuda:1') (0.00011703597556333989)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.812074
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2025, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.005726283881813288)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.975420
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2043, device='cuda:1')  +-  tensor(0.0703, device='cuda:1') (0.0048858243972063065)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.086475
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1814, device='cuda:1')  +-  tensor(0.0493, device='cuda:1') (1.4605269216261263e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.581146
Original XAI WIoU for r=0.3 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3322, device='cuda:1')  +-  tensor(0.1486, device='cuda:1') (0.004279543645679951)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.620091
Original XAI WIoU for r=0.6 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3138, device='cuda:1')  +-  tensor(0.1314, device='cuda:1') (0.0027248277328908443)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.627590
Original XAI WIoU for r=0.9 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2731, device='cuda:1')  +-  tensor(0.0973, device='cuda:1') (4.0761474195960545e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:25:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 09:25:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.255



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.815638
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4064, device='cuda:1')  +-  tensor(0.2549, device='cuda:1') (0.005315788555890322)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.579673
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4002, device='cuda:1')  +-  tensor(0.2448, device='cuda:1') (0.004605864640325308)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.358604
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3379, device='cuda:1')  +-  tensor(0.1658, device='cuda:1') (0.00015859078848734498)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.570408
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4053, device='cuda:1')  +-  tensor(0.2552, device='cuda:1') (0.005267867352813482)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.583730
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3991, device='cuda:1')  +-  tensor(0.2452, device='cuda:1') (0.00445803627371788)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.588352
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3377, device='cuda:1')  +-  tensor(0.1657, device='cuda:1') (0.00012654119927901775)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.795833
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2038, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.005985467229038477)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.825192
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2065, device='cuda:1')  +-  tensor(0.0703, device='cuda:1') (0.005098314024507999)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.852410
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1812, device='cuda:1')  +-  tensor(0.0497, device='cuda:1') (1.4771869283336514e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.585695
Original XAI WIoU for r=0.3 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3330, device='cuda:1')  +-  tensor(0.1492, device='cuda:1') (0.004263489972800016)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.579177
Original XAI WIoU for r=0.6 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3170, device='cuda:1')  +-  tensor(0.1347, device='cuda:1') (0.002524494891986251)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.628993
Original XAI WIoU for r=0.9 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2730, device='cuda:1')  +-  tensor(0.0929, device='cuda:1') (1.1114339031337295e-06)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32386574 0.32386587 0.32386587] +- [0.00206968 0.00206954 0.00206954] (mean across ratios: 0.3238658229509989)
(id) id_val WIOU_PERTURBED: 	[0.40556634 0.39858685 0.33622241] +- [0.00223538 0.00336519 0.00196942] (mean across ratios: 0.3801251987616221)
(id) id_test WIOU_ORIGINAL: 	[0.32323713 0.32323706 0.32323706] +- [0.00206095 0.00206082 0.00206094] (mean across ratios: 0.3232370813687642)
(id) id_test WIOU_PERTURBED: 	[0.40456364 0.39760722 0.33583683] +- [0.00224226 0.0029829  0.00191842] (mean across ratios: 0.37933589816093444)
(id) val WIOU_ORIGINAL: 	[0.17075033 0.1707504  0.17075033] +- [0.00277182 0.00277189 0.00277182] (mean across ratios: 0.17075035472710928)
(id) val WIOU_PERTURBED: 	[0.20356993 0.20560215 0.18107899] +- [0.00084438 0.00083809 0.00089216] (mean across ratios: 0.19675035774707794)
(id) test WIOU_ORIGINAL: 	[0.26244532 0.26244532 0.26244532] +- [0.00308772 0.00308772 0.00308772] (mean across ratios: 0.26244532465934756)
(id) test WIOU_PERTURBED: 	[0.33410702 0.32427117 0.27773125] +- [0.00241342 0.0078684  0.00409605] (mean across ratios: 0.31203647851943966)
DONE GSAT GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:31:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:31:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.671
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.764
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.775
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.267
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.403
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.448



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.510008
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5970, device='cuda:1')  +-  tensor(0.2707, device='cuda:1') (0.08667649328708649)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.448628
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5753, device='cuda:1')  +-  tensor(0.2678, device='cuda:1') (0.060887500643730164)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.483027
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7055, device='cuda:1')  +-  tensor(0.3081, device='cuda:1') (0.0003413892991375178)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.505658
Original XAI WIoU for r=0.3 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6085, device='cuda:1')  +-  tensor(0.2711, device='cuda:1') (0.08830596506595612)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.453287
Original XAI WIoU for r=0.6 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5858, device='cuda:1')  +-  tensor(0.2685, device='cuda:1') (0.06307365000247955)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.427554
Original XAI WIoU for r=0.9 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7221, device='cuda:1')  +-  tensor(0.3063, device='cuda:1') (0.00039262123755179346)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.403948
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.375995
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.351592
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.384481
Original XAI WIoU for r=0.3 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5039, device='cuda:1')  +-  tensor(0.1455, device='cuda:1') (0.056091856211423874)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.568071
Original XAI WIoU for r=0.6 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4915, device='cuda:1')  +-  tensor(0.1495, device='cuda:1') (0.034863412380218506)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.336351
Original XAI WIoU for r=0.9 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4834, device='cuda:1')  +-  tensor(0.1578, device='cuda:1') (0.0011506625451147556)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:35:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 09:35:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 09:35:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 09:35:58 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:00 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:36:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.641
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.755
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.760
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.284
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.472



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.648087
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5979, device='cuda:1')  +-  tensor(0.2810, device='cuda:1') (0.10041378438472748)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.680422
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5706, device='cuda:1')  +-  tensor(0.2712, device='cuda:1') (0.08679480850696564)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.457004
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6241, device='cuda:1')  +-  tensor(0.2774, device='cuda:1') (0.01649421453475952)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.480537
Original XAI WIoU for r=0.3 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6104, device='cuda:1')  +-  tensor(0.2812, device='cuda:1') (0.09791542589664459)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.432981
Original XAI WIoU for r=0.6 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5818, device='cuda:1')  +-  tensor(0.2711, device='cuda:1') (0.08671732246875763)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.444436
Original XAI WIoU for r=0.9 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6363, device='cuda:1')  +-  tensor(0.2703, device='cuda:1') (0.015347376465797424)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.379089
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.586522
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.340719
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.376033
Original XAI WIoU for r=0.3 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5035, device='cuda:1')  +-  tensor(0.1608, device='cuda:1') (0.05922022834420204)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.330747
Original XAI WIoU for r=0.6 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.1594, device='cuda:1') (0.04140616953372955)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.338297
Original XAI WIoU for r=0.9 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4697, device='cuda:1')  +-  tensor(0.1587, device='cuda:1') (0.0013808629009872675)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:40:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:26 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:40:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.797
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.798
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.582
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.608



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.667534
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6225, device='cuda:1')  +-  tensor(0.2847, device='cuda:1') (0.08496809005737305)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.428050
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6127, device='cuda:1')  +-  tensor(0.2827, device='cuda:1') (0.08458631485700607)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.653607
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6772, device='cuda:1')  +-  tensor(0.2989, device='cuda:1') (0.027999160811305046)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.550085
Original XAI WIoU for r=0.3 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6343, device='cuda:1')  +-  tensor(0.2839, device='cuda:1') (0.08396683633327484)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.174165
Original XAI WIoU for r=0.6 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6232, device='cuda:1')  +-  tensor(0.2808, device='cuda:1') (0.08429346978664398)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.416126
Original XAI WIoU for r=0.9 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6917, device='cuda:1')  +-  tensor(0.2932, device='cuda:1') (0.02674563229084015)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.337910
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9943, device='cuda:1')  +-  tensor(0.0441, device='cuda:1') (0.0019268564647063613)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.312417
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9954, device='cuda:1')  +-  tensor(0.0362, device='cuda:1') (0.0029068482108414173)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.357185
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.314603
Original XAI WIoU for r=0.3 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2097, device='cuda:1') (0.09447220712900162)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.065444
Original XAI WIoU for r=0.6 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7085, device='cuda:1')  +-  tensor(0.2227, device='cuda:1') (0.07176686823368073)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.316999
Original XAI WIoU for r=0.9 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7181, device='cuda:1')  +-  tensor(0.2294, device='cuda:1') (0.003732918296009302)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:45:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:09 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:25 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:27 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:45:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.738
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.835
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.830
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.410
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.548
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.457549
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.2610, device='cuda:1') (0.11642831563949585)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.441393
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6150, device='cuda:1')  +-  tensor(0.2480, device='cuda:1') (0.10781291872262955)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.431681
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7275, device='cuda:1')  +-  tensor(0.2916, device='cuda:1') (0.019796041771769524)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.433299
Original XAI WIoU for r=0.3 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6280, device='cuda:1')  +-  tensor(0.2568, device='cuda:1') (0.11960593611001968)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.177118
Original XAI WIoU for r=0.6 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6225, device='cuda:1')  +-  tensor(0.2445, device='cuda:1') (0.10919114947319031)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.436498
Original XAI WIoU for r=0.9 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7382, device='cuda:1')  +-  tensor(0.2877, device='cuda:1') (0.018618334084749222)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.344913
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9817, device='cuda:1')  +-  tensor(0.0489, device='cuda:1') (0.0040619345381855965)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.351756
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9793, device='cuda:1')  +-  tensor(0.0539, device='cuda:1') (6.464081270252109e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.120311
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1') (5.975387296075496e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.341104
Original XAI WIoU for r=0.3 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.1579, device='cuda:1') (0.0721898004412651)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.336440
Original XAI WIoU for r=0.6 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5152, device='cuda:1')  +-  tensor(0.1403, device='cuda:1') (0.05062006413936615)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.320223
Original XAI WIoU for r=0.9 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4779, device='cuda:1')  +-  tensor(0.1317, device='cuda:1') (0.0024277924094349146)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:49:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 09:49:52 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:50:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.812
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.810
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.414
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.511
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.425823
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6165, device='cuda:1')  +-  tensor(0.2665, device='cuda:1') (0.10125187039375305)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.431393
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6038, device='cuda:1')  +-  tensor(0.2725, device='cuda:1') (0.09071005880832672)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.426989
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6847, device='cuda:1')  +-  tensor(0.3170, device='cuda:1') (0.02352658286690712)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.418936
Original XAI WIoU for r=0.3 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6272, device='cuda:1')  +-  tensor(0.2621, device='cuda:1') (0.10172424465417862)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.426946
Original XAI WIoU for r=0.6 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6141, device='cuda:1')  +-  tensor(0.2703, device='cuda:1') (0.09318512678146362)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.414210
Original XAI WIoU for r=0.9 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6967, device='cuda:1')  +-  tensor(0.3082, device='cuda:1') (0.021380309015512466)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.381752
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0023, device='cuda:1') (7.153541082516313e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.323907
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0028, device='cuda:1') (1.9547736762604018e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.362924
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0014, device='cuda:1') (1.9547736762604018e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.315462
Original XAI WIoU for r=0.3 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5620, device='cuda:1')  +-  tensor(0.1650, device='cuda:1') (0.07093029469251633)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.348423
Original XAI WIoU for r=0.6 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5547, device='cuda:1')  +-  tensor(0.1601, device='cuda:1') (0.05671226978302002)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.302696
Original XAI WIoU for r=0.9 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5245, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.0021984719205647707)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127] (mean across ratios: 0.7854873299598694)
(id) id_val WIOU_PERTURBED: 	[0.61114535 0.5954779  0.6838217 ] +- [0.01134614 0.01884136 0.03461295] (mean across ratios: 0.6301483194033305)
(id) id_test WIOU_ORIGINAL: 	[0.79421998 0.79421998 0.79421998] +- [0.02474969 0.02474969 0.02474969] (mean across ratios: 0.7942199826240538)
(id) id_test WIOU_PERTURBED: 	[0.62169355 0.60547805 0.69698462] +- [0.01029666 0.01805741 0.03475021] (mean across ratios: 0.6413854082425435)
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648] (mean across ratios: 0.9960112810134888)
(id) val WIOU_PERTURBED: 	[0.99515246 0.99490519 0.9960122 ] +- [0.00708076 0.00798242 0.00793635] (mean across ratios: 0.9953566153844197)
(id) test WIOU_ORIGINAL: 	[0.50390714 0.50390722 0.50390708] +- [0.05632275 0.05632289 0.05632264] (mean across ratios: 0.5039071480433146)
(id) test WIOU_PERTURBED: 	[0.56431168 0.55213507 0.53470937] +- [0.08046348 0.08154441 0.09361123] (mean across ratios: 0.5503853758176168)
DONE LECI GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 21:55:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:11 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:24 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:26 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:28 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 09:55:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.671
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.764
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.775
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.267
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.403
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.448



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.683262
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5671, device='cuda:1')  +-  tensor(0.2675, device='cuda:1') (0.09331797063350677)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.611812
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5436, device='cuda:1')  +-  tensor(0.2730, device='cuda:1') (0.051607660949230194)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.625434
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7051, device='cuda:1')  +-  tensor(0.3087, device='cuda:1') (1.1015395102731418e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.673388
Original XAI WIoU for r=0.3 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5813, device='cuda:1')  +-  tensor(0.2696, device='cuda:1') (0.0950649231672287)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.622817
Original XAI WIoU for r=0.6 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5550, device='cuda:1')  +-  tensor(0.2734, device='cuda:1') (0.05346925929188728)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.608900
Original XAI WIoU for r=0.9 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7218, device='cuda:1')  +-  tensor(0.3067, device='cuda:1') (2.3874174075899646e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.559561
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.544204
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.529001
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.559664
Original XAI WIoU for r=0.3 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5571, device='cuda:1')  +-  tensor(0.1576, device='cuda:1') (0.07461715489625931)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.743062
Original XAI WIoU for r=0.6 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5264, device='cuda:1')  +-  tensor(0.1552, device='cuda:1') (0.0316958986222744)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.521948
Original XAI WIoU for r=0.9 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4849, device='cuda:1')  +-  tensor(0.1563, device='cuda:1') (2.177254154744901e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:00:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:00:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.641
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.755
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.760
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.284
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.472



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.803049
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5727, device='cuda:1')  +-  tensor(0.2876, device='cuda:1') (0.10407727211713791)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.830503
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5315, device='cuda:1')  +-  tensor(0.2789, device='cuda:1') (0.0840807631611824)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.615988
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6107, device='cuda:1')  +-  tensor(0.2896, device='cuda:1') (0.007057334762066603)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.628138
Original XAI WIoU for r=0.3 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5847, device='cuda:1')  +-  tensor(0.2868, device='cuda:1') (0.10353999584913254)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.590916
Original XAI WIoU for r=0.6 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5453, device='cuda:1')  +-  tensor(0.2798, device='cuda:1') (0.0837506577372551)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.616156
Original XAI WIoU for r=0.9 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6222, device='cuda:1')  +-  tensor(0.2833, device='cuda:1') (0.006727168802171946)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.526985
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.731833
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.520106
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.508655
Original XAI WIoU for r=0.3 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5540, device='cuda:1')  +-  tensor(0.1854, device='cuda:1') (0.07331154495477676)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.486096
Original XAI WIoU for r=0.6 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5267, device='cuda:1')  +-  tensor(0.1866, device='cuda:1') (0.04952232167124748)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.508340
Original XAI WIoU for r=0.9 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4703, device='cuda:1')  +-  tensor(0.1587, device='cuda:1') (4.21498080882543e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:05:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:18 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:05:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.797
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.798
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.582
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.608



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.670254
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5959, device='cuda:1')  +-  tensor(0.3030, device='cuda:1') (0.06909456849098206)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.633320
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5868, device='cuda:1')  +-  tensor(0.3064, device='cuda:1') (0.06552193313837051)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.751308
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6558, device='cuda:1')  +-  tensor(0.3144, device='cuda:1') (0.008211292326450348)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.581471
Original XAI WIoU for r=0.3 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6057, device='cuda:1')  +-  tensor(0.3051, device='cuda:1') (0.06741219758987427)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.595696
Original XAI WIoU for r=0.6 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5953, device='cuda:1')  +-  tensor(0.3076, device='cuda:1') (0.06471598893404007)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.594527
Original XAI WIoU for r=0.9 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6696, device='cuda:1')  +-  tensor(0.3093, device='cuda:1') (0.008484087884426117)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.514616
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9922, device='cuda:1')  +-  tensor(0.0456, device='cuda:1') (0.004374299198389053)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.734475
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9962, device='cuda:1')  +-  tensor(0.0266, device='cuda:1') (0.004498714581131935)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.520973
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.510889
Original XAI WIoU for r=0.3 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8013, device='cuda:1')  +-  tensor(0.1847, device='cuda:1') (0.09683121740818024)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.490966
Original XAI WIoU for r=0.6 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7747, device='cuda:1')  +-  tensor(0.2081, device='cuda:1') (0.07832858711481094)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.517790
Original XAI WIoU for r=0.9 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7238, device='cuda:1')  +-  tensor(0.2224, device='cuda:1') (2.2435469038128986e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:09:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:09:59 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:11 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:13 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:10:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.738
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.835
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.830
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.410
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.548
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.663801
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5763, device='cuda:1')  +-  tensor(0.2534, device='cuda:1') (0.1185510978102684)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.613774
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5610, device='cuda:1')  +-  tensor(0.2508, device='cuda:1') (0.0964464321732521)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.620478
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7176, device='cuda:1')  +-  tensor(0.3017, device='cuda:1') (0.00815733801573515)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.618858
Original XAI WIoU for r=0.3 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5867, device='cuda:1')  +-  tensor(0.2536, device='cuda:1') (0.11844279617071152)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.586881
Original XAI WIoU for r=0.6 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5651, device='cuda:1')  +-  tensor(0.2481, device='cuda:1') (0.09567397087812424)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.624350
Original XAI WIoU for r=0.9 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7290, device='cuda:1')  +-  tensor(0.2977, device='cuda:1') (0.007256932556629181)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.514209
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9824, device='cuda:1')  +-  tensor(0.0471, device='cuda:1') (0.0047895717434585094)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.529914
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9793, device='cuda:1')  +-  tensor(0.0544, device='cuda:1') (5.886534815147115e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.786760
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1') (5.975387296075496e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.506634
Original XAI WIoU for r=0.3 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5680, device='cuda:1')  +-  tensor(0.1656, device='cuda:1') (0.09114158153533936)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.270041
Original XAI WIoU for r=0.6 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5476, device='cuda:1')  +-  tensor(0.1573, device='cuda:1') (0.0653865709900856)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.510167
Original XAI WIoU for r=0.9 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4792, device='cuda:1')  +-  tensor(0.1309, device='cuda:1') (4.331600855778106e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:14:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:14:53 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:15:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.812
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.810
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.414
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.511
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.616999
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5918, device='cuda:1')  +-  tensor(0.2764, device='cuda:1') (0.0973714292049408)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.620547
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5734, device='cuda:1')  +-  tensor(0.2867, device='cuda:1') (0.07489428669214249)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.616331
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6671, device='cuda:1')  +-  tensor(0.3292, device='cuda:1') (0.006584892049431801)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.625451
Original XAI WIoU for r=0.3 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6034, device='cuda:1')  +-  tensor(0.2761, device='cuda:1') (0.09774643927812576)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.602036
Original XAI WIoU for r=0.6 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5849, device='cuda:1')  +-  tensor(0.2860, device='cuda:1') (0.07570923864841461)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.864003
Original XAI WIoU for r=0.9 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6792, device='cuda:1')  +-  tensor(0.3212, device='cuda:1') (0.006020599510520697)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.533633
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0017, device='cuda:1') (0.00010787219798658043)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.756128
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0027, device='cuda:1') (2.176907099027403e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.545516
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0014, device='cuda:1') (1.9547736762604018e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.514918
Original XAI WIoU for r=0.3 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6134, device='cuda:1')  +-  tensor(0.1669, device='cuda:1') (0.08548074960708618)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.501453
Original XAI WIoU for r=0.6 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6031, device='cuda:1')  +-  tensor(0.1764, device='cuda:1') (0.07422229647636414)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.530929
Original XAI WIoU for r=0.9 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5287, device='cuda:1')  +-  tensor(0.1448, device='cuda:1') (4.96468111066406e-09)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127] (mean across ratios: 0.7854873299598694)
(id) id_val WIOU_PERTURBED: 	[0.58077078 0.55927373 0.67124671] +- [0.01117762 0.01989559 0.03801757] (mean across ratios: 0.603763739267985)
(id) id_test WIOU_ORIGINAL: 	[0.79421998 0.79421998 0.79421998] +- [0.02474969 0.02474969 0.02474969] (mean across ratios: 0.7942199826240538)
(id) id_test WIOU_PERTURBED: 	[0.59237431 0.56912551 0.68436241] +- [0.01013018 0.01853744 0.0387254 ] (mean across ratios: 0.6152874112129211)
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648] (mean across ratios: 0.9960112810134888)
(id) val WIOU_PERTURBED: 	[0.99489682 0.9950441  0.9960122 ] +- [0.00693269 0.00801609 0.00793635] (mean across ratios: 0.9953177054723105)
(id) test WIOU_ORIGINAL: 	[0.50390708 0.50390708 0.50390714] +- [0.05632264 0.05632264 0.05632275] (mean across ratios: 0.5039071043332418)
(id) test WIOU_PERTURBED: 	[0.61876589 0.59569931 0.53737904] +- [0.09370891 0.09379173 0.09537499] (mean across ratios: 0.5839480817317962)
DONE LECI GOODMotif/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:20:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:23 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:37 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:20:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.690
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.738
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.707
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.752
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.754
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.356
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.427



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.269924
Original XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5761, device='cuda:1')  +-  tensor(0.2784, device='cuda:1') (0.1087457463145256)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.241991
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5683, device='cuda:1')  +-  tensor(0.2812, device='cuda:1') (0.08405828475952148)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.207444
Original XAI WIoU for r=0.9 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7015, device='cuda:1')  +-  tensor(0.2825, device='cuda:1') (0.01777089759707451)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.276205
Original XAI WIoU for r=0.3 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5839, device='cuda:1')  +-  tensor(0.2754, device='cuda:1') (0.10753938555717468)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.454968
Original XAI WIoU for r=0.6 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5827, device='cuda:1')  +-  tensor(0.2789, device='cuda:1') (0.08418777585029602)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.211703
Original XAI WIoU for r=0.9 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7132, device='cuda:1')  +-  tensor(0.2793, device='cuda:1') (0.017111551016569138)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.258819
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9993, device='cuda:1')  +-  tensor(0.0074, device='cuda:1') (0.00023237557616084814)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.215421
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9992, device='cuda:1')  +-  tensor(0.0088, device='cuda:1') (3.10986708607075e-10)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.219314
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9994, device='cuda:1')  +-  tensor(0.0070, device='cuda:1') (2.887733940859505e-10)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.271509
Original XAI WIoU for r=0.3 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4944, device='cuda:1')  +-  tensor(0.1900, device='cuda:1') (0.05628548189997673)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.004271
Original XAI WIoU for r=0.6 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4802, device='cuda:1')  +-  tensor(0.1923, device='cuda:1') (0.03786667808890343)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.207108
Original XAI WIoU for r=0.9 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4788, device='cuda:1')  +-  tensor(0.2008, device='cuda:1') (0.0016298920381814241)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:25:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:08 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:25:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.642
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.658
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.709
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.156
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.400
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.459948
Original XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6000, device='cuda:1')  +-  tensor(0.2816, device='cuda:1') (0.0959293320775032)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.211337
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5782, device='cuda:1')  +-  tensor(0.2804, device='cuda:1') (0.08833368867635727)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.435159
Original XAI WIoU for r=0.9 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7033, device='cuda:1')  +-  tensor(0.2981, device='cuda:1') (0.012646891176700592)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.215465
Original XAI WIoU for r=0.3 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6118, device='cuda:1')  +-  tensor(0.2761, device='cuda:1') (0.09484120458364487)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.223431
Original XAI WIoU for r=0.6 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5916, device='cuda:1')  +-  tensor(0.2735, device='cuda:1') (0.08954402804374695)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.192555
Original XAI WIoU for r=0.9 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7222, device='cuda:1')  +-  tensor(0.2885, device='cuda:1') (0.012332664802670479)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.426962
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.180891
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.941917
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.426201
Original XAI WIoU for r=0.3 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5582, device='cuda:1')  +-  tensor(0.2158, device='cuda:1') (0.07116743177175522)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.181799
Original XAI WIoU for r=0.6 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5414, device='cuda:1')  +-  tensor(0.2244, device='cuda:1') (0.05465288087725639)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.150083
Original XAI WIoU for r=0.9 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5238, device='cuda:1')  +-  tensor(0.2272, device='cuda:1') (0.0019030275288969278)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:29:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:29:52 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:30:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.572
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.573
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.790
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.421
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.455374
Original XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5361, device='cuda:1')  +-  tensor(0.2888, device='cuda:1') (0.06011063605546951)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.203906
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5156, device='cuda:1')  +-  tensor(0.2789, device='cuda:1') (0.050862446427345276)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.428655
Original XAI WIoU for r=0.9 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5487, device='cuda:1')  +-  tensor(0.2602, device='cuda:1') (0.005107474513351917)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.197169
Original XAI WIoU for r=0.3 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5472, device='cuda:1')  +-  tensor(0.2909, device='cuda:1') (0.05969057232141495)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.213553
Original XAI WIoU for r=0.6 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5250, device='cuda:1')  +-  tensor(0.2784, device='cuda:1') (0.05282232537865639)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.198708
Original XAI WIoU for r=0.9 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5618, device='cuda:1')  +-  tensor(0.2605, device='cuda:1') (0.004979186225682497)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.199050
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9963, device='cuda:1')  +-  tensor(0.0110, device='cuda:1') (0.0014019848313182592)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.182292
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9967, device='cuda:1')  +-  tensor(0.0103, device='cuda:1') (0.001643840572796762)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.194031
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0012, device='cuda:1') (3.776267354371754e-10)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.190915
Original XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5580, device='cuda:1')  +-  tensor(0.1858, device='cuda:1') (0.05174832046031952)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.174635
Original XAI WIoU for r=0.6 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5426, device='cuda:1')  +-  tensor(0.1901, device='cuda:1') (0.03184584528207779)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.190331
Original XAI WIoU for r=0.9 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5301, device='cuda:1')  +-  tensor(0.1879, device='cuda:1') (0.001101403497159481)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:34:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:35 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:34:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.542
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.552
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.551
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.814
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.407
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.475



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.217882
Original XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5153, device='cuda:1')  +-  tensor(0.2943, device='cuda:1') (0.05232776701450348)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:02.959677
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4986, device='cuda:1')  +-  tensor(0.2815, device='cuda:1') (0.04554295167326927)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.197904
Original XAI WIoU for r=0.9 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5320, device='cuda:1')  +-  tensor(0.2751, device='cuda:1') (0.0058903805911540985)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.206848
Original XAI WIoU for r=0.3 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5244, device='cuda:1')  +-  tensor(0.2960, device='cuda:1') (0.052450407296419144)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.175333
Original XAI WIoU for r=0.6 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5084, device='cuda:1')  +-  tensor(0.2821, device='cuda:1') (0.046322956681251526)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.198640
Original XAI WIoU for r=0.9 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5408, device='cuda:1')  +-  tensor(0.2758, device='cuda:1') (0.005562134552747011)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.189828
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0034, device='cuda:1') (7.868852117098868e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.172605
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9997, device='cuda:1')  +-  tensor(0.0039, device='cuda:1') (1.7770669658023763e-10)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.200816
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0020, device='cuda:1') (2.887733940859505e-10)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.172748
Original XAI WIoU for r=0.3 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5706, device='cuda:1')  +-  tensor(0.1898, device='cuda:1') (0.05606171488761902)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.185407
Original XAI WIoU for r=0.6 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5529, device='cuda:1')  +-  tensor(0.1964, device='cuda:1') (0.03964710608124733)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.168977
Original XAI WIoU for r=0.9 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5229, device='cuda:1')  +-  tensor(0.1839, device='cuda:1') (0.0010806634090840816)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:39:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:39:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.731
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.700
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.740
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.891
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.164
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.372
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.436368
Original XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5874, device='cuda:1')  +-  tensor(0.2726, device='cuda:1') (0.10561875253915787)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.196651
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5772, device='cuda:1')  +-  tensor(0.2720, device='cuda:1') (0.08563625812530518)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.427929
Original XAI WIoU for r=0.9 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7063, device='cuda:1')  +-  tensor(0.2871, device='cuda:1') (0.013810611329972744)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.189723
Original XAI WIoU for r=0.3 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6010, device='cuda:1')  +-  tensor(0.2697, device='cuda:1') (0.10440517216920853)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.196551
Original XAI WIoU for r=0.6 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5916, device='cuda:1')  +-  tensor(0.2699, device='cuda:1') (0.08361794054508209)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.185415
Original XAI WIoU for r=0.9 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7196, device='cuda:1')  +-  tensor(0.2794, device='cuda:1') (0.012596232816576958)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.179101
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.406539
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.180150
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.180896
Original XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4909, device='cuda:1')  +-  tensor(0.1893, device='cuda:1') (0.05461431294679642)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.171329
Original XAI WIoU for r=0.6 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4793, device='cuda:1')  +-  tensor(0.1881, device='cuda:1') (0.04008600860834122)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.935362
Original XAI WIoU for r=0.9 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4766, device='cuda:1')  +-  tensor(0.2007, device='cuda:1') (0.0014844697434455156)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.65580273 0.65580273 0.65580273] +- [0.08244711 0.08244711 0.08244711] (mean across ratios: 0.6558027267456055)
(id) id_val WIOU_PERTURBED: 	[0.56298404 0.54758132 0.63835379] +- [0.03205572 0.03367043 0.08022723] (mean across ratios: 0.5829730490843454)
(id) id_test WIOU_ORIGINAL: 	[0.66961046 0.66961046 0.66961046] +- [0.08590984 0.08590984 0.08590984] (mean across ratios: 0.6696104645729065)
(id) id_test WIOU_PERTURBED: 	[0.57363794 0.55987073 0.65152261] +- [0.03294652 0.03576468 0.08214081] (mean across ratios: 0.5950104276339213)
(id) val WIOU_ORIGINAL: 	[0.99980891 0.99980891 0.99980891] +- [0.0002322 0.0002322 0.0002322] (mean across ratios: 0.9998089075088501)
(id) val WIOU_PERTURBED: 	[0.99907452 0.99910598 0.99986439] +- [0.0014004  0.00125858 0.00022099] (mean across ratios: 0.9993482947349549)
(id) test WIOU_ORIGINAL: 	[0.4539116 0.4539116 0.4539116] +- [0.02255264 0.02255264 0.02255264] (mean across ratios: 0.45391159653663643)
(id) test WIOU_PERTURBED: 	[0.53443585 0.51925012 0.50644234] +- [0.03441819 0.03253226 0.02363898] (mean across ratios: 0.5200427691141765)
DONE CIGA GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:44:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:44:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:44:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:44:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:44:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:44:58 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:45:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.690
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.738
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.706
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.752
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.754
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.356
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.427



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.269997
Original XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5552, device='cuda:1')  +-  tensor(0.2998, device='cuda:1') (0.10022858530282974)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.218033
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5419, device='cuda:1')  +-  tensor(0.2977, device='cuda:1') (0.0700082778930664)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.184733
Original XAI WIoU for r=0.9 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6943, device='cuda:1')  +-  tensor(0.2927, device='cuda:1') (0.005738871172070503)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.255153
Original XAI WIoU for r=0.3 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5694, device='cuda:1')  +-  tensor(0.2983, device='cuda:1') (0.09869731217622757)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:02.982554
Original XAI WIoU for r=0.6 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5553, device='cuda:1')  +-  tensor(0.2986, device='cuda:1') (0.06897016614675522)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.195005
Original XAI WIoU for r=0.9 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2906, device='cuda:1') (0.005462330300360918)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.248485
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9991, device='cuda:1')  +-  tensor(0.0082, device='cuda:1') (0.00046918028965592384)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.192648
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9988, device='cuda:1')  +-  tensor(0.0108, device='cuda:1') (2.221333672558501e-10)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.190289
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9994, device='cuda:1')  +-  tensor(0.0070, device='cuda:1') (2.887733940859505e-10)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.220118
Original XAI WIoU for r=0.3 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5633, device='cuda:1')  +-  tensor(0.2091, device='cuda:1') (0.06455380469560623)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.194742
Original XAI WIoU for r=0.6 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5333, device='cuda:1')  +-  tensor(0.2156, device='cuda:1') (0.04030301794409752)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.169456
Original XAI WIoU for r=0.9 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4809, device='cuda:1')  +-  tensor(0.1988, device='cuda:1') (7.430361659288565e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:49:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:19 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:49:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.643
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.657
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.709
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.156
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.401
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.477358
Original XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5817, device='cuda:1')  +-  tensor(0.2972, device='cuda:1') (0.09084652364253998)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.219120
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5486, device='cuda:1')  +-  tensor(0.2931, device='cuda:1') (0.07253485172986984)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.191714
Original XAI WIoU for r=0.9 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7002, device='cuda:1')  +-  tensor(0.3060, device='cuda:1') (0.0048937490209937096)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.225431
Original XAI WIoU for r=0.3 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5957, device='cuda:1')  +-  tensor(0.2936, device='cuda:1') (0.08935414254665375)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.202677
Original XAI WIoU for r=0.6 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5588, device='cuda:1')  +-  tensor(0.2887, device='cuda:1') (0.07129167765378952)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.973914
Original XAI WIoU for r=0.9 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7189, device='cuda:1')  +-  tensor(0.2986, device='cuda:1') (0.005034544970840216)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.203868
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (1.0150399248232134e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.184380
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0003, device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.946027
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.440773
Original XAI WIoU for r=0.3 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6402, device='cuda:1')  +-  tensor(0.2163, device='cuda:1') (0.0843668133020401)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.191501
Original XAI WIoU for r=0.6 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6014, device='cuda:1')  +-  tensor(0.2388, device='cuda:1') (0.054363589733839035)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.162805
Original XAI WIoU for r=0.9 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5261, device='cuda:1')  +-  tensor(0.2251, device='cuda:1') (5.642188050103414e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:54:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:54:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.572
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.573
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.790
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.421
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.202387
Original XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5406, device='cuda:1')  +-  tensor(0.3115, device='cuda:1') (0.05253845080733299)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.182991
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5141, device='cuda:1')  +-  tensor(0.3006, device='cuda:1') (0.038114629685878754)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.153581
Original XAI WIoU for r=0.9 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5489, device='cuda:1')  +-  tensor(0.2607, device='cuda:1') (0.0008384056272916496)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.153048
Original XAI WIoU for r=0.3 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5512, device='cuda:1')  +-  tensor(0.3124, device='cuda:1') (0.05130334571003914)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.166275
Original XAI WIoU for r=0.6 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5246, device='cuda:1')  +-  tensor(0.3008, device='cuda:1') (0.03880301117897034)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.937187
Original XAI WIoU for r=0.9 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5616, device='cuda:1')  +-  tensor(0.2614, device='cuda:1') (0.0007540410151705146)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.148025
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9951, device='cuda:1')  +-  tensor(0.0181, device='cuda:1') (0.0032954877242445946)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.146516
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9954, device='cuda:1')  +-  tensor(0.0211, device='cuda:1') (0.0024190915282815695)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.172858
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0012, device='cuda:1') (3.776267354371754e-10)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.157610
Original XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6425, device='cuda:1')  +-  tensor(0.1962, device='cuda:1') (0.06478536128997803)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.359487
Original XAI WIoU for r=0.6 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6044, device='cuda:1')  +-  tensor(0.2035, device='cuda:1') (0.033983152359724045)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.139897
Original XAI WIoU for r=0.9 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5323, device='cuda:1')  +-  tensor(0.1854, device='cuda:1') (4.692567667774483e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 22:58:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 10:58:41 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 10:58:53 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 10:58:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 10:58:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 10:58:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 10:59:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.542
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.552
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.551
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.814
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.407
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.475



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.212310
Original XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5249, device='cuda:1')  +-  tensor(0.3140, device='cuda:1') (0.04537947475910187)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.221968
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5028, device='cuda:1')  +-  tensor(0.2996, device='cuda:1') (0.036358222365379333)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.194738
Original XAI WIoU for r=0.9 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5338, device='cuda:1')  +-  tensor(0.2747, device='cuda:1') (0.0010085238609462976)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.443239
Original XAI WIoU for r=0.3 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5357, device='cuda:1')  +-  tensor(0.3145, device='cuda:1') (0.045758768916130066)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.215242
Original XAI WIoU for r=0.6 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5131, device='cuda:1')  +-  tensor(0.3017, device='cuda:1') (0.036102425307035446)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.191705
Original XAI WIoU for r=0.9 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5428, device='cuda:1')  +-  tensor(0.2750, device='cuda:1') (0.0008302623173221946)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.424334
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9993, device='cuda:1')  +-  tensor(0.0089, device='cuda:1') (0.0003585531667340547)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.199366
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9990, device='cuda:1')  +-  tensor(0.0117, device='cuda:1') (2.443467095325502e-10)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.189864
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0020, device='cuda:1') (2.887733940859505e-10)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.180420
Original XAI WIoU for r=0.3 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6584, device='cuda:1')  +-  tensor(0.1964, device='cuda:1') (0.07436405122280121)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.193042
Original XAI WIoU for r=0.6 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6158, device='cuda:1')  +-  tensor(0.2122, device='cuda:1') (0.04690820351243019)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.422166
Original XAI WIoU for r=0.9 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5250, device='cuda:1')  +-  tensor(0.1818, device='cuda:1') (7.380381639165989e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:03:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:22 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:34 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:36 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:38 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 11:03:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.731
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.700
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.740
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.891
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.164
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.372
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.449769
Original XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5692, device='cuda:1')  +-  tensor(0.2937, device='cuda:1') (0.09736413508653641)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.189652
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5432, device='cuda:1')  +-  tensor(0.2819, device='cuda:1') (0.07208266109228134)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.455997
Original XAI WIoU for r=0.9 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7010, device='cuda:1')  +-  tensor(0.2925, device='cuda:1') (0.00682371761649847)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.196419
Original XAI WIoU for r=0.3 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5833, device='cuda:1')  +-  tensor(0.2920, device='cuda:1') (0.09724131971597672)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.427287
Original XAI WIoU for r=0.6 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5569, device='cuda:1')  +-  tensor(0.2828, device='cuda:1') (0.07252177596092224)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.196007
Original XAI WIoU for r=0.9 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7123, device='cuda:1')  +-  tensor(0.2873, device='cuda:1') (0.005870356690138578)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.185295
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.178871
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.187537
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.207832
Original XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5625, device='cuda:1')  +-  tensor(0.2093, device='cuda:1') (0.06396251171827316)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.190529
Original XAI WIoU for r=0.6 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5335, device='cuda:1')  +-  tensor(0.2097, device='cuda:1') (0.04110053554177284)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.205681
Original XAI WIoU for r=0.9 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4787, device='cuda:1')  +-  tensor(0.1987, device='cuda:1') (3.654093694294147e-09)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.65580273 0.65580264 0.65580273] +- [0.08244711 0.08244707 0.08244711] (mean across ratios: 0.6558026989301046)
(id) id_val WIOU_PERTURBED: 	[0.55428517 0.5300915  0.63562405] +- [0.02013626 0.01818527 0.07718446] (mean across ratios: 0.5733335733413697)
(id) id_test WIOU_ORIGINAL: 	[0.66961046 0.66961046 0.66961046] +- [0.08590984 0.08590984 0.08590984] (mean across ratios: 0.6696104645729065)
(id) id_test WIOU_PERTURBED: 	[0.56706537 0.54174663 0.64849865] +- [0.02155519 0.01909147 0.07893048] (mean across ratios: 0.5857702175776164)
(id) val WIOU_ORIGINAL: 	[0.99980891 0.99980891 0.99980891] +- [0.0002322 0.0002322 0.0002322] (mean across ratios: 0.9998089075088501)
(id) val WIOU_PERTURBED: 	[0.99868926 0.99864104 0.99986439] +- [0.00183378 0.00167548 0.00022099] (mean across ratios: 0.9990648945172628)
(id) test WIOU_ORIGINAL: 	[0.4539116 0.4539116 0.4539116] +- [0.02255264 0.02255264 0.02255264] (mean across ratios: 0.45391159653663643)
(id) test WIOU_PERTURBED: 	[0.61339459 0.57767419 0.50860113] +- [0.04168896 0.03645946 0.02363289] (mean across ratios: 0.5665566364924113)
DONE CIGA GOODMotif/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:08:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:37 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:08:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.492
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.348
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.175
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.451
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.627870
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3649, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.003859554883092642)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.537077
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3649, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.0031130400020629168)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.532278
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3342, device='cuda:1')  +-  tensor(0.1676, device='cuda:1') (0.00044579661334864795)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.584078
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3710, device='cuda:1')  +-  tensor(0.2164, device='cuda:1') (0.003897294867783785)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.532292
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3708, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.003143364330753684)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.536775
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3389, device='cuda:1')  +-  tensor(0.1684, device='cuda:1') (0.000472574116429314)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.457028
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4662, device='cuda:1')  +-  tensor(0.0910, device='cuda:1') (0.0012857274850830436)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.431584
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4660, device='cuda:1')  +-  tensor(0.0911, device='cuda:1') (0.00048091422650031745)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.402455
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4536, device='cuda:1')  +-  tensor(0.0899, device='cuda:1') (8.00054840510711e-06)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.438995
Original XAI WIoU for r=0.3 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1141, device='cuda:1') (0.003773773554712534)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.421850
Original XAI WIoU for r=0.6 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4246, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.003436754224821925)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.379773
Original XAI WIoU for r=0.9 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4231, device='cuda:1')  +-  tensor(0.1129, device='cuda:1') (0.00010826468496816233)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:13:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:23 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:37 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:13:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.260
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.582022
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.2184, device='cuda:1') (0.005942245479673147)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.540082
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3719, device='cuda:1')  +-  tensor(0.2175, device='cuda:1') (0.005035415757447481)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.758297
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3434, device='cuda:1')  +-  tensor(0.1747, device='cuda:1') (0.000471846287837252)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.539835
Original XAI WIoU for r=0.3 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3787, device='cuda:1')  +-  tensor(0.2201, device='cuda:1') (0.006021265406161547)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.293828
Original XAI WIoU for r=0.6 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3781, device='cuda:1')  +-  tensor(0.2192, device='cuda:1') (0.00526048569008708)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.511032
Original XAI WIoU for r=0.9 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3485, device='cuda:1')  +-  tensor(0.1758, device='cuda:1') (0.0004484867095015943)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.430641
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4730, device='cuda:1')  +-  tensor(0.0979, device='cuda:1') (0.0008379609207622707)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.402361
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4728, device='cuda:1')  +-  tensor(0.0979, device='cuda:1') (2.195133492932655e-05)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.417711
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4488, device='cuda:1')  +-  tensor(0.0899, device='cuda:1') (6.5862550968631695e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.402007
Original XAI WIoU for r=0.3 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4356, device='cuda:1')  +-  tensor(0.1202, device='cuda:1') (0.005525320768356323)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.151134
Original XAI WIoU for r=0.6 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4348, device='cuda:1')  +-  tensor(0.1201, device='cuda:1') (0.004800551105290651)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.372655
Original XAI WIoU for r=0.9 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4330, device='cuda:1')  +-  tensor(0.1196, device='cuda:1') (0.00015457120025530457)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:18:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:17 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:18:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.299
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.527118
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.2164, device='cuda:1') (0.005558195058256388)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.538904
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3686, device='cuda:1')  +-  tensor(0.2155, device='cuda:1') (0.004595930688083172)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.526427
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3378, device='cuda:1')  +-  tensor(0.1695, device='cuda:1') (0.00047169759636744857)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.522268
Original XAI WIoU for r=0.3 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3758, device='cuda:1')  +-  tensor(0.2179, device='cuda:1') (0.005646480713039637)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.498888
Original XAI WIoU for r=0.6 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3749, device='cuda:1')  +-  tensor(0.2173, device='cuda:1') (0.004513157997280359)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.530220
Original XAI WIoU for r=0.9 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3429, device='cuda:1')  +-  tensor(0.1708, device='cuda:1') (0.0004643122956622392)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.384274
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.0943, device='cuda:1') (0.0005529066547751427)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.414758
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.0943, device='cuda:1') (3.987294050489254e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.406558
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4506, device='cuda:1')  +-  tensor(0.0871, device='cuda:1') (4.187214130979555e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.388824
Original XAI WIoU for r=0.3 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4336, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.006094939541071653)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.607698
Original XAI WIoU for r=0.6 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4325, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.004535866901278496)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.370992
Original XAI WIoU for r=0.9 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4295, device='cuda:1')  +-  tensor(0.1205, device='cuda:1') (0.00014423104585148394)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:22:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:22:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:00 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:06 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:23:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.481
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.252
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.425



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.513823
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3686, device='cuda:1')  +-  tensor(0.2151, device='cuda:1') (0.005013158079236746)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.518147
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3681, device='cuda:1')  +-  tensor(0.2147, device='cuda:1') (0.004352173302322626)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.505047
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3373, device='cuda:1')  +-  tensor(0.1705, device='cuda:1') (0.0006692911847494543)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.487943
Original XAI WIoU for r=0.3 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3747, device='cuda:1')  +-  tensor(0.2168, device='cuda:1') (0.004904539790004492)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.659323
Original XAI WIoU for r=0.6 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3740, device='cuda:1')  +-  tensor(0.2164, device='cuda:1') (0.0043145944364368916)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.650770
Original XAI WIoU for r=0.9 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3421, device='cuda:1')  +-  tensor(0.1715, device='cuda:1') (0.0006219883798621595)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.412881
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4720, device='cuda:1')  +-  tensor(0.0948, device='cuda:1') (0.0010446762898936868)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.390105
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4716, device='cuda:1')  +-  tensor(0.0947, device='cuda:1') (9.351808330393396e-06)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.429361
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4493, device='cuda:1')  +-  tensor(0.0890, device='cuda:1') (2.4212536420264996e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.371748
Original XAI WIoU for r=0.3 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4312, device='cuda:1')  +-  tensor(0.1165, device='cuda:1') (0.005048514809459448)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.378012
Original XAI WIoU for r=0.6 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4315, device='cuda:1')  +-  tensor(0.1169, device='cuda:1') (0.004422631114721298)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.371040
Original XAI WIoU for r=0.9 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4304, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.00018049466598313302)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:27:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:33 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:49 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:27:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.530
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.237
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.750988
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3681, device='cuda:1')  +-  tensor(0.2168, device='cuda:1') (0.005481396801769733)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.510110
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3670, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.004780385177582502)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.512280
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3329, device='cuda:1')  +-  tensor(0.1676, device='cuda:1') (0.0005282367928884923)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.487042
Original XAI WIoU for r=0.3 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3739, device='cuda:1')  +-  tensor(0.2182, device='cuda:1') (0.005705934949219227)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.494807
Original XAI WIoU for r=0.6 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3728, device='cuda:1')  +-  tensor(0.2176, device='cuda:1') (0.004901991691440344)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.270828
Original XAI WIoU for r=0.9 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3365, device='cuda:1')  +-  tensor(0.1681, device='cuda:1') (0.00046814323286525905)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.380427
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4841, device='cuda:1')  +-  tensor(0.0932, device='cuda:1') (0.0015579948667436838)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.394565
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4832, device='cuda:1')  +-  tensor(0.0930, device='cuda:1') (0.000254705868428573)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.423857
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4609, device='cuda:1')  +-  tensor(0.0868, device='cuda:1') (3.998400721627604e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.374685
Original XAI WIoU for r=0.3 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.1178, device='cuda:1') (0.005366060417145491)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.600968
Original XAI WIoU for r=0.6 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4303, device='cuda:1')  +-  tensor(0.1177, device='cuda:1') (0.0042080143466591835)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.378171
Original XAI WIoU for r=0.9 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4277, device='cuda:1')  +-  tensor(0.1154, device='cuda:1') (0.00013422603660728782)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828] (mean across ratios: 0.32219606041908266)
(id) id_val WIOU_PERTURBED: 	[0.36873791 0.36810026 0.33711551] +- [0.00244488 0.00230985 0.00365791] (mean across ratios: 0.3579845587412516)
(id) id_test WIOU_ORIGINAL: 	[0.32659646 0.32659646 0.32659646] +- [0.0027637 0.0027637 0.0027637] (mean across ratios: 0.32659646272659304)
(id) id_test WIOU_PERTURBED: 	[0.3748051  0.37412965 0.34180599] +- [0.00251063 0.00240769 0.00406207] (mean across ratios: 0.36358024676640827)
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847] (mean across ratios: 0.44520326256752013)
(id) val WIOU_PERTURBED: 	[0.47381042 0.47349358 0.45265548] +- [0.00578657 0.00557141 0.00442769] (mean across ratios: 0.466653162240982)
(id) test WIOU_ORIGINAL: 	[0.39671335 0.39671335 0.39671335] +- [0.00250526 0.00250526 0.00250526] (mean across ratios: 0.39671334624290466)
(id) test WIOU_PERTURBED: 	[0.43122219 0.43074201 0.42874054] +- [0.00367325 0.0034086  0.00329318] (mean across ratios: 0.43023491104443873)
DONE GSAT GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:32:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:33:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.492
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.348
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.175
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.451
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.716103
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3978, device='cuda:1')  +-  tensor(0.2541, device='cuda:1') (0.004221274051815271)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.639443
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.2539, device='cuda:1') (0.003131990320980549)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.641899
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1666, device='cuda:1') (0.00021267203555908054)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.680339
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4051, device='cuda:1')  +-  tensor(0.2563, device='cuda:1') (0.0043420130386948586)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.631734
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4046, device='cuda:1')  +-  tensor(0.2561, device='cuda:1') (0.003155700396746397)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.640434
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3401, device='cuda:1')  +-  tensor(0.1674, device='cuda:1') (0.00021191139239817858)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.545801
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4986, device='cuda:1')  +-  tensor(0.1039, device='cuda:1') (0.001981615088880062)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.530777
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4982, device='cuda:1')  +-  tensor(0.1042, device='cuda:1') (0.0006849063211120665)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.516376
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4539, device='cuda:1')  +-  tensor(0.0897, device='cuda:1') (4.276067500086356e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.533810
Original XAI WIoU for r=0.3 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4613, device='cuda:1')  +-  tensor(0.1316, device='cuda:1') (0.004465243313461542)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.516999
Original XAI WIoU for r=0.6 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4606, device='cuda:1')  +-  tensor(0.1316, device='cuda:1') (0.003921137657016516)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.493973
Original XAI WIoU for r=0.9 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4249, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (2.310187152687604e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:37:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:37:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:37:57 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:37:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:01 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:38:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.260
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.683483
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4048, device='cuda:1')  +-  tensor(0.2563, device='cuda:1') (0.005375394597649574)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.642105
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.2505, device='cuda:1') (0.004310937598347664)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.551929
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3446, device='cuda:1')  +-  tensor(0.1737, device='cuda:1') (0.00016728276386857033)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.621405
Original XAI WIoU for r=0.3 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4122, device='cuda:1')  +-  tensor(0.2588, device='cuda:1') (0.005324073135852814)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.598814
Original XAI WIoU for r=0.6 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4097, device='cuda:1')  +-  tensor(0.2537, device='cuda:1') (0.004285396076738834)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.382527
Original XAI WIoU for r=0.9 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3496, device='cuda:1')  +-  tensor(0.1749, device='cuda:1') (0.00016374289407394826)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.742167
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5067, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.0015318782534450293)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.500471
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5064, device='cuda:1')  +-  tensor(0.1106, device='cuda:1') (2.3788734324625693e-05)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.739009
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4491, device='cuda:1')  +-  tensor(0.0897, device='cuda:1') (6.65289467960406e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.475102
Original XAI WIoU for r=0.3 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4740, device='cuda:1')  +-  tensor(0.1370, device='cuda:1') (0.006497630849480629)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.483107
Original XAI WIoU for r=0.6 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4716, device='cuda:1')  +-  tensor(0.1372, device='cuda:1') (0.004718060605227947)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.481641
Original XAI WIoU for r=0.9 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4348, device='cuda:1')  +-  tensor(0.1176, device='cuda:1') (3.820693983414003e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:42:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:42:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.494
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.299
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.626077
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.2551, device='cuda:1') (0.005689756944775581)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.596723
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3978, device='cuda:1')  +-  tensor(0.2489, device='cuda:1') (0.00453186547383666)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.358880
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3390, device='cuda:1')  +-  tensor(0.1684, device='cuda:1') (0.00019012836855836213)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.814929
Original XAI WIoU for r=0.3 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4094, device='cuda:1')  +-  tensor(0.2574, device='cuda:1') (0.005686239805072546)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.582534
Original XAI WIoU for r=0.6 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4054, device='cuda:1')  +-  tensor(0.2519, device='cuda:1') (0.004493840038776398)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.579085
Original XAI WIoU for r=0.9 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3442, device='cuda:1')  +-  tensor(0.1696, device='cuda:1') (0.00018602887575980276)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.462358
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.1059, device='cuda:1') (0.0010582847753539681)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.471229
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5059, device='cuda:1')  +-  tensor(0.1056, device='cuda:1') (3.5652403251873466e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.720658
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4509, device='cuda:1')  +-  tensor(0.0869, device='cuda:1') (4.264960828948006e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.444115
Original XAI WIoU for r=0.3 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4718, device='cuda:1')  +-  tensor(0.1338, device='cuda:1') (0.007339556235820055)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.458715
Original XAI WIoU for r=0.6 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4686, device='cuda:1')  +-  tensor(0.1342, device='cuda:1') (0.004750977270305157)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.455204
Original XAI WIoU for r=0.9 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4308, device='cuda:1')  +-  tensor(0.1192, device='cuda:1') (4.903593975313925e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:47:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:47:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.481
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.252
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.425



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.621823
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4017, device='cuda:1')  +-  tensor(0.2543, device='cuda:1') (0.0052131908014416695)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.638760
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3968, device='cuda:1')  +-  tensor(0.2458, device='cuda:1') (0.00424110796302557)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.632692
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3385, device='cuda:1')  +-  tensor(0.1694, device='cuda:1') (0.0002420255186734721)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.604226
Original XAI WIoU for r=0.3 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4088, device='cuda:1')  +-  tensor(0.2566, device='cuda:1') (0.005132034420967102)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.627130
Original XAI WIoU for r=0.6 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4035, device='cuda:1')  +-  tensor(0.2478, device='cuda:1') (0.004172829911112785)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.630468
Original XAI WIoU for r=0.9 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3432, device='cuda:1')  +-  tensor(0.1705, device='cuda:1') (0.00022653889027424157)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.510739
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5048, device='cuda:1')  +-  tensor(0.1069, device='cuda:1') (0.0017054002964869142)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.493059
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5041, device='cuda:1')  +-  tensor(0.1068, device='cuda:1') (3.384049341548234e-05)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.536990
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4496, device='cuda:1')  +-  tensor(0.0888, device='cuda:1') (2.4212536420264996e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.487903
Original XAI WIoU for r=0.3 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4693, device='cuda:1')  +-  tensor(0.1330, device='cuda:1') (0.006070415489375591)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.489952
Original XAI WIoU for r=0.6 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4693, device='cuda:1')  +-  tensor(0.1336, device='cuda:1') (0.004779229871928692)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.490160
Original XAI WIoU for r=0.9 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4323, device='cuda:1')  +-  tensor(0.1120, device='cuda:1') (3.5819005539394766e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:52:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:41 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:43 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:45 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:46 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 11:52:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.530
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.238
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.623836
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4012, device='cuda:1')  +-  tensor(0.2556, device='cuda:1') (0.005000794772058725)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.615488
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3958, device='cuda:1')  +-  tensor(0.2469, device='cuda:1') (0.004319522064179182)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.861363
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3338, device='cuda:1')  +-  tensor(0.1667, device='cuda:1') (0.00023206423793453723)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.600736
Original XAI WIoU for r=0.3 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4081, device='cuda:1')  +-  tensor(0.2580, device='cuda:1') (0.005079296883195639)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.610426
Original XAI WIoU for r=0.6 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4027, device='cuda:1')  +-  tensor(0.2491, device='cuda:1') (0.004340437240898609)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.616944
Original XAI WIoU for r=0.9 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3374, device='cuda:1')  +-  tensor(0.1673, device='cuda:1') (0.00020035056513734162)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.501852
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5156, device='cuda:1')  +-  tensor(0.1033, device='cuda:1') (0.002489811973646283)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.487083
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5139, device='cuda:1')  +-  tensor(0.1030, device='cuda:1') (0.0002163649769499898)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.532363
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4612, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (4.109467433011105e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.465032
Original XAI WIoU for r=0.3 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4697, device='cuda:1')  +-  tensor(0.1345, device='cuda:1') (0.006676316726952791)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.476086
Original XAI WIoU for r=0.6 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4679, device='cuda:1')  +-  tensor(0.1347, device='cuda:1') (0.004627054091542959)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.470149
Original XAI WIoU for r=0.9 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4293, device='cuda:1')  +-  tensor(0.1136, device='cuda:1') (3.021013883497403e-09)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828] (mean across ratios: 0.32219606041908266)
(id) id_val WIOU_PERTURBED: 	[0.40151669 0.3979923  0.33823454] +- [0.00223933 0.00211309 0.00370338] (mean across ratios: 0.3792478462060293)
(id) id_test WIOU_ORIGINAL: 	[0.32659646 0.32659646 0.32659646] +- [0.0027637 0.0027637 0.0027637] (mean across ratios: 0.32659646272659304)
(id) id_test WIOU_PERTURBED: 	[0.4087152  0.40517231 0.34290041] +- [0.00228043 0.00244506 0.00411075] (mean across ratios: 0.38559597134590146)
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847] (mean across ratios: 0.44520326256752013)
(id) val WIOU_PERTURBED: 	[0.50635931 0.50570522 0.45295618] +- [0.00544049 0.00501761 0.00446409] (mean across ratios: 0.4883402367432912)
(id) test WIOU_ORIGINAL: 	[0.39671335 0.39671335 0.39671335] +- [0.00250526 0.00250526 0.00250526] (mean across ratios: 0.39671334624290466)
(id) test WIOU_PERTURBED: 	[0.46921102 0.46758983 0.4304202 ] +- [0.00430137 0.00370452 0.0032768 ] (mean across ratios: 0.45574034651120504)
DONE GSAT GOODMotif/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 23:58:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:14 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:58:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.467
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.134
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.078



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.669397
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4924, device='cuda:1')  +-  tensor(0.2606, device='cuda:1') (0.026543233543634415)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.604506
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4713, device='cuda:1')  +-  tensor(0.2434, device='cuda:1') (0.011844092048704624)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.603010
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4329, device='cuda:1')  +-  tensor(0.2173, device='cuda:1') (5.9593876358121634e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.622839
Original XAI WIoU for r=0.3 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4959, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.027753759175539017)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.615010
Original XAI WIoU for r=0.6 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4755, device='cuda:1')  +-  tensor(0.2471, device='cuda:1') (0.01182237733155489)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.585638
Original XAI WIoU for r=0.9 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4383, device='cuda:1')  +-  tensor(0.2215, device='cuda:1') (7.011834532022476e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.109888
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2317, device='cuda:1')  +-  tensor(0.1430, device='cuda:1') (0.010568749159574509)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.853485
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2304, device='cuda:1')  +-  tensor(0.1551, device='cuda:1') (0.0027865180745720863)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.089231
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1947, device='cuda:1')  +-  tensor(0.1151, device='cuda:1') (8.029393939068541e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.039440
Original XAI WIoU for r=0.3 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0994, device='cuda:1')  +-  tensor(0.0603, device='cuda:1') (0.0018243201775476336)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.013291
Original XAI WIoU for r=0.6 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0932, device='cuda:1')  +-  tensor(0.0549, device='cuda:1') (0.000910300062969327)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.309586
Original XAI WIoU for r=0.9 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0773, device='cuda:1')  +-  tensor(0.0405, device='cuda:1') (0.0003027367638424039)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:04:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:32 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:45 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:47 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:51 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:04:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.464
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.442
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.295
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.281
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.281



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.621354
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4869, device='cuda:1')  +-  tensor(0.2472, device='cuda:1') (0.019456587731838226)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.606997
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4567, device='cuda:1')  +-  tensor(0.2196, device='cuda:1') (0.006555155385285616)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.581667
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4357, device='cuda:1')  +-  tensor(0.2036, device='cuda:1') (0.00012915053230244666)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.615575
Original XAI WIoU for r=0.3 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4892, device='cuda:1')  +-  tensor(0.2470, device='cuda:1') (0.019489746540784836)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.579195
Original XAI WIoU for r=0.6 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4614, device='cuda:1')  +-  tensor(0.2237, device='cuda:1') (0.006765950471162796)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.622263
Original XAI WIoU for r=0.9 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4399, device='cuda:1')  +-  tensor(0.2075, device='cuda:1') (0.00012689265713561326)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.092421
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.2606, device='cuda:1') (0.013451789505779743)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.077594
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3151, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.002277067629620433)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.063098
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3227, device='cuda:1')  +-  tensor(0.3037, device='cuda:1') (0.00017250736709684134)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.288963
Original XAI WIoU for r=0.3 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2812, device='cuda:1')  +-  tensor(0.3264, device='cuda:1') (0.006913002114742994)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.031681
Original XAI WIoU for r=0.6 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2764, device='cuda:1')  +-  tensor(0.3352, device='cuda:1') (0.001364280004054308)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.044170
Original XAI WIoU for r=0.9 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2798, device='cuda:1')  +-  tensor(0.3462, device='cuda:1') (3.629054481280036e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:11:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:19 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:20 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:11:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.597
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.597
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.165
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.653471
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6440, device='cuda:1')  +-  tensor(0.3217, device='cuda:1') (0.037865422666072845)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.610288
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6233, device='cuda:1')  +-  tensor(0.3141, device='cuda:1') (0.02366766147315502)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.601077
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6017, device='cuda:1')  +-  tensor(0.3050, device='cuda:1') (5.138925553183071e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.610876
Original XAI WIoU for r=0.3 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6473, device='cuda:1')  +-  tensor(0.3237, device='cuda:1') (0.03878456726670265)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.822374
Original XAI WIoU for r=0.6 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6279, device='cuda:1')  +-  tensor(0.3168, device='cuda:1') (0.024263793602585793)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.609144
Original XAI WIoU for r=0.9 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6059, device='cuda:1')  +-  tensor(0.3077, device='cuda:1') (6.578255852218717e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.080413
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4476, device='cuda:1')  +-  tensor(0.3316, device='cuda:1') (0.033634040504693985)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.051192
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4284, device='cuda:1')  +-  tensor(0.3268, device='cuda:1') (0.021485665813088417)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.104724
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4320, device='cuda:1')  +-  tensor(0.3466, device='cuda:1') (8.856892236508429e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.027157
Original XAI WIoU for r=0.3 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1614, device='cuda:1')  +-  tensor(0.0977, device='cuda:1') (0.013598444871604443)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.225417
Original XAI WIoU for r=0.6 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1555, device='cuda:1')  +-  tensor(0.0943, device='cuda:1') (0.009908908978104591)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.042052
Original XAI WIoU for r=0.9 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1480, device='cuda:1')  +-  tensor(0.0939, device='cuda:1') (0.00023355150187853724)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:17:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:17:44 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:17:56 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:17:58 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:00 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:03 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:18:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.415
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.312
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.256
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.263



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.665070
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3726, device='cuda:1')  +-  tensor(0.2549, device='cuda:1') (0.028925271704792976)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.625383
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3782, device='cuda:1')  +-  tensor(0.2460, device='cuda:1') (0.01003238558769226)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.612978
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3967, device='cuda:1')  +-  tensor(0.2369, device='cuda:1') (0.0009164390503428876)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.612937
Original XAI WIoU for r=0.3 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3828, device='cuda:1')  +-  tensor(0.2561, device='cuda:1') (0.02887006662786007)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.614626
Original XAI WIoU for r=0.6 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3852, device='cuda:1')  +-  tensor(0.2464, device='cuda:1') (0.009974142536520958)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.378370
Original XAI WIoU for r=0.9 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4028, device='cuda:1')  +-  tensor(0.2406, device='cuda:1') (0.0008690647082403302)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.078257
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.3279, device='cuda:1') (0.017653264105319977)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.097941
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.3340, device='cuda:1') (0.009127850644290447)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.097773
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3166, device='cuda:1')  +-  tensor(0.3402, device='cuda:1') (0.0019117306219413877)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.036304
Original XAI WIoU for r=0.3 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2611, device='cuda:1')  +-  tensor(0.3850, device='cuda:1') (0.004854148253798485)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.766029
Original XAI WIoU for r=0.6 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2583, device='cuda:1')  +-  tensor(0.3865, device='cuda:1') (0.0025075429584831)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.046418
Original XAI WIoU for r=0.9 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2628, device='cuda:1')  +-  tensor(0.3851, device='cuda:1') (0.00025883762282319367)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:24:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:32 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:33 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:35 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:24:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.251
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.402
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.611096
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4663, device='cuda:1')  +-  tensor(0.2759, device='cuda:1') (0.030308924615383148)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.603390
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4486, device='cuda:1')  +-  tensor(0.2626, device='cuda:1') (0.018286000937223434)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.608190
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4040, device='cuda:1')  +-  tensor(0.2074, device='cuda:1') (0.0005952263018116355)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.843443
Original XAI WIoU for r=0.3 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4738, device='cuda:1')  +-  tensor(0.2770, device='cuda:1') (0.029344365000724792)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.602729
Original XAI WIoU for r=0.6 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4541, device='cuda:1')  +-  tensor(0.2651, device='cuda:1') (0.017889929935336113)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.854506
Original XAI WIoU for r=0.9 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4126, device='cuda:1')  +-  tensor(0.2135, device='cuda:1') (0.0005770566640421748)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.057694
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2441, device='cuda:1')  +-  tensor(0.1597, device='cuda:1') (0.024039657786488533)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.079154
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2351, device='cuda:1')  +-  tensor(0.1588, device='cuda:1') (0.01166452094912529)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.081670
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2453, device='cuda:1')  +-  tensor(0.1875, device='cuda:1') (0.0004805253411177546)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.006754
Original XAI WIoU for r=0.3 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2097, device='cuda:1')  +-  tensor(0.2433, device='cuda:1') (0.008963667787611485)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.977286
Original XAI WIoU for r=0.6 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2186, device='cuda:1')  +-  tensor(0.2739, device='cuda:1') (0.006505175027996302)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.018531
Original XAI WIoU for r=0.9 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2394, device='cuda:1')  +-  tensor(0.3086, device='cuda:1') (0.0002902102132793516)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325] (mean across ratios: 0.44761313796043395)
(id) id_val WIOU_PERTURBED: 	[0.49242929 0.47563435 0.45416861] +- [0.08722749 0.08050467 0.07533342] (mean across ratios: 0.4740774154663086)
(id) id_test WIOU_ORIGINAL: 	[0.45311112 0.45311112 0.45311112] +- [0.07175872 0.07175872 0.07175872] (mean across ratios: 0.45311111807823173)
(id) id_test WIOU_PERTURBED: 	[0.49778639 0.4808227  0.45990701] +- [0.0851022  0.07988608 0.07441202] (mean across ratios: 0.4795053680737813)
(id) val WIOU_ORIGINAL: 	[0.30000606 0.30000614 0.30000614] +- [0.08320286 0.08320276 0.08320276] (mean across ratios: 0.30000611245632175)
(id) val WIOU_PERTURBED: 	[0.31234841 0.30338844 0.30227538] +- [0.07702578 0.07180297 0.08033442] (mean across ratios: 0.3060040791829427)
(id) test WIOU_ORIGINAL: 	[0.20151746 0.20151746 0.20151746] +- [0.08016272 0.08016272 0.08016272] (mean across ratios: 0.20151746422052383)
(id) test WIOU_PERTURBED: 	[0.20254632 0.20040618 0.20146428] +- [0.06630634 0.06777928 0.07696552] (mean across ratios: 0.2014722615480423)
DONE LECI GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:31:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:45 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:47 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:31:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.467
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.134
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.078



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.553845
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5207, device='cuda:1')  +-  tensor(0.2776, device='cuda:1') (0.025207694619894028)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.481820
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4894, device='cuda:1')  +-  tensor(0.2540, device='cuda:1') (0.007103305775672197)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.499972
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4337, device='cuda:1')  +-  tensor(0.2164, device='cuda:1') (3.5180415579816326e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.557146
Original XAI WIoU for r=0.3 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5243, device='cuda:1')  +-  tensor(0.2804, device='cuda:1') (0.025384772568941116)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.499014
Original XAI WIoU for r=0.6 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4929, device='cuda:1')  +-  tensor(0.2575, device='cuda:1') (0.007535595912486315)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.711402
Original XAI WIoU for r=0.9 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4391, device='cuda:1')  +-  tensor(0.2205, device='cuda:1') (3.3527390769449994e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.968184
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2713, device='cuda:1')  +-  tensor(0.1892, device='cuda:1') (0.010918439365923405)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.160398
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2409, device='cuda:1')  +-  tensor(0.1684, device='cuda:1') (0.0005918744718655944)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.966113
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1951, device='cuda:1')  +-  tensor(0.1147, device='cuda:1') (7.0574333221884444e-06)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.878865
Original XAI WIoU for r=0.3 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1114, device='cuda:1')  +-  tensor(0.0774, device='cuda:1') (0.001348121790215373)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.864825
Original XAI WIoU for r=0.6 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1001, device='cuda:1')  +-  tensor(0.0643, device='cuda:1') (0.00025989580899477005)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.043316
Original XAI WIoU for r=0.9 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0778, device='cuda:1')  +-  tensor(0.0401, device='cuda:1') (3.350170345584047e-06)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:37:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:37:59 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:11 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:13 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:15 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:18 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:38:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.464
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.442
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.295
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.281
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.281



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.517801
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5065, device='cuda:1')  +-  tensor(0.2579, device='cuda:1') (0.01742546074092388)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.536816
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4656, device='cuda:1')  +-  tensor(0.2239, device='cuda:1') (0.0053720963187515736)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.316974
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4362, device='cuda:1')  +-  tensor(0.2028, device='cuda:1') (5.1128303311998025e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.764191
Original XAI WIoU for r=0.3 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5096, device='cuda:1')  +-  tensor(0.2586, device='cuda:1') (0.018182270228862762)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.540133
Original XAI WIoU for r=0.6 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4703, device='cuda:1')  +-  tensor(0.2285, device='cuda:1') (0.005099434405565262)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.520354
Original XAI WIoU for r=0.9 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4406, device='cuda:1')  +-  tensor(0.2066, device='cuda:1') (4.574810736812651e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.010138
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3173, device='cuda:1')  +-  tensor(0.2288, device='cuda:1') (0.010819707065820694)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.095847
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3030, device='cuda:1')  +-  tensor(0.2504, device='cuda:1') (0.0016004926292225718)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.317720
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3226, device='cuda:1')  +-  tensor(0.3038, device='cuda:1') (5.195830681259395e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.851763
Original XAI WIoU for r=0.3 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1467, device='cuda:1')  +-  tensor(0.0963, device='cuda:1') (0.0049658953212201595)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.861068
Original XAI WIoU for r=0.6 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2128, device='cuda:1')  +-  tensor(0.2690, device='cuda:1') (0.0008193861576728523)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.913986
Original XAI WIoU for r=0.9 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2799, device='cuda:1')  +-  tensor(0.3461, device='cuda:1') (1.1442645941883711e-08)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:44:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:29 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:40 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:42 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:44 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:44:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.597
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.597
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.165
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.491322
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6645, device='cuda:1')  +-  tensor(0.3244, device='cuda:1') (0.04133255407214165)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.495021
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6355, device='cuda:1')  +-  tensor(0.3159, device='cuda:1') (0.023618942126631737)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.500400
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6018, device='cuda:1')  +-  tensor(0.3048, device='cuda:1') (1.3011102964810561e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.495165
Original XAI WIoU for r=0.3 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6646, device='cuda:1')  +-  tensor(0.3264, device='cuda:1') (0.04076848179101944)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.467092
Original XAI WIoU for r=0.6 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6401, device='cuda:1')  +-  tensor(0.3183, device='cuda:1') (0.02412828616797924)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.502340
Original XAI WIoU for r=0.9 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6060, device='cuda:1')  +-  tensor(0.3075, device='cuda:1') (9.783877430891152e-06)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.917684
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4061, device='cuda:1')  +-  tensor(0.3008, device='cuda:1') (0.038473933935165405)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.925396
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4045, device='cuda:1')  +-  tensor(0.3100, device='cuda:1') (0.01036440022289753)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.221366
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4320, device='cuda:1')  +-  tensor(0.3466, device='cuda:1') (3.759607292153078e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.826672
Original XAI WIoU for r=0.3 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1881, device='cuda:1')  +-  tensor(0.1005, device='cuda:1') (0.02087412029504776)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.587656
Original XAI WIoU for r=0.6 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1717, device='cuda:1')  +-  tensor(0.0938, device='cuda:1') (0.0064437431283295155)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.928002
Original XAI WIoU for r=0.9 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1487, device='cuda:1')  +-  tensor(0.0935, device='cuda:1') (1.139127792093575e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:50:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:50:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:51:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.367
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.415
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.312
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.256
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.263



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.500925
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3703, device='cuda:1')  +-  tensor(0.2557, device='cuda:1') (0.026396939530968666)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.513390
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3746, device='cuda:1')  +-  tensor(0.2403, device='cuda:1') (0.00822988711297512)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.506323
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3964, device='cuda:1')  +-  tensor(0.2372, device='cuda:1') (0.0003078368026763201)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.505471
Original XAI WIoU for r=0.3 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.2592, device='cuda:1') (0.026883604004979134)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.476557
Original XAI WIoU for r=0.6 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3816, device='cuda:1')  +-  tensor(0.2412, device='cuda:1') (0.008418619632720947)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.477736
Original XAI WIoU for r=0.9 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4022, device='cuda:1')  +-  tensor(0.2411, device='cuda:1') (0.0003104989882558584)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.912991
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3101, device='cuda:1')  +-  tensor(0.3245, device='cuda:1') (0.014547266066074371)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.920410
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3083, device='cuda:1')  +-  tensor(0.3312, device='cuda:1') (0.007202730514109135)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.709137
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3160, device='cuda:1')  +-  tensor(0.3407, device='cuda:1') (0.00010302937153028324)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.051947
Original XAI WIoU for r=0.3 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2658, device='cuda:1')  +-  tensor(0.3829, device='cuda:1') (0.0050578489899635315)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.820505
Original XAI WIoU for r=0.6 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2611, device='cuda:1')  +-  tensor(0.3854, device='cuda:1') (0.0014965124428272247)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.878774
Original XAI WIoU for r=0.9 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2628, device='cuda:1')  +-  tensor(0.3851, device='cuda:1') (4.650917984072578e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 00:57:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:32 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:34 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:35 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 12:57:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.251
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.402
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.490300
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4955, device='cuda:1')  +-  tensor(0.2905, device='cuda:1') (0.027543460950255394)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.497301
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4625, device='cuda:1')  +-  tensor(0.2708, device='cuda:1') (0.015113269910216331)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.264746
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4043, device='cuda:1')  +-  tensor(0.2070, device='cuda:1') (0.00022678927052766085)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.730305
Original XAI WIoU for r=0.3 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5032, device='cuda:1')  +-  tensor(0.2918, device='cuda:1') (0.027630742639303207)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.488176
Original XAI WIoU for r=0.6 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4675, device='cuda:1')  +-  tensor(0.2714, device='cuda:1') (0.01448690053075552)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.490861
Original XAI WIoU for r=0.9 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4130, device='cuda:1')  +-  tensor(0.2131, device='cuda:1') (0.0002563132729846984)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.917190
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2389, device='cuda:1')  +-  tensor(0.1538, device='cuda:1') (0.017002783715724945)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.939827
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2263, device='cuda:1')  +-  tensor(0.1506, device='cuda:1') (0.006714504212141037)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.217973
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2452, device='cuda:1')  +-  tensor(0.1877, device='cuda:1') (8.78511491464451e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.828332
Original XAI WIoU for r=0.3 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1571, device='cuda:1')  +-  tensor(0.1377, device='cuda:1') (0.009281324222683907)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.848020
Original XAI WIoU for r=0.6 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1920, device='cuda:1')  +-  tensor(0.2405, device='cuda:1') (0.0031385929323732853)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.898299
Original XAI WIoU for r=0.9 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2393, device='cuda:1')  +-  tensor(0.3087, device='cuda:1') (3.510054469302304e-09)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325] (mean across ratios: 0.44761313796043395)
(id) id_val WIOU_PERTURBED: 	[0.51151093 0.4855109  0.45447837] +- [0.09347761 0.08455339 0.07531361] (mean across ratios: 0.4838334023952484)
(id) id_test WIOU_ORIGINAL: 	[0.45311112 0.45311112 0.45311112] +- [0.07175872 0.07175872 0.07175872] (mean across ratios: 0.45311111807823173)
(id) id_test WIOU_PERTURBED: 	[0.51629629 0.49047334 0.46018742] +- [0.09043049 0.08388474 0.07442365] (mean across ratios: 0.48898568153381344)
(id) val WIOU_ORIGINAL: 	[0.30000606 0.30000606 0.30000606] +- [0.08320286 0.08320286 0.08320286] (mean across ratios: 0.3000060647726059)
(id) val WIOU_PERTURBED: 	[0.30875564 0.29657552 0.30217757] +- [0.05628666 0.06303066 0.08021491] (mean across ratios: 0.30250290830930077)
(id) test WIOU_ORIGINAL: 	[0.20151746 0.20151746 0.20151746] +- [0.08016272 0.08016272 0.08016272] (mean across ratios: 0.20151746422052383)
(id) test WIOU_PERTURBED: 	[0.17380703 0.18756265 0.20169574] +- [0.05210393 0.05283683 0.07671009] (mean across ratios: 0.1876884733637174)
DONE LECI GOODMotif/size 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:04:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:34 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:41 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:04:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.533
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.531
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.536
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.342
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.353
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.277
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.289



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.290242
Original XAI WIoU for r=0.3 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5857, device='cuda:1')  +-  tensor(0.3239, device='cuda:1') (0.04497603327035904)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.234771
Original XAI WIoU for r=0.6 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5593, device='cuda:1')  +-  tensor(0.3099, device='cuda:1') (0.02901560626924038)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.215820
Original XAI WIoU for r=0.9 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5352, device='cuda:1')  +-  tensor(0.3186, device='cuda:1') (0.0024146384093910456)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.291120
Original XAI WIoU for r=0.3 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5868, device='cuda:1')  +-  tensor(0.3282, device='cuda:1') (0.042524438351392746)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.224488
Original XAI WIoU for r=0.6 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5622, device='cuda:1')  +-  tensor(0.3151, device='cuda:1') (0.02805279940366745)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.234904
Original XAI WIoU for r=0.9 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5372, device='cuda:1')  +-  tensor(0.3247, device='cuda:1') (0.0024188391398638487)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.410522
Original XAI WIoU for r=0.3 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3713, device='cuda:1')  +-  tensor(0.3486, device='cuda:1') (0.02934083342552185)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.391524
Original XAI WIoU for r=0.6 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3600, device='cuda:1')  +-  tensor(0.3476, device='cuda:1') (0.023015055805444717)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.585504
Original XAI WIoU for r=0.9 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3518, device='cuda:1')  +-  tensor(0.3493, device='cuda:1') (0.0003738260129466653)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.773609
Original XAI WIoU for r=0.3 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3760, device='cuda:1') (0.011988379992544651)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.495102
Original XAI WIoU for r=0.6 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2849, device='cuda:1')  +-  tensor(0.3770, device='cuda:1') (0.009563189931213856)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.704482
Original XAI WIoU for r=0.9 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2824, device='cuda:1')  +-  tensor(0.3784, device='cuda:1') (8.963646541815251e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:10:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:10:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:10:55 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:10:57 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:10:59 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:02 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:11:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.417
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.513
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.411
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.515
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.341
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.352
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.357
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.275
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.239324
Original XAI WIoU for r=0.3 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5507, device='cuda:1')  +-  tensor(0.3127, device='cuda:1') (0.04348767548799515)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.216821
Original XAI WIoU for r=0.6 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5290, device='cuda:1')  +-  tensor(0.3010, device='cuda:1') (0.024699019268155098)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.435819
Original XAI WIoU for r=0.9 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5052, device='cuda:1')  +-  tensor(0.3120, device='cuda:1') (0.002255574567243457)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.222141
Original XAI WIoU for r=0.3 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5541, device='cuda:1')  +-  tensor(0.3174, device='cuda:1') (0.04166710376739502)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.228136
Original XAI WIoU for r=0.6 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5297, device='cuda:1')  +-  tensor(0.3054, device='cuda:1') (0.02286846935749054)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.218078
Original XAI WIoU for r=0.9 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.3184, device='cuda:1') (0.0023194667883217335)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.621236
Original XAI WIoU for r=0.3 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3484, device='cuda:1')  +-  tensor(0.3461, device='cuda:1') (0.02445574849843979)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.379206
Original XAI WIoU for r=0.6 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3444, device='cuda:1')  +-  tensor(0.3464, device='cuda:1') (0.018545158207416534)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.130123
Original XAI WIoU for r=0.9 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3427, device='cuda:1')  +-  tensor(0.3501, device='cuda:1') (0.0018623331561684608)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.747019
Original XAI WIoU for r=0.3 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2772, device='cuda:1')  +-  tensor(0.3788, device='cuda:1') (0.009869751520454884)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.723209
Original XAI WIoU for r=0.6 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2765, device='cuda:1')  +-  tensor(0.3792, device='cuda:1') (0.008242981508374214)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.474049
Original XAI WIoU for r=0.9 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2794, device='cuda:1')  +-  tensor(0.3785, device='cuda:1') (9.736285574035719e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:17:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:04 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:16 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:18 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:20 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:23 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:17:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.518
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.456
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.516
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.522
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.355
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.354
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.282
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.284
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.210076
Original XAI WIoU for r=0.3 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5676, device='cuda:1')  +-  tensor(0.3161, device='cuda:1') (0.05067496746778488)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.208070
Original XAI WIoU for r=0.6 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5390, device='cuda:1')  +-  tensor(0.3042, device='cuda:1') (0.027860863134264946)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.971151
Original XAI WIoU for r=0.9 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5219, device='cuda:1')  +-  tensor(0.3129, device='cuda:1') (0.002722680103033781)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.190128
Original XAI WIoU for r=0.3 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5691, device='cuda:1')  +-  tensor(0.3198, device='cuda:1') (0.0484788604080677)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.189726
Original XAI WIoU for r=0.6 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5413, device='cuda:1')  +-  tensor(0.3070, device='cuda:1') (0.026854166761040688)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.224704
Original XAI WIoU for r=0.9 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5264, device='cuda:1')  +-  tensor(0.3204, device='cuda:1') (0.002687221160158515)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.347738
Original XAI WIoU for r=0.3 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3571, device='cuda:1')  +-  tensor(0.3458, device='cuda:1') (0.02679440565407276)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.560662
Original XAI WIoU for r=0.6 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3529, device='cuda:1')  +-  tensor(0.3448, device='cuda:1') (0.01942271925508976)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.345926
Original XAI WIoU for r=0.9 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3516, device='cuda:1')  +-  tensor(0.3515, device='cuda:1') (0.0009146498050540686)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.715615
Original XAI WIoU for r=0.3 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2814, device='cuda:1')  +-  tensor(0.3773, device='cuda:1') (0.010975604876875877)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.677632
Original XAI WIoU for r=0.6 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2879, device='cuda:1')  +-  tensor(0.3765, device='cuda:1') (0.010145205073058605)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.687245
Original XAI WIoU for r=0.9 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2897, device='cuda:1')  +-  tensor(0.3769, device='cuda:1') (0.00019797062850557268)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:23:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:25 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:39 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:41 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:44 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:23:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.512
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.580
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.576
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.517
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.586
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.438
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.417
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.513
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.231986
Original XAI WIoU for r=0.3 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5728, device='cuda:1')  +-  tensor(0.3047, device='cuda:1') (0.04967623949050903)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.201252
Original XAI WIoU for r=0.6 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5624, device='cuda:1')  +-  tensor(0.2983, device='cuda:1') (0.022707702592015266)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.215784
Original XAI WIoU for r=0.9 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5711, device='cuda:1')  +-  tensor(0.2864, device='cuda:1') (0.0016674769576638937)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.207271
Original XAI WIoU for r=0.3 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5811, device='cuda:1')  +-  tensor(0.3073, device='cuda:1') (0.04809900000691414)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.212280
Original XAI WIoU for r=0.6 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5719, device='cuda:1')  +-  tensor(0.3026, device='cuda:1') (0.022640923038125038)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.439435
Original XAI WIoU for r=0.9 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5817, device='cuda:1')  +-  tensor(0.2884, device='cuda:1') (0.0018584721256047487)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.338014
Original XAI WIoU for r=0.3 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.3310, device='cuda:1') (0.022021526470780373)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.366503
Original XAI WIoU for r=0.6 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3640, device='cuda:1')  +-  tensor(0.3316, device='cuda:1') (0.01339421235024929)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.339693
Original XAI WIoU for r=0.9 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3842, device='cuda:1')  +-  tensor(0.3177, device='cuda:1') (0.001304524950683117)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.722186
Original XAI WIoU for r=0.3 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3524, device='cuda:1')  +-  tensor(0.3592, device='cuda:1') (0.024100657552480698)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.938930
Original XAI WIoU for r=0.6 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.3577, device='cuda:1') (0.01135152205824852)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.701463
Original XAI WIoU for r=0.9 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.3516, device='cuda:1') (0.0011459689121693373)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:29:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:29:47 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:29:59 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:01 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:03 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:06 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:30:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.587
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.707
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.717
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.716
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.610
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.578
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.365
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.246693
Original XAI WIoU for r=0.3 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6773, device='cuda:1')  +-  tensor(0.3197, device='cuda:1') (0.051902491599321365)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.244696
Original XAI WIoU for r=0.6 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6671, device='cuda:1')  +-  tensor(0.3054, device='cuda:1') (0.034481000155210495)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.486803
Original XAI WIoU for r=0.9 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7056, device='cuda:1')  +-  tensor(0.2860, device='cuda:1') (0.002884488319978118)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.253249
Original XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6825, device='cuda:1')  +-  tensor(0.3199, device='cuda:1') (0.052514445036649704)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.258229
Original XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6741, device='cuda:1')  +-  tensor(0.3059, device='cuda:1') (0.034120142459869385)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.252626
Original XAI WIoU for r=0.9 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7165, device='cuda:1')  +-  tensor(0.2846, device='cuda:1') (0.002802837872877717)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.617083
Original XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4638, device='cuda:1')  +-  tensor(0.3264, device='cuda:1') (0.05102365091443062)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.380758
Original XAI WIoU for r=0.6 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4544, device='cuda:1')  +-  tensor(0.3065, device='cuda:1') (0.02665730193257332)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.145222
Original XAI WIoU for r=0.9 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5541, device='cuda:1')  +-  tensor(0.3118, device='cuda:1') (0.004539588000625372)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.792386
Original XAI WIoU for r=0.3 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.3616, device='cuda:1') (0.012835454195737839)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.741158
Original XAI WIoU for r=0.6 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3257, device='cuda:1')  +-  tensor(0.3580, device='cuda:1') (0.007741798181086779)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.731805
Original XAI WIoU for r=0.9 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3373, device='cuda:1')  +-  tensor(0.3536, device='cuda:1') (0.002220078371465206)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.57071018 0.57071018 0.57071018] +- [0.0766256 0.0766256 0.0766256] (mean across ratios: 0.5707101821899414)
(id) id_val WIOU_PERTURBED: 	[0.59083006 0.57136737 0.56779875] +- [0.0446495  0.04947894 0.07222517] (mean across ratios: 0.5766653935114542)
(id) id_test WIOU_ORIGINAL: 	[0.5759082  0.57590812 0.57590805] +- [0.07943818 0.07943786 0.07943791] (mean across ratios: 0.5759081244468689)
(id) id_test WIOU_PERTURBED: 	[0.59472744 0.57583655 0.57423558] +- [0.04528799 0.05136093 0.07503868] (mean across ratios: 0.5815998593966166)
(id) val WIOU_ORIGINAL: 	[0.41252714 0.41252714 0.41252721] +- [0.08479544 0.08479544 0.0847954 ] (mean across ratios: 0.41252716581026716)
(id) val WIOU_PERTURBED: 	[0.38204173 0.37513658 0.3968709 ] +- [0.04174894 0.04021112 0.07988128] (mean across ratios: 0.3846830725669861)
(id) test WIOU_ORIGINAL: 	[0.34305007 0.34305013 0.34305019] +- [0.07925067 0.07925079 0.07925075] (mean across ratios: 0.34305013219515484)
(id) test WIOU_PERTURBED: 	[0.3040247  0.30027218 0.31261035] +- [0.02892998 0.02134994 0.03733251] (mean across ratios: 0.3056357403596242)
DONE CIGA GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:36:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:36:46 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:36:58 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:36:59 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:01 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:05 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:37:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.533
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.531
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.536
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.342
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.353
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.277
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.289



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.314286
Original XAI WIoU for r=0.3 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6057, device='cuda:1')  +-  tensor(0.3280, device='cuda:1') (0.04778394475579262)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.476659
Original XAI WIoU for r=0.6 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5687, device='cuda:1')  +-  tensor(0.3108, device='cuda:1') (0.029884638264775276)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.237337
Original XAI WIoU for r=0.9 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5348, device='cuda:1')  +-  tensor(0.3192, device='cuda:1') (0.0005996422260068357)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.320440
Original XAI WIoU for r=0.3 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6072, device='cuda:1')  +-  tensor(0.3315, device='cuda:1') (0.046140156686306)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.258073
Original XAI WIoU for r=0.6 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.3146, device='cuda:1') (0.02880214713513851)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.005736
Original XAI WIoU for r=0.9 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5373, device='cuda:1')  +-  tensor(0.3247, device='cuda:1') (0.0006400225684046745)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.661610
Original XAI WIoU for r=0.3 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3948, device='cuda:1')  +-  tensor(0.3529, device='cuda:1') (0.0378020703792572)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.400001
Original XAI WIoU for r=0.6 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3712, device='cuda:1')  +-  tensor(0.3461, device='cuda:1') (0.011855696327984333)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.361003
Original XAI WIoU for r=0.9 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3518, device='cuda:1')  +-  tensor(0.3493, device='cuda:1') (1.3362710937769862e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.750659
Original XAI WIoU for r=0.3 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2959, device='cuda:1')  +-  tensor(0.3724, device='cuda:1') (0.015468445606529713)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.721939
Original XAI WIoU for r=0.6 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2904, device='cuda:1')  +-  tensor(0.3746, device='cuda:1') (0.009114710614085197)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.488947
Original XAI WIoU for r=0.9 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2823, device='cuda:1')  +-  tensor(0.3785, device='cuda:1') (6.191967494295625e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:43:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:06 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:18 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:20 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:21 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:43:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.417
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.513
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.411
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.515
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.341
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.352
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.357
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.275
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.447552
Original XAI WIoU for r=0.3 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5683, device='cuda:1')  +-  tensor(0.3154, device='cuda:1') (0.04823639988899231)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.215572
Original XAI WIoU for r=0.6 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5345, device='cuda:1')  +-  tensor(0.3009, device='cuda:1') (0.024706311523914337)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.193978
Original XAI WIoU for r=0.9 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5045, device='cuda:1')  +-  tensor(0.3126, device='cuda:1') (0.0006740480894222856)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.197993
Original XAI WIoU for r=0.3 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5697, device='cuda:1')  +-  tensor(0.3186, device='cuda:1') (0.04775647446513176)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.208567
Original XAI WIoU for r=0.6 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5358, device='cuda:1')  +-  tensor(0.3037, device='cuda:1') (0.02415485307574272)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.433671
Original XAI WIoU for r=0.9 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5092, device='cuda:1')  +-  tensor(0.3185, device='cuda:1') (0.0006858118576928973)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.374622
Original XAI WIoU for r=0.3 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3615, device='cuda:1')  +-  tensor(0.3465, device='cuda:1') (0.028822820633649826)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.378572
Original XAI WIoU for r=0.6 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3533, device='cuda:1')  +-  tensor(0.3451, device='cuda:1') (0.011141619645059109)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.355390
Original XAI WIoU for r=0.9 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3430, device='cuda:1')  +-  tensor(0.3500, device='cuda:1') (7.241078947117785e-06)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.740860
Original XAI WIoU for r=0.3 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2805, device='cuda:1')  +-  tensor(0.3769, device='cuda:1') (0.011448769830167294)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.689478
Original XAI WIoU for r=0.6 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2817, device='cuda:1')  +-  tensor(0.3770, device='cuda:1') (0.008106312714517117)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.713809
Original XAI WIoU for r=0.9 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2793, device='cuda:1')  +-  tensor(0.3785, device='cuda:1') (5.664401170335509e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:49:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:24 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:36 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:38 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:39 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:49:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.518
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.456
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.516
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.522
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.355
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.354
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.282
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.284
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.239159
Original XAI WIoU for r=0.3 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5890, device='cuda:1')  +-  tensor(0.3207, device='cuda:1') (0.05367879197001457)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.217242
Original XAI WIoU for r=0.6 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5455, device='cuda:1')  +-  tensor(0.3048, device='cuda:1') (0.02562732994556427)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.979637
Original XAI WIoU for r=0.9 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5221, device='cuda:1')  +-  tensor(0.3133, device='cuda:1') (0.0007311114459298551)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.203898
Original XAI WIoU for r=0.3 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5910, device='cuda:1')  +-  tensor(0.3234, device='cuda:1') (0.0532933734357357)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.202763
Original XAI WIoU for r=0.6 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5484, device='cuda:1')  +-  tensor(0.3068, device='cuda:1') (0.025740470737218857)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:02.969686
Original XAI WIoU for r=0.9 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5264, device='cuda:1')  +-  tensor(0.3204, device='cuda:1') (0.000756012334022671)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.585395
Original XAI WIoU for r=0.3 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3749, device='cuda:1')  +-  tensor(0.3473, device='cuda:1') (0.03489438816905022)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.359470
Original XAI WIoU for r=0.6 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3601, device='cuda:1')  +-  tensor(0.3437, device='cuda:1') (0.011656473390758038)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.342055
Original XAI WIoU for r=0.9 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3516, device='cuda:1')  +-  tensor(0.3516, device='cuda:1') (2.140156993846176e-06)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.945903
Original XAI WIoU for r=0.3 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2849, device='cuda:1')  +-  tensor(0.3754, device='cuda:1') (0.013044880703091621)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.699282
Original XAI WIoU for r=0.6 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2922, device='cuda:1')  +-  tensor(0.3745, device='cuda:1') (0.009607485495507717)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.680156
Original XAI WIoU for r=0.9 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2896, device='cuda:1')  +-  tensor(0.3769, device='cuda:1') (1.4962883199132193e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 01:55:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 01:55:49 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:01 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:08 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 01:56:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.580
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.576
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.517
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.586
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.438
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.417
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.513
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.523416
Original XAI WIoU for r=0.3 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5860, device='cuda:1')  +-  tensor(0.3175, device='cuda:1') (0.05331093817949295)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.257817
Original XAI WIoU for r=0.6 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5698, device='cuda:1')  +-  tensor(0.3024, device='cuda:1') (0.0181574709713459)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.241141
Original XAI WIoU for r=0.9 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5710, device='cuda:1')  +-  tensor(0.2873, device='cuda:1') (0.0005671399994753301)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.247345
Original XAI WIoU for r=0.3 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5947, device='cuda:1')  +-  tensor(0.3164, device='cuda:1') (0.04978740215301514)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.265261
Original XAI WIoU for r=0.6 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.3057, device='cuda:1') (0.01703825034201145)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.487309
Original XAI WIoU for r=0.9 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2893, device='cuda:1') (0.00048659014282748103)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.382487
Original XAI WIoU for r=0.3 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3819, device='cuda:1')  +-  tensor(0.3383, device='cuda:1') (0.027633346617221832)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.408217
Original XAI WIoU for r=0.6 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3755, device='cuda:1')  +-  tensor(0.3364, device='cuda:1') (0.008625454269349575)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.402050
Original XAI WIoU for r=0.9 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3842, device='cuda:1')  +-  tensor(0.3179, device='cuda:1') (6.33711097179912e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.965405
Original XAI WIoU for r=0.3 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3174, device='cuda:1')  +-  tensor(0.3604, device='cuda:1') (0.017469536513090134)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.711918
Original XAI WIoU for r=0.6 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3061, device='cuda:1')  +-  tensor(0.3641, device='cuda:1') (0.00716520706191659)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.490420
Original XAI WIoU for r=0.9 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3696, device='cuda:1')  +-  tensor(0.3516, device='cuda:1') (4.483087252538098e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:02:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:11 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:22 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:24 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:26 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:29 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 02:02:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.587
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.707
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.717
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.717
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.610
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.578
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.365
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.220815
Original XAI WIoU for r=0.3 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6890, device='cuda:1')  +-  tensor(0.3332, device='cuda:1') (0.045304831117391586)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.220844
Original XAI WIoU for r=0.6 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6698, device='cuda:1')  +-  tensor(0.3186, device='cuda:1') (0.02822031080722809)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.449225
Original XAI WIoU for r=0.9 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7036, device='cuda:1')  +-  tensor(0.2892, device='cuda:1') (0.0010413533309474587)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.211635
Original XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6905, device='cuda:1')  +-  tensor(0.3339, device='cuda:1') (0.04504435136914253)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.228854
Original XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6750, device='cuda:1')  +-  tensor(0.3192, device='cuda:1') (0.0278796199709177)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.226733
Original XAI WIoU for r=0.9 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7138, device='cuda:1')  +-  tensor(0.2883, device='cuda:1') (0.0009650157880969346)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.578313
Original XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4826, device='cuda:1')  +-  tensor(0.3570, device='cuda:1') (0.04824070259928703)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.346250
Original XAI WIoU for r=0.6 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4555, device='cuda:1')  +-  tensor(0.3233, device='cuda:1') (0.015575427561998367)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.104743
Original XAI WIoU for r=0.9 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5485, device='cuda:1')  +-  tensor(0.3173, device='cuda:1') (0.0011363730300217867)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.667291
Original XAI WIoU for r=0.3 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3321, device='cuda:1')  +-  tensor(0.3613, device='cuda:1') (0.015165610238909721)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.695402
Original XAI WIoU for r=0.6 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3342, device='cuda:1')  +-  tensor(0.3564, device='cuda:1') (0.007480686064809561)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.734149
Original XAI WIoU for r=0.9 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3342, device='cuda:1')  +-  tensor(0.3560, device='cuda:1') (0.0006654491880908608)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.57071018 0.57071018 0.57071018] +- [0.0766256 0.0766256 0.0766256] (mean across ratios: 0.5707101821899414)
(id) id_val WIOU_PERTURBED: 	[0.60759008 0.57767953 0.56720024] +- [0.04240018 0.04801072 0.07159323] (mean across ratios: 0.5841566165288289)
(id) id_test WIOU_ORIGINAL: 	[0.57590805 0.57590805 0.57590805] +- [0.07943791 0.07943791 0.07943791] (mean across ratios: 0.5759080529212952)
(id) id_test WIOU_PERTURBED: 	[0.6106023  0.58174125 0.57361737] +- [0.04174567 0.0490524  0.07403541] (mean across ratios: 0.5886536399523417)
(id) val WIOU_ORIGINAL: 	[0.41252714 0.41252714 0.41252714] +- [0.08479544 0.08479544 0.08479544] (mean across ratios: 0.4125271439552307)
(id) val WIOU_PERTURBED: 	[0.39914795 0.38313542 0.39585384] +- [0.043086   0.03704731 0.0776109 ] (mean across ratios: 0.3927124003569285)
(id) test WIOU_ORIGINAL: 	[0.34305013 0.34305007 0.34305013] +- [0.07925063 0.07925067 0.07925063] (mean across ratios: 0.34305010835329686)
(id) test WIOU_PERTURBED: 	[0.30217761 0.30091689 0.3110031 ] +- [0.01967062 0.01838789 0.03537941] (mean across ratios: 0.3046992003917694)
DONE CIGA GOODMotif/size 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:09:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:21 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:23 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:25 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:09:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.626
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.412
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.832294
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4435, device='cuda:1')  +-  tensor(0.2366, device='cuda:1') (0.006363349035382271)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.762351
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4424, device='cuda:1')  +-  tensor(0.2356, device='cuda:1') (0.00430159829556942)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.761142
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3986, device='cuda:1')  +-  tensor(0.1905, device='cuda:1') (0.00034914223942905664)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.803141
Original XAI WIoU for r=0.3 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2393, device='cuda:1') (0.006052389275282621)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.988081
Original XAI WIoU for r=0.6 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4452, device='cuda:1')  +-  tensor(0.2386, device='cuda:1') (0.0042486353777348995)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.758382
Original XAI WIoU for r=0.9 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4014, device='cuda:1')  +-  tensor(0.1943, device='cuda:1') (0.0003709576849360019)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.625030
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1821, device='cuda:1')  +-  tensor(0.0986, device='cuda:1') (0.0020943982526659966)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.368291
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1804, device='cuda:1')  +-  tensor(0.0969, device='cuda:1') (0.001566743478178978)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.592400
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1645, device='cuda:1')  +-  tensor(0.0784, device='cuda:1') (0.00030821378459222615)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.687651
Original XAI WIoU for r=0.3 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0765, device='cuda:1')  +-  tensor(0.0345, device='cuda:1') (0.000517204578500241)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.582305
Original XAI WIoU for r=0.6 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0756, device='cuda:1')  +-  tensor(0.0337, device='cuda:1') (0.00039669894613325596)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.697270
Original XAI WIoU for r=0.9 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0701, device='cuda:1')  +-  tensor(0.0290, device='cuda:1') (0.0001250258064828813)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:15:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:15:48 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:02 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:04 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:16:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.608
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.528
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.401
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.202
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.988116
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4376, device='cuda:1')  +-  tensor(0.2346, device='cuda:1') (0.004976207856088877)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.743162
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4356, device='cuda:1')  +-  tensor(0.2324, device='cuda:1') (0.003867160761728883)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.731173
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3907, device='cuda:1')  +-  tensor(0.1857, device='cuda:1') (0.00036014479701407254)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.971118
Original XAI WIoU for r=0.3 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4401, device='cuda:1')  +-  tensor(0.2374, device='cuda:1') (0.0048752957955002785)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.736472
Original XAI WIoU for r=0.6 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4380, device='cuda:1')  +-  tensor(0.2353, device='cuda:1') (0.003751539858058095)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.716802
Original XAI WIoU for r=0.9 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3936, device='cuda:1')  +-  tensor(0.1898, device='cuda:1') (0.00037492424598895013)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.349508
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1777, device='cuda:1')  +-  tensor(0.0954, device='cuda:1') (0.0017049714224413037)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.333852
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1763, device='cuda:1')  +-  tensor(0.0939, device='cuda:1') (0.0013756809057667851)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.571030
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1603, device='cuda:1')  +-  tensor(0.0755, device='cuda:1') (0.0003287054132670164)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.568700
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0758, device='cuda:1')  +-  tensor(0.0344, device='cuda:1') (0.00043556824675761163)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.561698
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0749, device='cuda:1')  +-  tensor(0.0336, device='cuda:1') (0.0003803442232310772)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.567574
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0699, device='cuda:1')  +-  tensor(0.0294, device='cuda:1') (4.818643719772808e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:22:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:30 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:22:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.616
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.547
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.413
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.748267
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4412, device='cuda:1')  +-  tensor(0.2349, device='cuda:1') (0.0051345136016607285)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.964497
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4391, device='cuda:1')  +-  tensor(0.2325, device='cuda:1') (0.003950024023652077)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.741040
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3969, device='cuda:1')  +-  tensor(0.1888, device='cuda:1') (0.0004126170533709228)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.742154
Original XAI WIoU for r=0.3 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4439, device='cuda:1')  +-  tensor(0.2378, device='cuda:1') (0.004894846118986607)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.711875
Original XAI WIoU for r=0.6 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4419, device='cuda:1')  +-  tensor(0.2357, device='cuda:1') (0.0036990807857364416)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.743122
Original XAI WIoU for r=0.9 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3997, device='cuda:1')  +-  tensor(0.1925, device='cuda:1') (0.00043333048233762383)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.343021
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0960, device='cuda:1') (0.0017436740454286337)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.326422
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1777, device='cuda:1')  +-  tensor(0.0949, device='cuda:1') (0.0013613232877105474)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.373896
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1618, device='cuda:1')  +-  tensor(0.0769, device='cuda:1') (0.0003187253896612674)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.550755
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0763, device='cuda:1')  +-  tensor(0.0344, device='cuda:1') (0.00045096047688275576)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.570030
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0754, device='cuda:1')  +-  tensor(0.0335, device='cuda:1') (0.0003972392005380243)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.576493
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0703, device='cuda:1')  +-  tensor(0.0292, device='cuda:1') (9.730993770062923e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:29:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:09 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:21 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:23 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:25 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:29:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.076



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.758417
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4387, device='cuda:1')  +-  tensor(0.2333, device='cuda:1') (0.005734231323003769)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.507553
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4338, device='cuda:1')  +-  tensor(0.2263, device='cuda:1') (0.004366041161119938)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.756960
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3949, device='cuda:1')  +-  tensor(0.1869, device='cuda:1') (0.0004009623371530324)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.830367
Original XAI WIoU for r=0.3 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4414, device='cuda:1')  +-  tensor(0.2361, device='cuda:1') (0.005468873307108879)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.693632
Original XAI WIoU for r=0.6 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4361, device='cuda:1')  +-  tensor(0.2289, device='cuda:1') (0.0041862428188323975)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.739515
Original XAI WIoU for r=0.9 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3972, device='cuda:1')  +-  tensor(0.1905, device='cuda:1') (0.00041549428715370595)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.290372
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1797, device='cuda:1')  +-  tensor(0.0968, device='cuda:1') (0.00210018758662045)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.309386
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1780, device='cuda:1')  +-  tensor(0.0952, device='cuda:1') (0.0015263449167832732)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.320798
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1629, device='cuda:1')  +-  tensor(0.0770, device='cuda:1') (0.000341716775437817)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.535390
Original XAI WIoU for r=0.3 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0780, device='cuda:1')  +-  tensor(0.0358, device='cuda:1') (0.0005262647173367441)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.757664
Original XAI WIoU for r=0.6 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0771, device='cuda:1')  +-  tensor(0.0346, device='cuda:1') (0.0003929644008167088)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.538308
Original XAI WIoU for r=0.9 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0725, device='cuda:1')  +-  tensor(0.0303, device='cuda:1') (0.00011085996084148064)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:35:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:35:45 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:35:57 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:35:59 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:01 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:04 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:36:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.604
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.536
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.107
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.074



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.712989
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4401, device='cuda:1')  +-  tensor(0.2359, device='cuda:1') (0.004790007136762142)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.724145
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4373, device='cuda:1')  +-  tensor(0.2325, device='cuda:1') (0.003660893766209483)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.966861
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3951, device='cuda:1')  +-  tensor(0.1888, device='cuda:1') (0.0003356719680596143)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.704879
Original XAI WIoU for r=0.3 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4424, device='cuda:1')  +-  tensor(0.2384, device='cuda:1') (0.004565646406263113)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.471948
Original XAI WIoU for r=0.6 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4400, device='cuda:1')  +-  tensor(0.2357, device='cuda:1') (0.00355319119989872)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.732533
Original XAI WIoU for r=0.9 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3978, device='cuda:1')  +-  tensor(0.1928, device='cuda:1') (0.0003544216160662472)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.295722
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1784, device='cuda:1')  +-  tensor(0.0970, device='cuda:1') (0.0018177649471908808)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.291565
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1766, device='cuda:1')  +-  tensor(0.0955, device='cuda:1') (0.0013825938804075122)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.347180
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1605, device='cuda:1')  +-  tensor(0.0770, device='cuda:1') (0.0004030881973449141)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.498706
Original XAI WIoU for r=0.3 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0751, device='cuda:1')  +-  tensor(0.0338, device='cuda:1') (0.0005144401220604777)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.517175
Original XAI WIoU for r=0.6 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0742, device='cuda:1')  +-  tensor(0.0329, device='cuda:1') (0.00040547928074374795)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.546397
Original XAI WIoU for r=0.9 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0692, device='cuda:1')  +-  tensor(0.0287, device='cuda:1') (0.00012847426114603877)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.38347059 0.38347052 0.38347059] +- [0.00255775 0.00255777 0.00255775] (mean across ratios: 0.38347056905428567)
(id) id_val WIOU_PERTURBED: 	[0.44021081 0.43763244 0.39525466] +- [0.00206488 0.00297025 0.00263768] (mean across ratios: 0.4243659694989523)
(id) id_test WIOU_ORIGINAL: 	[0.38640491 0.38640491 0.38640491] +- [0.00261254 0.00261254 0.00261254] (mean across ratios: 0.3864049077033996)
(id) id_test WIOU_PERTURBED: 	[0.44279252 0.44025036 0.39793691] +- [0.0020815  0.00315221 0.00262208] (mean across ratios: 0.42699326276779176)
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181] (mean across ratios: 0.155351859331131)
(id) val WIOU_PERTURBED: 	[0.1794892  0.17780903 0.16201232] +- [0.00150325 0.00146628 0.00155813] (mean across ratios: 0.17310351431369783)
(id) test WIOU_ORIGINAL: 	[0.06810767 0.06810767 0.06810767] +- [0.00054001 0.00054001 0.00054001] (mean across ratios: 0.06810766607522964)
(id) test WIOU_PERTURBED: 	[0.07632817 0.07545932 0.07040513] +- [0.00095222 0.00094556 0.0011072 ] (mean across ratios: 0.07406420707702636)
DONE GSAT GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:43:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:06 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:18 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:19 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:21 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:25 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:43:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.626
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.412
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.642858
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4778, device='cuda:1')  +-  tensor(0.2635, device='cuda:1') (0.00626277644187212)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.586133
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4738, device='cuda:1')  +-  tensor(0.2596, device='cuda:1') (0.004062559921294451)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.678947
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3991, device='cuda:1')  +-  tensor(0.1900, device='cuda:1') (0.0001758071593940258)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.637801
Original XAI WIoU for r=0.3 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4794, device='cuda:1')  +-  tensor(0.2650, device='cuda:1') (0.006251221988350153)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.818180
Original XAI WIoU for r=0.6 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4756, device='cuda:1')  +-  tensor(0.2613, device='cuda:1') (0.004120903555303812)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.590121
Original XAI WIoU for r=0.9 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4019, device='cuda:1')  +-  tensor(0.1938, device='cuda:1') (0.0001620515395188704)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.426358
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2038, device='cuda:1')  +-  tensor(0.1219, device='cuda:1') (0.002659393707290292)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.168712
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1989, device='cuda:1')  +-  tensor(0.1178, device='cuda:1') (0.0011693702545017004)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.416593
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1650, device='cuda:1')  +-  tensor(0.0779, device='cuda:1') (0.0001492313895141706)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.567303
Original XAI WIoU for r=0.3 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0860, device='cuda:1')  +-  tensor(0.0410, device='cuda:1') (0.0007043134537525475)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.299730
Original XAI WIoU for r=0.6 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0834, device='cuda:1')  +-  tensor(0.0389, device='cuda:1') (0.0004882024950347841)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.569228
Original XAI WIoU for r=0.9 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0704, device='cuda:1')  +-  tensor(0.0287, device='cuda:1') (7.990696030901745e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:49:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:49:36 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:49:48 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:49:50 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:49:51 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:49:55 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:50:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.608
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.528
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.401
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.202
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.788959
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4718, device='cuda:1')  +-  tensor(0.2616, device='cuda:1') (0.004783150274306536)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.545293
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4655, device='cuda:1')  +-  tensor(0.2528, device='cuda:1') (0.0032835393212735653)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.530565
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3913, device='cuda:1')  +-  tensor(0.1850, device='cuda:1') (0.00019445459474809468)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.771192
Original XAI WIoU for r=0.3 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4736, device='cuda:1')  +-  tensor(0.2634, device='cuda:1') (0.004746322054415941)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.534148
Original XAI WIoU for r=0.6 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2545, device='cuda:1') (0.0032144568394869566)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.523508
Original XAI WIoU for r=0.9 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3941, device='cuda:1')  +-  tensor(0.1892, device='cuda:1') (0.0001801098114810884)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.118683
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1992, device='cuda:1')  +-  tensor(0.1177, device='cuda:1') (0.0021116428542882204)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.111728
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1949, device='cuda:1')  +-  tensor(0.1145, device='cuda:1') (0.0010445850202813745)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.360138
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1611, device='cuda:1')  +-  tensor(0.0747, device='cuda:1') (0.00017209656652994454)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.271826
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0852, device='cuda:1')  +-  tensor(0.0408, device='cuda:1') (0.0005795890465378761)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.283714
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0826, device='cuda:1')  +-  tensor(0.0385, device='cuda:1') (0.00041537388460710645)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.359487
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0700, device='cuda:1')  +-  tensor(0.0293, device='cuda:1') (4.327449460106436e-06)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 02:56:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:19 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:21 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:23 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 02:56:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.616
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.547
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.413
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.570430
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4756, device='cuda:1')  +-  tensor(0.2621, device='cuda:1') (0.004833991639316082)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.325942
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4693, device='cuda:1')  +-  tensor(0.2532, device='cuda:1') (0.0033527188934385777)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.586657
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3974, device='cuda:1')  +-  tensor(0.1882, device='cuda:1') (0.00019722820434253663)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.576340
Original XAI WIoU for r=0.3 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4775, device='cuda:1')  +-  tensor(0.2639, device='cuda:1') (0.004779849201440811)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.543181
Original XAI WIoU for r=0.6 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4715, device='cuda:1')  +-  tensor(0.2555, device='cuda:1') (0.003433127887547016)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.587176
Original XAI WIoU for r=0.9 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4002, device='cuda:1')  +-  tensor(0.1920, device='cuda:1') (0.00018186113447882235)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.117039
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2007, device='cuda:1')  +-  tensor(0.1186, device='cuda:1') (0.00206929468549788)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.130181
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1958, device='cuda:1')  +-  tensor(0.1160, device='cuda:1') (0.0010650699259713292)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.173596
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1623, device='cuda:1')  +-  tensor(0.0762, device='cuda:1') (0.00017916884098667651)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.292434
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0857, device='cuda:1')  +-  tensor(0.0408, device='cuda:1') (0.0005672613624483347)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.508363
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0831, device='cuda:1')  +-  tensor(0.0386, device='cuda:1') (0.0004387869266793132)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.376293
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0707, device='cuda:1')  +-  tensor(0.0289, device='cuda:1') (7.729115895926952e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 03:02:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 03:02:38 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 03:02:49 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 03:02:51 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 03:02:53 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 03:02:56 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 03:03:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.076



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.567514
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4736, device='cuda:1')  +-  tensor(0.2616, device='cuda:1') (0.005784948822110891)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.539901
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4636, device='cuda:1')  +-  tensor(0.2478, device='cuda:1') (0.00399714196100831)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.577194
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3954, device='cuda:1')  +-  tensor(0.1863, device='cuda:1') (0.00020644078904297203)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.539918
Original XAI WIoU for r=0.3 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4754, device='cuda:1')  +-  tensor(0.2632, device='cuda:1') (0.005733674392104149)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.297848
Original XAI WIoU for r=0.6 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4652, device='cuda:1')  +-  tensor(0.2492, device='cuda:1') (0.004012607969343662)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.566733
Original XAI WIoU for r=0.9 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3978, device='cuda:1')  +-  tensor(0.1899, device='cuda:1') (0.00018053101666737348)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.138205
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2006, device='cuda:1')  +-  tensor(0.1198, device='cuda:1') (0.00240502692759037)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.104156
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1954, device='cuda:1')  +-  tensor(0.1153, device='cuda:1') (0.0011756200110539794)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.030731
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1634, device='cuda:1')  +-  tensor(0.0765, device='cuda:1') (0.0001569244486745447)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.487420
Original XAI WIoU for r=0.3 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0873, device='cuda:1')  +-  tensor(0.0423, device='cuda:1') (0.0007425625808537006)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.257474
Original XAI WIoU for r=0.6 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0848, device='cuda:1')  +-  tensor(0.0394, device='cuda:1') (0.0005194550030864775)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.328159
Original XAI WIoU for r=0.9 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0729, device='cuda:1')  +-  tensor(0.0298, device='cuda:1') (7.931669824756682e-05)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 03:09:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:23 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:27 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 03:09:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.604
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.536
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.107
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.074



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.555860
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4740, device='cuda:1')  +-  tensor(0.2615, device='cuda:1') (0.004917213227599859)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.556606
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4681, device='cuda:1')  +-  tensor(0.2544, device='cuda:1') (0.003361725714057684)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.565251
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3958, device='cuda:1')  +-  tensor(0.1881, device='cuda:1') (0.00019038176105823368)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.536809
Original XAI WIoU for r=0.3 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4754, device='cuda:1')  +-  tensor(0.2630, device='cuda:1') (0.004849105607718229)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.295832
Original XAI WIoU for r=0.6 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4701, device='cuda:1')  +-  tensor(0.2563, device='cuda:1') (0.003235881682485342)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.565772
Original XAI WIoU for r=0.9 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3985, device='cuda:1')  +-  tensor(0.1920, device='cuda:1') (0.0001928375568240881)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.113084
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2000, device='cuda:1')  +-  tensor(0.1200, device='cuda:1') (0.0021717576310038567)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.099571
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1949, device='cuda:1')  +-  tensor(0.1158, device='cuda:1') (0.0010717203840613365)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.171020
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1613, device='cuda:1')  +-  tensor(0.0762, device='cuda:1') (0.00020527593733277172)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.247031
Original XAI WIoU for r=0.3 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0845, device='cuda:1')  +-  tensor(0.0402, device='cuda:1') (0.0006691471789963543)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.232361
Original XAI WIoU for r=0.6 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0819, device='cuda:1')  +-  tensor(0.0381, device='cuda:1') (0.0004912955919280648)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.378376
Original XAI WIoU for r=0.9 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0695, device='cuda:1')  +-  tensor(0.0283, device='cuda:1') (5.8360961702419445e-05)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.38347059 0.38347059 0.38347059] +- [0.00255775 0.00255775 0.00255775] (mean across ratios: 0.3834705948829651)
(id) id_val WIOU_PERTURBED: 	[0.47452975 0.46804435 0.39580272] +- [0.00200954 0.00348533 0.0026041 ] (mean across ratios: 0.44612560470898943)
(id) id_test WIOU_ORIGINAL: 	[0.38640497 0.38640491 0.38640491] +- [0.00261251 0.00261254 0.00261254] (mean across ratios: 0.386404929558436)
(id) id_test WIOU_PERTURBED: 	[0.47627024 0.46992764 0.39848919] +- [0.00198301 0.00361267 0.0026017 ] (mean across ratios: 0.4482290248076121)
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181] (mean across ratios: 0.155351859331131)
(id) val WIOU_PERTURBED: 	[0.200872   0.19597208 0.16262766] +- [0.00155713 0.00151724 0.00144504] (mean across ratios: 0.1864905774593353)
(id) test WIOU_ORIGINAL: 	[0.06810767 0.06810767 0.06810767] +- [0.00054001 0.00054001 0.00054001] (mean across ratios: 0.06810766607522964)
(id) test WIOU_PERTURBED: 	[0.08572416 0.08315085 0.07069363] +- [0.00095144 0.00098718 0.00117857] (mean across ratios: 0.07985621243715287)
DONE GSAT GOODMotif/size 0.08
DONE all :)
